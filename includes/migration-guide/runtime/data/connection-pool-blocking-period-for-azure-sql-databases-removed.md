---
ms.openlocfilehash: d7a18a0b457c2a38f40c1da3b2f0bfc578259475
ms.sourcegitcommit: e02d17b2cf9c1258dadda4810a5e6072a0089aee
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/01/2020
ms.locfileid: "85621067"
---
### <a name="connection-pool-blocking-period-for-azure-sql-databases-is-removed"></a><span data-ttu-id="f0906-101">Doba blokování fondu připojení pro databáze SQL Azure je odebraná.</span><span class="sxs-lookup"><span data-stu-id="f0906-101">Connection pool blocking period for Azure SQL databases is removed</span></span>

#### <a name="details"></a><span data-ttu-id="f0906-102">Podrobnosti</span><span class="sxs-lookup"><span data-stu-id="f0906-102">Details</span></span>

<span data-ttu-id="f0906-103">Počínaje .NET Framework 4.6.2 platí, že pro žádosti o otevření připojení ke známým databázím Azure SQL ( \* . Database.Windows.NET,. \* Database.chinacloudapi.cn, \* . database.usgovcloudapi.net, \* . Database.cloudapi.de) se odeberou dobu blokování fondu připojení a chyby otevření připojení se neukládají do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="f0906-103">Starting with the .NET Framework 4.6.2, for connection open requests to known Azure SQL databases (\*.database.windows.net, \*.database.chinacloudapi.cn, \*.database.usgovcloudapi.net, \*.database.cloudapi.de), the connection pool blocking period is removed, and connection open errors are not cached.</span></span> <span data-ttu-id="f0906-104">Pokusí se znovu spustit žádosti o připojení, ke kterým dojde téměř hned po přechodných chybách připojení.</span><span class="sxs-lookup"><span data-stu-id="f0906-104">Attempts to retry connection open requests will occur almost immediately after transient connection errors.</span></span> <span data-ttu-id="f0906-105">Tato změna umožňuje okamžité opakování pokusu o připojení pro databáze SQL Azure, což zlepšuje výkon aplikací s podporou cloudu.</span><span class="sxs-lookup"><span data-stu-id="f0906-105">This change allows the connection open attempt to be retried immediately for Azure SQL databases, thereby improving the performance of cloud- enabled apps.</span></span> <span data-ttu-id="f0906-106">U všech dalších pokusů o připojení se i nadále vynutilo období blokování fondu připojení.</span><span class="sxs-lookup"><span data-stu-id="f0906-106">For all other connection attempts, the connection pool blocking period continues to be enforced.</span></span><p/><span data-ttu-id="f0906-107">Pokud se v .NET Framework 4.6.1 a starších verzích při připojování k databázi vyskytne přechodný výpadek připojení, pokus o připojení se nedá znovu zkusit znovu, protože fond připojení ukládá chybu do mezipaměti a znovu ji vyvolá po dobu 5 sekund až 1 minuty.</span><span class="sxs-lookup"><span data-stu-id="f0906-107">In the .NET Framework 4.6.1 and earlier versions, when an app encounters a transient connection failure when connecting to a database, the connection attempt cannot be retried quickly, because the connection pool caches the error and re-throws it for 5 seconds to 1 minute.</span></span> <span data-ttu-id="f0906-108">Další informace najdete v tématu věnovaném [sdružování připojení SQL Server (ADO.NET)](~/docs/framework/data/adonet/sql-server-connection-pooling.md).</span><span class="sxs-lookup"><span data-stu-id="f0906-108">For more information, see [SQL Server Connection Pooling (ADO.NET)](~/docs/framework/data/adonet/sql-server-connection-pooling.md).</span></span> <span data-ttu-id="f0906-109">Toto chování je problematické pro připojení k databázím Azure SQL, což často selhává kvůli přechodným chybám, které se obvykle obnovují během několika sekund.</span><span class="sxs-lookup"><span data-stu-id="f0906-109">This behavior is problematic for connections to Azure SQL databases, which often fail with transient errors that are typically recovered from within a few seconds.</span></span> <span data-ttu-id="f0906-110">Funkce blokování fondu připojení znamená, že se aplikace nemůže po rozsáhlé době připojit k databázi, a to i v případě, že je databáze k dispozici a aplikace musí vykreslovat během několika sekund.</span><span class="sxs-lookup"><span data-stu-id="f0906-110">The connection pool blocking feature means that the app cannot connect to the database for an extensive period, even though the database is available and the app needs to render within a few seconds.</span></span>

#### <a name="suggestion"></a><span data-ttu-id="f0906-111">Návrh</span><span class="sxs-lookup"><span data-stu-id="f0906-111">Suggestion</span></span>

<span data-ttu-id="f0906-112">Je-li toto chování nežádoucí, lze nastavit dobu blokování fondu připojení nastavením <xref:System.Data.SqlClient.SqlConnectionStringBuilder.PoolBlockingPeriod?displayProperty=fullName> vlastnosti zavedené ve .NET Framework 4.6.2.</span><span class="sxs-lookup"><span data-stu-id="f0906-112">If this behavior is undesirable, the connection pool blocking period can be configured by setting the <xref:System.Data.SqlClient.SqlConnectionStringBuilder.PoolBlockingPeriod?displayProperty=fullName> property introduced in the .NET Framework 4.6.2.</span></span> <span data-ttu-id="f0906-113">Hodnota vlastnosti je členem <xref:System.Data.SqlClient.PoolBlockingPeriod?displayProperty=fullName> výčtu, který může převzít jednu ze tří hodnot:</span><span class="sxs-lookup"><span data-stu-id="f0906-113">The value of the property is a member of the <xref:System.Data.SqlClient.PoolBlockingPeriod?displayProperty=fullName> enumeration that can take either of three values:</span></span><ul><li><xref:System.Data.SqlClient.PoolBlockingPeriod.AlwaysBlock></li><li><xref:System.Data.SqlClient.PoolBlockingPeriod.Auto></li><li><xref:System.Data.SqlClient.PoolBlockingPeriod.NeverBlock></li></ul><span data-ttu-id="f0906-114">Předchozí chování lze obnovit nastavením <xref:System.Data.SqlClient.SqlConnectionStringBuilder.PoolBlockingPeriod?displayProperty=fullName> vlastnosti na <xref:System.Data.SqlClient.PoolBlockingPeriod.AlwaysBlock> .</span><span class="sxs-lookup"><span data-stu-id="f0906-114">The previous behavior can be restored by setting the <xref:System.Data.SqlClient.SqlConnectionStringBuilder.PoolBlockingPeriod?displayProperty=fullName> property to <xref:System.Data.SqlClient.PoolBlockingPeriod.AlwaysBlock>.</span></span>

| <span data-ttu-id="f0906-115">Name</span><span class="sxs-lookup"><span data-stu-id="f0906-115">Name</span></span>    | <span data-ttu-id="f0906-116">Hodnota</span><span class="sxs-lookup"><span data-stu-id="f0906-116">Value</span></span>       |
|:--------|:------------|
| <span data-ttu-id="f0906-117">Rozsah</span><span class="sxs-lookup"><span data-stu-id="f0906-117">Scope</span></span>   |<span data-ttu-id="f0906-118">Vedlejší</span><span class="sxs-lookup"><span data-stu-id="f0906-118">Minor</span></span>|
|<span data-ttu-id="f0906-119">Verze</span><span class="sxs-lookup"><span data-stu-id="f0906-119">Version</span></span>|<span data-ttu-id="f0906-120">4.6.2</span><span class="sxs-lookup"><span data-stu-id="f0906-120">4.6.2</span></span>|
|<span data-ttu-id="f0906-121">Typ</span><span class="sxs-lookup"><span data-stu-id="f0906-121">Type</span></span>|<span data-ttu-id="f0906-122">Modul runtime</span><span class="sxs-lookup"><span data-stu-id="f0906-122">Runtime</span></span>

#### <a name="affected-apis"></a><span data-ttu-id="f0906-123">Ovlivněná rozhraní API</span><span class="sxs-lookup"><span data-stu-id="f0906-123">Affected APIs</span></span>

-<xref:System.Data.Common.DbConnection.OpenAsync?displayProperty=nameWithType></li><li><xref:System.Data.SqlClient.SqlConnection.Open?displayProperty=nameWithType></li><li><xref:System.Data.SqlClient.SqlConnection.OpenAsync(System.Threading.CancellationToken)?displayProperty=nameWithType></li></ul>|
