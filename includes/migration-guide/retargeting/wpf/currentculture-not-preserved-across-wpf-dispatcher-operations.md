### <a name="currentculture-is-not-preserved-across-wpf-dispatcher-operations"></a><span data-ttu-id="a70d7-101">CurrentCulture nezachová v objektu WPF Dispatcher operace</span><span class="sxs-lookup"><span data-stu-id="a70d7-101">CurrentCulture is not preserved across WPF Dispatcher operations</span></span>

|   |   |
|---|---|
|<span data-ttu-id="a70d7-102">Podrobnosti</span><span class="sxs-lookup"><span data-stu-id="a70d7-102">Details</span></span>|<span data-ttu-id="a70d7-103">Počínaje .NET Framework 4.6, se změní na <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> nebo <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> v rámci <xref:System.Windows.Threading.Dispatcher?displayProperty=name> ztratí na konci této operace dispečera.</span><span class="sxs-lookup"><span data-stu-id="a70d7-103">Beginning in the .NET Framework 4.6, changes to <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> or <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> made within a <xref:System.Windows.Threading.Dispatcher?displayProperty=name> will be lost at the end of that dispatcher operation.</span></span> <span data-ttu-id="a70d7-104">Podobně změny <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> nebo <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> provedené mimo dispečera operace nemusí odrážet při, že se spustí operace. Prakticky mluvy, to znamená, že <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> a <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> změny nemusí tok mezi zpětná volání rozhraní WPF a jiný kód v aplikaci WPF. Toto je z důvodu změn v <xref:System.Threading.ExecutionContext?displayProperty=name> , který způsobí, že <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> a <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> uloží na začátku kontextu spuštění v rámci aplikace využívající rozhraní .NET Framework 4.6.</span><span class="sxs-lookup"><span data-stu-id="a70d7-104">Similarly, changes to <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> or <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> made outside of a Dispatcher operation may not be reflected when that operation executes.Practically speaking, this means that <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> changes may not flow between WPF UI callbacks and other code in a WPF application.This is due to a change in <xref:System.Threading.ExecutionContext?displayProperty=name> that causes <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> to be stored in the execution context beginning with apps targeting the .NET Framework 4.6.</span></span> <span data-ttu-id="a70d7-105">WPF dispatcher operace ukládání kontextu spuštění pro operace begin a obnovení předchozí kontext po dokončení operace.</span><span class="sxs-lookup"><span data-stu-id="a70d7-105">WPF dispatcher operations store the execution context used to begin the operation and restore the previous context when the operation is completed.</span></span> <span data-ttu-id="a70d7-106">Protože <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> a <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> jsou teď součástí daného kontextu, nejsou trvalé změny v rámci operace dispečer mimo provoz.</span><span class="sxs-lookup"><span data-stu-id="a70d7-106">Because <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> are now part of that context, changes to them within a dispatcher operation are not persisted outside of the operation.</span></span>|
|<span data-ttu-id="a70d7-107">Doporučení</span><span class="sxs-lookup"><span data-stu-id="a70d7-107">Suggestion</span></span>|<span data-ttu-id="a70d7-108">Touto změnou ovlivněny aplikace může obejít uložením požadovaný <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> nebo <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> v poli a vracet se změnami všechny operace těla dispečer (včetně obslužné rutiny zpětných volání události uživatelského rozhraní), který správné <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> a <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> jsou nastavené.</span><span class="sxs-lookup"><span data-stu-id="a70d7-108">Apps affected by this change may work around it by storing the desired <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> or <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> in a field and checking in all Dispatcher operation bodies (including UI event callback handlers) that the correct <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> are set.</span></span> <span data-ttu-id="a70d7-109">Případně protože kontextu ExecutionContext změnit základní tato WPF změna ovlivní pouze aplikace určené pro rozhraní .NET Framework 4.6 nebo novější, pomocí cílení na rozhraní .NET Framework 4.5.2.Apps, který cílit na .NET Framework 4.6 nebo novější můžete také pracovat se lze vyvarovat této přerušení vyřešit tak, že nastavíte následující kompatibility přepínače:</span><span class="sxs-lookup"><span data-stu-id="a70d7-109">Alternatively, because the ExecutionContext change underlying this WPF change only affects apps targeting the .NET Framework 4.6 or newer, this break can be avoided by targeting the .NET Framework 4.5.2.Apps that target .NET Framework 4.6 or later can also work around this by setting the following compatibility switch:</span></span><pre><code class="lang-csharp">AppContext.SetSwitch(&quot;Switch.System.Globalization.NoAsyncCurrentCulture&quot;, true);&#13;&#10;</code></pre><span data-ttu-id="a70d7-110">Tento problém byl vyřešen ve WPF v rozhraní .NET Framework 4.6.2.</span><span class="sxs-lookup"><span data-stu-id="a70d7-110">This issue has been fixed by WPF in .NET Framework 4.6.2.</span></span> <span data-ttu-id="a70d7-111">Také jsme opravili .NET Framework 4.6, 4.6.1 prostřednictvím [KB 3139549](https://support.microsoft.com/kb/3139549).</span><span class="sxs-lookup"><span data-stu-id="a70d7-111">It has also been fixed in .NET Frameworks 4.6, 4.6.1 through [KB 3139549](https://support.microsoft.com/kb/3139549).</span></span> <span data-ttu-id="a70d7-112">Aplikace cílené na rozhraní .NET Framework 4.6 nebo novější, automaticky získá správné chování v aplikaci WPF – <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> / <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name>) by zachovaná napříč operace dispečera.</span><span class="sxs-lookup"><span data-stu-id="a70d7-112">Applications targeting .NET Framework 4.6 or later will automatically get the right behavior in WPF applications - <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name>/<xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name>) would be preserved across Dispatcher operations.</span></span>|
|<span data-ttu-id="a70d7-113">Rozsah</span><span class="sxs-lookup"><span data-stu-id="a70d7-113">Scope</span></span>|<span data-ttu-id="a70d7-114">Vedlejší</span><span class="sxs-lookup"><span data-stu-id="a70d7-114">Minor</span></span>|
|<span data-ttu-id="a70d7-115">Version</span><span class="sxs-lookup"><span data-stu-id="a70d7-115">Version</span></span>|<span data-ttu-id="a70d7-116">4.6</span><span class="sxs-lookup"><span data-stu-id="a70d7-116">4.6</span></span>|
|<span data-ttu-id="a70d7-117">Typ</span><span class="sxs-lookup"><span data-stu-id="a70d7-117">Type</span></span>|<span data-ttu-id="a70d7-118">Změna cílení</span><span class="sxs-lookup"><span data-stu-id="a70d7-118">Retargeting</span></span>|

