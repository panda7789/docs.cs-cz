---
title: Nasazení aplikace eShopOnContainers do Azure
description: Nasazení aplikace eShopOnContainers pomocí služby Azure Kubernetes, Helm a DevSpaces.
ms.date: 04/20/2020
ms.openlocfilehash: a3eacedac946cb25cf3cced305d7921e29f0d204
ms.sourcegitcommit: 957c49696eaf048c284ef8f9f8ffeb562357ad95
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/07/2020
ms.locfileid: "82895585"
---
# <a name="deploying-eshoponcontainers-to-azure"></a><span data-ttu-id="257b1-103">Nasazení aplikace eShopOnContainers do Azure</span><span class="sxs-lookup"><span data-stu-id="257b1-103">Deploying eShopOnContainers to Azure</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="257b1-104">Aplikace eShopOnContainers se dá nasadit na celou řadu platforem Azure.</span><span class="sxs-lookup"><span data-stu-id="257b1-104">The eShopOnContainers application can be deployed to a variety of Azure platforms.</span></span> <span data-ttu-id="257b1-105">Doporučený postup je nasadit aplikaci do služby Azure Kubernetes Services (AKS).</span><span class="sxs-lookup"><span data-stu-id="257b1-105">The recommended approach is to deploy the application to Azure Kubernetes Services (AKS).</span></span> <span data-ttu-id="257b1-106">Helm, nástroj pro nasazení Kubernetes, je k dispozici, aby se snížila složitost nasazení.</span><span class="sxs-lookup"><span data-stu-id="257b1-106">Helm, a Kubernetes deployment tool, is available to reduce deployment complexity.</span></span> <span data-ttu-id="257b1-107">V případě potřeby můžou vývojáři implementovat Azure Dev Spaces pro Kubernetes, aby se zjednodušil proces vývoje.</span><span class="sxs-lookup"><span data-stu-id="257b1-107">Optionally, developers may implement Azure Dev Spaces for Kubernetes to streamline their development process.</span></span>

## <a name="azure-kubernetes-service"></a><span data-ttu-id="257b1-108">Azure Kubernetes Service</span><span class="sxs-lookup"><span data-stu-id="257b1-108">Azure Kubernetes Service</span></span>

<span data-ttu-id="257b1-109">Pro hostování eShop v AKS je prvním krokem vytvoření clusteru AKS.</span><span class="sxs-lookup"><span data-stu-id="257b1-109">To host eShop in AKS, the first step is to create an AKS cluster.</span></span> <span data-ttu-id="257b1-110">K tomu můžete použít Azure Portal, které vás provedou potřebnými kroky.</span><span class="sxs-lookup"><span data-stu-id="257b1-110">To do so, you might use the Azure portal, which will walk you through the required steps.</span></span> <span data-ttu-id="257b1-111">Můžete také vytvořit cluster z Azure CLI, přičemž se ujistěte, že jste povolili Access Control na základě rolí (RBAC) a směrování aplikací.</span><span class="sxs-lookup"><span data-stu-id="257b1-111">You could also create a cluster from the Azure CLI, taking care to enable Role-Based Access Control (RBAC) and application routing.</span></span> <span data-ttu-id="257b1-112">V dokumentaci k eShopOnContainers najdete postup vytvoření vlastního clusteru AKS.</span><span class="sxs-lookup"><span data-stu-id="257b1-112">The eShopOnContainers' documentation details the steps for creating your own AKS cluster.</span></span> <span data-ttu-id="257b1-113">Po vytvoření můžete cluster otevřít a spravovat pomocí řídicího panelu Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="257b1-113">Once created, you can access and manage the cluster from the Kubernetes dashboard.</span></span>

<span data-ttu-id="257b1-114">Aplikaci eShop teď můžete nasadit do clusteru s využitím Helm a.</span><span class="sxs-lookup"><span data-stu-id="257b1-114">You can now deploy the eShop application to the cluster leveraging Helm and Tiller.</span></span>

## <a name="deploying-to-azure-kubernetes-service-using-helm"></a><span data-ttu-id="257b1-115">Nasazení do služby Azure Kubernetes pomocí Helm</span><span class="sxs-lookup"><span data-stu-id="257b1-115">Deploying to Azure Kubernetes Service using Helm</span></span>

<span data-ttu-id="257b1-116">Helm je nástroj Správce balíčků aplikace, který pracuje přímo s Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="257b1-116">Helm is an application package manager tool that works directly with Kubernetes.</span></span> <span data-ttu-id="257b1-117">Pomůže vám definovat, instalovat a upgradovat Kubernetes aplikace.</span><span class="sxs-lookup"><span data-stu-id="257b1-117">It helps you define, install, and upgrade Kubernetes applications.</span></span> <span data-ttu-id="257b1-118">I když je možné jednoduché aplikace nasadit do AKS pomocí vlastních skriptů CLI nebo jednoduchých souborů nasazení, komplexní aplikace můžou obsahovat spoustu Kubernetes objektů a využívat výhod Helm.</span><span class="sxs-lookup"><span data-stu-id="257b1-118">While simple apps can be deployed to AKS with custom CLI scripts or simple deployment files, complex apps can contain many Kubernetes objects and benefit from Helm.</span></span>

<span data-ttu-id="257b1-119">Pomocí Helm aplikace zahrnují konfigurační soubory založené na textu s názvem Helm grafy, které deklarativně popisují aplikaci a konfiguraci v balíčcích Helm.</span><span class="sxs-lookup"><span data-stu-id="257b1-119">Using Helm, applications include text-based configuration files, called Helm charts, which declaratively describe the application and configuration in Helm packages.</span></span> <span data-ttu-id="257b1-120">Grafy používají standardní soubory ve formátu YAML k popisu související sady prostředků Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="257b1-120">Charts use standard YAML-formatted files to describe a related set of Kubernetes resources.</span></span> <span data-ttu-id="257b1-121">Jsou ve verzi spolu s kódem aplikace, které popisují.</span><span class="sxs-lookup"><span data-stu-id="257b1-121">They're versioned alongside the application code they describe.</span></span> <span data-ttu-id="257b1-122">Grafy Helm se od jednoduchých po složité v závislosti na požadavcích instalace, které popisují.</span><span class="sxs-lookup"><span data-stu-id="257b1-122">Helm Charts range from simple to complex depending on the requirements of the installation they describe.</span></span>

<span data-ttu-id="257b1-123">Helm se skládá z klientského nástroje příkazového řádku, který využívá grafy Helm a spouští příkazy pro serverovou komponentu s názvem, do které končí.</span><span class="sxs-lookup"><span data-stu-id="257b1-123">Helm is composed of a command-line client tool, which consumes helm charts and launches commands to a server component named, Tiller.</span></span> <span data-ttu-id="257b1-124">Do služby komunikuje s rozhraním API Kubernetes, aby bylo zajištěno správné zřizování vašich kontejnerových úloh.</span><span class="sxs-lookup"><span data-stu-id="257b1-124">Tiller communicates with the Kubernetes API to ensure the correct provisioning of your containerized workloads.</span></span> <span data-ttu-id="257b1-125">Helm je udržována v rámci platformy Cloud-Native Computing.</span><span class="sxs-lookup"><span data-stu-id="257b1-125">Helm is maintained by the Cloud-native Computing Foundation.</span></span>

<span data-ttu-id="257b1-126">Následující soubor YAML prezentuje šablonu Helm:</span><span class="sxs-lookup"><span data-stu-id="257b1-126">The following yaml file presents a Helm template:</span></span>

```yaml
apiVersion: v1
kind: Service
metadata:
  name: {{ .Values.app.svc.marketing }}
  labels:
    app: {{ template "marketing-api.name" . }}
    chart: {{ template "marketing-api.chart" . }}
    release: {{ .Release.Name }}
    heritage: {{ .Release.Service }}
spec:
  type: {{ .Values.service.type }}
  ports:
    - port: {{ .Values.service.port }}
      targetPort: http
      protocol: TCP
      name: http
  selector:
    app: {{ template "marketing-api.name" . }}
    release: {{ .Release.Name }}
```

<span data-ttu-id="257b1-127">Všimněte si, jak šablona popisuje dynamickou sadu párů klíč/hodnota.</span><span class="sxs-lookup"><span data-stu-id="257b1-127">Note how the template describes a dynamic set of key/value pairs.</span></span> <span data-ttu-id="257b1-128">Při vyvolání šablony jsou hodnoty, které jsou uzavřeny ve složených závorkách, načítány z jiných konfiguračních souborů založených na YAML.</span><span class="sxs-lookup"><span data-stu-id="257b1-128">When the template is invoked, values that enclosed in curly braces are pulled in from other yaml-based configuration files.</span></span>

<span data-ttu-id="257b1-129">Grafy eShopOnContainers Helm najdete ve složce/k8s/Helm.</span><span class="sxs-lookup"><span data-stu-id="257b1-129">You'll find the eShopOnContainers helm charts in the /k8s/helm folder.</span></span> <span data-ttu-id="257b1-130">Obrázek 2-6 ukazuje, jak jsou různé komponenty aplikace uspořádány do struktury složek, kterou používá Helm k definování a správě nasazení.</span><span class="sxs-lookup"><span data-stu-id="257b1-130">Figure 2-6 shows how the different components of the application are organized into a folder structure used by helm to define and managed deployments.</span></span>

<span data-ttu-id="257b1-131">![Obrázek architektury](./media/eshoponcontainers-helm-folder.png)
eShopOnContainers**2-6**.</span><span class="sxs-lookup"><span data-stu-id="257b1-131">![eShopOnContainers Architecture](./media/eshoponcontainers-helm-folder.png)
**Figure 2-6**.</span></span> <span data-ttu-id="257b1-132">Složka Helm eShopOnContainers</span><span class="sxs-lookup"><span data-stu-id="257b1-132">The eShopOnContainers helm folder.</span></span>

<span data-ttu-id="257b1-133">Jednotlivé komponenty se instalují pomocí `helm install` příkazu.</span><span class="sxs-lookup"><span data-stu-id="257b1-133">Each individual component is installed using a `helm install` command.</span></span> <span data-ttu-id="257b1-134">eShop obsahuje skript "nasadit vše", který projde a nainstaluje komponenty pomocí příslušných Helm grafů.</span><span class="sxs-lookup"><span data-stu-id="257b1-134">eShop includes a "deploy all" script that loops through and installs the components using their respective helm charts.</span></span> <span data-ttu-id="257b1-135">Výsledkem je opakovaný proces, ve kterém je verze aplikace ve správě zdrojového kódu, kterou může kdokoli v týmu nasadit do clusteru AKS s jedním řádkovým příkazem skriptu.</span><span class="sxs-lookup"><span data-stu-id="257b1-135">The result is a repeatable process, versioned with the application in source control, that anyone on the team can deploy to an AKS cluster with a one-line script command.</span></span>

> <span data-ttu-id="257b1-136">Všimněte si, že verze 3 nástroje Helm oficiálně odstraňuje nutnost serverové komponenty pro pokladnu.</span><span class="sxs-lookup"><span data-stu-id="257b1-136">Note that version 3 of Helm officially removes the need for the Tiller server component.</span></span> <span data-ttu-id="257b1-137">Další informace o tomto vylepšení najdete [tady](https://medium.com/better-programming/why-is-tiller-missing-in-helm-3-2347c446714).</span><span class="sxs-lookup"><span data-stu-id="257b1-137">More information on this enhancement can be found [here](https://medium.com/better-programming/why-is-tiller-missing-in-helm-3-2347c446714).</span></span>

## <a name="azure-dev-spaces"></a><span data-ttu-id="257b1-138">Azure Dev Spaces</span><span class="sxs-lookup"><span data-stu-id="257b1-138">Azure Dev Spaces</span></span>

<span data-ttu-id="257b1-139">Nativní aplikace pro Cloud můžou rychle rozšiřovat rozsáhlé a komplexní a vyžadují, aby se mohly spustit významné výpočetní prostředky.</span><span class="sxs-lookup"><span data-stu-id="257b1-139">Cloud-native applications can quickly grow large and complex, requiring significant compute resources to run.</span></span> <span data-ttu-id="257b1-140">V těchto scénářích nemůže být celá aplikace hostována na vývojovém počítači (zejména notebook).</span><span class="sxs-lookup"><span data-stu-id="257b1-140">In these scenarios, the entire application can't be hosted on a development machine (especially a laptop).</span></span> <span data-ttu-id="257b1-141">Azure Dev Spaces je navržený pro řešení tohoto problému pomocí AKS.</span><span class="sxs-lookup"><span data-stu-id="257b1-141">Azure Dev Spaces is designed to address this problem using AKS.</span></span> <span data-ttu-id="257b1-142">Umožňuje vývojářům pracovat s místní verzí svých služeb a současně hostovat zbytek aplikace v AKS vývojovém clusteru.</span><span class="sxs-lookup"><span data-stu-id="257b1-142">It enables developers to work with a local version of their services while hosting the rest of the application in an AKS development cluster.</span></span>

<span data-ttu-id="257b1-143">Vývojáři sdílejí běžící (vývojovou) instanci v clusteru AKS, který obsahuje celou kontejnerovou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="257b1-143">Developers share a running (development) instance in an AKS cluster that contains the entire containerized application.</span></span> <span data-ttu-id="257b1-144">Ale používají osobní prostory nastavené na svém počítači k místnímu vývoji svých služeb.</span><span class="sxs-lookup"><span data-stu-id="257b1-144">But they use personal spaces set up on their machine to locally develop their services.</span></span> <span data-ttu-id="257b1-145">Po dokončení se otestuje z konce na konec v clusteru AKS – bez závislostí replikace.</span><span class="sxs-lookup"><span data-stu-id="257b1-145">When ready, they test from end-to-end in the AKS cluster - without replicating dependencies.</span></span> <span data-ttu-id="257b1-146">Azure Dev Spaces sloučí kód z místního počítače se službami v AKS.</span><span class="sxs-lookup"><span data-stu-id="257b1-146">Azure Dev Spaces merges code from the local machine with services in AKS.</span></span> <span data-ttu-id="257b1-147">Členové týmu mohou vidět, jak se změny budou chovat ve skutečném prostředí AKS.</span><span class="sxs-lookup"><span data-stu-id="257b1-147">Team members can see how their changes will behave in a real AKS environment.</span></span> <span data-ttu-id="257b1-148">Vývojáři můžou rychle iterovat a ladit kód přímo v Kubernetes pomocí sady Visual Studio 2017 nebo Visual Studio Code.</span><span class="sxs-lookup"><span data-stu-id="257b1-148">Developers can rapidly iterate and debug code directly in Kubernetes using Visual Studio 2017 or Visual Studio Code.</span></span>

<span data-ttu-id="257b1-149">Na obrázku 2-7 vidíte, že vývojář Susie nasadil aktualizovanou verzi mikroslužby bicyklů do svého vývojového prostoru.</span><span class="sxs-lookup"><span data-stu-id="257b1-149">In Figure 2-7, you can see that Developer Susie has deployed an updated version of the Bikes microservice into her dev space.</span></span> <span data-ttu-id="257b1-150">Potom je možné otestovat své změny pomocí vlastní adresy URL začínající názvem jejího místa (susie.s.dev.myapp.eus.azds.io).</span><span class="sxs-lookup"><span data-stu-id="257b1-150">She's then able to test her changes using a custom URL starting with the name of her space (susie.s.dev.myapp.eus.azds.io).</span></span>

<span data-ttu-id="257b1-151">![Obrázek architektury](./media/azure-devspaces-one.png)
eShopOnContainers**2-7**.</span><span class="sxs-lookup"><span data-stu-id="257b1-151">![eShopOnContainers Architecture](./media/azure-devspaces-one.png)
**Figure 2-7**.</span></span> <span data-ttu-id="257b1-152">Vývojář Susie nasadí svoji vlastní verzi mikroslužby bicyklů a otestuje ji.</span><span class="sxs-lookup"><span data-stu-id="257b1-152">Developer Susie deploys her own version of the Bikes microservice and tests it.</span></span>

<span data-ttu-id="257b1-153">V současné době vývojář Jan přizpůsobuje mikroslužbu rezervací a potřebuje testovat své změny.</span><span class="sxs-lookup"><span data-stu-id="257b1-153">At the same time, developer John is customizing the Reservations microservice and needs to test his changes.</span></span> <span data-ttu-id="257b1-154">Nasadí své změny do vlastního prostoru pro vývoj bez konfliktu se změnami Susie, jak je znázorněno na obrázku 2-8.</span><span class="sxs-lookup"><span data-stu-id="257b1-154">He deploys his changes to his own dev space without conflicting with Susie's changes as shown in Figure 2-8.</span></span> <span data-ttu-id="257b1-155">Jan potom testuje změny pomocí vlastní adresy URL, která má předponu s názvem svého místa (john.s.dev.myapp.eus.azds.io).</span><span class="sxs-lookup"><span data-stu-id="257b1-155">John then tests his changes using his own URL that is prefixed with the name of his space (john.s.dev.myapp.eus.azds.io).</span></span>

<span data-ttu-id="257b1-156">![Obrázek architektury](./media/azure-devspaces-two.png)
eShopOnContainers**2-8**.</span><span class="sxs-lookup"><span data-stu-id="257b1-156">![eShopOnContainers Architecture](./media/azure-devspaces-two.png)
**Figure 2-8**.</span></span> <span data-ttu-id="257b1-157">Vývojář Jan nasadí svoji vlastní verzi mikroslužby rezervací a otestuje ji bez konfliktu s ostatními vývojáři.</span><span class="sxs-lookup"><span data-stu-id="257b1-157">Developer John deploys his own version of the Reservations microservice and tests it without conflicting with other developers.</span></span>

<span data-ttu-id="257b1-158">Pomocí Azure Dev Spaces můžou týmy pracovat přímo se AKS a přitom nezávisle měnit, nasazovat a testovat jejich změny.</span><span class="sxs-lookup"><span data-stu-id="257b1-158">Using Azure Dev Spaces, teams can work directly with AKS while independently changing, deploying, and testing their changes.</span></span> <span data-ttu-id="257b1-159">Tento přístup omezuje nutnost samostatných vyhrazených hostovaných prostředí, protože každý vývojář efektivně má své vlastní prostředí AKS.</span><span class="sxs-lookup"><span data-stu-id="257b1-159">This approach reduces the need for separate dedicated hosted environments since every developer effectively has their own AKS environment.</span></span> <span data-ttu-id="257b1-160">Vývojáři mohou pracovat s Azure Dev Spaces pomocí svého rozhraní příkazového řádku nebo spustit aplikaci pro Azure Dev Spaces přímo ze sady Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="257b1-160">Developers can work with Azure Dev Spaces using its CLI or launch their application to Azure Dev Spaces directly from Visual Studio.</span></span> [<span data-ttu-id="257b1-161">Přečtěte si další informace o tom, jak Azure Dev Spaces fungují a jsou nakonfigurované.</span><span class="sxs-lookup"><span data-stu-id="257b1-161">Learn more about how Azure Dev Spaces works and is configured.</span></span>](https://docs.microsoft.com/azure/dev-spaces/how-dev-spaces-works)

## <a name="azure-functions-and-logic-apps-serverless"></a><span data-ttu-id="257b1-162">Azure Functions a Logic Apps (bez serveru)</span><span class="sxs-lookup"><span data-stu-id="257b1-162">Azure Functions and Logic Apps (Serverless)</span></span>

<span data-ttu-id="257b1-163">Ukázka eShopOnContainers zahrnuje podporu pro sledování online marketingových kampaní.</span><span class="sxs-lookup"><span data-stu-id="257b1-163">The eShopOnContainers sample includes support for tracking online marketing campaigns.</span></span> <span data-ttu-id="257b1-164">Funkce Azure se používá ke sledování podrobností marketingové kampaně pro dané ID kampaně.</span><span class="sxs-lookup"><span data-stu-id="257b1-164">An Azure Function is used to track marketing campaign details for a given campaign ID.</span></span> <span data-ttu-id="257b1-165">Místo vytváření úplné mikroslužeb je jedna funkce Azure jednodušší a dostatečná.</span><span class="sxs-lookup"><span data-stu-id="257b1-165">Rather than creating a full microservice, a single Azure Function is simpler and sufficient.</span></span> <span data-ttu-id="257b1-166">Azure Functions mají jednoduchý model sestavení a nasazení, zejména v případě, že je nakonfigurován tak, aby běžel v Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="257b1-166">Azure Functions have a simple build and deployment model, especially when configured to run in Kubernetes.</span></span> <span data-ttu-id="257b1-167">Nasazení funkce se skriptuje pomocí šablon Azure Resource Manager (ARM) a rozhraní příkazového řádku Azure CLI.</span><span class="sxs-lookup"><span data-stu-id="257b1-167">Deploying the function is scripted using Azure Resource Manager (ARM) templates and the Azure CLI.</span></span> <span data-ttu-id="257b1-168">Tato služba kampaně není zaměřená na zákazníka a vyvolává jednu operaci, což je skvělým kandidátem na Azure Functions.</span><span class="sxs-lookup"><span data-stu-id="257b1-168">This campaign service isn't customer-facing and invokes a single operation, making it a great candidate for Azure Functions.</span></span> <span data-ttu-id="257b1-169">Tato funkce vyžaduje minimální konfiguraci, včetně dat připojovacího řetězce databáze a nastavení Image základního identifikátoru URI.</span><span class="sxs-lookup"><span data-stu-id="257b1-169">The function requires minimal configuration, including a database connection string data and image base URI settings.</span></span> <span data-ttu-id="257b1-170">Azure Functions můžete nakonfigurovat v Azure Portal.</span><span class="sxs-lookup"><span data-stu-id="257b1-170">You configure Azure Functions in the Azure portal.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="257b1-171">[Předchozí](map-eshoponcontainers-azure-services.md)
>[Další](centralized-configuration.md)</span><span class="sxs-lookup"><span data-stu-id="257b1-171">[Previous](map-eshoponcontainers-azure-services.md)
[Next](centralized-configuration.md)</span></span>
