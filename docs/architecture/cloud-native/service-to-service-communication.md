---
title: Komunikace mezi službami
description: Přečtěte si, jak cloudové mikroslužby back-end komunikují s ostatními back-end mikroslužbami.
author: robvet
ms.date: 09/09/2019
ms.openlocfilehash: 556617a9e2df5a4d9ff9adb9d19e714ca94930ea
ms.sourcegitcommit: 957c49696eaf048c284ef8f9f8ffeb562357ad95
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/07/2020
ms.locfileid: "82895497"
---
# <a name="service-to-service-communication"></a><span data-ttu-id="1a2d8-103">Komunikace mezi službami</span><span class="sxs-lookup"><span data-stu-id="1a2d8-103">Service-to-service communication</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="1a2d8-104">Při přesunu z front-endu klienta se teď řeší i back-endové mikroslužby navzájem.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-104">Moving from the front-end client, we now address back-end microservices communicate with each other.</span></span>

<span data-ttu-id="1a2d8-105">Při sestavování nativních cloudových aplikací budete chtít být citlivé na to, jak se vzájemně komunikují služby back-end.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-105">When constructing a cloud-native application, you'll want to be sensitive to how back-end services communicate with each other.</span></span> <span data-ttu-id="1a2d8-106">V ideálním případě je to lepší komunikace mezi službami.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-106">Ideally, the less inter-service communication, the better.</span></span> <span data-ttu-id="1a2d8-107">Vyhnutí se ale není vždycky možné, protože back-endové služby se často vzájemně spoléhá na to, že se operace dokončí.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-107">However, avoidance isn't always possible as back-end services often rely on one another to complete an operation.</span></span>

<span data-ttu-id="1a2d8-108">K implementaci komunikace mezi službami je k dispozici několik široce přijatelných přístupů.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-108">There are several widely accepted approaches to implementing cross-service communication.</span></span> <span data-ttu-id="1a2d8-109">*Typ interakce komunikace* bude často určovat nejlepší přístup.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-109">The *type of communication interaction* will often determine the best approach.</span></span>

<span data-ttu-id="1a2d8-110">Vezměte v úvahu následující typy interakcí:</span><span class="sxs-lookup"><span data-stu-id="1a2d8-110">Consider the following interaction types:</span></span>

- <span data-ttu-id="1a2d8-111">*Dotaz* – Pokud volající mikroslužba vyžaduje odpověď od pojmenované mikroslužby, například "Hey", sdělte mi informace nákupčího pro dané ID zákazníka. "</span><span class="sxs-lookup"><span data-stu-id="1a2d8-111">*Query* – when a calling microservice requires a response from a called microservice, such as, "Hey, give me the buyer information for a given customer Id."</span></span>

- <span data-ttu-id="1a2d8-112">*Příkaz* – když volající mikroslužba potřebuje k provedení akce jinou mikroslužbu, ale nevyžaduje odpověď, například "Hey", stačí dodávat tuto objednávku. "</span><span class="sxs-lookup"><span data-stu-id="1a2d8-112">*Command* – when the calling microservice needs another microservice to execute an action but doesn't require a response, such as, "Hey, just ship this order."</span></span>

- <span data-ttu-id="1a2d8-113">*Událost* – když mikroslužba, která se nazývá Vydavatel, vyvolá událost, u které došlo ke změně stavu nebo k akci.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-113">*Event* – when a microservice, called the publisher, raises an event that state has changed or an action has occurred.</span></span> <span data-ttu-id="1a2d8-114">Ostatní mikroslužby nazývané předplatitelé, kteří se zajímají, mohou reagovat na událost odpovídajícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-114">Other microservices, called subscribers, who are interested, can react to the event appropriately.</span></span> <span data-ttu-id="1a2d8-115">Vydavatel a předplatitelé si je vzájemně nevědí.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-115">The publisher and the subscribers aren't aware of each other.</span></span>

<span data-ttu-id="1a2d8-116">Systémy mikroslužeb obvykle používají kombinaci těchto typů interakcí při provádění operací, které vyžadují interakci mezi službami.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-116">Microservice systems typically use a combination of these interaction types when executing operations that require cross-service interaction.</span></span> <span data-ttu-id="1a2d8-117">Pojďme se podívat na každý a jak je můžete implementovat.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-117">Let's take a close look at each and how you might implement them.</span></span>

## <a name="queries"></a><span data-ttu-id="1a2d8-118">Dotazy</span><span class="sxs-lookup"><span data-stu-id="1a2d8-118">Queries</span></span>

<span data-ttu-id="1a2d8-119">V mnoha případech může být potřeba, aby jedna mikroslužba mohla zadat *dotaz* na jinou a vyžadovat okamžitou reakci na dokončení operace.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-119">Many times, one microservice might need to *query* another, requiring an immediate response to complete an operation.</span></span> <span data-ttu-id="1a2d8-120">Mikroslužba nákupního košíku může potřebovat informace o produktu a cenu za přidání položky do košíku.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-120">A shopping basket microservice may need product information and a price to add an item to its basket.</span></span> <span data-ttu-id="1a2d8-121">Pro implementaci operací dotazů je k dispozici několik přístupů.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-121">There are a number of approaches for implementing query operations.</span></span>

### <a name="requestresponse-messaging"></a><span data-ttu-id="1a2d8-122">Zasílání zpráv o požadavcích a odpovědích</span><span class="sxs-lookup"><span data-stu-id="1a2d8-122">Request/Response Messaging</span></span>

<span data-ttu-id="1a2d8-123">Jednou z možností implementace tohoto scénáře je pro volající back-end mikroslužba, která umožňuje přímé požadavky HTTP na mikroslužby, které potřebuje k dotazování, zobrazené na obrázku 4-8.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-123">One option for implementing this scenario is for the calling back-end microservice to make direct HTTP requests to the microservices it needs to query, shown in Figure 4-8.</span></span>

![Přímá komunikace HTTP](./media/direct-http-communication.png)

<span data-ttu-id="1a2d8-125">**Obrázek 4-8**.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-125">**Figure 4-8**.</span></span> <span data-ttu-id="1a2d8-126">Přímá komunikace HTTP</span><span class="sxs-lookup"><span data-stu-id="1a2d8-126">Direct HTTP communication</span></span>

<span data-ttu-id="1a2d8-127">I když Přímá volání HTTP mezi mikroslužbami jsou relativně jednoduchá na implementaci, měli byste dbát na to, aby se tento postup minimalizoval.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-127">While direct HTTP calls between microservices are relatively simple to implement, care should be taken to minimize this practice.</span></span> <span data-ttu-id="1a2d8-128">Pro spuštění jsou tato volání vždy *synchronní* a zablokují operaci, dokud není vrácen výsledek nebo dokud nevyprší časový limit požadavku.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-128">To start, these calls are always *synchronous* and will block the operation until a result is returned or the request times outs.</span></span> <span data-ttu-id="1a2d8-129">Jak byly samostatné, nezávislé služby, schopné vyvíjet nezávisle a často je nasazovat, teď se vzájemně navzájem vzájemně nasazují.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-129">What were once self-contained, independent services, able to evolve independently and deploy frequently, now become coupled to each other.</span></span> <span data-ttu-id="1a2d8-130">V rámci zvyšování vzájemného propojení mezi mikroslužby se snižuje přínos jejich architektury.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-130">As coupling among microservices increase, their architectural benefits diminish.</span></span>

<span data-ttu-id="1a2d8-131">Spuštění nečasté žádosti, která umožňuje jedno přímé volání HTTP do jiné mikroslužby, může být pro některé systémy přijatelné.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-131">Executing an infrequent request that makes a single direct HTTP call to another microservice might be acceptable for some systems.</span></span> <span data-ttu-id="1a2d8-132">Volání s vysokým objemem, která vyvolávají Přímá volání HTTP na více mikroslužeb, se však nedoporučuje.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-132">However, high-volume calls that invoke direct HTTP calls to multiple microservices aren't advisable.</span></span> <span data-ttu-id="1a2d8-133">Můžou zvýšit latenci a negativně ovlivnit výkon, škálovatelnost a dostupnost vašeho systému.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-133">They can increase latency and negatively impact the performance, scalability, and availability of your system.</span></span> <span data-ttu-id="1a2d8-134">I horší, dlouhé série přímých komunikací HTTP může vést k podrobným a složitým řetězům synchronních volání mikroslužeb, které jsou znázorněné na obrázku 4-9:</span><span class="sxs-lookup"><span data-stu-id="1a2d8-134">Even worse, a long series of direct HTTP communication can lead to deep and complex chains of synchronous microservices calls, shown in Figure 4-9:</span></span>

![Řetězení dotazů HTTP](./media/chaining-http-queries.png)

<span data-ttu-id="1a2d8-136">**Obrázek 4-9**.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-136">**Figure 4-9**.</span></span> <span data-ttu-id="1a2d8-137">Řetězení dotazů HTTP</span><span class="sxs-lookup"><span data-stu-id="1a2d8-137">Chaining HTTP queries</span></span>

<span data-ttu-id="1a2d8-138">V návrhu zobrazeném na předchozím obrázku si můžete představit riziko.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-138">You can certainly imagine the risk in the design shown in the previous image.</span></span> <span data-ttu-id="1a2d8-139">Co se stane, \#když krok 3 selhává?</span><span class="sxs-lookup"><span data-stu-id="1a2d8-139">What happens if Step \#3 fails?</span></span> <span data-ttu-id="1a2d8-140">Nebo se \#krok 8 nezdařil?</span><span class="sxs-lookup"><span data-stu-id="1a2d8-140">Or Step \#8 fails?</span></span> <span data-ttu-id="1a2d8-141">Jak obnovovat?</span><span class="sxs-lookup"><span data-stu-id="1a2d8-141">How do you recover?</span></span> <span data-ttu-id="1a2d8-142">Co když je \#krok 6 pomalý, protože podkladová služba je zaneprázdněná?</span><span class="sxs-lookup"><span data-stu-id="1a2d8-142">What if Step \#6 is slow because the underlying service is busy?</span></span> <span data-ttu-id="1a2d8-143">Jak budete pokračovat?</span><span class="sxs-lookup"><span data-stu-id="1a2d8-143">How do you continue?</span></span> <span data-ttu-id="1a2d8-144">I když vše funguje správně, zamyslete se nad latencí tohoto volání, což je součet latence každého kroku.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-144">Even if all works correctly, think of the latency this call would incur, which is the sum of the latency of each step.</span></span>

<span data-ttu-id="1a2d8-145">Velký stupeň spojení na předchozím obrázku naznačuje, že služby nebyly optimálně modelovány.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-145">The large degree of coupling in the previous image suggests the services weren't optimally modeled.</span></span> <span data-ttu-id="1a2d8-146">To by behoove týmu, aby znovu navštívilo svůj návrh.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-146">It would behoove the team to revisit their design.</span></span>

### <a name="materialized-view-pattern"></a><span data-ttu-id="1a2d8-147">Model materializovaného zobrazení</span><span class="sxs-lookup"><span data-stu-id="1a2d8-147">Materialized View pattern</span></span>

<span data-ttu-id="1a2d8-148">Oblíbenou možností pro odebrání spojení s mikroslužbami je [model materializované zobrazení](https://docs.microsoft.com/azure/architecture/patterns/materialized-view).</span><span class="sxs-lookup"><span data-stu-id="1a2d8-148">A popular option for removing microservice coupling is the [Materialized View pattern](https://docs.microsoft.com/azure/architecture/patterns/materialized-view).</span></span> <span data-ttu-id="1a2d8-149">S tímto modelem mikroslužba ukládá svou vlastní místní, denormalizovanou kopii dat, která vlastní jiné služby.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-149">With this pattern, a microservice stores its own local, denormalized copy of data that's owned by other services.</span></span> <span data-ttu-id="1a2d8-150">Místo nákupního košíku, který se dotazuje na službu Katalog produktů a cenové služby, zachovává svou vlastní místní kopii těchto dat.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-150">Instead of the Shopping Basket microservice querying the Product Catalog and Pricing microservices, it maintains its own local copy of that data.</span></span> <span data-ttu-id="1a2d8-151">Tento model eliminuje zbytečné spojení a zlepšuje spolehlivost a dobu odezvy.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-151">This pattern eliminates unnecessary coupling and improves reliability and response time.</span></span> <span data-ttu-id="1a2d8-152">Celá operace se provádí uvnitř jednoho procesu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-152">The entire operation executes inside a single process.</span></span> <span data-ttu-id="1a2d8-153">Zkoumáme tento model a další otázky k datům v kapitole 5.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-153">We explore this pattern and other data concerns in Chapter 5.</span></span>

### <a name="service-aggregator-pattern"></a><span data-ttu-id="1a2d8-154">Model Agregátoru služby</span><span class="sxs-lookup"><span data-stu-id="1a2d8-154">Service Aggregator Pattern</span></span>

<span data-ttu-id="1a2d8-155">Další možností pro odstranění spojení mikroslužeb proti mikroslužbám je [agregátorová mikroslužba](https://devblogs.microsoft.com/cesardelatorre/designing-and-implementing-api-gateways-with-ocelot-in-a-microservices-and-container-based-architecture/), která je znázorněná fialově na obrázku 4-10.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-155">Another option for eliminating microservice-to-microservice coupling is an [Aggregator microservice](https://devblogs.microsoft.com/cesardelatorre/designing-and-implementing-api-gateways-with-ocelot-in-a-microservices-and-container-based-architecture/), shown in purple in Figure 4-10.</span></span>

![Služba Agregátoru](./media/aggregator-service.png)

<span data-ttu-id="1a2d8-157">**Obrázek 4-10**.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-157">**Figure 4-10**.</span></span> <span data-ttu-id="1a2d8-158">Mikroslužba Agregátoru</span><span class="sxs-lookup"><span data-stu-id="1a2d8-158">Aggregator microservice</span></span>

<span data-ttu-id="1a2d8-159">Vzorek izoluje operaci, která umožňuje volat více back-endové mikroslužby a soustřeďuje logiku do specializované mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-159">The pattern isolates an operation that makes calls to multiple back-end microservices, centralizing its logic into a specialized microservice.</span></span>  <span data-ttu-id="1a2d8-160">Mikroslužba Agregátoru pro fialovou rezervaci na předchozím obrázku orchestruje pracovní postup pro operaci rezervace.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-160">The purple checkout aggregator microservice in the previous figure orchestrates the workflow for the Checkout operation.</span></span> <span data-ttu-id="1a2d8-161">Zahrnuje volání několika mikroslužeb back-end v pořadí podle pořadí.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-161">It includes calls to several back-end microservices in a sequenced order.</span></span> <span data-ttu-id="1a2d8-162">Data z pracovního postupu se agreguje a vrátí volajícímu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-162">Data from the workflow is aggregated and returned to the caller.</span></span> <span data-ttu-id="1a2d8-163">I když stále implementuje Přímá volání HTTP, omezuje mikroslužba Agregátoru přímé závislosti mezi back-endové mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-163">While it still implements direct HTTP calls, the aggregator microservice reduces direct dependencies among back-end microservices.</span></span>

### <a name="requestreply-pattern"></a><span data-ttu-id="1a2d8-164">Vzor požadavků a odpovědí</span><span class="sxs-lookup"><span data-stu-id="1a2d8-164">Request/Reply Pattern</span></span>

<span data-ttu-id="1a2d8-165">Dalším přístupem k odkládání synchronních zpráv HTTP je [vzor požadavku na odpověď](https://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html), který používá komunikaci pomocí fronty.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-165">Another approach for decoupling synchronous HTTP messages is a [Request-Reply Pattern](https://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html), which uses queuing communication.</span></span> <span data-ttu-id="1a2d8-166">Komunikace pomocí fronty je vždy jednosměrovým kanálem a producent posílá zprávu a příjemce obdrží.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-166">Communication using a queue is always a one-way channel, with a producer sending the message and consumer receiving it.</span></span> <span data-ttu-id="1a2d8-167">V tomto modelu jsou implementovány fronty požadavků i fronta odpovědí, zobrazené na obrázku 4-11.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-167">With this pattern, both a request queue and response queue are implemented, shown in Figure 4-11.</span></span>

![Vzor požadavku a odpovědi](./media/request-reply-pattern.png)

<span data-ttu-id="1a2d8-169">**Obrázek 4-11**.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-169">**Figure 4-11**.</span></span> <span data-ttu-id="1a2d8-170">Vzor požadavku a odpovědi</span><span class="sxs-lookup"><span data-stu-id="1a2d8-170">Request-reply pattern</span></span>

<span data-ttu-id="1a2d8-171">V tomto případě producent zprávy vytvoří zprávu založenou na dotazech, která obsahuje jedinečné ID korelace, a umístí ji do fronty požadavků.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-171">Here, the message producer creates a query-based message that contains a unique correlation ID and places it into a request queue.</span></span> <span data-ttu-id="1a2d8-172">Nenáročná služba vyřadí zprávy do fronty, zpracuje je a umístí odpověď do fronty odpovědí se stejným ID korelace.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-172">The consuming service dequeues the messages, processes it and places the response into the response queue with the same correlation ID.</span></span> <span data-ttu-id="1a2d8-173">Služba producenta vyřadí zprávu, porovná ji s ID korelace a pokračuje ve zpracování.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-173">The producer service dequeues the message, matches it with the correlation ID and continues processing.</span></span> <span data-ttu-id="1a2d8-174">Fronty podrobněji pokrýváme v další části.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-174">We cover queues in detail in the next section.</span></span>

## <a name="commands"></a><span data-ttu-id="1a2d8-175">Příkazy</span><span class="sxs-lookup"><span data-stu-id="1a2d8-175">Commands</span></span>

<span data-ttu-id="1a2d8-176">Dalším typem interakce komunikace je *příkaz*.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-176">Another type of communication interaction is a *command*.</span></span> <span data-ttu-id="1a2d8-177">Mikroslužba může pro provedení akce potřebovat jinou mikroslužbu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-177">A microservice may need another microservice to perform an action.</span></span> <span data-ttu-id="1a2d8-178">Mikroslužba objednávání možná potřebuje, aby mikroslužba expedice vytvořila dodávku pro schválenou objednávku.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-178">The Ordering microservice may need the Shipping microservice to create a shipment for an approved order.</span></span> <span data-ttu-id="1a2d8-179">Na obrázku 4-12 jedna mikroslužba, označovaná jako producent, pošle zprávu jiné mikroslužbě, příjemce a provede to.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-179">In Figure 4-12, one microservice, called a Producer, sends a message to another microservice, the Consumer, commanding it to do something.</span></span>

![Interakce příkazů s frontou](./media/command-interaction-with-queue.png)

<span data-ttu-id="1a2d8-181">**Obrázek 4-12**.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-181">**Figure 4-12**.</span></span> <span data-ttu-id="1a2d8-182">Interakce příkazů s frontou</span><span class="sxs-lookup"><span data-stu-id="1a2d8-182">Command interaction with a queue</span></span>

<span data-ttu-id="1a2d8-183">Ve většině případů producent nevyžaduje odpověď a zprávu může spustit *a zapomenout* .</span><span class="sxs-lookup"><span data-stu-id="1a2d8-183">Most often, the Producer doesn't require a response and can *fire-and-forget* the message.</span></span> <span data-ttu-id="1a2d8-184">Pokud je vyžadována odpověď, příjemce pošle samostatnou zprávu zpět producentovi na jiném kanálu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-184">If a reply is needed, the Consumer sends a separate message back to Producer on another channel.</span></span> <span data-ttu-id="1a2d8-185">Zpráva příkazu se nejlépe odesílá asynchronně s frontou zpráv.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-185">A command message is best sent asynchronously with a message queue.</span></span> <span data-ttu-id="1a2d8-186">podporováno nezjednodušeným zprostředkovatelem zpráv.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-186">supported by a lightweight message broker.</span></span> <span data-ttu-id="1a2d8-187">V předchozím diagramu si všimněte, jak fronta odděluje a odděluje obě služby.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-187">In the previous diagram, note how a queue separates and decouples both services.</span></span>

<span data-ttu-id="1a2d8-188">Fronta zpráv je zprostředkující konstrukce, přes kterou producent a příjemce docházejí zprávu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-188">A message queue is an intermediary construct through which a producer and consumer pass a message.</span></span> <span data-ttu-id="1a2d8-189">Fronty implementují asynchronní model zasílání zpráv typu Point-to-Point.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-189">Queues implement an asynchronous, point-to-point messaging pattern.</span></span> <span data-ttu-id="1a2d8-190">Výrobce ví, kde je třeba odeslat a správně směrovat příkazy.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-190">The Producer knows where a command needs to be sent and routes appropriately.</span></span> <span data-ttu-id="1a2d8-191">Ve frontě je zaručeno, že zpráva je zpracována přes právě jednu z instancí spotřebitele, která je čtena z kanálu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-191">The queue guarantees that a message is processed by exactly one of the consumer instances that are reading from the channel.</span></span> <span data-ttu-id="1a2d8-192">V tomto scénáři může producent nebo služba příjemce škálovat horizontální navýšení kapacity, aniž by to mělo vliv na ostatní.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-192">In this scenario, either the producer or consumer service can scale out without affecting the other.</span></span> <span data-ttu-id="1a2d8-193">I ty technologie můžou být různorodé na každé straně, což znamená, že mikroslužba Java může volat mikroslužbu [golang](https://golang.org) .</span><span class="sxs-lookup"><span data-stu-id="1a2d8-193">As well, technologies can be disparate on each side, meaning that we might have a Java microservice calling a [Golang](https://golang.org) microservice.</span></span>

<span data-ttu-id="1a2d8-194">V kapitole 1 se mluvili o *službách zálohování*.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-194">In chapter 1, we talked about *backing services*.</span></span> <span data-ttu-id="1a2d8-195">Záložní služby jsou pomocné prostředky, na kterých jsou závislé nativní systémy cloudu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-195">Backing services are ancillary resources upon which cloud-native systems depend.</span></span> <span data-ttu-id="1a2d8-196">Fronty zpráv jsou zálohovací služby.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-196">Message queues are backing services.</span></span> <span data-ttu-id="1a2d8-197">Cloud Azure podporuje dva typy front zpráv, které můžou vaše cloudové nativní systémy využívat k implementaci zasílání zpráv příkazem: Azure Storage front a Azure Service Bus front.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-197">The Azure cloud supports two types of message queues that your cloud-native systems can consume to implement command messaging: Azure Storage Queues and Azure Service Bus Queues.</span></span>

### <a name="azure-storage-queues"></a><span data-ttu-id="1a2d8-198">Fronty Azure Storage</span><span class="sxs-lookup"><span data-stu-id="1a2d8-198">Azure Storage Queues</span></span>

<span data-ttu-id="1a2d8-199">Fronty Azure Storage nabízejí jednoduchou infrastrukturu ve frontě, která je rychlá, cenově a zálohovaná pomocí účtů úložiště Azure.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-199">Azure storage queues offer a simple queueing infrastructure that is fast, affordable, and backed by Azure storage accounts.</span></span>

<span data-ttu-id="1a2d8-200">[Fronty Azure Storage se zařadí do fronty](https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction) založené na REST pomocí spolehlivého a trvalého zasílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-200">[Azure Storage Queues](https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction) feature a REST-based queuing mechanism with reliable and persistent messaging.</span></span> <span data-ttu-id="1a2d8-201">Poskytují minimální sadu funkcí, ale jsou levné a můžou ukládat miliony zpráv.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-201">They provide a minimal feature set, but are inexpensive and store millions of messages.</span></span> <span data-ttu-id="1a2d8-202">Rozsah jejich kapacity je až 500 TB.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-202">Their capacity ranges up to 500 TB.</span></span> <span data-ttu-id="1a2d8-203">Jedna zpráva může mít velikost až 64 KB.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-203">A single message can be up to 64 KB in size.</span></span>

<span data-ttu-id="1a2d8-204">Prostřednictvím ověřených volání přes protokol HTTP nebo HTTPS máte přístup k zprávám odkudkoli na světě.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-204">You can access messages from anywhere in the world via authenticated calls using HTTP or HTTPS.</span></span> <span data-ttu-id="1a2d8-205">Fronty úložiště můžou škálovat na velké počty souběžných klientů a zpracovávat špičky provozu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-205">Storage queues can scale out to large numbers of concurrent clients to handle traffic spikes.</span></span>

<span data-ttu-id="1a2d8-206">Tato služba má omezení ke službě:</span><span class="sxs-lookup"><span data-stu-id="1a2d8-206">That said, there are limitations with the service:</span></span>

- <span data-ttu-id="1a2d8-207">Není zaručeno pořadí zpráv.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-207">Message order isn't guaranteed.</span></span>

- <span data-ttu-id="1a2d8-208">Zpráva může být zachována po dobu sedmi dní, než bude automaticky odebrána.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-208">A message can only persist for seven days before it's automatically removed.</span></span>

- <span data-ttu-id="1a2d8-209">Podpora správy stavů, duplicit duplicit nebo transakcí není k dispozici.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-209">Support for state management, duplicate detection, or transactions isn't available.</span></span>

<span data-ttu-id="1a2d8-210">Obrázek 4-13 ukazuje hierarchii Azure Storage fronty.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-210">Figure 4-13 shows the hierarchy of an Azure Storage Queue.</span></span>

![Hierarchie fronty úložiště](./media/storage-queue-hierarchy.png)

<span data-ttu-id="1a2d8-212">**Obrázek 4-13**.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-212">**Figure 4-13**.</span></span> <span data-ttu-id="1a2d8-213">Hierarchie fronty úložiště</span><span class="sxs-lookup"><span data-stu-id="1a2d8-213">Storage queue hierarchy</span></span>

<span data-ttu-id="1a2d8-214">Na předchozím obrázku si všimněte, jak fronty úložiště ukládají své zprávy v podkladovém účtu Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-214">In the previous figure, note how storage queues store their messages in the underlying Azure Storage account.</span></span>

<span data-ttu-id="1a2d8-215">Pro vývojáře nabízí Microsoft několik klientských a serverových knihoven pro zpracování fronty úložiště.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-215">For developers, Microsoft provides several client and server-side libraries for Storage queue processing.</span></span> <span data-ttu-id="1a2d8-216">Většina hlavních platforem je podporovaná, včetně .NET, Java, JavaScriptu, Ruby, Pythonu a přechodu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-216">Most major platforms are supported including .NET, Java, JavaScript, Ruby, Python, and Go.</span></span> <span data-ttu-id="1a2d8-217">Vývojáři by nikdy neměli komunikovat přímo s těmito knihovnami.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-217">Developers should never communicate directly with these libraries.</span></span> <span data-ttu-id="1a2d8-218">Provedete to tak, že kód mikroslužby pevně propojíte s Azure Storage Služba front.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-218">Doing so will tightly couple your microservice code to the Azure Storage Queue service.</span></span> <span data-ttu-id="1a2d8-219">Je lepší postupovat při izolaci podrobností o implementaci rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-219">It's a better practice to insulate the implementation details of the API.</span></span> <span data-ttu-id="1a2d8-220">Zavedení vícevrstvé vrstvy nebo zprostředkujícího rozhraní API, které zpřístupňuje obecné operace a zapouzdřuje konkrétní knihovnu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-220">Introduce an intermediation layer, or intermediate API, that exposes generic operations and encapsulates the concrete library.</span></span> <span data-ttu-id="1a2d8-221">Toto volné spojení vám umožní odpínat jednu službu Řízení front pro jinou, aniž by bylo nutné provádět změny v kódu služby hlavní.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-221">This loose coupling enables you to swap out one queuing service for another without having to make changes to the mainline service code.</span></span>

<span data-ttu-id="1a2d8-222">Fronty Azure Storage jsou ekonomicky výhodné k implementaci příkazů pro zasílání zpráv v cloudových nativních aplikacích.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-222">Azure Storage queues are an economical option to implement command messaging in your cloud-native applications.</span></span> <span data-ttu-id="1a2d8-223">Obzvláště když velikost fronty překročí 80 GB, nebo je jednoduchá sada funkcí přijatelná.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-223">Especially when a queue size will exceed 80 GB, or a simple feature set is acceptable.</span></span> <span data-ttu-id="1a2d8-224">Platíte jenom za úložiště zpráv. neexistují žádné pevné hodinové poplatky.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-224">You only pay for the storage of the messages; there are no fixed hourly charges.</span></span>

### <a name="azure-service-bus-queues"></a><span data-ttu-id="1a2d8-225">Fronty služby Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="1a2d8-225">Azure Service Bus Queues</span></span>

<span data-ttu-id="1a2d8-226">V případě složitějších požadavků na zasílání zpráv zvažte Azure Service Bus fronty.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-226">For more complex messaging requirements, consider Azure Service Bus queues.</span></span>

<span data-ttu-id="1a2d8-227">Základem je robustní infrastruktura zpráv, která se šíří, [Azure Service Bus](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview) podporuje model zprostředkovaných *zpráv*.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-227">Sitting atop a robust message infrastructure, [Azure Service Bus](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview) supports a *brokered messaging model*.</span></span> <span data-ttu-id="1a2d8-228">Zprávy jsou spolehlivě uloženy ve zprostředkovateli (fronty), dokud je příjemce neobdrží.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-228">Messages are reliably stored in a broker (the queue) until received by the consumer.</span></span> <span data-ttu-id="1a2d8-229">Fronta garantuje doručování zpráv first-in/first-out (FIFO) a respektuje pořadí, ve kterém byly zprávy přidány do fronty.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-229">The queue guarantees First-In/First-Out (FIFO) message delivery, respecting the order in which messages were added to the queue.</span></span>

<span data-ttu-id="1a2d8-230">Velikost zprávy může být mnohem větší, až do 256 KB.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-230">The size of a message can be much larger, up to 256 KB.</span></span> <span data-ttu-id="1a2d8-231">Zprávy jsou po neomezenou dobu uchovávány ve frontě.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-231">Messages are persisted in the queue for an unlimited period of time.</span></span> <span data-ttu-id="1a2d8-232">Service Bus podporuje nejen volání založené na protokolu HTTP, ale také poskytuje úplnou podporu pro [Protokol AMQP](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-amqp-overview).</span><span class="sxs-lookup"><span data-stu-id="1a2d8-232">Service Bus supports not only HTTP-based calls, but also provides full support for the [AMQP protocol](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-amqp-overview).</span></span> <span data-ttu-id="1a2d8-233">AMQP je otevřený standard pro dodavatele, který podporuje binární protokol a vyšší úroveň spolehlivosti.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-233">AMQP is an open-standard across vendors that supports a binary protocol and higher degrees of reliability.</span></span>

<span data-ttu-id="1a2d8-234">Service Bus poskytuje bohatou sadu funkcí, včetně [podpory transakcí](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions) a [funkce zjišťování duplicitních](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection)dat.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-234">Service Bus provides a rich set of features, including [transaction support](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions) and a [duplicate detection feature](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection).</span></span> <span data-ttu-id="1a2d8-235">Fronta garantuje "po doručení" po každé zprávě.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-235">The queue guarantees "at most once delivery" per message.</span></span> <span data-ttu-id="1a2d8-236">Automaticky zahodí zprávu, která již byla odeslána.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-236">It automatically discards a message that has already been sent.</span></span> <span data-ttu-id="1a2d8-237">Pokud je producent nejistý, může znovu odeslat stejnou zprávu a Service Bus garantuje, že bude zpracována pouze jedna kopie.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-237">If a producer is in doubt, it can resend the same message, and Service Bus guarantees that only one copy will be processed.</span></span> <span data-ttu-id="1a2d8-238">Zjišťování duplicitních dat je bezplatné, protože nemusíte sestavovat další instalace infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-238">Duplicate detection frees you from  having to build additional infrastructure plumbing.</span></span>

<span data-ttu-id="1a2d8-239">Pro vytváření oddílů a relací jsou dvě další podnikové funkce.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-239">Two more enterprise features are partitioning and sessions.</span></span> <span data-ttu-id="1a2d8-240">Konvenční Service Bus fronta se zpracovává pomocí jediného zprostředkovatele zpráv a je uložený v jednom úložišti zpráv.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-240">A conventional Service Bus queue is handled by a single message broker and stored in a single message store.</span></span> <span data-ttu-id="1a2d8-241">Ale [Service Bus rozdělení](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) do fronty v rámci více zprostředkovatelů zpráv a úložišť zpráv.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-241">But, [Service Bus Partitioning](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) spreads the queue across multiple message brokers and message stores.</span></span> <span data-ttu-id="1a2d8-242">Celková propustnost již není omezena výkonem jediného zprostředkovatele zpráv nebo úložiště pro zasílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-242">The overall throughput is no longer limited by the performance of a single message broker or messaging store.</span></span> <span data-ttu-id="1a2d8-243">Dočasný výpadek úložiště pro zasílání zpráv nezobrazuje nedostupné oddíly rozdělené do oddílů.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-243">A temporary outage of a messaging store doesn't render a partitioned queue unavailable.</span></span>

<span data-ttu-id="1a2d8-244">[Service Bus relace](https://codingcanvas.com/azure-service-bus-sessions/) poskytují způsob, jak seskupit zprávy související se skupinami.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-244">[Service Bus Sessions](https://codingcanvas.com/azure-service-bus-sessions/) provide a way to group-related messages.</span></span> <span data-ttu-id="1a2d8-245">Představte si scénář pracovního postupu, ve kterém se zprávy musí zpracovávat společně a operace skončila na konci.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-245">Imagine a workflow scenario where messages must be processed together and the operation completed at the end.</span></span> <span data-ttu-id="1a2d8-246">Aby bylo možné využít výhody, musí být relace explicitně povoleny pro frontu a každá související zpráva musí obsahovat stejné ID relace.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-246">To take advantage, sessions must be explicitly enabled for the queue and each related messaged must contain the same session ID.</span></span>

<span data-ttu-id="1a2d8-247">Existuje však několik důležitých aspektů: velikost fronty Service Bus je omezena na 80 GB, což je mnohem menší než v případě, že jsou k dispozici z fronty úložiště.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-247">However, there are some important caveats: Service Bus queues size is limited to 80 GB, which is much smaller than what's available from store queues.</span></span> <span data-ttu-id="1a2d8-248">Kromě toho Service Bus fronty účtují základní náklady a účtuje se na operaci.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-248">Additionally, Service Bus queues incur a base cost and charge per operation.</span></span>

<span data-ttu-id="1a2d8-249">Obrázek 4-14 popisuje architekturu Service Bus fronty na nejvyšší úrovni.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-249">Figure 4-14 outlines the high-level architecture of a Service Bus queue.</span></span>

![Fronta služby Service Bus](./media/service-bus-queue.png)

<span data-ttu-id="1a2d8-251">**Obrázek 4-14**.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-251">**Figure 4-14**.</span></span> <span data-ttu-id="1a2d8-252">Fronta služby Service Bus</span><span class="sxs-lookup"><span data-stu-id="1a2d8-252">Service Bus queue</span></span>

<span data-ttu-id="1a2d8-253">Na předchozím obrázku si všimněte vztahu Point-to-Point.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-253">In the previous figure, note the point-to-point relationship.</span></span> <span data-ttu-id="1a2d8-254">Dvě instance stejného poskytovatele jsou enqueuing zprávy do jedné fronty Service Bus.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-254">Two instances of the same provider are enqueuing messages into a single Service Bus queue.</span></span> <span data-ttu-id="1a2d8-255">Každou zprávu spotřebují jenom jedna ze tří instancí příjemců na pravé straně.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-255">Each message is consumed by only one of three consumer instances on the right.</span></span> <span data-ttu-id="1a2d8-256">V dalším kroku se podíváme, jak implementovat zasílání zpráv, kde se stejnou zprávu můžou zajímat různí zákazníci.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-256">Next, we discuss how to implement messaging where different consumers may all be interested the same message.</span></span>

## <a name="events"></a><span data-ttu-id="1a2d8-257">Události</span><span class="sxs-lookup"><span data-stu-id="1a2d8-257">Events</span></span>

<span data-ttu-id="1a2d8-258">Služba Řízení front zpráv představuje účinný způsob, jak implementovat komunikaci, když producent může asynchronně poslat zprávu příjemce.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-258">Message queuing is an effective way to implement communication where a producer can asynchronously send a consumer a message.</span></span> <span data-ttu-id="1a2d8-259">Co se ale stane, když se stejná zpráva zajímá *mnoho různých uživatelů* ?</span><span class="sxs-lookup"><span data-stu-id="1a2d8-259">However, what happens when *many different consumers* are interested in the same message?</span></span> <span data-ttu-id="1a2d8-260">Vyhrazená fronta zpráv pro každého příjemce by nemusela správně škálovat a měla by být obtížná spravovat.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-260">A dedicated message queue for each consumer wouldn't scale well and would become difficult to manage.</span></span>

<span data-ttu-id="1a2d8-261">Pro vyřešení tohoto scénáře se přesunete na třetí typ interakce zprávy, která je v *události*.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-261">To address this scenario, we move to the third type of message interaction, the *event*.</span></span> <span data-ttu-id="1a2d8-262">Jedna mikroslužba oznamuje, že došlo k nějaké akci.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-262">One microservice announces that an action had occurred.</span></span> <span data-ttu-id="1a2d8-263">Další mikroslužby, pokud to zajímá, reagují na akci nebo na událost.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-263">Other microservices, if interested, react to the action, or event.</span></span>

<span data-ttu-id="1a2d8-264">Událost je proces se dvěma kroky.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-264">Eventing is a two-step process.</span></span> <span data-ttu-id="1a2d8-265">Pro danou změnu stavu mikroslužba publikuje událost zprostředkovateli zpráv a zpřístupní ji všem dalším zúčastněným mikroslužbám.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-265">For a given state change, a microservice publishes an event to a message broker, making it available to any other interested microservice.</span></span> <span data-ttu-id="1a2d8-266">Zúčastněná mikroslužba je informována o přihlášení k odběru události v zprostředkovateli zpráv.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-266">The interested microservice is notified by subscribing to the event in the message broker.</span></span> <span data-ttu-id="1a2d8-267">Ke implementaci [komunikace založené na událostech](https://docs.microsoft.com/dotnet/standard/microservices-architecture/multi-container-microservice-net-applications/integration-event-based-microservice-communications)slouží model [publikování/odběr](https://docs.microsoft.com/azure/architecture/patterns/publisher-subscriber) .</span><span class="sxs-lookup"><span data-stu-id="1a2d8-267">You use the [Publish/Subscribe](https://docs.microsoft.com/azure/architecture/patterns/publisher-subscriber) pattern to implement [event-based communication](https://docs.microsoft.com/dotnet/standard/microservices-architecture/multi-container-microservice-net-applications/integration-event-based-microservice-communications).</span></span>

<span data-ttu-id="1a2d8-268">Obrázek 4-15 ukazuje mikroslužbu nákupního košíku, která publikuje událost se dvěma ostatními mikroslužbami k přihlášení.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-268">Figure 4-15 shows a shopping basket microservice publishing an event with two other microservices subscribing to it.</span></span>

![Zasílání zpráv řízených událostmi](./media/event-driven-messaging.png)

<span data-ttu-id="1a2d8-270">**Obrázek 4-15**.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-270">**Figure 4-15**.</span></span> <span data-ttu-id="1a2d8-271">Zasílání zpráv řízených událostmi</span><span class="sxs-lookup"><span data-stu-id="1a2d8-271">Event-Driven messaging</span></span>

<span data-ttu-id="1a2d8-272">Poznamenejte si součást *Sběrnice událostí* , která je umístěná uprostřed komunikačního kanálu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-272">Note the *event bus* component that sits in the middle of the communication channel.</span></span> <span data-ttu-id="1a2d8-273">Jedná se o vlastní třídu, která zapouzdřuje zprostředkovatele zpráv a oddělí ho od příslušné aplikace.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-273">It's a custom class that encapsulates the message broker and decouples it from the underlying application.</span></span> <span data-ttu-id="1a2d8-274">Mikroslužby řazení a inventarizace nezávisle provozují událost bez jakýchkoli znalostí ani mikroslužby nákupního košíku.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-274">The ordering and inventory microservices independently operate the event with no knowledge of each other, nor the shopping basket microservice.</span></span> <span data-ttu-id="1a2d8-275">Když je registrovaná událost publikovaná do sběrnice událostí, na ni působí.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-275">When the registered event is published to the event bus, they act upon it.</span></span>

<span data-ttu-id="1a2d8-276">S událostmi přesouváme z technologie řízení front zpráv na *témata*.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-276">With eventing, we move from queuing technology to *topics*.</span></span> <span data-ttu-id="1a2d8-277">[Téma](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions) se podobá frontě, ale podporuje vzor zasílání zpráv 1: n.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-277">A [topic](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions) is similar to a queue, but supports a one-to-many messaging pattern.</span></span> <span data-ttu-id="1a2d8-278">Jedna mikroslužba publikuje zprávu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-278">One microservice publishes a message.</span></span> <span data-ttu-id="1a2d8-279">U této zprávy se může rozhodnout, že se bude tato zpráva přijímat a reagovat na více než více služeb odběru.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-279">Multiple subscribing microservices can choose to receive and act upon that message.</span></span> <span data-ttu-id="1a2d8-280">Obrázek 4-16 ukazuje architekturu tématu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-280">Figure 4-16 shows a topic architecture.</span></span>

![Architektura tématu](./media/topic-architecture.png)

<span data-ttu-id="1a2d8-282">**Obrázek 4-16**.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-282">**Figure 4-16**.</span></span> <span data-ttu-id="1a2d8-283">Architektura tématu</span><span class="sxs-lookup"><span data-stu-id="1a2d8-283">Topic architecture</span></span>

<span data-ttu-id="1a2d8-284">Na předchozím obrázku odesílají vydavatelé zprávy do tématu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-284">In the previous figure, publishers send messages to the topic.</span></span> <span data-ttu-id="1a2d8-285">Na konci předplatitelé obdrží zprávy od předplatných.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-285">At the end, subscribers receive messages from subscriptions.</span></span> <span data-ttu-id="1a2d8-286">Uprostřed se v tomto tématu předají zprávy do předplatných založených na sadě *pravidel*, která jsou zobrazená v tmavě modrých polích.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-286">In the middle, the topic forwards messages to subscriptions based on a set of *rules*, shown in dark blue boxes.</span></span> <span data-ttu-id="1a2d8-287">Pravidla slouží jako filtr, který předávají konkrétní zprávy do předplatného.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-287">Rules act as a filter that forward specific messages to a subscription.</span></span> <span data-ttu-id="1a2d8-288">Tady se pošle událost "CreateOrder" do předplatného \#1 a předplatné \#3, ale ne do předplatného \#2.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-288">Here, a "CreateOrder" event would be sent to Subscription \#1 and Subscription \#3, but not to Subscription \#2.</span></span> <span data-ttu-id="1a2d8-289">Do předplatného \#2 a předplatné \#3 se pošle událost OrderCompleted.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-289">An "OrderCompleted" event would be sent to Subscription \#2 and Subscription \#3.</span></span>

<span data-ttu-id="1a2d8-290">Cloud Azure podporuje dvě různé služby tématu: Azure Service Bus témata a Azure EventGrid.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-290">The Azure cloud supports two different topic services: Azure Service Bus Topics and Azure EventGrid.</span></span>

### <a name="azure-service-bus-topics"></a><span data-ttu-id="1a2d8-291">Téma služby Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="1a2d8-291">Azure Service Bus Topics</span></span>

<span data-ttu-id="1a2d8-292">[Azure Service Bus témata](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions)se koná nad stejným robustním modelem zprostředkovaných zpráv Azure Service Bus fronty.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-292">Sitting on top of the same robust brokered message model of Azure Service Bus queues are [Azure Service Bus Topics](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span></span> <span data-ttu-id="1a2d8-293">Téma může přijímat zprávy od více nezávislých vydavatelů a odesílat zprávy až 2 000 předplatitelů.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-293">A topic can receive messages from multiple independent publishers and send messages to up to 2,000 subscribers.</span></span> <span data-ttu-id="1a2d8-294">Odběry je možné dynamicky přidávat nebo odebírat za běhu bez zastavení systému nebo opětovného vytváření tématu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-294">Subscriptions can be dynamically added or removed at runtime without stopping the system or recreating the topic.</span></span>

<span data-ttu-id="1a2d8-295">K dispozici je také mnoho pokročilých funkcí z front Azure Service Bus, včetně [zjišťování duplicit](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection) a [podpory transakcí](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions).</span><span class="sxs-lookup"><span data-stu-id="1a2d8-295">Many advanced features from Azure Service Bus queues are also available for topics, including [Duplicate Detection](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection) and [Transaction support](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions).</span></span> <span data-ttu-id="1a2d8-296">Ve výchozím nastavení se Service Bus témata zpracovávají pomocí jediného zprostředkovatele zpráv a ukládají se do jednoho úložiště zpráv.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-296">By default, Service Bus topics are handled by a single message broker and stored in a single message store.</span></span> <span data-ttu-id="1a2d8-297">[Service Bus rozdělení na oddíly](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) ale škáluje téma tím, že se rozprostře mezi mnoho zprostředkovatelů zpráv a úložišť zpráv.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-297">But, [Service Bus Partitioning](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) scales a topic by spreading it across many message brokers and message stores.</span></span>

<span data-ttu-id="1a2d8-298">[Naplánovaná](https://docs.microsoft.com/azure/service-bus-messaging/message-sequencing) zpráva o doručení označuje zprávu s určitou dobou pro zpracování.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-298">[Scheduled Message Delivery](https://docs.microsoft.com/azure/service-bus-messaging/message-sequencing) tags a message with a specific time for processing.</span></span> <span data-ttu-id="1a2d8-299">Zpráva se v tématu před časem nezobrazí.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-299">The message won't appear in the topic before that time.</span></span> <span data-ttu-id="1a2d8-300">[Odložení zprávy](https://docs.microsoft.com/azure/service-bus-messaging/message-deferral) umožňuje odložit načtení zprávy na pozdější dobu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-300">[Message Deferral](https://docs.microsoft.com/azure/service-bus-messaging/message-deferral) enables you to defer a retrieval of a message to a later time.</span></span> <span data-ttu-id="1a2d8-301">Obě možnosti se běžně používají ve scénářích zpracování pracovního postupu, kdy se operace zpracovávají v určitém pořadí.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-301">Both are commonly used in workflow processing scenarios where operations are processed in a particular order.</span></span> <span data-ttu-id="1a2d8-302">Zpracování přijatých zpráv můžete odložit až do dokončení předchozí práce.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-302">You can postpone processing of received messages until prior work has been completed.</span></span>

<span data-ttu-id="1a2d8-303">Témata Service Bus jsou robustní a prověřená technologie pro povolení komunikace s publikováním a odběrem v cloudových nativních systémech.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-303">Service Bus topics are a robust and proven technology for enabling publish/subscribe communication in your cloud-native systems.</span></span>

### <a name="azure-event-grid"></a><span data-ttu-id="1a2d8-304">Azure Event Grid</span><span class="sxs-lookup"><span data-stu-id="1a2d8-304">Azure Event Grid</span></span>

<span data-ttu-id="1a2d8-305">I když je Azure Service Bus poskytovatel zasílání zpráv s plnou platností, [Azure Event Grid](https://docs.microsoft.com/azure/event-grid/overview) je nový dítě na bloku.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-305">While Azure Service Bus is a battle-tested messaging broker with a full set of enterprise features, [Azure Event Grid](https://docs.microsoft.com/azure/event-grid/overview) is the new kid on the block.</span></span>

<span data-ttu-id="1a2d8-306">Na první pohled může Event Grid vypadat stejně jako jiný systém zasílání zpráv na základě tématu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-306">At first glance, Event Grid may look like just another topic-based messaging system.</span></span> <span data-ttu-id="1a2d8-307">Liší se ale v mnoha ohledech.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-307">However, it's different in many ways.</span></span> <span data-ttu-id="1a2d8-308">Zaměřuje se na úlohy řízené událostmi, které umožňují zpracování událostí v reálném čase, rozsáhlou integraci Azure a otevřenou platformu na infrastruktuře bez serveru.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-308">Focused on event-driven workloads, it enables real-time event processing, deep Azure integration, and an open-platform - all on serverless infrastructure.</span></span> <span data-ttu-id="1a2d8-309">Je navržený pro moderní cloudové a nativní aplikace bez serveru.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-309">It's designed for contemporary cloud-native and serverless applications</span></span>

<span data-ttu-id="1a2d8-310">Jako centralizované *obslužné*nebo potrubní Event Grid reaguje na události v prostředcích Azure a z vašich vlastních služeb.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-310">As a centralized *eventing backplane*, or pipe, Event Grid reacts to events inside Azure resources and from your own services.</span></span>

<span data-ttu-id="1a2d8-311">Oznámení událostí jsou publikována v Event Grid tématu, které následně směruje každou událost na předplatné.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-311">Event notifications are published to an Event Grid Topic, which, in turn, routes each event to a subscription.</span></span> <span data-ttu-id="1a2d8-312">Předplatitelé mapují na předplatná a spotřebovávají události.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-312">Subscribers map to subscriptions and consume the events.</span></span> <span data-ttu-id="1a2d8-313">Stejně jako u Service Bus Event Grid podporuje *filtrovaný model odběratele* , kde předplatné nastavuje pravidlo pro události, které chce přijmout.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-313">Like Service Bus, Event Grid supports a *filtered subscriber model* where a subscription sets rule for the events it wishes to receive.</span></span> <span data-ttu-id="1a2d8-314">Event Grid poskytuje rychlou propustnost s jistotou 10 000 000 událostí za sekundu, které umožňují téměř větší doručování v reálném čase, než Azure Service Bus může generovat.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-314">Event Grid provides fast throughput with a guarantee of 10 million events per second enabling near real-time delivery - far more than what Azure Service Bus can generate.</span></span>

<span data-ttu-id="1a2d8-315">Sladkou skvrnou pro Event Grid je jeho Hluboká integrace do prostředků infrastruktury Azure.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-315">A sweet spot for Event Grid is its deep integration into the fabric of Azure infrastructure.</span></span> <span data-ttu-id="1a2d8-316">Prostředek Azure, například Cosmos DB, může publikovat integrované události přímo do jiných zúčastněných prostředků Azure – bez nutnosti vlastního kódu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-316">An Azure resource, such as Cosmos DB, can publish built-in events directly to other interested Azure resources - without the need for custom code.</span></span> <span data-ttu-id="1a2d8-317">Event Grid může publikovat události z předplatného Azure, skupiny prostředků nebo služby a poskytnout vývojářům jemně odstupňovanou kontrolu nad životním cyklem cloudových prostředků.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-317">Event Grid can publish events from an Azure Subscription, Resource Group, or Service, giving developers fine-grained control over the lifecycle of cloud resources.</span></span> <span data-ttu-id="1a2d8-318">Event Grid ale nejsou omezené na Azure.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-318">However, Event Grid isn't limited to Azure.</span></span> <span data-ttu-id="1a2d8-319">Je to otevřená platforma, která může využívat vlastní události HTTP publikované z aplikací nebo služeb třetích stran a události směrování externím předplatitelům.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-319">It's an open platform that can consume custom HTTP events published from applications or third-party services and route events to external subscribers.</span></span>

<span data-ttu-id="1a2d8-320">Při publikování a přihlášení k odběru nativních událostí z prostředků Azure se nevyžaduje žádné kódování.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-320">When publishing and subscribing to native events from Azure resources, no coding is required.</span></span> <span data-ttu-id="1a2d8-321">Díky jednoduché konfiguraci můžete integrovat události z jednoho prostředku Azure do jiného, který využívá integrované instalace pro témata a odběry.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-321">With simple configuration, you can integrate events from one Azure resource to another leveraging built-in plumbing for Topics and Subscriptions.</span></span> <span data-ttu-id="1a2d8-322">Obrázek 4-17 ukazuje anatomii Event Grid.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-322">Figure 4-17 shows the anatomy of Event Grid.</span></span>

![Event Grid anatomie](./media/event-grid-anatomy.png)

<span data-ttu-id="1a2d8-324">**Obrázek 4-17**.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-324">**Figure 4-17**.</span></span> <span data-ttu-id="1a2d8-325">Event Grid anatomie</span><span class="sxs-lookup"><span data-stu-id="1a2d8-325">Event Grid anatomy</span></span>

<span data-ttu-id="1a2d8-326">Hlavním rozdílem mezi EventGrid a Service Bus je základní *vzor výměny zpráv*.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-326">A major difference between EventGrid and Service Bus is the underlying *message exchange pattern*.</span></span>

<span data-ttu-id="1a2d8-327">Service Bus implementuje starší *model Pull* ve stylu, ve kterém se předplatitelé pro příjem dat aktivně dotazují na odběr nových zpráv v tématu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-327">Service Bus implements an older style *pull model* in which the downstream subscriber actively polls the topic subscription for new messages.</span></span> <span data-ttu-id="1a2d8-328">Po celou stranu tento přístup umožňuje předplatiteli úplné řízení tempa, při kterém zpracovává zprávy.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-328">On the upside, this approach gives the subscriber full control of the pace at which it processes messages.</span></span> <span data-ttu-id="1a2d8-329">Řídí, kdy a kolik zpráv se má v daném čase zpracovat.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-329">It controls when and how many messages to process at any given time.</span></span> <span data-ttu-id="1a2d8-330">Nepřečtené zprávy zůstávají v předplatném až do zpracování.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-330">Unread messages remain in the subscription until processed.</span></span> <span data-ttu-id="1a2d8-331">Významnou nedostatkem je latence mezi tím, kdy se událost generuje, a operací cyklického dotazování, která tuto zprávu vyžádá do předplatitele ke zpracování.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-331">A significant shortcoming is the latency between the time the event is generated and the polling operation that pulls that message to the subscriber for processing.</span></span> <span data-ttu-id="1a2d8-332">Navíc režie konstantního cyklického dotazování pro další událost spotřebovává prostředky a peníze.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-332">Also, the overhead of constant polling for the next event consumes resources and money.</span></span>

<span data-ttu-id="1a2d8-333">EventGrid se ale liší.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-333">EventGrid, however, is different.</span></span> <span data-ttu-id="1a2d8-334">Implementuje *model push* , ve kterém jsou události odesílány do událostí EventHandler, jak byly přijaty, což poskytuje téměř v reálném čase doručení událostí.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-334">It implements a *push model* in which events are sent to the EventHandlers as received, giving near real-time event delivery.</span></span> <span data-ttu-id="1a2d8-335">Také snižuje náklady, protože služba se aktivuje jenom v případě, že je potřeba spotřebovat událost – neprůběžně jako při cyklickém dotazování.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-335">It also reduces cost as the service is triggered only when it's needed to consume an event – not continually as with polling.</span></span> <span data-ttu-id="1a2d8-336">V takovém případě obslužná rutina události musí zpracovat příchozí zatížení a zajistit mechanismy omezování ochrany před zahlcením.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-336">That said, an event handler must handle the incoming load and provide throttling mechanisms to protect itself from becoming overwhelmed.</span></span> <span data-ttu-id="1a2d8-337">Řada služeb Azure, které využívají tyto události, jako jsou Azure Functions a Logic Apps, poskytují automatické možnosti automatického škálování pro zpracování zvýšené zátěže.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-337">Many Azure services that consume these events, such as Azure Functions and Logic Apps provide automatic autoscaling capabilities to handle increased loads.</span></span>  

<span data-ttu-id="1a2d8-338">Event Grid je plně spravovaná cloudová služba bez serveru.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-338">Event Grid is a fully managed serverless cloud service.</span></span> <span data-ttu-id="1a2d8-339">Dynamicky se škáluje podle vašich přenosů a účtuje se jenom za skutečné využití, a ne na předem zakoupenou kapacitu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-339">It dynamically scales based on your traffic and charges you only for your actual usage, not pre-purchased capacity.</span></span> <span data-ttu-id="1a2d8-340">Prvních 100 000 operací za měsíc je zdarma – operace se definují jako příchozí události (příchozí oznámení událostí), pokusy o doručení, volání správy a filtrování podle předmětu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-340">The first 100,000 operations per month are free – operations being defined as event ingress (incoming event notifications), subscription delivery attempts, management calls, and filtering by subject.</span></span> <span data-ttu-id="1a2d8-341">S 99,99% dostupností EventGrid garantuje doručení události během 24 hodin s integrovanou funkcí opakování pro neúspěšné doručení.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-341">With 99.99% availability, EventGrid guarantees the delivery of an event within a 24-hour period, with built-in retry functionality for unsuccessful delivery.</span></span> <span data-ttu-id="1a2d8-342">Nedoručené zprávy lze pro rozlišení přesunout do fronty nedoručených zpráv.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-342">Undelivered messages can be moved to a "dead-letter" queue for resolution.</span></span>  <span data-ttu-id="1a2d8-343">Na rozdíl od Azure Service Bus je Event Grid vyladěno pro rychlý výkon a nepodporuje funkce jako objednané zasílání zpráv, transakce a relace.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-343">Unlike Azure Service Bus, Event Grid is tuned for fast performance and doesn't support features like ordered messaging, transactions, and sessions.</span></span>

### <a name="streaming-messages-in-the-azure-cloud"></a><span data-ttu-id="1a2d8-344">Streamování zpráv v cloudu Azure</span><span class="sxs-lookup"><span data-stu-id="1a2d8-344">Streaming messages in the Azure cloud</span></span>

<span data-ttu-id="1a2d8-345">Azure Service Bus a Event Grid poskytuje skvělou podporu pro aplikace, které zveřejňují jednotlivé diskrétní události, jako je nový dokument, vložen do Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-345">Azure Service Bus and Event Grid provide great support for applications that expose single, discrete events like a new document has been inserted into a Cosmos DB.</span></span> <span data-ttu-id="1a2d8-346">Ale co dělat v případě, že systém nativní pro Cloud potřebuje zpracovat *Stream souvisejících událostí*?</span><span class="sxs-lookup"><span data-stu-id="1a2d8-346">But, what if your cloud-native system needs to process a *stream of related events*?</span></span> <span data-ttu-id="1a2d8-347">[Datové proudy událostí](https://docs.microsoft.com/archive/msdn-magazine/2015/february/microsoft-azure-the-rise-of-event-stream-oriented-systems) jsou složitější.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-347">[Event streams](https://docs.microsoft.com/archive/msdn-magazine/2015/february/microsoft-azure-the-rise-of-event-stream-oriented-systems) are more complex.</span></span> <span data-ttu-id="1a2d8-348">Typicky se jedná o časově uspořádané, vzájemně seřazené a musí být zpracovávány jako skupina.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-348">They're typically time-ordered, interrelated, and must be processed as a group.</span></span>

<span data-ttu-id="1a2d8-349">[Centrum událostí Azure](https://azure.microsoft.com/services/event-hubs/) je platforma pro streamování dat a služba pro příjem událostí, která shromažďuje, transformuje a ukládá události.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-349">[Azure Event Hub](https://azure.microsoft.com/services/event-hubs/) is a data streaming platform and event ingestion service that collects, transforms, and stores events.</span></span> <span data-ttu-id="1a2d8-350">Je vyladěný tak, aby zachytával streamovaná data, například nepřetržitá oznámení o událostech emitovaných z kontextu telemetrie.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-350">It's fine-tuned to capture streaming data, such as continuous event notifications emitted from a telemetry context.</span></span> <span data-ttu-id="1a2d8-351">Služba je vysoce škálovatelná a může ukládat a [zpracovávat miliony událostí za sekundu](https://docs.microsoft.com/azure/event-hubs/event-hubs-about).</span><span class="sxs-lookup"><span data-stu-id="1a2d8-351">The service is highly scalable and can store and [process millions of events per second](https://docs.microsoft.com/azure/event-hubs/event-hubs-about).</span></span> <span data-ttu-id="1a2d8-352">Znázorněné na obrázku 4-18 je často předním dveřem pro kanál událostí, která odpojuje datový proud ingestuje od spotřeby událostí.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-352">Shown in Figure 4-18, it's often a front door for an event pipeline, decoupling ingest stream from event consumption.</span></span>

![Azure Event Hub](./media/azure-event-hub.png)

<span data-ttu-id="1a2d8-354">**Obrázek 4-18**.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-354">**Figure 4-18**.</span></span> <span data-ttu-id="1a2d8-355">Azure Event Hub</span><span class="sxs-lookup"><span data-stu-id="1a2d8-355">Azure Event Hub</span></span>

<span data-ttu-id="1a2d8-356">Centrum událostí podporuje nízkou latenci a konfigurovatelné časové uchovávání.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-356">Event Hub supports low latency and configurable time retention.</span></span> <span data-ttu-id="1a2d8-357">Na rozdíl od front a témat Event Hubs uchovat data událostí poté, co je uživatel přečte.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-357">Unlike queues and topics, Event Hubs keep event data after it's been read by a consumer.</span></span> <span data-ttu-id="1a2d8-358">Tato funkce umožňuje jiným datovým službám (interním i externím) přehrávat data pro další analýzu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-358">This feature enables other data analytic services, both internal and external, to replay the data for further analysis.</span></span> <span data-ttu-id="1a2d8-359">Události uložené v centru událostí se odstraní jenom po vypršení doby uchování, což je ve výchozím nastavení jeden den, ale dá se konfigurovat.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-359">Events stored in event hub are only deleted upon expiration of the retention period, which is one day by default, but configurable.</span></span>

<span data-ttu-id="1a2d8-360">Centrum událostí podporuje společné protokoly pro publikování událostí, včetně protokolu HTTPS a AMQP.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-360">Event Hub supports common event publishing protocols including HTTPS and AMQP.</span></span> <span data-ttu-id="1a2d8-361">Podporuje také Kafka 1,0.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-361">It also supports Kafka 1.0.</span></span> <span data-ttu-id="1a2d8-362">[Stávající aplikace Kafka můžou komunikovat s centrem událostí](https://docs.microsoft.com/azure/event-hubs/event-hubs-for-kafka-ecosystem-overview) pomocí protokolu Kafka, který poskytuje alternativu ke správě rozsáhlých clusterů Kafka.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-362">[Existing Kafka applications can communicate with Event Hub](https://docs.microsoft.com/azure/event-hubs/event-hubs-for-kafka-ecosystem-overview) using the Kafka protocol providing an alternative to managing large Kafka clusters.</span></span> <span data-ttu-id="1a2d8-363">Spousta Open Source nativních systémů se Kafka přidaných v cloudu.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-363">Many open-source cloud-native systems embrace Kafka.</span></span>

<span data-ttu-id="1a2d8-364">Event Hubs implementuje streamování zpráv prostřednictvím [děleného](https://docs.microsoft.com/azure/event-hubs/event-hubs-features) dodavatelského modelu, ve kterém každý příjemce přečte jenom určitou podmnožinu nebo oddíl datového proudu zpráv.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-364">Event Hubs implements message streaming through a [partitioned consumer model](https://docs.microsoft.com/azure/event-hubs/event-hubs-features) in which each consumer only reads a specific subset, or partition, of the message stream.</span></span> <span data-ttu-id="1a2d8-365">Tento model umožňuje obrovské horizontální škálování pro zpracování událostí a poskytuje další funkce zaměřené na streamy, které nejsou ve frontách a tématech dostupné.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-365">This pattern enables tremendous horizontal scale for event processing and provides other stream-focused features that are unavailable in queues and topics.</span></span> <span data-ttu-id="1a2d8-366">Oddíl je seřazená posloupnost událostí, která se nachází v centru událostí.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-366">A partition is an ordered sequence of events that is held in an event hub.</span></span> <span data-ttu-id="1a2d8-367">Jakmile přijdete o novější události, přidají se na konec této sekvence.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-367">As newer events arrive, they're added to the end of this sequence.</span></span><span data-ttu-id="1a2d8-368">Obrázek 4-19 ukazuje dělení do oddílů v centru událostí.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-368"> Figure 4-19 shows partitioning in an Event Hub.</span></span>

![Vytváření oddílů centra událostí](./media/event-hub-partitioning.png)

<span data-ttu-id="1a2d8-370">**Obrázek 4-19**.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-370">**Figure 4-19**.</span></span> <span data-ttu-id="1a2d8-371">Vytváření oddílů centra událostí</span><span class="sxs-lookup"><span data-stu-id="1a2d8-371">Event Hub partitioning</span></span>

<span data-ttu-id="1a2d8-372">Místo čtení ze stejného prostředku každá skupina uživatelů čte celou podmnožinu nebo oddíl datového proudu zpráv.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-372">Instead of reading from the same resource, each consumer group reads across a subset, or partition, of the message stream.</span></span>

<span data-ttu-id="1a2d8-373">V případě cloudových nativních aplikací, které musí streamovat velký počet událostí, může být centrum událostí Azure robustní a dostupné řešení.</span><span class="sxs-lookup"><span data-stu-id="1a2d8-373">For cloud-native applications that must stream large numbers of events, Azure Event Hub can be a robust and affordable solution.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="1a2d8-374">[Předchozí](front-end-communication.md)
>[Další](grpc.md)</span><span class="sxs-lookup"><span data-stu-id="1a2d8-374">[Previous](front-end-communication.md)
[Next](grpc.md)</span></span>
