---
title: gRPC
description: Přečtěte si o gRPC, její roli v cloudových nativních aplikacích a o tom, jak se liší od komunikace HTTP RESTful.
author: robvet
no-loc:
- Blazor
- Blazor WebAssembly
ms.date: 05/13/2020
ms.openlocfilehash: 4a0c88472d2b19efb2ff0f58395003b1b6409131
ms.sourcegitcommit: ef50c99928183a0bba75e07b9f22895cd4c480f8
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/07/2020
ms.locfileid: "87914894"
---
# <a name="grpc"></a><span data-ttu-id="0354b-103">gRPC</span><span class="sxs-lookup"><span data-stu-id="0354b-103">gRPC</span></span>

<span data-ttu-id="0354b-104">V této knize jsme se zaměřili na komunikaci na [bázi REST](https://docs.microsoft.com/azure/architecture/best-practices/api-design) .</span><span class="sxs-lookup"><span data-stu-id="0354b-104">So far in this book, we've focused on [REST-based](https://docs.microsoft.com/azure/architecture/best-practices/api-design) communication.</span></span> <span data-ttu-id="0354b-105">Viděli jsme, že REST je flexibilní styl architektury, který definuje operace na základě CRUD u prostředků entity.</span><span class="sxs-lookup"><span data-stu-id="0354b-105">We've seen that REST is a flexible architectural style that defines CRUD-based operations against entity resources.</span></span> <span data-ttu-id="0354b-106">Klienti komunikují s prostředky přes protokol HTTP pomocí komunikačního modelu požadavků a odpovědí.</span><span class="sxs-lookup"><span data-stu-id="0354b-106">Clients interact with resources across HTTP with a request/response communication model.</span></span> <span data-ttu-id="0354b-107">I když je REST široce implementováno, novější komunikační technologie, gRPC, získala obrovský potenciál v rámci cloudové nativní komunity.</span><span class="sxs-lookup"><span data-stu-id="0354b-107">While REST is widely implemented, a newer communication technology, gRPC, has gained tremendous momentum across the cloud-native community.</span></span>

## <a name="what-is-grpc"></a><span data-ttu-id="0354b-108">Co je gRPC?</span><span class="sxs-lookup"><span data-stu-id="0354b-108">What is gRPC?</span></span>

<span data-ttu-id="0354b-109">gRPC je moderní, vysoce výkonné rozhraní, které vyvíjí stáří protokolu [RPC (Remote Procedure Call)](https://en.wikipedia.org/wiki/Remote_procedure_call) .</span><span class="sxs-lookup"><span data-stu-id="0354b-109">gRPC is a modern, high-performance framework that evolves the age-old [remote procedure call (RPC)](https://en.wikipedia.org/wiki/Remote_procedure_call) protocol.</span></span> <span data-ttu-id="0354b-110">Na úrovni aplikace gRPC zjednodušuje zasílání zpráv mezi klienty a back-endové služby.</span><span class="sxs-lookup"><span data-stu-id="0354b-110">At the application level, gRPC streamlines messaging between clients and back-end services.</span></span> <span data-ttu-id="0354b-111">Pocházející z Google, gRPC je open source a součástí ekosystému [Cloud Native Computing Foundation (CNCF)](https://www.cncf.io/) pro nativní nabídky cloudu.</span><span class="sxs-lookup"><span data-stu-id="0354b-111">Originating from Google, gRPC is open source and part of the  [Cloud Native Computing Foundation (CNCF)](https://www.cncf.io/) ecosystem of cloud-native offerings.</span></span> <span data-ttu-id="0354b-112">CNCF se považuje za gRPC na [inkubaci projektu](https://github.com/cncf/toc/blob/master/process/graduation_criteria.adoc).</span><span class="sxs-lookup"><span data-stu-id="0354b-112">CNCF considers gRPC an [incubating project](https://github.com/cncf/toc/blob/master/process/graduation_criteria.adoc).</span></span> <span data-ttu-id="0354b-113">Inkubace znamená, že koncoví uživatelé používají technologii v produkčních aplikacích a projekt má dobrý počet přispěvatelů.</span><span class="sxs-lookup"><span data-stu-id="0354b-113">Incubating means end users are using the technology in production applications, and the project has a healthy number of contributors.</span></span>

<span data-ttu-id="0354b-114">Typická klientská aplikace gRPC bude vystavovat místní, vnitroprocesově funkci, která implementuje obchodní operaci.</span><span class="sxs-lookup"><span data-stu-id="0354b-114">A typical gRPC client app will expose a local, in-process function that implements a business operation.</span></span> <span data-ttu-id="0354b-115">V rámci pokrývá tato místní funkce vyvolá jinou funkci na vzdáleném počítači.</span><span class="sxs-lookup"><span data-stu-id="0354b-115">Under the covers, that local function invokes another function on a remote machine.</span></span> <span data-ttu-id="0354b-116">To, co se jeví jako místní volání, se v podstatě stal transparentním nezpracovaným voláním vzdálené služby.</span><span class="sxs-lookup"><span data-stu-id="0354b-116">What appears to be a local call essentially becomes a transparent out-of-process call to a remote service.</span></span> <span data-ttu-id="0354b-117">Instalace rozhraní příkazového informačního protokolu RPC vyabstrakce síťovou komunikaci, serializaci a spouštění mezi počítači.</span><span class="sxs-lookup"><span data-stu-id="0354b-117">The RPC plumbing abstracts the point-to-point networking communication, serialization, and execution between computers.</span></span>

<span data-ttu-id="0354b-118">V cloudových nativních aplikacích vývojáři často pracují v různých programovacích jazycích, architekturách a technologiích.</span><span class="sxs-lookup"><span data-stu-id="0354b-118">In cloud-native applications, developers often work across programming languages, frameworks, and technologies.</span></span> <span data-ttu-id="0354b-119">Tato *interoperabilita* ztěžuje kontrakty zpráv a domovníing potřebnou pro komunikaci mezi platformami.</span><span class="sxs-lookup"><span data-stu-id="0354b-119">This *interoperability* complicates message contracts and the plumbing required for cross-platform communication.</span></span>  <span data-ttu-id="0354b-120">gRPC poskytuje "jednotnou vodorovnou vrstvu", která tyto otázky vyabstrakcí.</span><span class="sxs-lookup"><span data-stu-id="0354b-120">gRPC provides a "uniform horizontal layer" that abstracts these concerns.</span></span> <span data-ttu-id="0354b-121">Vývojářům kód v jejich nativní platformě se zaměřuje na obchodní funkce, zatímco gRPC zpracovává komunikaci při komunikaci.</span><span class="sxs-lookup"><span data-stu-id="0354b-121">Developers code in their native platform focused on business functionality, while gRPC handles communication plumbing.</span></span>

<span data-ttu-id="0354b-122">gRPC nabízí komplexní podporu napříč nejoblíbenějšími vývojovými zásobníky, včetně jazyků Java, JavaScript, C#, cestách, SWIFT a NodeJS.</span><span class="sxs-lookup"><span data-stu-id="0354b-122">gRPC offers comprehensive support across most popular development stacks, including Java, JavaScript, C#, Go, Swift, and NodeJS.</span></span>

## <a name="grpc-benefits"></a><span data-ttu-id="0354b-123">Výhody gRPC</span><span class="sxs-lookup"><span data-stu-id="0354b-123">gRPC Benefits</span></span>

<span data-ttu-id="0354b-124">gRPC používá pro svůj transportní protokol HTTP/2.</span><span class="sxs-lookup"><span data-stu-id="0354b-124">gRPC uses HTTP/2 for its transport protocol.</span></span> <span data-ttu-id="0354b-125">I když je kompatibilní s HTTP 1,1, funkce HTTP/2 nabízí mnoho pokročilých možností:</span><span class="sxs-lookup"><span data-stu-id="0354b-125">While compatible with HTTP 1.1, HTTP/2 features many advanced capabilities:</span></span>

- <span data-ttu-id="0354b-126">Protokol binárních rámců pro přenos dat na rozdíl od HTTP 1,1, který je založený na textu.</span><span class="sxs-lookup"><span data-stu-id="0354b-126">A binary framing protocol for data transport - unlike HTTP 1.1, which is text based.</span></span>
- <span data-ttu-id="0354b-127">Podpora multiplexování pro posílání více paralelních požadavků přes stejné připojení – HTTP 1,1 omezuje zpracování na jednu zprávu požadavku nebo odpovědi.</span><span class="sxs-lookup"><span data-stu-id="0354b-127">Multiplexing support for sending multiple parallel requests over the same connection - HTTP 1.1 limits processing to one request/response message at a time.</span></span>
- <span data-ttu-id="0354b-128">Obousměrná plně duplexní komunikace pro posílání požadavků klientů a odpovědí serveru současně.</span><span class="sxs-lookup"><span data-stu-id="0354b-128">Bidirectional full-duplex communication for sending both client requests and server responses simultaneously.</span></span>
- <span data-ttu-id="0354b-129">Integrované streamování umožňující požadavky a odpovědi na asynchronní streamování velkých datových sad.</span><span class="sxs-lookup"><span data-stu-id="0354b-129">Built-in streaming enabling requests and responses to asynchronously stream large data sets.</span></span>
- <span data-ttu-id="0354b-130">Komprese hlaviček, která snižuje využití sítě.</span><span class="sxs-lookup"><span data-stu-id="0354b-130">Header compression that reduces network usage.</span></span>

<span data-ttu-id="0354b-131">gRPC je odlehčená a vysoce výkonná.</span><span class="sxs-lookup"><span data-stu-id="0354b-131">gRPC is lightweight and highly performant.</span></span> <span data-ttu-id="0354b-132">Může to být až 8x rychlejší než serializace JSON se zprávami menšími 60-80%.</span><span class="sxs-lookup"><span data-stu-id="0354b-132">It can be up to 8x faster than JSON serialization with messages 60-80% smaller.</span></span> <span data-ttu-id="0354b-133">Ve službě Microsoft [Windows Communication Foundation (WCF)](https://docs.microsoft.com/dotnet/framework/wcf/whats-wcf) agilním výkon gRPC překračuje rychlost a efektivitu vysoce optimalizovaných [vazeb NetTcp](https://docs.microsoft.com/dotnet/api/system.servicemodel.nettcpbinding?view=netframework-4.8).</span><span class="sxs-lookup"><span data-stu-id="0354b-133">In Microsoft [Windows Communication Foundation (WCF)](https://docs.microsoft.com/dotnet/framework/wcf/whats-wcf) parlance, gRPC performance exceeds the speed and efficiency of the highly optimized [NetTCP bindings](https://docs.microsoft.com/dotnet/api/system.servicemodel.nettcpbinding?view=netframework-4.8).</span></span> <span data-ttu-id="0354b-134">Na rozdíl od NetTCP, který upřednostňuje Microsoft Stack, gRPC je mezi platformami.</span><span class="sxs-lookup"><span data-stu-id="0354b-134">Unlike NetTCP, which favors the Microsoft stack, gRPC is cross-platform.</span></span>

## <a name="protocol-buffers"></a><span data-ttu-id="0354b-135">Vyrovnávací paměti protokolů</span><span class="sxs-lookup"><span data-stu-id="0354b-135">Protocol Buffers</span></span>

<span data-ttu-id="0354b-136">gRPC zahrnuje Open Source technologie označované jako [vyrovnávací paměti protokolu](https://developers.google.com/protocol-buffers/docs/overview).</span><span class="sxs-lookup"><span data-stu-id="0354b-136">gRPC embraces an open-source technology called [Protocol Buffers](https://developers.google.com/protocol-buffers/docs/overview).</span></span> <span data-ttu-id="0354b-137">Poskytují vysoce efektivní a neutrální formát serializace pro serializaci strukturovaných zpráv, které služby odesílají vzájemně.</span><span class="sxs-lookup"><span data-stu-id="0354b-137">They provide a highly efficient and platform-neutral serialization format for serializing structured messages that services send to each other.</span></span> <span data-ttu-id="0354b-138">Pomocí jazyka IDL (Interface Definition Language) pro různé platformy, vývojáři definují kontrakt služby pro jednotlivé mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="0354b-138">Using a cross-platform Interface Definition Language (IDL), developers define a service contract for each microservice.</span></span> <span data-ttu-id="0354b-139">Kontrakt implementovaný jako textový `.proto` soubor, popisuje metody, vstupy a výstupy pro každou službu.</span><span class="sxs-lookup"><span data-stu-id="0354b-139">The contract, implemented as a text-based `.proto` file, describes the methods, inputs, and outputs for each service.</span></span> <span data-ttu-id="0354b-140">Stejný soubor kontraktu se dá použít pro gRPC klienty a služby postavené na různých vývojových platformách.</span><span class="sxs-lookup"><span data-stu-id="0354b-140">The same contract file can be used for gRPC clients and services built on different development platforms.</span></span>

<span data-ttu-id="0354b-141">Pomocí souboru. kompilátor Protobuf `protoc` vygeneruje kód klienta i služby pro vaši cílovou platformu.</span><span class="sxs-lookup"><span data-stu-id="0354b-141">Using the proto file, the Protobuf compiler, `protoc`, generates both client and service code for your target platform.</span></span> <span data-ttu-id="0354b-142">Kód zahrnuje následující součásti:</span><span class="sxs-lookup"><span data-stu-id="0354b-142">The code includes the following components:</span></span>

- <span data-ttu-id="0354b-143">Silně typované objekty, které sdílí klient a služba, které reprezentují operace služby a datové prvky pro zprávu.</span><span class="sxs-lookup"><span data-stu-id="0354b-143">Strongly typed objects, shared by the client and service, that represent the service operations and data elements for a message.</span></span>
- <span data-ttu-id="0354b-144">Základní třída se silnými typy s požadovanou síťovou síťovou instalací, kterou služba vzdálené gRPC může zdědit a rozšiřuje.</span><span class="sxs-lookup"><span data-stu-id="0354b-144">A strongly typed base class with the required network plumbing that the remote gRPC service can inherit and extend.</span></span>
- <span data-ttu-id="0354b-145">Klientský kód klienta, který obsahuje požadované instalace k vyvolání vzdálené služby gRPC.</span><span class="sxs-lookup"><span data-stu-id="0354b-145">A client stub that contains the required plumbing to invoke the remote gRPC service.</span></span>

<span data-ttu-id="0354b-146">Za běhu je každá zpráva serializována jako standardní reprezentace Protobuf a vyměněna mezi klientem a vzdálenou službou.</span><span class="sxs-lookup"><span data-stu-id="0354b-146">At runtime, each message is serialized as a standard Protobuf representation and exchanged between the client and remote service.</span></span> <span data-ttu-id="0354b-147">Na rozdíl od JSON nebo XML jsou zprávy Protobuf serializovány jako zkompilované binární bajty.</span><span class="sxs-lookup"><span data-stu-id="0354b-147">Unlike JSON or XML, Protobuf messages are serialized as compiled binary bytes.</span></span>

<span data-ttu-id="0354b-148">Kniha [gRPC pro vývojáře WCF](https://docs.microsoft.com/dotnet/architecture/grpc-for-wcf-developers/), která je dostupná na webu architektury Microsoftu, poskytuje podrobné pokrytí mezipamětí GRPC a protokolů.</span><span class="sxs-lookup"><span data-stu-id="0354b-148">The book, [gRPC for WCF Developers](https://docs.microsoft.com/dotnet/architecture/grpc-for-wcf-developers/), available from the Microsoft Architecture site, provides in-depth coverage of gRPC and Protocol Buffers.</span></span>

## <a name="grpc-support-in-net"></a><span data-ttu-id="0354b-149">Podpora gRPC v .NET</span><span class="sxs-lookup"><span data-stu-id="0354b-149">gRPC support in .NET</span></span>

<span data-ttu-id="0354b-150">gRPC je integrovaný do sady .NET Core 3,0 SDK a novější.</span><span class="sxs-lookup"><span data-stu-id="0354b-150">gRPC is integrated into .NET Core 3.0 SDK and later.</span></span> <span data-ttu-id="0354b-151">Následující nástroje ji podporují:</span><span class="sxs-lookup"><span data-stu-id="0354b-151">The following tools support it:</span></span>

- <span data-ttu-id="0354b-152">Visual Studio 2019, verze 16,3 nebo novější, s nainstalovanou úlohou vývoj webu.</span><span class="sxs-lookup"><span data-stu-id="0354b-152">Visual Studio 2019, version 16.3 or later, with the web development workload installed.</span></span>
- <span data-ttu-id="0354b-153">Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="0354b-153">Visual Studio Code</span></span>
- <span data-ttu-id="0354b-154">rozhraní příkazového řádku dotnet</span><span class="sxs-lookup"><span data-stu-id="0354b-154">the dotnet CLI</span></span>

<span data-ttu-id="0354b-155">Sada SDK obsahuje nástroje pro směrování koncových bodů, integrované IoC a protokolování.</span><span class="sxs-lookup"><span data-stu-id="0354b-155">The SDK includes tooling for endpoint routing, built-in IoC, and logging.</span></span> <span data-ttu-id="0354b-156">Open source webový server Kestrel podporuje připojení HTTP/2.</span><span class="sxs-lookup"><span data-stu-id="0354b-156">The open-source Kestrel web server supports HTTP/2 connections.</span></span> <span data-ttu-id="0354b-157">Obrázek 4-20 ukazuje šablonu sady Visual Studio 2019, která vygeneruje kostru projektu pro službu gRPC.</span><span class="sxs-lookup"><span data-stu-id="0354b-157">Figure 4-20 shows a Visual Studio 2019 template that scaffolds a skeleton project for a gRPC service.</span></span> <span data-ttu-id="0354b-158">Všimněte si, jak .NET Core plně podporuje Windows, Linux a macOS.</span><span class="sxs-lookup"><span data-stu-id="0354b-158">Note how .NET Core fully supports Windows, Linux, and macOS.</span></span>

![Podpora gRPC v aplikaci Visual Studio 2019](./media/visual-studio-2019-grpc-template.png)

<span data-ttu-id="0354b-160">**Obrázek 4-20**.</span><span class="sxs-lookup"><span data-stu-id="0354b-160">**Figure 4-20**.</span></span> <span data-ttu-id="0354b-161">Podpora gRPC v aplikaci Visual Studio 2019</span><span class="sxs-lookup"><span data-stu-id="0354b-161">gRPC support in Visual Studio 2019</span></span>
  
<span data-ttu-id="0354b-162">Obrázek 4-21 ukazuje kostru služby gRPC vygenerovanou z integrovaného generování uživatelského rozhraní, které je součástí sady Visual Studio 2019.</span><span class="sxs-lookup"><span data-stu-id="0354b-162">Figure 4-21 shows the skeleton gRPC service generated from the built-in scaffolding included in Visual Studio 2019.</span></span>  

![projekt gRPC v aplikaci Visual Studio 2019](./media/grpc-project.png  )

<span data-ttu-id="0354b-164">**Obrázek 4-21**.</span><span class="sxs-lookup"><span data-stu-id="0354b-164">**Figure 4-21**.</span></span> <span data-ttu-id="0354b-165">projekt gRPC v aplikaci Visual Studio 2019</span><span class="sxs-lookup"><span data-stu-id="0354b-165">gRPC project in Visual Studio 2019</span></span>

<span data-ttu-id="0354b-166">Na předchozím obrázku si poznamenejte soubor s popisem a kód služby.</span><span class="sxs-lookup"><span data-stu-id="0354b-166">In the previous figure, note the proto description file and service code.</span></span> <span data-ttu-id="0354b-167">Jak vidíte v krátké době, Visual Studio vygeneruje další konfiguraci jak ve třídě po spuštění, tak i v podkladovém souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="0354b-167">As you'll see shortly, Visual Studio generates additional configuration in both the Startup class and underlying project file.</span></span>

## <a name="grpc-usage"></a><span data-ttu-id="0354b-168">využití gRPC</span><span class="sxs-lookup"><span data-stu-id="0354b-168">gRPC usage</span></span>

<span data-ttu-id="0354b-169">Upřednostnit gRPC pro následující scénáře:</span><span class="sxs-lookup"><span data-stu-id="0354b-169">Favor gRPC for the following scenarios:</span></span>

- <span data-ttu-id="0354b-170">Synchronní back-end přenosná služba proti mikroslužbám, kde je pro pokračování v zpracování nutná okamžitá odpověď.</span><span class="sxs-lookup"><span data-stu-id="0354b-170">Synchronous backend microservice-to-microservice communication where an immediate response is required to continue processing.</span></span>
- <span data-ttu-id="0354b-171">Polyglot prostředí, která vyžadují podporu smíšených programovacích platforem.</span><span class="sxs-lookup"><span data-stu-id="0354b-171">Polyglot environments that need to support mixed programming platforms.</span></span>
- <span data-ttu-id="0354b-172">Nízká latence a komunikace s vysokou propustností, kde je výkon kritický.</span><span class="sxs-lookup"><span data-stu-id="0354b-172">Low latency and high throughput communication where performance is critical.</span></span>
- <span data-ttu-id="0354b-173">Komunikace Point-to-Point – gRPC může nabízet zprávy v reálném čase bez cyklického dotazování a má vynikající podporu pro obousměrné streamování.</span><span class="sxs-lookup"><span data-stu-id="0354b-173">Point-to-point real-time communication - gRPC can push messages in real time without polling and has excellent support for bi-directional streaming.</span></span>
- <span data-ttu-id="0354b-174">Omezená prostředí sítě – binární zprávy gRPC jsou vždycky menší než ekvivalentní textová zpráva JSON.</span><span class="sxs-lookup"><span data-stu-id="0354b-174">Network constrained environments – binary gRPC messages are always smaller than an equivalent text-based JSON message.</span></span>

<span data-ttu-id="0354b-175">V době psaní tohoto zápisu se gRPC primárně používá pro back-end služby.</span><span class="sxs-lookup"><span data-stu-id="0354b-175">At the time, of this writing, gRPC is primarily used with backend services.</span></span> <span data-ttu-id="0354b-176">Moderní prohlížeče nemůžou poskytovat úroveň ovládacího prvku HTTP/2, která je nutná k podpoře klienta front-endu gRPC.</span><span class="sxs-lookup"><span data-stu-id="0354b-176">Modern browsers can't provide the level of HTTP/2 control required to support a front-end gRPC client.</span></span> <span data-ttu-id="0354b-177">V takovém případě je k dispozici podpora [gRPC-web s rozhraním .NET](https://devblogs.microsoft.com/aspnet/grpc-web-for-net-now-available/) , která umožňuje komunikaci gRPC z aplikací založených na prohlížeči vytvořených pomocí JavaScriptu nebo Blazor WebAssembly technologií.</span><span class="sxs-lookup"><span data-stu-id="0354b-177">That said, there's support for [gRPC-Web with .NET](https://devblogs.microsoft.com/aspnet/grpc-web-for-net-now-available/) that enables gRPC communication from browser-based apps built with JavaScript or Blazor WebAssembly technologies.</span></span> <span data-ttu-id="0354b-178">[gRPC-web](https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-WEB.md) umožňuje aplikaci v aplikaci ASP.NET Core gRPC podporovat funkce gRPC v prohlížečových aplikacích:</span><span class="sxs-lookup"><span data-stu-id="0354b-178">[gRPC-Web](https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-WEB.md) enables an ASP.NET Core gRPC app to support gRPC features in browser apps:</span></span>

- <span data-ttu-id="0354b-179">Silně typované, klienti vygenerované kódem</span><span class="sxs-lookup"><span data-stu-id="0354b-179">Strongly typed, code-generated clients</span></span>
- <span data-ttu-id="0354b-180">Kompaktní zprávy Protobuf</span><span class="sxs-lookup"><span data-stu-id="0354b-180">Compact Protobuf messages</span></span>
- <span data-ttu-id="0354b-181">Streamování serveru</span><span class="sxs-lookup"><span data-stu-id="0354b-181">Server streaming</span></span>

## <a name="grpc-implementation"></a><span data-ttu-id="0354b-182">implementace gRPC</span><span class="sxs-lookup"><span data-stu-id="0354b-182">gRPC implementation</span></span>

<span data-ttu-id="0354b-183">Referenční architektura mikroslužeb, [eshop na kontejnerech](https://github.com/dotnet-architecture/eShopOnContainers), od Microsoftu, ukazuje, jak implementovat služby gRPC v aplikacích .NET Core.</span><span class="sxs-lookup"><span data-stu-id="0354b-183">The microservice reference architecture, [eShop on Containers](https://github.com/dotnet-architecture/eShopOnContainers), from Microsoft, shows how to implement gRPC services in .NET Core applications.</span></span> <span data-ttu-id="0354b-184">Obrázek 4-22 prezentuje architekturu back-endu.</span><span class="sxs-lookup"><span data-stu-id="0354b-184">Figure 4-22 presents the back-end architecture.</span></span>

![Architektura back-endu pro eShop na kontejnerech](./media/eshop-with-aggregators.png)

<span data-ttu-id="0354b-186">**Obrázek 4-22**.</span><span class="sxs-lookup"><span data-stu-id="0354b-186">**Figure 4-22**.</span></span> <span data-ttu-id="0354b-187">Architektura back-endu pro eShop na kontejnerech</span><span class="sxs-lookup"><span data-stu-id="0354b-187">Backend architecture for eShop on Containers</span></span>

<span data-ttu-id="0354b-188">Na předchozím obrázku si všimněte, jak eShop zahrnuje [back-end pro model front-endu](https://docs.microsoft.com/azure/architecture/patterns/backends-for-frontends) (BFF) vystavení více bran rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="0354b-188">In the previous figure, note how eShop embraces the [Backend for Frontends pattern](https://docs.microsoft.com/azure/architecture/patterns/backends-for-frontends) (BFF) by exposing multiple API gateways.</span></span> <span data-ttu-id="0354b-189">Probrali jsme vzor BFF dříve v této kapitole.</span><span class="sxs-lookup"><span data-stu-id="0354b-189">We discussed the BFF pattern earlier in this chapter.</span></span> <span data-ttu-id="0354b-190">Věnujte pozornost špičkové mikroslužbě Agregátoru (v šedé), která je umístěná mezi webovými a koncovými mikroslužbami rozhraní API pro web a back-end.</span><span class="sxs-lookup"><span data-stu-id="0354b-190">Pay close attention to the Aggregator microservice (in gray) that sits between the Web-Shopping API Gateway and backend Shopping microservices.</span></span> <span data-ttu-id="0354b-191">Agregátor obdrží jeden požadavek od klienta, odešle ho do různých mikroslužeb, agreguje výsledky a pošle je zpět žádajícímu klientovi.</span><span class="sxs-lookup"><span data-stu-id="0354b-191">The Aggregator receives a single request from a client, dispatches it to various microservices, aggregates the results, and sends them back to the requesting client.</span></span> <span data-ttu-id="0354b-192">Tyto operace obvykle vyžadují synchronní komunikaci, aby se vytvořila Okamžitá odezva.</span><span class="sxs-lookup"><span data-stu-id="0354b-192">Such operations typically require synchronous communication as to produce an immediate response.</span></span> <span data-ttu-id="0354b-193">V eShop volání back-endu z Agregátoru se provádí pomocí gRPC, jak je znázorněno na obrázku 4-23.</span><span class="sxs-lookup"><span data-stu-id="0354b-193">In eShop, backend calls from the Aggregator are performed using gRPC as shown in Figure 4-23.</span></span>

![gRPC v eShop na kontejnerech](./media/grpc-implementation.png)

<span data-ttu-id="0354b-195">**Obrázek 4-23**.</span><span class="sxs-lookup"><span data-stu-id="0354b-195">**Figure 4-23**.</span></span> <span data-ttu-id="0354b-196">gRPC v eShop na kontejnerech</span><span class="sxs-lookup"><span data-stu-id="0354b-196">gRPC in eShop on Containers</span></span>

<span data-ttu-id="0354b-197">gRPC komunikace vyžaduje součásti klienta i serveru.</span><span class="sxs-lookup"><span data-stu-id="0354b-197">gRPC communication requires both client and server components.</span></span> <span data-ttu-id="0354b-198">Na předchozím obrázku si všimněte, jak nákupní agregátor implementuje klienta gRPC.</span><span class="sxs-lookup"><span data-stu-id="0354b-198">In the previous figure, note how the Shopping Aggregator implements a gRPC client.</span></span> <span data-ttu-id="0354b-199">Klient provádí synchronní volání gRPC (červeně) na mikroslužby back-end, z nichž každá implementuje Server gRPC.</span><span class="sxs-lookup"><span data-stu-id="0354b-199">The client makes synchronous gRPC calls (in red) to backend microservices, each of which implement a gRPC server.</span></span> <span data-ttu-id="0354b-200">Klient i server využívají integrované gRPC domovní instalace z .NET Core SDK.</span><span class="sxs-lookup"><span data-stu-id="0354b-200">Both the client and server take advantage of the built-in gRPC plumbing from the .NET Core SDK.</span></span> <span data-ttu-id="0354b-201">Zástupné *procedury* na straně klienta poskytují k vyvolání vzdálených volání gRPC k dispozici instalace.</span><span class="sxs-lookup"><span data-stu-id="0354b-201">Client-side *stubs* provide the plumbing to invoke remote gRPC calls.</span></span> <span data-ttu-id="0354b-202">Komponenty na straně serveru poskytují gRPC domovníing, které vlastní třídy služeb můžou dědit a spotřebovat.</span><span class="sxs-lookup"><span data-stu-id="0354b-202">Server-side components provide gRPC plumbing that custom service classes can inherit and consume.</span></span>

<span data-ttu-id="0354b-203">Mikroslužby, které zveřejňují RESTful API a gRPC komunikaci, vyžadují ke správě provozu několik koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="0354b-203">Microservices that expose both a RESTful API and gRPC communication require multiple endpoints to manage traffic.</span></span> <span data-ttu-id="0354b-204">Otevřeli jste koncový bod, který naslouchá přenosu HTTP pro volání RESTful a další pro volání gRPC.</span><span class="sxs-lookup"><span data-stu-id="0354b-204">You would open an endpoint that listens for HTTP traffic for the RESTful calls and another for gRPC calls.</span></span> <span data-ttu-id="0354b-205">Koncový bod gRPC musí být konfigurován pro protokol HTTP/2, který je požadován pro komunikaci gRPC.</span><span class="sxs-lookup"><span data-stu-id="0354b-205">The gRPC endpoint must be configured for the HTTP/2 protocol that is required for gRPC communication.</span></span>

<span data-ttu-id="0354b-206">I když se snažíme oddělit mikroslužby pomocí asynchronních komunikačních vzorů, některé operace vyžadují přímé volání.</span><span class="sxs-lookup"><span data-stu-id="0354b-206">While we strive to decouple microservices with asynchronous communication patterns, some operations require direct calls.</span></span> <span data-ttu-id="0354b-207">gRPC by měla být primární volbou pro přímou synchronní komunikaci mezi mikroslužbami.</span><span class="sxs-lookup"><span data-stu-id="0354b-207">gRPC should be the primary choice for direct synchronous communication between microservices.</span></span> <span data-ttu-id="0354b-208">Svůj vysoce výkonný komunikační protokol založený na protokolech HTTP/2 a vyrovnávacích pamětí protokolu se dá perfektní volbou.</span><span class="sxs-lookup"><span data-stu-id="0354b-208">Its high-performance communication protocol, based on HTTP/2 and protocol buffers, make it a perfect choice.</span></span>

## <a name="looking-ahead"></a><span data-ttu-id="0354b-209">Pohled dopředu</span><span class="sxs-lookup"><span data-stu-id="0354b-209">Looking ahead</span></span>

<span data-ttu-id="0354b-210">GRPC se bude i nadále používat pro cloudové nativní systémy.</span><span class="sxs-lookup"><span data-stu-id="0354b-210">Looking ahead, gRPC will continue to gain traction for cloud-native systems.</span></span> <span data-ttu-id="0354b-211">Výhody výkonu a jednoduchost vývoje jsou přesvědčivé.</span><span class="sxs-lookup"><span data-stu-id="0354b-211">The performance benefits and ease of development are compelling.</span></span> <span data-ttu-id="0354b-212">Klid však bude pravděpodobně přibližně delší dobu trvat.</span><span class="sxs-lookup"><span data-stu-id="0354b-212">However, REST will likely be around for a long time.</span></span> <span data-ttu-id="0354b-213">IT Excelu pro veřejně vystavená rozhraní API a z důvodů zpětné kompatibility.</span><span class="sxs-lookup"><span data-stu-id="0354b-213">It excels for publicly exposed APIs and for backward compatibility reasons.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="0354b-214">[Předchozí](service-to-service-communication.md) 
> [Další](service-mesh-communication-infrastructure.md)</span><span class="sxs-lookup"><span data-stu-id="0354b-214">[Previous](service-to-service-communication.md)
[Next](service-mesh-communication-infrastructure.md)</span></span>
