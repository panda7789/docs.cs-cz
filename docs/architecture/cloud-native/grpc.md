---
title: gRPC
description: Další informace o gRPC, jeho roli v cloud-nativní aplikace, a jak se liší od HTTP RESTful komunikace.
author: robvet
ms.date: 03/31/2020
ms.openlocfilehash: 28a07ad5ec105d3fc5b65e4cf0ac0cd85eb16627
ms.sourcegitcommit: 79b0dd8bfc63f33a02137121dd23475887ecefda
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/01/2020
ms.locfileid: "80524171"
---
# <a name="grpc"></a><span data-ttu-id="13da4-103">gRPC</span><span class="sxs-lookup"><span data-stu-id="13da4-103">gRPC</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="13da4-104">Zatím jsme se v této knize zaměřili na komunikaci [založenou na REST.](https://docs.microsoft.com/azure/architecture/best-practices/api-design)</span><span class="sxs-lookup"><span data-stu-id="13da4-104">So far in this book, we've focused on [REST-based](https://docs.microsoft.com/azure/architecture/best-practices/api-design) communication.</span></span> <span data-ttu-id="13da4-105">Viděli jsme, že REST je flexibilní architektonický styl, který definuje operace založené na CRUD proti prostředkům entity.</span><span class="sxs-lookup"><span data-stu-id="13da4-105">We've seen that REST is a flexible architectural style that defines CRUD-based operations against entity resources.</span></span> <span data-ttu-id="13da4-106">Klienti interagují s prostředky v rámci protokolu HTTP pomocí modelu komunikace požadavku a odpovědi.</span><span class="sxs-lookup"><span data-stu-id="13da4-106">Clients interact with resources across HTTP with a request/response communication model.</span></span> <span data-ttu-id="13da4-107">Zatímco REST je široce implementována, novější komunikační technologie, gRPC, získala obrovskou dynamiku v celé komunitě nativní pro cloud.</span><span class="sxs-lookup"><span data-stu-id="13da4-107">While REST is widely implemented, a newer communication technology, gRPC, has gained tremendous momentum across the cloud-native community.</span></span>

## <a name="what-is-grpc"></a><span data-ttu-id="13da4-108">Co je gRPC?</span><span class="sxs-lookup"><span data-stu-id="13da4-108">What is gRPC?</span></span>

<span data-ttu-id="13da4-109">gRPC je moderní, vysoce výkonný rámec, který vyvíjí starý [protokol vzdáleného volání procedur (RPC).](https://en.wikipedia.org/wiki/Remote_procedure_call)</span><span class="sxs-lookup"><span data-stu-id="13da4-109">gRPC is a modern, high-performance framework that evolves the age-old [remote procedure call (RPC)](https://en.wikipedia.org/wiki/Remote_procedure_call) protocol.</span></span> <span data-ttu-id="13da4-110">Na úrovni aplikace gRPC zjednodušuje zasílání zpráv mezi klienty a back-endové služby.</span><span class="sxs-lookup"><span data-stu-id="13da4-110">At the application level, gRPC streamlines messaging between clients and back-end services.</span></span> <span data-ttu-id="13da4-111">GRPC, pocházející z Googlu, je open source a je součástí ekosystému [Cloud Native Computing Foundation (CNCF)](https://www.cncf.io/) nativních cloudových nabídek.</span><span class="sxs-lookup"><span data-stu-id="13da4-111">Originating from Google, gRPC is open source and part of the  [Cloud Native Computing Foundation (CNCF)](https://www.cncf.io/) ecosystem of cloud-native offerings.</span></span> <span data-ttu-id="13da4-112">CNCF považuje gRPC za [inkubační projekt](https://github.com/cncf/toc/blob/master/process/graduation_criteria.adoc).</span><span class="sxs-lookup"><span data-stu-id="13da4-112">CNCF considers gRPC an [incubating project](https://github.com/cncf/toc/blob/master/process/graduation_criteria.adoc).</span></span> <span data-ttu-id="13da4-113">Inkubace znamená, že koncoví uživatelé používají technologii ve výrobních aplikacích a projekt má zdravý počet přispěvatelů.</span><span class="sxs-lookup"><span data-stu-id="13da4-113">Incubating means end users are using the technology in production applications, and the project has a healthy number of contributors.</span></span>

<span data-ttu-id="13da4-114">Typická klientská aplikace gRPC zpřístupní místní v procesu, která implementuje obchodní operaci.</span><span class="sxs-lookup"><span data-stu-id="13da4-114">A typical gRPC client app will expose a local, in-process function that implements a business operation.</span></span> <span data-ttu-id="13da4-115">Pod kryty, že místní funkce vyvolá jinou funkci na vzdáleném počítači.</span><span class="sxs-lookup"><span data-stu-id="13da4-115">Under the covers, that local function invokes another function on a remote machine.</span></span> <span data-ttu-id="13da4-116">Co se zdá být místní volání v podstatě stane transparentní mimoprocesvolání vzdálené služby.</span><span class="sxs-lookup"><span data-stu-id="13da4-116">What appears to be a local call essentially becomes a transparent out-of-process call to a remote service.</span></span> <span data-ttu-id="13da4-117">Instalace vzdáleného volání procedur abstrahuje komunikaci, serializaci a provádění sítí typu point-to-point mezi počítači.</span><span class="sxs-lookup"><span data-stu-id="13da4-117">The RPC plumbing abstracts the point-to-point networking communication, serialization, and execution between computers.</span></span>

<span data-ttu-id="13da4-118">V aplikacích nativních pro cloud vývojáři často pracují napříč programovacími jazyky, architekturami a technologiemi.</span><span class="sxs-lookup"><span data-stu-id="13da4-118">In cloud-native applications, developers often work across programming languages, frameworks, and technologies.</span></span> <span data-ttu-id="13da4-119">Tato *interoperabilita* komplikuje smlouvy o smenít a instalatérské práce potřebné pro komunikaci mezi platformami.</span><span class="sxs-lookup"><span data-stu-id="13da4-119">This *interoperability* complicates message contracts and the plumbing required for cross-platform communication.</span></span>  <span data-ttu-id="13da4-120">gRPC poskytuje "jednotnou vodorovnou vrstvu", která tyto obavy abstrahuje.</span><span class="sxs-lookup"><span data-stu-id="13da4-120">gRPC provides a "uniform horizontal layer" that abstracts these concerns.</span></span> <span data-ttu-id="13da4-121">Vývojáři kód v jejich nativní platformě zaměřené na obchodní funkce, zatímco gRPC zpracovává komunikaci instalatérské práce.</span><span class="sxs-lookup"><span data-stu-id="13da4-121">Developers code in their native platform focused on business functionality, while gRPC handles communication plumbing.</span></span>

<span data-ttu-id="13da4-122">gRPC nabízí komplexní podporu napříč nejoblíbenějšími vývojovými zásobníky, včetně Java, JavaScriptu, C#, Go, Swiftu a NodeJS.</span><span class="sxs-lookup"><span data-stu-id="13da4-122">gRPC offers comprehensive support across most popular development stacks, including Java, JavaScript, C#, Go, Swift, and NodeJS.</span></span>

## <a name="grpc-benefits"></a><span data-ttu-id="13da4-123">gRPC Výhody</span><span class="sxs-lookup"><span data-stu-id="13da4-123">gRPC Benefits</span></span>

<span data-ttu-id="13da4-124">gRPC používá HTTP/2 pro svůj transportní protokol.</span><span class="sxs-lookup"><span data-stu-id="13da4-124">gRPC uses HTTP/2 for its transport protocol.</span></span> <span data-ttu-id="13da4-125">Zatímco je kompatibilní s HTTP 1.1, HTTP/2 nabízí mnoho pokročilých funkcí:</span><span class="sxs-lookup"><span data-stu-id="13da4-125">While compatible with HTTP 1.1, HTTP/2 features many advanced capabilities:</span></span>

- <span data-ttu-id="13da4-126">Binární protokol pro přenos dat - na rozdíl od HTTP 1.1, který odesílá data jako jasný text.</span><span class="sxs-lookup"><span data-stu-id="13da4-126">A binary protocol for data transport - unlike HTTP 1.1, which sends data as clear text.</span></span>
- <span data-ttu-id="13da4-127">Podpora multiplexování pro odesílání více paralelních požadavků přes stejné připojení - HTTP 1.1 omezuje zpracování na jednu zprávu požadavku a odpovědi najednou.</span><span class="sxs-lookup"><span data-stu-id="13da4-127">Multiplexing support for sending multiple parallel requests over the same connection - HTTP 1.1 limits processing to one request/response message at a time.</span></span>
- <span data-ttu-id="13da4-128">Obousměrná plně duplexní komunikace pro současné odesílání požadavků klientů i odpovědí serveru.</span><span class="sxs-lookup"><span data-stu-id="13da4-128">Bidirectional full-duplex communication for sending both client requests and server responses simultaneously.</span></span>
- <span data-ttu-id="13da4-129">Integrované streamování umožňující požadavky a odpovědi na asynchronně streamovat velké datové sady.</span><span class="sxs-lookup"><span data-stu-id="13da4-129">Built-in streaming enabling requests and responses to asynchronously stream large data sets.</span></span>

<span data-ttu-id="13da4-130">gRPC je lehký a vysoce výkonný.</span><span class="sxs-lookup"><span data-stu-id="13da4-130">gRPC is lightweight and highly performant.</span></span> <span data-ttu-id="13da4-131">Může být až 8x rychlejší než serializace JSON se zprávami o 60-80% menšími.</span><span class="sxs-lookup"><span data-stu-id="13da4-131">It can be up to 8x faster than JSON serialization with messages 60-80% smaller.</span></span> <span data-ttu-id="13da4-132">V jazyce [WCF (Microsoft Windows Communication Foundation)](https://docs.microsoft.com/dotnet/framework/wcf/whats-wcf) překračuje výkon gRPC rychlost a efektivitu vysoce optimalizovaných [vazeb NetTCP](https://docs.microsoft.com/dotnet/api/system.servicemodel.nettcpbinding?view=netframework-4.8).</span><span class="sxs-lookup"><span data-stu-id="13da4-132">In Microsoft [Windows Communication Foundation (WCF)](https://docs.microsoft.com/dotnet/framework/wcf/whats-wcf) parlance, gRPC performance exceeds the speed and efficiency of the highly optimized [NetTCP bindings](https://docs.microsoft.com/dotnet/api/system.servicemodel.nettcpbinding?view=netframework-4.8).</span></span> <span data-ttu-id="13da4-133">Na rozdíl od NetTCP, který upřednostňuje microsoft zásobníku, gRPC je cross-platformní.</span><span class="sxs-lookup"><span data-stu-id="13da4-133">Unlike NetTCP, which favors the Microsoft stack, gRPC is cross-platform.</span></span>

## <a name="protocol-buffers"></a><span data-ttu-id="13da4-134">Vyrovnávací paměti protokolů</span><span class="sxs-lookup"><span data-stu-id="13da4-134">Protocol Buffers</span></span>

<span data-ttu-id="13da4-135">gRPC zahrnuje technologii s otevřeným zdrojovým kódem nazvanou [Protocol Buffers](https://developers.google.com/protocol-buffers/docs/overview).</span><span class="sxs-lookup"><span data-stu-id="13da4-135">gRPC embraces an open-source technology called [Protocol Buffers](https://developers.google.com/protocol-buffers/docs/overview).</span></span> <span data-ttu-id="13da4-136">Poskytují vysoce efektivní a neutrální serializační formát pro serializaci strukturovaných zpráv, které si služby vzájemně odesílají.</span><span class="sxs-lookup"><span data-stu-id="13da4-136">They provide a highly efficient and platform-neutral serialization format for serializing structured messages that services send to each other.</span></span> <span data-ttu-id="13da4-137">Pomocí jazyka IDL (Interface Definition Language) napříč platformami definují vývojáři smlouvu o poskytování služeb pro každou mikroslužbu.</span><span class="sxs-lookup"><span data-stu-id="13da4-137">Using a cross-platform Interface Definition Language (IDL), developers define a service contract for each microservice.</span></span> <span data-ttu-id="13da4-138">Kontrakt, implementovaný jako textový `.proto` soubor, popisuje metody, vstupy a výstupy pro každou službu.</span><span class="sxs-lookup"><span data-stu-id="13da4-138">The contract, implemented as a text-based `.proto` file, describes the methods, inputs, and outputs for each service.</span></span> <span data-ttu-id="13da4-139">Stejný soubor smlouvy lze použít pro klienty gRPC a služby postavené na různých vývojových platformách.</span><span class="sxs-lookup"><span data-stu-id="13da4-139">The same contract file can be used for gRPC clients and services built on different development platforms.</span></span>

<span data-ttu-id="13da4-140">Pomocí proto souboru kompilátor Protobuf , `protoc`generuje kód klienta i služby pro cílovou platformu.</span><span class="sxs-lookup"><span data-stu-id="13da4-140">Using the proto file, the Protobuf compiler, `protoc`, generates both client and service code for your target platform.</span></span> <span data-ttu-id="13da4-141">Kód obsahuje následující součásti:</span><span class="sxs-lookup"><span data-stu-id="13da4-141">The code includes the following components:</span></span>

- <span data-ttu-id="13da4-142">Objekty silného typu sdílené klientem a službou, které představují operace služby a datové prvky pro zprávu.</span><span class="sxs-lookup"><span data-stu-id="13da4-142">Strongly-typed objects, shared by the client and service, that represent the service operations and data elements for a message.</span></span>
- <span data-ttu-id="13da4-143">Základní třída silného typu s požadovanou síťovou inmisací, kterou může vzdálená služba gRPC dědit a rozšiřovat.</span><span class="sxs-lookup"><span data-stu-id="13da4-143">A strongly-typed base class with the required network plumbing that the remote gRPC service can inherit and extend.</span></span>
- <span data-ttu-id="13da4-144">Se zakázaným inzerováním klienta, který obsahuje požadované instalace k vyvolání vzdálené služby gRPC.</span><span class="sxs-lookup"><span data-stu-id="13da4-144">A client stub that contains the required plumbing to invoke the remote gRPC service.</span></span>

<span data-ttu-id="13da4-145">Za běhu je každá zpráva serializována jako standardní reprezentace Protobuf a vyměňována mezi klientem a vzdálenou službou.</span><span class="sxs-lookup"><span data-stu-id="13da4-145">At runtime, each message is serialized as a standard Protobuf representation and exchanged between the client and remote service.</span></span> <span data-ttu-id="13da4-146">Na rozdíl od JSON nebo XML protobuf zprávy jsou serializovány jako kompilované binární bajty.</span><span class="sxs-lookup"><span data-stu-id="13da4-146">Unlike JSON or XML, Protobuf messages are serialized as compiled binary bytes.</span></span>

<span data-ttu-id="13da4-147">Kniha [gRPC pro vývojáře WCF](https://docs.microsoft.com/dotnet/architecture/grpc-for-wcf-developers/), která je k dispozici na webu Microsoft Architecture, poskytuje podrobné pokrytí vyrovnávacích pamětí gRPC a protokolu.</span><span class="sxs-lookup"><span data-stu-id="13da4-147">The book, [gRPC for WCF Developers](https://docs.microsoft.com/dotnet/architecture/grpc-for-wcf-developers/), available from the Microsoft Architecture site, provides in-depth coverage of gRPC and Protocol Buffers.</span></span>

## <a name="grpc-support-in-net"></a><span data-ttu-id="13da4-148">podpora gRPC v rozhraní .NET</span><span class="sxs-lookup"><span data-stu-id="13da4-148">gRPC support in .NET</span></span>

<span data-ttu-id="13da4-149">gRPC je integrován do sady .NET Core 3.0 SDK nebo novější.</span><span class="sxs-lookup"><span data-stu-id="13da4-149">gRPC is integrated into .NET Core 3.0 SDK or later.</span></span> <span data-ttu-id="13da4-150">Podporují následující nástroje:</span><span class="sxs-lookup"><span data-stu-id="13da4-150">The following tools support it:</span></span>

- <span data-ttu-id="13da4-151">Visual Studio 2019, verze 16.3 nebo novější, s nainstalovanou úlohou pro vývoj webu.</span><span class="sxs-lookup"><span data-stu-id="13da4-151">Visual Studio 2019, version 16.3 or later, with the web development workload installed.</span></span>
- <span data-ttu-id="13da4-152">Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="13da4-152">Visual Studio Code</span></span>
- <span data-ttu-id="13da4-153">rozhraní SE kontinu pro dotnet</span><span class="sxs-lookup"><span data-stu-id="13da4-153">the dotnet CLI</span></span>

<span data-ttu-id="13da4-154">Sada SDK obsahuje nástroje pro směrování koncových bodů, integrované ioc a protokolování.</span><span class="sxs-lookup"><span data-stu-id="13da4-154">The SDK includes tooling for endpoint routing, built-in IoC, and logging.</span></span> <span data-ttu-id="13da4-155">Open source webový server Kestrel podporuje připojení HTTP/2.</span><span class="sxs-lookup"><span data-stu-id="13da4-155">The open-source Kestrel web server supports HTTP/2 connections.</span></span> <span data-ttu-id="13da4-156">Obrázek 4-20 znázorňuje šablonu Visual Studia 2019, která veleše kostru projektu pro službu gRPC.</span><span class="sxs-lookup"><span data-stu-id="13da4-156">Figure 4-20 shows a Visual Studio 2019 template that scaffolds a skeleton project for a gRPC service.</span></span> <span data-ttu-id="13da4-157">Všimněte si, jak rozhraní .NET Core plně podporuje Windows, Linux a macOS.</span><span class="sxs-lookup"><span data-stu-id="13da4-157">Note how .NET Core fully supports Windows, Linux, and macOS.</span></span>

![podpora gRPC ve Visual Studiu 2019](./media/visual-studio-2019-grpc-template.png)

<span data-ttu-id="13da4-159">**Obrázek 4-20**.</span><span class="sxs-lookup"><span data-stu-id="13da4-159">**Figure 4-20**.</span></span> <span data-ttu-id="13da4-160">podpora gRPC ve Visual Studiu 2019</span><span class="sxs-lookup"><span data-stu-id="13da4-160">gRPC support in Visual Studio 2019</span></span>
  
<span data-ttu-id="13da4-161">Obrázek 4-21 znázorňuje službu kostry gRPC vygenerovanou z integrovaného lešení, které je součástí sady Visual Studio 2019.</span><span class="sxs-lookup"><span data-stu-id="13da4-161">Figure 4-21 shows the skeleton gRPC service generated from the built-in scaffolding included in Visual Studio 2019.</span></span>  

![projekt gRPC v Sadě Visual Studio 2019](./media/grpc-project.png  )

<span data-ttu-id="13da4-163">**Obrázek 4-21**.</span><span class="sxs-lookup"><span data-stu-id="13da4-163">**Figure 4-21**.</span></span> <span data-ttu-id="13da4-164">projekt gRPC v Sadě Visual Studio 2019</span><span class="sxs-lookup"><span data-stu-id="13da4-164">gRPC project in Visual Studio 2019</span></span>

<span data-ttu-id="13da4-165">Na předchozím obrázku si poznamenejte soubor popisu proto a kód služby.</span><span class="sxs-lookup"><span data-stu-id="13da4-165">In the previous figure, note the proto description file and service code.</span></span> <span data-ttu-id="13da4-166">Jak uvidíte v nejbližší době, Visual Studio generuje další konfiguraci v spouštěcí třídě i základní soubor projektu.</span><span class="sxs-lookup"><span data-stu-id="13da4-166">As you'll see shortly, Visual Studio generates additional configuration in both the Startup class and underlying project file.</span></span>

## <a name="grpc-usage"></a><span data-ttu-id="13da4-167">gRPC použití</span><span class="sxs-lookup"><span data-stu-id="13da4-167">gRPC usage</span></span>

<span data-ttu-id="13da4-168">Favor gRPC pro následující scénáře:</span><span class="sxs-lookup"><span data-stu-id="13da4-168">Favor gRPC for the following scenarios:</span></span>

- <span data-ttu-id="13da4-169">Synchronní back-endmikroslužeb mikroslužeb, kde je nutná okamžitá odpověď pokračovat ve zpracování.</span><span class="sxs-lookup"><span data-stu-id="13da4-169">Synchronous backend microservice-to-microservice communication where an immediate response is required to continue processing.</span></span>
- <span data-ttu-id="13da4-170">Polyglot prostředí, které potřebují k podpoře smíšené programovací platformy.</span><span class="sxs-lookup"><span data-stu-id="13da4-170">Polyglot environments that need to support mixed programming platforms.</span></span>
- <span data-ttu-id="13da4-171">Nízká latence a vysoká propustnost komunikace, kde je rozhodující výkon.</span><span class="sxs-lookup"><span data-stu-id="13da4-171">Low latency and high throughput communication where performance is critical.</span></span>
- <span data-ttu-id="13da4-172">Komunikace v reálném čase point-to-point - gRPC může tlačit zprávy v reálném čase bez dotazování a má vynikající podporu obousměrného streamování.</span><span class="sxs-lookup"><span data-stu-id="13da4-172">Point-to-point real-time communication - gRPC can push messages in real time without polling and has excellent support for bi-directional streaming.</span></span>
- <span data-ttu-id="13da4-173">Síťově omezená prostředí – binární gRPC zprávy jsou vždy menší než ekvivalentní textová zpráva JSON.</span><span class="sxs-lookup"><span data-stu-id="13da4-173">Network constrained environments – binary gRPC messages are always smaller than an equivalent text-based JSON message.</span></span>

<span data-ttu-id="13da4-174">V té době, tohoto psaní, gRPC se používá především s back-endové služby.</span><span class="sxs-lookup"><span data-stu-id="13da4-174">At the time, of this writing, gRPC is primarily used with backend services.</span></span> <span data-ttu-id="13da4-175">Většina moderních prohlížečů nemůže poskytnout úroveň ovládacího prvku HTTP/2 potřebnou pro podporu front-endového gRPC klienta.</span><span class="sxs-lookup"><span data-stu-id="13da4-175">Most modern browsers can't provide the level of HTTP/2 control required to support a front-end gRPC client.</span></span> <span data-ttu-id="13da4-176">To znamená, že je tu [brzy iniciativa,](https://devblogs.microsoft.com/aspnet/grpc-web-experiment/) která umožňuje gRPC komunikaci z prohlížeče-založené aplikace postavené s JavaScript nebo Blazor WebAssembly technologií.</span><span class="sxs-lookup"><span data-stu-id="13da4-176">That said, there's an [early initiative](https://devblogs.microsoft.com/aspnet/grpc-web-experiment/) that enables gRPC communication from browser-based apps built with JavaScript or Blazor WebAssembly technologies.</span></span> <span data-ttu-id="13da4-177">[GRPC-Web pro rozhraní .NET](https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-WEB.md) umožňuje aplikaci ASP.NET Core gRPC podporovat funkce gRPC v aplikacích prohlížeče:</span><span class="sxs-lookup"><span data-stu-id="13da4-177">The  [gRPC-Web for .NET](https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-WEB.md) enables an ASP.NET Core gRPC app to support gRPC features in browser apps:</span></span>

- <span data-ttu-id="13da4-178">Klienti generovaný kódem silného typu</span><span class="sxs-lookup"><span data-stu-id="13da4-178">Strongly-typed code-generated clients</span></span>
- <span data-ttu-id="13da4-179">Kompaktní zprávy Protobuf</span><span class="sxs-lookup"><span data-stu-id="13da4-179">Compact Protobuf messages</span></span>
- <span data-ttu-id="13da4-180">Serverové vysílání</span><span class="sxs-lookup"><span data-stu-id="13da4-180">Server streaming</span></span>

## <a name="grpc-implementation"></a><span data-ttu-id="13da4-181">gRPC implementace</span><span class="sxs-lookup"><span data-stu-id="13da4-181">gRPC implementation</span></span>

<span data-ttu-id="13da4-182">Referenční architektura mikroslužeb, [eShop na kontejnerech od Microsoftu,](https://github.com/dotnet-architecture/eShopOnContainers)ukazuje, jak implementovat služby gRPC v aplikacích .NET Core.</span><span class="sxs-lookup"><span data-stu-id="13da4-182">The microservice reference architecture, [eShop on Containers](https://github.com/dotnet-architecture/eShopOnContainers), from Microsoft, shows how to implement gRPC services in .NET Core applications.</span></span> <span data-ttu-id="13da4-183">Obrázek 4-22 představuje back-end architekturu.</span><span class="sxs-lookup"><span data-stu-id="13da4-183">Figure 4-22 presents the back-end architecture.</span></span>

![Backendová architektura pro eShop na kontejnerech](./media/eshop-with-aggregators.png)

<span data-ttu-id="13da4-185">**Obrázek 4-22**.</span><span class="sxs-lookup"><span data-stu-id="13da4-185">**Figure 4-22**.</span></span> <span data-ttu-id="13da4-186">Backendová architektura pro eShop na kontejnerech</span><span class="sxs-lookup"><span data-stu-id="13da4-186">Backend architecture for eShop on Containers</span></span>

<span data-ttu-id="13da4-187">Na předchozím obrázku si všimněte, jak eShop zahrnuje [back-end pro frontendy vzoru](https://docs.microsoft.com/azure/architecture/patterns/backends-for-frontends) (BFF) tím, že vystavuje více bran rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="13da4-187">In the previous figure, note how eShop embraces the [Backend for Frontends pattern](https://docs.microsoft.com/azure/architecture/patterns/backends-for-frontends) (BFF) by exposing multiple API gateways.</span></span> <span data-ttu-id="13da4-188">Diskutovali jsme o vzoru BFF dříve v této kapitole.</span><span class="sxs-lookup"><span data-stu-id="13da4-188">We discussed the BFF pattern earlier in this chapter.</span></span> <span data-ttu-id="13da4-189">Věnujte velkou pozornost mikroslužbě Agregátor (šedě), která je na místě mezi bránou rozhraní API web-shopping a back-endem nákupních mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="13da4-189">Pay close attention to the Aggregator microservice (in gray) that sits between the Web-Shopping API Gateway and backend Shopping microservices.</span></span> <span data-ttu-id="13da4-190">Agregátor obdrží jeden požadavek od klienta, odešle jej do různých mikroslužeb, agreguje výsledky a odešle je zpět žádajícímu klientovi.</span><span class="sxs-lookup"><span data-stu-id="13da4-190">The Aggregator receives a single request from a client, dispatches it to various microservices, aggregates the results, and sends them back to the requesting client.</span></span> <span data-ttu-id="13da4-191">Tyto operace obvykle vyžadují synchronní komunikaci, aby vznikla okamžitá odpověď.</span><span class="sxs-lookup"><span data-stu-id="13da4-191">Such operations typically require synchronous communication as to produce an immediate response.</span></span> <span data-ttu-id="13da4-192">V eShopu se back-endové hovory z agregátoru provádějí pomocí gRPC, jak je znázorněno na obrázku 4-23.</span><span class="sxs-lookup"><span data-stu-id="13da4-192">In eShop, backend calls from the Aggregator are performed using gRPC as shown in Figure 4-23.</span></span>

![gRPC v eShopu na kontejnerech](./media/grpc-implementation.png)

<span data-ttu-id="13da4-194">**Obrázek 4-23**.</span><span class="sxs-lookup"><span data-stu-id="13da4-194">**Figure 4-23**.</span></span> <span data-ttu-id="13da4-195">gRPC v eShopu na kontejnerech</span><span class="sxs-lookup"><span data-stu-id="13da4-195">gRPC in eShop on Containers</span></span>

<span data-ttu-id="13da4-196">gRPC komunikace vyžaduje klientské i serverové komponenty.</span><span class="sxs-lookup"><span data-stu-id="13da4-196">gRPC communication requires both client and server components.</span></span> <span data-ttu-id="13da4-197">Na předchozím obrázku si všimněte, jak agregátor nákupů implementuje klienta gRPC.</span><span class="sxs-lookup"><span data-stu-id="13da4-197">In the previous figure, note how the Shopping Aggregator implements a gRPC client.</span></span> <span data-ttu-id="13da4-198">Klient provádí synchronní volání gRPC (červeně) pro back-endové mikroslužby, z nichž každý implementuje server gRPC.</span><span class="sxs-lookup"><span data-stu-id="13da4-198">The client makes synchronous gRPC calls (in red) to backend microservices, each of which implement a gRPC server.</span></span> <span data-ttu-id="13da4-199">Klient i server využívají integrované instalace gRPC ze sady .NET Core 3.0 SDK.</span><span class="sxs-lookup"><span data-stu-id="13da4-199">Both the client and server take advantage of the built-in gRPC plumbing from the .NET Core 3.0 SDK.</span></span> <span data-ttu-id="13da4-200">*Zástupné procedury* na straně klienta poskytují instalace pro vyvolání vzdálených volání gRPC.</span><span class="sxs-lookup"><span data-stu-id="13da4-200">Client-side *stubs* provide the plumbing to invoke remote gRPC calls.</span></span> <span data-ttu-id="13da4-201">Součásti na straně serveru poskytují gRPC instalatérství, které mohou dědit a využívat vlastní třídy služeb.</span><span class="sxs-lookup"><span data-stu-id="13da4-201">Server-side components provide gRPC plumbing that custom service classes can inherit and consume.</span></span>

<span data-ttu-id="13da4-202">Mikroslužby, které zveřejňují rozhraní RESTful API a gRPC komunikace vyžadují více koncových bodů pro správu provozu.</span><span class="sxs-lookup"><span data-stu-id="13da4-202">Microservices that expose both a RESTful API and gRPC communication require multiple endpoints to manage traffic.</span></span> <span data-ttu-id="13da4-203">Byste otevřít koncový bod, který naslouchá pro přenosy HTTP pro volání RESTful a další pro volání gRPC.</span><span class="sxs-lookup"><span data-stu-id="13da4-203">You would open an endpoint that listens for HTTP traffic for the RESTful calls and another for gRPC calls.</span></span> <span data-ttu-id="13da4-204">Koncový bod gRPC musí být nakonfigurován pro protokol HTTP/2, který je vyžadován pro komunikaci gRPC.</span><span class="sxs-lookup"><span data-stu-id="13da4-204">The gRPC endpoint must be configured for the HTTP/2 protocol that is required for gRPC communication.</span></span>

<span data-ttu-id="13da4-205">Zatímco se snažíme oddělit mikroslužby s vzory asynchronní komunikace, některé operace vyžadují přímé volání.</span><span class="sxs-lookup"><span data-stu-id="13da4-205">While we strive to decouple microservices with asynchronous communication patterns, some operations require direct calls.</span></span> <span data-ttu-id="13da4-206">gRPC by měla být primární volbou pro přímou synchronní komunikaci mezi mikroslužbami.</span><span class="sxs-lookup"><span data-stu-id="13da4-206">gRPC should be the primary choice for direct synchronous communication between microservices.</span></span> <span data-ttu-id="13da4-207">Jeho vysoce výkonný komunikační protokol založený na HTTP/2 a vyrovnávacích pamětí protokolu z něj činí ideální volbu.</span><span class="sxs-lookup"><span data-stu-id="13da4-207">Its high-performance communication protocol, based on HTTP/2 and protocol buffers, make it a perfect choice.</span></span>

## <a name="looking-ahead"></a><span data-ttu-id="13da4-208">Výhled do budoucna</span><span class="sxs-lookup"><span data-stu-id="13da4-208">Looking ahead</span></span>

<span data-ttu-id="13da4-209">Při pohledu do budoucna bude gRPC i nadále získávat trakci pro cloud-nativní systémy.</span><span class="sxs-lookup"><span data-stu-id="13da4-209">Looking ahead, gRPC will continue to gain traction for cloud-native systems.</span></span> <span data-ttu-id="13da4-210">Výhody výkonu a snadný rozvoj jsou přesvědčivé.</span><span class="sxs-lookup"><span data-stu-id="13da4-210">The performance benefits and ease of development are compelling.</span></span> <span data-ttu-id="13da4-211">Nicméně, REST bude pravděpodobně asi na dlouhou dobu.</span><span class="sxs-lookup"><span data-stu-id="13da4-211">However, REST will likely be around for a long time.</span></span> <span data-ttu-id="13da4-212">Vyniká pro veřejně exponovaná řešení API a z důvodů zpětné kompatibility.</span><span class="sxs-lookup"><span data-stu-id="13da4-212">It excels for publicly exposed APIs and for backward compatibility reasons.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="13da4-213">[Předchozí](service-to-service-communication.md)
>[další](service-mesh-communication-infrastructure.md)</span><span class="sxs-lookup"><span data-stu-id="13da4-213">[Previous](service-to-service-communication.md)
[Next](service-mesh-communication-infrastructure.md)</span></span>
