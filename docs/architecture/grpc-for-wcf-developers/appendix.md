---
title: Příloha – gRPC pro vývojáře WCF
description: Diskuze nad distribuovanými transakcemi a jejich implementaci v moderních architekturách mikroslužeb.
ms.date: 09/02/2019
ms.openlocfilehash: 061aef016fd0e4303e1bbcbf0e73cec2b0c54f74
ms.sourcegitcommit: f348c84443380a1959294cdf12babcb804cfa987
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/12/2019
ms.locfileid: "73968221"
---
# <a name="appendix-a---transactions"></a><span data-ttu-id="d08a9-103">Příloha A – transakce</span><span class="sxs-lookup"><span data-stu-id="d08a9-103">Appendix A - Transactions</span></span>

<span data-ttu-id="d08a9-104">Windows Communication Foundation (WCF) podporuje distribuované transakce, což umožňuje provádět atomické operace napříč více službami.</span><span class="sxs-lookup"><span data-stu-id="d08a9-104">Windows Communication Foundation (WCF) supported distributed transactions, allowing atomic operations to be performed across multiple services.</span></span> <span data-ttu-id="d08a9-105">Tato funkce je založená na [DTC (Distributed Transaction Coordinator) Microsoftu](https://docs.microsoft.com/previous-versions/windows/desktop/ms684146(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="d08a9-105">This functionality was based on the [Microsoft Distributed Transaction Coordinator](https://docs.microsoft.com/previous-versions/windows/desktop/ms684146(v=vs.85)).</span></span>

<span data-ttu-id="d08a9-106">V moderních mikroslužbách na šířku není tento typ automatizovaného zpracování distribuované transakce možný.</span><span class="sxs-lookup"><span data-stu-id="d08a9-106">In the modern microservices landscape, this type of automated distributed transaction processing isn't possible.</span></span> <span data-ttu-id="d08a9-107">Při hraní je k dispozici příliš mnoho různých technologií, včetně relačních databází, úložišť NoSQL dat a systémů pro zasílání zpráv, a nezmiňujte si kombinaci operačních systémů, programovacích jazyků a platforem, které mohou být použity v jednom prostředí.</span><span class="sxs-lookup"><span data-stu-id="d08a9-107">There are too many different technologies at play, including relational databases, NoSQL data stores, and messaging systems, not to mention the mix of operating systems, programming languages and frameworks that may be used in a single environment.</span></span>

<span data-ttu-id="d08a9-108">Distribuovaná transakce WCF je implementací toho, co se říká dvoufázové [potvrzení (2PC)](https://en.wikipedia.org/wiki/Two-phase_commit_protocol).</span><span class="sxs-lookup"><span data-stu-id="d08a9-108">The WCF distributed transaction is an implementation of what is known as a [two-phase commit (2PC)](https://en.wikipedia.org/wiki/Two-phase_commit_protocol).</span></span> <span data-ttu-id="d08a9-109">Transakce 2PC je možné implementovat ručně prostřednictvím koordinace zpráv napříč službami, vytvořením otevřených transakcí v rámci každé služby a odesláním zpráv "commit" nebo "Rollback" v závislosti na úspěchu nebo neúspěchu.</span><span class="sxs-lookup"><span data-stu-id="d08a9-109">It's possible to implement 2PC transactions manually by coordinating messages across services, creating open transactions within each service and sending "commit" or "rollback" messages depending upon success or failure.</span></span> <span data-ttu-id="d08a9-110">Složitost, která je zapojená do správy 2PC, se ale může zvyšovat exponenciálně, jak se budou vyvíjet systémy, a otevřené transakce uchovávají zámky databáze, které mohou negativně ovlivnit výkon nebo horší, způsobit zablokování mezi službami.</span><span class="sxs-lookup"><span data-stu-id="d08a9-110">However, the complexity that is involved in managing 2PC can increase exponentially as systems evolve, and open transactions hold database locks that can negatively impact performance or, worse, cause cross-service deadlocks.</span></span>

<span data-ttu-id="d08a9-111">Pokud je to možné, je nejlepší vyhnout se distribuovaným transakcím úplně.</span><span class="sxs-lookup"><span data-stu-id="d08a9-111">If possible, it's best to avoid distributed transactions altogether.</span></span> <span data-ttu-id="d08a9-112">Pokud jsou tak propojeny dvě položky dat, jako by vyžadovaly atomické aktualizace, zvažte jejich manipulaci se stejnou službou a použití těchto atomických změn pomocí jediné žádosti nebo zprávy do této služby.</span><span class="sxs-lookup"><span data-stu-id="d08a9-112">If two items of data are so linked as to require atomic updates, consider handling them both with the same service, and applying those atomic changes using a single request or message to that service.</span></span>

<span data-ttu-id="d08a9-113">Pokud to není možné, pak je jednou alternativou použití [vzoru Saga](https://microservices.io/patterns/data/saga.html).</span><span class="sxs-lookup"><span data-stu-id="d08a9-113">If that isn't possible, then one alternative is to use the [Saga pattern](https://microservices.io/patterns/data/saga.html).</span></span> <span data-ttu-id="d08a9-114">V Saga jsou aktualizace zpracovávány postupně. v případě, že se každá aktualizace zdaří, aktivuje se další.</span><span class="sxs-lookup"><span data-stu-id="d08a9-114">In a saga, updates are processing sequentially; as each update succeeds the next one is triggered.</span></span> <span data-ttu-id="d08a9-115">Tyto aktivační události se dají rozšířit ze služby na službu nebo spravovat koordinátor Saga nebo Orchestrator.</span><span class="sxs-lookup"><span data-stu-id="d08a9-115">These triggers can be propagated from service to service, or managed by a saga coordinator or "orchestrator".</span></span> <span data-ttu-id="d08a9-116">Pokud se aktualizace v jakémkoli okamžiku v rámci procesu nezdařila, služby, které již dokončí jejich aktualizace, uplatní konkrétní logiku pro jejich vrácení.</span><span class="sxs-lookup"><span data-stu-id="d08a9-116">If an update fails at any point during the process, the services that have already completed their updates apply specific logic to reverse them.</span></span>

<span data-ttu-id="d08a9-117">Další možností je použití návrhu řízeného doménou (DDD) a oddělení zodpovědnosti příkazů nebo dotazů (CQRS), jak je popsáno v [elektronické knize .NET mikroslužeb](https://docs.microsoft.com/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/).</span><span class="sxs-lookup"><span data-stu-id="d08a9-117">Another option is to use Domain Driven Design (DDD) and Command/Query Responsibility Segregation (CQRS), as described in the [.NET Microservices e-book](https://docs.microsoft.com/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/).</span></span> <span data-ttu-id="d08a9-118">Konkrétně použití doménových událostí nebo [zdrojů událostí](https://martinfowler.com/eaaDev/EventSourcing.html) může pomoci zajistit, že aktualizace budou konzistentně&mdash;, pokud nejsou okamžitě&mdash;použity.</span><span class="sxs-lookup"><span data-stu-id="d08a9-118">In particular, using domain events or [event sourcing](https://martinfowler.com/eaaDev/EventSourcing.html) can help to ensure that updates are consistently&mdash;if not immediately&mdash;applied.</span></span>

>[!div class="step-by-step"]
>[<span data-ttu-id="d08a9-119">Předchozí</span><span class="sxs-lookup"><span data-stu-id="d08a9-119">Previous</span></span>](application-performance-management.md)
