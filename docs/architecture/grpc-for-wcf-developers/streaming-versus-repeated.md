---
title: Služby streamování vs. opakující se pole – gRPC pro vývojáře WCF
description: Porovnejte opakující se pole se službami streamování jako způsoby předávání kolekcí dat pomocí gRPC.
ms.date: 09/02/2019
ms.openlocfilehash: 0e717df57ba2bb52d63a063072d8a45bf0f7e395
ms.sourcegitcommit: f38e527623883b92010cf4760246203073e12898
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 02/20/2020
ms.locfileid: "77503381"
---
# <a name="grpc-streaming-services-vs-repeated-fields"></a><span data-ttu-id="ce168-103">služby streamování gRPC vs. opakující se pole</span><span class="sxs-lookup"><span data-stu-id="ce168-103">gRPC streaming services vs. repeated fields</span></span>

<span data-ttu-id="ce168-104">služby gRPC poskytují dva způsoby vrácení datových sad nebo seznamů objektů.</span><span class="sxs-lookup"><span data-stu-id="ce168-104">gRPC services provide two ways of returning datasets, or lists of objects.</span></span> <span data-ttu-id="ce168-105">Specifikace zprávy vyrovnávací paměti protokolu používá klíčové slovo `repeated` pro deklarování seznamů nebo polí zpráv v rámci jiné zprávy.</span><span class="sxs-lookup"><span data-stu-id="ce168-105">The Protocol Buffers message specification uses the `repeated` keyword for declaring lists or arrays of messages within another message.</span></span> <span data-ttu-id="ce168-106">Specifikace služby gRPC používá klíčové slovo `stream` k deklaraci dlouhotrvajícího trvalého připojení.</span><span class="sxs-lookup"><span data-stu-id="ce168-106">The gRPC service specification uses the `stream` keyword to declare a long-running persistent connection.</span></span> <span data-ttu-id="ce168-107">Přes toto připojení se posílá více zpráv a dají se zpracovat individuálně.</span><span class="sxs-lookup"><span data-stu-id="ce168-107">Over that connection, multiple messages are sent, and can be processed, individually.</span></span> 

<span data-ttu-id="ce168-108">Můžete také použít funkci `stream` pro dlouhodobě běžící dočasná data, jako jsou například oznámení nebo zprávy protokolu.</span><span class="sxs-lookup"><span data-stu-id="ce168-108">You can also use the `stream` feature for long-running temporal data such as notifications or log messages.</span></span> <span data-ttu-id="ce168-109">Ale tato kapitola bude uvažovat o použití pro vrácení jedné datové sady.</span><span class="sxs-lookup"><span data-stu-id="ce168-109">But this chapter will consider its use for returning a single dataset.</span></span>

<span data-ttu-id="ce168-110">Které byste měli použít, závisí na faktorech, jako jsou:</span><span class="sxs-lookup"><span data-stu-id="ce168-110">Which you should use depends on factors such as:</span></span>

- <span data-ttu-id="ce168-111">Celková velikost datové sady.</span><span class="sxs-lookup"><span data-stu-id="ce168-111">The overall size of the dataset.</span></span>
- <span data-ttu-id="ce168-112">Čas potřebný k vytvoření datové sady buď na straně klienta, nebo na straně serveru.</span><span class="sxs-lookup"><span data-stu-id="ce168-112">The time it took to create the dataset at either the client or server end.</span></span>
- <span data-ttu-id="ce168-113">Určuje, zda příjemce datové sady může na něm začít pracovat, jakmile bude první položka k dispozici, nebo potřebuje kompletní datovou sadu, aby provedla cokoli užitečnost.</span><span class="sxs-lookup"><span data-stu-id="ce168-113">Whether the consumer of the dataset can start acting on it as soon as the first item is available, or needs the complete dataset to do anything useful.</span></span>

## <a name="when-to-use-repeated-fields"></a><span data-ttu-id="ce168-114">Kdy použít pole `repeated`</span><span class="sxs-lookup"><span data-stu-id="ce168-114">When to use `repeated` fields</span></span>

<span data-ttu-id="ce168-115">Pro libovolnou datovou sadu, která má omezení velikosti a která se dá v celém rozsahu generovat v krátkém čase – řekněme, že v rámci jedné sekundy byste měli v běžné Protobuf zprávě použít pole `repeated`.</span><span class="sxs-lookup"><span data-stu-id="ce168-115">For any dataset that's constrained in size and that can be generated in its entirety in a short time—say, under one second—you should use a `repeated` field in a regular Protobuf message.</span></span> <span data-ttu-id="ce168-116">Například v systému elektronického obchodování je sestavení seznamu položek v rámci objednávky pravděpodobně rychlé a seznam nebude velmi velký.</span><span class="sxs-lookup"><span data-stu-id="ce168-116">For example, in an e-commerce system, to build a list of items within an order is probably quick and the list won't be very large.</span></span> <span data-ttu-id="ce168-117">Vrácení jedné zprávy s `repeated`ovým polem je pořadí větší než při použití `stream` a dojde k menšímu zatížení sítě.</span><span class="sxs-lookup"><span data-stu-id="ce168-117">Returning a single message with a `repeated` field is an order of magnitude faster than using `stream` and incurs less network overhead.</span></span>

<span data-ttu-id="ce168-118">Pokud klient potřebuje všechna data před zahájením zpracování a datová sada je dostatečně malá, aby mohla vytvořit paměť, pak zvažte použití pole `repeated`.</span><span class="sxs-lookup"><span data-stu-id="ce168-118">If the client needs all the data before starting to process it and the dataset is small enough to construct in memory, then consider using a `repeated` field.</span></span> <span data-ttu-id="ce168-119">Vezměte ho i v případě, že je vytváření datové sady v paměti na serveru pomalejší.</span><span class="sxs-lookup"><span data-stu-id="ce168-119">Consider it even if the creation of the dataset in memory on the server is slower.</span></span>

## <a name="when-to-use-stream-methods"></a><span data-ttu-id="ce168-120">Kdy použít metody `stream`</span><span class="sxs-lookup"><span data-stu-id="ce168-120">When to use `stream` methods</span></span>

<span data-ttu-id="ce168-121">Když jsou objekty zpráv v datových sadách potenciálně velmi velké, je vhodné je přenést pomocí požadavků na streamování nebo odpovědí.</span><span class="sxs-lookup"><span data-stu-id="ce168-121">When the message objects in your datasets are potentially very large, it's best for you transfer them by using streaming requests or responses.</span></span> <span data-ttu-id="ce168-122">Je efektivnější vytvořit rozsáhlý objekt v paměti, zapsat ho do sítě a pak uvolnit prostředky.</span><span class="sxs-lookup"><span data-stu-id="ce168-122">It's more efficient to construct a large object in memory, write it to the network, and then free up the resources.</span></span> <span data-ttu-id="ce168-123">Tento přístup vám pomůže zlepšit škálovatelnost vaší služby.</span><span class="sxs-lookup"><span data-stu-id="ce168-123">This approach will improve the scalability of your service.</span></span>

<span data-ttu-id="ce168-124">Podobně byste měli odeslat datové sady s neomezenou velikostí prostřednictvím datových proudů, abyste se vyhnuli nedostatku paměti při sestavování.</span><span class="sxs-lookup"><span data-stu-id="ce168-124">Similarly, you should send datasets of unconstrained size over streams to avoid running out of memory while constructing them.</span></span>

<span data-ttu-id="ce168-125">U datových sad, kde příjemce může samostatně zpracovat každou položku, byste měli zvážit použití datového proudu, pokud to znamená, že může být pro uživatele zjištěn průběh.</span><span class="sxs-lookup"><span data-stu-id="ce168-125">For datasets where the consumer can separately process each item, you should consider using a stream if it means that progress can be indicated to the user.</span></span> <span data-ttu-id="ce168-126">Použití datového proudu může zlepšit rychlost odezvy aplikace, ale měli byste ho vyvážit proti celkovému výkonu aplikace.</span><span class="sxs-lookup"><span data-stu-id="ce168-126">Using a stream can improve the responsiveness of an application, but you should balance it against the overall performance of the application.</span></span>

<span data-ttu-id="ce168-127">Další scénář, ve kterém mohou být datové proudy užitečné, je zpracování zprávy napříč více službami.</span><span class="sxs-lookup"><span data-stu-id="ce168-127">Another scenario where streams can be useful is where a message is being processed across multiple services.</span></span> <span data-ttu-id="ce168-128">Pokud každá služba v řetězci vrátí datový proud, pak může Terminálová služba (tj. poslední v řetězu) začít vracet zprávy.</span><span class="sxs-lookup"><span data-stu-id="ce168-128">If each service in a chain returns a stream, then the terminal service (that is, the last one in the chain) can start returning messages.</span></span> <span data-ttu-id="ce168-129">Tyto zprávy lze zpracovat a předat zpět původnímu žadateli.</span><span class="sxs-lookup"><span data-stu-id="ce168-129">These messages can be processed and passed back along the chain to the original requestor.</span></span> <span data-ttu-id="ce168-130">Žadatel může buď vrátit datový proud, nebo agregovat výsledky do jediné zprávy odpovědi.</span><span class="sxs-lookup"><span data-stu-id="ce168-130">The requestor can either return a stream or aggregate the results into a single response message.</span></span> <span data-ttu-id="ce168-131">Tento přístup se dobře hodí ke vzorům, jako je MapReduce.</span><span class="sxs-lookup"><span data-stu-id="ce168-131">This approach lends itself well to patterns like MapReduce.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="ce168-132">[Předchozí](migrate-duplex-services.md)
>[Další](client-libraries.md)</span><span class="sxs-lookup"><span data-stu-id="ce168-132">[Previous](migrate-duplex-services.md)
[Next](client-libraries.md)</span></span>
