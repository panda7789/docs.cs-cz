---
title: Streamovací služby vs. opakovaná pole - gRPC pro vývojáře WCF
description: Porovnejte opakovaná pole se streamovacími službami jako způsoby předávání kolekcí dat pomocí gRPC.
ms.date: 09/02/2019
ms.openlocfilehash: 542ebc393f9c9c1ad717d02d01fab33d85c18917
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/12/2020
ms.locfileid: "79147747"
---
# <a name="grpc-streaming-services-vs-repeated-fields"></a><span data-ttu-id="2f0a8-103">gRPC streamingové služby vs. opakovaná pole</span><span class="sxs-lookup"><span data-stu-id="2f0a8-103">gRPC streaming services vs. repeated fields</span></span>

<span data-ttu-id="2f0a8-104">gRPC služby poskytují dva způsoby vrácení datových sad nebo seznamy objektů.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-104">gRPC services provide two ways of returning datasets, or lists of objects.</span></span> <span data-ttu-id="2f0a8-105">Specifikace zprávy vyrovnávací paměti `repeated` protokolu používá klíčové slovo pro deklarování seznamů nebo polí zpráv v rámci jiné zprávy.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-105">The Protocol Buffers message specification uses the `repeated` keyword for declaring lists or arrays of messages within another message.</span></span> <span data-ttu-id="2f0a8-106">Specifikace služby gRPC `stream` používá klíčové slovo k deklarování dlouhotrvajícího trvalého připojení.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-106">The gRPC service specification uses the `stream` keyword to declare a long-running persistent connection.</span></span> <span data-ttu-id="2f0a8-107">Přes toto připojení je odesíláno více zpráv a může být zpracováno jednotlivě.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-107">Over that connection, multiple messages are sent, and can be processed, individually.</span></span>

<span data-ttu-id="2f0a8-108">`stream` Tuto funkci můžete také použít pro dlouhotrvající časová data, jako jsou oznámení nebo zprávy protokolu.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-108">You can also use the `stream` feature for long-running temporal data such as notifications or log messages.</span></span> <span data-ttu-id="2f0a8-109">Ale tato kapitola bude zvažovat jeho použití pro vrácení jedné datové sady.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-109">But this chapter will consider its use for returning a single dataset.</span></span>

<span data-ttu-id="2f0a8-110">Který byste měli použít, závisí na faktorech, jako jsou:</span><span class="sxs-lookup"><span data-stu-id="2f0a8-110">Which you should use depends on factors such as:</span></span>

- <span data-ttu-id="2f0a8-111">Celková velikost datové sady.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-111">The overall size of the dataset.</span></span>
- <span data-ttu-id="2f0a8-112">Čas, který trvalo vytvoření datové sady na konci klienta nebo serveru.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-112">The time it took to create the dataset at either the client or server end.</span></span>
- <span data-ttu-id="2f0a8-113">Zda spotřebitel datové sady může začít na něm reagovat, jakmile je k dispozici první položka, nebo potřebuje úplnou datovou sadu, aby udělal něco užitečného.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-113">Whether the consumer of the dataset can start acting on it as soon as the first item is available, or needs the complete dataset to do anything useful.</span></span>

## <a name="when-to-use-repeated-fields"></a><span data-ttu-id="2f0a8-114">Kdy použít `repeated` pole</span><span class="sxs-lookup"><span data-stu-id="2f0a8-114">When to use `repeated` fields</span></span>

<span data-ttu-id="2f0a8-115">Pro všechny datové sady, které jsou omezeny na velikost a které mohou být generovány v plném rozsahu `repeated` v krátkém čase - řekněme, pod jednu sekundu - měli byste použít pole v běžné zprávě Protobuf.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-115">For any dataset that's constrained in size and that can be generated in its entirety in a short time—say, under one second—you should use a `repeated` field in a regular Protobuf message.</span></span> <span data-ttu-id="2f0a8-116">Například v systému elektronického obchodování je vytvoření seznamu položek v objednávce pravděpodobně rychlé a seznam nebude příliš velký.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-116">For example, in an e-commerce system, to build a list of items within an order is probably quick and the list won't be very large.</span></span> <span data-ttu-id="2f0a8-117">Vrácení jedné zprávy s `repeated` polem je řádově `stream` rychlejší než při použití a vznikne nižší zatížení sítě.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-117">Returning a single message with a `repeated` field is an order of magnitude faster than using `stream` and incurs less network overhead.</span></span>

<span data-ttu-id="2f0a8-118">Pokud klient potřebuje všechna data před zahájením jejich zpracování a datová sada je dostatečně `repeated` malá, aby se vytvořila v paměti, zvažte použití pole.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-118">If the client needs all the data before starting to process it and the dataset is small enough to construct in memory, then consider using a `repeated` field.</span></span> <span data-ttu-id="2f0a8-119">Zvažte to i v případě, že vytvoření datové sady v paměti na serveru je pomalejší.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-119">Consider it even if the creation of the dataset in memory on the server is slower.</span></span>

## <a name="when-to-use-stream-methods"></a><span data-ttu-id="2f0a8-120">Kdy použít `stream` metody</span><span class="sxs-lookup"><span data-stu-id="2f0a8-120">When to use `stream` methods</span></span>

<span data-ttu-id="2f0a8-121">Pokud jsou objekty zpráv v datových sadách potenciálně velmi velké, je nejlepší je přenést pomocí požadavků na streamování nebo odpovědí.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-121">When the message objects in your datasets are potentially very large, it's best for you transfer them by using streaming requests or responses.</span></span> <span data-ttu-id="2f0a8-122">Je efektivnější vytvořit velký objekt v paměti, zapsat do sítě a uvolnit prostředky.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-122">It's more efficient to construct a large object in memory, write it to the network, and then free up the resources.</span></span> <span data-ttu-id="2f0a8-123">Tento přístup zlepší škálovatelnost vaší služby.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-123">This approach will improve the scalability of your service.</span></span>

<span data-ttu-id="2f0a8-124">Podobně byste měli odesílat datové sady bez omezení velikosti přes datové proudy, aby se zabránilo vyčerpání paměti při jejich vytváření.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-124">Similarly, you should send datasets of unconstrained size over streams to avoid running out of memory while constructing them.</span></span>

<span data-ttu-id="2f0a8-125">Pro datové sady, kde spotřebitel může samostatně zpracovat každou položku, měli byste zvážit použití datového proudu, pokud to znamená, že průběh může být indikován uživateli.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-125">For datasets where the consumer can separately process each item, you should consider using a stream if it means that progress can be indicated to the user.</span></span> <span data-ttu-id="2f0a8-126">Použití datového proudu může zlepšit odezvu aplikace, ale měli byste jej vyvážit s celkovým výkonem aplikace.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-126">Using a stream can improve the responsiveness of an application, but you should balance it against the overall performance of the application.</span></span>

<span data-ttu-id="2f0a8-127">Dalším scénářem, kde mohou být užitečné datové proudy, je, kde se zpracovává zpráva ve více službách.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-127">Another scenario where streams can be useful is where a message is being processed across multiple services.</span></span> <span data-ttu-id="2f0a8-128">Pokud každá služba v řetězci vrátí datový proud, pak terminálová služba (to znamená poslední v řetězci) můžete začít vracet zprávy.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-128">If each service in a chain returns a stream, then the terminal service (that is, the last one in the chain) can start returning messages.</span></span> <span data-ttu-id="2f0a8-129">Tyto zprávy mohou být zpracovány a předány zpět v řetězci původnímu žadateli.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-129">These messages can be processed and passed back along the chain to the original requestor.</span></span> <span data-ttu-id="2f0a8-130">Žadatel může vrátit datový proud nebo agregovat výsledky do jedné zprávy odpovědi.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-130">The requestor can either return a stream or aggregate the results into a single response message.</span></span> <span data-ttu-id="2f0a8-131">Tento přístup se hodí dobře vzory jako MapReduce.</span><span class="sxs-lookup"><span data-stu-id="2f0a8-131">This approach lends itself well to patterns like MapReduce.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="2f0a8-132">[Předchozí](migrate-duplex-services.md)
>[další](client-libraries.md)</span><span class="sxs-lookup"><span data-stu-id="2f0a8-132">[Previous](migrate-duplex-services.md)
[Next](client-libraries.md)</span></span>
