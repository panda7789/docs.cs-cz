---
title: služby streamování gRPC versus opakující se pole – gRPC pro vývojáře WCF
description: Porovnávání opakujících se polí se službami streamování jako způsob předávání kolekcí dat pomocí gRPC.
author: markrendle
ms.date: 09/02/2019
ms.openlocfilehash: e48fe4882139e029dbf5b52451a2e68cb4316677
ms.sourcegitcommit: 337bdc5a463875daf2cc6883e5a2da97d56f5000
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/24/2019
ms.locfileid: "72846077"
---
# <a name="grpc-streaming-services-versus-repeated-fields"></a><span data-ttu-id="d3a4f-103">služby streamování gRPC versus opakující se pole</span><span class="sxs-lookup"><span data-stu-id="d3a4f-103">gRPC streaming services versus repeated fields</span></span>

<span data-ttu-id="d3a4f-104">služby gRPC poskytují dva způsoby vrácení datových sad nebo seznamů objektů.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-104">gRPC services provide two ways of returning datasets, or lists of objects.</span></span> <span data-ttu-id="d3a4f-105">Specifikace zprávy vyrovnávací paměti protokolu používá klíčové slovo `repeated` pro deklarování seznamů nebo polí zpráv v rámci jiné zprávy.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-105">The Protocol Buffers message specification uses the `repeated` keyword for declaring lists or arrays of messages within another message.</span></span> <span data-ttu-id="d3a4f-106">Specifikace služby gRPC používá klíčové slovo `stream` k deklaraci dlouhotrvajícího trvale běžícího připojení, přes které se odesílá více zpráv, a dá se zpracovat jednotlivě.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-106">The gRPC service specification uses the `stream` keyword to declare a long-running persistent connection over which multiple messages are sent, and can be processed, individually.</span></span> <span data-ttu-id="d3a4f-107">Funkci `stream` lze také použít pro dlouhotrvající dočasná data, jako jsou oznámení nebo zprávy protokolu, ale tato kapitola bude uvažovat o použití pro vrácení jedné datové sady.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-107">The `stream` feature can also be used for long-running temporal data such as notifications or log messages, but this chapter will consider its use for returning a single dataset.</span></span>

<span data-ttu-id="d3a4f-108">Které byste měli použít, závisí na různých faktorech, jako je celková velikost datové sady, čas potřebný k vytvoření datové sady na konci klienta nebo serveru a na to, zda může příjemce datové sady na něm začít pracovat, jakmile bude k dispozici první položka. nebo potřebuje kompletní datovou sadu k provedení cokoli užitečného.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-108">Which you should use depends on various factors, such as the overall size of the dataset, the time it took to create the dataset at either the client or server end, and whether the consumer of the dataset can start acting on it as soon as the first item is available, or needs the complete dataset to do anything useful.</span></span>

## <a name="when-to-use-repeated-fields"></a><span data-ttu-id="d3a4f-109">Kdy použít pole `repeated`</span><span class="sxs-lookup"><span data-stu-id="d3a4f-109">When to use `repeated` fields</span></span>

<span data-ttu-id="d3a4f-110">Pro libovolnou datovou sadu, která má omezení velikosti a která se dá v celém rozsahu generovat v krátkém čase – řekněme, že v rámci jedné sekundy byste měli v běžné Protobuf zprávě použít pole `repeated`.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-110">For any dataset that is constrained in size and that can be generated in its entirety in a short time—say, under one second—you should use a `repeated` field in a regular Protobuf message.</span></span> <span data-ttu-id="d3a4f-111">Například v systému elektronického obchodování je sestavení seznamu položek v rámci objednávky pravděpodobně rychlé a seznam nebude velmi velký.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-111">For example, in an e-commerce system, to build a list of items within an order is probably quick and the list won't be very large.</span></span> <span data-ttu-id="d3a4f-112">Vrácení jedné zprávy s `repeated`ovým polem je pořadí větší než při použití `stream` a dojde k menšímu zatížení sítě.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-112">Returning a single message with a `repeated` field is an order of magnitude faster than using a `stream` and incurs less network overhead.</span></span>

<span data-ttu-id="d3a4f-113">Pokud klient potřebuje všechna data před zahájením zpracování a datová sada je dostatečně malá, aby mohla vytvořit paměť, pak zvažte použití `repeated` pole, i když je skutečným vytvořením datové sady v paměti na serveru pomalejší.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-113">If the client needs all the data before starting to process it and the dataset is small enough to construct in memory, then consider using a `repeated` field even if the actual creation of the dataset in memory on the server is slower.</span></span>

## <a name="when-to-use-stream-methods"></a><span data-ttu-id="d3a4f-114">Kdy použít metody `stream`</span><span class="sxs-lookup"><span data-stu-id="d3a4f-114">When to use `stream` methods</span></span>

<span data-ttu-id="d3a4f-115">Datové sady, kde jsou objekty zpráv potenciálně velmi velké, jsou nejlépe převáděny pomocí požadavků na streamování nebo odpovědí.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-115">Datasets where the message objects are potentially very large are best transferred using streaming requests or responses.</span></span> <span data-ttu-id="d3a4f-116">Je efektivnější vytvořit rozsáhlý objekt v paměti, zapsat ho do sítě a pak uvolnit prostředky.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-116">It's more efficient to construct a large object in memory, write it to the network and then free up the resources.</span></span> <span data-ttu-id="d3a4f-117">Tento přístup vám pomůže zlepšit škálovatelnost vaší služby.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-117">This approach will improve the scalability of your service.</span></span>

<span data-ttu-id="d3a4f-118">Podobně by měly být datové sady bez omezení velikosti odesílány přes proudy, aby při sestavování nedocházelo k vynechání paměti.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-118">Similarly, datasets of unconstrained size should be sent over streams to avoid running out of memory while constructing them.</span></span>

<span data-ttu-id="d3a4f-119">U datových sad, kde je možné každou jednotlivou položku zpracovat odděleně od příjemce, byste měli zvážit použití datového proudu, pokud to znamená, že je možné určit jeho průběh koncovému uživateli.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-119">For datasets where each individual item can be processed separately by the consumer, you should consider using a stream if it means that progress can be indicated to the end user.</span></span> <span data-ttu-id="d3a4f-120">To může zlepšit zdánlivou odezvu aplikace, i když by se to mělo vyrovnávat s celkovým výkonem aplikace.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-120">This could improve the apparent responsiveness of an application, although this should be balanced against the overall performance of the application.</span></span>

<span data-ttu-id="d3a4f-121">Další scénář, ve kterém mohou být datové proudy užitečné, je zpracování zprávy napříč více službami.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-121">Another scenario where streams can be useful is where a message is being processed across multiple services.</span></span> <span data-ttu-id="d3a4f-122">Pokud každá služba v řetězci vrátí datový proud, pak Terminálová služba (tj. poslední v řetězu) může začít vracet zprávy, které je možné zpracovat a předat zpátky v rámci řetězce původnímu žadateli, který může buď vrátit datový proud nebo agregovat výsledky do jediné zprávy odpovědi.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-122">If each service in a chain returns a stream, then the terminal service (that is, the last one in the chain) can start returning messages that can be processed and passed back along the chain to the original requestor, which can either return a stream or aggregate the results into a single response message.</span></span> <span data-ttu-id="d3a4f-123">Tento přístup se dobře hodí ke vzorům, jako je mapa nebo zmenšení.</span><span class="sxs-lookup"><span data-stu-id="d3a4f-123">This approach lends itself well to patterns like Map/Reduce.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="d3a4f-124">[Předchozí](migrate-duplex-services.md)
>[Další](client-libraries.md)</span><span class="sxs-lookup"><span data-stu-id="d3a4f-124">[Previous](migrate-duplex-services.md)
[Next](client-libraries.md)</span></span>
