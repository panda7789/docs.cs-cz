---
title: Vytváření, vývoj a správa verzí rozhraní API a kontraktů mikroslužeb
description: Vytvářejte rozhraní API mikroslužeb a kontrakty, které zvažuje vývoj a správu verzí, protože se vyžaduje změna.
ms.date: 09/20/2018
ms.openlocfilehash: 9164bfd12df18a88ac187c8962f0afc80b702881
ms.sourcegitcommit: 8bfeb5930ca48b2ee6053f16082dcaf24d46d221
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/18/2020
ms.locfileid: "88557669"
---
# <a name="creating-evolving-and-versioning-microservice-apis-and-contracts"></a><span data-ttu-id="118c1-103">Vytváření, vývoj a správa verzí rozhraní API a kontraktů mikroslužeb</span><span class="sxs-lookup"><span data-stu-id="118c1-103">Creating, evolving, and versioning microservice APIs and contracts</span></span>

<span data-ttu-id="118c1-104">Rozhraní API mikroslužeb je smlouva mezi službou a jejími klienty.</span><span class="sxs-lookup"><span data-stu-id="118c1-104">A microservice API is a contract between the service and its clients.</span></span> <span data-ttu-id="118c1-105">Mikroslužbu budete moct vyvíjet nezávisle jenom v případě, že jste nepřerušili její kontrakt rozhraní API. to je důvod, proč je smlouva důležitá.</span><span class="sxs-lookup"><span data-stu-id="118c1-105">You'll be able to evolve a microservice independently only if you do not break its API contract, which is why the contract is so important.</span></span> <span data-ttu-id="118c1-106">Pokud změníte smlouvu, bude to mít vliv na vaše klientské aplikace nebo na bránu rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="118c1-106">If you change the contract, it will impact your client applications or your API Gateway.</span></span>

<span data-ttu-id="118c1-107">Povaha definice rozhraní API závisí na tom, který protokol používáte.</span><span class="sxs-lookup"><span data-stu-id="118c1-107">The nature of the API definition depends on which protocol you're using.</span></span> <span data-ttu-id="118c1-108">Například pokud používáte zasílání zpráv (například [AMQP](http://www.amqp.org/)), rozhraní API se skládá z typů zpráv.</span><span class="sxs-lookup"><span data-stu-id="118c1-108">For instance, if you're using messaging (like [AMQP](http://www.amqp.org/)), the API consists of the message types.</span></span> <span data-ttu-id="118c1-109">Pokud používáte služby HTTP a RESTful, rozhraní API se skládá z adres URL a formátů JSON požadavků a odpovědí.</span><span class="sxs-lookup"><span data-stu-id="118c1-109">If you're using HTTP and RESTful services, the API consists of the URLs and the request and response JSON formats.</span></span>

<span data-ttu-id="118c1-110">Nicméně i v případě, že jste důkladnéi o vaší počáteční smlouvě, rozhraní API služby se bude muset v průběhu času změnit.</span><span class="sxs-lookup"><span data-stu-id="118c1-110">However, even if you're thoughtful about your initial contract, a service API will need to change over time.</span></span> <span data-ttu-id="118c1-111">Když k tomu dojde – a zejména v případě, že vaše rozhraní API je veřejné rozhraní API spotřebované více klientskými aplikacemi – obvykle nemůžete vynutit, aby všichni klienti upgradovali na váš nový kontrakt rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="118c1-111">When that happens—and especially if your API is a public API consumed by multiple client applications — you typically can't force all clients to upgrade to your new API contract.</span></span> <span data-ttu-id="118c1-112">Obvykle je třeba postupně nasazovat nové verze služby tak, aby se současně používaly staré i nové verze kontraktu služby.</span><span class="sxs-lookup"><span data-stu-id="118c1-112">You usually need to incrementally deploy new versions of a service in a way that both old and new versions of a service contract are running simultaneously.</span></span> <span data-ttu-id="118c1-113">Proto je důležité mít strategii pro správu verzí služby.</span><span class="sxs-lookup"><span data-stu-id="118c1-113">Therefore, it's important to have a strategy for your service versioning.</span></span>

<span data-ttu-id="118c1-114">Pokud jsou změny rozhraní API malé, například pokud do svého rozhraní API přidáte atributy nebo parametry, klienti, kteří používají starší rozhraní API, by se měli přepínat a pracovat s novou verzí služby.</span><span class="sxs-lookup"><span data-stu-id="118c1-114">When the API changes are small, like if you add attributes or parameters to your API, clients that use an older API should switch and work with the new version of the service.</span></span> <span data-ttu-id="118c1-115">Může být možné zadat výchozí hodnoty pro všechny chybějící atributy, které jsou požadovány, a klienti mohou ignorovat další atributy odpovědi.</span><span class="sxs-lookup"><span data-stu-id="118c1-115">You might be able to provide default values for any missing attributes that are required, and the clients might be able to ignore any extra response attributes.</span></span>

<span data-ttu-id="118c1-116">Někdy ale budete muset v rozhraní API služby udělat významné a nekompatibilní změny.</span><span class="sxs-lookup"><span data-stu-id="118c1-116">However, sometimes you need to make major and incompatible changes to a service API.</span></span> <span data-ttu-id="118c1-117">Vzhledem k tomu, že pravděpodobně nebudete moci vynutit, aby klientské aplikace nebo služby byly okamžitě upgradovány na novou verzi, služba musí po určitou dobu podporovat starší verze rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="118c1-117">Because you might not be able to force client applications or services to upgrade immediately to the new version, a service must support older versions of the API for some period.</span></span> <span data-ttu-id="118c1-118">Pokud používáte mechanizmy založené na protokolu HTTP, například REST, je jedním z přístupů vložení čísla verze rozhraní API do adresy URL nebo do hlavičky protokolu HTTP.</span><span class="sxs-lookup"><span data-stu-id="118c1-118">If you're using an HTTP-based mechanism such as REST, one approach is to embed the API version number in the URL or into an HTTP header.</span></span> <span data-ttu-id="118c1-119">Pak se můžete rozhodnout mezi implementací obou verzí služby současně v rámci stejné instance služby nebo nasazením různých instancí, které jednotlivé verze rozhraní API zpracovávají.</span><span class="sxs-lookup"><span data-stu-id="118c1-119">Then you can decide between implementing both versions of the service simultaneously within the same service instance, or deploying different instances that each handle a version of the API.</span></span> <span data-ttu-id="118c1-120">Dobrým přístupem k tomuto je [vzor](https://en.wikipedia.org/wiki/Mediator_pattern) vedení (například [MediatR Library](https://github.com/jbogard/MediatR)), aby se odlišily různé verze implementace na nezávislé obslužné rutiny.</span><span class="sxs-lookup"><span data-stu-id="118c1-120">A good approach for this is the [Mediator pattern](https://en.wikipedia.org/wiki/Mediator_pattern) (for example, [MediatR library](https://github.com/jbogard/MediatR)) to decouple the different implementation versions into independent handlers.</span></span>

<span data-ttu-id="118c1-121">Nakonec, pokud používáte architekturu REST [, je pro](https://www.infoq.com/articles/mark-baker-hypermedia) vás nejvhodnější řešení pro správu verzí vašich služeb a povoluje se vyvíjejíná rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="118c1-121">Finally, if you're using a REST architecture, [Hypermedia](https://www.infoq.com/articles/mark-baker-hypermedia) is the best solution for versioning your services and allowing evolvable APIs.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="118c1-122">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="118c1-122">Additional resources</span></span>

- <span data-ttu-id="118c1-123">**Scott Hanselman Jednodušší ASP.NET Core RESTful webového rozhraní API pro správu** </span><span class="sxs-lookup"><span data-stu-id="118c1-123">**Scott Hanselman. ASP.NET Core RESTful Web API versioning made easy** </span></span>\
  <https://www.hanselman.com/blog/ASPNETCoreRESTfulWebAPIVersioningMadeEasy.aspx>

- <span data-ttu-id="118c1-124">**Správa verzí webového rozhraní API RESTful** </span><span class="sxs-lookup"><span data-stu-id="118c1-124">**Versioning a RESTful web API** </span></span>\
  <https://docs.microsoft.com/azure/architecture/best-practices/api-design#versioning-a-restful-web-api>

- <span data-ttu-id="118c1-125">**Roy pole. Správa verzí, multimédií a REST** </span><span class="sxs-lookup"><span data-stu-id="118c1-125">**Roy Fielding. Versioning, Hypermedia, and REST** </span></span>\
  <https://www.infoq.com/articles/roy-fielding-on-versioning>

>[!div class="step-by-step"]
><span data-ttu-id="118c1-126">[Předchozí](asynchronous-message-based-communication.md) 
> [Další](microservices-addressability-service-registry.md)</span><span class="sxs-lookup"><span data-stu-id="118c1-126">[Previous](asynchronous-message-based-communication.md)
[Next](microservices-addressability-service-registry.md)</span></span>
