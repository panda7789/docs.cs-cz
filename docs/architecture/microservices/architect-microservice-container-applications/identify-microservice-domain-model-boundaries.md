---
title: Identifikace hranic mezi modelem a doménou u jednotlivých mikroslužeb
description: Prozkoumejte podstatu rozdělení velké aplikace na mikroslužby, aby se dosáhlo zvukové architektury.
ms.date: 09/20/2018
ms.openlocfilehash: 9c433066dd8e93dbb09b15e58c9c85617775723d
ms.sourcegitcommit: 8a0fe8a2227af612f8b8941bdb8b19d6268748e7
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/03/2019
ms.locfileid: "71834417"
---
# <a name="identify-domain-model-boundaries-for-each-microservice"></a><span data-ttu-id="d6623-103">Identifikujte hranice doménového modelu pro jednotlivé mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="d6623-103">Identify domain-model boundaries for each microservice</span></span>

<span data-ttu-id="d6623-104">Cíl, který identifikuje hranice modelu a velikost pro jednotlivé mikroslužby, se nedostane k nejpřesnější oddělitelné, i když je to možné, i když je to možné, měli byste se obrátit na malé mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="d6623-104">The goal when identifying model boundaries and size for each microservice isn't to get to the most granular separation possible, although you should tend toward small microservices if possible.</span></span> <span data-ttu-id="d6623-105">Místo toho by měl být vaším cílem získat nejsmysluplnější oddělení, které vás provedou znalostmi vaší domény.</span><span class="sxs-lookup"><span data-stu-id="d6623-105">Instead, your goal should be to get to the most meaningful separation guided by your domain knowledge.</span></span> <span data-ttu-id="d6623-106">Důraz není na velikost, ale místo na obchodních funkcích.</span><span class="sxs-lookup"><span data-stu-id="d6623-106">The emphasis isn't on the size, but instead on business capabilities.</span></span> <span data-ttu-id="d6623-107">Pokud je navíc k dispozici jasná soudržnost pro určitou oblast aplikace na základě vysokého počtu závislostí, znamená to, že je to také potřeba pro jednu mikroslužbu.</span><span class="sxs-lookup"><span data-stu-id="d6623-107">In addition, if there's clear cohesion needed for a certain area of the application based on a high number of dependencies, that indicates the need for a single microservice, too.</span></span> <span data-ttu-id="d6623-108">Soudržnost je způsob, jak určit, jak rozdělit nebo seskupit mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="d6623-108">Cohesion is a way to identify how to break apart or group together microservices.</span></span> <span data-ttu-id="d6623-109">I když získáte větší znalosti o doméně, měli byste ji v případě iterativní velikosti přizpůsobit.</span><span class="sxs-lookup"><span data-stu-id="d6623-109">Ultimately, while you gain more knowledge about the domain, you should adapt the size of your microservice, iteratively.</span></span> <span data-ttu-id="d6623-110">Vyhledání správné velikosti není proces jednoho snímku.</span><span class="sxs-lookup"><span data-stu-id="d6623-110">Finding the right size isn't a one-shot process.</span></span>

<span data-ttu-id="d6623-111">[Sam Newman](https://samnewman.io/), uznávaná propagace mikroslužeb a autora knih [vytváření mikroslužeb](https://samnewman.io/books/building_microservices/), zdůrazňuje, že byste měli navrhovat mikroslužby založené na vzoru ohraničeného kontextu (Bc) (součást návrhu založeného na doméně), jak bylo uvedeno dříve.</span><span class="sxs-lookup"><span data-stu-id="d6623-111">[Sam Newman](https://samnewman.io/), a recognized promoter of microservices and author of the book [Building Microservices](https://samnewman.io/books/building_microservices/), highlights that you should design your microservices based on the Bounded Context (BC) pattern (part of domain-driven design), as introduced earlier.</span></span> <span data-ttu-id="d6623-112">V některých případech může být BC tvořen několika fyzickými službami, ale nikoli naopak.</span><span class="sxs-lookup"><span data-stu-id="d6623-112">Sometimes, a BC could be composed of several physical services, but not vice versa.</span></span>

<span data-ttu-id="d6623-113">Doménový model s konkrétními doménovými entitami platí v rámci konkrétního BC nebo mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="d6623-113">A domain model with specific domain entities applies within a concrete BC or microservice.</span></span> <span data-ttu-id="d6623-114">Množina BC odděluje použitelnost doménového modelu a členům týmu vývojářů poskytuje jasné a sdílené vysvětlení toho, co musí být soudržné a co se dá vyvíjet nezávisle.</span><span class="sxs-lookup"><span data-stu-id="d6623-114">A BC delimits the applicability of a domain model and gives developer team members a clear and shared understanding of what must be cohesive and what can be developed independently.</span></span> <span data-ttu-id="d6623-115">Jedná se o stejné cíle jako u mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="d6623-115">These are the same goals for microservices.</span></span>

<span data-ttu-id="d6623-116">Dalším nástrojem, který je v souladu s návrhem, je [právo na Conwayův kodex](https://en.wikipedia.org/wiki/Conway%27s_law), které uvádí, že aplikace bude odrážet hranice sociálních organizací, které ji vytvořily.</span><span class="sxs-lookup"><span data-stu-id="d6623-116">Another tool that informs your design choice is [Conway's law](https://en.wikipedia.org/wiki/Conway%27s_law), which states that an application will reflect the social boundaries of the organization that produced it.</span></span> <span data-ttu-id="d6623-117">Ale v některých případech má opak hodnotu true – organizace je vytvořená softwarem.</span><span class="sxs-lookup"><span data-stu-id="d6623-117">But sometimes the opposite is true -the company's organization is formed by the software.</span></span> <span data-ttu-id="d6623-118">Je možné, že budete muset obrátit zákon na Conwayův kodex a vytvořit hranice tak, jak chcete, aby společnost byla uspořádána do konzultačních procesů obchodních procesů.</span><span class="sxs-lookup"><span data-stu-id="d6623-118">You might need to reverse Conway's law and build the boundaries the way you want the company to be organized, leaning toward business process consulting.</span></span>

<span data-ttu-id="d6623-119">Chcete-li identifikovat ohraničené kontexty, můžete použít vzor DDD pojmenovaný [vzor mapování kontextu](https://www.infoq.com/articles/ddd-contextmapping).</span><span class="sxs-lookup"><span data-stu-id="d6623-119">To identify bounded contexts, you can use a DDD pattern called the [Context Mapping pattern](https://www.infoq.com/articles/ddd-contextmapping).</span></span> <span data-ttu-id="d6623-120">Pomocí mapování kontextu identifikujete různé kontexty v aplikaci a jejich hranice.</span><span class="sxs-lookup"><span data-stu-id="d6623-120">With Context Mapping, you identify the various contexts in the application and their boundaries.</span></span> <span data-ttu-id="d6623-121">Je běžné mít jiný kontext a hranici pro každý malý podsystém, například.</span><span class="sxs-lookup"><span data-stu-id="d6623-121">It's common to have a different context and boundary for each small subsystem, for instance.</span></span> <span data-ttu-id="d6623-122">Mapování kontextu je způsob, jak definovat a zadat explicitní hranice mezi doménami.</span><span class="sxs-lookup"><span data-stu-id="d6623-122">The Context Map is a way to define and make explicit those boundaries between domains.</span></span> <span data-ttu-id="d6623-123">BC je autonomní a obsahuje podrobnosti o jednotlivých doménových detailech, jako jsou například entity domény – a definuje kontrakty integrace s jinou službou BCs.</span><span class="sxs-lookup"><span data-stu-id="d6623-123">A BC is autonomous and includes the details of a single domain -details like the domain entities- and defines integration contracts with other BCs.</span></span> <span data-ttu-id="d6623-124">To je podobné jako definice mikroslužeb: je to autonomní, implementuje určitou doménovou schopnost a musí poskytovat rozhraní.</span><span class="sxs-lookup"><span data-stu-id="d6623-124">This is similar to the definition of a microservice: it's autonomous, it implements certain domain capability, and it must provide interfaces.</span></span> <span data-ttu-id="d6623-125">To je důvod, proč mapování kontextu a vzor vázaného kontextu jsou dobré přístupy k identifikaci hranic doménových modelů vašich mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="d6623-125">This is why Context Mapping and the Bounded Context pattern are good approaches for identifying the domain model boundaries of your microservices.</span></span>

<span data-ttu-id="d6623-126">Když navrhujete velkou aplikaci, zjistíte, jak se dá rozdělit jeho doménový model – odborník na doménu z domény katalogu bude v katalogu a v doménách katalogu pojmenovat entity jinak, než je odborník na doménu pro expedici.</span><span class="sxs-lookup"><span data-stu-id="d6623-126">When designing a large application, you'll see how its domain model can be fragmented - a domain expert from the catalog domain will name entities differently in the catalog and inventory domains than a shipping domain expert, for instance.</span></span> <span data-ttu-id="d6623-127">Nebo entita domény uživatele se může lišit v velikosti a počtu atributů při práci s odborníkem na CRM, který chce uložit všechny podrobnosti o zákazníkovi, než pro odborníka na doménu, který právě potřebuje částečná data o zákazníkovi.</span><span class="sxs-lookup"><span data-stu-id="d6623-127">Or the user domain entity might be different in size and number of attributes when dealing with a CRM expert who wants to store every detail about the customer than for an ordering domain expert who just needs partial data about the customer.</span></span> <span data-ttu-id="d6623-128">Je velmi obtížné rozlišit všechny doménové oblasti napříč všemi doménami, které se vztahují k velké aplikaci.</span><span class="sxs-lookup"><span data-stu-id="d6623-128">It's very hard to disambiguate all domain terms across all the domains related to a large application.</span></span> <span data-ttu-id="d6623-129">Nejdůležitějším aspektem je, že byste se neměli pokoušet sjednotit tyto výrazy.</span><span class="sxs-lookup"><span data-stu-id="d6623-129">But the most important thing is that you shouldn't try to unify the terms.</span></span> <span data-ttu-id="d6623-130">Místo toho přijměte rozdíly a bohatosti poskytované jednotlivými doménami.</span><span class="sxs-lookup"><span data-stu-id="d6623-130">Instead, accept the differences and richness provided by each domain.</span></span> <span data-ttu-id="d6623-131">Pokud se pokusíte mít sjednocenou databázi pro celou aplikaci, pokusy na sjednoceném slovníku budou nevhodné a nebudou se jednat o zvukové právo na žádného odborníka na více domén.</span><span class="sxs-lookup"><span data-stu-id="d6623-131">If you try to have a unified database for the whole application, attempts at a unified vocabulary will be awkward and won't sound right to any of the multiple domain experts.</span></span> <span data-ttu-id="d6623-132">Proto služba BCs (implementovaná jako mikroslužby) vám pomůže objasnit, kde můžete použít určité doménové smlouvy, a kde budete muset rozdělit systém a vytvořit další službu BCs s různými doménami.</span><span class="sxs-lookup"><span data-stu-id="d6623-132">Therefore, BCs (implemented as microservices) will help you to clarify where you can use certain domain terms and where you'll need to split the system and create additional BCs with different domains.</span></span>

<span data-ttu-id="d6623-133">Dozvíte se, že máte správné hranice a velikosti jednotlivých modelů BC a domén, pokud máte několik silných vztahů mezi doménovými modely a nepotřebujete při provádění typických operací s aplikacemi obvykle sloučit informace z více doménových modelů. .</span><span class="sxs-lookup"><span data-stu-id="d6623-133">You'll know that you got the right boundaries and sizes of each BC and domain model if you have few strong relationships between domain models, and you do not usually need to merge information from multiple domain models when performing typical application operations.</span></span>

<span data-ttu-id="d6623-134">Možná nejlepší odpověď na otázku, jak velký doménový model pro jednotlivé mikroslužby by měl být následující: by měl mít autonomní nadmnožinu BC, jak je izolovaný, což vám umožní pracovat bez nutnosti nepřetržitě přepínat na jiné kontexty (jiné modely mikroslužeb).</span><span class="sxs-lookup"><span data-stu-id="d6623-134">Perhaps the best answer to the question of how large a domain model for each microservice should be is the following: it should have an autonomous BC, as isolated as possible, that enables you to work without having to constantly switch to other contexts (other microservice's models).</span></span> <span data-ttu-id="d6623-135">Na obrázku 4-10 vidíte, jak různé mikroslužby (více BCs) mají svůj vlastní model a jak se jejich entity dají definovat, v závislosti na konkrétních požadavcích pro jednotlivé identifikované domény ve vaší aplikaci.</span><span class="sxs-lookup"><span data-stu-id="d6623-135">In Figure 4-10, you can see how multiple microservices (multiple BCs) each has their own model and how their entities can be defined, depending on the specific requirements for each of the identified domains in your application.</span></span>

![Diagram znázorňující entity v několika hranicích modelu](./media/identify-microservice-domain-model-boundaries/identify-entities-microservice-model-boundries.png)

<span data-ttu-id="d6623-137">**Obrázek 4-10**.</span><span class="sxs-lookup"><span data-stu-id="d6623-137">**Figure 4-10**.</span></span> <span data-ttu-id="d6623-138">Identifikace entit a hranic modelu mikroslužeb</span><span class="sxs-lookup"><span data-stu-id="d6623-138">Identifying entities and microservice model boundaries</span></span>

<span data-ttu-id="d6623-139">Obrázek 4-10 znázorňuje vzorový scénář týkající se systému správy online konferencí.</span><span class="sxs-lookup"><span data-stu-id="d6623-139">Figure 4-10 illustrates a sample scenario related to an online conference management system.</span></span> <span data-ttu-id="d6623-140">Stejná entita se zobrazí jako "uživatelé", "nákupčí", "Payers" a "zákazníci" v závislosti na ohraničeném kontextu.</span><span class="sxs-lookup"><span data-stu-id="d6623-140">The same entity appears as "Users", "Buyers", "Payers", and "Customers" depending on the bounded context.</span></span> <span data-ttu-id="d6623-141">Identifikovali jste několik BCs, které by se daly implementovat jako mikroslužby, a to na základě domén, které vám odborníci na doménu definovali.</span><span class="sxs-lookup"><span data-stu-id="d6623-141">You've identified several BCs that could be implemented as microservices, based on domains that domain experts defined for you.</span></span> <span data-ttu-id="d6623-142">Jak vidíte, existují entity, které jsou přítomny pouze v jednom modelu mikroslužby, jako jsou platby v mikroslužbě plateb.</span><span class="sxs-lookup"><span data-stu-id="d6623-142">As you can see, there are entities that are present just in a single microservice model, like Payments in the Payment microservice.</span></span> <span data-ttu-id="d6623-143">Ty budou snadno implementovány.</span><span class="sxs-lookup"><span data-stu-id="d6623-143">Those will be easy to implement.</span></span>

<span data-ttu-id="d6623-144">Můžete ale také mít entity, které mají jiný tvar, ale sdílet stejnou identitu napříč různými doménovými modely z více mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="d6623-144">However, you might also have entities that have a different shape but share the same identity across the multiple domain models from the multiple microservices.</span></span> <span data-ttu-id="d6623-145">Například entita uživatele je identifikována v mikroslužbě správy konferencí.</span><span class="sxs-lookup"><span data-stu-id="d6623-145">For example, the User entity is identified in the Conferences Management microservice.</span></span> <span data-ttu-id="d6623-146">Stejný uživatel se stejnou identitou je ten, který se jmenuje Customers v rámci objednávání mikroslužby, nebo druhý s názvem plátce v rámci platební služby a dokonce i ten, kdo je v mikroslužbě Customer Service pro zákazníky.</span><span class="sxs-lookup"><span data-stu-id="d6623-146">That same user, with the same identity, is the one named Buyers in the Ordering microservice, or the one named Payer in the Payment microservice, and even the one named Customer in the Customer Service microservice.</span></span> <span data-ttu-id="d6623-147">Důvodem je to, že v závislosti na [jazyku všudypřítomný](https://martinfowler.com/bliki/UbiquitousLanguage.html) , který používá každý odborník domény, může mít uživatel jinou perspektivu i s různými atributy.</span><span class="sxs-lookup"><span data-stu-id="d6623-147">This is because, depending on the [ubiquitous language](https://martinfowler.com/bliki/UbiquitousLanguage.html) that each domain expert is using, a user might have a different perspective even with different attributes.</span></span> <span data-ttu-id="d6623-148">Entita uživatele v modelu mikroslužeb s názvem konference může mít většinu svých atributů osobních dat.</span><span class="sxs-lookup"><span data-stu-id="d6623-148">The user entity in the microservice model named Conferences Management might have most of its personal data attributes.</span></span> <span data-ttu-id="d6623-149">Stejný uživatel ale v rámci platby plátce v platební službě nebo ve tvaru zákazníka ve službě pro zákazníky mikroslužeb ale nemusí potřebovat stejný seznam atributů.</span><span class="sxs-lookup"><span data-stu-id="d6623-149">However, that same user in the shape of Payer in the microservice Payment or in the shape of Customer in the microservice Customer Service might not need the same list of attributes.</span></span>

<span data-ttu-id="d6623-150">Podobný přístup je znázorněný na obrázku 4-11.</span><span class="sxs-lookup"><span data-stu-id="d6623-150">A similar approach is illustrated in Figure 4-11.</span></span>

![Diagram znázorňující, jak rozložit datový model do více doménových modelů](./media/identify-microservice-domain-model-boundaries/decompose-traditional-data-models.png)

<span data-ttu-id="d6623-152">**Obrázek 4-11**.</span><span class="sxs-lookup"><span data-stu-id="d6623-152">**Figure 4-11**.</span></span> <span data-ttu-id="d6623-153">Deskládání tradičních datových modelů do několika doménových modelů</span><span class="sxs-lookup"><span data-stu-id="d6623-153">Decomposing traditional data models into multiple domain models</span></span>

<span data-ttu-id="d6623-154">Při deskládání tradičního datového modelu mezi ohraničenými kontexty můžete mít různé entity, které sdílejí stejnou identitu (kupující je také uživatel) s různými atributy v každém ohraničeném kontextu.</span><span class="sxs-lookup"><span data-stu-id="d6623-154">When decomposing a traditional data model between bounded contexts, you can have different entities that share the same identity (a buyer is also a user) with different attributes in each bounded context.</span></span> <span data-ttu-id="d6623-155">Můžete zjistit, jak se uživatel nachází v modelu mikroslužeb správy konferencí, jako uživatelskou entitu a také ve formě entity nákupčího v rámci cenové služby cen, s alternativními atributy nebo podrobnostmi o uživateli, když je ve skutečnosti kupující.</span><span class="sxs-lookup"><span data-stu-id="d6623-155">You can see how the user is present in the Conferences Management microservice model as the User entity and is also present in the form of the Buyer entity in the Pricing microservice, with alternate attributes or details about the user when it's actually a buyer.</span></span> <span data-ttu-id="d6623-156">Každá mikroslužba nebo BC nemusí potřebovat všechna data související s entitou uživatele, a to jenom v závislosti na problému, který chcete vyřešit, nebo v kontextu.</span><span class="sxs-lookup"><span data-stu-id="d6623-156">Each microservice or BC might not need all the data related to a User entity, just part of it, depending on the problem to solve or the context.</span></span> <span data-ttu-id="d6623-157">Například v modelu cenové služby Price nepotřebujete adresu ani jméno uživatele, jenom ID (jako identitu) a stav, což bude mít dopad na slevy při cenách za počet míst na odběratele.</span><span class="sxs-lookup"><span data-stu-id="d6623-157">For instance, in the Pricing microservice model, you do not need the address or the name of the user, just the ID (as identity) and Status, which will have an impact on discounts when pricing the seats per buyer.</span></span>

<span data-ttu-id="d6623-158">Entita sedadla má stejný název, ale různé atributy v každém doménovém modelu.</span><span class="sxs-lookup"><span data-stu-id="d6623-158">The Seat entity has the same name but different attributes in each domain model.</span></span> <span data-ttu-id="d6623-159">Sdílí ale identitu na základě stejného ID, co se stane se jménem uživatele a nákupčího.</span><span class="sxs-lookup"><span data-stu-id="d6623-159">However, Seat shares identity based on the same ID, as happens with User and Buyer.</span></span>

<span data-ttu-id="d6623-160">V podstatě existuje sdílený koncept uživatele, který existuje ve více službách (doménách), které všechny sdílí identitu daného uživatele.</span><span class="sxs-lookup"><span data-stu-id="d6623-160">Basically, there's a shared concept of a user that exists in multiple services (domains), which all share the identity of that user.</span></span> <span data-ttu-id="d6623-161">V každém modelu domény ale můžou být informace o entitě uživatele další nebo jiné.</span><span class="sxs-lookup"><span data-stu-id="d6623-161">But in each domain model there might be additional or different details about the user entity.</span></span> <span data-ttu-id="d6623-162">Proto musí být k dispozici způsob, jak namapovat entitu uživatele z jedné domény (mikroslužba) na jinou.</span><span class="sxs-lookup"><span data-stu-id="d6623-162">Therefore, there needs to be a way to map a user entity from one domain (microservice) to another.</span></span>

<span data-ttu-id="d6623-163">Existuje několik výhod, které nesdílí stejnou entitu uživatele se stejným počtem atributů napříč doménami.</span><span class="sxs-lookup"><span data-stu-id="d6623-163">There are several benefits to not sharing the same user entity with the same number of attributes across domains.</span></span> <span data-ttu-id="d6623-164">Jednou z výhod je omezit duplicity, aby modely mikroslužeb nemusely mít žádná data, která nepotřebují.</span><span class="sxs-lookup"><span data-stu-id="d6623-164">One benefit is to reduce duplication, so that microservice models do not have any data that they do not need.</span></span> <span data-ttu-id="d6623-165">Další výhodou je mít hlavní mikroslužbu, která vlastní určitý typ dat na entitu, aby aktualizace a dotazy pro tento typ dat byly řízené pouze touto mikroslužbou.</span><span class="sxs-lookup"><span data-stu-id="d6623-165">Another benefit is having a master microservice that owns a certain type of data per entity so that updates and queries for that type of data are driven only by that microservice.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="d6623-166">[Předchozí](distributed-data-management.md)
>[Další](direct-client-to-microservice-communication-versus-the-api-gateway-pattern.md)</span><span class="sxs-lookup"><span data-stu-id="d6623-166">[Previous](distributed-data-management.md)
[Next](direct-client-to-microservice-communication-versus-the-api-gateway-pattern.md)</span></span>
