---
title: Identifikace hranic mezi modelem a doménou u jednotlivých mikroslužeb
description: Prozkoumejte podstatu rozdělení velké aplikace do mikroslužeb k dosažení zvukové architektury.
ms.date: 09/20/2018
ms.openlocfilehash: 9c433066dd8e93dbb09b15e58c9c85617775723d
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/14/2020
ms.locfileid: "71834417"
---
# <a name="identify-domain-model-boundaries-for-each-microservice"></a><span data-ttu-id="09a9a-103">Identifikovat hranice modelu domény pro každou mikroslužbu</span><span class="sxs-lookup"><span data-stu-id="09a9a-103">Identify domain-model boundaries for each microservice</span></span>

<span data-ttu-id="09a9a-104">Cílem při identifikaci hranice modelu a velikost pro každou mikroslužbu není získat nejvíce podrobné oddělení možné, i když byste měli tendenci k malé mikroslužeb, pokud je to možné.</span><span class="sxs-lookup"><span data-stu-id="09a9a-104">The goal when identifying model boundaries and size for each microservice isn't to get to the most granular separation possible, although you should tend toward small microservices if possible.</span></span> <span data-ttu-id="09a9a-105">Místo toho by vaším cílem mělo být dostat se k nejsmysluplnějšímu oddělení vedenému znalostmi domény.</span><span class="sxs-lookup"><span data-stu-id="09a9a-105">Instead, your goal should be to get to the most meaningful separation guided by your domain knowledge.</span></span> <span data-ttu-id="09a9a-106">Důraz není kladen na velikost, ale na obchodní možnosti.</span><span class="sxs-lookup"><span data-stu-id="09a9a-106">The emphasis isn't on the size, but instead on business capabilities.</span></span> <span data-ttu-id="09a9a-107">Kromě toho pokud je jasná soudržnost potřebné pro určitou oblast aplikace na základě vysokého počtu závislostí, který označuje potřebu jedné mikroslužby, taky.</span><span class="sxs-lookup"><span data-stu-id="09a9a-107">In addition, if there's clear cohesion needed for a certain area of the application based on a high number of dependencies, that indicates the need for a single microservice, too.</span></span> <span data-ttu-id="09a9a-108">Soudržnost je způsob, jak zjistit, jak rozdělit nebo seskupit mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="09a9a-108">Cohesion is a way to identify how to break apart or group together microservices.</span></span> <span data-ttu-id="09a9a-109">Nakonec při získání dalších znalostí o doméně, měli byste přizpůsobit velikost mikroslužeb, iterativně.</span><span class="sxs-lookup"><span data-stu-id="09a9a-109">Ultimately, while you gain more knowledge about the domain, you should adapt the size of your microservice, iteratively.</span></span> <span data-ttu-id="09a9a-110">Nalezení správné velikosti není jednorázový proces.</span><span class="sxs-lookup"><span data-stu-id="09a9a-110">Finding the right size isn't a one-shot process.</span></span>

<span data-ttu-id="09a9a-111">[Sam Newman](https://samnewman.io/), uznávaný propagátor mikroslužeb a autor knihy [Building Microservices](https://samnewman.io/books/building_microservices/), zdůrazňuje, že byste měli navrhnout mikroslužeb na základě vzoru ohraničeného kontextu (BC) (součást návrhu řízeného doménou), jak byl zaveden dříve.</span><span class="sxs-lookup"><span data-stu-id="09a9a-111">[Sam Newman](https://samnewman.io/), a recognized promoter of microservices and author of the book [Building Microservices](https://samnewman.io/books/building_microservices/), highlights that you should design your microservices based on the Bounded Context (BC) pattern (part of domain-driven design), as introduced earlier.</span></span> <span data-ttu-id="09a9a-112">Někdy může být BC složena z několika fyzických služeb, ale ne naopak.</span><span class="sxs-lookup"><span data-stu-id="09a9a-112">Sometimes, a BC could be composed of several physical services, but not vice versa.</span></span>

<span data-ttu-id="09a9a-113">Model domény s konkrétními entitami domény platí v rámci konkrétní BC nebo mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="09a9a-113">A domain model with specific domain entities applies within a concrete BC or microservice.</span></span> <span data-ttu-id="09a9a-114">Bc vymezuje použitelnost modelu domény a poskytuje členům vývojářského týmu jasné a sdílené pochopení toho, co musí být soudržné a co lze vyvíjet nezávisle.</span><span class="sxs-lookup"><span data-stu-id="09a9a-114">A BC delimits the applicability of a domain model and gives developer team members a clear and shared understanding of what must be cohesive and what can be developed independently.</span></span> <span data-ttu-id="09a9a-115">Jedná se o stejné cíle pro mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="09a9a-115">These are the same goals for microservices.</span></span>

<span data-ttu-id="09a9a-116">Dalším nástrojem, který informuje o vaší volbě návrhu, je [Conwayův zákon](https://en.wikipedia.org/wiki/Conway%27s_law), který uvádí, že aplikace bude odrážet sociální hranice organizace, která ji vyrobila.</span><span class="sxs-lookup"><span data-stu-id="09a9a-116">Another tool that informs your design choice is [Conway's law](https://en.wikipedia.org/wiki/Conway%27s_law), which states that an application will reflect the social boundaries of the organization that produced it.</span></span> <span data-ttu-id="09a9a-117">Ale někdy je opak pravdou -organizace společnosti je tvořena softwarem.</span><span class="sxs-lookup"><span data-stu-id="09a9a-117">But sometimes the opposite is true -the company's organization is formed by the software.</span></span> <span data-ttu-id="09a9a-118">Možná budete muset zvrátit Conwayův zákon a vybudovat hranice tak, jak chcete, aby společnost byla organizována, a přiklánět se k poradenství v oblasti obchodních procesů.</span><span class="sxs-lookup"><span data-stu-id="09a9a-118">You might need to reverse Conway's law and build the boundaries the way you want the company to be organized, leaning toward business process consulting.</span></span>

<span data-ttu-id="09a9a-119">Chcete-li identifikovat ohraničené kontexty, můžete použít vzorek DDD nazvaný [vzor kontextové mapování](https://www.infoq.com/articles/ddd-contextmapping).</span><span class="sxs-lookup"><span data-stu-id="09a9a-119">To identify bounded contexts, you can use a DDD pattern called the [Context Mapping pattern](https://www.infoq.com/articles/ddd-contextmapping).</span></span> <span data-ttu-id="09a9a-120">Pomocí mapování kontextu můžete identifikovat různé kontexty v aplikaci a jejich hranice.</span><span class="sxs-lookup"><span data-stu-id="09a9a-120">With Context Mapping, you identify the various contexts in the application and their boundaries.</span></span> <span data-ttu-id="09a9a-121">Je běžné mít jiný kontext a hranice pro každý malý subsystém, například.</span><span class="sxs-lookup"><span data-stu-id="09a9a-121">It's common to have a different context and boundary for each small subsystem, for instance.</span></span> <span data-ttu-id="09a9a-122">Mapa kontextu je způsob, jak definovat a explicitní tyto hranice mezi doménami.</span><span class="sxs-lookup"><span data-stu-id="09a9a-122">The Context Map is a way to define and make explicit those boundaries between domains.</span></span> <span data-ttu-id="09a9a-123">Bc je autonomní a obsahuje podrobnosti o jedné doméně - podrobnosti, jako jsou entity domény - a definuje integrační smlouvy s jinými řadiči domény.</span><span class="sxs-lookup"><span data-stu-id="09a9a-123">A BC is autonomous and includes the details of a single domain -details like the domain entities- and defines integration contracts with other BCs.</span></span> <span data-ttu-id="09a9a-124">To je podobné definici mikroslužby: je autonomní, implementuje určité funkce domény a musí poskytovat rozhraní.</span><span class="sxs-lookup"><span data-stu-id="09a9a-124">This is similar to the definition of a microservice: it's autonomous, it implements certain domain capability, and it must provide interfaces.</span></span> <span data-ttu-id="09a9a-125">To je důvod, proč context mapping a ohraničený kontext vzor jsou dobré přístupy pro identifikaci hranice modelu domény mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="09a9a-125">This is why Context Mapping and the Bounded Context pattern are good approaches for identifying the domain model boundaries of your microservices.</span></span>

<span data-ttu-id="09a9a-126">Při navrhování velké aplikace uvidíte, jak může být její model domény fragmentován – odborník na doménu z domény katalogu bude v doménách katalogu a inventáře například pojmenovávat entity jinak než odborník na doručovací doménu.</span><span class="sxs-lookup"><span data-stu-id="09a9a-126">When designing a large application, you'll see how its domain model can be fragmented - a domain expert from the catalog domain will name entities differently in the catalog and inventory domains than a shipping domain expert, for instance.</span></span> <span data-ttu-id="09a9a-127">Nebo entita domény uživatele se může lišit velikostí a počtem atributů při práci s odborníkem na CRM, který chce uložit každý detail o zákazníkovi než pro odborníka na objednávající doménu, který potřebuje pouze částečná data o zákazníkovi.</span><span class="sxs-lookup"><span data-stu-id="09a9a-127">Or the user domain entity might be different in size and number of attributes when dealing with a CRM expert who wants to store every detail about the customer than for an ordering domain expert who just needs partial data about the customer.</span></span> <span data-ttu-id="09a9a-128">Je velmi těžké rozptýlit všechny termíny domény ve všech doménách souvisejících s velkou aplikací.</span><span class="sxs-lookup"><span data-stu-id="09a9a-128">It's very hard to disambiguate all domain terms across all the domains related to a large application.</span></span> <span data-ttu-id="09a9a-129">Ale nejdůležitější je, že byste se neměli snažit sjednotit podmínky.</span><span class="sxs-lookup"><span data-stu-id="09a9a-129">But the most important thing is that you shouldn't try to unify the terms.</span></span> <span data-ttu-id="09a9a-130">Místo toho přijměte rozdíly a bohatost poskytoanou jednotlivými doménami.</span><span class="sxs-lookup"><span data-stu-id="09a9a-130">Instead, accept the differences and richness provided by each domain.</span></span> <span data-ttu-id="09a9a-131">Pokud se pokusíte mít jednotnou databázi pro celou aplikaci, pokusy o jednotný slovník bude nepříjemné a nebude znít právo na některý z více doménových odborníků.</span><span class="sxs-lookup"><span data-stu-id="09a9a-131">If you try to have a unified database for the whole application, attempts at a unified vocabulary will be awkward and won't sound right to any of the multiple domain experts.</span></span> <span data-ttu-id="09a9a-132">Proto bccs (implementované jako mikroslužeb) vám pomůže objasnit, kde můžete použít určité podmínky domény a kde budete muset rozdělit systém a vytvořit další řadiče domény s různými doménami.</span><span class="sxs-lookup"><span data-stu-id="09a9a-132">Therefore, BCs (implemented as microservices) will help you to clarify where you can use certain domain terms and where you'll need to split the system and create additional BCs with different domains.</span></span>

<span data-ttu-id="09a9a-133">Budete vědět, že máte správné hranice a velikosti každého modelu BC a domény, pokud máte několik silných vztahů mezi modely domény a obvykle nemusíte slučovat informace z více modelů domény při provádění typických operací aplikace .</span><span class="sxs-lookup"><span data-stu-id="09a9a-133">You'll know that you got the right boundaries and sizes of each BC and domain model if you have few strong relationships between domain models, and you do not usually need to merge information from multiple domain models when performing typical application operations.</span></span>

<span data-ttu-id="09a9a-134">Snad nejlepší odpověď na otázku, jak velký model domény pro každou mikroslužbu by měl být, je následující: měl by mít autonomní BC, co by bylo možné tak izolované, které vám umožní pracovat, aniž byste museli neustále přepínat do jiných kontextů (jiné mikroslužeb).</span><span class="sxs-lookup"><span data-stu-id="09a9a-134">Perhaps the best answer to the question of how large a domain model for each microservice should be is the following: it should have an autonomous BC, as isolated as possible, that enables you to work without having to constantly switch to other contexts (other microservice's models).</span></span> <span data-ttu-id="09a9a-135">Na obrázku 4-10 uvidíte, jak více mikroslužeb (více řadičů domény) každý má svůj vlastní model a jak jejich entity lze definovat, v závislosti na konkrétní požadavky pro každou z identifikovaných domén ve vaší aplikaci.</span><span class="sxs-lookup"><span data-stu-id="09a9a-135">In Figure 4-10, you can see how multiple microservices (multiple BCs) each has their own model and how their entities can be defined, depending on the specific requirements for each of the identified domains in your application.</span></span>

![Diagram znázorňující entity v několika hranicích modelu.](./media/identify-microservice-domain-model-boundaries/identify-entities-microservice-model-boundries.png)

<span data-ttu-id="09a9a-137">**Obrázek 4-10**.</span><span class="sxs-lookup"><span data-stu-id="09a9a-137">**Figure 4-10**.</span></span> <span data-ttu-id="09a9a-138">Identifikace entit a hranic modelu mikroslužeb</span><span class="sxs-lookup"><span data-stu-id="09a9a-138">Identifying entities and microservice model boundaries</span></span>

<span data-ttu-id="09a9a-139">Obrázek 4-10 znázorňuje ukázkový scénář související se systémem správy online konferencí.</span><span class="sxs-lookup"><span data-stu-id="09a9a-139">Figure 4-10 illustrates a sample scenario related to an online conference management system.</span></span> <span data-ttu-id="09a9a-140">Stejná entita se zobrazí jako "Uživatelé", "Kupující", "Plátci" a "Zákazníci" v závislosti na ohraničeném kontextu.</span><span class="sxs-lookup"><span data-stu-id="09a9a-140">The same entity appears as "Users", "Buyers", "Payers", and "Customers" depending on the bounded context.</span></span> <span data-ttu-id="09a9a-141">Identifikovali jste několik řadičů domény, které by mohly být implementovány jako mikroslužby, na základě domén, které pro vás definovali odborníci na doménu.</span><span class="sxs-lookup"><span data-stu-id="09a9a-141">You've identified several BCs that could be implemented as microservices, based on domains that domain experts defined for you.</span></span> <span data-ttu-id="09a9a-142">Jak můžete vidět, existují entity, které jsou k dispozici pouze v jednom modelu mikroslužeb, jako jsou platby v mikroslužbě platby.</span><span class="sxs-lookup"><span data-stu-id="09a9a-142">As you can see, there are entities that are present just in a single microservice model, like Payments in the Payment microservice.</span></span> <span data-ttu-id="09a9a-143">Ty budou snadno realizovatelné.</span><span class="sxs-lookup"><span data-stu-id="09a9a-143">Those will be easy to implement.</span></span>

<span data-ttu-id="09a9a-144">Můžete však mít také entity, které mají jiný tvar, ale sdílejí stejnou identitu napříč více modely domén z více mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="09a9a-144">However, you might also have entities that have a different shape but share the same identity across the multiple domain models from the multiple microservices.</span></span> <span data-ttu-id="09a9a-145">Například user entity je identifikován v mikroslužbě Správy konferencí.</span><span class="sxs-lookup"><span data-stu-id="09a9a-145">For example, the User entity is identified in the Conferences Management microservice.</span></span> <span data-ttu-id="09a9a-146">Stejný uživatel se stejnou identitou je ten, který je pojmenován kupující v objednávání mikroslužby, nebo ten s názvem Plátce v platební mikroslužby a dokonce i ten s názvem Zákazník v mikroslužbě služby zákazníkům.</span><span class="sxs-lookup"><span data-stu-id="09a9a-146">That same user, with the same identity, is the one named Buyers in the Ordering microservice, or the one named Payer in the Payment microservice, and even the one named Customer in the Customer Service microservice.</span></span> <span data-ttu-id="09a9a-147">Důvodem je, že v závislosti na [všudypřítomném jazyce,](https://martinfowler.com/bliki/UbiquitousLanguage.html) který používá každý odborník domény, může mít uživatel jinou perspektivu i s různými atributy.</span><span class="sxs-lookup"><span data-stu-id="09a9a-147">This is because, depending on the [ubiquitous language](https://martinfowler.com/bliki/UbiquitousLanguage.html) that each domain expert is using, a user might have a different perspective even with different attributes.</span></span> <span data-ttu-id="09a9a-148">Entita uživatele v modelu mikroslužeb s názvem Správa konferencí může mít většinu atributů svých osobních dat.</span><span class="sxs-lookup"><span data-stu-id="09a9a-148">The user entity in the microservice model named Conferences Management might have most of its personal data attributes.</span></span> <span data-ttu-id="09a9a-149">Však stejný uživatel ve tvaru plátce v mikroslužeb platby nebo ve tvaru zákazníka v mikroslužeb zákaznický servis nemusí potřebovat stejný seznam atributů.</span><span class="sxs-lookup"><span data-stu-id="09a9a-149">However, that same user in the shape of Payer in the microservice Payment or in the shape of Customer in the microservice Customer Service might not need the same list of attributes.</span></span>

<span data-ttu-id="09a9a-150">Podobný přístup je znázorněn na obrázku 4-11.</span><span class="sxs-lookup"><span data-stu-id="09a9a-150">A similar approach is illustrated in Figure 4-11.</span></span>

![Diagram znázorňující, jak rozložit datový model do více modelů domény.](./media/identify-microservice-domain-model-boundaries/decompose-traditional-data-models.png)

<span data-ttu-id="09a9a-152">**Obrázek 4-11**.</span><span class="sxs-lookup"><span data-stu-id="09a9a-152">**Figure 4-11**.</span></span> <span data-ttu-id="09a9a-153">Rozklad tradičních datových modelů na více modelů domény</span><span class="sxs-lookup"><span data-stu-id="09a9a-153">Decomposing traditional data models into multiple domain models</span></span>

<span data-ttu-id="09a9a-154">Při rozkladu tradiční datový model mezi ohraničené kontexty, můžete mít různé entity, které sdílejí stejnou identitu (kupující je také uživatel) s různými atributy v každém ohraničeném kontextu.</span><span class="sxs-lookup"><span data-stu-id="09a9a-154">When decomposing a traditional data model between bounded contexts, you can have different entities that share the same identity (a buyer is also a user) with different attributes in each bounded context.</span></span> <span data-ttu-id="09a9a-155">Můžete vidět, jak je uživatel přítomen v modelu mikroslužeb správy konferencí jako entita User a je také k dispozici ve formě entity Kupující v cenové mikroslužbě, s alternativními atributy nebo podrobnosti o uživateli, když je ve skutečnosti kupující.</span><span class="sxs-lookup"><span data-stu-id="09a9a-155">You can see how the user is present in the Conferences Management microservice model as the User entity and is also present in the form of the Buyer entity in the Pricing microservice, with alternate attributes or details about the user when it's actually a buyer.</span></span> <span data-ttu-id="09a9a-156">Každá mikroslužba nebo BC nemusí potřebovat všechna data související s entitou Uživatele, jen její část, v závislosti na problému k vyřešení nebo kontextu.</span><span class="sxs-lookup"><span data-stu-id="09a9a-156">Each microservice or BC might not need all the data related to a User entity, just part of it, depending on the problem to solve or the context.</span></span> <span data-ttu-id="09a9a-157">Například v modelu cenové mikroslužby nepotřebujete adresu nebo jméno uživatele, pouze ID (jako identitu) a stav, což bude mít vliv na slevy při stanovení cen licencí na kupujícího.</span><span class="sxs-lookup"><span data-stu-id="09a9a-157">For instance, in the Pricing microservice model, you do not need the address or the name of the user, just the ID (as identity) and Status, which will have an impact on discounts when pricing the seats per buyer.</span></span>

<span data-ttu-id="09a9a-158">Entita Seat má stejný název, ale různé atributy v každém modelu domény.</span><span class="sxs-lookup"><span data-stu-id="09a9a-158">The Seat entity has the same name but different attributes in each domain model.</span></span> <span data-ttu-id="09a9a-159">Seat však sdílí identitu na základě stejného ID, jak se děje s uživatelem a kupujícím.</span><span class="sxs-lookup"><span data-stu-id="09a9a-159">However, Seat shares identity based on the same ID, as happens with User and Buyer.</span></span>

<span data-ttu-id="09a9a-160">V podstatě existuje sdílený koncept uživatele, který existuje ve více službách (doménách), které všechny sdílejí identitu tohoto uživatele.</span><span class="sxs-lookup"><span data-stu-id="09a9a-160">Basically, there's a shared concept of a user that exists in multiple services (domains), which all share the identity of that user.</span></span> <span data-ttu-id="09a9a-161">Ale v každém modelu domény může být další nebo různé podrobnosti o entitě uživatele.</span><span class="sxs-lookup"><span data-stu-id="09a9a-161">But in each domain model there might be additional or different details about the user entity.</span></span> <span data-ttu-id="09a9a-162">Proto musí existovat způsob, jak mapovat entitu uživatele z jedné domény (mikroslužby) do jiné.</span><span class="sxs-lookup"><span data-stu-id="09a9a-162">Therefore, there needs to be a way to map a user entity from one domain (microservice) to another.</span></span>

<span data-ttu-id="09a9a-163">Existuje několik výhod, které nesdílejí stejnou entitu uživatele se stejným počtem atributů napříč doménami.</span><span class="sxs-lookup"><span data-stu-id="09a9a-163">There are several benefits to not sharing the same user entity with the same number of attributes across domains.</span></span> <span data-ttu-id="09a9a-164">Jednou z výhod je snížit duplicitu, takže modely mikroslužeb nemají žádná data, která nepotřebují.</span><span class="sxs-lookup"><span data-stu-id="09a9a-164">One benefit is to reduce duplication, so that microservice models do not have any data that they do not need.</span></span> <span data-ttu-id="09a9a-165">Další výhodou je mít hlavní mikroslužbu, která vlastní určitý typ dat na entitu tak, aby aktualizace a dotazy pro tento typ dat jsou řízeny pouze této mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="09a9a-165">Another benefit is having a master microservice that owns a certain type of data per entity so that updates and queries for that type of data are driven only by that microservice.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="09a9a-166">[Předchozí](distributed-data-management.md)
>[další](direct-client-to-microservice-communication-versus-the-api-gateway-pattern.md)</span><span class="sxs-lookup"><span data-stu-id="09a9a-166">[Previous](distributed-data-management.md)
[Next](direct-client-to-microservice-communication-versus-the-api-gateway-pattern.md)</span></span>
