---
title: Kontejnerizování monolitických aplikací
description: Kontejnerizace monolitických aplikací, i když nezíská všechny výhody z architektury mikroslužeb, má důležité výhody nasazení, které mohou být dodány hned.
ms.date: 01/30/2020
ms.openlocfilehash: 0e6f7504a91d2b1a89193471746168fc34f50956
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/14/2020
ms.locfileid: "77503289"
---
# <a name="containerizing-monolithic-applications"></a><span data-ttu-id="ab118-103">Kontejnerizování monolitických aplikací</span><span class="sxs-lookup"><span data-stu-id="ab118-103">Containerizing monolithic applications</span></span>

<span data-ttu-id="ab118-104">Můžete chtít vytvořit jednu, monoliticky nasazenou webovou aplikaci nebo službu a nasadit ji jako kontejner.</span><span class="sxs-lookup"><span data-stu-id="ab118-104">You might want to build a single, monolithically deployed web application or service and deploy it as a container.</span></span> <span data-ttu-id="ab118-105">Samotná aplikace nemusí být interně monolitická, ale strukturovaná jako několik knihoven, komponent nebo dokonce vrstev (aplikační vrstva, doménová vrstva, vrstva přístupu k datům atd.).</span><span class="sxs-lookup"><span data-stu-id="ab118-105">The application itself might not be internally monolithic, but structured as several libraries, components, or even layers (application layer, domain layer, data-access layer, etc.).</span></span> <span data-ttu-id="ab118-106">Externě se však jedná o jeden kontejner – jeden proces, jednu webovou aplikaci nebo jednu službu.</span><span class="sxs-lookup"><span data-stu-id="ab118-106">Externally, however, it's a single container—a single process, a single web application, or a single service.</span></span>

<span data-ttu-id="ab118-107">Chcete-li spravovat tento model, nasadit jeden kontejner reprezentovat aplikaci.</span><span class="sxs-lookup"><span data-stu-id="ab118-107">To manage this model, you deploy a single container to represent the application.</span></span> <span data-ttu-id="ab118-108">Chcete-li zvýšit kapacitu, můžete horizontální navýšení kapacity, to znamená, že stačí přidat další kopie s vyrovnáváním zatížení vpředu.</span><span class="sxs-lookup"><span data-stu-id="ab118-108">To increase capacity, you scale out, that is, just add more copies with a load balancer in front.</span></span> <span data-ttu-id="ab118-109">Jednoduchost pochází ze správy jednoho nasazení v jednom kontejneru nebo virtuálním počítače.</span><span class="sxs-lookup"><span data-stu-id="ab118-109">The simplicity comes from managing a single deployment in a single container or VM.</span></span>

![Diagram znázorňující součásti monolitické kontejnerové aplikace.](./media/containerize-monolithic-applications/monolithic-containerized-application.png)

<span data-ttu-id="ab118-111">**Obrázek 4-1**.</span><span class="sxs-lookup"><span data-stu-id="ab118-111">**Figure 4-1**.</span></span> <span data-ttu-id="ab118-112">Příklad architektury kontejnerizované monolitické aplikace</span><span class="sxs-lookup"><span data-stu-id="ab118-112">Example of the architecture of a containerized monolithic application</span></span>

<span data-ttu-id="ab118-113">Do každého kontejneru můžete zahrnout více součástí, knihoven nebo vnitřních vrstev, jak je znázorněno na obrázku 4-1.</span><span class="sxs-lookup"><span data-stu-id="ab118-113">You can include multiple components, libraries, or internal layers in each container, as illustrated in Figure 4-1.</span></span> <span data-ttu-id="ab118-114">Monolitické kontejnerizované aplikace má většinu svých funkcí v rámci jednoho kontejneru, s vnitřní vrstvy nebo knihovny a škáluje se klonování kontejneru na více serverů nebo virtuálních počítačích.</span><span class="sxs-lookup"><span data-stu-id="ab118-114">A monolithic containerized application has most of its functionality within a single container, with internal layers or libraries, and scales out by cloning the container on multiple servers/VMs.</span></span> <span data-ttu-id="ab118-115">Tento monolitický vzor však může být v konfliktu s principem kontejneru "kontejner dělá jednu věc a dělá to v jednom procesu", ale může být v pořádku v některých případech.</span><span class="sxs-lookup"><span data-stu-id="ab118-115">However, this monolithic pattern might conflict with the container principle "a container does one thing, and does it in one process", but might be ok for some cases.</span></span>

<span data-ttu-id="ab118-116">Nevýhodou tohoto přístupu se projeví, pokud aplikace roste, vyžadující škálování.</span><span class="sxs-lookup"><span data-stu-id="ab118-116">The downside of this approach becomes evident if the application grows, requiring it to scale.</span></span> <span data-ttu-id="ab118-117">Pokud celá aplikace může škálovat, není to opravdu problém.</span><span class="sxs-lookup"><span data-stu-id="ab118-117">If the entire application can scale, it isn't really a problem.</span></span> <span data-ttu-id="ab118-118">Ve většině případů však pouze několik částí aplikace jsou body sytiče, které vyžadují změnu měřítka, zatímco jiné součásti se používají méně.</span><span class="sxs-lookup"><span data-stu-id="ab118-118">However, in most cases, just a few parts of the application are the choke points that requiring scaling, while other components are used less.</span></span>

<span data-ttu-id="ab118-119">Například v typické aplikaci elektronického obchodování budete pravděpodobně muset škálovat subsystém informací o produktu, protože mnohem více zákazníků prochází produkty, než je zakoupí.</span><span class="sxs-lookup"><span data-stu-id="ab118-119">For example, in a typical e-commerce application, you likely need to scale the product information subsystem, because many more customers browse products than purchase them.</span></span> <span data-ttu-id="ab118-120">Více zákazníků používá svůj košík než kanál plateb.</span><span class="sxs-lookup"><span data-stu-id="ab118-120">More customers use their basket than use the payment pipeline.</span></span> <span data-ttu-id="ab118-121">Méně zákazníků přidává komentáře nebo si prohlíží historii nákupů.</span><span class="sxs-lookup"><span data-stu-id="ab118-121">Fewer customers add comments or view their purchase history.</span></span> <span data-ttu-id="ab118-122">A můžete mít jen hrstka zaměstnanců, kteří potřebují spravovat obsah a marketingové kampaně.</span><span class="sxs-lookup"><span data-stu-id="ab118-122">And you might have only a handful of employees that need to manage the content and marketing campaigns.</span></span> <span data-ttu-id="ab118-123">Pokud změníte velikost monolitické návrhu, veškerý kód pro tyto různé úkoly se nasadí vícekrát a škálovat na stejném stupni.</span><span class="sxs-lookup"><span data-stu-id="ab118-123">If you scale the monolithic design, all the code for these different tasks is deployed multiple times and scaled at the same grade.</span></span>

<span data-ttu-id="ab118-124">Existuje několik způsobů škálování duplikace aplikace horizontální, rozdělení různých oblastí aplikace a dělení podobné obchodní koncepty nebo data.</span><span class="sxs-lookup"><span data-stu-id="ab118-124">There are multiple ways to scale an application-horizontal duplication, splitting different areas of the application, and partitioning similar business concepts or data.</span></span> <span data-ttu-id="ab118-125">Kromě problému škálování všech součástí však změny jedné součásti vyžadují úplné opětovné testování celé aplikace a úplné opětovné nasazení všech instancí.</span><span class="sxs-lookup"><span data-stu-id="ab118-125">But, in addition to the problem of scaling all components, changes to a single component require complete retesting of the entire application, and a complete redeployment of all the instances.</span></span>

<span data-ttu-id="ab118-126">Monolitický přístup je však běžné, protože vývoj aplikace je zpočátku jednodušší než pro přístupy mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="ab118-126">However, the monolithic approach is common, because the development of the application is initially easier than for microservices approaches.</span></span> <span data-ttu-id="ab118-127">Tak, mnoho organizací rozvíjet pomocí tohoto architektonického přístupu.</span><span class="sxs-lookup"><span data-stu-id="ab118-127">Thus, many organizations develop using this architectural approach.</span></span> <span data-ttu-id="ab118-128">Zatímco některé organizace mají dost dobré výsledky, jiné jsou bít limity.</span><span class="sxs-lookup"><span data-stu-id="ab118-128">While some organizations have had good enough results, others are hitting limits.</span></span> <span data-ttu-id="ab118-129">Mnoho organizací navrhlo své aplikace pomocí tohoto modelu, protože nástroje a infrastruktura ztěžovaly vytváření architektur orientovaných na služby (SOA) před lety a neviděly potřebu - dokud aplikace nerostla.</span><span class="sxs-lookup"><span data-stu-id="ab118-129">Many organizations designed their applications using this model because tools and infrastructure made it too difficult to build service-oriented architectures (SOA) years ago, and they did not see the need-until the application grew.</span></span>

<span data-ttu-id="ab118-130">Z hlediska infrastruktury může každý server spouštět mnoho aplikací v rámci stejného hostitele a mít přijatelný poměr efektivity využití prostředků, jak je znázorněno na obrázku 4-2.</span><span class="sxs-lookup"><span data-stu-id="ab118-130">From an infrastructure perspective, each server can run many applications within the same host and have an acceptable ratio of efficiency in resources usage, as shown in Figure 4-2.</span></span>

![Diagram znázorňující jednoho hostitele, který používá mnoho aplikací v kontejnerech.](./media/containerize-monolithic-applications/host-multiple-apps-containers.png)

<span data-ttu-id="ab118-132">**Obrázek 4-2**.</span><span class="sxs-lookup"><span data-stu-id="ab118-132">**Figure 4-2**.</span></span> <span data-ttu-id="ab118-133">Monolitický přístup: Host se spuštěným více aplikacemi, z nichž každá běží jako kontejner</span><span class="sxs-lookup"><span data-stu-id="ab118-133">Monolithic approach: Host running multiple apps, each app running as a container</span></span>

<span data-ttu-id="ab118-134">Monolitické aplikace v Microsoft Azure lze nasadit pomocí vyhrazených virtuálních počítačů pro každou instanci.</span><span class="sxs-lookup"><span data-stu-id="ab118-134">Monolithic applications in Microsoft Azure can be deployed using dedicated VMs for each instance.</span></span> <span data-ttu-id="ab118-135">Kromě toho pomocí [škálovacísady virtuálních strojů Azure](https://azure.microsoft.com/documentation/services/virtual-machine-scale-sets/)můžete snadno škálovat virtuální počítače.</span><span class="sxs-lookup"><span data-stu-id="ab118-135">Additionally, using [Azure virtual machine scale sets](https://azure.microsoft.com/documentation/services/virtual-machine-scale-sets/), you can easily scale the VMs.</span></span> <span data-ttu-id="ab118-136">[Azure App Service](https://azure.microsoft.com/services/app-service/) můžete také spouštět monolitické aplikace a snadno škálovat instance bez nutnosti spravovat virtuální počítače.</span><span class="sxs-lookup"><span data-stu-id="ab118-136">[Azure App Service](https://azure.microsoft.com/services/app-service/) can also run monolithic applications and easily scale instances without requiring you to manage the VMs.</span></span> <span data-ttu-id="ab118-137">Od roku 2016 můžou Azure App Services spouštět i jednotlivé instance kontejnerů Dockeru, což zjednodušuje nasazení.</span><span class="sxs-lookup"><span data-stu-id="ab118-137">Since 2016, Azure App Services can run single instances of Docker containers as well, simplifying deployment.</span></span>

<span data-ttu-id="ab118-138">Jako prostředí qa nebo omezené produkční prostředí můžete nasadit více hostitelských virtuálních počítačů Dockeru a vyvážit je pomocí vyvažovače Azure, jak je znázorněno na obrázku 4-3.</span><span class="sxs-lookup"><span data-stu-id="ab118-138">As a QA environment or a limited production environment, you can deploy multiple Docker host VMs and balance them using the Azure balancer, as shown in Figure 4-3.</span></span> <span data-ttu-id="ab118-139">To umožňuje spravovat škálování s hrubým koeficientem přístup, protože celá aplikace žije v rámci jednoho kontejneru.</span><span class="sxs-lookup"><span data-stu-id="ab118-139">This lets you manage scaling with a coarse-grain approach, because the whole application lives within a single container.</span></span>

![Diagram znázorňující několik hostitelů, kteří spouštějí kontejnery monolitických aplikací.](./media/containerize-monolithic-applications/docker-infrastructure-monolithic-application.png)

<span data-ttu-id="ab118-141">**Obrázek 4-3**.</span><span class="sxs-lookup"><span data-stu-id="ab118-141">**Figure 4-3**.</span></span> <span data-ttu-id="ab118-142">Příklad více hostitelů, kteří zvětšují jednu aplikaci kontejneru</span><span class="sxs-lookup"><span data-stu-id="ab118-142">Example of multiple hosts scaling up a single container application</span></span>

<span data-ttu-id="ab118-143">Nasazení do různých hostitelů lze spravovat pomocí tradičních technik nasazení.</span><span class="sxs-lookup"><span data-stu-id="ab118-143">Deployment to the various hosts can be managed with traditional deployment techniques.</span></span> <span data-ttu-id="ab118-144">Hostitelé Dockeru lze spravovat `docker run` `docker-compose` pomocí příkazů, jako je třeba provést ručně nebo provádět je ručně, nebo prostřednictvím automatizace, jako jsou kanály pro průběžné doručování (CD).</span><span class="sxs-lookup"><span data-stu-id="ab118-144">Docker hosts can be managed with commands like `docker run` or `docker-compose` performed manually, or through automation such as continuous delivery (CD) pipelines.</span></span>

## <a name="deploying-a-monolithic-application-as-a-container"></a><span data-ttu-id="ab118-145">Nasazení monolitické aplikace jako kontejneru</span><span class="sxs-lookup"><span data-stu-id="ab118-145">Deploying a monolithic application as a container</span></span>

<span data-ttu-id="ab118-146">Použití kontejnerů ke správě nasazení monolitických aplikací přináší výhody.</span><span class="sxs-lookup"><span data-stu-id="ab118-146">There are benefits to using containers to manage monolithic application deployments.</span></span> <span data-ttu-id="ab118-147">Škálování instance kontejneru je mnohem rychlejší a jednodušší než nasazení dalších virtuálních mandů.</span><span class="sxs-lookup"><span data-stu-id="ab118-147">Scaling container instances is far faster and easier than deploying additional VMs.</span></span> <span data-ttu-id="ab118-148">I v případě, že používáte škálovací sady virtuálních strojů, virtuální počítače nějakou dobu trvat, než začít.</span><span class="sxs-lookup"><span data-stu-id="ab118-148">Even if you use virtual machine scale sets, VMs take time to start.</span></span> <span data-ttu-id="ab118-149">Při nasazení jako tradiční instance aplikace namísto kontejnerů, konfigurace aplikace se spravuje jako součást virtuálního počítače, což není ideální.</span><span class="sxs-lookup"><span data-stu-id="ab118-149">When deployed as traditional application instances instead of containers, the configuration of the application is managed as part of the VM, which isn't ideal.</span></span>

<span data-ttu-id="ab118-150">Nasazení aktualizací jako inamů Dockeru je mnohem rychlejší a efektivní v síti.</span><span class="sxs-lookup"><span data-stu-id="ab118-150">Deploying updates as Docker images is far faster and network efficient.</span></span> <span data-ttu-id="ab118-151">Image Dockeru se obvykle spouštějí během několika sekund, což urychluje zavádění.</span><span class="sxs-lookup"><span data-stu-id="ab118-151">Docker images typically start in seconds, which speeds rollouts.</span></span> <span data-ttu-id="ab118-152">Stržení instance image Dockeru je stejně snadné jako vydání příkazu `docker stop` a obvykle se dokončí za méně než sekundu.</span><span class="sxs-lookup"><span data-stu-id="ab118-152">Tearing down a Docker image instance is as easy as issuing a `docker stop` command, and typically completes in less than a second.</span></span>

<span data-ttu-id="ab118-153">Vzhledem k tomu, že kontejnery jsou neměnné podle návrhu, nikdy se nemusíte starat o poškozené virtuální chody.</span><span class="sxs-lookup"><span data-stu-id="ab118-153">Because containers are immutable by design, you never need to worry about corrupted VMs.</span></span> <span data-ttu-id="ab118-154">Naproti tomu aktualizace skriptů pro virtuální počítač může zapomenout na účet pro některé konkrétní konfigurace nebo soubor vlevo na disku.</span><span class="sxs-lookup"><span data-stu-id="ab118-154">In contrast, update scripts for a VM might forget to account for some specific configuration or file left on disk.</span></span>

<span data-ttu-id="ab118-155">Zatímco monolitické aplikace mohou těžit z Dockeru, dotýkáme se pouze výhod.</span><span class="sxs-lookup"><span data-stu-id="ab118-155">While monolithic applications can benefit from Docker, we're touching only on the benefits.</span></span> <span data-ttu-id="ab118-156">Další výhody správy kontejnerů pocházejí z nasazení s orchestrátory kontejnerů, které spravují různé instance a životní cyklus každé instance kontejneru.</span><span class="sxs-lookup"><span data-stu-id="ab118-156">Additional benefits of managing containers come from deploying with container orchestrators, which manage the various instances and lifecycle of each container instance.</span></span> <span data-ttu-id="ab118-157">Rozdělení monolitické aplikace do subsystémů, které lze škálovat, vyvíjet a nasazovat jednotlivě, je vstupním bodem do sféry mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="ab118-157">Breaking up the monolithic application into subsystems that can be scaled, developed, and deployed individually is your entry point into the realm of microservices.</span></span>

## <a name="publishing-a-single-container-based-application-to-azure-app-service"></a><span data-ttu-id="ab118-158">Publikování aplikace založené na jednom kontejneru do služby Azure App Service</span><span class="sxs-lookup"><span data-stu-id="ab118-158">Publishing a single-container-based application to Azure App Service</span></span>

<span data-ttu-id="ab118-159">Ať už chcete získat ověření kontejneru nasazeného do Azure nebo když je aplikace jednoduše aplikace s jedním kontejnerem, Azure App Service poskytuje skvělý způsob, jak poskytovat škálovatelné služby založené na jednom kontejneru.</span><span class="sxs-lookup"><span data-stu-id="ab118-159">Whether you want to get validation of a container deployed to Azure or when an application is simply a single-container application, Azure App Service provides a great way to provide scalable single-container-based services.</span></span> <span data-ttu-id="ab118-160">Používání služby Azure App Service je jednoduché.</span><span class="sxs-lookup"><span data-stu-id="ab118-160">Using Azure App Service is simple.</span></span> <span data-ttu-id="ab118-161">Poskytuje skvělou integraci s Gitem, která usnadňuje převzít váš kód, sestavit ho ve Visual Studiu a nasadit ho přímo do Azure.</span><span class="sxs-lookup"><span data-stu-id="ab118-161">It provides great integration with Git to make it easy to take your code, build it in Visual Studio, and deploy it directly to Azure.</span></span>

![Snímek obrazovky s dialogem Vytvořit službu aplikace zobrazujícího registr kontejnerů](./media/containerize-monolithic-applications/publish-azure-app-service-container.png)

<span data-ttu-id="ab118-163">**Obrázek 4-4**.</span><span class="sxs-lookup"><span data-stu-id="ab118-163">**Figure 4-4**.</span></span> <span data-ttu-id="ab118-164">Publikování aplikace s jedním kontejnerem do služby Azure App Service z Visual Studia 2019</span><span class="sxs-lookup"><span data-stu-id="ab118-164">Publishing a single-container application to Azure App Service from Visual Studio 2019</span></span>

<span data-ttu-id="ab118-165">Bez Dockeru, pokud potřebujete další možnosti, architektury nebo závislosti, které nejsou podporované ve službě Azure App Service, museli jste počkat, dokud tým Azure tyto závislosti aktualizuje ve službě App Service.</span><span class="sxs-lookup"><span data-stu-id="ab118-165">Without Docker, if you needed other capabilities, frameworks, or dependencies that aren't supported in Azure App Service, you had to wait until the Azure team updated those dependencies in App Service.</span></span> <span data-ttu-id="ab118-166">Nebo jste museli přejít na jiné služby, jako jsou Azure Cloud Services nebo virtuální počítače, kde jste měli další kontrolu a můžete nainstalovat požadovanou komponentu nebo architekturu pro vaši aplikaci.</span><span class="sxs-lookup"><span data-stu-id="ab118-166">Or you had to switch to other services like Azure Cloud Services or VMs, where you had further control and you could install a required component or framework for your application.</span></span>

<span data-ttu-id="ab118-167">Podpora kontejnerů ve Visual Studiu 2017 a novějších vám dává možnost zahrnout do aplikačního prostředí vše, co chcete, jak je znázorněno na obrázku 4-4.</span><span class="sxs-lookup"><span data-stu-id="ab118-167">Container support in Visual Studio 2017 and later gives you the ability to include whatever you want in your application environment, as shown in Figure 4-4.</span></span> <span data-ttu-id="ab118-168">Vzhledem k tomu, že jej spouštěte v kontejneru, pokud přidáte závislost do vaší aplikace, můžete zahrnout závislost do image Dockerfile nebo Docker.</span><span class="sxs-lookup"><span data-stu-id="ab118-168">Since you're running it in a container, if you add a dependency to your application, you can include the dependency in your Dockerfile or Docker image.</span></span>

<span data-ttu-id="ab118-169">Jak je znázorněno také na obrázku 4-4, tok publikování tlačí bitovou kopii prostřednictvím registru kontejneru.</span><span class="sxs-lookup"><span data-stu-id="ab118-169">As also shown in Figure 4-4, the publish flow pushes an image through a container registry.</span></span> <span data-ttu-id="ab118-170">Může se jednalo o registr kontejnerů Azure (registr blízký vašim nasazením v Azure a zabezpečený skupinami a účty služby Azure Active Directory) nebo jakýkoli jiný registr Dockeru, jako je Docker Hub nebo místní registr.</span><span class="sxs-lookup"><span data-stu-id="ab118-170">This can be the Azure Container Registry (a registry close to your deployments in Azure and secured by Azure Active Directory groups and accounts), or any other Docker registry, like Docker Hub or an on-premises registry.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="ab118-171">[Předchozí](index.md)
>[další](docker-application-state-data.md)</span><span class="sxs-lookup"><span data-stu-id="ab118-171">[Previous](index.md)
[Next](docker-application-state-data.md)</span></span>
