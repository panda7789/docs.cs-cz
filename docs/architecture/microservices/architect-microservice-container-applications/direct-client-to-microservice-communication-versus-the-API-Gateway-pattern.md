---
title: Vzor brány rozhraní API versus přímá komunikace mezi klientem a mikroslužbou
description: Pochopit rozdíly a použití vzoru brány rozhraní API a přímé komunikace klienta mikroslužeb.
ms.date: 01/07/2019
ms.openlocfilehash: 47e9a383c1fcb6c9fec38cb376b60a4ab839077d
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/14/2020
ms.locfileid: "79401723"
---
# <a name="the-api-gateway-pattern-versus-the-direct-client-to-microservice-communication"></a><span data-ttu-id="02653-103">Vzor brány rozhraní API versus přímá komunikace mezi klientem a mikroslužbou</span><span class="sxs-lookup"><span data-stu-id="02653-103">The API gateway pattern versus the Direct client-to-microservice communication</span></span>

<span data-ttu-id="02653-104">V architektuře mikroslužeb každá mikroslužba zveřejňuje sadu (obvykle) jemně odstupňované koncové body.</span><span class="sxs-lookup"><span data-stu-id="02653-104">In a microservices architecture, each microservice exposes a set of (typically) fine-grained endpoints.</span></span> <span data-ttu-id="02653-105">Tato skutečnost může mít vliv na komunikaci mezi klientem a mikroslužbou, jak je vysvětleno v této části.</span><span class="sxs-lookup"><span data-stu-id="02653-105">This fact can impact the client-to-microservice communication, as explained in this section.</span></span>

## <a name="direct-client-to-microservice-communication"></a><span data-ttu-id="02653-106">Přímá komunikace mezi klientem a mikroslužbami</span><span class="sxs-lookup"><span data-stu-id="02653-106">Direct client-to-microservice communication</span></span>

<span data-ttu-id="02653-107">Možný přístup je použití architektury přímé komunikace mezi klientem a mikroslužbami.</span><span class="sxs-lookup"><span data-stu-id="02653-107">A possible approach is to use a direct client-to-microservice communication architecture.</span></span> <span data-ttu-id="02653-108">V tomto přístupu klientská aplikace můžete provádět požadavky přímo na některé mikroslužeb, jak je znázorněno na obrázku 4-12.</span><span class="sxs-lookup"><span data-stu-id="02653-108">In this approach, a client app can make requests directly to some of the microservices, as shown in Figure 4-12.</span></span>

![Diagram znázorňující architekturu komunikace mezi klientem a mikroslužbami.](./media/direct-client-to-microservice-communication.png)

<span data-ttu-id="02653-110">**Obrázek 4-12**.</span><span class="sxs-lookup"><span data-stu-id="02653-110">**Figure 4-12**.</span></span> <span data-ttu-id="02653-111">Použití architektury přímé komunikace mezi klientem a mikroslužbami</span><span class="sxs-lookup"><span data-stu-id="02653-111">Using a direct client-to-microservice communication architecture</span></span>

<span data-ttu-id="02653-112">V tomto přístupu má každá mikroslužba veřejný koncový bod, někdy s jiným portem TCP pro každou mikroslužbu.</span><span class="sxs-lookup"><span data-stu-id="02653-112">In this approach, each microservice has a public endpoint, sometimes with a different TCP port for each microservice.</span></span> <span data-ttu-id="02653-113">Příkladem adresy URL pro konkrétní službu může být následující adresa URL v Azure:</span><span class="sxs-lookup"><span data-stu-id="02653-113">An example of a URL for a particular service could be the following URL in Azure:</span></span>

`http://eshoponcontainers.westus.cloudapp.azure.com:88/`

<span data-ttu-id="02653-114">V produkčním prostředí založeném na clusteru by tato adresa URL mapovala na nástroje pro vyrovnávání zatížení používaný v clusteru, který zase distribuuje požadavky mezi mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="02653-114">In a production environment based on a cluster, that URL would map to the load balancer used in the cluster, which in turn distributes the requests across the microservices.</span></span> <span data-ttu-id="02653-115">V produkčním prostředí můžete mít řadič pro doručování aplikací (ADC), jako je [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) mezi mikroslužbami a Internetem.</span><span class="sxs-lookup"><span data-stu-id="02653-115">In production environments, you could have an Application Delivery Controller (ADC) like [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) between your microservices and the Internet.</span></span> <span data-ttu-id="02653-116">To funguje jako transparentní vrstva, která nejen provádí vyrovnávání zatížení, ale zabezpečuje vaše služby tím, že nabízí ukončení SSL.</span><span class="sxs-lookup"><span data-stu-id="02653-116">This acts as a transparent tier that not only performs load balancing, but secures your services by offering SSL termination.</span></span> <span data-ttu-id="02653-117">To zlepšuje zatížení vašich hostitelů tím, že přečítáte ukončení SSL náročné na procesor a další povinnosti směrování do brány aplikace Azure.</span><span class="sxs-lookup"><span data-stu-id="02653-117">This improves the load of your hosts by offloading CPU-intensive SSL termination and other routing duties to the Azure Application Gateway.</span></span> <span data-ttu-id="02653-118">V každém případě je z hlediska architektury logické aplikace transparentní správce zatížení a ADC.</span><span class="sxs-lookup"><span data-stu-id="02653-118">In any case, a load balancer and ADC are transparent from a logical application architecture point of view.</span></span>

<span data-ttu-id="02653-119">Architektura přímé komunikace mezi klientem a mikroslužbami může být dost dobrá pro malou aplikaci založenou na mikroslužbách, zejména pokud je klientská aplikace webovou aplikací na straně serveru, jako je ASP.NET aplikace MVC.</span><span class="sxs-lookup"><span data-stu-id="02653-119">A direct client-to-microservice communication architecture could be good enough for a small microservice-based application, especially if the client app is a server-side web application like an ASP.NET MVC app.</span></span> <span data-ttu-id="02653-120">Však při vytváření velkých a složitých aplikací založených na mikroslužbách (například při zpracování desítky typů mikroslužeb), a zejména v případě, že klientské aplikace jsou vzdálené mobilní aplikace nebo SPA webové aplikace, tento přístup čelí několik problémů.</span><span class="sxs-lookup"><span data-stu-id="02653-120">However, when you build large and complex microservice-based applications (for example, when handling dozens of microservice types), and especially when the client apps are remote mobile apps or SPA web applications, that approach faces a few issues.</span></span>

<span data-ttu-id="02653-121">Při vývoji velké aplikace založené na mikroslužbách zvažte následující otázky:</span><span class="sxs-lookup"><span data-stu-id="02653-121">Consider the following questions when developing a large application based on microservices:</span></span>

- <span data-ttu-id="02653-122">*Jak mohou klientské aplikace minimalizovat počet požadavků na back-end a snížit upovídanou komunikaci s více mikroslužbami?*</span><span class="sxs-lookup"><span data-stu-id="02653-122">*How can client apps minimize the number of requests to the back end and reduce chatty communication to multiple microservices?*</span></span>

<span data-ttu-id="02653-123">Interakce s více mikroslužeb k vytvoření jedné obrazovky ui zvyšuje počet zpátečních cest přes Internet.</span><span class="sxs-lookup"><span data-stu-id="02653-123">Interacting with multiple microservices to build a single UI screen increases the number of round trips across the Internet.</span></span> <span data-ttu-id="02653-124">To zvyšuje latenci a složitost na straně ui.</span><span class="sxs-lookup"><span data-stu-id="02653-124">This increases latency and complexity on the UI side.</span></span> <span data-ttu-id="02653-125">V ideálním případě by odpovědi měly být efektivně agregovány na straně serveru.</span><span class="sxs-lookup"><span data-stu-id="02653-125">Ideally, responses should be efficiently aggregated in the server side.</span></span> <span data-ttu-id="02653-126">To snižuje latenci, protože více kusů dat vrátit paralelně a některé uI můžete zobrazit data, jakmile je připraven.</span><span class="sxs-lookup"><span data-stu-id="02653-126">This reduces latency, since multiple pieces of data come back in parallel and some UI can show data as soon as it's ready.</span></span>

- <span data-ttu-id="02653-127">*Jak můžete zpracovat průřezové problémy, jako je autorizace, transformace dat a dynamické odesílání požadavků?*</span><span class="sxs-lookup"><span data-stu-id="02653-127">*How can you handle cross-cutting concerns such as authorization, data transformations, and dynamic request dispatching?*</span></span>

<span data-ttu-id="02653-128">Implementace zabezpečení a průřezové obavy, jako je zabezpečení a autorizace na každé mikroslužby může vyžadovat značné úsilí vývoje.</span><span class="sxs-lookup"><span data-stu-id="02653-128">Implementing security and cross-cutting concerns like security and authorization on every microservice can require significant development effort.</span></span> <span data-ttu-id="02653-129">Možným přístupem je mít tyto služby v rámci hostitele Dockeru nebo interní cluster omezit přímý přístup k nim zvenčí a implementovat tyto průřezové obavy v centralizovaném místě, jako je brána rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="02653-129">A possible approach is to have those services within the Docker host or internal cluster to restrict direct access to them from the outside, and to implement those cross-cutting concerns in a centralized place, like an API Gateway.</span></span>

- <span data-ttu-id="02653-130">*Jak mohou klientské aplikace komunikovat se službami, které používají protokoly, které nejsou vhodné pro internet?*</span><span class="sxs-lookup"><span data-stu-id="02653-130">*How can client apps communicate with services that use non-Internet-friendly protocols?*</span></span>

<span data-ttu-id="02653-131">Protokoly používané na straně serveru (například AMQP nebo binární protokoly) obvykle nejsou v klientských aplikacích podporovány.</span><span class="sxs-lookup"><span data-stu-id="02653-131">Protocols used on the server side (like AMQP or binary protocols) are usually not supported in client apps.</span></span> <span data-ttu-id="02653-132">Proto požadavky musí být provedeny prostřednictvím protokolů, jako je HTTP/HTTPS a překládat do jiných protokolů později.</span><span class="sxs-lookup"><span data-stu-id="02653-132">Therefore, requests must be performed through protocols like HTTP/HTTPS and translated to the other protocols afterwards.</span></span> <span data-ttu-id="02653-133">*Man-in-the-middle* přístup může pomoci v této situaci.</span><span class="sxs-lookup"><span data-stu-id="02653-133">A *man-in-the-middle* approach can help in this situation.</span></span>

- <span data-ttu-id="02653-134">*Jak můžete utvářet fasádu speciálně vyrobenou pro mobilní aplikace?*</span><span class="sxs-lookup"><span data-stu-id="02653-134">*How can you shape a facade especially made for mobile apps?*</span></span>

<span data-ttu-id="02653-135">Rozhraní API více mikroslužeb nemusí být dobře navrženy pro potřeby různých klientských aplikací.</span><span class="sxs-lookup"><span data-stu-id="02653-135">The API of multiple microservices might not be well designed for the needs of different client applications.</span></span> <span data-ttu-id="02653-136">Například potřeby mobilní aplikace se mohou lišit od potřeb webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="02653-136">For instance, the needs of a mobile app might be different than the needs of a web app.</span></span> <span data-ttu-id="02653-137">Pro mobilní aplikace může být nutné optimalizovat ještě dále, aby odpovědi na data mohly být efektivnější.</span><span class="sxs-lookup"><span data-stu-id="02653-137">For mobile apps, you might need to optimize even further so that data responses can be more efficient.</span></span> <span data-ttu-id="02653-138">Můžete to provést agregací dat z více mikroslužeb a vrácením jedné sady dat a někdy odstraněním všech dat v odpovědi, která mobilní aplikace nepotřebuje.</span><span class="sxs-lookup"><span data-stu-id="02653-138">You might do this by aggregating data from multiple microservices and returning a single set of data, and sometimes eliminating any data in the response that isn't needed by the mobile app.</span></span> <span data-ttu-id="02653-139">A samozřejmě, můžete komprimovat tato data.</span><span class="sxs-lookup"><span data-stu-id="02653-139">And, of course, you might compress that data.</span></span> <span data-ttu-id="02653-140">Opět platí, že fasáda nebo rozhraní API mezi mobilní aplikace a mikroslužeb může být vhodné pro tento scénář.</span><span class="sxs-lookup"><span data-stu-id="02653-140">Again, a facade or API in between the mobile app and the microservices can be convenient for this scenario.</span></span>

## <a name="why-consider-api-gateways-instead-of-direct-client-to-microservice-communication"></a><span data-ttu-id="02653-141">Proč zvážit brány rozhraní API namísto přímé komunikace mezi klientem a mikroslužbami</span><span class="sxs-lookup"><span data-stu-id="02653-141">Why consider API Gateways instead of direct client-to-microservice communication</span></span>

<span data-ttu-id="02653-142">V architektuře mikroslužeb klientské aplikace obvykle potřebují využívat funkce z více než jedné mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="02653-142">In a microservices architecture, the client apps usually need to consume functionality from more than one microservice.</span></span> <span data-ttu-id="02653-143">Pokud se tato spotřeba provádí přímo, klient potřebuje zpracovat více volání koncových bodů mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="02653-143">If that consumption is performed directly, the client needs to handle multiple calls to microservice endpoints.</span></span> <span data-ttu-id="02653-144">Co se stane, když se aplikace vyvíjí a jsou zavedeny nové mikroslužby nebo jsou aktualizovány stávající mikroslužby?</span><span class="sxs-lookup"><span data-stu-id="02653-144">What happens when the application evolves and new microservices are introduced or existing microservices are updated?</span></span> <span data-ttu-id="02653-145">Pokud vaše aplikace má mnoho mikroslužeb, zpracování tolik koncových bodů z klientských aplikací může být noční můra.</span><span class="sxs-lookup"><span data-stu-id="02653-145">If your application has many microservices, handling so many endpoints from the client apps can be a nightmare.</span></span> <span data-ttu-id="02653-146">Vzhledem k tomu, že klientská aplikace by být spojeny s těmito interníkoncové body, vyvíjející se mikroslužeb v budoucnu může způsobit velký dopad na klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="02653-146">Since the client app would be coupled to those internal endpoints, evolving the microservices in the future can cause high impact for the client apps.</span></span>

<span data-ttu-id="02653-147">Proto s mezilehlou úroveň nebo úroveň dereference (Gateway) může být velmi vhodné pro aplikace založené na mikroslužbách.</span><span class="sxs-lookup"><span data-stu-id="02653-147">Therefore, having an intermediate level or tier of indirection (Gateway) can be very convenient for microservice-based applications.</span></span> <span data-ttu-id="02653-148">Pokud nemáte brány rozhraní API, klientské aplikace musí odesílat požadavky přímo mikroslužbám a to vyvolává problémy, jako jsou následující problémy:</span><span class="sxs-lookup"><span data-stu-id="02653-148">If you don't have API Gateways, the client apps must send requests directly to the microservices and that raises problems, such as the following issues:</span></span>

- <span data-ttu-id="02653-149">**Párování**: Bez vzoru brány rozhraní API jsou klientské aplikace spojeny s interními mikroslužbami.</span><span class="sxs-lookup"><span data-stu-id="02653-149">**Coupling**: Without the API Gateway pattern, the client apps are coupled to the internal microservices.</span></span> <span data-ttu-id="02653-150">Klientské aplikace potřebují vědět, jak se v mikroslužbách rozloží více oblastí aplikace.</span><span class="sxs-lookup"><span data-stu-id="02653-150">The client apps need to know how the multiple areas of the application are decomposed in microservices.</span></span> <span data-ttu-id="02653-151">Při vývoji a refaktoring interní mikroslužeb, tyto akce dopad údržby docela špatně, protože způsobují narušující změny klientských aplikací z důvodu přímý odkaz na interní mikroslužeb z klientských aplikací.</span><span class="sxs-lookup"><span data-stu-id="02653-151">When evolving and refactoring the internal microservices, those actions impact maintenance pretty badly because they cause breaking changes to the client apps due to the direct reference to the internal microservices from the client apps.</span></span> <span data-ttu-id="02653-152">Klientské aplikace je třeba často aktualizovat, což ztěžuje vývoj řešení.</span><span class="sxs-lookup"><span data-stu-id="02653-152">Client apps need to be updated frequently, making the solution harder to evolve.</span></span>

- <span data-ttu-id="02653-153">**Příliš mnoho zpátečních cest**: Jedna stránka nebo obrazovka v klientské aplikaci může vyžadovat několik volání více služeb.</span><span class="sxs-lookup"><span data-stu-id="02653-153">**Too many round trips**: A single page/screen in the client app might require several calls to multiple services.</span></span> <span data-ttu-id="02653-154">To může mít za následek více síťových zpátečních cest mezi klientem a serverem, přidání významné latence.</span><span class="sxs-lookup"><span data-stu-id="02653-154">That can result in multiple network round trips between the client and the server, adding significant latency.</span></span> <span data-ttu-id="02653-155">Agregace zpracovat v mezilehlé úrovni může zlepšit výkon a uživatelské prostředí pro klientskou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="02653-155">Aggregation handled in an intermediate level could improve the performance and user experience for the client app.</span></span>

- <span data-ttu-id="02653-156">**Problémy se zabezpečením**: Bez brány všechny mikroslužby musí být vystaveny "externí svět", takže prostor pro útok větší, než pokud skrýt interní mikroslužeb, které nejsou přímo používány klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="02653-156">**Security issues**: Without a gateway, all the microservices must be exposed to the "external world", making the attack surface larger than if you hide internal microservices that aren't directly used by the client apps.</span></span> <span data-ttu-id="02653-157">Čím menší je povrch útoku, tím bezpečnější může být vaše aplikace.</span><span class="sxs-lookup"><span data-stu-id="02653-157">The smaller the attack surface is, the more secure your application can be.</span></span>

- <span data-ttu-id="02653-158">**Průřezové obavy**: Každá veřejně publikovaná mikroslužba musí řešit obavy, jako je autorizace, SSL atd. V mnoha situacích tyto obavy by mohly být zpracovány v jedné vrstvě, takže vnitřní mikroslužby jsou zjednodušeny.</span><span class="sxs-lookup"><span data-stu-id="02653-158">**Cross-cutting concerns**: Each publicly published microservice must handle concerns such as authorization, SSL, etc. In many situations, those concerns could be handled in a single tier so the internal microservices are simplified.</span></span>

## <a name="what-is-the-api-gateway-pattern"></a><span data-ttu-id="02653-159">Co je vzor brány rozhraní API?</span><span class="sxs-lookup"><span data-stu-id="02653-159">What is the API Gateway pattern?</span></span>

<span data-ttu-id="02653-160">Při navrhování a vytváření velkých nebo složitých aplikací založených na mikroslužbách s více klientskými aplikacemi může být dobrým přístupem, který je třeba zvážit, [brána rozhraní API](https://microservices.io/patterns/apigateway.html).</span><span class="sxs-lookup"><span data-stu-id="02653-160">When you design and build large or complex microservice-based applications with multiple client apps, a good approach to consider can be an [API Gateway](https://microservices.io/patterns/apigateway.html).</span></span> <span data-ttu-id="02653-161">Toto je služba, která poskytuje jeden vstupní bod pro určité skupiny mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="02653-161">This is a service that provides a single-entry point for certain groups of microservices.</span></span> <span data-ttu-id="02653-162">Je to podobné [vzoru Fasáda](https://en.wikipedia.org/wiki/Facade_pattern) z objektově orientovaného designu, ale v tomto případě je součástí distribuovaného systému.</span><span class="sxs-lookup"><span data-stu-id="02653-162">It's similar to the [Facade pattern](https://en.wikipedia.org/wiki/Facade_pattern) from object-oriented design, but in this case, it's part of a distributed system.</span></span> <span data-ttu-id="02653-163">Vzor brány rozhraní API je také někdy známý jako "back-end pro frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)), protože jej vytvoříte při přemýšlení o potřebách klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="02653-163">The API Gateway pattern is also sometimes known as the "backend for frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) because you build it while thinking about the needs of the client app.</span></span>

<span data-ttu-id="02653-164">Proto brána rozhraní API je mezi klientské aplikace a mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="02653-164">Therefore, the API gateway sits between the client apps and the microservices.</span></span> <span data-ttu-id="02653-165">Funguje jako reverzní proxy server, směrování požadavků od klientů ke službám.</span><span class="sxs-lookup"><span data-stu-id="02653-165">It acts as a reverse proxy, routing requests from clients to services.</span></span> <span data-ttu-id="02653-166">Může také poskytovat další průřezové funkce, jako je ověřování, ukončení Protokolu SSL a mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="02653-166">It can also provide additional cross-cutting features such as authentication, SSL termination, and cache.</span></span>

<span data-ttu-id="02653-167">Obrázek 4-13 ukazuje, jak se vlastní brána rozhraní API vejde do zjednodušené architektury založené na mikroslužbách s několika mikroslužbami.</span><span class="sxs-lookup"><span data-stu-id="02653-167">Figure 4-13 shows how a custom API Gateway can fit into a simplified microservice-based architecture with just a few microservices.</span></span>

![Diagram znázorňující bránu rozhraní API implementovanou jako vlastní službu.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/custom-service-api-gateway.png)

<span data-ttu-id="02653-169">**Obrázek 4-13**.</span><span class="sxs-lookup"><span data-stu-id="02653-169">**Figure 4-13**.</span></span> <span data-ttu-id="02653-170">Použití brány rozhraní API implementované jako vlastní služby</span><span class="sxs-lookup"><span data-stu-id="02653-170">Using an API Gateway implemented as a custom service</span></span>

<span data-ttu-id="02653-171">Aplikace se připojují k jedinému koncovému bodu, bráně rozhraní API, která je nakonfigurovaná tak, aby přesměrovala požadavky na jednotlivé mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="02653-171">Apps connect to a single endpoint, the API Gateway, that's configured to forward requests to individual microservices.</span></span> <span data-ttu-id="02653-172">V tomto příkladu brána rozhraní API by být implementována jako vlastní ASP.NET služby Core WebHost běží jako kontejner.</span><span class="sxs-lookup"><span data-stu-id="02653-172">In this example, the API Gateway would be implemented as a custom ASP.NET Core WebHost service running as a container.</span></span>

<span data-ttu-id="02653-173">Je důležité zdůraznit, že v tomto diagramu byste používali jednu vlastní službu brány rozhraní API, která čelí více a různým klientským aplikacím.</span><span class="sxs-lookup"><span data-stu-id="02653-173">It's important to highlight that in that diagram, you would be using a single custom API Gateway service facing multiple and different client apps.</span></span> <span data-ttu-id="02653-174">Tato skutečnost může být důležitým rizikem, protože vaše služba brány rozhraní API bude růst a vyvíjet se na základě mnoha různých požadavků z klientských aplikací.</span><span class="sxs-lookup"><span data-stu-id="02653-174">That fact can be an important risk because your API Gateway service will be growing and evolving based on many different requirements from the client apps.</span></span> <span data-ttu-id="02653-175">Nakonec, to bude nafouklý, protože tyto různé potřeby a efektivně by to mohlo být docela podobné monolitické aplikace nebo monolitické služby.</span><span class="sxs-lookup"><span data-stu-id="02653-175">Eventually, it will be bloated because of those different needs and effectively it could be pretty similar to a monolithic application or monolithic service.</span></span> <span data-ttu-id="02653-176">That's why it's very much recommended to split the API Gateway in multiple services or multiple smaller API Gateways, one per client app form-factor type, for instance.</span><span class="sxs-lookup"><span data-stu-id="02653-176">That's why it's very much recommended to split the API Gateway in multiple services or multiple smaller API Gateways, one per client app form-factor type, for instance.</span></span>

<span data-ttu-id="02653-177">Při implementaci vzoru brány rozhraní API musíte být opatrní.</span><span class="sxs-lookup"><span data-stu-id="02653-177">You need to be careful when implementing the API Gateway pattern.</span></span> <span data-ttu-id="02653-178">Obvykle není vhodné mít jednu bránu rozhraní API agregovat všechny interní mikroslužeb vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="02653-178">Usually it isn't a good idea to have a single API Gateway aggregating all the internal microservices of your application.</span></span> <span data-ttu-id="02653-179">Pokud ano, funguje jako monolitický agregátor nebo orchestrator a porušuje autonomii mikroslužeb propojením všech mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="02653-179">If it does, it acts as a monolithic aggregator or orchestrator and violates microservice autonomy by coupling all the microservices.</span></span>

<span data-ttu-id="02653-180">Brány rozhraní API by proto měly být odděleny na základě obchodních hranic a klientských aplikací a neměly by fungovat jako jeden agregátor pro všechny interní mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="02653-180">Therefore, the API Gateways should be segregated based on business boundaries and the client apps and not act as a single aggregator for all the internal microservices.</span></span>

<span data-ttu-id="02653-181">Při rozdělení úrovně brány rozhraní API do více bran rozhraní API, pokud vaše aplikace má více klientských aplikací, které může být primární pivot při identifikaci více typů brány rozhraní API, takže můžete mít jinou fasádu pro potřeby každé klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="02653-181">When splitting the API Gateway tier into multiple API Gateways, if your application has multiple client apps, that can be a primary pivot when identifying the multiple API Gateways types, so that you can have a different facade for the needs of each client app.</span></span> <span data-ttu-id="02653-182">Tento případ je vzor s názvem "Backend pro front-end" ([BFF),](https://samnewman.io/patterns/architectural/bff/)kde každá brána rozhraní API může poskytnout jiné rozhraní API přizpůsobené pro každý typ klientské aplikace, případně i na základě faktoru tvaru klienta implementací konkrétního kódu adaptéru, který pod voláním více interních mikroslužeb, jak je znázorněno na následujícím obrázku:</span><span class="sxs-lookup"><span data-stu-id="02653-182">This case is a pattern named "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) where each API Gateway can provide a different API tailored for each client app type, possibly even based on the client form factor by implementing specific adapter code which underneath calls multiple internal microservices, as shown in the following image:</span></span>

![Diagram znázorňující více vlastních bran rozhraní API.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/multiple-custom-api-gateways.png)

<span data-ttu-id="02653-184">**Obrázek 4-13.1**.</span><span class="sxs-lookup"><span data-stu-id="02653-184">**Figure 4-13.1**.</span></span> <span data-ttu-id="02653-185">Použití více vlastních bran rozhraní API</span><span class="sxs-lookup"><span data-stu-id="02653-185">Using multiple custom API Gateways</span></span>

<span data-ttu-id="02653-186">Obrázek 4-13.1 znázorňuje brány rozhraní API, které jsou odděleny podle typu klienta; jeden pro mobilní klienty a jeden pro webové klienty.</span><span class="sxs-lookup"><span data-stu-id="02653-186">Figure 4-13.1 shows API Gateways that are segregated by client type; one for mobile clients and one for web clients.</span></span> <span data-ttu-id="02653-187">Tradiční webová aplikace se připojuje k mikroslužbě MVC, která používá webovou bránu rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="02653-187">A traditional web app connects to an MVC microservice that uses the web API Gateway.</span></span> <span data-ttu-id="02653-188">Příklad znázorňuje zjednodušenou architekturu s více jemně odstupňovanými bránami rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="02653-188">The example depicts a simplified architecture with multiple fine-grained API Gateways.</span></span> <span data-ttu-id="02653-189">V tomto případě jsou hranice identifikované pro každou bránu rozhraní API založeny čistě na vzoru "Backend for Frontend" ([BFF),](https://samnewman.io/patterns/architectural/bff/)tedy pouze na základě rozhraní API potřebného pro klientskou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="02653-189">In this case, the boundaries identified for each API Gateway are based purely on the "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) pattern, hence based just on the API needed per client app.</span></span> <span data-ttu-id="02653-190">Ale ve větších aplikacích byste měli také jít dál a vytvořit další brány rozhraní API založené na obchodních hranicích jako druhý pivot návrhu.</span><span class="sxs-lookup"><span data-stu-id="02653-190">But in larger applications you should also go further and create additional API Gateways based on business boundaries as a second design pivot.</span></span>

## <a name="main-features-in-the-api-gateway-pattern"></a><span data-ttu-id="02653-191">Hlavní funkce ve vzoru brány rozhraní API</span><span class="sxs-lookup"><span data-stu-id="02653-191">Main features in the API Gateway pattern</span></span>

<span data-ttu-id="02653-192">Brána rozhraní API může nabízet více funkcí.</span><span class="sxs-lookup"><span data-stu-id="02653-192">An API Gateway can offer multiple features.</span></span> <span data-ttu-id="02653-193">V závislosti na produktu může nabízet bohatší nebo jednodušší funkce, ale nejdůležitější a základní funkce pro všechny brány rozhraní API jsou následující návrhové vzory:</span><span class="sxs-lookup"><span data-stu-id="02653-193">Depending on the product it might offer richer or simpler features, however, the most important and foundational features for any API Gateway are the following design patterns:</span></span>

<span data-ttu-id="02653-194">**Reverzní směrování proxy nebo brány.**</span><span class="sxs-lookup"><span data-stu-id="02653-194">**Reverse proxy or gateway routing.**</span></span> <span data-ttu-id="02653-195">Brána rozhraní API nabízí reverzní proxy pro přesměrování nebo směrování požadavků (směrování vrstvy 7, obvykle požadavky HTTP) do koncových bodů interních mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="02653-195">The API Gateway offers a reverse proxy to redirect or route requests (layer 7 routing, usually HTTP requests) to the endpoints of the internal microservices.</span></span> <span data-ttu-id="02653-196">Brána poskytuje jeden koncový bod nebo adresu URL pro klientské aplikace a pak interně mapuje požadavky na skupinu interních mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="02653-196">The gateway provides a single endpoint or URL for the client apps and then internally maps the requests to a group of internal microservices.</span></span> <span data-ttu-id="02653-197">Tato funkce směrování pomáhá oddělit klientské aplikace od mikroslužeb, ale je také velmi pohodlné při modernizaci monolitického rozhraní API tím, že sedí bránu rozhraní API mezi monolitické rozhraní API a klientské aplikace, pak můžete přidat nová rozhraní API jako nové mikroslužby při stále používáte starší monolitické rozhraní API, dokud se v budoucnu nerozdělí na mnoho mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="02653-197">This routing feature helps to decouple the client apps from the microservices but it's also pretty convenient when modernizing a monolithic API by sitting the API Gateway in between the monolithic API and the client apps, then you can add new APIs as new microservices while still using the legacy monolithic API until it's split into many microservices in the future.</span></span> <span data-ttu-id="02653-198">Z důvodu brány rozhraní API si klientské aplikace nevšimnou, pokud jsou používaná rozhraní API implementována jako interní mikroslužby nebo monolitické rozhraní API a co je důležitější, při vývoji a refaktorování monolitického rozhraní API do mikroslužeb, a to díky směrování brány rozhraní API , klientské aplikace nebudou ovlivněny žádnou změnou identifikátoru URI.</span><span class="sxs-lookup"><span data-stu-id="02653-198">Because of the API Gateway, the client apps won't notice if the APIs being used are implemented as internal microservices or a monolithic API and more importantly, when evolving and refactoring the monolithic API into microservices, thanks to the API Gateway routing, client apps won't be impacted with any URI change.</span></span>

<span data-ttu-id="02653-199">Další informace naleznete v tématu [Gateway routing pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-routing).</span><span class="sxs-lookup"><span data-stu-id="02653-199">For more information, see [Gateway routing pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-routing).</span></span>

<span data-ttu-id="02653-200">**Požadavky agregace.**</span><span class="sxs-lookup"><span data-stu-id="02653-200">**Requests aggregation.**</span></span> <span data-ttu-id="02653-201">Jako součást vzoru brány můžete agregovat více požadavků klientů (obvykle http požadavky) cílení více interních mikroslužeb do jednoho požadavku klienta.</span><span class="sxs-lookup"><span data-stu-id="02653-201">As part of the gateway pattern you can aggregate multiple client requests (usually HTTP requests) targeting multiple internal microservices into a single client request.</span></span> <span data-ttu-id="02653-202">Tento vzor je zvláště vhodné, když stránka klienta nebo obrazovka potřebuje informace z několika mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="02653-202">This pattern is especially convenient when a client page/screen needs information from several microservices.</span></span> <span data-ttu-id="02653-203">S tímto přístupem klientská aplikace odešle jeden požadavek do brány rozhraní API, která odešle několik požadavků na interní mikroslužeb a pak agreguje výsledky a odešle vše zpět do klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="02653-203">With this approach, the client app sends a single request to the API Gateway that dispatches several requests to the internal microservices and then aggregates the results and sends everything back to the client app.</span></span> <span data-ttu-id="02653-204">Hlavní výhodou a cílem tohoto návrhového vzoru je snížit chattiness mezi klientskými aplikacemi a rozhraním API back-endu, což je obzvláště důležité pro vzdálené aplikace mimo datové centrum, kde žijí mikroslužby, jako jsou mobilní aplikace nebo požadavky pocházející z aplikací SPA, které pocházejí z Javascriptu v klientských vzdálených prohlížečích.</span><span class="sxs-lookup"><span data-stu-id="02653-204">The main benefit and goal of this design pattern is to reduce chattiness between the client apps and the backend API, which is especially important for remote apps out of the datacenter where the microservices live, like mobile apps or requests coming from SPA apps that come from Javascript in client remote browsers.</span></span> <span data-ttu-id="02653-205">Pro běžné webové aplikace, které provádějí požadavky v prostředí serveru (například ASP.NET webové aplikace Core MVC), není tento vzor tak důležitý, protože latence je mnohem menší než u vzdálených klientských aplikací.</span><span class="sxs-lookup"><span data-stu-id="02653-205">For regular web apps performing the requests in the server environment (like an ASP.NET Core MVC web app), this pattern is not so important as the latency is very much smaller than for remote client apps.</span></span>

<span data-ttu-id="02653-206">V závislosti na produktu brány rozhraní API, který používáte, může být schopen provést tuto agregaci.</span><span class="sxs-lookup"><span data-stu-id="02653-206">Depending on the API Gateway product you use, it might be able to perform this aggregation.</span></span> <span data-ttu-id="02653-207">V mnoha případech je však flexibilnější vytvořit mikroslužby agregace v rámci oboru brány rozhraní API, takže definujete agregaci v kódu (to znamená kód C#):</span><span class="sxs-lookup"><span data-stu-id="02653-207">However, in many cases it's more flexible to create aggregation microservices under the scope of the API Gateway, so you define the aggregation in code (that is, C# code):</span></span>

<span data-ttu-id="02653-208">Další informace naleznete [v tématu Gateway agregace vzor](https://docs.microsoft.com/azure/architecture/patterns/gateway-aggregation).</span><span class="sxs-lookup"><span data-stu-id="02653-208">For more information, see [Gateway aggregation pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-aggregation).</span></span>

<span data-ttu-id="02653-209">**Průřezové obavy nebo vyložení brány.**</span><span class="sxs-lookup"><span data-stu-id="02653-209">**Cross-cutting concerns or gateway offloading.**</span></span> <span data-ttu-id="02653-210">V závislosti na funkcích nabízených jednotlivými produkty brány rozhraní API můžete převést funkce z jednotlivých mikroslužeb do brány, což zjednodušuje implementaci každé mikroslužby konsolidací průřezových problémů do jedné vrstvy.</span><span class="sxs-lookup"><span data-stu-id="02653-210">Depending on the features offered by each API Gateway product, you can offload functionality from individual microservices to the gateway, which simplifies the implementation of each microservice by consolidating cross-cutting concerns into one tier.</span></span> <span data-ttu-id="02653-211">To je zvláště vhodné pro specializované funkce, které mohou být složité správně implementovat v každé interní mikroslužby, jako jsou následující funkce:</span><span class="sxs-lookup"><span data-stu-id="02653-211">This is especially convenient for specialized features that can be complex to implement properly in every internal microservice, such as the following functionality:</span></span>

- <span data-ttu-id="02653-212">Ověřování a autorizace</span><span class="sxs-lookup"><span data-stu-id="02653-212">Authentication and authorization</span></span>
- <span data-ttu-id="02653-213">Integrace zjišťování služeb</span><span class="sxs-lookup"><span data-stu-id="02653-213">Service discovery integration</span></span>
- <span data-ttu-id="02653-214">Ukládání odpovědí do mezipaměti</span><span class="sxs-lookup"><span data-stu-id="02653-214">Response caching</span></span>
- <span data-ttu-id="02653-215">Zásady opakování, jistič a technologie QoS</span><span class="sxs-lookup"><span data-stu-id="02653-215">Retry policies, circuit breaker, and QoS</span></span>
- <span data-ttu-id="02653-216">Omezení rychlosti a omezení</span><span class="sxs-lookup"><span data-stu-id="02653-216">Rate limiting and throttling</span></span>
- <span data-ttu-id="02653-217">Vyrovnávání zatížení</span><span class="sxs-lookup"><span data-stu-id="02653-217">Load balancing</span></span>
- <span data-ttu-id="02653-218">Protokolování, trasování, korelace</span><span class="sxs-lookup"><span data-stu-id="02653-218">Logging, tracing, correlation</span></span>
- <span data-ttu-id="02653-219">Záhlaví, řetězce dotazů a transformace deklarací identity</span><span class="sxs-lookup"><span data-stu-id="02653-219">Headers, query strings, and claims transformation</span></span>
- <span data-ttu-id="02653-220">Seznam povolených adres IP</span><span class="sxs-lookup"><span data-stu-id="02653-220">IP whitelisting</span></span>

<span data-ttu-id="02653-221">Další informace naleznete v [tématu Gateway offloading pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-offloading).</span><span class="sxs-lookup"><span data-stu-id="02653-221">For more information, see [Gateway offloading pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-offloading).</span></span>

## <a name="using-products-with-api-gateway-features"></a><span data-ttu-id="02653-222">Používání produktů s funkcemi brány rozhraní API</span><span class="sxs-lookup"><span data-stu-id="02653-222">Using products with API Gateway features</span></span>

<span data-ttu-id="02653-223">V závislosti na každé implementaci může existovat mnoho dalších průřezových problémů nabízených produkty brány rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="02653-223">There can be many more cross-cutting concerns offered by the API Gateways products depending on each implementation.</span></span> <span data-ttu-id="02653-224">Prozkoumáme zde:</span><span class="sxs-lookup"><span data-stu-id="02653-224">We'll explore here:</span></span>

- [<span data-ttu-id="02653-225">Azure API Management</span><span class="sxs-lookup"><span data-stu-id="02653-225">Azure API Management</span></span>](https://azure.microsoft.com/services/api-management/)
- [<span data-ttu-id="02653-226">Ocelot</span><span class="sxs-lookup"><span data-stu-id="02653-226">Ocelot</span></span>](https://github.com/ThreeMammals/Ocelot)

### <a name="azure-api-management"></a><span data-ttu-id="02653-227">Azure API Management</span><span class="sxs-lookup"><span data-stu-id="02653-227">Azure API Management</span></span>

<span data-ttu-id="02653-228">[Azure API Management](https://azure.microsoft.com/services/api-management/) (jak je znázorněno na obrázku 4-14) nejen řeší vaše potřeby brány rozhraní API, ale poskytuje funkce, jako je shromažďování přehledů z vašich rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="02653-228">[Azure API Management](https://azure.microsoft.com/services/api-management/) (as shown in Figure 4-14) not only solves your API Gateway needs but provides features like gathering insights from your APIs.</span></span> <span data-ttu-id="02653-229">Pokud používáte řešení pro správu rozhraní API, brána rozhraní API je jenom součást v rámci tohoto úplného řešení pro správu rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="02653-229">If you're using an API management solution, an API Gateway is only a component within that full API management solution.</span></span>

![Diagram znázorňující, jak používat Azure API Management jako bránu rozhraní API.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/api-gateway-azure-api-management.png)

<span data-ttu-id="02653-231">**Obrázek 4-14**.</span><span class="sxs-lookup"><span data-stu-id="02653-231">**Figure 4-14**.</span></span> <span data-ttu-id="02653-232">Použití Azure API Management pro bránu rozhraní API</span><span class="sxs-lookup"><span data-stu-id="02653-232">Using Azure API Management for your API Gateway</span></span>

<span data-ttu-id="02653-233">Azure API Management řeší vaše brány rozhraní API a potřeby správy, jako je protokolování, zabezpečení, měření atd. V tomto případě při použití produktu, jako je Správa rozhraní API Azure, skutečnost, že můžete mít jednu bránu rozhraní API není tak riskantní, protože tyto druhy brány rozhraní API jsou "tenčí", což znamená, že neimplementujete vlastní kód Jazyka C#, který by se mohl vyvíjet směrem k monolitické součásti.</span><span class="sxs-lookup"><span data-stu-id="02653-233">Azure API Management solves both your API Gateway and Management needs like logging, security, metering, etc. In this case, when using a product like Azure API Management, the fact that you might have a single API Gateway is not so risky because these kinds of API Gateways are "thinner", meaning that you don't implement custom C# code that could evolve towards a monolithic component.</span></span>

<span data-ttu-id="02653-234">Produkty brány rozhraní API obvykle fungují jako reverzní proxy pro příchozí komunikaci, kde můžete také filtrovat rozhraní API z interních mikroslužeb a použít autorizaci na publikovaná rozhraní API v této jedné vrstvě.</span><span class="sxs-lookup"><span data-stu-id="02653-234">The API Gateway products usually act like a reverse proxy for ingress communication, where you can also filter the APIs from the internal microservices plus apply authorization to the published APIs in this single tier.</span></span>

<span data-ttu-id="02653-235">Přehledy dostupné ze systému správy rozhraní API vám pomohou pochopit, jak se vaše rozhraní API používají a jak si vedou.</span><span class="sxs-lookup"><span data-stu-id="02653-235">The insights available from an API Management system help you get an understanding of how your APIs are being used and how they are performing.</span></span> <span data-ttu-id="02653-236">Dělají to tím, že vám umožní zobrazit přehledy analýz v reálném čase a identifikovat trendy, které by mohly mít vliv na vaši firmu.</span><span class="sxs-lookup"><span data-stu-id="02653-236">They do this by letting you view near real-time analytics reports and identifying trends that might impact your business.</span></span> <span data-ttu-id="02653-237">Navíc můžete mít protokoly o činnosti požadavků a odpovědí pro další online a offline analýzu.</span><span class="sxs-lookup"><span data-stu-id="02653-237">Plus, you can have logs about request and response activity for further online and offline analysis.</span></span>

<span data-ttu-id="02653-238">Pomocí Azure API Management můžete zabezpečit rozhraní API pomocí klíče, tokenu a filtrování IP adres.</span><span class="sxs-lookup"><span data-stu-id="02653-238">With Azure API Management, you can secure your APIs using a key, a token, and IP filtering.</span></span> <span data-ttu-id="02653-239">Tyto funkce umožňují vynutit flexibilní a jemně odstupňované kvóty a omezení rychlosti, upravit tvar a chování vašich api pomocí zásad a zlepšit výkon pomocí ukládání odpovědí do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="02653-239">These features let you enforce flexible and fine-grained quotas and rate limits, modify the shape and behavior of your APIs using policies, and improve performance with response caching.</span></span>

<span data-ttu-id="02653-240">V této příručce a referenční ukázkové aplikace (eShopOnContainers) je architektura omezena na jednodušší a na zakázku vyrobenou kontejnerizovanou architekturu, aby se zaměřila na prosté kontejnery bez použití produktů PaaS, jako je Správa rozhraní API Azure.</span><span class="sxs-lookup"><span data-stu-id="02653-240">In this guide and the reference sample application (eShopOnContainers), the architecture is limited to a simpler and custom-made containerized architecture in order to focus on plain containers without using PaaS products like Azure API Management.</span></span> <span data-ttu-id="02653-241">Ale pro velké aplikace založené na mikroslužbách, které se nasazují do Microsoft Azure, doporučujeme vyhodnotit Azure API Management jako základ pro vaše brány rozhraní API v produkčním prostředí.</span><span class="sxs-lookup"><span data-stu-id="02653-241">But for large microservice-based applications that are deployed into Microsoft Azure, we encourage you to evaluate Azure API Management as the base for your API Gateways in production.</span></span>

### <a name="ocelot"></a><span data-ttu-id="02653-242">Ocelot</span><span class="sxs-lookup"><span data-stu-id="02653-242">Ocelot</span></span>

<span data-ttu-id="02653-243">[Ocelot](https://github.com/ThreeMammals/Ocelot) je lehká brána rozhraní API, doporučená pro jednodušší přístupy.</span><span class="sxs-lookup"><span data-stu-id="02653-243">[Ocelot](https://github.com/ThreeMammals/Ocelot) is a lightweight API Gateway, recommended for simpler approaches.</span></span> <span data-ttu-id="02653-244">Ocelot je brána ROZHRANÍ API založená na open source jádru, která je speciálně vyrobena pro architekturu mikroslužeb, která potřebuje jednotné vstupní body do svého systému.</span><span class="sxs-lookup"><span data-stu-id="02653-244">Ocelot is an Open Source .NET Core based API Gateway especially made for microservices architecture that need unified points of entry into their system.</span></span> <span data-ttu-id="02653-245">Je lehký, rychlý, škálovatelný a poskytuje směrování a ověřování mezi mnoha dalšími funkcemi.</span><span class="sxs-lookup"><span data-stu-id="02653-245">It's lightweight, fast, scalable and provides routing and authentication among many other features.</span></span>

<span data-ttu-id="02653-246">Hlavním důvodem pro výběr Ocelot u [referenční aplikace eShopOnContainers](https://github.com/dotnet-architecture/eShopOnContainers) je, že Ocelot je .NET Core lightweight API Gateway, kterou můžete nasadit do stejného prostředí nasazení aplikace, kde nasazujete mikroslužby/kontejnery, jako je například Hostitel Dockeru, Kubernetes atd. A protože je založen na .NET Core, je to cross-platformní umožňuje nasazení na Linuxu nebo Windows.</span><span class="sxs-lookup"><span data-stu-id="02653-246">The main reason to choose Ocelot for the [eShopOnContainers reference application](https://github.com/dotnet-architecture/eShopOnContainers) is because Ocelot is a .NET Core lightweight API Gateway that you can deploy into the same application deployment environment where you're deploying your microservices/containers, such as a Docker Host, Kubernetes, etc. And since it's based on .NET Core, it's cross-platform allowing you to deploy on Linux or Windows.</span></span>

<span data-ttu-id="02653-247">Předchozí diagramy znázorňující vlastní brány rozhraní API spuštěné v kontejnerech jsou přesně tak, jak můžete také spustit Ocelot v kontejneru a aplikaci založené na mikroslužbách.</span><span class="sxs-lookup"><span data-stu-id="02653-247">The previous diagrams showing custom API Gateways running in containers are precisely how you can also run Ocelot in a container and microservice-based application.</span></span>

<span data-ttu-id="02653-248">Kromě toho existuje mnoho dalších produktů na trhu, které nabízejí funkce brány rozhraní API, jako je Apigee, Kong, MuleSoft, WSO2 a další produkty, jako je Linkerd a Istio pro funkce řadiče sítě služeb.</span><span class="sxs-lookup"><span data-stu-id="02653-248">In addition, there are many other products in the market offering API Gateways features, such as Apigee, Kong, MuleSoft, WSO2, and other products like Linkerd and Istio for service mesh ingress controller features.</span></span>

<span data-ttu-id="02653-249">Po počáteční architektury a vzory vysvětlení části, další části vysvětlují, jak implementovat brány rozhraní API s [Ocelot](https://github.com/ThreeMammals/Ocelot).</span><span class="sxs-lookup"><span data-stu-id="02653-249">After the initial architecture and patterns explanation sections, the next sections explain how to implement API Gateways with [Ocelot](https://github.com/ThreeMammals/Ocelot).</span></span>

## <a name="drawbacks-of-the-api-gateway-pattern"></a><span data-ttu-id="02653-250">Nevýhody vzoru brány rozhraní API</span><span class="sxs-lookup"><span data-stu-id="02653-250">Drawbacks of the API Gateway pattern</span></span>

- <span data-ttu-id="02653-251">Nejdůležitější nevýhodou je, že při implementaci brány rozhraní API, jste připojení této vrstvy s interní mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="02653-251">The most important drawback is that when you implement an API Gateway, you're coupling that tier with the internal microservices.</span></span> <span data-ttu-id="02653-252">Párování, jako je tento, může způsobit vážné potíže pro vaši aplikaci.</span><span class="sxs-lookup"><span data-stu-id="02653-252">Coupling like this might introduce serious difficulties for your application.</span></span> <span data-ttu-id="02653-253">Clemens Vaster, architekt v týmu Azure Service Bus, odkazuje na tento potenciální problém jako "nový ESB" v relaci "[Zasílání zpráv a mikroslužeb](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" na GOTO 2016.</span><span class="sxs-lookup"><span data-stu-id="02653-253">Clemens Vaster, architect at the Azure Service Bus team, refers to this potential difficulty as "the new ESB" in the "[Messaging and Microservices](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" session at GOTO 2016.</span></span>

- <span data-ttu-id="02653-254">Pomocí brány rozhraní API mikroslužeb vytvoří další možný jediný bod selhání.</span><span class="sxs-lookup"><span data-stu-id="02653-254">Using a microservices API Gateway creates an additional possible single point of failure.</span></span>

- <span data-ttu-id="02653-255">Brána rozhraní API může zavést delší dobu odezvy z důvodu dalšího volání sítě.</span><span class="sxs-lookup"><span data-stu-id="02653-255">An API Gateway can introduce increased response time due to the additional network call.</span></span> <span data-ttu-id="02653-256">Toto volání navíc však má obvykle menší dopad než s rozhraní klienta, který je příliš upovídaný přímo volání interní mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="02653-256">However, this extra call usually has less impact than having a client interface that's too chatty directly calling the internal microservices.</span></span>

- <span data-ttu-id="02653-257">Pokud není správně škálovat, brána rozhraní API se může stát kritickým bodem.</span><span class="sxs-lookup"><span data-stu-id="02653-257">If not scaled out properly, the API Gateway can become a bottleneck.</span></span>

- <span data-ttu-id="02653-258">Brána rozhraní API vyžaduje další náklady na vývoj a budoucí údržbu, pokud zahrnuje vlastní logiku a agregaci dat.</span><span class="sxs-lookup"><span data-stu-id="02653-258">An API Gateway requires additional development cost and future maintenance if it includes custom logic and data aggregation.</span></span> <span data-ttu-id="02653-259">Vývojáři musí aktualizovat bránu rozhraní API, aby bylo možné vystavit koncové body jednotlivých mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="02653-259">Developers must update the API Gateway in order to expose each microservice's endpoints.</span></span> <span data-ttu-id="02653-260">Kromě toho změny implementace v interní mikroslužeb může způsobit změny kódu na úrovni brány rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="02653-260">Moreover, implementation changes in the internal microservices might cause code changes at the API Gateway level.</span></span> <span data-ttu-id="02653-261">Pokud však brána rozhraní API používá pouze zabezpečení, protokolování a správu verzí (jako při použití služby Azure API Management), nemusí se tyto dodatečné náklady na vývoj použít.</span><span class="sxs-lookup"><span data-stu-id="02653-261">However, if the API Gateway is just applying security, logging, and versioning (as when using Azure API Management), this additional development cost might not apply.</span></span>

- <span data-ttu-id="02653-262">Pokud brána rozhraní API je vyvinuta jedním týmem, může existovat kritické místo vývoje.</span><span class="sxs-lookup"><span data-stu-id="02653-262">If the API Gateway is developed by a single team, there can be a development bottleneck.</span></span> <span data-ttu-id="02653-263">To je další důvod, proč je lepším přístupem mít několik chybně odstupňovaných bran rozhraní API, které reagují na různé potřeby klientů.</span><span class="sxs-lookup"><span data-stu-id="02653-263">This is another reason why a better approach is to have several fined-grained API Gateways that respond to different client needs.</span></span> <span data-ttu-id="02653-264">Můžete také oddělit bránu rozhraní API interně do více oblastí nebo vrstev, které jsou vlastněny různými týmy pracujícími na interních mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="02653-264">You could also segregate the API Gateway internally into multiple areas or layers that are owned by the different teams working on the internal microservices.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="02653-265">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="02653-265">Additional resources</span></span>

- <span data-ttu-id="02653-266">**Chrise Richardsona. Vzor: Brána rozhraní API / back-end pro front-end** </span><span class="sxs-lookup"><span data-stu-id="02653-266">**Chris Richardson. Pattern: API Gateway / Backend for Front-End** </span></span>\
  <https://microservices.io/patterns/apigateway.html>

- <span data-ttu-id="02653-267">**Vzor brány rozhraní API** </span><span class="sxs-lookup"><span data-stu-id="02653-267">**API Gateway pattern** </span></span>\
  <https://docs.microsoft.com/azure/architecture/microservices/gateway>

- <span data-ttu-id="02653-268">**Vzor agregace a složení** </span><span class="sxs-lookup"><span data-stu-id="02653-268">**Aggregation and composition pattern** </span></span>\
  <https://microservices.io/patterns/data/api-composition.html>

- <span data-ttu-id="02653-269">**Správa rozhraní AZURE API** </span><span class="sxs-lookup"><span data-stu-id="02653-269">**Azure API Management** </span></span>\
  <https://azure.microsoft.com/services/api-management/>

- <span data-ttu-id="02653-270">**Udi Dahan. Služba orientovaná kompozice** </span><span class="sxs-lookup"><span data-stu-id="02653-270">**Udi Dahan. Service Oriented Composition** </span></span>\
  <http://udidahan.com/2014/07/30/service-oriented-composition-with-video/>

- <span data-ttu-id="02653-271">**Clemens Vasters. Zasílání zpráv a mikroslužby na GOTO 2016 (video)** </span><span class="sxs-lookup"><span data-stu-id="02653-271">**Clemens Vasters. Messaging and Microservices at GOTO 2016 (video)** </span></span>\
  <https://www.youtube.com/watch?v=rXi5CLjIQ9k>

- <span data-ttu-id="02653-272">**Brána rozhraní API v kostce** (ASP.net základní řady výukových programů brány rozhraní API) </span><span class="sxs-lookup"><span data-stu-id="02653-272">**API Gateway in a Nutshell** (ASP.net Core API Gateway Tutorial Series) </span></span>\
  <https://www.pogsdotnet.com/2018/08/api-gateway-in-nutshell.html>

>[!div class="step-by-step"]
><span data-ttu-id="02653-273">[Předchozí](identify-microservice-domain-model-boundaries.md)
>[další](communication-in-microservice-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="02653-273">[Previous](identify-microservice-domain-model-boundaries.md)
[Next](communication-in-microservice-architecture.md)</span></span>
