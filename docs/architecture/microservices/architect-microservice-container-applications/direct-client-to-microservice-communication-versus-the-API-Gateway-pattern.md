---
title: Vzor brány rozhraní API oproti přímé komunikaci mezi klientem a mikroslužbou
description: Seznamte se s rozdíly a využitím vzoru brány API a přímé komunikace mezi klientem a mikroslužbou.
ms.date: 01/07/2019
ms.openlocfilehash: 089b6302132437e4bb733653b3edb401ff81a164
ms.sourcegitcommit: 5280b2aef60a1ed99002dba44e4b9e7f6c830604
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/03/2020
ms.locfileid: "84306952"
---
# <a name="the-api-gateway-pattern-versus-the-direct-client-to-microservice-communication"></a><span data-ttu-id="f992e-103">Vzor brány rozhraní API oproti přímé komunikaci mezi klientem a mikroslužbou</span><span class="sxs-lookup"><span data-stu-id="f992e-103">The API gateway pattern versus the Direct client-to-microservice communication</span></span>

<span data-ttu-id="f992e-104">V architektuře mikroslužeb každá mikroslužba zveřejňuje sadu (typicky) jemně odstupňovaných koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="f992e-104">In a microservices architecture, each microservice exposes a set of (typically) fine-grained endpoints.</span></span> <span data-ttu-id="f992e-105">Tato skutečnost může mít dopad na komunikaci mezi klientem a mikroslužbou, jak je vysvětleno v této části.</span><span class="sxs-lookup"><span data-stu-id="f992e-105">This fact can impact the client-to-microservice communication, as explained in this section.</span></span>

## <a name="direct-client-to-microservice-communication"></a><span data-ttu-id="f992e-106">Přímá komunikace mezi klientem a mikroslužbou</span><span class="sxs-lookup"><span data-stu-id="f992e-106">Direct client-to-microservice communication</span></span>

<span data-ttu-id="f992e-107">Možným přístupem je použití přímé architektury komunikace mezi klientem a mikroslužbou.</span><span class="sxs-lookup"><span data-stu-id="f992e-107">A possible approach is to use a direct client-to-microservice communication architecture.</span></span> <span data-ttu-id="f992e-108">V tomto přístupu může klientská aplikace dělat požadavky přímo na některé mikroslužby, jak je znázorněno na obrázku 4-12.</span><span class="sxs-lookup"><span data-stu-id="f992e-108">In this approach, a client app can make requests directly to some of the microservices, as shown in Figure 4-12.</span></span>

![Diagram znázorňující architekturu komunikace mezi klientem a mikroslužbou.](./media/direct-client-to-microservice-communication.png)

<span data-ttu-id="f992e-110">**Obrázek 4-12**.</span><span class="sxs-lookup"><span data-stu-id="f992e-110">**Figure 4-12**.</span></span> <span data-ttu-id="f992e-111">Použití přímé architektury komunikace mezi klientem a mikroslužbou</span><span class="sxs-lookup"><span data-stu-id="f992e-111">Using a direct client-to-microservice communication architecture</span></span>

<span data-ttu-id="f992e-112">V tomto postupu má každá mikroslužba veřejný koncový bod, někdy s jiným portem TCP pro každou mikroslužbu.</span><span class="sxs-lookup"><span data-stu-id="f992e-112">In this approach, each microservice has a public endpoint, sometimes with a different TCP port for each microservice.</span></span> <span data-ttu-id="f992e-113">Příkladem adresy URL konkrétní služby může být následující adresa URL v Azure:</span><span class="sxs-lookup"><span data-stu-id="f992e-113">An example of a URL for a particular service could be the following URL in Azure:</span></span>

`http://eshoponcontainers.westus.cloudapp.azure.com:88/`

<span data-ttu-id="f992e-114">V produkčním prostředí založeném na clusteru by tato adresa URL byla namapována na nástroj pro vyrovnávání zatížení, který se používá v clusteru, který pak rozšíří požadavky napříč mikroslužbami.</span><span class="sxs-lookup"><span data-stu-id="f992e-114">In a production environment based on a cluster, that URL would map to the load balancer used in the cluster, which in turn distributes the requests across the microservices.</span></span> <span data-ttu-id="f992e-115">V produkčních prostředích můžete mít k dispozici řadič pro doručování aplikací (ADC), jako je například [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) mezi vašimi mikroslužbami a internetem.</span><span class="sxs-lookup"><span data-stu-id="f992e-115">In production environments, you could have an Application Delivery Controller (ADC) like [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) between your microservices and the Internet.</span></span> <span data-ttu-id="f992e-116">Funguje jako průhledná vrstva, která neprovádí vyrovnávání zatížení, ale zabezpečuje vaše služby tím, že nabízí ukončení protokolu SSL.</span><span class="sxs-lookup"><span data-stu-id="f992e-116">This acts as a transparent tier that not only performs load balancing, but secures your services by offering SSL termination.</span></span> <span data-ttu-id="f992e-117">Tím se zlepšuje zatížení hostitelů tím, že dojde k přesměrování ukončení protokolu SSL náročného na procesor a dalších funkcí směrování do Azure Application Gateway.</span><span class="sxs-lookup"><span data-stu-id="f992e-117">This improves the load of your hosts by offloading CPU-intensive SSL termination and other routing duties to the Azure Application Gateway.</span></span> <span data-ttu-id="f992e-118">Nástroj pro vyrovnávání zatížení a konektor ADC jsou v každém případě transparentní z pohledu logické architektury aplikace.</span><span class="sxs-lookup"><span data-stu-id="f992e-118">In any case, a load balancer and ADC are transparent from a logical application architecture point of view.</span></span>

<span data-ttu-id="f992e-119">Pro malou aplikaci založenou na mikroslužbách by mohla být dostatečná pro komunikaci mezi klientem a mikroslužbou, zejména v případě, že klientská aplikace je webová aplikace, jako je aplikace ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="f992e-119">A direct client-to-microservice communication architecture could be good enough for a small microservice-based application, especially if the client app is a server-side web application like an ASP.NET MVC app.</span></span> <span data-ttu-id="f992e-120">Nicméně při vytváření rozsáhlých a složitých aplikací založených na mikroslužbách (například při manipulaci s desítkami typů mikroslužeb) a zejména v případě, že jsou klientské aplikace vzdálené mobilní aplikace nebo zabezpečené webové aplikace, které se blíží několika problémům.</span><span class="sxs-lookup"><span data-stu-id="f992e-120">However, when you build large and complex microservice-based applications (for example, when handling dozens of microservice types), and especially when the client apps are remote mobile apps or SPA web applications, that approach faces a few issues.</span></span>

<span data-ttu-id="f992e-121">Při vývoji velké aplikace založené na mikroslužbách Vezměte v úvahu následující otázky:</span><span class="sxs-lookup"><span data-stu-id="f992e-121">Consider the following questions when developing a large application based on microservices:</span></span>

- <span data-ttu-id="f992e-122">*Jak můžou klientské aplikace minimalizovat počet požadavků na back-end a snížit komunikaci s konverzacemi s více mikroslužbami?*</span><span class="sxs-lookup"><span data-stu-id="f992e-122">*How can client apps minimize the number of requests to the back end and reduce chatty communication to multiple microservices?*</span></span>

<span data-ttu-id="f992e-123">Interakce s více mikroslužbami při vytváření jediné obrazovky uživatelského rozhraní zvyšuje počet přenosů po internetu.</span><span class="sxs-lookup"><span data-stu-id="f992e-123">Interacting with multiple microservices to build a single UI screen increases the number of round trips across the Internet.</span></span> <span data-ttu-id="f992e-124">Tím se zvyšuje latence a složitost na straně uživatelského rozhraní.</span><span class="sxs-lookup"><span data-stu-id="f992e-124">This increases latency and complexity on the UI side.</span></span> <span data-ttu-id="f992e-125">V ideálním případě by se odpovědi měly efektivně agregovat na straně serveru.</span><span class="sxs-lookup"><span data-stu-id="f992e-125">Ideally, responses should be efficiently aggregated in the server side.</span></span> <span data-ttu-id="f992e-126">Tím se snižuje latence, protože se souběžně vrací více dat a některé uživatelské rozhraní může zobrazit data hned po jejím dokončení.</span><span class="sxs-lookup"><span data-stu-id="f992e-126">This reduces latency, since multiple pieces of data come back in parallel and some UI can show data as soon as it's ready.</span></span>

- <span data-ttu-id="f992e-127">*Jak můžete zpracovávat problémy mezi průřezy, například autorizací, transformace dat a dynamické odesílání požadavků?*</span><span class="sxs-lookup"><span data-stu-id="f992e-127">*How can you handle cross-cutting concerns such as authorization, data transformations, and dynamic request dispatching?*</span></span>

<span data-ttu-id="f992e-128">Implementace zabezpečení a mezi průřezy, jako je zabezpečení a autorizace u každé mikroslužby, může vyžadovat významné úsilí při vývoji.</span><span class="sxs-lookup"><span data-stu-id="f992e-128">Implementing security and cross-cutting concerns like security and authorization on every microservice can require significant development effort.</span></span> <span data-ttu-id="f992e-129">Možným přístupem je mít tyto služby v rámci hostitele Docker nebo interního clusteru k omezení přímého přístupu k nim zvenčí a k implementaci těchto obav v centralizovaném umístění, jako je brána API.</span><span class="sxs-lookup"><span data-stu-id="f992e-129">A possible approach is to have those services within the Docker host or internal cluster to restrict direct access to them from the outside, and to implement those cross-cutting concerns in a centralized place, like an API Gateway.</span></span>

- <span data-ttu-id="f992e-130">*Jak můžou klientské aplikace komunikovat se službami, které používají jiné protokoly než Internet?*</span><span class="sxs-lookup"><span data-stu-id="f992e-130">*How can client apps communicate with services that use non-Internet-friendly protocols?*</span></span>

<span data-ttu-id="f992e-131">Protokoly používané na straně serveru (například AMQP nebo binární protokoly) nejsou většinou podporovány v klientských aplikacích.</span><span class="sxs-lookup"><span data-stu-id="f992e-131">Protocols used on the server side (like AMQP or binary protocols) are usually not supported in client apps.</span></span> <span data-ttu-id="f992e-132">Proto musí být požadavky provedeny prostřednictvím protokolů jako HTTP/HTTPS a následně přeloženy do dalších protokolů.</span><span class="sxs-lookup"><span data-stu-id="f992e-132">Therefore, requests must be performed through protocols like HTTP/HTTPS and translated to the other protocols afterwards.</span></span> <span data-ttu-id="f992e-133">V této situaci vám může pomáhat *útok* prostředníkem.</span><span class="sxs-lookup"><span data-stu-id="f992e-133">A *man-in-the-middle* approach can help in this situation.</span></span>

- <span data-ttu-id="f992e-134">*Jak můžete vytvořit obrazec fasády, která je zvlášť vytvořená pro mobilní aplikace?*</span><span class="sxs-lookup"><span data-stu-id="f992e-134">*How can you shape a facade especially made for mobile apps?*</span></span>

<span data-ttu-id="f992e-135">Rozhraní API pro více mikroslužeb nemusí být navržené pro potřeby různých klientských aplikací.</span><span class="sxs-lookup"><span data-stu-id="f992e-135">The API of multiple microservices might not be well designed for the needs of different client applications.</span></span> <span data-ttu-id="f992e-136">Třeba požadavky mobilní aplikace se mohou lišit od potřeb webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="f992e-136">For instance, the needs of a mobile app might be different than the needs of a web app.</span></span> <span data-ttu-id="f992e-137">U mobilních aplikací možná budete muset ještě více optimalizovat, aby bylo možné zajistit efektivnější odezvy dat.</span><span class="sxs-lookup"><span data-stu-id="f992e-137">For mobile apps, you might need to optimize even further so that data responses can be more efficient.</span></span> <span data-ttu-id="f992e-138">Můžete to udělat tak, že agregujete data z více mikroslužeb a vrátíte jednu sadu dat a někdy eliminují veškerá data v odpovědi, která mobilní aplikace nevyžaduje.</span><span class="sxs-lookup"><span data-stu-id="f992e-138">You might do this by aggregating data from multiple microservices and returning a single set of data, and sometimes eliminating any data in the response that isn't needed by the mobile app.</span></span> <span data-ttu-id="f992e-139">Tato data samozřejmě můžete zkomprimovat.</span><span class="sxs-lookup"><span data-stu-id="f992e-139">And, of course, you might compress that data.</span></span> <span data-ttu-id="f992e-140">Pro tento scénář může být znovu vhodná fasáda nebo rozhraní API mezi mobilní aplikací a mikroslužbami.</span><span class="sxs-lookup"><span data-stu-id="f992e-140">Again, a facade or API in between the mobile app and the microservices can be convenient for this scenario.</span></span>

## <a name="why-consider-api-gateways-instead-of-direct-client-to-microservice-communication"></a><span data-ttu-id="f992e-141">Proč zvážit brány rozhraní API namísto přímé komunikace mezi klientem a mikroslužbou</span><span class="sxs-lookup"><span data-stu-id="f992e-141">Why consider API Gateways instead of direct client-to-microservice communication</span></span>

<span data-ttu-id="f992e-142">V architektuře mikroslužeb klientské aplikace obvykle potřebují využívat funkce z více než jedné mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="f992e-142">In a microservices architecture, the client apps usually need to consume functionality from more than one microservice.</span></span> <span data-ttu-id="f992e-143">Pokud je tato spotřeba prováděna přímo, klient potřebuje zpracovat více volání koncových bodů mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="f992e-143">If that consumption is performed directly, the client needs to handle multiple calls to microservice endpoints.</span></span> <span data-ttu-id="f992e-144">Co se stane, když se aplikace vyvíjí a zavádí se nové mikroslužby nebo se aktualizují stávající mikroslužby?</span><span class="sxs-lookup"><span data-stu-id="f992e-144">What happens when the application evolves and new microservices are introduced or existing microservices are updated?</span></span> <span data-ttu-id="f992e-145">Pokud má vaše aplikace velký počet mikroslužeb, což znamená, že mnoho koncových bodů z klientských aplikací může být Nightmare.</span><span class="sxs-lookup"><span data-stu-id="f992e-145">If your application has many microservices, handling so many endpoints from the client apps can be a nightmare.</span></span> <span data-ttu-id="f992e-146">Vzhledem k tomu, že klientská aplikace by byla propojená s těmito interními koncovými body, může být vývoj mikroslužeb v budoucnu ovlivněný vysokým dopadem na klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="f992e-146">Since the client app would be coupled to those internal endpoints, evolving the microservices in the future can cause high impact for the client apps.</span></span>

<span data-ttu-id="f992e-147">Proto je pro aplikace založené na mikroslužbách velmi výhodné mít úroveň dereference (brána).</span><span class="sxs-lookup"><span data-stu-id="f992e-147">Therefore, having an intermediate level or tier of indirection (Gateway) can be very convenient for microservice-based applications.</span></span> <span data-ttu-id="f992e-148">Pokud nemáte brány rozhraní API, klientské aplikace musí posílat požadavky přímo na mikroslužby a, které vyvolává problémy, například následující problémy:</span><span class="sxs-lookup"><span data-stu-id="f992e-148">If you don't have API Gateways, the client apps must send requests directly to the microservices and that raises problems, such as the following issues:</span></span>

- <span data-ttu-id="f992e-149">**Spoj**: bez vzoru brány API jsou klientské aplikace propojeny s interními mikroslužbami.</span><span class="sxs-lookup"><span data-stu-id="f992e-149">**Coupling**: Without the API Gateway pattern, the client apps are coupled to the internal microservices.</span></span> <span data-ttu-id="f992e-150">Klientské aplikace potřebují informace o tom, jak se více oblastí aplikace rozloží v mikroslužbách.</span><span class="sxs-lookup"><span data-stu-id="f992e-150">The client apps need to know how the multiple areas of the application are decomposed in microservices.</span></span> <span data-ttu-id="f992e-151">Při vývoji a refaktoringu vnitřních mikroslužeb tyto akce ovlivňují údržbu, protože způsobují zásadní změny klientských aplikací kvůli přímému odkazu na interní mikroslužby z klientských aplikací.</span><span class="sxs-lookup"><span data-stu-id="f992e-151">When evolving and refactoring the internal microservices, those actions impact maintenance because they cause breaking changes to the client apps due to the direct reference to the internal microservices from the client apps.</span></span> <span data-ttu-id="f992e-152">Klientské aplikace je třeba často aktualizovat, takže se řešení bude obtížnější vyvíjet.</span><span class="sxs-lookup"><span data-stu-id="f992e-152">Client apps need to be updated frequently, making the solution harder to evolve.</span></span>

- <span data-ttu-id="f992e-153">**Příliš mnoho zpátečních cest**: jedna stránka nebo obrazovka v klientské aplikaci může vyžadovat několik volání na více služeb.</span><span class="sxs-lookup"><span data-stu-id="f992e-153">**Too many round trips**: A single page/screen in the client app might require several calls to multiple services.</span></span> <span data-ttu-id="f992e-154">To může vést k tomu, že mezi klientem a serverem dojde k většímu počtu síťových přenosů a přidáním významné latence.</span><span class="sxs-lookup"><span data-stu-id="f992e-154">That can result in multiple network round trips between the client and the server, adding significant latency.</span></span> <span data-ttu-id="f992e-155">Agregace zpracovávaná na mezilehlé úrovni by mohla zlepšit výkon a uživatelské prostředí pro klientskou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="f992e-155">Aggregation handled in an intermediate level could improve the performance and user experience for the client app.</span></span>

- <span data-ttu-id="f992e-156">**Problémy se zabezpečením**: bez brány musí být všechny mikroslužby vystavené externímu světu, takže je velikost prostoru pro útoky větší, než když skryjete interní mikroslužby, které nejsou přímo používané klientskými aplikacemi.</span><span class="sxs-lookup"><span data-stu-id="f992e-156">**Security issues**: Without a gateway, all the microservices must be exposed to the "external world", making the attack surface larger than if you hide internal microservices that aren't directly used by the client apps.</span></span> <span data-ttu-id="f992e-157">Menší plocha pro útok je, tím bezpečnější může být aplikace.</span><span class="sxs-lookup"><span data-stu-id="f992e-157">The smaller the attack surface is, the more secure your application can be.</span></span>

- <span data-ttu-id="f992e-158">**Problémy mezi průřezy**: každá veřejně publikovaná mikroslužba musí mít obavy, jako je například autorizace a SSL.</span><span class="sxs-lookup"><span data-stu-id="f992e-158">**Cross-cutting concerns**: Each publicly published microservice must handle concerns such as authorization and SSL.</span></span> <span data-ttu-id="f992e-159">V mnoha situacích by tyto otázky mohly být zpracovány v rámci jedné úrovně, aby byly interní mikroslužby zjednodušeny.</span><span class="sxs-lookup"><span data-stu-id="f992e-159">In many situations, those concerns could be handled in a single tier so the internal microservices are simplified.</span></span>

## <a name="what-is-the-api-gateway-pattern"></a><span data-ttu-id="f992e-160">Co je to vzor brány rozhraní API?</span><span class="sxs-lookup"><span data-stu-id="f992e-160">What is the API Gateway pattern?</span></span>

<span data-ttu-id="f992e-161">Při návrhu a vytváření rozsáhlých nebo složitých aplikací založených na mikroslužbách s více klientskými aplikacemi může být vhodné zvážit [bránu rozhraní API](https://microservices.io/patterns/apigateway.html).</span><span class="sxs-lookup"><span data-stu-id="f992e-161">When you design and build large or complex microservice-based applications with multiple client apps, a good approach to consider can be an [API Gateway](https://microservices.io/patterns/apigateway.html).</span></span> <span data-ttu-id="f992e-162">Toto je služba, která poskytuje jeden vstupní bod pro určité skupiny mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="f992e-162">This is a service that provides a single-entry point for certain groups of microservices.</span></span> <span data-ttu-id="f992e-163">Je podobný [vzor průčelí](https://en.wikipedia.org/wiki/Facade_pattern) z objektově orientovaného návrhu, ale v tomto případě je součástí distribuovaného systému.</span><span class="sxs-lookup"><span data-stu-id="f992e-163">It's similar to the [Facade pattern](https://en.wikipedia.org/wiki/Facade_pattern) from object-oriented design, but in this case, it's part of a distributed system.</span></span> <span data-ttu-id="f992e-164">Vzor brány rozhraní API se také někdy označuje jako "back-end pro front-end" ([BFF](https://samnewman.io/patterns/architectural/bff/)), protože ho sestavíte a myslíme na potřebách klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="f992e-164">The API Gateway pattern is also sometimes known as the "backend for frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) because you build it while thinking about the needs of the client app.</span></span>

<span data-ttu-id="f992e-165">Proto brána API se nachází mezi klientskými aplikacemi a mikroslužbami.</span><span class="sxs-lookup"><span data-stu-id="f992e-165">Therefore, the API gateway sits between the client apps and the microservices.</span></span> <span data-ttu-id="f992e-166">Funguje jako reverzní proxy server, směrování požadavků od klientů na služby.</span><span class="sxs-lookup"><span data-stu-id="f992e-166">It acts as a reverse proxy, routing requests from clients to services.</span></span> <span data-ttu-id="f992e-167">Může také poskytovat další funkce pro různé průřezy, jako je ověřování, ukončení protokolu SSL a mezipaměť.</span><span class="sxs-lookup"><span data-stu-id="f992e-167">It can also provide additional cross-cutting features such as authentication, SSL termination, and cache.</span></span>

<span data-ttu-id="f992e-168">Obrázek 4-13 ukazuje, jak se dá vlastní brána API vejít do zjednodušené architektury založené na mikroslužbách jenom s několika mikroslužbami.</span><span class="sxs-lookup"><span data-stu-id="f992e-168">Figure 4-13 shows how a custom API Gateway can fit into a simplified microservice-based architecture with just a few microservices.</span></span>

![Diagram znázorňující bránu rozhraní API, která je implementovaná jako vlastní služba.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/custom-service-api-gateway.png)

<span data-ttu-id="f992e-170">**Obrázek 4-13**.</span><span class="sxs-lookup"><span data-stu-id="f992e-170">**Figure 4-13**.</span></span> <span data-ttu-id="f992e-171">Použití brány API, která je implementovaná jako vlastní služba</span><span class="sxs-lookup"><span data-stu-id="f992e-171">Using an API Gateway implemented as a custom service</span></span>

<span data-ttu-id="f992e-172">Aplikace se připojují k jednomu koncovému bodu, bráně API, která je nakonfigurovaná tak, aby přesměrovala požadavky na jednotlivé mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="f992e-172">Apps connect to a single endpoint, the API Gateway, that's configured to forward requests to individual microservices.</span></span> <span data-ttu-id="f992e-173">V tomto příkladu by se brána API implementovala jako vlastní ASP.NET Core služba webhosta spuštěná jako kontejner.</span><span class="sxs-lookup"><span data-stu-id="f992e-173">In this example, the API Gateway would be implemented as a custom ASP.NET Core WebHost service running as a container.</span></span>

<span data-ttu-id="f992e-174">Je důležité zdůraznit, že v tomto diagramu byste použili jednu vlastní službu API Gateway, která se týká více a různých klientských aplikací.</span><span class="sxs-lookup"><span data-stu-id="f992e-174">It's important to highlight that in that diagram, you would be using a single custom API Gateway service facing multiple and different client apps.</span></span> <span data-ttu-id="f992e-175">Tato skutečnost může představovat důležité riziko, protože vaše služba API Gateway se bude zvětšovat a rozvíjet na základě mnoha různých požadavků z klientských aplikací.</span><span class="sxs-lookup"><span data-stu-id="f992e-175">That fact can be an important risk because your API Gateway service will be growing and evolving based on many different requirements from the client apps.</span></span> <span data-ttu-id="f992e-176">Nakonec bude bloated z důvodu těchto různých potřeb a efektivně by mohla být podobná aplikaci monolitické nebo službě monolitické.</span><span class="sxs-lookup"><span data-stu-id="f992e-176">Eventually, it will be bloated because of those different needs and effectively it could be similar to a monolithic application or monolithic service.</span></span> <span data-ttu-id="f992e-177">To je důvod, proč je velmi vhodné rozdělit bránu API ve více službách nebo více menších bran rozhraní API, jeden pro každý klient aplikace typ formuláře-faktor.</span><span class="sxs-lookup"><span data-stu-id="f992e-177">That's why it's very much recommended to split the API Gateway in multiple services or multiple smaller API Gateways, one per client app form-factor type, for instance.</span></span>

<span data-ttu-id="f992e-178">Při implementaci vzoru brány rozhraní API musíte být opatrní.</span><span class="sxs-lookup"><span data-stu-id="f992e-178">You need to be careful when implementing the API Gateway pattern.</span></span> <span data-ttu-id="f992e-179">Obvykle není vhodné mít jedinou bránu rozhraní API, která agreguje všechny interní mikroslužby vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="f992e-179">Usually it isn't a good idea to have a single API Gateway aggregating all the internal microservices of your application.</span></span> <span data-ttu-id="f992e-180">V takovém případě funguje jako agregátor monolitické nebo Orchestrator a je porušená autonomii mikroslužeb tím, že se připojí ke všem mikroslužbám.</span><span class="sxs-lookup"><span data-stu-id="f992e-180">If it does, it acts as a monolithic aggregator or orchestrator and violates microservice autonomy by coupling all the microservices.</span></span>

<span data-ttu-id="f992e-181">Proto by se brány rozhraní API měly oddělit na základě hranic firmy a klientských aplikací a nemusí fungovat jako jeden agregátor pro všechny interní mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="f992e-181">Therefore, the API Gateways should be segregated based on business boundaries and the client apps and not act as a single aggregator for all the internal microservices.</span></span>

<span data-ttu-id="f992e-182">Při rozdělení vrstvy brány API na několik bran rozhraní API platí, že pokud má vaše aplikace více klientských aplikací, může být primárním objektem Pivot při identifikaci několika typů bran rozhraní API, takže můžete mít různou fasádu pro potřeby jednotlivých klientských aplikací.</span><span class="sxs-lookup"><span data-stu-id="f992e-182">When splitting the API Gateway tier into multiple API Gateways, if your application has multiple client apps, that can be a primary pivot when identifying the multiple API Gateways types, so that you can have a different facade for the needs of each client app.</span></span> <span data-ttu-id="f992e-183">V tomto případě se jedná o vzor s názvem "back-end pro front-end" ([BFF](https://samnewman.io/patterns/architectural/bff/)), kde každá brána API může poskytovat jiné rozhraní API přizpůsobené pro každý typ klientské aplikace, a to i na základě faktoru formuláře klienta implementací konkrétního kódu adaptéru, který je pod voláním více interních mikroslužeb, jak je znázorněno na následujícím obrázku:</span><span class="sxs-lookup"><span data-stu-id="f992e-183">This case is a pattern named "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) where each API Gateway can provide a different API tailored for each client app type, possibly even based on the client form factor by implementing specific adapter code which underneath calls multiple internal microservices, as shown in the following image:</span></span>

![Diagram znázorňující několik vlastních bran rozhraní API.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/multiple-custom-api-gateways.png)

<span data-ttu-id="f992e-185">**Obrázek 4 – 13.1**.</span><span class="sxs-lookup"><span data-stu-id="f992e-185">**Figure 4-13.1**.</span></span> <span data-ttu-id="f992e-186">Používání několika vlastních bran API</span><span class="sxs-lookup"><span data-stu-id="f992e-186">Using multiple custom API Gateways</span></span>

<span data-ttu-id="f992e-187">Obrázek 4 – 13.1 zobrazuje brány rozhraní API, které jsou oddělené typem klienta; jeden pro mobilní klienty a jeden pro webové klienty.</span><span class="sxs-lookup"><span data-stu-id="f992e-187">Figure 4-13.1 shows API Gateways that are segregated by client type; one for mobile clients and one for web clients.</span></span> <span data-ttu-id="f992e-188">Tradiční webová aplikace se připojuje ke mikroslužbám MVC, která používá webovou bránu API.</span><span class="sxs-lookup"><span data-stu-id="f992e-188">A traditional web app connects to an MVC microservice that uses the web API Gateway.</span></span> <span data-ttu-id="f992e-189">Tento příklad znázorňuje zjednodušenou architekturu s několika jemně odstupňovanými branami API.</span><span class="sxs-lookup"><span data-stu-id="f992e-189">The example depicts a simplified architecture with multiple fine-grained API Gateways.</span></span> <span data-ttu-id="f992e-190">V takovém případě jsou hranice identifikované pro jednotlivé brány rozhraní API založené čistě na vzoru back-end pro front-end ([BFF](https://samnewman.io/patterns/architectural/bff/)), a proto jsou založené jenom na rozhraní API potřebném pro každou klientskou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="f992e-190">In this case, the boundaries identified for each API Gateway are based purely on the "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) pattern, hence based just on the API needed per client app.</span></span> <span data-ttu-id="f992e-191">Ale v větších aplikacích byste také měli dál pokračovat a vytvořit další brány API na základě hranic firmy jako druhého kontingenčního pivotu.</span><span class="sxs-lookup"><span data-stu-id="f992e-191">But in larger applications you should also go further and create additional API Gateways based on business boundaries as a second design pivot.</span></span>

## <a name="main-features-in-the-api-gateway-pattern"></a><span data-ttu-id="f992e-192">Hlavní funkce ve vzoru brány rozhraní API</span><span class="sxs-lookup"><span data-stu-id="f992e-192">Main features in the API Gateway pattern</span></span>

<span data-ttu-id="f992e-193">Brána rozhraní API může nabízet víc funkcí.</span><span class="sxs-lookup"><span data-stu-id="f992e-193">An API Gateway can offer multiple features.</span></span> <span data-ttu-id="f992e-194">V závislosti na tom, jaký produkt může nabízet bohatší nebo jednodušší funkce, jsou ale nejdůležitější a základní funkce pro libovolnou bránu rozhraní API tyto vzory návrhu:</span><span class="sxs-lookup"><span data-stu-id="f992e-194">Depending on the product it might offer richer or simpler features, however, the most important and foundational features for any API Gateway are the following design patterns:</span></span>

<span data-ttu-id="f992e-195">**Směrování reverzního proxy serveru nebo brány.**</span><span class="sxs-lookup"><span data-stu-id="f992e-195">**Reverse proxy or gateway routing.**</span></span> <span data-ttu-id="f992e-196">Rozhraní API Gateway nabízí reverzní proxy server pro přesměrování nebo směrování požadavků (směrování vrstvy 7, obvykle požadavky HTTP) do koncových bodů interních mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="f992e-196">The API Gateway offers a reverse proxy to redirect or route requests (layer 7 routing, usually HTTP requests) to the endpoints of the internal microservices.</span></span> <span data-ttu-id="f992e-197">Brána poskytuje jeden koncový bod nebo adresu URL pro klientské aplikace a pak interně mapuje požadavky na skupinu interních mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="f992e-197">The gateway provides a single endpoint or URL for the client apps and then internally maps the requests to a group of internal microservices.</span></span> <span data-ttu-id="f992e-198">Tato funkce směrování pomáhá oddělit klientské aplikace od mikroslužeb, ale je to také užitečné, když modernizaci rozhraní API monolitické prostřednictvím brány API v mezi rozhraními monolitické API a klientskými aplikacemi. potom můžete přidat nová rozhraní API jako nové mikroslužby, dokud nebude v budoucnu rozdělená na mnoho mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="f992e-198">This routing feature helps to decouple the client apps from the microservices but it's also convenient when modernizing a monolithic API by sitting the API Gateway in between the monolithic API and the client apps, then you can add new APIs as new microservices while still using the legacy monolithic API until it's split into many microservices in the future.</span></span> <span data-ttu-id="f992e-199">Z důvodu brány rozhraní API nebudou klientské aplikace obsahovat informace o tom, jestli se použitá rozhraní API implementují jako interní mikroslužby nebo rozhraní monolitické API. při vývoji a refaktoringu rozhraní monolitické API na mikroslužby se díky směrování brány API nebudou ovlivněny žádné změny identifikátoru URI.</span><span class="sxs-lookup"><span data-stu-id="f992e-199">Because of the API Gateway, the client apps won't notice if the APIs being used are implemented as internal microservices or a monolithic API and more importantly, when evolving and refactoring the monolithic API into microservices, thanks to the API Gateway routing, client apps won't be impacted with any URI change.</span></span>

<span data-ttu-id="f992e-200">Další informace najdete v tématu [vzor směrování brány](https://docs.microsoft.com/azure/architecture/patterns/gateway-routing).</span><span class="sxs-lookup"><span data-stu-id="f992e-200">For more information, see [Gateway routing pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-routing).</span></span>

<span data-ttu-id="f992e-201">**Agregace požadavků.**</span><span class="sxs-lookup"><span data-stu-id="f992e-201">**Requests aggregation.**</span></span> <span data-ttu-id="f992e-202">V rámci vzoru brány můžete agregovat více požadavků klientů (obvykle požadavků HTTP), které cílí na více interních mikroslužeb do jediné žádosti klienta.</span><span class="sxs-lookup"><span data-stu-id="f992e-202">As part of the gateway pattern you can aggregate multiple client requests (usually HTTP requests) targeting multiple internal microservices into a single client request.</span></span> <span data-ttu-id="f992e-203">Tento model je vhodný hlavně v případě, že stránka klienta/obrazovka potřebuje informace z několika mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="f992e-203">This pattern is especially convenient when a client page/screen needs information from several microservices.</span></span> <span data-ttu-id="f992e-204">S tímto přístupem klientská aplikace pošle jednu žádost do brány rozhraní API, která odesílá několik požadavků do interních mikroslužeb a pak agreguje výsledky a pošle všechno zpátky do klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="f992e-204">With this approach, the client app sends a single request to the API Gateway that dispatches several requests to the internal microservices and then aggregates the results and sends everything back to the client app.</span></span> <span data-ttu-id="f992e-205">Hlavním přínosem a cílem tohoto vzoru návrhu je snížit upovídanost mezi klientskými aplikacemi a rozhraním API back-end, což je zvláště důležité pro vzdálené aplikace z datového centra, ve kterém se mikroslužby nacházejí v provozu, jako jsou mobilní aplikace nebo požadavky z JavaScriptu v klientských vzdálených prohlížečích.</span><span class="sxs-lookup"><span data-stu-id="f992e-205">The main benefit and goal of this design pattern is to reduce chattiness between the client apps and the backend API, which is especially important for remote apps out of the datacenter where the microservices live, like mobile apps or requests coming from SPA apps that come from JavaScript in client remote browsers.</span></span> <span data-ttu-id="f992e-206">U běžných webových aplikací, které provádějí požadavky v prostředí serveru (jako je webová aplikace ASP.NET Core MVC), není tento model tak důležitý, protože latence je mnohem menší než u vzdálených klientských aplikací.</span><span class="sxs-lookup"><span data-stu-id="f992e-206">For regular web apps performing the requests in the server environment (like an ASP.NET Core MVC web app), this pattern is not so important as the latency is very much smaller than for remote client apps.</span></span>

<span data-ttu-id="f992e-207">V závislosti na použitém produktu brány API může být tato agregace schopná provádět tuto agregaci.</span><span class="sxs-lookup"><span data-stu-id="f992e-207">Depending on the API Gateway product you use, it might be able to perform this aggregation.</span></span> <span data-ttu-id="f992e-208">V mnoha případech je však pružnější vytvořit agregované mikroslužby v rámci oboru brány rozhraní API, takže definujete agregaci v kódu (tj. C# kód):</span><span class="sxs-lookup"><span data-stu-id="f992e-208">However, in many cases it's more flexible to create aggregation microservices under the scope of the API Gateway, so you define the aggregation in code (that is, C# code):</span></span>

<span data-ttu-id="f992e-209">Další informace najdete v tématu [model agregace brány](https://docs.microsoft.com/azure/architecture/patterns/gateway-aggregation).</span><span class="sxs-lookup"><span data-stu-id="f992e-209">For more information, see [Gateway aggregation pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-aggregation).</span></span>

<span data-ttu-id="f992e-210">**Problémy pro průřezy nebo snižování zátěže brány.**</span><span class="sxs-lookup"><span data-stu-id="f992e-210">**Cross-cutting concerns or gateway offloading.**</span></span> <span data-ttu-id="f992e-211">V závislosti na funkcích, které nabízí jednotlivé produkty brány rozhraní API, můžete přesměrovat funkce z jednotlivých mikroslužeb na bránu, což zjednodušuje implementaci každé mikroslužby sloučením různých oblastí průřezů do jedné úrovně.</span><span class="sxs-lookup"><span data-stu-id="f992e-211">Depending on the features offered by each API Gateway product, you can offload functionality from individual microservices to the gateway, which simplifies the implementation of each microservice by consolidating cross-cutting concerns into one tier.</span></span> <span data-ttu-id="f992e-212">To je zvlášť užitečné pro specializované funkce, které je možné složitě použít v každé interní mikroslužbě, jako jsou například následující funkce:</span><span class="sxs-lookup"><span data-stu-id="f992e-212">This is especially convenient for specialized features that can be complex to implement properly in every internal microservice, such as the following functionality:</span></span>

- <span data-ttu-id="f992e-213">Ověřování a autorizace</span><span class="sxs-lookup"><span data-stu-id="f992e-213">Authentication and authorization</span></span>
- <span data-ttu-id="f992e-214">Integrace zjišťování služeb</span><span class="sxs-lookup"><span data-stu-id="f992e-214">Service discovery integration</span></span>
- <span data-ttu-id="f992e-215">Ukládání odpovědí do mezipaměti</span><span class="sxs-lookup"><span data-stu-id="f992e-215">Response caching</span></span>
- <span data-ttu-id="f992e-216">Zásady opakování, přepínací modul okruhů a QoS</span><span class="sxs-lookup"><span data-stu-id="f992e-216">Retry policies, circuit breaker, and QoS</span></span>
- <span data-ttu-id="f992e-217">Omezení rychlosti a omezení</span><span class="sxs-lookup"><span data-stu-id="f992e-217">Rate limiting and throttling</span></span>
- <span data-ttu-id="f992e-218">Vyrovnávání zatížení</span><span class="sxs-lookup"><span data-stu-id="f992e-218">Load balancing</span></span>
- <span data-ttu-id="f992e-219">Protokolování, trasování, korelace</span><span class="sxs-lookup"><span data-stu-id="f992e-219">Logging, tracing, correlation</span></span>
- <span data-ttu-id="f992e-220">Hlavičky, řetězce dotazů a transformace deklarací identity</span><span class="sxs-lookup"><span data-stu-id="f992e-220">Headers, query strings, and claims transformation</span></span>
- <span data-ttu-id="f992e-221">Seznam povolených IP adres</span><span class="sxs-lookup"><span data-stu-id="f992e-221">IP whitelisting</span></span>

<span data-ttu-id="f992e-222">Další informace najdete v tématu [model snižování zátěže brány](https://docs.microsoft.com/azure/architecture/patterns/gateway-offloading).</span><span class="sxs-lookup"><span data-stu-id="f992e-222">For more information, see [Gateway offloading pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-offloading).</span></span>

## <a name="using-products-with-api-gateway-features"></a><span data-ttu-id="f992e-223">Používání produktů s funkcemi API Gateway</span><span class="sxs-lookup"><span data-stu-id="f992e-223">Using products with API Gateway features</span></span>

<span data-ttu-id="f992e-224">V závislosti na každé implementaci může být k dispozici mnoho dalších častých otázek pro průřezy nabízených produkty API Gateway.</span><span class="sxs-lookup"><span data-stu-id="f992e-224">There can be many more cross-cutting concerns offered by the API Gateways products depending on each implementation.</span></span> <span data-ttu-id="f992e-225">Prozkoumáme toto:</span><span class="sxs-lookup"><span data-stu-id="f992e-225">We'll explore here:</span></span>

- [<span data-ttu-id="f992e-226">Azure API Management</span><span class="sxs-lookup"><span data-stu-id="f992e-226">Azure API Management</span></span>](https://azure.microsoft.com/services/api-management/)
- [<span data-ttu-id="f992e-227">Ocelot</span><span class="sxs-lookup"><span data-stu-id="f992e-227">Ocelot</span></span>](https://github.com/ThreeMammals/Ocelot)

### <a name="azure-api-management"></a><span data-ttu-id="f992e-228">Azure API Management</span><span class="sxs-lookup"><span data-stu-id="f992e-228">Azure API Management</span></span>

<span data-ttu-id="f992e-229">[Azure API Management](https://azure.microsoft.com/services/api-management/) (jak je znázorněno na obrázku 4-14) nejenom vyřeší vaše požadavky na bránu API, ale poskytuje funkce, jako je shromažďování přehledů z vašich rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="f992e-229">[Azure API Management](https://azure.microsoft.com/services/api-management/) (as shown in Figure 4-14) not only solves your API Gateway needs but provides features like gathering insights from your APIs.</span></span> <span data-ttu-id="f992e-230">Pokud používáte řešení API Management, brána rozhraní API je jenom součást v rámci celého řešení API Management.</span><span class="sxs-lookup"><span data-stu-id="f992e-230">If you're using an API management solution, an API Gateway is only a component within that full API management solution.</span></span>

![Diagram znázorňující, jak používat Azure API Management jako bránu rozhraní API.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/api-gateway-azure-api-management.png)

<span data-ttu-id="f992e-232">**Obrázek 4-14**.</span><span class="sxs-lookup"><span data-stu-id="f992e-232">**Figure 4-14**.</span></span> <span data-ttu-id="f992e-233">Použití Azure API Management pro vaši bránu API</span><span class="sxs-lookup"><span data-stu-id="f992e-233">Using Azure API Management for your API Gateway</span></span>

<span data-ttu-id="f992e-234">Azure API Management řeší jak vaše brána rozhraní API, tak i jejich požadavky na správu, jako je protokolování, zabezpečení, měření atd. V takovém případě, když používáte produkt, jako je Azure API Management, skutečnost, že máte jedinou bránu API, není tak riskantní, protože tyto druhy bran rozhraní API jsou "tenčí", což znamená, že neimplementujete vlastní kód C#, který by se mohl vyvíjet ke komponentě monolitické.</span><span class="sxs-lookup"><span data-stu-id="f992e-234">Azure API Management solves both your API Gateway and Management needs like logging, security, metering, etc. In this case, when using a product like Azure API Management, the fact that you might have a single API Gateway is not so risky because these kinds of API Gateways are "thinner", meaning that you don't implement custom C# code that could evolve towards a monolithic component.</span></span>

<span data-ttu-id="f992e-235">Produkty brány rozhraní API obvykle fungují jako reverzní proxy server pro komunikaci příchozího přenosu dat, kde můžete také vyfiltrovat rozhraní API z interních mikroslužeb a použít autorizaci na publikovaná rozhraní API v této jedné vrstvě.</span><span class="sxs-lookup"><span data-stu-id="f992e-235">The API Gateway products usually act like a reverse proxy for ingress communication, where you can also filter the APIs from the internal microservices plus apply authorization to the published APIs in this single tier.</span></span>

<span data-ttu-id="f992e-236">Přehledy dostupné z API Management systému vám pomůžou pochopit, jak se vaše rozhraní API používají a jak se provádějí.</span><span class="sxs-lookup"><span data-stu-id="f992e-236">The insights available from an API Management system help you get an understanding of how your APIs are being used and how they are performing.</span></span> <span data-ttu-id="f992e-237">Díky tomu můžete zobrazit sestavy analýzy téměř v reálném čase a identifikovat trendy, které by mohly mít dopad na vaši firmu.</span><span class="sxs-lookup"><span data-stu-id="f992e-237">They do this by letting you view near real-time analytics reports and identifying trends that might impact your business.</span></span> <span data-ttu-id="f992e-238">Navíc můžete mít protokoly o aktivitě požadavků a odpovědí pro další online a offline analýzu.</span><span class="sxs-lookup"><span data-stu-id="f992e-238">Plus, you can have logs about request and response activity for further online and offline analysis.</span></span>

<span data-ttu-id="f992e-239">Pomocí Azure API Management můžete zabezpečit vaše rozhraní API pomocí klíče, tokenu a filtrování IP adres.</span><span class="sxs-lookup"><span data-stu-id="f992e-239">With Azure API Management, you can secure your APIs using a key, a token, and IP filtering.</span></span> <span data-ttu-id="f992e-240">Tyto funkce umožňují vyhovět flexibilním a jemně odstupňovaným kvótám a omezením četnosti, měnit tvar a chování rozhraní API pomocí zásad a zlepšovat výkon pomocí ukládání odpovědí do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="f992e-240">These features let you enforce flexible and fine-grained quotas and rate limits, modify the shape and behavior of your APIs using policies, and improve performance with response caching.</span></span>

<span data-ttu-id="f992e-241">V této příručce a v referenční aplikaci eShopOnContainers (Reference Sample Application) je architektura omezená na jednodušší a vlastní integrovanou architekturu, aby se daly soustředit na jednoduché kontejnery bez použití PaaSch produktů, jako je Azure API Management.</span><span class="sxs-lookup"><span data-stu-id="f992e-241">In this guide and the reference sample application (eShopOnContainers), the architecture is limited to a simpler and custom-made containerized architecture in order to focus on plain containers without using PaaS products like Azure API Management.</span></span> <span data-ttu-id="f992e-242">Pro velké aplikace založené na mikroslužbách, které jsou nasazené v Microsoft Azure, doporučujeme, abyste Azure API Management vyhodnotili jako základ pro vaše brány rozhraní API v produkčním prostředí.</span><span class="sxs-lookup"><span data-stu-id="f992e-242">But for large microservice-based applications that are deployed into Microsoft Azure, we encourage you to evaluate Azure API Management as the base for your API Gateways in production.</span></span>

### <a name="ocelot"></a><span data-ttu-id="f992e-243">Ocelot</span><span class="sxs-lookup"><span data-stu-id="f992e-243">Ocelot</span></span>

<span data-ttu-id="f992e-244">[Ocelot](https://github.com/ThreeMammals/Ocelot) je zjednodušená brána API, která se doporučuje pro jednodušší přístupy.</span><span class="sxs-lookup"><span data-stu-id="f992e-244">[Ocelot](https://github.com/ThreeMammals/Ocelot) is a lightweight API Gateway, recommended for simpler approaches.</span></span> <span data-ttu-id="f992e-245">Ocelot je open source brána API založená na rozhraní .NET Core, která se hodí hlavně pro architektury mikroslužeb, které potřebují v jejich systémech sjednocení vstupních bodů.</span><span class="sxs-lookup"><span data-stu-id="f992e-245">Ocelot is an Open Source .NET Core-based API Gateway especially made for microservices architectures that need unified points of entry into their systems.</span></span> <span data-ttu-id="f992e-246">Je odlehčená, rychlá a škálovatelná a poskytuje směrování a ověřování mezi mnoha dalšími funkcemi.</span><span class="sxs-lookup"><span data-stu-id="f992e-246">It's lightweight, fast, and scalable and provides routing and authentication among many other features.</span></span>

<span data-ttu-id="f992e-247">Hlavním důvodem pro výběr Ocelot pro [referenční aplikaci eShopOnContainers](https://github.com/dotnet-architecture/eShopOnContainers) je, že Ocelot je odlehčená brána rozhraní API .NET Core, kterou můžete nasadit do stejného prostředí nasazení aplikace, kde nasazujete mikroslužby nebo kontejnery, jako je například hostitel Docker, Kubernetes atd. A vzhledem k tomu, že je založená na .NET Core, je to pro různé platformy, které vám umožní nasadit na Linux nebo Windows.</span><span class="sxs-lookup"><span data-stu-id="f992e-247">The main reason to choose Ocelot for the [eShopOnContainers reference application](https://github.com/dotnet-architecture/eShopOnContainers) is because Ocelot is a .NET Core lightweight API Gateway that you can deploy into the same application deployment environment where you're deploying your microservices/containers, such as a Docker Host, Kubernetes, etc. And since it's based on .NET Core, it's cross-platform allowing you to deploy on Linux or Windows.</span></span>

<span data-ttu-id="f992e-248">Předchozí diagramy, které zobrazují vlastní brány API spuštěné v kontejnerech, jsou přesně takové, jak můžete také spustit Ocelot v kontejneru a v aplikaci založené na mikroslužbách.</span><span class="sxs-lookup"><span data-stu-id="f992e-248">The previous diagrams showing custom API Gateways running in containers are precisely how you can also run Ocelot in a container and microservice-based application.</span></span>

<span data-ttu-id="f992e-249">Kromě toho je na trhu mnoho dalších produktů, které nabízejí funkce bran rozhraní API, jako jsou Apigee, Hongkong, MuleSoft, WSO2 a další produkty, jako jsou linkery a Istio pro funkce herního adaptéru pro síť.</span><span class="sxs-lookup"><span data-stu-id="f992e-249">In addition, there are many other products in the market offering API Gateways features, such as Apigee, Kong, MuleSoft, WSO2, and other products like Linkerd and Istio for service mesh ingress controller features.</span></span>

<span data-ttu-id="f992e-250">V dalších oddílech se po úvodní části architektury a vzorů vysvětlují, jak implementovat brány API pomocí [ocelot](https://github.com/ThreeMammals/Ocelot).</span><span class="sxs-lookup"><span data-stu-id="f992e-250">After the initial architecture and patterns explanation sections, the next sections explain how to implement API Gateways with [Ocelot](https://github.com/ThreeMammals/Ocelot).</span></span>

## <a name="drawbacks-of-the-api-gateway-pattern"></a><span data-ttu-id="f992e-251">Nevýhody vzoru brány rozhraní API</span><span class="sxs-lookup"><span data-stu-id="f992e-251">Drawbacks of the API Gateway pattern</span></span>

- <span data-ttu-id="f992e-252">Nejdůležitější nevýhodou je, že když implementujete bránu API, budete tuto vrstvu přidružit k vnitřním mikroslužbám.</span><span class="sxs-lookup"><span data-stu-id="f992e-252">The most important drawback is that when you implement an API Gateway, you're coupling that tier with the internal microservices.</span></span> <span data-ttu-id="f992e-253">Propojení podobně může způsobit vážné problémy pro vaši aplikaci.</span><span class="sxs-lookup"><span data-stu-id="f992e-253">Coupling like this might introduce serious difficulties for your application.</span></span> <span data-ttu-id="f992e-254">Clemense obrovského, architekt ve Azure Service Bus týmu, odkazuje na toto potenciální potíže jako "nové ESB" v relaci "[zasílání zpráv a mikroslužeb](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" v tématu goto 2016.</span><span class="sxs-lookup"><span data-stu-id="f992e-254">Clemens Vaster, architect at the Azure Service Bus team, refers to this potential difficulty as "the new ESB" in the "[Messaging and Microservices](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" session at GOTO 2016.</span></span>

- <span data-ttu-id="f992e-255">Použití brány rozhraní API mikroslužeb vytvoří další možný jediný bod selhání.</span><span class="sxs-lookup"><span data-stu-id="f992e-255">Using a microservices API Gateway creates an additional possible single point of failure.</span></span>

- <span data-ttu-id="f992e-256">Brána rozhraní API může způsobit zvýšení doby odezvy z důvodu dalšího síťového volání.</span><span class="sxs-lookup"><span data-stu-id="f992e-256">An API Gateway can introduce increased response time due to the additional network call.</span></span> <span data-ttu-id="f992e-257">Nicméně toto nadbytečné volání má méně dopad než klientské rozhraní, které je příliš nepřímým voláním vnitřních mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="f992e-257">However, this extra call usually has less impact than having a client interface that's too chatty directly calling the internal microservices.</span></span>

- <span data-ttu-id="f992e-258">Pokud není horizontální horizontální navýšení kapacity, může se brána API stát kritickým bodem.</span><span class="sxs-lookup"><span data-stu-id="f992e-258">If not scaled out properly, the API Gateway can become a bottleneck.</span></span>

- <span data-ttu-id="f992e-259">Brána API vyžaduje další náklady na vývoj a budoucí údržbu, pokud obsahuje vlastní logiku a datovou agregaci.</span><span class="sxs-lookup"><span data-stu-id="f992e-259">An API Gateway requires additional development cost and future maintenance if it includes custom logic and data aggregation.</span></span> <span data-ttu-id="f992e-260">Vývojáři musí aktualizovat bránu rozhraní API, aby vystavily koncové body mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="f992e-260">Developers must update the API Gateway in order to expose each microservice's endpoints.</span></span> <span data-ttu-id="f992e-261">Změny v implementaci v interních mikroslužbách navíc můžou způsobit změny kódu na úrovni brány rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="f992e-261">Moreover, implementation changes in the internal microservices might cause code changes at the API Gateway level.</span></span> <span data-ttu-id="f992e-262">Pokud se ale brána API jenom aplikuje na zabezpečení, protokolování a správu verzí (jako při použití Azure API Management), nemusí se tyto dodatečné náklady na vývoj vztahovat.</span><span class="sxs-lookup"><span data-stu-id="f992e-262">However, if the API Gateway is just applying security, logging, and versioning (as when using Azure API Management), this additional development cost might not apply.</span></span>

- <span data-ttu-id="f992e-263">Pokud je brána API vyvinutá jedním týmem, může dojít k nekritickému vývoji.</span><span class="sxs-lookup"><span data-stu-id="f992e-263">If the API Gateway is developed by a single team, there can be a development bottleneck.</span></span> <span data-ttu-id="f992e-264">To je další důvod, proč lepší přístup je mít několik jemně odstupňovaných bran rozhraní API, které reagují na různé požadavky klientů.</span><span class="sxs-lookup"><span data-stu-id="f992e-264">This is another reason why a better approach is to have several fined-grained API Gateways that respond to different client needs.</span></span> <span data-ttu-id="f992e-265">Bránu rozhraní API můžete také interně rozdělit do několika oblastí nebo vrstev vlastněných různými týmy, které pracují na vnitřních mikroslužbách.</span><span class="sxs-lookup"><span data-stu-id="f992e-265">You could also segregate the API Gateway internally into multiple areas or layers that are owned by the different teams working on the internal microservices.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="f992e-266">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="f992e-266">Additional resources</span></span>

- <span data-ttu-id="f992e-267">**Chris Richardson. Vzor: Brána API/back-end pro front-end** </span><span class="sxs-lookup"><span data-stu-id="f992e-267">**Chris Richardson. Pattern: API Gateway / Backend for Front-End** </span></span>\
  <https://microservices.io/patterns/apigateway.html>

- <span data-ttu-id="f992e-268">**Vzor brány API** </span><span class="sxs-lookup"><span data-stu-id="f992e-268">**API Gateway pattern** </span></span>\
  <https://docs.microsoft.com/azure/architecture/microservices/gateway>

- <span data-ttu-id="f992e-269">**Model agregace a kompozice** </span><span class="sxs-lookup"><span data-stu-id="f992e-269">**Aggregation and composition pattern** </span></span>\
  <https://microservices.io/patterns/data/api-composition.html>

- <span data-ttu-id="f992e-270">**API Management Azure** </span><span class="sxs-lookup"><span data-stu-id="f992e-270">**Azure API Management** </span></span>\
  <https://azure.microsoft.com/services/api-management/>

- <span data-ttu-id="f992e-271">**UDI Dahan. Složení orientované na služby** </span><span class="sxs-lookup"><span data-stu-id="f992e-271">**Udi Dahan. Service Oriented Composition** </span></span>\
  <https://udidahan.com/2014/07/30/service-oriented-composition-with-video/>

- <span data-ttu-id="f992e-272">**Clemense obrovské. Zasílání zpráv a mikroslužeb na adrese GOTO 2016 (video)** </span><span class="sxs-lookup"><span data-stu-id="f992e-272">**Clemens Vasters. Messaging and Microservices at GOTO 2016 (video)** </span></span>\
  <https://www.youtube.com/watch?v=rXi5CLjIQ9k>

- <span data-ttu-id="f992e-273">**Brána API v kostce** (řada kurzů ASP.NET Core API Gateway) </span><span class="sxs-lookup"><span data-stu-id="f992e-273">**API Gateway in a Nutshell** (ASP.NET Core API Gateway Tutorial Series) </span></span>\
  <https://www.pogsdotnet.com/2018/08/api-gateway-in-nutshell.html>

>[!div class="step-by-step"]
><span data-ttu-id="f992e-274">[Předchozí](identify-microservice-domain-model-boundaries.md) 
> [Další](communication-in-microservice-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="f992e-274">[Previous](identify-microservice-domain-model-boundaries.md)
[Next](communication-in-microservice-architecture.md)</span></span>
