---
title: Přehled tisku
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print path [WPF], XPS
- printers [WPF], XPSDrv-based
- printing [WPF]
- PrintQueue class PrintServer class [WPF]
- XML Paper Specification (XPS) file format
- XPS (XML Paper Specification) file format
- XPSDrv-based printers
- GDI print path [WPF]
ms.assetid: 0de8ac41-9aa6-413d-a121-7aa6f41539b1
ms.openlocfilehash: 902d51341850b5245b9fa6410b1954b2ab373bbc
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/12/2020
ms.locfileid: "79187204"
---
# <a name="printing-overview"></a><span data-ttu-id="04620-102">Přehled tisku</span><span class="sxs-lookup"><span data-stu-id="04620-102">Printing Overview</span></span>
<span data-ttu-id="04620-103">S rozhraním Microsoft .NET Framework mají vývojáři aplikací používající windows presentation foundation (WPF) bohatou novou sadu rozhraní API pro správu tisku a tiskových systémů.</span><span class="sxs-lookup"><span data-stu-id="04620-103">With Microsoft .NET Framework, application developers using Windows Presentation Foundation (WPF) have a rich new set of printing and print system management APIs.</span></span> <span data-ttu-id="04620-104">V systému Windows Vista jsou některá z těchto vylepšení tiskového systému k dispozici také vývojářům, kteří vytvářejí aplikace pro Windows Forms, a vývojářům používajícím nespravovaný kód.</span><span class="sxs-lookup"><span data-stu-id="04620-104">With Windows Vista, some of these print system enhancements are also available to developers creating Windows Forms applications and developers using unmanaged code.</span></span> <span data-ttu-id="04620-105">Jádrem této nové funkce je nový formát souboru XML Paper Specification (XPS) a cesta k tisku XPS.</span><span class="sxs-lookup"><span data-stu-id="04620-105">At the core of this new functionality is the new XML Paper Specification (XPS) file format and the XPS print path.</span></span>  
  
 <span data-ttu-id="04620-106">Toto téma obsahuje tyto části:</span><span class="sxs-lookup"><span data-stu-id="04620-106">This topic contains the following sections.</span></span>  
  
<a name="introduction_to_XPS"></a>
## <a name="about-xps"></a><span data-ttu-id="04620-107">O společnosti XPS</span><span class="sxs-lookup"><span data-stu-id="04620-107">About XPS</span></span>  
 <span data-ttu-id="04620-108">XPS je formát elektronického dokumentu, formát souboru cívky a jazyk popisu stránky.</span><span class="sxs-lookup"><span data-stu-id="04620-108">XPS is an electronic document format, a spool file format and a page description language.</span></span> <span data-ttu-id="04620-109">Jedná se o otevřený formát dokumentu, který používá XML, otevřené konvence balení (OPC) a další oborové standardy k vytváření dokumentů pro různé platformy.</span><span class="sxs-lookup"><span data-stu-id="04620-109">It is an open document format that uses XML, Open Packaging Conventions (OPC), and other industry standards to create cross-platform documents.</span></span> <span data-ttu-id="04620-110">Xps zjednodušuje proces vytváření, sdílení, tisku, prohlížení a archivace digitálních dokumentů.</span><span class="sxs-lookup"><span data-stu-id="04620-110">XPS simplifies the process by which digital documents are created, shared, printed, viewed, and archived.</span></span> <span data-ttu-id="04620-111">Další informace o systému XPS naleznete v [tématu XPS Documents](/windows/desktop/printdocs/documents).</span><span class="sxs-lookup"><span data-stu-id="04620-111">For additional information on XPS, see [XPS Documents](/windows/desktop/printdocs/documents).</span></span>  
  
 <span data-ttu-id="04620-112">Několik technik pro tisk obsahu založeného na systému XPS pomocí WPF je demonstrováno v [programově tisku xps souborů](how-to-programmatically-print-xps-files.md).</span><span class="sxs-lookup"><span data-stu-id="04620-112">Several techniques for printing XPS-based content using WPF are demonstrated in [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="04620-113">Může být užitečné odkazovat na tyto ukázky během kontroly obsahu obsaženého v tomto tématu.</span><span class="sxs-lookup"><span data-stu-id="04620-113">You may find it useful to reference these samples during review of content contained in this topic.</span></span> <span data-ttu-id="04620-114">(Vývojáři nespravovaného kódu by měli vidět dokumentaci pro [funkci MXDC_ESCAPE](/windows/desktop/printdocs/mxdc-escape).</span><span class="sxs-lookup"><span data-stu-id="04620-114">(Unmanaged code developers should see documentation for the [MXDC_ESCAPE function](/windows/desktop/printdocs/mxdc-escape).</span></span> <span data-ttu-id="04620-115">Vývojáři windows forms musí <xref:System.Drawing.Printing> používat rozhraní API v oboru názvů, který nepodporuje úplnou cestu tisku XPS, ale podporuje hybridní cestu tisku GDI-XPS.</span><span class="sxs-lookup"><span data-stu-id="04620-115">Windows Forms developers must use the API in the <xref:System.Drawing.Printing> namespace which does not support the full XPS print path, but does support a hybrid GDI-to-XPS print path.</span></span> <span data-ttu-id="04620-116">Viz **Architektura cesty tisku** níže.)</span><span class="sxs-lookup"><span data-stu-id="04620-116">See **Print Path Architecture** below.)</span></span>  
  
<a name="XPS_print_path_intro"></a>
## <a name="xps-print-path"></a><span data-ttu-id="04620-117">Cesta k tisku XPS</span><span class="sxs-lookup"><span data-stu-id="04620-117">XPS Print Path</span></span>  
 <span data-ttu-id="04620-118">Cesta k tisku specifikace papíru XML (XPS) je nová funkce systému Windows, která nově definuje způsob zpracování tisku v aplikacích systému Windows.</span><span class="sxs-lookup"><span data-stu-id="04620-118">The XML Paper Specification (XPS) print path is a new Windows feature that redefines how printing is handled in Windows applications.</span></span> <span data-ttu-id="04620-119">Vzhledem k tomu, že systém XPS může nahradit jazyk prezentace dokumentu (například RTF), formát zařazování tisku (například WMF) a jazyk popisu stránky (například PCL nebo Postscript); nová cesta k tisku udržuje formát XPS od publikace aplikace až po konečné zpracování v tiskovém ovladači nebo zařízení.</span><span class="sxs-lookup"><span data-stu-id="04620-119">Because XPS can replace a document presentation language (such as RTF), a print spooler format (such as WMF), and a page description language (such as PCL or Postscript); the new print path maintains the XPS format from application publication to the final processing in the print driver or device.</span></span>  
  
 <span data-ttu-id="04620-120">Tisková cesta XPS je postavena na modelu ovladače tiskárny XPS (XPSDrv), který poskytuje vývojářům několik výhod, jako je například tisk "to, co vidíte, je to, co získáte" (WYSIWYG), vylepšená podpora barev a výrazně vyšší výkon tisku.</span><span class="sxs-lookup"><span data-stu-id="04620-120">The XPS print path is built upon the XPS printer driver model (XPSDrv), which provides several benefits for developers such as "what you see is what you get" (WYSIWYG) printing, improved color support, and significantly improved print performance.</span></span> <span data-ttu-id="04620-121">(Další informace o notebooku XPSDrv naleznete v [dokumentaci k sadě ovladačů systému Windows](/windows-hardware/drivers/).)</span><span class="sxs-lookup"><span data-stu-id="04620-121">(For more on XPSDrv, see the [Windows Driver Kit documentation](/windows-hardware/drivers/).)</span></span>  
  
 <span data-ttu-id="04620-122">Provoz služby zařazování tisku pro dokumenty XPS je v podstatě stejný jako v předchozích verzích systému Windows.</span><span class="sxs-lookup"><span data-stu-id="04620-122">The operation of the print spooler for XPS documents is essentially the same as in previous versions of Windows.</span></span> <span data-ttu-id="04620-123">Byla však rozšířena tak, aby podporovala cestu tisku XPS kromě existující cesty tisku GDI.</span><span class="sxs-lookup"><span data-stu-id="04620-123">However, it has been enhanced to support the XPS print path in addition to the existing GDI print path.</span></span> <span data-ttu-id="04620-124">Nová cesta tisku nativně spotřebovává soubor zařazování XPS.</span><span class="sxs-lookup"><span data-stu-id="04620-124">The new print path natively consumes an XPS spool file.</span></span> <span data-ttu-id="04620-125">Zatímco ovladače tiskárny v uživatelském režimu napsané pro předchozí verze systému Windows budou i nadále fungovat, k použití tiskové cesty XPS je nutný ovladač tiskárny XPS (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="04620-125">While user-mode printer drivers written for previous versions of Windows will continue to work, an XPS printer driver (XPSDrv) is required in order to use the XPS print path.</span></span>  
  
 <span data-ttu-id="04620-126">Výhody tiskové cesty XPS jsou významné a zahrnují:</span><span class="sxs-lookup"><span data-stu-id="04620-126">The benefits of the XPS print path are significant, and include:</span></span>  
  
- <span data-ttu-id="04620-127">Podpora tisku WYSIWYG</span><span class="sxs-lookup"><span data-stu-id="04620-127">WYSIWYG print support</span></span>  
  
- <span data-ttu-id="04620-128">Nativní podpora pokročilých profilů barev, které zahrnují 32 bitů na kanál (bpc), CMYK, pojmenované barvy, n-inkousty a nativní podporu průhlednosti a přechodů.</span><span class="sxs-lookup"><span data-stu-id="04620-128">Native support of advanced color profiles, which include 32 bits per channel (bpc), CMYK, named-colors, n-inks, and native support of transparency and gradients.</span></span>  
  
- <span data-ttu-id="04620-129">Zlepšený výkon tisku pro aplikace založené na rozhraní .NET Framework i Win32.</span><span class="sxs-lookup"><span data-stu-id="04620-129">Improved print performance for both .NET Framework and Win32 based applications.</span></span>  
  
- <span data-ttu-id="04620-130">Standardní formát XPS.</span><span class="sxs-lookup"><span data-stu-id="04620-130">Industry standard XPS format.</span></span>  
  
 <span data-ttu-id="04620-131">Pro základní tiskové scénáře je k dispozici jednoduché a intuitivní rozhraní API s jediným vstupním bodem pro uživatelské rozhraní, konfiguraci a odeslání úlohy.</span><span class="sxs-lookup"><span data-stu-id="04620-131">For basic print scenarios, a simple and intuitive API is available with a single entry point for user interface, configuration and job submission.</span></span> <span data-ttu-id="04620-132">Pro pokročilé scénáře je přidána [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] další podpora [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] pro přizpůsobení (nebo vůbec žádné), synchronní nebo asynchronní tisk a možnosti dávkového tisku.</span><span class="sxs-lookup"><span data-stu-id="04620-132">For advanced scenarios, an additional support is added for [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] customization (or no [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] at all), synchronous or asynchronous printing, and batch printing capabilities.</span></span> <span data-ttu-id="04620-133">Obě možnosti poskytují podporu tisku v režimu úplné nebo částečné důvěryhodnosti.</span><span class="sxs-lookup"><span data-stu-id="04620-133">Both options provide print support in full or partial trust mode.</span></span>  
  
 <span data-ttu-id="04620-134">Systém XPS byl navržen s ohledem na rozšiřitelnost.</span><span class="sxs-lookup"><span data-stu-id="04620-134">XPS was designed with extensibility in mind.</span></span> <span data-ttu-id="04620-135">Pomocí rozhraní rozšiřitelnosti lze funkce a možnosti přidat do systému XPS modulárním způsobem.</span><span class="sxs-lookup"><span data-stu-id="04620-135">By using the extensibility framework, features and capabilities can be added to XPS in a modular manner.</span></span> <span data-ttu-id="04620-136">Funkce rozšiřitelnosti zahrnují:</span><span class="sxs-lookup"><span data-stu-id="04620-136">Extensibility features include:</span></span>  
  
- <span data-ttu-id="04620-137">Schéma tisku.</span><span class="sxs-lookup"><span data-stu-id="04620-137">Print Schema.</span></span> <span data-ttu-id="04620-138">Veřejné schéma je pravidelně aktualizováno a umožňuje rychlé rozšíření možností zařízení.</span><span class="sxs-lookup"><span data-stu-id="04620-138">The public schema is updated regularly and enables rapid extension of device capabilities.</span></span> <span data-ttu-id="04620-139">(Viz **PrintTicket a PrintCapabilities** níže.)</span><span class="sxs-lookup"><span data-stu-id="04620-139">(See **PrintTicket and PrintCapabilities** below.)</span></span>  
  
- <span data-ttu-id="04620-140">Rozšiřitelný kanál filtru.</span><span class="sxs-lookup"><span data-stu-id="04620-140">Extensible Filter Pipeline.</span></span> <span data-ttu-id="04620-141">Kanál filtru ovladače tiskárny XPS (XPSDrv) byl navržen tak, aby umožňoval přímý i škálovatelný tisk dokumentů XPS.</span><span class="sxs-lookup"><span data-stu-id="04620-141">The XPS printer driver (XPSDrv) filter pipeline was designed to enable both direct and scalable printing of XPS documents.</span></span> <span data-ttu-id="04620-142">Další informace naleznete [v tématu Ovladače tiskáren XPSDrv](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span><span class="sxs-lookup"><span data-stu-id="04620-142">For more information, see [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>
  
### <a name="print-path-architecture"></a><span data-ttu-id="04620-143">Architektura tiskových cest</span><span class="sxs-lookup"><span data-stu-id="04620-143">Print Path Architecture</span></span>  
 <span data-ttu-id="04620-144">Zatímco aplikace Win32 i .NET Framework podporují aplikace XPS, Win32 a Windows Forms, používají převod GDI na XPS za účelem vytvoření obsahu ve formátu XPS pro ovladač tiskárny XPS (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="04620-144">While both Win32 and .NET Framework applications support XPS, Win32 and Windows Forms applications use a GDI to XPS conversion in order to create XPS formatted content for the XPS printer driver (XPSDrv).</span></span> <span data-ttu-id="04620-145">Tyto aplikace nejsou nutné k použití cesty tisku XPS a mohou nadále používat rozšířený metafile (EMF) založený na tisku.</span><span class="sxs-lookup"><span data-stu-id="04620-145">These applications are not required to use the XPS print path, and can continue to use Enhanced Metafile (EMF) based printing.</span></span> <span data-ttu-id="04620-146">Většina funkcí a vylepšení systému XPS je však k dispozici pouze aplikacím, které cílí na cestu tisku XPS.</span><span class="sxs-lookup"><span data-stu-id="04620-146">However, most XPS features and enhancements are only available to applications that target the XPS print path.</span></span>  
  
 <span data-ttu-id="04620-147">Chcete-li povolit použití tiskáren založených na technologii XPSDrv aplikacemi Win32 a Windows Forms, podporuje ovladač tiskárny XPS (XPSDrv) převod formátu GDI na formát XPS.</span><span class="sxs-lookup"><span data-stu-id="04620-147">To enable the use of XPSDrv-based printers by Win32 and Windows Forms applications, the XPS printer driver (XPSDrv) supports conversion of GDI to XPS format.</span></span> <span data-ttu-id="04620-148">Model XPSDrv také poskytuje převodník pro formát XPS do GDI, takže aplikace Win32 mohou tisknout dokumenty XPS.</span><span class="sxs-lookup"><span data-stu-id="04620-148">The XPSDrv model also provides a converter for XPS to GDI format so that Win32 applications can print XPS Documents.</span></span> <span data-ttu-id="04620-149">U aplikací WPF se převod formátu XPS na GDI provádí automaticky <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> metodami a <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> metodami <xref:System.Windows.Xps.XpsDocumentWriter> třídy, kdykoli cílová tisková fronta operace zápisu nemá ovladač XPSDrv.</span><span class="sxs-lookup"><span data-stu-id="04620-149">For WPF applications, conversion of XPS to GDI format is done automatically by the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class whenever the target print queue of the write operation does not have an XPSDrv driver.</span></span> <span data-ttu-id="04620-150">(Aplikace Windows Forms nemohou tisknout dokumenty XPS.)</span><span class="sxs-lookup"><span data-stu-id="04620-150">(Windows Forms applications cannot print XPS Documents.)</span></span>  
  
 <span data-ttu-id="04620-151">Následující obrázek znázorňuje tiskový subsystém a definuje části poskytované společností Microsoft a části definované dodavateli softwaru a hardwaru:</span><span class="sxs-lookup"><span data-stu-id="04620-151">The following illustration depicts the print subsystem and defines the portions provided by Microsoft, and the portions defined by software and hardware vendors:</span></span>  
  
 ![Snímek obrazovky ukazuje tiskový systém XPS.](./media/printing-overview/xml-paper-specification-print-system.png)  
  
### <a name="basic-xps-printing"></a><span data-ttu-id="04620-153">Základní tisk XPS</span><span class="sxs-lookup"><span data-stu-id="04620-153">Basic XPS Printing</span></span>  
 <span data-ttu-id="04620-154">WPF definuje základní i pokročilé rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="04620-154">WPF defines both a basic and advanced API.</span></span> <span data-ttu-id="04620-155">Pro aplikace, které nevyžadují rozsáhlé přizpůsobení tisku nebo přístup k kompletní sadě funkcí XPS, je k dispozici základní podpora tisku.</span><span class="sxs-lookup"><span data-stu-id="04620-155">For those applications that do not require extensive print customization or access to the complete XPS feature set, basic print support is available.</span></span> <span data-ttu-id="04620-156">Základní podpora tisku je vystavena prostřednictvím ovládacího prvku [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]tiskového dialogu, který vyžaduje minimální konfiguraci a obsahuje známé .</span><span class="sxs-lookup"><span data-stu-id="04620-156">Basic print support is exposed through a print dialog control that requires minimal configuration and features a familiar [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="04620-157">Pomocí tohoto zjednodušeného tiskového modelu je k dispozici mnoho funkcí XPS.</span><span class="sxs-lookup"><span data-stu-id="04620-157">Many XPS features are available using this simplified print model.</span></span>  
  
#### <a name="printdialog"></a><span data-ttu-id="04620-158">PrintDialog</span><span class="sxs-lookup"><span data-stu-id="04620-158">PrintDialog</span></span>  
 <span data-ttu-id="04620-159">Ovládací <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> prvek poskytuje jeden [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]vstupní bod pro , konfigurace a XPS odeslání úlohy.</span><span class="sxs-lookup"><span data-stu-id="04620-159">The <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> control provides a single entry point for [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuration, and XPS job submission.</span></span> <span data-ttu-id="04620-160">Informace o vytvoření instance a použití ovládacího prvku naleznete v [tématu Invoke a Print Dialog](how-to-invoke-a-print-dialog.md).</span><span class="sxs-lookup"><span data-stu-id="04620-160">For information about how to instantiate and use the control, see [Invoke a Print Dialog](how-to-invoke-a-print-dialog.md).</span></span>  
  
### <a name="advanced-xps-printing"></a><span data-ttu-id="04620-161">Pokročilý tisk XPS</span><span class="sxs-lookup"><span data-stu-id="04620-161">Advanced XPS Printing</span></span>  
 <span data-ttu-id="04620-162">Pro přístup k úplné sadě funkcí XPS je nutné použít rozšířené rozhraní API pro tisk.</span><span class="sxs-lookup"><span data-stu-id="04620-162">To access the complete set of XPS features, the advanced print API must be used.</span></span> <span data-ttu-id="04620-163">Několik relevantních API je podrobněji popsáno níže.</span><span class="sxs-lookup"><span data-stu-id="04620-163">Several relevant API are described in greater detail below.</span></span> <span data-ttu-id="04620-164">Úplný seznam souborů API cesty k tisku <xref:System.Windows.Xps> xps naleznete v odkazech a <xref:System.Printing> odkazech na obor názvů.</span><span class="sxs-lookup"><span data-stu-id="04620-164">For a complete list of XPS print path APIs, see the <xref:System.Windows.Xps> and <xref:System.Printing> namespace references.</span></span>  
  
#### <a name="printticket-and-printcapabilities"></a><span data-ttu-id="04620-165">PrintTicket a PrintCapabilities</span><span class="sxs-lookup"><span data-stu-id="04620-165">PrintTicket and PrintCapabilities</span></span>  
 <span data-ttu-id="04620-166"><xref:System.Printing.PrintTicket> Třídy <xref:System.Printing.PrintCapabilities> a jsou základem pokročilých funkcí XPS.</span><span class="sxs-lookup"><span data-stu-id="04620-166">The <xref:System.Printing.PrintTicket> and <xref:System.Printing.PrintCapabilities> classes are the foundation of the advanced XPS features.</span></span> <span data-ttu-id="04620-167">Oba typy objektů jsou struktury funkcí orientovaných na tisk ve formátu XML, jako je řazení, oboustranný tisk, sešívání atd. Tyto struktury jsou definovány schématem tisku.</span><span class="sxs-lookup"><span data-stu-id="04620-167">Both types of objects are XML formatted structures of print-oriented features such as collation, two-sided printing, stapling, etc. These structures are defined by the print schema.</span></span> <span data-ttu-id="04620-168">A <xref:System.Printing.PrintTicket> pokyn tiskárny, jak zpracovat tiskovou úlohu.</span><span class="sxs-lookup"><span data-stu-id="04620-168">A <xref:System.Printing.PrintTicket> instructs a printer how to process a print job.</span></span> <span data-ttu-id="04620-169">Třída <xref:System.Printing.PrintCapabilities> definuje možnosti tiskárny.</span><span class="sxs-lookup"><span data-stu-id="04620-169">The <xref:System.Printing.PrintCapabilities> class defines the capabilities of a printer.</span></span> <span data-ttu-id="04620-170">Dotazem na možnosti tiskárny <xref:System.Printing.PrintTicket> lze vytvořit a plně využít výhod podporovaných funkcí tiskárny.</span><span class="sxs-lookup"><span data-stu-id="04620-170">By querying the capabilities of a printer, a <xref:System.Printing.PrintTicket> can be created that takes full advantage of a printer's supported features.</span></span> <span data-ttu-id="04620-171">Podobně se lze vyhnout nepodporovaným funkcím.</span><span class="sxs-lookup"><span data-stu-id="04620-171">Similarly, unsupported features can be avoided.</span></span>  
  
 <span data-ttu-id="04620-172">Následující příklad ukazuje, jak <xref:System.Printing.PrintCapabilities> dotaz tiskárny a <xref:System.Printing.PrintTicket> vytvořit pomocí kódu.</span><span class="sxs-lookup"><span data-stu-id="04620-172">The following example demonstrates how to query the <xref:System.Printing.PrintCapabilities> of a printer and create a <xref:System.Printing.PrintTicket> using code.</span></span>  
  
 [!code-cpp[xpscreate#PrinterCapabilities](~/samples/snippets/cpp/VS_Snippets_Wpf/XpsCreate/CPP/XpsCreate.cpp#printercapabilities)]
 [!code-csharp[xpscreate#PrinterCapabilities](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsCreate/CSharp/XpsCreate.cs#printercapabilities)]
 [!code-vb[xpscreate#PrinterCapabilities](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsCreate/visualbasic/xpscreate.vb#printercapabilities)]  
  
#### <a name="printserver-and-printqueue"></a><span data-ttu-id="04620-173">PrintServer a tisková fronta</span><span class="sxs-lookup"><span data-stu-id="04620-173">PrintServer and PrintQueue</span></span>  
 <span data-ttu-id="04620-174">Třída <xref:System.Printing.PrintServer> představuje síťový tiskový server <xref:System.Printing.PrintQueue> a třída představuje tiskárnu a výstupní frontu úloh, která je k ní přidružena.</span><span class="sxs-lookup"><span data-stu-id="04620-174">The <xref:System.Printing.PrintServer> class represents a network print server and the <xref:System.Printing.PrintQueue> class represents a printer and the output job queue associated with it.</span></span> <span data-ttu-id="04620-175">Tato řešení API společně umožňují pokročilou správu tiskových úloh serveru.</span><span class="sxs-lookup"><span data-stu-id="04620-175">Together, these APIs allow advanced management of a server's print jobs.</span></span> <span data-ttu-id="04620-176">A <xref:System.Printing.PrintServer>nebo jeden z jeho odvozené třídy, se používá ke správě <xref:System.Printing.PrintQueue>.</span><span class="sxs-lookup"><span data-stu-id="04620-176">A <xref:System.Printing.PrintServer>, or one of its derived classes, is used to manage a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="04620-177">Metoda <xref:System.Printing.PrintQueue.AddJob%2A> se používá k vložení nové tiskové úlohy do fronty.</span><span class="sxs-lookup"><span data-stu-id="04620-177">The <xref:System.Printing.PrintQueue.AddJob%2A> method is used to insert a new print job into the queue.</span></span>  
  
 <span data-ttu-id="04620-178">Následující příklad ukazuje, jak <xref:System.Printing.LocalPrintServer> vytvořit a <xref:System.Printing.PrintQueue> získat přístup k jeho výchozí pomocí kódu.</span><span class="sxs-lookup"><span data-stu-id="04620-178">The following example demonstrates how to create a <xref:System.Printing.LocalPrintServer> and access its default <xref:System.Printing.PrintQueue> by using code.</span></span>  
  
 [!code-csharp[xpsprint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[xpsprint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
#### <a name="xpsdocumentwriter"></a><span data-ttu-id="04620-179">XpsDocumentWriter</span><span class="sxs-lookup"><span data-stu-id="04620-179">XpsDocumentWriter</span></span>  
 <span data-ttu-id="04620-180">An <xref:System.Windows.Xps.XpsDocumentWriter>, s <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> jeho <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> mnoha a metody, se používá <xref:System.Printing.PrintQueue>k zápisu XPS dokumenty .</span><span class="sxs-lookup"><span data-stu-id="04620-180">An <xref:System.Windows.Xps.XpsDocumentWriter>, with its many the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods, is used to write XPS documents to a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="04620-181">Metoda se <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> například používá k výstupu dokumentu <xref:System.Printing.PrintTicket> XPS a synchronně.</span><span class="sxs-lookup"><span data-stu-id="04620-181">For example, the <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> synchronously.</span></span> <span data-ttu-id="04620-182">Metoda <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> se používá k výstupu dokumentu <xref:System.Printing.PrintTicket> XPS a asynchronně.</span><span class="sxs-lookup"><span data-stu-id="04620-182">The <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> asynchronously.</span></span>  
  
 <span data-ttu-id="04620-183">Následující příklad ukazuje, jak <xref:System.Windows.Xps.XpsDocumentWriter> vytvořit pomocí kódu.</span><span class="sxs-lookup"><span data-stu-id="04620-183">The following example demonstrates how to create an <xref:System.Windows.Xps.XpsDocumentWriter> using code.</span></span>  
  
 [!code-csharp[XpsPrint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[XpsPrint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
 <span data-ttu-id="04620-184">Metody <xref:System.Printing.PrintQueue.AddJob%2A> také poskytují způsoby tisku.</span><span class="sxs-lookup"><span data-stu-id="04620-184">The <xref:System.Printing.PrintQueue.AddJob%2A> methods also provide ways to print.</span></span> <span data-ttu-id="04620-185">Viz [Programově tisk souborů XPS](how-to-programmatically-print-xps-files.md).</span><span class="sxs-lookup"><span data-stu-id="04620-185">See [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="04620-186">podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="04620-186">for details.</span></span>  
  
<a name="GDI_Print_Path_intro"></a>
## <a name="gdi-print-path"></a><span data-ttu-id="04620-187">Cesta k tisku GDI</span><span class="sxs-lookup"><span data-stu-id="04620-187">GDI Print Path</span></span>  
 <span data-ttu-id="04620-188">Zatímco aplikace WPF nativně podporují cestu tisku XPS, aplikace Win32 a Windows Forms mohou také využívat některé funkce XPS.</span><span class="sxs-lookup"><span data-stu-id="04620-188">While WPF applications natively support the XPS print path, Win32 and Windows Forms applications can also take advantage of some XPS features.</span></span> <span data-ttu-id="04620-189">Ovladač tiskárny XPS (XPSDrv) může převést výstup založený na GDI do formátu XPS.</span><span class="sxs-lookup"><span data-stu-id="04620-189">The XPS printer driver (XPSDrv) can convert GDI based output to XPS format.</span></span> <span data-ttu-id="04620-190">U pokročilých scénářů je vlastní převod obsahu podporován pomocí [převaděče dokumentů Microsoft XPS (MXDC).](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)</span><span class="sxs-lookup"><span data-stu-id="04620-190">For advanced scenarios, custom conversion of content is supported using the [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-).</span></span> <span data-ttu-id="04620-191">Podobně wpf aplikace mohou také výstup na cestu tisku GDI <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> voláním <xref:System.Windows.Xps.XpsDocumentWriter> jedné z <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> nebo metody třídy a označení non-XpsDrv tiskárny jako cílové tiskové fronty.</span><span class="sxs-lookup"><span data-stu-id="04620-191">Similarly, WPF applications can also output to the GDI print path by calling one of the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> or <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class and designating a non-XpsDrv printer as the target print queue.</span></span>  

<span data-ttu-id="04620-192">U aplikací, které nevyžadují funkce nebo podporu systému XPS, zůstane aktuální cesta k tisku GDI nezměněna.</span><span class="sxs-lookup"><span data-stu-id="04620-192">For applications that do not require XPS functionality or support, the current GDI print path remains unchanged.</span></span>  
  
- <span data-ttu-id="04620-193">Další referenční materiál na cestě k tisku GDI a různé možnosti převodu XPS naleznete v tématech [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) a [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span><span class="sxs-lookup"><span data-stu-id="04620-193">For additional reference material on the GDI print path and the various XPS conversion options, see [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) and [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>  
  
<a name="XPS_Driver_Model_intro"></a>
## <a name="xpsdrv-driver-model"></a><span data-ttu-id="04620-194">Model ovladače XPSDrv</span><span class="sxs-lookup"><span data-stu-id="04620-194">XPSDrv Driver Model</span></span>  
 <span data-ttu-id="04620-195">Tisková cesta XPS zvyšuje efektivitu zařazování pomocí systému XPS jako nativního formátu zařazování tisku při tisku do tiskárny nebo ovladače s podporou systému XPS.</span><span class="sxs-lookup"><span data-stu-id="04620-195">The XPS print path improves spooler efficiency by using XPS as the native print spool format when printing to an XPS -enabled printer or driver.</span></span> <span data-ttu-id="04620-196">Zjednodušený proces zařazování eliminuje potřebu generovat zprostředkující soubor zařazování, například datový soubor EMF, před zařazováním dokumentu.</span><span class="sxs-lookup"><span data-stu-id="04620-196">The simplified spooling process eliminates the need to generate an intermediate spool file, such as an EMF data file, before the document is spooled.</span></span> <span data-ttu-id="04620-197">Díky menším velikostem souborů zařazování může tisková cesta XPS snížit zatížení sítě a zlepšit výkon tisku.</span><span class="sxs-lookup"><span data-stu-id="04620-197">Through smaller spool file sizes, the XPS print path can reduce network traffic and improve print performance.</span></span>  
  
 <span data-ttu-id="04620-198">EMF je uzavřený formát, který představuje výstup aplikace jako řadu volání do GDI pro vykreslování služeb.</span><span class="sxs-lookup"><span data-stu-id="04620-198">EMF is a closed format that represents application output as a series of calls into GDI for rendering services.</span></span> <span data-ttu-id="04620-199">Na rozdíl od EMF představuje formát zařazování XPS skutečný dokument bez nutnosti další interpretace při výstupu do ovladače tiskárny založené na notebooku XPS (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="04620-199">Unlike EMF, the XPS spool format represents the actual document without requiring further interpretation when output to an XPS-based printer driver (XPSDrv).</span></span> <span data-ttu-id="04620-200">Ovladače mohou pracovat přímo na datech ve formátu.</span><span class="sxs-lookup"><span data-stu-id="04620-200">The drivers can operate directly on the data in the format.</span></span> <span data-ttu-id="04620-201">Tato funkce eliminuje převody dat a barevného prostoru požadované při použití souborů EMF a tiskových ovladačů založených na GDI.</span><span class="sxs-lookup"><span data-stu-id="04620-201">This capability eliminates the data and color space conversions required when you use EMF files and GDI-based print drivers.</span></span>  
  
 <span data-ttu-id="04620-202">Velikost souborů zařazuje se obvykle snižuje, když používáte dokumenty XPS, které cílí na ovladač tiskárny XPS (XPSDrv) ve srovnání s jejich ekvivalenty EMF; existují však výjimky:</span><span class="sxs-lookup"><span data-stu-id="04620-202">Spool file sizes are usually reduced when you use XPS Documents that target an XPS printer driver (XPSDrv) compared with their EMF equivalents; however, there are exceptions:</span></span>  
  
- <span data-ttu-id="04620-203">Vektorová grafika, která je velmi složitá, vícevrstvá nebo neefektivně napsaná, může být větší než bitmapovaná verze stejné grafiky.</span><span class="sxs-lookup"><span data-stu-id="04620-203">A vector graphic that is very complex, multi-layered, or inefficiently written can be larger than a bitmapped version of the same graphic.</span></span>  
  
- <span data-ttu-id="04620-204">Pro účely zobrazení obrazovky, XPS soubory vložit zařízení písma, stejně jako počítač-založené písma; vzhledem k tomu, že soubory zařazovacího zařízení GDI nevsousávají písma zařízení.</span><span class="sxs-lookup"><span data-stu-id="04620-204">For screen display purposes, XPS files embed device fonts as well as computer-based fonts; whereas GDI spool files do not embed device fonts.</span></span> <span data-ttu-id="04620-205">Ale oba druhy písem jsou podsety (viz níže) a ovladače tiskárny mohou odstranit písma zařízení před přenosem souboru do tiskárny.</span><span class="sxs-lookup"><span data-stu-id="04620-205">But both kinds of fonts are subsetted (see below) and printer drivers can remove the device fonts before transmitting the file to the printer.</span></span>  
  
 <span data-ttu-id="04620-206">Snížení velikosti cívky se provádí pomocí několika mechanismů:</span><span class="sxs-lookup"><span data-stu-id="04620-206">Spool size reduction is performed through several mechanisms:</span></span>  
  
- <span data-ttu-id="04620-207">**Podmnožina písma**.</span><span class="sxs-lookup"><span data-stu-id="04620-207">**Font subsetting**.</span></span> <span data-ttu-id="04620-208">V souboru XPS jsou uloženy pouze znaky použité v rámci skutečného dokumentu.</span><span class="sxs-lookup"><span data-stu-id="04620-208">Only characters used within the actual document are stored in the XPS file.</span></span>  
  
- <span data-ttu-id="04620-209">**Pokročilá podpora grafiky**.</span><span class="sxs-lookup"><span data-stu-id="04620-209">**Advanced Graphics Support**.</span></span> <span data-ttu-id="04620-210">Nativní podpora pro transparentnost a základní přechod zabraňuje rastrování obsahu v dokumentu XPS.</span><span class="sxs-lookup"><span data-stu-id="04620-210">Native support for transparency and gradient primitives avoids rasterization of content in the XPS Document.</span></span>  
  
- <span data-ttu-id="04620-211">**Identifikace společných zdrojů**.</span><span class="sxs-lookup"><span data-stu-id="04620-211">**Identification of common resources**.</span></span> <span data-ttu-id="04620-212">Prostředky, které se používají vícekrát (například obrázek, který představuje firemní logo) jsou považovány za sdílené prostředky a jsou načteny pouze jednou.</span><span class="sxs-lookup"><span data-stu-id="04620-212">Resources that are used multiple times (such as an image that represents a corporate logo) are treated as shared resources and are loaded only once.</span></span>  
  
- <span data-ttu-id="04620-213">**Komprese ZIP**.</span><span class="sxs-lookup"><span data-stu-id="04620-213">**ZIP compression**.</span></span> <span data-ttu-id="04620-214">Všechny dokumenty XPS používají kompresi ZIP.</span><span class="sxs-lookup"><span data-stu-id="04620-214">All XPS documents use ZIP compression.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="04620-215">Viz také</span><span class="sxs-lookup"><span data-stu-id="04620-215">See also</span></span>

- <xref:System.Windows.Controls.PrintDialog>
- <xref:System.Windows.Xps.XpsDocumentWriter>
- <xref:System.Windows.Xps.Packaging.XpsDocument>
- <xref:System.Printing.PrintTicket>
- <xref:System.Printing.PrintCapabilities>
- <xref:System.Printing.PrintServer>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="04620-216">Témata s postupy</span><span class="sxs-lookup"><span data-stu-id="04620-216">How-to Topics</span></span>](printing-how-to-topics.md)
- [<span data-ttu-id="04620-217">Dokumenty v platformě WPF</span><span class="sxs-lookup"><span data-stu-id="04620-217">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="04620-218">Dokumenty XPS</span><span class="sxs-lookup"><span data-stu-id="04620-218">XPS Documents</span></span>](/windows/desktop/printdocs/documents)
- [<span data-ttu-id="04620-219">Serializace a úložiště dokumentu</span><span class="sxs-lookup"><span data-stu-id="04620-219">Document Serialization and Storage</span></span>](document-serialization-and-storage.md)
- [<span data-ttu-id="04620-220">Microsoft XPS Převaděč dokumentů (MXDC)</span><span class="sxs-lookup"><span data-stu-id="04620-220">Microsoft XPS Document Converter (MXDC)</span></span>](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)
