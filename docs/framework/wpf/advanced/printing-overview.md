---
title: Přehled tisku
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print path [WPF], XPS
- printers [WPF], XPSDrv-based
- printing [WPF]
- PrintQueue class PrintServer class [WPF]
- XML Paper Specification (XPS) file format
- XPS (XML Paper Specification) file format
- XPSDrv-based printers
- GDI print path [WPF]
ms.assetid: 0de8ac41-9aa6-413d-a121-7aa6f41539b1
ms.openlocfilehash: de9f4b5c0a817d010c7510395b4e5c09ed0a9865
ms.sourcegitcommit: 13e79efdbd589cad6b1de634f5d6b1262b12ab01
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/28/2020
ms.locfileid: "76794283"
---
# <a name="printing-overview"></a><span data-ttu-id="6edd9-102">Přehled tisku</span><span class="sxs-lookup"><span data-stu-id="6edd9-102">Printing Overview</span></span>
<span data-ttu-id="6edd9-103">S Microsoft .NET Framework mají vývojáři aplikací pomocí Windows Presentation Foundation (WPF) bohatou novou sadu rozhraní API pro správu tisku a tiskového systému.</span><span class="sxs-lookup"><span data-stu-id="6edd9-103">With Microsoft .NET Framework, application developers using Windows Presentation Foundation (WPF) have a rich new set of printing and print system management APIs.</span></span> <span data-ttu-id="6edd9-104">V systému Windows Vista jsou některá z těchto vylepšení systému pro tisk také k dispozici vývojářům vytvářejícím model Windows Forms aplikací a vývojářů pomocí nespravovaného kódu.</span><span class="sxs-lookup"><span data-stu-id="6edd9-104">With Windows Vista, some of these print system enhancements are also available to developers creating Windows Forms applications and developers using unmanaged code.</span></span> <span data-ttu-id="6edd9-105">Základem této nové funkce je nový formát souboru XPS (XML Paper Specification) a cesta k tisku XPS.</span><span class="sxs-lookup"><span data-stu-id="6edd9-105">At the core of this new functionality is the new XML Paper Specification (XPS) file format and the XPS print path.</span></span>  
  
 <span data-ttu-id="6edd9-106">Toto téma obsahuje následující části.</span><span class="sxs-lookup"><span data-stu-id="6edd9-106">This topic contains the following sections.</span></span>  
  
<a name="introduction_to_XPS"></a>   
## <a name="about-xps"></a><span data-ttu-id="6edd9-107">O formátu XPS</span><span class="sxs-lookup"><span data-stu-id="6edd9-107">About XPS</span></span>  
 <span data-ttu-id="6edd9-108">XPS je elektronický formát dokumentu, formát souboru zařazování a jazyk popisu stránky.</span><span class="sxs-lookup"><span data-stu-id="6edd9-108">XPS is an electronic document format, a spool file format and a page description language.</span></span> <span data-ttu-id="6edd9-109">Jedná se o otevřený formát dokumentu, který používá XML, konvence pro otevření balíčku (OPC) a další oborové standardy k vytváření dokumentů pro různé platformy.</span><span class="sxs-lookup"><span data-stu-id="6edd9-109">It is an open document format that uses XML, Open Packaging Conventions (OPC), and other industry standards to create cross-platform documents.</span></span> <span data-ttu-id="6edd9-110">XPS zjednodušuje proces, při kterém se vytvářejí, sdílí, tisknou, zobrazují a archivují digitální dokumenty.</span><span class="sxs-lookup"><span data-stu-id="6edd9-110">XPS simplifies the process by which digital documents are created, shared, printed, viewed, and archived.</span></span> <span data-ttu-id="6edd9-111">Další informace o XPS najdete v [dokumentu XPS](/windows/desktop/printdocs/documents).</span><span class="sxs-lookup"><span data-stu-id="6edd9-111">For additional information on XPS, see [XPS Documents](/windows/desktop/printdocs/documents).</span></span>  
  
 <span data-ttu-id="6edd9-112">Několik postupů pro tisk obsahu založeného na XPS pomocí WPF je znázorněno v [programovém tisku souborů XPS](how-to-programmatically-print-xps-files.md).</span><span class="sxs-lookup"><span data-stu-id="6edd9-112">Several techniques for printing XPS-based content using WPF are demonstrated in [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="6edd9-113">Může být užitečné, aby na tyto ukázky odkazovala během revize obsahu obsaženého v tomto tématu.</span><span class="sxs-lookup"><span data-stu-id="6edd9-113">You may find it useful to reference these samples during review of content contained in this topic.</span></span> <span data-ttu-id="6edd9-114">(Vývojáři nespravovaného kódu by měli vidět dokumentaci k [funkci MXDC_ESCAPE](/windows/desktop/printdocs/mxdc-escape).</span><span class="sxs-lookup"><span data-stu-id="6edd9-114">(Unmanaged code developers should see documentation for the [MXDC_ESCAPE function](/windows/desktop/printdocs/mxdc-escape).</span></span> <span data-ttu-id="6edd9-115">Model Windows Forms vývojáři musí používat rozhraní API v oboru názvů <xref:System.Drawing.Printing>, který nepodporuje úplnou cestu k tisku v rámci XPS, ale podporuje hybridní cestu k tisku typu GDI.</span><span class="sxs-lookup"><span data-stu-id="6edd9-115">Windows Forms developers must use the API in the <xref:System.Drawing.Printing> namespace which does not support the full XPS print path, but does support a hybrid GDI-to-XPS print path.</span></span> <span data-ttu-id="6edd9-116">Viz **Architektura tisk cesty** níže.)</span><span class="sxs-lookup"><span data-stu-id="6edd9-116">See **Print Path Architecture** below.)</span></span>  
  
<a name="XPS_print_path_intro"></a>   
## <a name="xps-print-path"></a><span data-ttu-id="6edd9-117">Cesta tisku XPS</span><span class="sxs-lookup"><span data-stu-id="6edd9-117">XPS Print Path</span></span>  
 <span data-ttu-id="6edd9-118">Cesta tisku XPS (XML Paper Specification) je nová funkce systému Windows, která mění definici způsobu zpracování tisku v aplikacích systému Windows.</span><span class="sxs-lookup"><span data-stu-id="6edd9-118">The XML Paper Specification (XPS) print path is a new Windows feature that redefines how printing is handled in Windows applications.</span></span> <span data-ttu-id="6edd9-119">Vzhledem k tomu, že XPS může nahradit jazyk prezentace dokumentu (jako je RTF), formát zařazování tisku (například WMF) a jazyk popisu stránky (například PCL nebo PostScript); Nová cesta tisku uchovává formát XPS z publikace aplikace do konečného zpracování v ovladači tiskárny nebo zařízení.</span><span class="sxs-lookup"><span data-stu-id="6edd9-119">Because XPS can replace a document presentation language (such as RTF), a print spooler format (such as WMF), and a page description language (such as PCL or Postscript); the new print path maintains the XPS format from application publication to the final processing in the print driver or device.</span></span>  
  
 <span data-ttu-id="6edd9-120">Cesta k tisku ve formátu XPS je postavená na modelu XPSDrv (XPS Printer Driver Model), který poskytuje několik výhod pro vývojáře, jako je například "co vidíte" (WYSIWYG), vylepšená podpora barev a výrazně Vylepšený výkon tisku.</span><span class="sxs-lookup"><span data-stu-id="6edd9-120">The XPS print path is built upon the XPS printer driver model (XPSDrv), which provides several benefits for developers such as "what you see is what you get" (WYSIWYG) printing, improved color support, and significantly improved print performance.</span></span> <span data-ttu-id="6edd9-121">(Další informace o XPSDrv najdete v [dokumentaci k sadě Windows Driver Kit](/windows-hardware/drivers/).)</span><span class="sxs-lookup"><span data-stu-id="6edd9-121">(For more on XPSDrv, see the [Windows Driver Kit documentation](/windows-hardware/drivers/).)</span></span>  
  
 <span data-ttu-id="6edd9-122">Operace zařazování tisku pro dokumenty XPS je v podstatě stejná jako v předchozích verzích Windows.</span><span class="sxs-lookup"><span data-stu-id="6edd9-122">The operation of the print spooler for XPS documents is essentially the same as in previous versions of Windows.</span></span> <span data-ttu-id="6edd9-123">Kromě existující cesty pro tisk v rozhraní GDI se ale vylepšila podpora cesty k tisku XPS.</span><span class="sxs-lookup"><span data-stu-id="6edd9-123">However, it has been enhanced to support the XPS print path in addition to the existing GDI print path.</span></span> <span data-ttu-id="6edd9-124">Nová cesta pro tisk nativně spotřebovává soubor zařazování XPS.</span><span class="sxs-lookup"><span data-stu-id="6edd9-124">The new print path natively consumes an XPS spool file.</span></span> <span data-ttu-id="6edd9-125">I když budou ovladače tiskáren v uživatelském režimu napsané pro předchozí verze Windows i nadále fungovat, vyžaduje se ovladač tiskárny XPS (XPSDrv), aby bylo možné použít tiskovou cestu XPS.</span><span class="sxs-lookup"><span data-stu-id="6edd9-125">While user-mode printer drivers written for previous versions of Windows will continue to work, an XPS printer driver (XPSDrv) is required in order to use the XPS print path.</span></span>  
  
 <span data-ttu-id="6edd9-126">Výhody tiskové cesty XPS jsou významné a zahrnují:</span><span class="sxs-lookup"><span data-stu-id="6edd9-126">The benefits of the XPS print path are significant, and include:</span></span>  
  
- <span data-ttu-id="6edd9-127">Podpora tisku v režimu WYSIWYG</span><span class="sxs-lookup"><span data-stu-id="6edd9-127">WYSIWYG print support</span></span>  
  
- <span data-ttu-id="6edd9-128">Nativní podpora pokročilých barevných profilů, mezi které patří 32 bitů na kanál (bitů), CMYK, pojmenované barvy, n-tiskové a nativní podpora transparentnosti a přechodů.</span><span class="sxs-lookup"><span data-stu-id="6edd9-128">Native support of advanced color profiles, which include 32 bits per channel (bpc), CMYK, named-colors, n-inks, and native support of transparency and gradients.</span></span>  
  
- <span data-ttu-id="6edd9-129">Vylepšený výkon tisku pro .NET Framework i aplikace založené na Win32.</span><span class="sxs-lookup"><span data-stu-id="6edd9-129">Improved print performance for both .NET Framework and Win32 based applications.</span></span>  
  
- <span data-ttu-id="6edd9-130">Standardní formát XPS v oboru.</span><span class="sxs-lookup"><span data-stu-id="6edd9-130">Industry standard XPS format.</span></span>  
  
 <span data-ttu-id="6edd9-131">Pro základní scénáře tisku je k dispozici jednoduché a intuitivní rozhraní API s jedním vstupním bodem pro uživatelské rozhraní, konfiguraci a odeslání úlohy.</span><span class="sxs-lookup"><span data-stu-id="6edd9-131">For basic print scenarios, a simple and intuitive API is available with a single entry point for user interface, configuration and job submission.</span></span> <span data-ttu-id="6edd9-132">V případě pokročilých scénářů je přidána další podpora pro [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] přizpůsobení (nebo žádné [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] vůbec), synchronní nebo asynchronní tisk a možnosti dávkového tisku.</span><span class="sxs-lookup"><span data-stu-id="6edd9-132">For advanced scenarios, an additional support is added for [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] customization (or no [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] at all), synchronous or asynchronous printing, and batch printing capabilities.</span></span> <span data-ttu-id="6edd9-133">Obě možnosti poskytují podporu tisku v režimu úplného nebo částečného vztahu důvěryhodnosti.</span><span class="sxs-lookup"><span data-stu-id="6edd9-133">Both options provide print support in full or partial trust mode.</span></span>  
  
 <span data-ttu-id="6edd9-134">XPS je navržený s ohledem na rozšiřitelnost.</span><span class="sxs-lookup"><span data-stu-id="6edd9-134">XPS was designed with extensibility in mind.</span></span> <span data-ttu-id="6edd9-135">Pomocí architektury rozšiřitelnosti můžete funkce a možnosti Přidat do XPS modulárním způsobem.</span><span class="sxs-lookup"><span data-stu-id="6edd9-135">By using the extensibility framework, features and capabilities can be added to XPS in a modular manner.</span></span> <span data-ttu-id="6edd9-136">Mezi funkce rozšíření patří:</span><span class="sxs-lookup"><span data-stu-id="6edd9-136">Extensibility features include:</span></span>  
  
- <span data-ttu-id="6edd9-137">Tisk schématu.</span><span class="sxs-lookup"><span data-stu-id="6edd9-137">Print Schema.</span></span> <span data-ttu-id="6edd9-138">Veřejné schéma se pravidelně aktualizuje a umožňuje rychlé rozšíření možností zařízení.</span><span class="sxs-lookup"><span data-stu-id="6edd9-138">The public schema is updated regularly and enables rapid extension of device capabilities.</span></span> <span data-ttu-id="6edd9-139">(Viz **PrintTicket a PrintCapabilities** níže.)</span><span class="sxs-lookup"><span data-stu-id="6edd9-139">(See **PrintTicket and PrintCapabilities** below.)</span></span>  
  
- <span data-ttu-id="6edd9-140">Kanál rozšiřitelného filtru.</span><span class="sxs-lookup"><span data-stu-id="6edd9-140">Extensible Filter Pipeline.</span></span> <span data-ttu-id="6edd9-141">Kanál filtru XPS tiskárny (XPSDrv) byl navržen tak, aby umožňoval přímý i škálovatelný tisk dokumentů XPS.</span><span class="sxs-lookup"><span data-stu-id="6edd9-141">The XPS printer driver (XPSDrv) filter pipeline was designed to enable both direct and scalable printing of XPS documents.</span></span> <span data-ttu-id="6edd9-142">Další informace najdete v tématu [ovladače tiskáren XPSDrv](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span><span class="sxs-lookup"><span data-stu-id="6edd9-142">For more information, see [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span> 
  
### <a name="print-path-architecture"></a><span data-ttu-id="6edd9-143">Architektura cesty tisku</span><span class="sxs-lookup"><span data-stu-id="6edd9-143">Print Path Architecture</span></span>  
 <span data-ttu-id="6edd9-144">I když aplikace Win32 i .NET Framework podporují XPS, Win32 a aplikace model Windows Forms k vytvoření obsahu XPS pro ovladač tiskáren XPS (XPSDrv) používá rozhraní GDI pro převod na formát XPS.</span><span class="sxs-lookup"><span data-stu-id="6edd9-144">While both Win32 and .NET Framework applications support XPS, Win32 and Windows Forms applications use a GDI to XPS conversion in order to create XPS formatted content for the XPS printer driver (XPSDrv).</span></span> <span data-ttu-id="6edd9-145">Tyto aplikace nejsou nutné k použití tiskové cesty XPS a můžou dál používat tisk založený na rozšířených metasouborech (EMF).</span><span class="sxs-lookup"><span data-stu-id="6edd9-145">These applications are not required to use the XPS print path, and can continue to use Enhanced Metafile (EMF) based printing.</span></span> <span data-ttu-id="6edd9-146">Většina funkcí a vylepšení XPS je ale dostupná jenom pro aplikace, které cílí na tiskovou cestu XPS.</span><span class="sxs-lookup"><span data-stu-id="6edd9-146">However, most XPS features and enhancements are only available to applications that target the XPS print path.</span></span>  
  
 <span data-ttu-id="6edd9-147">Aby bylo možné povolit používání XPSDrv tiskáren v aplikacích Win32 a model Windows Forms, podporuje ovladač tiskárny XPS (XPSDrv) převod GDI do formátu XPS.</span><span class="sxs-lookup"><span data-stu-id="6edd9-147">To enable the use of XPSDrv-based printers by Win32 and Windows Forms applications, the XPS printer driver (XPSDrv) supports conversion of GDI to XPS format.</span></span> <span data-ttu-id="6edd9-148">Model XPSDrv také poskytuje převaděč pro formát XPS do formátu GDI, takže aplikace Win32 mohou tisknout dokumenty XPS.</span><span class="sxs-lookup"><span data-stu-id="6edd9-148">The XPSDrv model also provides a converter for XPS to GDI format so that Win32 applications can print XPS Documents.</span></span> <span data-ttu-id="6edd9-149">Pro aplikace WPF je převod formátu XPS na formát GDI proveden automaticky pomocí <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> a <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> metody třídy <xref:System.Windows.Xps.XpsDocumentWriter> vždy, když cílová tisková fronta operace zápisu nemá ovladač XPSDrv.</span><span class="sxs-lookup"><span data-stu-id="6edd9-149">For WPF applications, conversion of XPS to GDI format is done automatically by the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class whenever the target print queue of the write operation does not have an XPSDrv driver.</span></span> <span data-ttu-id="6edd9-150">(Model Windows Forms aplikace nemůžou tisknout dokumenty XPS.)</span><span class="sxs-lookup"><span data-stu-id="6edd9-150">(Windows Forms applications cannot print XPS Documents.)</span></span>  
  
 <span data-ttu-id="6edd9-151">Následující obrázek znázorňuje podsystém tisku a definuje části poskytované společností Microsoft a části definované výrobci softwaru a hardwaru:</span><span class="sxs-lookup"><span data-stu-id="6edd9-151">The following illustration depicts the print subsystem and defines the portions provided by Microsoft, and the portions defined by software and hardware vendors:</span></span>  
  
 ![Snímek obrazovky ukazuje tiskový systém XPS.](./media/printing-overview/xml-paper-specification-print-system.png)  
  
### <a name="basic-xps-printing"></a><span data-ttu-id="6edd9-153">Základní tisk XPS</span><span class="sxs-lookup"><span data-stu-id="6edd9-153">Basic XPS Printing</span></span>  
 <span data-ttu-id="6edd9-154">WPF definuje základní i pokročilé rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="6edd9-154">WPF defines both a basic and advanced API.</span></span> <span data-ttu-id="6edd9-155">Pro aplikace, které nevyžadují rozsáhlé přizpůsobení tisku nebo přístup k kompletní sadě funkcí XPS, je k dispozici podpora základní tiskárny.</span><span class="sxs-lookup"><span data-stu-id="6edd9-155">For those applications that do not require extensive print customization or access to the complete XPS feature set, basic print support is available.</span></span> <span data-ttu-id="6edd9-156">Základní podpora tisku se zveřejňuje prostřednictvím ovládacího prvku tiskového dialogu, který vyžaduje minimální konfiguraci a nabízí známý [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6edd9-156">Basic print support is exposed through a print dialog control that requires minimal configuration and features a familiar [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="6edd9-157">K dispozici je mnoho funkcí XPS pomocí tohoto zjednodušeného tiskového modelu.</span><span class="sxs-lookup"><span data-stu-id="6edd9-157">Many XPS features are available using this simplified print model.</span></span>  
  
#### <a name="printdialog"></a><span data-ttu-id="6edd9-158">PrintDialog</span><span class="sxs-lookup"><span data-stu-id="6edd9-158">PrintDialog</span></span>  
 <span data-ttu-id="6edd9-159">Ovládací prvek <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> poskytuje jeden vstupní bod pro [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], konfiguraci a odeslání úlohy ve formátu XPS.</span><span class="sxs-lookup"><span data-stu-id="6edd9-159">The <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> control provides a single entry point for [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuration, and XPS job submission.</span></span> <span data-ttu-id="6edd9-160">Informace o vytvoření instance a použití ovládacího prvku naleznete v tématu [vyvolání dialogového okna pro tisk](how-to-invoke-a-print-dialog.md).</span><span class="sxs-lookup"><span data-stu-id="6edd9-160">For information about how to instantiate and use the control, see [Invoke a Print Dialog](how-to-invoke-a-print-dialog.md).</span></span>  
  
### <a name="advanced-xps-printing"></a><span data-ttu-id="6edd9-161">Pokročilý tisk do XPS</span><span class="sxs-lookup"><span data-stu-id="6edd9-161">Advanced XPS Printing</span></span>  
 <span data-ttu-id="6edd9-162">Pro přístup k kompletní sadě funkcí XPS se musí použít pokročilé rozhraní API pro tisk.</span><span class="sxs-lookup"><span data-stu-id="6edd9-162">To access the complete set of XPS features, the advanced print API must be used.</span></span> <span data-ttu-id="6edd9-163">Několik relevantních rozhraní API je podrobněji popsáno níže.</span><span class="sxs-lookup"><span data-stu-id="6edd9-163">Several relevant API are described in greater detail below.</span></span> <span data-ttu-id="6edd9-164">Úplný seznam rozhraní API pro tisk ve formátu XPS najdete v odkazech na obor názvů <xref:System.Windows.Xps> a <xref:System.Printing>.</span><span class="sxs-lookup"><span data-stu-id="6edd9-164">For a complete list of XPS print path APIs, see the <xref:System.Windows.Xps> and <xref:System.Printing> namespace references.</span></span>  
  
#### <a name="printticket-and-printcapabilities"></a><span data-ttu-id="6edd9-165">PrintTicket a PrintCapabilities</span><span class="sxs-lookup"><span data-stu-id="6edd9-165">PrintTicket and PrintCapabilities</span></span>  
 <span data-ttu-id="6edd9-166">Třídy <xref:System.Printing.PrintTicket> a <xref:System.Printing.PrintCapabilities> jsou základem pokročilých funkcí XPS.</span><span class="sxs-lookup"><span data-stu-id="6edd9-166">The <xref:System.Printing.PrintTicket> and <xref:System.Printing.PrintCapabilities> classes are the foundation of the advanced XPS features.</span></span> <span data-ttu-id="6edd9-167">Oba typy objektů jsou XML formátované struktury funkcí orientovaných na tisk, jako jsou kolace, oboustranný tisk, sešívání atd. Tyto struktury jsou definovány schématem tisku.</span><span class="sxs-lookup"><span data-stu-id="6edd9-167">Both types of objects are XML formatted structures of print-oriented features such as collation, two-sided printing, stapling, etc. These structures are defined by the print schema.</span></span> <span data-ttu-id="6edd9-168"><xref:System.Printing.PrintTicket> instruuje tiskárnu, jak zpracovat tiskovou úlohu.</span><span class="sxs-lookup"><span data-stu-id="6edd9-168">A <xref:System.Printing.PrintTicket> instructs a printer how to process a print job.</span></span> <span data-ttu-id="6edd9-169">Třída <xref:System.Printing.PrintCapabilities> definuje možnosti tiskárny.</span><span class="sxs-lookup"><span data-stu-id="6edd9-169">The <xref:System.Printing.PrintCapabilities> class defines the capabilities of a printer.</span></span> <span data-ttu-id="6edd9-170">Díky dotazování na možnosti tiskárny je možné vytvořit <xref:System.Printing.PrintTicket>, která plně využívá podporované funkce tiskárny.</span><span class="sxs-lookup"><span data-stu-id="6edd9-170">By querying the capabilities of a printer, a <xref:System.Printing.PrintTicket> can be created that takes full advantage of a printer's supported features.</span></span> <span data-ttu-id="6edd9-171">Podobně je možné vyhnout se nepodporovaným funkcím.</span><span class="sxs-lookup"><span data-stu-id="6edd9-171">Similarly, unsupported features can be avoided.</span></span>  
  
 <span data-ttu-id="6edd9-172">Následující příklad ukazuje, jak zadat dotaz na <xref:System.Printing.PrintCapabilities> tiskárny a vytvořit <xref:System.Printing.PrintTicket> pomocí kódu.</span><span class="sxs-lookup"><span data-stu-id="6edd9-172">The following example demonstrates how to query the <xref:System.Printing.PrintCapabilities> of a printer and create a <xref:System.Printing.PrintTicket> using code.</span></span>  
  
 [!code-cpp[xpscreate#PrinterCapabilities](~/samples/snippets/cpp/VS_Snippets_Wpf/XpsCreate/CPP/XpsCreate.cpp#printercapabilities)]
 [!code-csharp[xpscreate#PrinterCapabilities](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsCreate/CSharp/XpsCreate.cs#printercapabilities)]
 [!code-vb[xpscreate#PrinterCapabilities](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsCreate/visualbasic/xpscreate.vb#printercapabilities)]  
  
#### <a name="printserver-and-printqueue"></a><span data-ttu-id="6edd9-173">Tiskový_server a tisková fronta</span><span class="sxs-lookup"><span data-stu-id="6edd9-173">PrintServer and PrintQueue</span></span>  
 <span data-ttu-id="6edd9-174">Třída <xref:System.Printing.PrintServer> představuje tiskový server sítě a třída <xref:System.Printing.PrintQueue> představuje tiskárnu a výstupní frontu úloh, která je k ní přidružená.</span><span class="sxs-lookup"><span data-stu-id="6edd9-174">The <xref:System.Printing.PrintServer> class represents a network print server and the <xref:System.Printing.PrintQueue> class represents a printer and the output job queue associated with it.</span></span> <span data-ttu-id="6edd9-175">Tato rozhraní API dohromady umožňují pokročilou správu tiskových úloh serveru.</span><span class="sxs-lookup"><span data-stu-id="6edd9-175">Together, these APIs allow advanced management of a server's print jobs.</span></span> <span data-ttu-id="6edd9-176">Pro správu <xref:System.Printing.PrintQueue>se používá <xref:System.Printing.PrintServer>nebo jedna z jeho odvozených tříd.</span><span class="sxs-lookup"><span data-stu-id="6edd9-176">A <xref:System.Printing.PrintServer>, or one of its derived classes, is used to manage a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="6edd9-177">Metoda <xref:System.Printing.PrintQueue.AddJob%2A> slouží k vložení nové tiskové úlohy do fronty.</span><span class="sxs-lookup"><span data-stu-id="6edd9-177">The <xref:System.Printing.PrintQueue.AddJob%2A> method is used to insert a new print job into the queue.</span></span>  
  
 <span data-ttu-id="6edd9-178">Následující příklad ukazuje, jak vytvořit <xref:System.Printing.LocalPrintServer> a přistupovat ke svému výchozímu <xref:System.Printing.PrintQueue> pomocí kódu.</span><span class="sxs-lookup"><span data-stu-id="6edd9-178">The following example demonstrates how to create a <xref:System.Printing.LocalPrintServer> and access its default <xref:System.Printing.PrintQueue> by using code.</span></span>  
  
 [!code-csharp[xpsprint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[xpsprint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
#### <a name="xpsdocumentwriter"></a><span data-ttu-id="6edd9-179">XpsDocumentWriter</span><span class="sxs-lookup"><span data-stu-id="6edd9-179">XpsDocumentWriter</span></span>  
 <span data-ttu-id="6edd9-180"><xref:System.Windows.Xps.XpsDocumentWriter>s mnoha metodami <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> a <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> se používá k zápisu dokumentů XPS do <xref:System.Printing.PrintQueue>.</span><span class="sxs-lookup"><span data-stu-id="6edd9-180">An <xref:System.Windows.Xps.XpsDocumentWriter>, with its many the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods, is used to write XPS documents to a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="6edd9-181">Například metoda <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> se používá pro výstup dokumentu XPS a <xref:System.Printing.PrintTicket> synchronně.</span><span class="sxs-lookup"><span data-stu-id="6edd9-181">For example, the <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> synchronously.</span></span> <span data-ttu-id="6edd9-182">Metoda <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> se používá pro výstup dokumentu XPS a <xref:System.Printing.PrintTicket> asynchronně.</span><span class="sxs-lookup"><span data-stu-id="6edd9-182">The <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> asynchronously.</span></span>  
  
 <span data-ttu-id="6edd9-183">Následující příklad ukazuje, jak vytvořit <xref:System.Windows.Xps.XpsDocumentWriter> pomocí kódu.</span><span class="sxs-lookup"><span data-stu-id="6edd9-183">The following example demonstrates how to create an <xref:System.Windows.Xps.XpsDocumentWriter> using code.</span></span>  
  
 [!code-csharp[XpsPrint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[XpsPrint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
 <span data-ttu-id="6edd9-184">Metody <xref:System.Printing.PrintQueue.AddJob%2A> také poskytují způsoby tisku.</span><span class="sxs-lookup"><span data-stu-id="6edd9-184">The <xref:System.Printing.PrintQueue.AddJob%2A> methods also provide ways to print.</span></span> <span data-ttu-id="6edd9-185">Viz [programové tisk souborů XPS](how-to-programmatically-print-xps-files.md).</span><span class="sxs-lookup"><span data-stu-id="6edd9-185">See [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="6edd9-186">, kde najdete podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="6edd9-186">for details.</span></span>  
  
<a name="GDI_Print_Path_intro"></a>   
## <a name="gdi-print-path"></a><span data-ttu-id="6edd9-187">Cesta pro tisk GDI</span><span class="sxs-lookup"><span data-stu-id="6edd9-187">GDI Print Path</span></span>  
 <span data-ttu-id="6edd9-188">I když aplikace WPF nativně podporují tiskovou cestu XPS, Win32 a model Windows Forms aplikace mohou také využívat některé funkce XPS.</span><span class="sxs-lookup"><span data-stu-id="6edd9-188">While WPF applications natively support the XPS print path, Win32 and Windows Forms applications can also take advantage of some XPS features.</span></span> <span data-ttu-id="6edd9-189">Ovladač tiskárny XPS (XPSDrv) může převést výstup založený na GDI na formát XPS.</span><span class="sxs-lookup"><span data-stu-id="6edd9-189">The XPS printer driver (XPSDrv) can convert GDI based output to XPS format.</span></span> <span data-ttu-id="6edd9-190">V případě pokročilých scénářů se vlastní konverze obsahu podporuje pomocí [převaděče dokumentů Microsoft XPS (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-).</span><span class="sxs-lookup"><span data-stu-id="6edd9-190">For advanced scenarios, custom conversion of content is supported using the [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-).</span></span> <span data-ttu-id="6edd9-191">Podobně aplikace WPF mohou také výstup do cesty tisku GDI voláním jedné z <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> nebo <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> metod třídy <xref:System.Windows.Xps.XpsDocumentWriter> a určením XpsDrv tiskárny jako cílové tiskové fronty.</span><span class="sxs-lookup"><span data-stu-id="6edd9-191">Similarly, WPF applications can also output to the GDI print path by calling one of the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> or <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class and designating a non-XpsDrv printer as the target print queue.</span></span>  

<span data-ttu-id="6edd9-192">U aplikací, které nevyžadují funkce a podporu XPS, zůstane aktuální cesta tisku GDI beze změny.</span><span class="sxs-lookup"><span data-stu-id="6edd9-192">For applications that do not require XPS functionality or support, the current GDI print path remains unchanged.</span></span>  
  
- <span data-ttu-id="6edd9-193">Další referenční materiály k tiskové cestě GDI a různým možnostem převodu XPS najdete v tématu [MXDC (Microsoft XPS Document Converter)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) a [XPSDrv ovladače tiskárny](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span><span class="sxs-lookup"><span data-stu-id="6edd9-193">For additional reference material on the GDI print path and the various XPS conversion options, see [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) and [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>  
  
<a name="XPS_Driver_Model_intro"></a>   
## <a name="xpsdrv-driver-model"></a><span data-ttu-id="6edd9-194">Model ovladače XPSDrv</span><span class="sxs-lookup"><span data-stu-id="6edd9-194">XPSDrv Driver Model</span></span>  
 <span data-ttu-id="6edd9-195">Tisková cesta XPS zlepšuje efektivitu zařazování pomocí XPS jako nativního formátu zařazování tisku při tisku na tiskárnu nebo ovladač s podporou standardu XPS.</span><span class="sxs-lookup"><span data-stu-id="6edd9-195">The XPS print path improves spooler efficiency by using XPS as the native print spool format when printing to an XPS -enabled printer or driver.</span></span> <span data-ttu-id="6edd9-196">Zjednodušený proces zařazování eliminuje nutnost vygenerovat soubor mezilehlého zařazování, jako je například datový soubor EMF, před zařazením dokumentu do fronty.</span><span class="sxs-lookup"><span data-stu-id="6edd9-196">The simplified spooling process eliminates the need to generate an intermediate spool file, such as an EMF data file, before the document is spooled.</span></span> <span data-ttu-id="6edd9-197">V menších velikostech souborů zařazování může tisknout tiskovou cestu XPS snížit zatížení sítě a zvýšit výkon tisku.</span><span class="sxs-lookup"><span data-stu-id="6edd9-197">Through smaller spool file sizes, the XPS print path can reduce network traffic and improve print performance.</span></span>  
  
 <span data-ttu-id="6edd9-198">EMF je zavřený formát, který představuje výstup aplikace jako řadu volání rozhraní GDI pro vykreslování služeb.</span><span class="sxs-lookup"><span data-stu-id="6edd9-198">EMF is a closed format that represents application output as a series of calls into GDI for rendering services.</span></span> <span data-ttu-id="6edd9-199">Na rozdíl od formátu EMF představuje formát fronty XPS skutečný dokument bez nutnosti dalšího výkladu při výstupu do ovladače tiskárny založeného na formátu XPS (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="6edd9-199">Unlike EMF, the XPS spool format represents the actual document without requiring further interpretation when output to an XPS-based printer driver (XPSDrv).</span></span> <span data-ttu-id="6edd9-200">Ovladače mohou pracovat přímo s daty ve formátu.</span><span class="sxs-lookup"><span data-stu-id="6edd9-200">The drivers can operate directly on the data in the format.</span></span> <span data-ttu-id="6edd9-201">Tato funkce eliminuje, že při použití souborů EMF a ovladačů tiskárny založených na rozhraní GDI se vyžadují převody datových prostorů a barev.</span><span class="sxs-lookup"><span data-stu-id="6edd9-201">This capability eliminates the data and color space conversions required when you use EMF files and GDI-based print drivers.</span></span>  
  
 <span data-ttu-id="6edd9-202">Velikosti souborů zařazování se obvykle zmenší při použití dokumentů XPS, které cílí na ovladač tiskárny XPS (XPSDrv), v porovnání s jejich ekvivalenty EMF; Existují však výjimky:</span><span class="sxs-lookup"><span data-stu-id="6edd9-202">Spool file sizes are usually reduced when you use XPS Documents that target an XPS printer driver (XPSDrv) compared with their EMF equivalents; however, there are exceptions:</span></span>  
  
- <span data-ttu-id="6edd9-203">Vektorová grafika, která je velmi složitá nebo neefektivně vytvořená, může být větší než bitmapová verze stejného obrázku.</span><span class="sxs-lookup"><span data-stu-id="6edd9-203">A vector graphic that is very complex, multi-layered, or inefficiently written can be larger than a bitmapped version of the same graphic.</span></span>  
  
- <span data-ttu-id="6edd9-204">Pro účely zobrazení obrazovky soubory XPS vkládají písma zařízení a také písma založená na počítačích. vzhledem k tomu, že soubory pro zařazování GDI nevkládají písma zařízení.</span><span class="sxs-lookup"><span data-stu-id="6edd9-204">For screen display purposes, XPS files embed device fonts as well as computer-based fonts; whereas GDI spool files do not embed device fonts.</span></span> <span data-ttu-id="6edd9-205">Ale oba druhy písem jsou subsetted (viz níže) a ovladače tiskárny mohou odebrat písma zařízení před tím, než se soubor přenáší do tiskárny.</span><span class="sxs-lookup"><span data-stu-id="6edd9-205">But both kinds of fonts are subsetted (see below) and printer drivers can remove the device fonts before transmitting the file to the printer.</span></span>  
  
 <span data-ttu-id="6edd9-206">Zmenšení velikosti fronty se provádí prostřednictvím několika mechanismů:</span><span class="sxs-lookup"><span data-stu-id="6edd9-206">Spool size reduction is performed through several mechanisms:</span></span>  
  
- <span data-ttu-id="6edd9-207">**PodNastavení písma**</span><span class="sxs-lookup"><span data-stu-id="6edd9-207">**Font subsetting**.</span></span> <span data-ttu-id="6edd9-208">V souboru XPS jsou uloženy pouze znaky používané v rámci samotného dokumentu.</span><span class="sxs-lookup"><span data-stu-id="6edd9-208">Only characters used within the actual document are stored in the XPS file.</span></span>  
  
- <span data-ttu-id="6edd9-209">**Podpora pokročilých grafických prvků**</span><span class="sxs-lookup"><span data-stu-id="6edd9-209">**Advanced Graphics Support**.</span></span> <span data-ttu-id="6edd9-210">Nativní podpora pro základní prvky transparentnosti a přechodu zabraňuje rastrování obsahu v dokumentu XPS.</span><span class="sxs-lookup"><span data-stu-id="6edd9-210">Native support for transparency and gradient primitives avoids rasterization of content in the XPS Document.</span></span>  
  
- <span data-ttu-id="6edd9-211">**Identifikace běžných prostředků**</span><span class="sxs-lookup"><span data-stu-id="6edd9-211">**Identification of common resources**.</span></span> <span data-ttu-id="6edd9-212">Prostředky, které se používají několikrát (například obrázek reprezentující logo společnosti), se považují za sdílené prostředky a načtou se jenom jednou.</span><span class="sxs-lookup"><span data-stu-id="6edd9-212">Resources that are used multiple times (such as an image that represents a corporate logo) are treated as shared resources and are loaded only once.</span></span>  
  
- <span data-ttu-id="6edd9-213">**Komprese ZIP**.</span><span class="sxs-lookup"><span data-stu-id="6edd9-213">**ZIP compression**.</span></span> <span data-ttu-id="6edd9-214">Všechny dokumenty XPS používají kompresi ZIP.</span><span class="sxs-lookup"><span data-stu-id="6edd9-214">All XPS documents use ZIP compression.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6edd9-215">Viz také:</span><span class="sxs-lookup"><span data-stu-id="6edd9-215">See also</span></span>

- <xref:System.Windows.Controls.PrintDialog>
- <xref:System.Windows.Xps.XpsDocumentWriter>
- <xref:System.Windows.Xps.Packaging.XpsDocument>
- <xref:System.Printing.PrintTicket>
- <xref:System.Printing.PrintCapabilities>
- <xref:System.Printing.PrintServer>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="6edd9-216">Postupy</span><span class="sxs-lookup"><span data-stu-id="6edd9-216">How-to Topics</span></span>](printing-how-to-topics.md)
- [<span data-ttu-id="6edd9-217">Dokumenty v platformě WPF</span><span class="sxs-lookup"><span data-stu-id="6edd9-217">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="6edd9-218">Dokumenty XPS</span><span class="sxs-lookup"><span data-stu-id="6edd9-218">XPS Documents</span></span>](/windows/desktop/printdocs/documents)
- [<span data-ttu-id="6edd9-219">Serializace a úložiště dokumentů</span><span class="sxs-lookup"><span data-stu-id="6edd9-219">Document Serialization and Storage</span></span>](document-serialization-and-storage.md)
- [<span data-ttu-id="6edd9-220">Převaděč dokumentů Microsoft XPS (MXDC)</span><span class="sxs-lookup"><span data-stu-id="6edd9-220">Microsoft XPS Document Converter (MXDC)</span></span>](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)
