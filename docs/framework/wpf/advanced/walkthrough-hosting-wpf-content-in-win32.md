---
title: Hostování obsahu WPF v systému Win32
titleSuffix: ''
ms.date: 03/30/2017
dev_langs:
- cpp
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
ms.assetid: 38ce284a-4303-46dd-b699-c9365b22a7dc
ms.openlocfilehash: ff95b330ff67e916a4d27ef841e757998d847c8b
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/24/2020
ms.locfileid: "76735320"
---
# <a name="walkthrough-hosting-wpf-content-in-win32"></a><span data-ttu-id="e34b5-102">Návod: Hostování obsahu WPF v Win32</span><span class="sxs-lookup"><span data-stu-id="e34b5-102">Walkthrough: Hosting WPF Content in Win32</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] <span data-ttu-id="e34b5-103">poskytuje bohatou prostředí pro vytváření aplikací.</span><span class="sxs-lookup"><span data-stu-id="e34b5-103">provides a rich environment for creating applications.</span></span> <span data-ttu-id="e34b5-104">Nicméně pokud máte významnou investici do kódu Win32, může být efektivnější přidat funkce [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] do vaší aplikace, a ne přepsat původní kód.</span><span class="sxs-lookup"><span data-stu-id="e34b5-104">However, when you have a substantial investment in Win32 code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewriting your original code.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="e34b5-105">poskytuje jednoduchý mechanismus pro hostování [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu v okně Win32.</span><span class="sxs-lookup"><span data-stu-id="e34b5-105">provides a straightforward mechanism for hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a Win32 window.</span></span>  
  
 <span data-ttu-id="e34b5-106">V tomto kurzu se dozvíte, jak napsat ukázkovou aplikaci, která [hostuje obsah WPF v okně ukázek Win32](https://go.microsoft.com/fwlink/?LinkID=160004), který hostuje [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu v okně Win32.</span><span class="sxs-lookup"><span data-stu-id="e34b5-106">This tutorial describes how to write a sample application, [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a Win32 window.</span></span> <span data-ttu-id="e34b5-107">Tuto ukázku můžete v případě, že chcete hostovat jakékoli okno Win32, roztáhnout.</span><span class="sxs-lookup"><span data-stu-id="e34b5-107">You can extend this sample to host any Win32 window.</span></span> <span data-ttu-id="e34b5-108">Vzhledem k tomu, že zahrnuje kombinování spravovaného a nespravovaného C++kódu, aplikace je zapsána v/CLI.</span><span class="sxs-lookup"><span data-stu-id="e34b5-108">Because it involves mixing managed and unmanaged code, the application is written in C++/CLI.</span></span>  

<a name="requirements"></a>   
## <a name="requirements"></a><span data-ttu-id="e34b5-109">Požadavky</span><span class="sxs-lookup"><span data-stu-id="e34b5-109">Requirements</span></span>  
 <span data-ttu-id="e34b5-110">V tomto kurzu se předpokládá základní znalost jak pro [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], tak pro programování v prostředí Win32.</span><span class="sxs-lookup"><span data-stu-id="e34b5-110">This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and Win32 programming.</span></span> <span data-ttu-id="e34b5-111">Základní Úvod do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programování naleznete v tématu [Začínáme](../getting-started/index.md).</span><span class="sxs-lookup"><span data-stu-id="e34b5-111">For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Getting Started](../getting-started/index.md).</span></span> <span data-ttu-id="e34b5-112">Pro Úvod do programování v systému Win32 byste měli odkazovat na některý z mnoha knih v předmětu, zejména v *oknech programování* podle Charles Petzold.</span><span class="sxs-lookup"><span data-stu-id="e34b5-112">For an introduction to Win32 programming, you should reference any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold.</span></span>  
  
 <span data-ttu-id="e34b5-113">Vzhledem k tomu, že je ukázka, která doprovází C++tento kurz, implementována ve verzi/CLI, v tomto C++ kurzu se předpokládá znalost použití nástroje k programování rozhraní Windows API a porozumění programování spravovaného kódu.</span><span class="sxs-lookup"><span data-stu-id="e34b5-113">Because the sample that accompanies this tutorial is implemented in C++/CLI, this tutorial assumes familiarity with the use of C++ to program the Windows API plus an understanding of managed code programming.</span></span> <span data-ttu-id="e34b5-114">Znalost C++/CLI je užitečná, ale není nezbytná.</span><span class="sxs-lookup"><span data-stu-id="e34b5-114">Familiarity with C++/CLI is helpful but not essential.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="e34b5-115">Tento kurz obsahuje několik příkladů kódu z přidruženého vzorku.</span><span class="sxs-lookup"><span data-stu-id="e34b5-115">This tutorial includes a number of code examples from the associated sample.</span></span> <span data-ttu-id="e34b5-116">Pro čitelnost ale nezahrnuje kompletní vzorový kód.</span><span class="sxs-lookup"><span data-stu-id="e34b5-116">However, for readability, it does not include the complete sample code.</span></span> <span data-ttu-id="e34b5-117">Úplný vzorový kód naleznete v tématu [hostování obsahu WPF v ukázce okna Win32](https://go.microsoft.com/fwlink/?LinkID=160004).</span><span class="sxs-lookup"><span data-stu-id="e34b5-117">For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004).</span></span>  
  
<a name="basic_procedure"></a>   
## <a name="the-basic-procedure"></a><span data-ttu-id="e34b5-118">Základní postup</span><span class="sxs-lookup"><span data-stu-id="e34b5-118">The Basic Procedure</span></span>  
 <span data-ttu-id="e34b5-119">Tato část popisuje základní postup, který slouží k hostování [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu v okně Win32.</span><span class="sxs-lookup"><span data-stu-id="e34b5-119">This section outlines the basic procedure you use to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a Win32 window.</span></span> <span data-ttu-id="e34b5-120">Zbývající části obsahují podrobné informace o jednotlivých krocích.</span><span class="sxs-lookup"><span data-stu-id="e34b5-120">The remaining sections explain the details of each step.</span></span>  
  
 <span data-ttu-id="e34b5-121">Klíč pro hostování [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu v okně Win32 je třída <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="e34b5-121">The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content on a Win32 window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="e34b5-122">Tato třída zalomí obsah [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] v okně Win32, což umožňuje jeho začlenění do [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] jako podřízené okno.</span><span class="sxs-lookup"><span data-stu-id="e34b5-122">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a Win32 window, allowing it to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="e34b5-123">Následující postup kombinuje Win32 a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] v jediné aplikaci.</span><span class="sxs-lookup"><span data-stu-id="e34b5-123">The following approach combines the Win32 and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1. <span data-ttu-id="e34b5-124">Implementujte svůj [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah jako spravovanou třídu.</span><span class="sxs-lookup"><span data-stu-id="e34b5-124">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a managed class.</span></span>  
  
2. <span data-ttu-id="e34b5-125">Implementace aplikace pro Windows pomocí C++/CLI.</span><span class="sxs-lookup"><span data-stu-id="e34b5-125">Implement a Windows application with C++/CLI.</span></span> <span data-ttu-id="e34b5-126">Pokud začínáte s existující aplikací a nespravovaným C++ kódem, můžete ji obvykle povolit pro volání spravovaného kódu změnou nastavení projektu tak, aby obsahovala příznak kompilátoru `/clr`.</span><span class="sxs-lookup"><span data-stu-id="e34b5-126">If you are starting with an existing application and unmanaged C++ code, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag.</span></span>  
  
3. <span data-ttu-id="e34b5-127">Nastavte model dělení na vlákna (STA) s jedním vláknem.</span><span class="sxs-lookup"><span data-stu-id="e34b5-127">Set the threading model to single-threaded apartment (STA).</span></span>  
  
4. <span data-ttu-id="e34b5-128">Zpracujte oznámení [WM_CREATE](/windows/desktop/winmsg/wm-create)v postupu okna a proveďte následující kroky:</span><span class="sxs-lookup"><span data-stu-id="e34b5-128">Handle the [WM_CREATE](/windows/desktop/winmsg/wm-create)notification in your window procedure and do the following:</span></span>  
  
    1. <span data-ttu-id="e34b5-129">Vytvořte nový objekt <xref:System.Windows.Interop.HwndSource> s nadřazeným oknem jako jeho parametr `parent`.</span><span class="sxs-lookup"><span data-stu-id="e34b5-129">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window as its `parent` parameter.</span></span>  
  
    2. <span data-ttu-id="e34b5-130">Vytvořte instanci třídy obsahu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e34b5-130">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3. <span data-ttu-id="e34b5-131">Přiřaďte odkaz na objekt [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu na vlastnost <xref:System.Windows.Interop.HwndSource.RootVisual%2A> <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="e34b5-131">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
    4. <span data-ttu-id="e34b5-132">Získat HWND pro obsah</span><span class="sxs-lookup"><span data-stu-id="e34b5-132">Get the HWND for the content.</span></span> <span data-ttu-id="e34b5-133">Vlastnost <xref:System.Windows.Interop.HwndSource.Handle%2A> objektu <xref:System.Windows.Interop.HwndSource> obsahuje popisovač okna (HWND).</span><span class="sxs-lookup"><span data-stu-id="e34b5-133">The <xref:System.Windows.Interop.HwndSource.Handle%2A> property of the <xref:System.Windows.Interop.HwndSource> object contains the window handle (HWND).</span></span> <span data-ttu-id="e34b5-134">Chcete-li získat HWND, který můžete použít v nespravované části aplikace, přetypování `Handle.ToPointer()` na HWND.</span><span class="sxs-lookup"><span data-stu-id="e34b5-134">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
5. <span data-ttu-id="e34b5-135">Implementujte spravovanou třídu, která obsahuje statické pole pro uložení odkazu na váš [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah.</span><span class="sxs-lookup"><span data-stu-id="e34b5-135">Implement a managed class that contains a static field to hold a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="e34b5-136">Tato třída umožňuje získat odkaz na obsah [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] z kódu Win32.</span><span class="sxs-lookup"><span data-stu-id="e34b5-136">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from your Win32 code.</span></span>  
  
6. <span data-ttu-id="e34b5-137">Přiřaďte obsah [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] statickému poli.</span><span class="sxs-lookup"><span data-stu-id="e34b5-137">Assign the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the static field.</span></span>  
  
7. <span data-ttu-id="e34b5-138">Příjem oznámení z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu připojením obslužné rutiny k jedné nebo více událostem [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e34b5-138">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events.</span></span>  
  
8. <span data-ttu-id="e34b5-139">Komunikujte s obsahem [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] pomocí odkazu, který jste uložili do statického pole pro nastavení vlastností a tak dále.</span><span class="sxs-lookup"><span data-stu-id="e34b5-139">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by using the reference that you stored in the static field to set properties, and so on.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="e34b5-140">K implementaci [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu můžete použít taky [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e34b5-140">You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="e34b5-141">Bude však nutné jej zkompilovat samostatně jako dynamickou knihovnu (DLL) a odkazovat na tuto knihovnu DLL z aplikace Win32.</span><span class="sxs-lookup"><span data-stu-id="e34b5-141">However, you will have to compile it separately as a dynamic-link library (DLL) and reference that DLL from your Win32 application.</span></span> <span data-ttu-id="e34b5-142">Zbytek postupu je podobný jako uvedený výše.</span><span class="sxs-lookup"><span data-stu-id="e34b5-142">The remainder of the procedure is similar to that outlined above.</span></span>

<a name="implementing_the_application"></a>
## <a name="implementing-the-host-application"></a><span data-ttu-id="e34b5-143">Implementace hostitelské aplikace</span><span class="sxs-lookup"><span data-stu-id="e34b5-143">Implementing the Host Application</span></span>
 <span data-ttu-id="e34b5-144">Tato část popisuje, jak hostovat obsah [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] v základní aplikaci Win32.</span><span class="sxs-lookup"><span data-stu-id="e34b5-144">This section describes how to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a basic Win32 application.</span></span> <span data-ttu-id="e34b5-145">Samotný obsah je implementován v C++/CLI jako spravovaná třída.</span><span class="sxs-lookup"><span data-stu-id="e34b5-145">The content itself is implemented in C++/CLI as a managed class.</span></span> <span data-ttu-id="e34b5-146">Ve většině případů je [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programování jednoduché.</span><span class="sxs-lookup"><span data-stu-id="e34b5-146">For the most part, it is straightforward [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming.</span></span> <span data-ttu-id="e34b5-147">Klíčové aspekty implementace obsahu jsou popsány v tématu [implementace obsahu WPF](#implementing_the_wpf_page).</span><span class="sxs-lookup"><span data-stu-id="e34b5-147">The key aspects of the content implementation are discussed in [Implementing the WPF Content](#implementing_the_wpf_page).</span></span>

- [<span data-ttu-id="e34b5-148">Základní aplikace</span><span class="sxs-lookup"><span data-stu-id="e34b5-148">The Basic Application</span></span>](#the_basic_application)

- [<span data-ttu-id="e34b5-149">Hostování obsahu WPF</span><span class="sxs-lookup"><span data-stu-id="e34b5-149">Hosting the WPF Content</span></span>](#hosting_the_wpf_page)

- [<span data-ttu-id="e34b5-150">Držení odkazu na obsah WPF</span><span class="sxs-lookup"><span data-stu-id="e34b5-150">Holding a Reference to the WPF Content</span></span>](#holding_a_reference)

- [<span data-ttu-id="e34b5-151">Komunikace s obsahem WPF</span><span class="sxs-lookup"><span data-stu-id="e34b5-151">Communicating with the WPF Content</span></span>](#communicating_with_the_page)

<a name="the_basic_application"></a>
### <a name="the-basic-application"></a><span data-ttu-id="e34b5-152">Základní aplikace</span><span class="sxs-lookup"><span data-stu-id="e34b5-152">The Basic Application</span></span>
 <span data-ttu-id="e34b5-153">Výchozím bodem pro hostitelskou aplikaci bylo vytvoření šablony sady Visual Studio 2005.</span><span class="sxs-lookup"><span data-stu-id="e34b5-153">The starting point for the host application was to create a Visual Studio 2005 template.</span></span>

1. <span data-ttu-id="e34b5-154">Otevřete Visual Studio 2005 a v nabídce **soubor** vyberte **Nový projekt** .</span><span class="sxs-lookup"><span data-stu-id="e34b5-154">Open Visual Studio 2005, and select **New Project** from the **File** menu.</span></span>

2. <span data-ttu-id="e34b5-155">V seznamu typů vizuálních C++ projektů vyberte Win32.</span><span class="sxs-lookup"><span data-stu-id="e34b5-155">Select **Win32** from the list of Visual C++ project types.</span></span> <span data-ttu-id="e34b5-156">Pokud váš výchozí jazyk není C++, najdete tyto typy projektů v části **jiné jazyky**.</span><span class="sxs-lookup"><span data-stu-id="e34b5-156">If your default language is not C++, you will find these project types under **Other Languages**.</span></span>

3. <span data-ttu-id="e34b5-157">Vyberte šablonu **projektu Win32** , přiřaďte k projektu název a kliknutím na tlačítko **OK** spusťte **Průvodce aplikací Win32**.</span><span class="sxs-lookup"><span data-stu-id="e34b5-157">Select a **Win32 Project** template, assign a name to the project and click **OK** to launch the **Win32 Application Wizard**.</span></span>

4. <span data-ttu-id="e34b5-158">Přijměte výchozí nastavení průvodce a kliknutím na tlačítko **Dokončit** spusťte projekt.</span><span class="sxs-lookup"><span data-stu-id="e34b5-158">Accept the wizard's default settings and click **Finish** to start the project.</span></span>

 <span data-ttu-id="e34b5-159">Šablona vytvoří základní aplikaci Win32, včetně:</span><span class="sxs-lookup"><span data-stu-id="e34b5-159">The template creates a basic Win32 application, including:</span></span>

- <span data-ttu-id="e34b5-160">Vstupní bod pro aplikaci.</span><span class="sxs-lookup"><span data-stu-id="e34b5-160">An entry point for the application.</span></span>

- <span data-ttu-id="e34b5-161">Okno s přiřazenou procedurou okna (WndProc).</span><span class="sxs-lookup"><span data-stu-id="e34b5-161">A window, with an associated window procedure (WndProc).</span></span>

- <span data-ttu-id="e34b5-162">Nabídka se záhlavími **souborů** a **nápovědě**</span><span class="sxs-lookup"><span data-stu-id="e34b5-162">A menu with **File** and **Help** headings.</span></span> <span data-ttu-id="e34b5-163">Nabídka **soubor** obsahuje položku **Exit** , která zavírá aplikaci.</span><span class="sxs-lookup"><span data-stu-id="e34b5-163">The **File** menu has an **Exit** item that closes the application.</span></span> <span data-ttu-id="e34b5-164">Nabídka **help** obsahuje **informace o** položce, která spustí jednoduché dialogové okno.</span><span class="sxs-lookup"><span data-stu-id="e34b5-164">The **Help** menu has an **About** item that launches a simple dialog box.</span></span>

 <span data-ttu-id="e34b5-165">Než začnete psát kód pro hostování [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu, je třeba provést dvě úpravy základní šablony.</span><span class="sxs-lookup"><span data-stu-id="e34b5-165">Before you start writing code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, you need to make two modifications to the basic template.</span></span>

 <span data-ttu-id="e34b5-166">První je kompilovat projekt jako spravovaný kód.</span><span class="sxs-lookup"><span data-stu-id="e34b5-166">The first is to compile the project as managed code.</span></span> <span data-ttu-id="e34b5-167">Ve výchozím nastavení se projekt zkompiluje jako nespravovaný kód.</span><span class="sxs-lookup"><span data-stu-id="e34b5-167">By default, the project compiles as unmanaged code.</span></span> <span data-ttu-id="e34b5-168">Avšak protože [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] je implementováno ve spravovaném kódu, projekt musí být zkompilován odpovídajícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="e34b5-168">However, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is implemented in managed code, the project must be compiled accordingly.</span></span>

1. <span data-ttu-id="e34b5-169">Klikněte pravým tlačítkem myši na název projektu v **Průzkumník řešení** a v místní nabídce vyberte možnost **vlastnosti** . tím otevřete dialogové okno **stránky vlastností** .</span><span class="sxs-lookup"><span data-stu-id="e34b5-169">Right-click the project name in **Solution Explorer** and select **Properties** from the context menu to launch the **Property Pages** dialog box.</span></span>

2. <span data-ttu-id="e34b5-170">Ve stromovém zobrazení v levém podokně vyberte **Vlastnosti konfigurace** .</span><span class="sxs-lookup"><span data-stu-id="e34b5-170">Select **Configuration Properties** from the tree view in the left pane.</span></span>

3. <span data-ttu-id="e34b5-171">V pravém podokně vyberte možnost Podpora **Common Language Runtime** ze seznamu **výchozích hodnot projektu** .</span><span class="sxs-lookup"><span data-stu-id="e34b5-171">Select **Common Language Runtime** support from the **Project Defaults** list in the right pane.</span></span>

4. <span data-ttu-id="e34b5-172">V rozevíracím seznamu vyberte možnost **Podpora Common Language Runtime (/CLR)** .</span><span class="sxs-lookup"><span data-stu-id="e34b5-172">Select **Common Language Runtime Support (/clr)** from the drop-down list box.</span></span>

> [!NOTE]
> <span data-ttu-id="e34b5-173">Tento příznak kompilátoru umožňuje použít spravovaný kód v aplikaci, ale váš nespravovaný kód bude zkompilován jako dříve.</span><span class="sxs-lookup"><span data-stu-id="e34b5-173">This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.</span></span>

 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="e34b5-174">používá model vláken typu apartment (STA) s jedním vláknem.</span><span class="sxs-lookup"><span data-stu-id="e34b5-174">uses the single-threaded apartment (STA) threading model.</span></span> <span data-ttu-id="e34b5-175">Aby bylo možné správně pracovat s kódem [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu, je nutné nastavit model vláken aplikace na STA použitím atributu na vstupní bod.</span><span class="sxs-lookup"><span data-stu-id="e34b5-175">In order to work properly with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content code, you must set the application's threading model to STA by applying an attribute to the entry point.</span></span>

 [!code-cpp[Win32HostingWPFPage#WinMain](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#winmain)]

<a name="hosting_the_wpf_page"></a>
### <a name="hosting-the-wpf-content"></a><span data-ttu-id="e34b5-176">Hostování obsahu WPF</span><span class="sxs-lookup"><span data-stu-id="e34b5-176">Hosting the WPF Content</span></span>
 <span data-ttu-id="e34b5-177">Obsah [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] je jednoduchá aplikace zadávání adres.</span><span class="sxs-lookup"><span data-stu-id="e34b5-177">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is a simple address entry application.</span></span> <span data-ttu-id="e34b5-178">Skládá se z několika ovládacích prvků <xref:System.Windows.Controls.TextBox> k převzetí uživatelského jména, adresy a tak dále.</span><span class="sxs-lookup"><span data-stu-id="e34b5-178">It consists of several <xref:System.Windows.Controls.TextBox> controls to take user name, address, and so on.</span></span> <span data-ttu-id="e34b5-179">Existují také dva ovládací prvky <xref:System.Windows.Controls.Button>, **OK** a **Zrušit**.</span><span class="sxs-lookup"><span data-stu-id="e34b5-179">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**.</span></span> <span data-ttu-id="e34b5-180">Když uživatel klikne na tlačítko **OK**, obslužná rutina události <xref:System.Windows.Controls.Primitives.ButtonBase.Click> tlačítka shromáždí data z ovládacích prvků <xref:System.Windows.Controls.TextBox>, přiřadí je k odpovídajícím vlastnostem a vyvolá vlastní událost, `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="e34b5-180">When the user clicks **OK**, the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler collects the data from the <xref:System.Windows.Controls.TextBox> controls, assigns it to corresponding properties, and raises a custom event, `OnButtonClicked`.</span></span> <span data-ttu-id="e34b5-181">Když uživatel klikne na **Storno**, obslužná rutina jednoduše vyvolá `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="e34b5-181">When the user clicks **Cancel**, the handler simply raises `OnButtonClicked`.</span></span> <span data-ttu-id="e34b5-182">Objekt argumentu události pro `OnButtonClicked` obsahuje pole Boolean, které indikuje, na které tlačítko bylo kliknuto.</span><span class="sxs-lookup"><span data-stu-id="e34b5-182">The event argument object for `OnButtonClicked` contains a Boolean field that indicates which button was clicked.</span></span>

 <span data-ttu-id="e34b5-183">Kód pro hostování [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]ho obsahu je implementován v obslužné rutině pro [WM_CREATE](/windows/desktop/winmsg/wm-create) oznámení v hostitelském okně.</span><span class="sxs-lookup"><span data-stu-id="e34b5-183">The code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in a handler for the [WM_CREATE](/windows/desktop/winmsg/wm-create) notification on the host window.</span></span>

 [!code-cpp[Win32HostingWPFPage#WMCreate](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcreate)]

 <span data-ttu-id="e34b5-184">Metoda `GetHwnd` přebírá informace o velikosti a umístění a také popisovači nadřazeného okna a vrací popisovač okna hostovaného [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]ho obsahu.</span><span class="sxs-lookup"><span data-stu-id="e34b5-184">The `GetHwnd` method takes size and position information plus the parent window handle and returns the window handle of the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>

> [!NOTE]
> <span data-ttu-id="e34b5-185">Pro obor názvů `System::Windows::Interop` nelze použít direktivu `#using`.</span><span class="sxs-lookup"><span data-stu-id="e34b5-185">You cannot use a `#using` directive for the `System::Windows::Interop` namespace.</span></span> <span data-ttu-id="e34b5-186">Tím se vytvoří kolize názvů mezi <xref:System.Windows.Interop.MSG> strukturou v tomto oboru názvů a strukturou MSG deklarovanou v Winuser. h.</span><span class="sxs-lookup"><span data-stu-id="e34b5-186">Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h.</span></span> <span data-ttu-id="e34b5-187">Místo toho je nutné použít plně kvalifikované názvy pro přístup k obsahu tohoto oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="e34b5-187">You must instead use fully-qualified names to access the contents of that namespace.</span></span>

 [!code-cpp[Win32HostingWPFPage#GetHwnd](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#gethwnd)]

 <span data-ttu-id="e34b5-188">Obsah [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] nelze hostovat přímo v okně aplikace.</span><span class="sxs-lookup"><span data-stu-id="e34b5-188">You cannot host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content directly in your application window.</span></span> <span data-ttu-id="e34b5-189">Místo toho vytvořte nejprve objekt <xref:System.Windows.Interop.HwndSource> pro zabalení [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu.</span><span class="sxs-lookup"><span data-stu-id="e34b5-189">Instead, you first create an <xref:System.Windows.Interop.HwndSource> object to wrap the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="e34b5-190">Tento objekt je v podstatě okno, které je navrženo pro hostování [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]ho obsahu.</span><span class="sxs-lookup"><span data-stu-id="e34b5-190">This object is basically a window that is designed to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="e34b5-191">Objekt <xref:System.Windows.Interop.HwndSource> hostovat v nadřazeném okně tak, že ho vytvoříte jako podřízený uzel okna Win32, který je součástí vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="e34b5-191">You host the <xref:System.Windows.Interop.HwndSource> object in the parent window by creating it as a child of a Win32 window that is part of your application.</span></span> <span data-ttu-id="e34b5-192">Parametry konstruktoru <xref:System.Windows.Interop.HwndSource> obsahují mnohem stejné informace, které byste při vytváření podřízeného okna systému Win32 předávali funkci CreateWindow.</span><span class="sxs-lookup"><span data-stu-id="e34b5-192">The <xref:System.Windows.Interop.HwndSource> constructor parameters contain much the same information that you would pass to CreateWindow when you create a Win32 child window.</span></span>

 <span data-ttu-id="e34b5-193">Dále vytvoříte instanci objektu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu.</span><span class="sxs-lookup"><span data-stu-id="e34b5-193">You next create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="e34b5-194">V tomto případě se [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah implementuje jako samostatná třída, `WPFPage`pomocí C++/CLI.</span><span class="sxs-lookup"><span data-stu-id="e34b5-194">In this case, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented as a separate class, `WPFPage`, using C++/CLI.</span></span> <span data-ttu-id="e34b5-195">Můžete také implementovat [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah pomocí [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e34b5-195">You could also implement the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content with [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="e34b5-196">K tomu však potřebujete nastavit samostatný projekt a sestavit [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah jako knihovnu DLL.</span><span class="sxs-lookup"><span data-stu-id="e34b5-196">However, to do so you need to set up a separate project and build the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a DLL.</span></span> <span data-ttu-id="e34b5-197">Můžete přidat odkaz na tuto knihovnu DLL do projektu a použít tento odkaz k vytvoření instance [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]ho obsahu.</span><span class="sxs-lookup"><span data-stu-id="e34b5-197">You can add a reference to that DLL to your project, and use that reference to create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>

 <span data-ttu-id="e34b5-198">Obsah [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] v podřízeném okně zobrazíte tak, že do vlastnosti <xref:System.Windows.Interop.HwndSource.RootVisual%2A> <xref:System.Windows.Interop.HwndSource>přiřadíte odkaz na [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah.</span><span class="sxs-lookup"><span data-stu-id="e34b5-198">You display the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in your child window by assigning a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>

 <span data-ttu-id="e34b5-199">Další řádek kódu připojí obslužnou rutinu události `WPFButtonClicked`k události [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="e34b5-199">The next line of code attaches an event handler, `WPFButtonClicked`, to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content `OnButtonClicked` event.</span></span> <span data-ttu-id="e34b5-200">Tato obslužná rutina se volá, když uživatel klikne na tlačítko **OK** nebo **Storno** .</span><span class="sxs-lookup"><span data-stu-id="e34b5-200">This handler is called when the user clicks the **OK** or **Cancel** button.</span></span> <span data-ttu-id="e34b5-201">Další diskuzi o této obslužné rutině události najdete v tématu [communicating_with_the_WPF obsahu](#communicating_with_the_page) .</span><span class="sxs-lookup"><span data-stu-id="e34b5-201">See [communicating_with_the_WPF content](#communicating_with_the_page) for further discussion of this event handler.</span></span>

 <span data-ttu-id="e34b5-202">Poslední zobrazený řádek kódu vrátí popisovač okna (HWND), který je spojen s objektem <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="e34b5-202">The final line of code shown returns the window handle (HWND) that is associated with the <xref:System.Windows.Interop.HwndSource> object.</span></span> <span data-ttu-id="e34b5-203">Pomocí tohoto popisovače z kódu Win32 můžete odesílat zprávy do hostovaného okna, i když ukázka to neudělá.</span><span class="sxs-lookup"><span data-stu-id="e34b5-203">You can use this handle from your Win32 code to send messages to the hosted window, although the sample does not do so.</span></span> <span data-ttu-id="e34b5-204">Objekt <xref:System.Windows.Interop.HwndSource> vyvolá událost pokaždé, když obdrží zprávu.</span><span class="sxs-lookup"><span data-stu-id="e34b5-204">The <xref:System.Windows.Interop.HwndSource> object raises an event every time it receives a message.</span></span> <span data-ttu-id="e34b5-205">Chcete-li zpracovat zprávy, zavolejte metodu <xref:System.Windows.Interop.HwndSource.AddHook%2A> pro připojení obslužné rutiny zpráv a poté zpracování zpráv v této obslužné rutině.</span><span class="sxs-lookup"><span data-stu-id="e34b5-205">To process the messages, call the <xref:System.Windows.Interop.HwndSource.AddHook%2A> method to attach a message handler and then process the messages in that handler.</span></span>

<a name="holding_a_reference"></a>
### <a name="holding-a-reference-to-the-wpf-content"></a><span data-ttu-id="e34b5-206">Držení odkazu na obsah WPF</span><span class="sxs-lookup"><span data-stu-id="e34b5-206">Holding a Reference to the WPF Content</span></span>
 <span data-ttu-id="e34b5-207">U mnoha aplikací budete chtít později komunikovat s [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahem.</span><span class="sxs-lookup"><span data-stu-id="e34b5-207">For many applications, you will want to communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content later.</span></span> <span data-ttu-id="e34b5-208">Můžete například chtít upravit vlastnosti obsahu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] nebo může mít <xref:System.Windows.Interop.HwndSource> hostitel objektu jiný [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah.</span><span class="sxs-lookup"><span data-stu-id="e34b5-208">For example, you might want to modify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, or perhaps have the <xref:System.Windows.Interop.HwndSource> object host different [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="e34b5-209">K tomu potřebujete odkaz na objekt <xref:System.Windows.Interop.HwndSource> nebo [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah.</span><span class="sxs-lookup"><span data-stu-id="e34b5-209">To do this, you need a reference to the <xref:System.Windows.Interop.HwndSource> object or the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="e34b5-210">Objekt <xref:System.Windows.Interop.HwndSource> a jeho přidružený [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah zůstanou v paměti, dokud nezničíte popisovač okna.</span><span class="sxs-lookup"><span data-stu-id="e34b5-210">The <xref:System.Windows.Interop.HwndSource> object and its associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content remain in memory until you destroy the window handle.</span></span> <span data-ttu-id="e34b5-211">Nicméně proměnná, kterou přiřadíte objektu <xref:System.Windows.Interop.HwndSource>, se po návratu z postupu okna přejdou do rozsahu.</span><span class="sxs-lookup"><span data-stu-id="e34b5-211">However, the variable you assign to the <xref:System.Windows.Interop.HwndSource> object will go out of scope as soon as you return from the window procedure.</span></span> <span data-ttu-id="e34b5-212">Vlastní způsob, jak tento problém obsloužit aplikacím Win32, je použít statickou nebo globální proměnnou.</span><span class="sxs-lookup"><span data-stu-id="e34b5-212">The customary way to handle this issue with Win32 applications is to use a static or global variable.</span></span> <span data-ttu-id="e34b5-213">K těmto typům proměnných bohužel nelze přiřadit spravovaný objekt.</span><span class="sxs-lookup"><span data-stu-id="e34b5-213">Unfortunately, you cannot assign a managed object to those types of variables.</span></span> <span data-ttu-id="e34b5-214">Popisovač okna přidružený k objektu <xref:System.Windows.Interop.HwndSource> lze přiřadit globální nebo statické proměnné, ale tato operace Chvojková neposkytuje přístup k objektu samotnému.</span><span class="sxs-lookup"><span data-stu-id="e34b5-214">You can assign the window handle associated with <xref:System.Windows.Interop.HwndSource> object to a global or static variable, but that doe not provide access to the object itself.</span></span>

 <span data-ttu-id="e34b5-215">Nejjednodušší řešení tohoto problému je implementace spravované třídy, která obsahuje sadu statických polí pro blokování odkazů na jakékoli spravované objekty, ke kterým potřebujete přístup.</span><span class="sxs-lookup"><span data-stu-id="e34b5-215">The simplest solution to this issue is to implement a managed class that contains a set of static fields to hold references to any managed objects that you need access to.</span></span> <span data-ttu-id="e34b5-216">Ukázka používá třídu `WPFPageHost` k uložení odkazu na [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu a počáteční hodnoty počtu jeho vlastností, které může uživatel později změnit.</span><span class="sxs-lookup"><span data-stu-id="e34b5-216">The sample uses the `WPFPageHost` class to hold a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, plus the initial values of a number of its properties that might be changed later by the user.</span></span> <span data-ttu-id="e34b5-217">Tato definice je definována v hlavičce.</span><span class="sxs-lookup"><span data-stu-id="e34b5-217">This is defined in the header.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageHost](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.h#wpfpagehost)]

 <span data-ttu-id="e34b5-218">Druhá část funkce `GetHwnd` přiřadí hodnoty do těchto polí pro pozdější použití, zatímco `myPage` stále ještě v oboru.</span><span class="sxs-lookup"><span data-stu-id="e34b5-218">The latter part of the `GetHwnd` function assigns values to those fields for later use while `myPage` is still in scope.</span></span>

<a name="communicating_with_the_page"></a>
### <a name="communicating-with-the-wpf-content"></a><span data-ttu-id="e34b5-219">Komunikace s obsahem WPF</span><span class="sxs-lookup"><span data-stu-id="e34b5-219">Communicating with the WPF Content</span></span>
 <span data-ttu-id="e34b5-220">Existují dva typy komunikace s obsahem [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e34b5-220">There are two types of communication with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="e34b5-221">Aplikace obdrží informace z obsahu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], když uživatel klikne na tlačítko **OK** nebo **Storno** .</span><span class="sxs-lookup"><span data-stu-id="e34b5-221">The application receives information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content when the user clicks the **OK** or **Cancel** buttons.</span></span> <span data-ttu-id="e34b5-222">Aplikace má také [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], která umožňuje uživateli měnit různé vlastnosti obsahu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], například barvu pozadí nebo výchozí velikost písma.</span><span class="sxs-lookup"><span data-stu-id="e34b5-222">The application also has a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that allows the user to change various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, such as the background color or default font size.</span></span>

 <span data-ttu-id="e34b5-223">Jak je uvedeno výše, když uživatel klikne buď na tlačítko, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah vyvolá událost `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="e34b5-223">As mentioned above, when the user clicks either button the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content raises an `OnButtonClicked` event.</span></span> <span data-ttu-id="e34b5-224">Aplikace k této události připojí obslužnou rutinu pro příjem těchto oznámení.</span><span class="sxs-lookup"><span data-stu-id="e34b5-224">The application attaches a handler to this event to receive these notifications.</span></span> <span data-ttu-id="e34b5-225">Pokud bylo kliknuto na tlačítko **OK** , obslužná rutina získá informace o uživateli z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu a zobrazí ji v sadě statických ovládacích prvků.</span><span class="sxs-lookup"><span data-stu-id="e34b5-225">If the **OK** button was clicked, the handler gets the user information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content and displays it in a set of static controls.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFButtonClicked](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wpfbuttonclicked)]

 <span data-ttu-id="e34b5-226">Obslužná rutina přijme objekt vlastní argument události z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu `MyPageEventArgs`.</span><span class="sxs-lookup"><span data-stu-id="e34b5-226">The handler receives a custom event argument object from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, `MyPageEventArgs`.</span></span> <span data-ttu-id="e34b5-227">Vlastnost `IsOK` objektu je nastavena na hodnotu `true`, pokud bylo tlačítko **OK** kliknuto a `false`, pokud bylo kliknuto na tlačítko **Storno** .</span><span class="sxs-lookup"><span data-stu-id="e34b5-227">The object's `IsOK` property is set to `true` if the **OK** button was clicked, and `false` if the **Cancel** button was clicked.</span></span>

 <span data-ttu-id="e34b5-228">Pokud bylo kliknuto na tlačítko **OK** , obslužná rutina získá odkaz na [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah z třídy kontejneru.</span><span class="sxs-lookup"><span data-stu-id="e34b5-228">If the **OK** button was clicked, the handler gets a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from the container class.</span></span> <span data-ttu-id="e34b5-229">Poté shromáždí informace o uživateli, které jsou uchovávány v rámci přidružených vlastností obsahu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] a používá statické ovládací prvky k zobrazení informací v nadřazeném okně.</span><span class="sxs-lookup"><span data-stu-id="e34b5-229">It then collects the user information that is held by the associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties and uses the static controls to display the information on the parent window.</span></span> <span data-ttu-id="e34b5-230">Vzhledem k tomu, že data obsahu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] jsou ve formě spravovaného řetězce, je nutné ji zařadit pro použití pomocí ovládacího prvku Win32.</span><span class="sxs-lookup"><span data-stu-id="e34b5-230">Because the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content data is in the form of a managed string, it has to be marshaled for use by a Win32 control.</span></span> <span data-ttu-id="e34b5-231">Pokud bylo kliknuto na tlačítko **Storno** , obslužná rutina vymaže data ze statických ovládacích prvků.</span><span class="sxs-lookup"><span data-stu-id="e34b5-231">If the **Cancel** button was clicked, the handler clears the data from the static controls.</span></span>

 <span data-ttu-id="e34b5-232">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] aplikace poskytuje sadu přepínačů, které umožňují uživateli upravovat barvu pozadí [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu a několik vlastností souvisejících s písmem.</span><span class="sxs-lookup"><span data-stu-id="e34b5-232">The application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] provides a set of radio buttons that allow the user to modify the background color of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and several font-related properties.</span></span> <span data-ttu-id="e34b5-233">Následující příklad je výpis z procedury okna aplikace (WndProc) a jeho zpracování zpráv, které nastavuje různé vlastnosti v různých zprávách, včetně barvy pozadí.</span><span class="sxs-lookup"><span data-stu-id="e34b5-233">The following example is an excerpt from the application's window procedure (WndProc) and its message handling that sets various properties on different messages, including the background color.</span></span> <span data-ttu-id="e34b5-234">Ostatní jsou podobné a nejsou zobrazeny.</span><span class="sxs-lookup"><span data-stu-id="e34b5-234">The others are similar, and are not shown.</span></span> <span data-ttu-id="e34b5-235">Podrobnosti a kontext najdete v kompletní ukázce.</span><span class="sxs-lookup"><span data-stu-id="e34b5-235">See the complete sample for details and context.</span></span>

 [!code-cpp[Win32HostingWPFPage#WMCommandToBG](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcommandtobg)]

 <span data-ttu-id="e34b5-236">Chcete-li nastavit barvu pozadí, získáte odkaz na obsah [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (`hostedPage`) z `WPFPageHost` a nastavte vlastnost barva pozadí na odpovídající barvu.</span><span class="sxs-lookup"><span data-stu-id="e34b5-236">To set the background color, get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (`hostedPage`) from `WPFPageHost` and set the background color property to the appropriate color.</span></span> <span data-ttu-id="e34b5-237">Ukázka používá tři možnosti barev: původní barva, světle zelená nebo světle losos.</span><span class="sxs-lookup"><span data-stu-id="e34b5-237">The sample uses three color options: the original color, light green, or light salmon.</span></span> <span data-ttu-id="e34b5-238">Původní barva pozadí je uložena jako statické pole ve třídě `WPFPageHost`.</span><span class="sxs-lookup"><span data-stu-id="e34b5-238">The original background color is stored as a static field in the `WPFPageHost` class.</span></span> <span data-ttu-id="e34b5-239">Chcete-li nastavit druhé dva, vytvořte nový objekt <xref:System.Windows.Media.SolidColorBrush> a předejte konstruktoru hodnotu statické barvy z objektu <xref:System.Windows.Media.Colors>.</span><span class="sxs-lookup"><span data-stu-id="e34b5-239">To set the other two, you create a new <xref:System.Windows.Media.SolidColorBrush> object and pass the constructor a static colors value from the <xref:System.Windows.Media.Colors> object.</span></span>

<a name="implementing_the_wpf_page"></a>
## <a name="implementing-the-wpf-page"></a><span data-ttu-id="e34b5-240">Implementace stránky WPF</span><span class="sxs-lookup"><span data-stu-id="e34b5-240">Implementing the WPF Page</span></span>
 <span data-ttu-id="e34b5-241">Obsah [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] můžete hostovat a používat bez znalosti skutečné implementace.</span><span class="sxs-lookup"><span data-stu-id="e34b5-241">You can host and use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content without any knowledge of the actual implementation.</span></span> <span data-ttu-id="e34b5-242">Pokud byl obsah [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zabalen v samostatné knihovně DLL, mohl by být sestaven v jakémkoli jazyce modulu CLR (Common Language Runtime).</span><span class="sxs-lookup"><span data-stu-id="e34b5-242">If the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content had been packaged in a separate DLL, it could have been built in any common language runtime (CLR) language.</span></span> <span data-ttu-id="e34b5-243">Následuje stručný návod k implementaci C++/CLI, která se používá v ukázce.</span><span class="sxs-lookup"><span data-stu-id="e34b5-243">Following is a brief walkthrough of the C++/CLI implementation that is used in the sample.</span></span> <span data-ttu-id="e34b5-244">Tato část obsahuje následující pododdíly.</span><span class="sxs-lookup"><span data-stu-id="e34b5-244">This section contains the following subsections.</span></span>

- [<span data-ttu-id="e34b5-245">Rozložení</span><span class="sxs-lookup"><span data-stu-id="e34b5-245">Layout</span></span>](#page_layout)

- [<span data-ttu-id="e34b5-246">Vrácení dat do hostitelského okna</span><span class="sxs-lookup"><span data-stu-id="e34b5-246">Returning the Data to the Host Window</span></span>](#returning_data_to_window)

- [<span data-ttu-id="e34b5-247">Nastavení vlastností WPF</span><span class="sxs-lookup"><span data-stu-id="e34b5-247">Setting the WPF Properties</span></span>](#set_page_properties)

<a name="page_layout"></a>
### <a name="layout"></a><span data-ttu-id="e34b5-248">Rozložení</span><span class="sxs-lookup"><span data-stu-id="e34b5-248">Layout</span></span>
 <span data-ttu-id="e34b5-249">Prvky [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] v obsahu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] se skládají z pěti ovládacích prvků <xref:System.Windows.Controls.TextBox> s přidruženými ovládacími prvky <xref:System.Windows.Controls.Label>: název, adresa, město, stát a PSČ.</span><span class="sxs-lookup"><span data-stu-id="e34b5-249">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content consist of five <xref:System.Windows.Controls.TextBox> controls, with associated <xref:System.Windows.Controls.Label> controls: Name, Address, City, State, and Zip.</span></span> <span data-ttu-id="e34b5-250">Existují také dva ovládací prvky <xref:System.Windows.Controls.Button>, **OK** a **Storno** .</span><span class="sxs-lookup"><span data-stu-id="e34b5-250">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**</span></span>

 <span data-ttu-id="e34b5-251">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah je implementován ve třídě `WPFPage`.</span><span class="sxs-lookup"><span data-stu-id="e34b5-251">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in the `WPFPage` class.</span></span> <span data-ttu-id="e34b5-252">Rozložení se zpracovává pomocí elementu <xref:System.Windows.Controls.Grid> rozložení.</span><span class="sxs-lookup"><span data-stu-id="e34b5-252">Layout is handled with a <xref:System.Windows.Controls.Grid> layout element.</span></span> <span data-ttu-id="e34b5-253">Třída dědí z <xref:System.Windows.Controls.Grid>, což efektivně zpřístupňuje kořenový prvek obsahu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e34b5-253">The class inherits from <xref:System.Windows.Controls.Grid>, which effectively makes it the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content root element.</span></span>

 <span data-ttu-id="e34b5-254">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] konstruktor obsahu přebírá požadovanou šířku a výšku a <xref:System.Windows.Controls.Grid> odpovídajícím způsobem velikost.</span><span class="sxs-lookup"><span data-stu-id="e34b5-254">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content constructor takes the required width and height, and sizes the <xref:System.Windows.Controls.Grid> accordingly.</span></span> <span data-ttu-id="e34b5-255">Pak definuje základní rozložení vytvořením sady <xref:System.Windows.Controls.ColumnDefinition> a <xref:System.Windows.Controls.RowDefinition> objektů a jejich přidáním do základních <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> a <xref:System.Windows.Controls.Grid.RowDefinitions%2A> kolekcí objektů <xref:System.Windows.Controls.Grid>.</span><span class="sxs-lookup"><span data-stu-id="e34b5-255">It then defines the basic layout by creating a set of <xref:System.Windows.Controls.ColumnDefinition> and <xref:System.Windows.Controls.RowDefinition> objects and adding them to the <xref:System.Windows.Controls.Grid> object base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> and <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectively.</span></span> <span data-ttu-id="e34b5-256">Tím se definuje mřížka s pěti řádky a sedmi sloupci s rozměry určenými obsahem buněk.</span><span class="sxs-lookup"><span data-stu-id="e34b5-256">This defines a grid of five rows and seven columns, with the dimensions determined by the contents of the cells.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorToGridDef](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortogriddef)]

 <span data-ttu-id="e34b5-257">Dále konstruktor přidá prvky [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] do <xref:System.Windows.Controls.Grid>.</span><span class="sxs-lookup"><span data-stu-id="e34b5-257">Next, the constructor adds the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements to the <xref:System.Windows.Controls.Grid>.</span></span> <span data-ttu-id="e34b5-258">První prvek je text nadpisu, což je <xref:System.Windows.Controls.Label> ovládací prvek, který je zarovnán na střed prvního řádku mřížky.</span><span class="sxs-lookup"><span data-stu-id="e34b5-258">The first element is the title text, which is a <xref:System.Windows.Controls.Label> control that is centered in the first row of the grid.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorTitle](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortitle)]

 <span data-ttu-id="e34b5-259">Další řádek obsahuje název <xref:System.Windows.Controls.Label> ovládací prvek a jeho přidružený ovládací prvek <xref:System.Windows.Controls.TextBox>.</span><span class="sxs-lookup"><span data-stu-id="e34b5-259">The next row contains the Name <xref:System.Windows.Controls.Label> control and its associated <xref:System.Windows.Controls.TextBox> control.</span></span> <span data-ttu-id="e34b5-260">Vzhledem k tomu, že se stejný kód používá pro každou dvojici popisku nebo textového pole, je umístěn ve dvojici privátních metod a používá se pro všechna pět párů popisku nebo textového pole.</span><span class="sxs-lookup"><span data-stu-id="e34b5-260">Because the same code is used for each label/textbox pair, it is placed in a pair of private methods and used for all five label/textbox pairs.</span></span> <span data-ttu-id="e34b5-261">Metody vytvoří příslušný ovládací prvek a zavolá metodu <xref:System.Windows.Controls.Grid> static <xref:System.Windows.Controls.Grid.SetColumn%2A> a <xref:System.Windows.Controls.Grid.SetRow%2A>, aby ovládací prvky umístily do příslušné buňky.</span><span class="sxs-lookup"><span data-stu-id="e34b5-261">The methods create the appropriate control, and call the <xref:System.Windows.Controls.Grid> class static <xref:System.Windows.Controls.Grid.SetColumn%2A> and <xref:System.Windows.Controls.Grid.SetRow%2A> methods to place the controls in the appropriate cell.</span></span> <span data-ttu-id="e34b5-262">Po vytvoření ovládacího prvku ukázka zavolá metodu <xref:System.Windows.Controls.UIElementCollection.Add%2A> pro vlastnost <xref:System.Windows.Controls.Panel.Children%2A> <xref:System.Windows.Controls.Grid> pro přidání ovládacího prvku do mřížky.</span><span class="sxs-lookup"><span data-stu-id="e34b5-262">After the control is created, the sample calls the <xref:System.Windows.Controls.UIElementCollection.Add%2A> method on the <xref:System.Windows.Controls.Panel.Children%2A> property of the <xref:System.Windows.Controls.Grid> to add the control to the grid.</span></span> <span data-ttu-id="e34b5-263">Kód pro přidání zbývajících párů popisku nebo textového pole je podobný.</span><span class="sxs-lookup"><span data-stu-id="e34b5-263">The code to add the remaining label/textbox pairs is similar.</span></span> <span data-ttu-id="e34b5-264">Podrobnosti najdete v ukázkovém kódu.</span><span class="sxs-lookup"><span data-stu-id="e34b5-264">See the sample code for details.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorName](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorname)]

 <span data-ttu-id="e34b5-265">Implementace těchto dvou metod je následující:</span><span class="sxs-lookup"><span data-stu-id="e34b5-265">The implementation of the two methods is as follows:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCreateHelpers](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagecreatehelpers)]

 <span data-ttu-id="e34b5-266">Nakonec ukázka přidá tlačítka **OK** a **Storno** a připojí obslužnou rutinu události ke svým <xref:System.Windows.Controls.Primitives.ButtonBase.Click>m událostem.</span><span class="sxs-lookup"><span data-stu-id="e34b5-266">Finally, the sample adds the **OK** and **Cancel** buttons and attaches an event handler to their <xref:System.Windows.Controls.Primitives.ButtonBase.Click> events.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorButtonsEvents](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorbuttonsevents)]

<a name="returning_data_to_window"></a>
### <a name="returning-the-data-to-the-host-window"></a><span data-ttu-id="e34b5-267">Vrácení dat do hostitelského okna</span><span class="sxs-lookup"><span data-stu-id="e34b5-267">Returning the Data to the Host Window</span></span>
 <span data-ttu-id="e34b5-268">Po kliknutí na tlačítko je vyvolána jeho událost <xref:System.Windows.Controls.Primitives.ButtonBase.Click>.</span><span class="sxs-lookup"><span data-stu-id="e34b5-268">When either button is clicked, its <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is raised.</span></span> <span data-ttu-id="e34b5-269">Hostitelské okno může jednoduše připojit obslužné rutiny k těmto událostem a získat data přímo z ovládacích prvků <xref:System.Windows.Controls.TextBox>.</span><span class="sxs-lookup"><span data-stu-id="e34b5-269">The host window could simply attach handlers to these events and get the data directly from the <xref:System.Windows.Controls.TextBox> controls.</span></span> <span data-ttu-id="e34b5-270">Ukázka používá poněkud méně přímý přístup.</span><span class="sxs-lookup"><span data-stu-id="e34b5-270">The sample uses a somewhat less direct approach.</span></span> <span data-ttu-id="e34b5-271">Zpracovává <xref:System.Windows.Controls.Primitives.ButtonBase.Click> v rámci [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu a potom vyvolá vlastní událost `OnButtonClicked`, aby upozornila [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah.</span><span class="sxs-lookup"><span data-stu-id="e34b5-271">It handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and then raises a custom event `OnButtonClicked`, to notify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="e34b5-272">Díky tomu může [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu provést několik ověření parametru před tím, než bude hostiteli upozorněni.</span><span class="sxs-lookup"><span data-stu-id="e34b5-272">This allows the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to do some parameter validation before notifying the host.</span></span> <span data-ttu-id="e34b5-273">Obslužná rutina získá text z ovládacích prvků <xref:System.Windows.Controls.TextBox> a přiřadí ho k veřejným vlastnostem, ze kterých může hostitel získat informace.</span><span class="sxs-lookup"><span data-stu-id="e34b5-273">The handler gets the text from the <xref:System.Windows.Controls.TextBox> controls and assigns it to public properties, from which the host can retrieve the information.</span></span>

 <span data-ttu-id="e34b5-274">Deklarace události v WPFPage. h:</span><span class="sxs-lookup"><span data-stu-id="e34b5-274">The event declaration, in WPFPage.h:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageEventDecl](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpageeventdecl)]

 <span data-ttu-id="e34b5-275">Obslužná rutina události <xref:System.Windows.Controls.Primitives.ButtonBase.Click> v WPFPage. cpp:</span><span class="sxs-lookup"><span data-stu-id="e34b5-275">The <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, in WPFPage.cpp:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageButtonClicked](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagebuttonclicked)]

<a name="set_page_properties"></a>
### <a name="setting-the-wpf-properties"></a><span data-ttu-id="e34b5-276">Nastavení vlastností WPF</span><span class="sxs-lookup"><span data-stu-id="e34b5-276">Setting the WPF Properties</span></span>
 <span data-ttu-id="e34b5-277">Hostitel Win32 umožňuje uživateli změnit několik [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]ch vlastností obsahu.</span><span class="sxs-lookup"><span data-stu-id="e34b5-277">The Win32 host allows the user to change several [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties.</span></span> <span data-ttu-id="e34b5-278">Ze strany Win32 je jednoduše Změna vlastností.</span><span class="sxs-lookup"><span data-stu-id="e34b5-278">From the Win32 side, it is simply a matter of changing the properties.</span></span> <span data-ttu-id="e34b5-279">Implementace ve třídě obsahu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] je trochu složitější, protože neexistuje žádná jediná globální vlastnost, která ovládá písma pro všechny ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="e34b5-279">The implementation in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls.</span></span> <span data-ttu-id="e34b5-280">Místo toho se v přístupových objektech set vlastností změní příslušná vlastnost pro každý ovládací prvek.</span><span class="sxs-lookup"><span data-stu-id="e34b5-280">Instead, the appropriate property for each control is changed in the properties' set accessors.</span></span> <span data-ttu-id="e34b5-281">Následující příklad ukazuje kód pro vlastnost `DefaultFontFamily`.</span><span class="sxs-lookup"><span data-stu-id="e34b5-281">The following example shows the code for the `DefaultFontFamily` property.</span></span> <span data-ttu-id="e34b5-282">Nastavení vlastnosti volá soukromou metodu, která zase nastaví vlastnosti <xref:System.Windows.Controls.Control.FontFamily%2A> pro různé ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="e34b5-282">Setting the property calls a private method that in turn sets the <xref:System.Windows.Controls.Control.FontFamily%2A> properties for the various controls.</span></span>

 <span data-ttu-id="e34b5-283">Z WPFPage. h:</span><span class="sxs-lookup"><span data-stu-id="e34b5-283">From WPFPage.h:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageFontFamilyProperty](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpagefontfamilyproperty)]

 <span data-ttu-id="e34b5-284">From WPFPage.cpp:</span><span class="sxs-lookup"><span data-stu-id="e34b5-284">From WPFPage.cpp:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageSetFontFamily](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagesetfontfamily)]

## <a name="see-also"></a><span data-ttu-id="e34b5-285">Viz také</span><span class="sxs-lookup"><span data-stu-id="e34b5-285">See also</span></span>

- <xref:System.Windows.Interop.HwndSource>
- [<span data-ttu-id="e34b5-286">Vzájemná spolupráce grafického subsystému WPF a systému Win32</span><span class="sxs-lookup"><span data-stu-id="e34b5-286">WPF and Win32 Interoperation</span></span>](wpf-and-win32-interoperation.md)
