---
title: Spuštění testování ve vizuální vrstvě
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- hit testing functionality [WPF]
- visual layer [WPF], hit testing functionality
ms.assetid: b1a64b61-14be-4d75-b89a-5c67bebb2c7b
ms.openlocfilehash: d4d304353e91147c57297dcc4525759ff1474b4f
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/12/2020
ms.locfileid: "79186407"
---
# <a name="hit-testing-in-the-visual-layer"></a><span data-ttu-id="1c4b9-102">Spuštění testování ve vizuální vrstvě</span><span class="sxs-lookup"><span data-stu-id="1c4b9-102">Hit Testing in the Visual Layer</span></span>
<span data-ttu-id="1c4b9-103">Toto téma obsahuje přehled funkcí testování přístupů poskytovaných vizuální vrstvou.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-103">This topic provides an overview of hit testing functionality provided by the visual layer.</span></span> <span data-ttu-id="1c4b9-104">Podpora testování přístupů umožňuje určit, zda geometrie nebo bodová <xref:System.Windows.Media.Visual>hodnota spadá do vykresleného obsahu , což umožňuje implementovat chování uživatelského rozhraní, jako je například obdélník výběru pro výběr více objektů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-104">Hit testing support allows you to determine whether a geometry or point value falls within the rendered content of a <xref:System.Windows.Media.Visual>, allowing you to implement user interface behavior such as a selection rectangle to select multiple objects.</span></span>  

<a name="hit_testing_scenarios"></a>
## <a name="hit-testing-scenarios"></a><span data-ttu-id="1c4b9-105">Scénáře testování přístupů</span><span class="sxs-lookup"><span data-stu-id="1c4b9-105">Hit Testing Scenarios</span></span>  
 <span data-ttu-id="1c4b9-106">Třída <xref:System.Windows.UIElement> poskytuje <xref:System.Windows.UIElement.InputHitTest%2A> metodu, která umožňuje přístupů test proti prvek pomocí dané hodnoty souřadnice.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-106">The <xref:System.Windows.UIElement> class provides the <xref:System.Windows.UIElement.InputHitTest%2A> method, which allows you to hit test against an element using a given coordinate value.</span></span> <span data-ttu-id="1c4b9-107">V mnoha případech <xref:System.Windows.UIElement.InputHitTest%2A> metoda poskytuje požadované funkce pro implementaci testování přístupů prvků.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-107">In many cases, the <xref:System.Windows.UIElement.InputHitTest%2A> method provides the desired functionality for implementing hit testing of elements.</span></span> <span data-ttu-id="1c4b9-108">Existuje však několik scénářů, ve kterých budete muset implementovat testování přístupů ve vizuální vrstvě.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-108">However, there are several scenarios in which you may need to implement hit testing at the visual layer.</span></span>  
  
- <span data-ttu-id="1c4b9-109">Přístupové položky<xref:System.Windows.UIElement> testování proti non-objekty: To<xref:System.Windows.UIElement> platí, <xref:System.Windows.Media.DrawingVisual> pokud jsou přístupů testování non-objekty, jako jsou nebo grafické objekty.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-109">Hit testing against non-<xref:System.Windows.UIElement> objects: This applies if you are hit testing non-<xref:System.Windows.UIElement> objects, such as <xref:System.Windows.Media.DrawingVisual> or graphics objects.</span></span>  
  
- <span data-ttu-id="1c4b9-110">Testování přístupů pomocí geometrie: To platí, pokud potřebujete zasáhnout test pomocí objektu geometrie, nikoli souřadnicovou hodnotou bodu.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-110">Hit testing using a geometry: This applies if you need to hit test using a geometry object rather than the coordinate value of a point.</span></span>  
  
- <span data-ttu-id="1c4b9-111">Přístupové položky testování proti více objektů: To platí, když potřebujete přístupů test proti více objektů, jako jsou překrývající se objekty.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-111">Hit testing against multiple objects: This applies when you need to hit test against multiple objects, such as overlapping objects.</span></span> <span data-ttu-id="1c4b9-112">Můžete získat výsledky pro všechny vizuály protínající geometrii nebo bod, ne jen pro první.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-112">You can get results for all visuals intersecting a geometry or point, not just the first one.</span></span>  
  
- <span data-ttu-id="1c4b9-113">Ignorování <xref:System.Windows.UIElement> zásady testování přístupů: To platí, když potřebujete ignorovat zásady testování přístupů, <xref:System.Windows.UIElement> které bere v úvahu takové faktory, jako je, zda je prvek zakázán nebo neviditelný.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-113">Ignoring <xref:System.Windows.UIElement> hit testing policy: This applies when you need to ignore the <xref:System.Windows.UIElement> hit testing policy, which takes into consideration such factors as whether an element is disabled or invisible.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="1c4b9-114">Kompletní ukázka kódu ilustrující testování přístupů ve vizuální vrstvě naleznete v [tématu Hit Test Using DrawingVisuals Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Visual%20Layer/DrawingVisual) and [Hit Test with Win32 Interoperation Sample](https://github.com/microsoft/WPF-Samples/tree/master/Visual%20Layer/VisualsHitTesting).</span><span class="sxs-lookup"><span data-stu-id="1c4b9-114">For a complete code sample illustrating hit testing at the visual layer, see [Hit Test Using DrawingVisuals Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Visual%20Layer/DrawingVisual) and [Hit Test with Win32 Interoperation Sample](https://github.com/microsoft/WPF-Samples/tree/master/Visual%20Layer/VisualsHitTesting).</span></span>  
  
<a name="hit_testing_support"></a>
## <a name="hit-testing-support"></a><span data-ttu-id="1c4b9-115">Podpora testování přístupů</span><span class="sxs-lookup"><span data-stu-id="1c4b9-115">Hit Testing Support</span></span>  
 <span data-ttu-id="1c4b9-116">Účelem <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> metod ve <xref:System.Windows.Media.VisualTreeHelper> třídě je určit, zda geometrie nebo bod souřadnice hodnota je v rámci vykreslení obsahu daného objektu, jako je například ovládací prvek nebo grafický prvek.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-116">The purpose of the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> methods in the <xref:System.Windows.Media.VisualTreeHelper> class is to determine whether a geometry or point coordinate value is within the rendered content of a given object, such as a control or graphic element.</span></span> <span data-ttu-id="1c4b9-117">Můžete například použít testování přístupů k určení, zda klepnutí myší v ohraničujícím obdélníku objektu spadá do geometrie kruhu.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-117">For example, you could use hit testing to determine whether a mouse click within the bounding rectangle of an object falls within the geometry of a circle.</span></span> <span data-ttu-id="1c4b9-118">Můžete také přepsat výchozí implementaci testování přístupů k provedení vlastních výpočtů testu přístupů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-118">You can also choose to override the default implementation of hit testing to perform your own custom hit test calculations.</span></span>  
  
 <span data-ttu-id="1c4b9-119">Následující obrázek znázorňuje vztah mezi oblastí neobdélníkového objektu a jeho ohraničujícím obdélníkem.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-119">The following illustration shows the relationship between a non-rectangular object's region and its bounding rectangle.</span></span>  
  
 <span data-ttu-id="1c4b9-120">![Diagram platné oblasti testu přístupů](./media/wcpsdk-mmgraphics-visuals-hittest-1.png "wcpsdk_mmgraphics_visuals_hittest_1")</span><span class="sxs-lookup"><span data-stu-id="1c4b9-120">![Diagram of valid hit test region](./media/wcpsdk-mmgraphics-visuals-hittest-1.png "wcpsdk_mmgraphics_visuals_hittest_1")</span></span>  
<span data-ttu-id="1c4b9-121">Diagram platné oblasti testu přístupů</span><span class="sxs-lookup"><span data-stu-id="1c4b9-121">Diagram of valid hit test region</span></span>  
  
<a name="hit_testing_and_z-order"></a>
## <a name="hit-testing-and-z-order"></a><span data-ttu-id="1c4b9-122">Testování přístupů a pořadí vykreslující</span><span class="sxs-lookup"><span data-stu-id="1c4b9-122">Hit Testing and Z-Order</span></span>  
 <span data-ttu-id="1c4b9-123">Vizuální [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] vrstva podporuje testování přístupů proti všem objektům pod bodem nebo geometrií, nejen proti objektu zcela nahoře.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-123">The [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] visual layer supports hit testing against all objects under a point or geometry, not just the top-most object.</span></span> <span data-ttu-id="1c4b9-124">Výsledky jsou vráceny v pořadí vykreslášti.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-124">Results are returned in z-order.</span></span> <span data-ttu-id="1c4b9-125">Vizuální objekt, který předáte jako parametr <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> metodě, však určuje, která část vizuálního stromu, která bude testována přístupem.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-125">However, the visual object that you pass as the parameter to the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method determines which portion of the visual tree that will be hit test.</span></span> <span data-ttu-id="1c4b9-126">Můžete zasáhnout test proti celý vizuální strom, nebo jeho část.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-126">You can hit test against the entire visual tree, or any portion of it.</span></span>  
  
 <span data-ttu-id="1c4b9-127">Na následujícím obrázku je objekt kruhu nad čtvercovými i trojúhelníkovými objekty.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-127">In the following illustration, the circle object is on top of both the square and triangle objects.</span></span> <span data-ttu-id="1c4b9-128">Pokud vás zajímá pouze testování přístupů vizuální objekt, jehož hodnota pořadí vykreslování <xref:System.Windows.Media.HitTestResultBehavior.Stop> je <xref:System.Windows.Media.HitTestResultCallback> nejvyšší, můžete nastavit výčet testu vizuální hohodu, aby se vrátil z testu přístupů po první položce.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-128">If you are only interested in hit testing the visual object whose z-order value is top-most, you can set the visual hit test enumeration to return <xref:System.Windows.Media.HitTestResultBehavior.Stop> from the <xref:System.Windows.Media.HitTestResultCallback> to stop the hit test traversal after the first item.</span></span>  
  
 <span data-ttu-id="1c4b9-129">![Diagram pořadí z&#45;vizuálního stromu](./media/wcpsdk-mmgraphics-visuals-hittest-2.png "wcpsdk_mmgraphics_visuals_hittest_2")</span><span class="sxs-lookup"><span data-stu-id="1c4b9-129">![Diagram of the z&#45;order of a visual tree](./media/wcpsdk-mmgraphics-visuals-hittest-2.png "wcpsdk_mmgraphics_visuals_hittest_2")</span></span>  
<span data-ttu-id="1c4b9-130">Diagram pořadí vykreslujícího vizuálního stromu</span><span class="sxs-lookup"><span data-stu-id="1c4b9-130">Diagram of the z-order of a visual tree</span></span>  
  
 <span data-ttu-id="1c4b9-131">Pokud chcete vytvořit výčet všech vizuálních objektů pod určitým <xref:System.Windows.Media.HitTestResultBehavior.Continue> bodem <xref:System.Windows.Media.HitTestResultCallback>nebo geometrií, vraťte se z .</span><span class="sxs-lookup"><span data-stu-id="1c4b9-131">If you want to enumerate all visual objects under a specific point or geometry, return <xref:System.Windows.Media.HitTestResultBehavior.Continue> from the <xref:System.Windows.Media.HitTestResultCallback>.</span></span> <span data-ttu-id="1c4b9-132">To znamená, že můžete zasáhnout test pro vizuální objekty, které jsou pod jinými objekty, i když jsou zcela zakryté.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-132">This means you can hit test for visual objects that are beneath other objects, even if they are wholly obscured.</span></span> <span data-ttu-id="1c4b9-133">Další informace naleznete v ukázkovém kódu v části "Použití zpětného volání výsledků testu přístupů".</span><span class="sxs-lookup"><span data-stu-id="1c4b9-133">See the sample code in the section "Using a Hit Test Results Callback" for more information.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="1c4b9-134">Vizuální objekt, který je transparentní lze také přístupů test.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-134">A visual object that is transparent can also be hit test.</span></span>  
  
<a name="using_default_hit_testing"></a>
## <a name="using-default-hit-testing"></a><span data-ttu-id="1c4b9-135">Použití výchozího testování přístupů</span><span class="sxs-lookup"><span data-stu-id="1c4b9-135">Using Default Hit Testing</span></span>  
 <span data-ttu-id="1c4b9-136">Můžete určit, zda je bod v geometrii vizuálního <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> objektu, pomocí metody k určení vizuálního objektu a hodnoty souřadnic bodu, proti které se má testovat.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-136">You can identify whether a point is within the geometry of a visual object, by using the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method to specify a visual object and a point coordinate value to test against.</span></span> <span data-ttu-id="1c4b9-137">Parametr vizuálního objektu identifikuje počáteční bod ve vizuálním stromu pro hledání testu přístupů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-137">The visual object parameter identifies the starting point in the visual tree for the hit test search.</span></span> <span data-ttu-id="1c4b9-138">Pokud je vizuální objekt nalezen ve vizuálním stromu, jehož <xref:System.Windows.Media.HitTestResult.VisualHit%2A> geometrie <xref:System.Windows.Media.HitTestResult> obsahuje souřadnice, je nastaven na vlastnost objektu.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-138">If a visual object is found in the visual tree whose geometry contains the coordinate, it is set to the <xref:System.Windows.Media.HitTestResult.VisualHit%2A> property of a <xref:System.Windows.Media.HitTestResult> object.</span></span> <span data-ttu-id="1c4b9-139">Potom <xref:System.Windows.Media.HitTestResult> je vrácena <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> z metody.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-139">The <xref:System.Windows.Media.HitTestResult> is then returned from the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span> <span data-ttu-id="1c4b9-140">Pokud bod není obsažen s vizuální podstrom, který <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> jsou `null`hit testování, vrátí .</span><span class="sxs-lookup"><span data-stu-id="1c4b9-140">If the point is not contained with the visual sub-tree you are hit testing, <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> returns `null`.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="1c4b9-141">Výchozí testování přístupů vždy vrátí nejvyšší objekt v pořadí vykreslující.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-141">Default hit testing always returns the top-most object in the z-order.</span></span> <span data-ttu-id="1c4b9-142">Chcete-li identifikovat všechny vizuální objekty, i ty, které mohou být částečně nebo zcela zakryté, použijte zpětné volání výsledků testu přístupů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-142">In order to identify all visual objects, even those that may be partly or wholly obscured, use a hit test result callback.</span></span>  
  
 <span data-ttu-id="1c4b9-143">Hodnota souřadnic, kterou předáte jako parametr bodu pro metodu, <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> musí být relativní vzhledem k souřadnicovému prostoru vizuálního objektu, proti kterém jste narazili na testování.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-143">The coordinate value you pass as the point parameter for the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method has to be relative to the coordinate space of the visual object you are hit testing against.</span></span> <span data-ttu-id="1c4b9-144">Například pokud jste vnořené vizuální objekty definované na (100, 100) v nadřazené souřadnicové prostoru, pak přístupů testování podřízené vizuál na (0, 0) je ekvivalentní testování přístupů na (100, 100) v nadřazené souřadnicové prostoru.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-144">For example, if you have nested visual objects defined at (100, 100) in the parent's coordinate space, then hit testing a child visual at (0, 0) is equivalent to hit testing at (100, 100) in the parent's coordinate space.</span></span>  
  
 <span data-ttu-id="1c4b9-145">Následující kód ukazuje, jak nastavit obslužné rutiny událostí myši pro <xref:System.Windows.UIElement> objekt, který se používá k zachycení událostí používaných pro testování přístupů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-145">The following code shows how to set up mouse event handlers for a <xref:System.Windows.UIElement> object that is used to capture events used for hit testing.</span></span>  
  
 [!code-csharp[HitTestingOverview#100](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#100)]
 [!code-vb[HitTestingOverview#100](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#100)]  
  
### <a name="how-the-visual-tree-affects-hit-testing"></a><span data-ttu-id="1c4b9-146">Jak vizuální strom ovlivňuje testování přístupů</span><span class="sxs-lookup"><span data-stu-id="1c4b9-146">How the Visual Tree Affects Hit Testing</span></span>  
 <span data-ttu-id="1c4b9-147">Počáteční bod ve vizuálním stromu určuje, které objekty jsou vráceny během výčtu test přístupů objektů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-147">The starting point in the visual tree determines which objects are returned during the hit test enumeration of objects.</span></span> <span data-ttu-id="1c4b9-148">Pokud máte více objektů, které chcete zasáhnout test, vizuální objekt použitý jako výchozí bod ve vizuálním stromu musí být společným předchůdcem všech objektů, které vás zajímají.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-148">If you have multiple objects you want to hit test, the visual object used as the starting point in the visual tree must be the common ancestor of all objects of interest.</span></span> <span data-ttu-id="1c4b9-149">Například pokud jste měli zájem o testování jak prvek tlačítka a kreslení vizuál v následujícím diagramu, budete muset nastavit počáteční bod ve vizuálním stromu společného předchůdce obou.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-149">For example, if you were interested in hit testing both the button element and drawing visual in the following diagram, you would have to set the starting point in the visual tree to the common ancestor of both.</span></span> <span data-ttu-id="1c4b9-150">V tomto případě je prvek plátna společným předchůdcem prvku tlačítka i vizuálu výkresu.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-150">In this case, the canvas element is the common ancestor of both the button element and the drawing visual.</span></span>  
  
 <span data-ttu-id="1c4b9-151">![Diagram hierarchie vizuálního stromu](./media/wcpsdk-mmgraphics-visuals-overview-01.gif "wcpsdk_mmgraphics_visuals_overview_01")</span><span class="sxs-lookup"><span data-stu-id="1c4b9-151">![Diagram of a visual tree hierarchy](./media/wcpsdk-mmgraphics-visuals-overview-01.gif "wcpsdk_mmgraphics_visuals_overview_01")</span></span>  
<span data-ttu-id="1c4b9-152">Diagram hierarchie vizuálního stromu</span><span class="sxs-lookup"><span data-stu-id="1c4b9-152">Diagram of a visual tree hierarchy</span></span>  
  
> [!NOTE]
> <span data-ttu-id="1c4b9-153">Vlastnost <xref:System.Windows.UIElement.IsHitTestVisible%2A> získá nebo nastaví hodnotu, <xref:System.Windows.UIElement>která deklaruje, zda odvozený objekt může být případně vrácena jako výsledek testu přístupů z některé části jeho vykresleného obsahu.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-153">The <xref:System.Windows.UIElement.IsHitTestVisible%2A> property gets or sets a value that declares whether a <xref:System.Windows.UIElement>-derived object can possibly be returned as a hit test result from some portion of its rendered content.</span></span> <span data-ttu-id="1c4b9-154">To umožňuje selektivně změnit vizuální strom k určení, které vizuální objekty jsou zapojeny do testu přístupů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-154">This allows you to selectively alter the visual tree to determine which visual objects are involved in a hit test.</span></span>  
  
<a name="using_a_hit_test_result_callback"></a>
## <a name="using-a-hit-test-result-callback"></a><span data-ttu-id="1c4b9-155">Použití zpětného volání výsledku testu přístupů</span><span class="sxs-lookup"><span data-stu-id="1c4b9-155">Using a Hit Test Result Callback</span></span>  
 <span data-ttu-id="1c4b9-156">Můžete vytvořit výčet všech vizuálních objektů ve vizuálním stromu, jehož geometrie obsahuje zadanou hodnotu souřadnic.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-156">You can enumerate all visual objects in a visual tree whose geometry contains a specified coordinate value.</span></span> <span data-ttu-id="1c4b9-157">To umožňuje identifikovat všechny vizuální objekty, i ty, které mohou být částečně nebo zcela zakryty jinými vizuálními objekty.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-157">This allows you to identify all visual objects, even those that may be partly or wholly obscured by other visual objects.</span></span> <span data-ttu-id="1c4b9-158">Chcete-li vytvořit výčet vizuálníobjekty <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> ve vizuálním stromu, použijte metodu s funkcí zpětného volání testu přístupů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-158">To enumerate visual objects in a visual tree use the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method with a hit test callback function.</span></span> <span data-ttu-id="1c4b9-159">Funkce zpětného volání testu přístupů je volána systémem, pokud je zadaná hodnota souřadnic obsažena ve vizuálním objektu.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-159">The hit test callback function is called by the system when the coordinate value you specify is contained in a visual object.</span></span>  
  
 <span data-ttu-id="1c4b9-160">Během výčtu výsledků testu přístupů byste neměli provádět žádné operace, které upravuje vizuální strom.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-160">During the hit test results enumeration, you should not perform any operation that modifies the visual tree.</span></span> <span data-ttu-id="1c4b9-161">Přidání nebo odebrání objektu z vizuálního stromu během jeho procházení může mít za následek nepředvídatelné chování.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-161">Adding or removing an object from the visual tree while it is being traversed can result in unpredictable behavior.</span></span> <span data-ttu-id="1c4b9-162">Po vrácení <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> metody můžete bezpečně upravit vizuální strom.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-162">You can safely modify the visual tree after the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method returns.</span></span> <span data-ttu-id="1c4b9-163">Můžete chtít poskytnout strukturu dat, jako <xref:System.Collections.ArrayList>je například , pro uložení hodnot během výčtu výsledků testu přístupů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-163">You may want to provide a data structure, such as an <xref:System.Collections.ArrayList>, to store values during the hit test results enumeration.</span></span>  
  
 [!code-csharp[HitTestingOverview#101](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#101)]
 [!code-vb[HitTestingOverview#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#101)]  
  
 <span data-ttu-id="1c4b9-164">Metoda zpětného volání testu přístupů definuje akce, které provedete, když je test přístupů identifikován na konkrétním vizuálním objektu ve vizuálním stromu.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-164">The hit test callback method defines the actions you perform when a hit test is identified on a particular visual object in the visual tree.</span></span> <span data-ttu-id="1c4b9-165">Po provedení akcí vrátíte <xref:System.Windows.Media.HitTestResultBehavior> hodnotu, která určuje, zda chcete pokračovat ve výčtu jiných vizuálních objektů nebo ne.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-165">After you perform the actions, you return a <xref:System.Windows.Media.HitTestResultBehavior> value that determines whether to continue the enumeration of any other visual objects or not.</span></span>  
  
 [!code-csharp[HitTestingOverview#102](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#102)]
 [!code-vb[HitTestingOverview#102](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#102)]  
  
> [!NOTE]
> <span data-ttu-id="1c4b9-166">Pořadí výčtu přístupů vizuální objekty je pořadí vykreslování.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-166">The order of enumeration of hit visual objects is by z-order.</span></span> <span data-ttu-id="1c4b9-167">Vizuální objekt na nejvyšší úrovni pořadí vykreslovaného objektu je první objekt ve výčtu.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-167">The visual object at the top-most z-order level is the first object enumerated.</span></span> <span data-ttu-id="1c4b9-168">Všechny ostatní vizuální objekty ve výčtu jsou na úrovni snížení pořadí vykreslovaných.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-168">Any other visual objects enumerated are at decreasing z-order level.</span></span> <span data-ttu-id="1c4b9-169">Toto pořadí výčtu odpovídá pořadí vykreslování vizuálů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-169">This order of enumeration corresponds to the rendering order of the visuals.</span></span>  
  
 <span data-ttu-id="1c4b9-170">Výčet vizuálních objektů můžete kdykoli zastavit ve funkci zpětného volání <xref:System.Windows.Media.HitTestResultBehavior.Stop>testu přístupů vrácením .</span><span class="sxs-lookup"><span data-stu-id="1c4b9-170">You can stop the enumeration of visual objects at any time in the hit test callback function by returning <xref:System.Windows.Media.HitTestResultBehavior.Stop>.</span></span>  
  
 [!code-csharp[HitTestingOverview#103](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#103)]
 [!code-vb[HitTestingOverview#103](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#103)]  
  
<a name="using_a_hit_test_filter_callback"></a>
## <a name="using-a-hit-test-filter-callback"></a><span data-ttu-id="1c4b9-171">Použití zpětného volání filtru testu přístupů</span><span class="sxs-lookup"><span data-stu-id="1c4b9-171">Using a Hit Test Filter Callback</span></span>  
 <span data-ttu-id="1c4b9-172">Můžete použít volitelný filtr testu přístupů k omezení objektů, které jsou předány výsledky testu přístupů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-172">You can use an optional hit test filter to restrict the objects that are passed on to the hit test results.</span></span> <span data-ttu-id="1c4b9-173">To umožňuje ignorovat části vizuálního stromu, které nemáte zájem o zpracování ve výsledcích testu přístupů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-173">This allows you to ignore parts of the visual tree that you are not interested in processing in your hit test results.</span></span> <span data-ttu-id="1c4b9-174">Chcete-li implementovat filtr testu přístupů, definujte funkci zpětného volání filtru <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> testu přístupů a předejte ji jako hodnotu parametru při volání metody.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-174">To implement a hit test filter, you define a hit test filter callback function and pass it as a parameter value when you call the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span>  
  
 [!code-csharp[HitTestingOverview#104](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#104)]
 [!code-vb[HitTestingOverview#104](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#104)]  
  
 <span data-ttu-id="1c4b9-175">Pokud nechcete zadat volitelnou funkci zpětného volání filtru `null` testu přístupů, <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> předejte hodnotu jako parametr pro metodu.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-175">If you do not want to supply the optional hit test filter callback function, pass a `null` value as its parameter for the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span>  
  
 [!code-csharp[HitTestingOverview#105](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#105)]
 [!code-vb[HitTestingOverview#105](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#105)]  
  
 <span data-ttu-id="1c4b9-176">![Prořezávání vizuálního stromu pomocí testovacího filtru přístupů](./media/filteredvisualtree-01.png "FilteredVisualTree_01")</span><span class="sxs-lookup"><span data-stu-id="1c4b9-176">![Pruning a visual tree using a hit test filter](./media/filteredvisualtree-01.png "FilteredVisualTree_01")</span></span>  
<span data-ttu-id="1c4b9-177">Prořezávání vizuálního stromu</span><span class="sxs-lookup"><span data-stu-id="1c4b9-177">Pruning a visual tree</span></span>  
  
 <span data-ttu-id="1c4b9-178">Funkce zpětného volání filtru testu přístupů umožňuje vytvořit výčet všech vizuálů, jejichž vykreslený obsah obsahuje zadané souřadnice.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-178">The hit test filter callback function allows you to enumerate through all the visuals whose rendered content contains the coordinates you specify.</span></span> <span data-ttu-id="1c4b9-179">Můžete však chtít ignorovat určité větve vizuálního stromu, které nemáte zájem o zpracování ve funkci zpětného volání výsledků testu přístupů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-179">However, you may want to ignore certain branches of the visual tree that you are not interested in processing in your hit test results callback function.</span></span> <span data-ttu-id="1c4b9-180">Vrácená hodnota funkce zpětného volání filtru testu přístupů určuje, jaký typ akce by měl výčet vizuálních objektů provést.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-180">The return value of the hit test filter callback function determines what type of action the enumeration of the visual objects should take.</span></span> <span data-ttu-id="1c4b9-181">Například pokud vrátíte hodnotu , <xref:System.Windows.Media.HitTestFilterBehavior.ContinueSkipSelfAndChildren>můžete odebrat aktuální vizuální objekt a jeho podřízené objekty z výčtu výsledků testu přístupů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-181">For example, if you return the value, <xref:System.Windows.Media.HitTestFilterBehavior.ContinueSkipSelfAndChildren>, you can remove the current visual object and its children from the hit test results enumeration.</span></span> <span data-ttu-id="1c4b9-182">To znamená, že funkce zpětného volání výsledků testu přístupů neuvidí tyto objekty ve svém výčtu.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-182">This means that the hit test results callback function will not see these objects in its enumeration.</span></span> <span data-ttu-id="1c4b9-183">Prořezávání vizuální strom objektů snižuje množství zpracování během průchodu výsledků testu přístupů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-183">Pruning the visual tree of objects decreases the amount of processing during the hit test results enumeration pass.</span></span> <span data-ttu-id="1c4b9-184">V následujícím příkladu kódu filtr přeskočí popisky a jejich potomky a přístupů testuje vše ostatní.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-184">In the following code example, the filter skips labels and their descendants and hit tests everything else.</span></span>  
  
 [!code-csharp[HitTestingOverview#106](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#106)]
 [!code-vb[HitTestingOverview#106](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#106)]  
  
> [!NOTE]
> <span data-ttu-id="1c4b9-185">Návrat filtru test přístupů bude někdy volána v případech, kdy není volána zpětná volání výsledků testu přístupů.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-185">The hit test filter callback will sometimes be called in cases where the hit test results callback is not called.</span></span>  
  
<a name="overriding_default_hit_testing"></a>
## <a name="overriding-default-hit-testing"></a><span data-ttu-id="1c4b9-186">Přepsání výchozího testování přístupů</span><span class="sxs-lookup"><span data-stu-id="1c4b9-186">Overriding Default Hit Testing</span></span>  
 <span data-ttu-id="1c4b9-187">Výchozí podporu testování přístupů vizuálního objektu můžete <xref:System.Windows.Media.Visual.HitTestCore%2A> přepsat přepsáním metody.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-187">You can override a visual object’s default hit testing support by overriding the <xref:System.Windows.Media.Visual.HitTestCore%2A> method.</span></span> <span data-ttu-id="1c4b9-188">To znamená, že <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> při vyvolání metody <xref:System.Windows.Media.Visual.HitTestCore%2A> je volána vaše přepsané implementace.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-188">This means that when you invoke the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method, your overridden implementation of <xref:System.Windows.Media.Visual.HitTestCore%2A> is called.</span></span> <span data-ttu-id="1c4b9-189">Přepnutá metoda je volána, když test přístupů spadá do ohraničovacího obdélníku vizuálního objektu, i když souřadnice spadá mimo vykreslený obsah vizuálního objektu.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-189">Your overridden method is called when a hit test falls within the bounding rectangle of the visual object, even if the coordinate falls outside the rendered content of the visual object.</span></span>  
  
 [!code-csharp[HitTestingOverview#107](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#107)]
 [!code-vb[HitTestingOverview#107](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#107)]  
  
 <span data-ttu-id="1c4b9-190">Může nastat někdy, kdy chcete přístupů test proti ohraničující obdélník a vykreslený obsah vizuální objekt.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-190">There may be times when you want to hit test against both the bounding rectangle and the rendered content of a visual object.</span></span> <span data-ttu-id="1c4b9-191">Pomocí hodnoty `PointHitTestParameters` parametru v <xref:System.Windows.Media.Visual.HitTestCore%2A> přepsané metodě jako <xref:System.Windows.Media.Visual.HitTestCore%2A>parametr u základní metody můžete provádět akce na základě přístupu ohraničujícího obdélníku vizuálního objektu a potom provést druhý test přístupů proti vykreslení obsahu vizuálního objektu.</span><span class="sxs-lookup"><span data-stu-id="1c4b9-191">By using the `PointHitTestParameters` parameter value in your overridden <xref:System.Windows.Media.Visual.HitTestCore%2A> method as the parameter to the base method <xref:System.Windows.Media.Visual.HitTestCore%2A>, you can perform actions based on a hit of the bounding rectangle of a visual object, and then perform a second hit test against the rendered content of the visual object.</span></span>  
  
 [!code-csharp[HitTestingOverview#108](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#108)]
 [!code-vb[HitTestingOverview#108](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#108)]  
  
## <a name="see-also"></a><span data-ttu-id="1c4b9-192">Viz také</span><span class="sxs-lookup"><span data-stu-id="1c4b9-192">See also</span></span>

- <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A>
- <xref:System.Windows.Media.HitTestResult>
- <xref:System.Windows.Media.HitTestResultCallback>
- <xref:System.Windows.Media.HitTestFilterCallback>
- <xref:System.Windows.UIElement.IsHitTestVisible%2A>
- [<span data-ttu-id="1c4b9-193">Test přístupů pomocí ukázky výkresových obrazovek</span><span class="sxs-lookup"><span data-stu-id="1c4b9-193">Hit Test Using DrawingVisuals Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Visual%20Layer/DrawingVisual)
- [<span data-ttu-id="1c4b9-194">Test přístupů s ukázkou spolupráce win32</span><span class="sxs-lookup"><span data-stu-id="1c4b9-194">Hit Test with Win32 Interoperation Sample</span></span>](https://github.com/microsoft/WPF-Samples/tree/master/Visual%20Layer/VisualsHitTesting)
- [<span data-ttu-id="1c4b9-195">Spuštění geometrie testu ve vizuálním objektu</span><span class="sxs-lookup"><span data-stu-id="1c4b9-195">Hit Test Geometry in a Visual</span></span>](how-to-hit-test-geometry-in-a-visual.md)
- [<span data-ttu-id="1c4b9-196">Ověřování pozice pomocí kontejneru hostitele Win32</span><span class="sxs-lookup"><span data-stu-id="1c4b9-196">Hit Test Using a Win32 Host Container</span></span>](how-to-hit-test-using-a-win32-host-container.md)
