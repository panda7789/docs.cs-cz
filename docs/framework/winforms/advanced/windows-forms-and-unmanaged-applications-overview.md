---
title: Přehled nespravovaných aplikací
ms.date: 03/30/2017
helpviewer_keywords:
- COM [Windows Forms]
- Windows Forms, unmanaged
- COM interop
- ActiveX controls [Windows Forms], about ActiveX controls
- Windows Forms, interop
ms.assetid: 0a26d99d-8135-4895-8760-c9a2b5f67f14
ms.openlocfilehash: 0b4c3e738848be1ead2adeb1945e168c9db60071
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/24/2020
ms.locfileid: "76732532"
---
# <a name="windows-forms-and-unmanaged-applications-overview"></a><span data-ttu-id="bc2b3-102">Windows Forms a přehled nespravovaných aplikací</span><span class="sxs-lookup"><span data-stu-id="bc2b3-102">Windows Forms and Unmanaged Applications Overview</span></span>
<span data-ttu-id="bc2b3-103">Model Windows Forms aplikace a ovládací prvky mohou spolupracovat s nespravovanými aplikacemi, s některými upozorněními.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-103">Windows Forms applications and controls can interoperate with unmanaged applications, with some caveats.</span></span> <span data-ttu-id="bc2b3-104">V následujících částech najdete popis scénářů a konfigurací, které model Windows Forms aplikace a ovládací prvky podporují, a ty, které nepodporují.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-104">The following sections describe the scenarios and configurations that Windows Forms applications and controls support and those that they do not support.</span></span>  
  
## <a name="windows-forms-controls-and-activex-applications"></a><span data-ttu-id="bc2b3-105">model Windows Forms ovládací prvky a aplikace ActiveX</span><span class="sxs-lookup"><span data-stu-id="bc2b3-105">Windows Forms Controls and ActiveX Applications</span></span>  
 <span data-ttu-id="bc2b3-106">S výjimkou aplikací Microsoft Internet Explorer a Microsoft Foundation Classes (MFC) nejsou ovládací prvky model Windows Forms podporovány v aplikacích navržených pro hostování ovládacích prvků ActiveX.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-106">With the exception of Microsoft Internet Explorer and Microsoft Foundation Classes (MFC), Windows Forms controls are not supported in applications designed to host ActiveX controls.</span></span> <span data-ttu-id="bc2b3-107">Jiné aplikace a vývojové nástroje, které jsou schopné hostovat ovládací prvky ActiveX, včetně kontejnerů testů ActiveX z verzí sady Visual Studio, které jsou starší než Visual Studio .NET 2003, nejsou pro ovládací prvky model Windows Forms podporovány.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-107">Other applications and development tools that are capable of hosting ActiveX controls, including the ActiveX test containers from versions of Visual Studio that are earlier than Visual Studio .NET 2003, are not supported hosts for Windows Forms controls.</span></span>  
  
 <span data-ttu-id="bc2b3-108">Tato omezení platí také pro použití model Windows Formsch ovládacích prvků prostřednictvím zprostředkovatele komunikace s objekty COM komponent modelu COM.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-108">These constraints also apply to the use of Windows Forms controls through Component Object Model COM interop.</span></span> <span data-ttu-id="bc2b3-109">Použití ovládacího prvku model Windows Forms přes obálku s podporou modelu COM (doleva) je podporováno pouze v aplikaci Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-109">The use of a Windows Forms control through a COM callable wrapper (CCW) is supported only in Internet Explorer.</span></span> <span data-ttu-id="bc2b3-110">Další informace o zprostředkovateli komunikace s objekty COM naleznete v tématu.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-110">For more information about COM interop, see</span></span>  
  
 <span data-ttu-id="bc2b3-111">[Zprostředkovatel komunikace s objekty COM](../../../visual-basic/programming-guide/com-interop/index.md).</span><span class="sxs-lookup"><span data-stu-id="bc2b3-111">[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md).</span></span>  
  
 <span data-ttu-id="bc2b3-112">V následující tabulce je uvedena dostupná podpora hostování ActiveX pro ovládací prvky model Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-112">The following table shows the available ActiveX hosting support for Windows Forms controls.</span></span>  
  
|<span data-ttu-id="bc2b3-113">Verze model Windows Forms</span><span class="sxs-lookup"><span data-stu-id="bc2b3-113">Windows Forms version</span></span>|<span data-ttu-id="bc2b3-114">Podpora</span><span class="sxs-lookup"><span data-stu-id="bc2b3-114">Support</span></span>|  
|---------------------------|-------------|  
|<span data-ttu-id="bc2b3-115">.NET Framework verze 1,0</span><span class="sxs-lookup"><span data-stu-id="bc2b3-115">.NET Framework version 1.0</span></span>|<span data-ttu-id="bc2b3-116">Internet Explorer 5,01 a novější verze</span><span class="sxs-lookup"><span data-stu-id="bc2b3-116">Internet Explorer 5.01 and later versions</span></span>|  
|<span data-ttu-id="bc2b3-117">.NET Framework verze 1,1 a novější</span><span class="sxs-lookup"><span data-stu-id="bc2b3-117">.NET Framework version 1.1 and later</span></span>|<span data-ttu-id="bc2b3-118">Internet Explorer 5,01 a novější verze</span><span class="sxs-lookup"><span data-stu-id="bc2b3-118">Internet Explorer 5.01 and later versions</span></span><br /><br /> <span data-ttu-id="bc2b3-119">Microsoft Foundation Classes (MFC) 7,0 a novější</span><span class="sxs-lookup"><span data-stu-id="bc2b3-119">Microsoft Foundation Classes (MFC) 7.0 and later</span></span>|  
  
## <a name="hosting-windows-forms-components-as-activex-controls"></a><span data-ttu-id="bc2b3-120">Hostování komponent model Windows Forms jako ovládacích prvků ActiveX</span><span class="sxs-lookup"><span data-stu-id="bc2b3-120">Hosting Windows Forms components as ActiveX controls</span></span>  
 <span data-ttu-id="bc2b3-121">V .NET Framework 1,1 byla podpora rozšířena tak, aby zahrnovala knihovnu MFC 7,0 a novější verze.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-121">In the .NET Framework 1.1, support was extended to include MFC 7.0 and later versions.</span></span> <span data-ttu-id="bc2b3-122">Tato podpora zahrnuje libovolný kontejner, který je plně kompatibilní s kontejnerem ovládacích prvků ActiveX MFC 7,0 a novějším.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-122">This support includes any container that is fully compatible with the MFC 7.0 and later ActiveX control container.</span></span>  
  
 <span data-ttu-id="bc2b3-123">Nicméně registrace ovládacích prvků model Windows Forms jako ovládacích prvků ActiveX není podporována.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-123">However, registration of Windows Forms controls as ActiveX controls is not supported.</span></span> <span data-ttu-id="bc2b3-124">Také volání metody `com.ms.win32.Ole32.CoCreateInstance` pro ovládací prvky model Windows Forms není podporováno.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-124">Also, calling the `com.ms.win32.Ole32.CoCreateInstance` method for Windows Forms controls is not supported.</span></span> <span data-ttu-id="bc2b3-125">Podporovaná je jenom spravovaná aktivace model Windows Formsch ovládacích prvků.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-125">Only managed activation of Windows Forms controls is supported.</span></span> <span data-ttu-id="bc2b3-126">Po vytvoření ovládacího prvku model Windows Forms jej můžete hostovat v aplikaci knihovny MFC stejně jako s ovládacím prvkem ActiveX.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-126">Once you create a Windows Forms control, you can host it in an MFC application just as with an ActiveX control.</span></span>  
  
 <span data-ttu-id="bc2b3-127">Chcete-li použít ovládací prvky model Windows Forms v nespravované aplikaci, je nutné buď hostovat modul CLR pomocí nespravovaného rozhraní API C++ pro hostování CLR, nebo použít funkce spolupráce.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-127">To use Windows Forms controls in your unmanaged application, you must either host the CLR using the unmanaged CLR hosting APIs or use the C++ interop features.</span></span> <span data-ttu-id="bc2b3-128">Doporučené řešení C++ je použití funkcí spolupráce.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-128">Using the C++ interop features is the recommended solution.</span></span>  
  
## <a name="windows-forms-in-com-client-applications"></a><span data-ttu-id="bc2b3-129">model Windows Forms v klientských aplikacích modelu COM</span><span class="sxs-lookup"><span data-stu-id="bc2b3-129">Windows Forms in COM client applications</span></span>  
 <span data-ttu-id="bc2b3-130">Při otevření formuláře Windows z klientské aplikace modelu COM, jako je například aplikace Visual Basic 6,0 nebo aplikace MFC, se formulář může chovat neočekávaně.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-130">When you open a Windows Form from a COM client application, such as a Visual Basic 6.0 application or an MFC application, the form may behave unexpectedly.</span></span> <span data-ttu-id="bc2b3-131">Například při stisknutí klávesy TAB se fokus nemění z jednoho ovládacího prvku na jiný ovládací prvek.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-131">For example, when you press the TAB key, the focus does not change from one control to another control.</span></span> <span data-ttu-id="bc2b3-132">Když stisknete klávesu ENTER, zatímco příkazové tlačítko má fokus, není vyvolána událost <xref:System.Windows.Forms.Control.Click> tlačítka.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-132">When you press the ENTER key while a command button has focus, the button's <xref:System.Windows.Forms.Control.Click> event is not raised.</span></span> <span data-ttu-id="bc2b3-133">Můžete také zaznamenat neočekávané chování pro stisknutí kláves nebo aktivitu myši.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-133">You may also experience unexpected behavior for keystrokes or mouse activity.</span></span>  
  
 <span data-ttu-id="bc2b3-134">K tomuto chování dochází, protože nespravované aplikace neimplementuje podporu smyčky zpráv, kterou model Windows Forms vyžaduje, aby správně fungovala.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-134">This behavior occurs because the unmanaged application does not implement the message loop support that Windows Forms requires to work correctly.</span></span> <span data-ttu-id="bc2b3-135">Smyčka zprávy, kterou poskytuje klientská aplikace modelu COM, se od smyčky zpráv model Windows Forms liší.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-135">The message loop provided by the COM client application is fundamentally different from the Windows Forms message loop.</span></span>  
  
 <span data-ttu-id="bc2b3-136">Smyčka zpráv aplikace je interní smyčka programu, která načítá zprávy z fronty zpráv vlákna, překládá je a odesílá do aplikace, aby ji bylo možné zpracovat.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-136">An application's message loop is an internal program loop that retrieves messages from a thread's message queue, translates them, and then sends them to the application to be handled.</span></span> <span data-ttu-id="bc2b3-137">Smyčka zpráv pro formulář Windows nemá stejnou architekturu jako smyčka zpráv, kterou používají dřívější aplikace, jako jsou například aplikace Visual Basic 6,0 a aplikace MFC.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-137">The message loop for a Windows Form does not have the same architecture as message loops that earlier applications, such as Visual Basic 6.0 applications and MFC applications, provide.</span></span> <span data-ttu-id="bc2b3-138">Zprávy oken, které jsou publikovány do smyčky zpráv, mohou být zpracovány odlišně, než systém Windows Form očekává.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-138">The window messages that are posted to the message loop may be handled differently than the Windows Form expects.</span></span> <span data-ttu-id="bc2b3-139">Proto může dojít k neočekávanému chování.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-139">Therefore, unexpected behavior may occur.</span></span> <span data-ttu-id="bc2b3-140">Některé kombinace klávesových úhozů nemusí fungovat, některé aktivity myši nemusí fungovat nebo některé události nemusejí být vyvolány podle očekávání.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-140">Some keystroke combinations may not work, some mouse activity may not work, or some events may not be raised as expected.</span></span>  
  
## <a name="resolving-interoperability-issues"></a><span data-ttu-id="bc2b3-141">Řešení problémů s interoperabilitou</span><span class="sxs-lookup"><span data-stu-id="bc2b3-141">Resolving Interoperability Issues</span></span>  
 <span data-ttu-id="bc2b3-142">Tyto problémy můžete vyřešit zobrazením formuláře ve smyčce zprávy .NET Framework, která je vytvořena pomocí metody <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-142">You can resolve these problems by displaying the form on a .NET Framework message loop, which is created by using the <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="bc2b3-143">Chcete-li, aby formulář Windows pracoval správně z klientské aplikace modelu COM, je nutné jej spustit ve smyčce model Windows Forms zpráv.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-143">To make a Windows Form work correctly from a COM client application, you must run it on a Windows Forms message loop.</span></span> <span data-ttu-id="bc2b3-144">K tomu použijte jeden z následujících přístupů:</span><span class="sxs-lookup"><span data-stu-id="bc2b3-144">To do this, use one of the following approaches:</span></span>  
  
- <span data-ttu-id="bc2b3-145">K zobrazení formuláře Windows použijte metodu <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-145">Use the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method to display the Windows Form.</span></span> <span data-ttu-id="bc2b3-146">Další informace najdete v tématu [Postupy: Podpora zprostředkovatele komunikace s objekty COM zobrazením formuláře Windows pomocí metody ShowDialog](com-interop-by-displaying-a-windows-form-shadow.md).</span><span class="sxs-lookup"><span data-stu-id="bc2b3-146">For more information, see [How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](com-interop-by-displaying-a-windows-form-shadow.md).</span></span>  
  
- <span data-ttu-id="bc2b3-147">Zobrazí každý formulář Windows na novém vlákně.</span><span class="sxs-lookup"><span data-stu-id="bc2b3-147">Display each Windows Form on a new thread.</span></span> <span data-ttu-id="bc2b3-148">Další informace najdete v tématu [Postupy: Podpora zprostředkovatele komunikace s objekty COM zobrazením jednotlivých formulářů Windows ve vlastním vlákně](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span><span class="sxs-lookup"><span data-stu-id="bc2b3-148">For more information, see [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bc2b3-149">Viz také</span><span class="sxs-lookup"><span data-stu-id="bc2b3-149">See also</span></span>

- [<span data-ttu-id="bc2b3-150">Model Windows Forms a nespravované aplikace</span><span class="sxs-lookup"><span data-stu-id="bc2b3-150">Windows Forms and Unmanaged Applications</span></span>](windows-forms-and-unmanaged-applications.md)
- [<span data-ttu-id="bc2b3-151">Zprostředkovatel komunikace s objekty COM</span><span class="sxs-lookup"><span data-stu-id="bc2b3-151">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)
- [<span data-ttu-id="bc2b3-152">Interoperabilita modelů COM v aplikacích .NET Framework</span><span class="sxs-lookup"><span data-stu-id="bc2b3-152">COM Interoperability in .NET Framework Applications</span></span>](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)
- <span data-ttu-id="bc2b3-153">[Ukázky vzájemné funkční spolupráce modelu COM](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="bc2b3-153">[COM Interoperability Samples](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span></span>
- [<span data-ttu-id="bc2b3-154">Aximp.exe (importér ovládacích prvků ActiveX Windows Forms)</span><span class="sxs-lookup"><span data-stu-id="bc2b3-154">Aximp.exe (Windows Forms ActiveX Control Importer)</span></span>](../../tools/aximp-exe-windows-forms-activex-control-importer.md)
- [<span data-ttu-id="bc2b3-155">Vystavení komponent architektury .NET Framework pro COM</span><span class="sxs-lookup"><span data-stu-id="bc2b3-155">Exposing .NET Framework Components to COM</span></span>](../../interop/exposing-dotnet-components-to-com.md)
- [<span data-ttu-id="bc2b3-156">Zabalení sestavení pro model COM</span><span class="sxs-lookup"><span data-stu-id="bc2b3-156">Packaging an Assembly for COM</span></span>](../../interop/packaging-an-assembly-for-com.md)
- [<span data-ttu-id="bc2b3-157">Registrování sestav pomocí modelu COM</span><span class="sxs-lookup"><span data-stu-id="bc2b3-157">Registering Assemblies with COM</span></span>](../../interop/registering-assemblies-with-com.md)
- [<span data-ttu-id="bc2b3-158">Postupy: Podpora zprostředkovatele komunikace s objekty COM zobrazením formuláře Windows pomocí metody ShowDialog</span><span class="sxs-lookup"><span data-stu-id="bc2b3-158">How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method</span></span>](com-interop-by-displaying-a-windows-form-shadow.md)
- [<span data-ttu-id="bc2b3-159">Postupy: Podpora komunikace s objekty COM zobrazením jednotlivých formulářů Windows ve vlastním vlákně</span><span class="sxs-lookup"><span data-stu-id="bc2b3-159">How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread</span></span>](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)
