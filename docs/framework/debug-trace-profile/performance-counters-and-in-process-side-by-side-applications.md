---
title: Čítače výkonu a vnitroprocesorové souběžné aplikace
description: Zkontrolujte čítače výkonu a vnitroprocesové souběžné aplikace v .NET. Pomocí Perfmon.exe můžete odlišit čítače výkonu na základě za běhu.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- performance counters
- performance counters,and in-process side-by-side applications
- performance,.NET Framework applications
- performance monitoring,counters
ms.assetid: 6888f9be-c65b-4b03-a07b-df7ebdee2436
ms.openlocfilehash: eb05d9f5f930420827c6b3d94ea0ed34f64464fd
ms.sourcegitcommit: c23d9666ec75b91741da43ee3d91c317d68c7327
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/01/2020
ms.locfileid: "85803856"
---
# <a name="performance-counters-and-in-process-side-by-side-applications"></a><span data-ttu-id="60098-104">Čítače výkonu a vnitroprocesorové souběžné aplikace</span><span class="sxs-lookup"><span data-stu-id="60098-104">Performance Counters and In-Process Side-By-Side Applications</span></span>
<span data-ttu-id="60098-105">Pomocí nástroje sledování výkonu (Perfmon.exe) je možné odlišit čítače výkonu v závislosti na modulu runtime.</span><span class="sxs-lookup"><span data-stu-id="60098-105">Using the Performance Monitor (Perfmon.exe), it is possible to differentiate the performance counters on a per-runtime basis.</span></span> <span data-ttu-id="60098-106">Toto téma popisuje změnu registru nutnou k povolení této funkce.</span><span class="sxs-lookup"><span data-stu-id="60098-106">This topic describes the registry change needed to enable this functionality.</span></span>  
  
## <a name="the-default-behavior"></a><span data-ttu-id="60098-107">Výchozí chování</span><span class="sxs-lookup"><span data-stu-id="60098-107">The Default Behavior</span></span>  
 <span data-ttu-id="60098-108">Ve výchozím nastavení monitor výkonu zobrazuje čítače výkonu na základě jednotlivých aplikací.</span><span class="sxs-lookup"><span data-stu-id="60098-108">By default, the Performance Monitor displays performance counters on a per-application basis.</span></span> <span data-ttu-id="60098-109">Existují však dva scénáře, ve kterých je to problematické:</span><span class="sxs-lookup"><span data-stu-id="60098-109">However, there are two scenarios in which this is problematic:</span></span>  
  
- <span data-ttu-id="60098-110">Když sledujete dvě aplikace, které mají stejný název.</span><span class="sxs-lookup"><span data-stu-id="60098-110">When you monitor two applications that have the same name.</span></span> <span data-ttu-id="60098-111">Například pokud jsou obě aplikace pojmenovány myapp.exe, zobrazí se jedna jako **MyApp** a druhá jako **MyApp # 1** ve sloupci **instance** .</span><span class="sxs-lookup"><span data-stu-id="60098-111">For example, if both applications are named myapp.exe, one will be displayed as **myapp** and the other as **myapp#1** in the **Instance** column.</span></span> <span data-ttu-id="60098-112">V takovém případě je obtížné porovnat čítač výkonu s určitou aplikací.</span><span class="sxs-lookup"><span data-stu-id="60098-112">In this case, it is difficult to match a performance counter to a particular application.</span></span> <span data-ttu-id="60098-113">Není jasné, zda data shromážděná pro **MyApp # 1** odkazují na první myapp.exe nebo druhý myapp.exe.</span><span class="sxs-lookup"><span data-stu-id="60098-113">It is not clear whether the data collected for **myapp#1** refers to the first myapp.exe or the second myapp.exe.</span></span>  
  
- <span data-ttu-id="60098-114">Když aplikace používá více instancí modulu CLR (Common Language Runtime).</span><span class="sxs-lookup"><span data-stu-id="60098-114">When an application uses multiple instances of the common language runtime.</span></span> <span data-ttu-id="60098-115">.NET Framework 4 podporuje scénáře souběžného hostování v procesu; To znamená, že jeden proces nebo aplikace může načíst více instancí modulu CLR (Common Language Runtime).</span><span class="sxs-lookup"><span data-stu-id="60098-115">The .NET Framework 4 supports in-process side-by-side hosting scenarios; that is, a single process or application can load multiple instances of the common language runtime.</span></span> <span data-ttu-id="60098-116">Pokud jedna aplikace s názvem myapp.exe načte dvě běhové instance, ve výchozím nastavení budou označeny ve sloupci **instance** jako **MyApp** a **MyApp # 1**.</span><span class="sxs-lookup"><span data-stu-id="60098-116">If a single application named myapp.exe loads two runtime instances, by default, they will be designated in the **Instance** column as **myapp** and **myapp#1**.</span></span> <span data-ttu-id="60098-117">V tomto případě není jasné, zda **MyApp** a **MyApp # 1** odkazují na dvě aplikace se stejným názvem nebo na stejnou aplikaci se dvěma moduly runtime.</span><span class="sxs-lookup"><span data-stu-id="60098-117">In this case, it is not clear whether **myapp** and **myapp#1** refer to two applications with the same name, or to the same application with two runtimes.</span></span> <span data-ttu-id="60098-118">Pokud více aplikací se stejným názvem načte více modulů runtime, nejednoznačnost je ještě větší.</span><span class="sxs-lookup"><span data-stu-id="60098-118">If multiple applications with the same name load multiple runtimes, the ambiguity is even greater.</span></span>  
  
 <span data-ttu-id="60098-119">Můžete nastavit klíč registru, který eliminuje tuto nejednoznačnost.</span><span class="sxs-lookup"><span data-stu-id="60098-119">You can set a registry key to eliminate this ambiguity.</span></span> <span data-ttu-id="60098-120">U aplikací vyvinutých pomocí .NET Framework 4 přidá tato změna registru identifikátor procesu následovaný identifikátorem instance modulu runtime do názvu aplikace ve sloupci **instance** .</span><span class="sxs-lookup"><span data-stu-id="60098-120">For applications developed using the .NET Framework 4, this registry change adds a process identifier followed by a runtime instance identifier to the application name in the **Instance** column.</span></span> <span data-ttu-id="60098-121">Namísto #1 *aplikace* nebo *aplikace*je nyní aplikace označena jako *Application*_ `p` *ProcessID* \_ `r` *runtimeID* ve sloupci **instance** .</span><span class="sxs-lookup"><span data-stu-id="60098-121">Instead of *application* or *application*#1, the application is now identified as *application*_`p`*processID*\_`r`*runtimeID* in the **Instance** column.</span></span> <span data-ttu-id="60098-122">Pokud byla aplikace vyvinuta pomocí předchozí verze modulu CLR (Common Language Runtime), je tato instance reprezentovaná jako \* \_ Application\* `p` *ProcessID* , pokud je nainstalovaná .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="60098-122">If an application was developed using a previous version of the common language runtime, that instance is represented as *application\_*`p`*processID* provided that the .NET Framework 4 is installed.</span></span>  
  
## <a name="performance-counters-for-in-process-side-by-side-applications"></a><span data-ttu-id="60098-123">Čítače výkonu pro vnitroprocesové souběžné aplikace</span><span class="sxs-lookup"><span data-stu-id="60098-123">Performance Counters for In-Process Side-by-Side Applications</span></span>  
 <span data-ttu-id="60098-124">Chcete-li zpracovat čítače výkonu pro více verzí modulu CLR, které jsou hostovány v jediné aplikaci, je nutné změnit nastavení jednoho klíče registru, jak je znázorněno v následující tabulce.</span><span class="sxs-lookup"><span data-stu-id="60098-124">To handle performance counters for multiple common language runtime versions that are hosted in a single application, you must change a single registry key setting, as shown in the following table.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="60098-125">Název klíče</span><span class="sxs-lookup"><span data-stu-id="60098-125">Key name</span></span>|<span data-ttu-id="60098-126">HKEY_LOCAL_MACHINE \System\CurrentControlSet\Services \\ . NETFramework\Performance</span><span class="sxs-lookup"><span data-stu-id="60098-126">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\\.NETFramework\Performance</span></span>|  
|<span data-ttu-id="60098-127">Název hodnoty</span><span class="sxs-lookup"><span data-stu-id="60098-127">Value name</span></span>|<span data-ttu-id="60098-128">ProcessNameFormat</span><span class="sxs-lookup"><span data-stu-id="60098-128">ProcessNameFormat</span></span>|  
|<span data-ttu-id="60098-129">Typ hodnoty</span><span class="sxs-lookup"><span data-stu-id="60098-129">Value type</span></span>|<span data-ttu-id="60098-130">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="60098-130">REG_DWORD</span></span>|  
|<span data-ttu-id="60098-131">Hodnota</span><span class="sxs-lookup"><span data-stu-id="60098-131">Value</span></span>|<span data-ttu-id="60098-132">1 (0x00000001)</span><span class="sxs-lookup"><span data-stu-id="60098-132">1 (0x00000001)</span></span>|  
  
 <span data-ttu-id="60098-133">Hodnota 0 pro `ProcessNameFormat` označuje, že je povoleno výchozí chování; to znamená, že Perfmon.exe zobrazuje čítače výkonu na základě jednotlivých aplikací.</span><span class="sxs-lookup"><span data-stu-id="60098-133">A value of 0 for `ProcessNameFormat` indicates that the default behavior is enabled; that is, Perfmon.exe displays performance counters on a per-application basis.</span></span> <span data-ttu-id="60098-134">Když nastavíte tuto hodnotu na 1, Perfmon.exe nejednoznačně více verzí aplikace a poskytuje čítače výkonu pro jednotlivé moduly runtime.</span><span class="sxs-lookup"><span data-stu-id="60098-134">When you set this value to 1, Perfmon.exe disambiguates multiple versions of an application and provides performance counters on a per-runtime basis.</span></span> <span data-ttu-id="60098-135">Jakákoli jiná hodnota `ProcessNameFormat` nastavení klíče registru není podporována a je vyhrazena pro budoucí použití.</span><span class="sxs-lookup"><span data-stu-id="60098-135">Any other value for the `ProcessNameFormat` registry key setting is unsupported and reserved for future use.</span></span>  
  
 <span data-ttu-id="60098-136">Po aktualizaci `ProcessNameFormat` nastavení klíče registru je nutné restartovat Perfmon.exe nebo jakékoli jiné uživatele čítačů výkonu, aby nová funkce pro pojmenování instancí fungovala správně.</span><span class="sxs-lookup"><span data-stu-id="60098-136">After you update the `ProcessNameFormat` registry key setting, you must restart Perfmon.exe or any other consumers of performance counters so that the new instance naming feature works correctly.</span></span>  
  
 <span data-ttu-id="60098-137">Následující příklad ukazuje, jak změnit `ProcessNameFormat` hodnotu programově.</span><span class="sxs-lookup"><span data-stu-id="60098-137">The following example shows how to change the `ProcessNameFormat` value programmatically.</span></span>  
  
 [!code-csharp[Conceptual.PerfCounters.InProSxS#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.perfcounters.inprosxs/cs/regsetting1.cs#1)]
 [!code-vb[Conceptual.PerfCounters.InProSxS#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.perfcounters.inprosxs/vb/regsetting1.vb#1)]  
  
 <span data-ttu-id="60098-138">Po provedení této změny registru Perfmon.exe zobrazí názvy aplikací, které cílí na .NET Framework 4 jako *aplikace*_ `p` *ProcessID* \_ `r` *runtimeID*, kde *aplikace* je název aplikace, identifikátor *ID* procesu aplikace a *runtimeID* je identifikátor společného jazykového modulu runtime.</span><span class="sxs-lookup"><span data-stu-id="60098-138">When you make this registry change, Perfmon.exe displays the names of applications that target the .NET Framework 4 as *application*_`p`*processID*\_`r`*runtimeID*, where *application* is the name of the application, *processID* is the application's process identifier, and *runtimeID* is a common language runtime identifier.</span></span> <span data-ttu-id="60098-139">Například pokud aplikace s názvem myapp.exe načte dvě instance modulu CLR (Common Language Runtime), Perfmon.exe může identifikovat jednu instanci jako myapp_p1416_r10 a druhou jako myapp_p3160_r10.</span><span class="sxs-lookup"><span data-stu-id="60098-139">For example, if an application named myapp.exe loads two instances of the common language runtime, Perfmon.exe may identify one instance as myapp_p1416_r10 and the second as myapp_p3160_r10.</span></span> <span data-ttu-id="60098-140">Identifikátor modulu runtime nejednoznačně modul runtime v rámci procesu; neposkytuje žádné další informace o modulu runtime.</span><span class="sxs-lookup"><span data-stu-id="60098-140">The runtime identifier only disambiguates the runtimes within a process; it does not provide any other information about the runtime.</span></span> <span data-ttu-id="60098-141">(Například běhové ID nemá žádný vztah k verzi nebo SKU modulu runtime.)</span><span class="sxs-lookup"><span data-stu-id="60098-141">(For example, the runtime ID has no relation to the version or the SKU of the runtime.)</span></span>  
  
 <span data-ttu-id="60098-142">Pokud je nainstalovaná .NET Framework 4, změna registru ovlivní také aplikace, které byly vyvinuty pomocí předchozích verzí .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="60098-142">If the .NET Framework 4 is installed, the registry change also affects applications that were developed using earlier versions of the .NET Framework.</span></span> <span data-ttu-id="60098-143">Ty se zobrazí v Perfmon.exe jako *Application_* `p` *ProcessID*, kde *aplikace* je název aplikace a *ProcessID* je identifikátor procesu.</span><span class="sxs-lookup"><span data-stu-id="60098-143">These appear in Perfmon.exe as *application_*`p`*processID*, where *application* is the application name and *processID* is the process identifier.</span></span> <span data-ttu-id="60098-144">Například pokud jsou monitorovány čítače výkonu dvou aplikací s názvem myapp.exe, může se jedna zobrazit jako myapp_p23900 a druhá jako myapp_p24908.</span><span class="sxs-lookup"><span data-stu-id="60098-144">For example, if the performance counters of two applications named myapp.exe are monitored, one might appear as myapp_p23900 and the other as myapp_p24908.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="60098-145">Identifikátor procesu eliminuje nejednoznačnost při řešení dvou aplikací se stejným názvem, které používají starší verze modulu runtime.</span><span class="sxs-lookup"><span data-stu-id="60098-145">The process identifier eliminates the ambiguity of resolving two applications with the same name that use earlier versions of the runtime.</span></span> <span data-ttu-id="60098-146">Identifikátor modulu runtime není pro předchozí verze vyžadován, protože předchozí verze modulu CLR (Common Language Runtime) nepodporují souběžné scénáře.</span><span class="sxs-lookup"><span data-stu-id="60098-146">A runtime identifier is not required for previous versions, because previous versions of the common language runtime do not support side-by-side scenarios.</span></span>  
  
 <span data-ttu-id="60098-147">Pokud .NET Framework 4 není k dispozici nebo byl odinstalován, nastavení klíče registru nemá žádný vliv.</span><span class="sxs-lookup"><span data-stu-id="60098-147">If the .NET Framework 4 is not present or was uninstalled, setting the registry key has no effect.</span></span> <span data-ttu-id="60098-148">To znamená, že se dvě aplikace se stejným názvem budou nadále zobrazovat v Perfmon.exe jako *aplikace* a *aplikace # 1* (například jako **MyApp** a **MyApp # 1**).</span><span class="sxs-lookup"><span data-stu-id="60098-148">This means that two applications with the same name will continue to appear in Perfmon.exe as *application* and *application#1* (for example, as **myapp** and **myapp#1**).</span></span>
