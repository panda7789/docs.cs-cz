---
title: Usnadnění ladění v rozhraní .NET bitovou kopii
description: Zjistěte, jak nakonfigurovat spustitelnou bitovou kopii pro snazší ladění pomocí integrovaného vývojového prostředí přepínače a možnosti příkazového řádku.
ms.date: 08/30/2018
helpviewer_keywords:
- images [.NET Framework], debugging
- executable image for debugging
- debugging [.NET Framework], executable images for
ms.assetid: 7d90ea7a-150f-4f97-98a7-f9c26541b9a3
author: mairaw
ms.author: mairaw
ms.openlocfilehash: 7f25eaaa17d4c4bd2e9522591bb0fd66445cdb6f
ms.sourcegitcommit: 76a304c79a32aa13889ebcf4b9789a4542b48e3e
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 09/13/2018
ms.locfileid: "45516695"
---
# <a name="making-an-image-easier-to-debug-in-net"></a><span data-ttu-id="c38a2-103">Usnadnění ladění v rozhraní .NET bitovou kopii</span><span class="sxs-lookup"><span data-stu-id="c38a2-103">Making an image easier to debug in .NET</span></span>

<span data-ttu-id="c38a2-104">Při kompilaci nespravovaného kódu je možné nakonfigurovat spustitelnou bitovou kopii pro ladění nastavením přepínačů IDE nebo parametrů příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="c38a2-104">When compiling unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options.</span></span> <span data-ttu-id="c38a2-105">Například můžete použít /**Zi** možnost příkazového řádku v jazyce Visual C++ klást na souborů ladění symbolů (přípona souboru .pdb).</span><span class="sxs-lookup"><span data-stu-id="c38a2-105">For example, you can use the /**Zi** command-line option in Visual C++ to ask it to emit debug symbol files (file extension .pdb).</span></span> <span data-ttu-id="c38a2-106">Podobně /**Od** možnost příkazového řádku instruuje kompilátor, aby zakáže optimalizaci.</span><span class="sxs-lookup"><span data-stu-id="c38a2-106">Similarly, the /**Od** command-line option tells the compiler to disable optimization.</span></span> <span data-ttu-id="c38a2-107">Výsledný kód pracuje pomaleji, ale je snazší ladit, musí to být nutné.</span><span class="sxs-lookup"><span data-stu-id="c38a2-107">The resulting code runs more slowly, but it's easier to debug, should this be necessary.</span></span>

<span data-ttu-id="c38a2-108">Při kompilaci rozhraní .NET Framework spravovaného kódu, kompilovat kompilátory jazyků jako Visual C++, Visual Basic a C# vlastní zdrojové programy do jazyka Microsoft intermediate language (MSIL).</span><span class="sxs-lookup"><span data-stu-id="c38a2-108">When compiling .NET Framework managed code, compilers such as Visual C++, Visual Basic, and C# compile their source program into Microsoft intermediate language (MSIL).</span></span> <span data-ttu-id="c38a2-109">Jazyk MSIL je následně zkompilovaný pomocí kompilátoru JIT, těsně před spuštěním do nativního strojového kódu.</span><span class="sxs-lookup"><span data-stu-id="c38a2-109">MSIL is then JIT-compiled, just before execution, into native machine code.</span></span> <span data-ttu-id="c38a2-110">Stejně jako u nespravovaného kódu je možné nakonfigurovat spustitelnou bitovou kopii pro ladění nastavením přepínačů IDE nebo parametrů příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="c38a2-110">As with unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options.</span></span> <span data-ttu-id="c38a2-111">Můžete také nakonfigurovat JIT kompilaci pro ladění v podstatě stejným způsobem.</span><span class="sxs-lookup"><span data-stu-id="c38a2-111">You can also configure the JIT compilation for debugging in much the same way.</span></span>

<span data-ttu-id="c38a2-112">Tato konfigurace JIT má dva aspekty:</span><span class="sxs-lookup"><span data-stu-id="c38a2-112">This JIT configuration has two aspects:</span></span>

- <span data-ttu-id="c38a2-113">Můžete požádat o JIT kompilátoru generování informací o sledování.</span><span class="sxs-lookup"><span data-stu-id="c38a2-113">You can request the JIT compiler to generate tracking information.</span></span> <span data-ttu-id="c38a2-114">To umožňuje ladicímu programu nalézt shodu se svým protějškem strojového kódu řetězce jazyka MSIL a sledovat, kde jsou uloženy místní proměnné a argumenty funkce.</span><span class="sxs-lookup"><span data-stu-id="c38a2-114">This makes it possible for the debugger to match up a chain of MSIL with its machine code counterpart, and to track where local variables and function arguments are stored.</span></span> <span data-ttu-id="c38a2-115">Od verze rozhraní .NET Framework verze 2.0, kompilátor JIT vždy generovat informace o sledování, takže není nutné o ně žádat.</span><span class="sxs-lookup"><span data-stu-id="c38a2-115">Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information, so there is no need to request it.</span></span>

- <span data-ttu-id="c38a2-116">Můžete požádat o kompilátor JIT, aby neprováděl optimalizaci výsledného strojového kódu.</span><span class="sxs-lookup"><span data-stu-id="c38a2-116">You can request the JIT compiler to not optimize the resulting machine code.</span></span>

<span data-ttu-id="c38a2-117">Za normálních okolností kompilátor, který generuje jazyk MSIL nastaví tyto možnosti kompilátoru JIT vhodným způsobem, na základě přepínačů IDE nebo parametrů příkazového řádku zadáte, například /**Od**.</span><span class="sxs-lookup"><span data-stu-id="c38a2-117">Normally, the compiler that generates the MSIL sets these JIT compiler options appropriately, based upon the IDE switches or command-line options you specify, for example, /**Od**.</span></span>

<span data-ttu-id="c38a2-118">V některých případech bude zapotřebí změnit chování kompilátoru JIT tak, aby bylo možné strojový kód, který generuje, snadněji ladit.</span><span class="sxs-lookup"><span data-stu-id="c38a2-118">In some cases, you might want to change the behavior of the JIT compiler so that the machine code it generates is easier to debug.</span></span> <span data-ttu-id="c38a2-119">Například může být třeba generovat informace o sledování JIT pro sestavení prodejní verze nebo pro optimalizaci řízení.</span><span class="sxs-lookup"><span data-stu-id="c38a2-119">For example, you might want to generate JIT tracking information for a retail build or control optimization.</span></span> <span data-ttu-id="c38a2-120">To lze provést pomocí inicializačního souboru (.ini).</span><span class="sxs-lookup"><span data-stu-id="c38a2-120">You can do so with an initialization (.ini) file.</span></span>

<span data-ttu-id="c38a2-121">Například, pokud sestavení, který chcete ladit nazývá *MyApp.exe*, můžete vytvořit textový soubor s názvem *MyApp.ini*, ve stejné složce jako *MyApp.exe*, které obsahuje Tyto tři řádky:</span><span class="sxs-lookup"><span data-stu-id="c38a2-121">For example, if the assembly you want to debug is called *MyApp.exe*, then you can create a text file named *MyApp.ini*, in the same folder as *MyApp.exe*, which contains these three lines:</span></span>

```txt
[.NET Framework Debugging Control]
GenerateTrackingInfo=1
AllowOptimize=0
```

<span data-ttu-id="c38a2-122">Hodnotu každé možnosti lze nastavit na 0 nebo 1 a chybějící možnost bude mít výchozí hodnotu 0.</span><span class="sxs-lookup"><span data-stu-id="c38a2-122">You can set the value of each option to 0 or 1, and any absent option defaults to 0.</span></span> <span data-ttu-id="c38a2-123">Nastavení volby `GenerateTrackingInfo` na hodnotu 1 a volby `AllowOptimize` na hodnotu 0 poskytuje nejjednodušší ladění.</span><span class="sxs-lookup"><span data-stu-id="c38a2-123">Setting `GenerateTrackingInfo` to 1 and `AllowOptimize` to 0 provides the easiest debugging.</span></span>

<span data-ttu-id="c38a2-124">Od verze rozhraní .NET Framework verze 2.0, kompilátor JIT vždy generovat informace o sledování bez ohledu na hodnotu pro `GenerateTrackingInfo`, nicméně `AllowOptimize` hodnota stále má vliv.</span><span class="sxs-lookup"><span data-stu-id="c38a2-124">Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information regardless of the value for `GenerateTrackingInfo`; however, the `AllowOptimize` value still has an effect.</span></span> <span data-ttu-id="c38a2-125">Při použití [Ngen.exe (Generátor nativních obrázků)](../../../docs/framework/tools/ngen-exe-native-image-generator.md) předkompilování nativní bitové kopie bez optimalizace, musí být k dispozici v cílové složce s souboru INI `AllowOptimize=0` při Ngen.exe spustí.</span><span class="sxs-lookup"><span data-stu-id="c38a2-125">When using the [Ngen.exe (Native Image Generator)](../../../docs/framework/tools/ngen-exe-native-image-generator.md) to precompile the native image without optimization, the .ini file must be present in the target folder with `AllowOptimize=0` when Ngen.exe executes.</span></span> <span data-ttu-id="c38a2-126">Pokud máte předkompilovaných sestavení bez optimalizace, je nutné odebrat předkompilovaný kód pomocí NGen.exe **/ uninstall** možnost před opětovným spuštěním Ngen.exe předkompilování kódu jako optimalizovaného.</span><span class="sxs-lookup"><span data-stu-id="c38a2-126">If you have precompiled an assembly without optimization, you must remove the precompiled code using NGen.exe **/uninstall** option before rerunning Ngen.exe to precompile the code as optimized.</span></span> <span data-ttu-id="c38a2-127">Pokud není k dispozici ve složce soubor .ini, Ngen.exe předkompilování kódu jako optimalizovaného.</span><span class="sxs-lookup"><span data-stu-id="c38a2-127">If the .ini file isn't present in the folder, by default Ngen.exe precompiles the code as optimized.</span></span>

<span data-ttu-id="c38a2-128"><xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType> určuje nastavení sestavení.</span><span class="sxs-lookup"><span data-stu-id="c38a2-128">The <xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType> controls the settings for an assembly.</span></span> <span data-ttu-id="c38a2-129">**DebuggableAttribute** obsahuje dvě pole určující, zda kompilátor JIT by měl optimalizaci a/nebo generovat informace o sledování.</span><span class="sxs-lookup"><span data-stu-id="c38a2-129">**DebuggableAttribute** includes two fields that control whether the JIT compiler should optimize and/or generate tracking information.</span></span> <span data-ttu-id="c38a2-130">Od verze rozhraní .NET Framework verze 2.0, kompilátor JIT vždy generovat informace o sledování.</span><span class="sxs-lookup"><span data-stu-id="c38a2-130">Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information.</span></span>

<span data-ttu-id="c38a2-131">Pro sestavení prodejní verze, kompilátory nemají nastavený žádný **DebuggableAttribute**.</span><span class="sxs-lookup"><span data-stu-id="c38a2-131">For a retail build, compilers don't set any **DebuggableAttribute**.</span></span> <span data-ttu-id="c38a2-132">Ve výchozím nastavení vygeneruje kompilátor JIT nejvyšší výkon s nejtěžší možností ladění strojového kódu.</span><span class="sxs-lookup"><span data-stu-id="c38a2-132">By default, the JIT compiler generates the highest performance, hardest to debug machine code.</span></span> <span data-ttu-id="c38a2-133">Povolením JIT sledování se snižuje výkon a vypnutím optimalizace se výkon razantně snižuje.</span><span class="sxs-lookup"><span data-stu-id="c38a2-133">Enabling JIT tracking lowers performance a little, and disabling optimization lowers performance a lot.</span></span>

<span data-ttu-id="c38a2-134">**DebuggableAttribute** se vztahuje na celé sestavení najednou, nikoli na jednotlivé moduly v rámci sestavení.</span><span class="sxs-lookup"><span data-stu-id="c38a2-134">The **DebuggableAttribute** applies to a whole assembly at a time, not to individual modules within the assembly.</span></span> <span data-ttu-id="c38a2-135">Nástroje pro vývoj proto musí připojit vlastní atributy k tokenu metadat sestavení, pokud sestavení má již byl vytvořen, nebo ke třídě s názvem **System.Runtime.CompilerServices.AssemblyAttributesGoHere**.</span><span class="sxs-lookup"><span data-stu-id="c38a2-135">Development tools must therefore attach custom attributes to the assembly metadata token, if an assembly has already been created, or to the class called **System.Runtime.CompilerServices.AssemblyAttributesGoHere**.</span></span> <span data-ttu-id="c38a2-136">Nástroj ALink následně podporuje tyto **DebuggableAttribute** atributy z každého modulu na sestavení stanou součástí.</span><span class="sxs-lookup"><span data-stu-id="c38a2-136">The ALink tool then promotes these **DebuggableAttribute** attributes from each module to the assembly they become a part of.</span></span> <span data-ttu-id="c38a2-137">Pokud dojde ke konfliktu, operace nástroje ALink se nezdaří.</span><span class="sxs-lookup"><span data-stu-id="c38a2-137">If there's a conflict, the ALink operation fails.</span></span>

> [!NOTE]
> <span data-ttu-id="c38a2-138">V rozhraní .NET Framework verze 1.0, přidá kompilátor jazyka Microsoft Visual C++ **DebuggableAttribute** při **/CLR** a **/zi** jsou zadány možnosti kompilátoru.</span><span class="sxs-lookup"><span data-stu-id="c38a2-138">In version 1.0 of the .NET Framework, the Microsoft Visual C++ compiler adds the **DebuggableAttribute** when the **/clr** and **/Zi** compiler options are specified.</span></span> <span data-ttu-id="c38a2-139">Ve verzi 1.1 rozhraní .NET Framework, musíte buď přidat **DebugabbleAttribute** ručně v kódu nebo použití **/assemblydebug** – možnost linkeru.</span><span class="sxs-lookup"><span data-stu-id="c38a2-139">In version 1.1 of the .NET Framework, you must either add the **DebugabbleAttribute** manually in your code or use the **/ASSEMBLYDEBUG** linker option.</span></span>

## <a name="see-also"></a><span data-ttu-id="c38a2-140">Viz také:</span><span class="sxs-lookup"><span data-stu-id="c38a2-140">See also</span></span>

- [<span data-ttu-id="c38a2-141">Ladění, trasování a profilace</span><span class="sxs-lookup"><span data-stu-id="c38a2-141">Debugging, Tracing, and Profiling</span></span>](../../../docs/framework/debug-trace-profile/index.md)
- [<span data-ttu-id="c38a2-142">Povolení JIT – ladění Attach</span><span class="sxs-lookup"><span data-stu-id="c38a2-142">Enabling JIT-Attach Debugging</span></span>](../../../docs/framework/debug-trace-profile/enabling-jit-attach-debugging.md)
- <span data-ttu-id="c38a2-143">[Povolení profilace](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/s5ec0es1(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="c38a2-143">[Enabling Profiling](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/s5ec0es1(v=vs.100))</span></span>
