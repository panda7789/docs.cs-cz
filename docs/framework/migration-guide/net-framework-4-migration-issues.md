---
title: Problémy s migrací rozhraní .NET Framework 4
ms.date: 05/02/2017
helpviewer_keywords:
- .NET Framework 4, migration
- application compatibility
ms.assetid: df478548-8c05-4de2-8ba7-adcdbe1c2a60
ms.openlocfilehash: 200acea81b9f00c659ddceae011430983e2b5f5b
ms.sourcegitcommit: c91110ef6ee3fedb591f3d628dc17739c4a7071e
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/15/2020
ms.locfileid: "81389713"
---
# <a name="net-framework-4-migration-issues"></a>Problémy s migrací rozhraní .NET Framework 4

Tento článek popisuje problémy s migrací mezi rozhraními .NET Framework verze 3.5 Service Pack 1 a rozhraní .NET Framework verze 4, včetně oprav, změn dodržování standardů a zabezpečení a změn na základě zpětné vazby od zákazníků. Většina těchto změn nevyžaduje žádné programové změny v aplikacích. Ty, které mohou zahrnovat změny, naleznete v části **Doporučené změny** v tabulce. Významné změny jsou rozděleny podle oblasti, například ASP.NET a Windows Presentation Foundation (WPF).

Přehled problémů v tomto článku na vyšší úrovni naleznete v [tématu Migration Guide to .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff657133%28v=vs.100%29).

Informace o nových funkcích naleznete [v tématu What's New in .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms171868%28v=vs.100%29).

## <a name="aspnet-and-web"></a>ASP.NET a Web

Jmenné <xref:System.Web>prostory: , <xref:System.Web.Mobile>, <xref:System.Web.Security>,<xref:System.Web.UI.WebControls>

Sestava: System.Web (v souboru System.Web.dll)

| Funkce  | Rozdíly od 3,5 SP1 | Doporučené změny |
| -------- | ------------------------ | ------------------- |
| **Soubory definic prohlížeče** | Soubory definic prohlížeče byly aktualizovány tak, aby obsahovaly informace o nových a aktualizovaných prohlížečích a zařízeních. Starší prohlížeče a zařízení, jako je Netscape Navigator, byly odstraněny a byly přidány novější prohlížeče a zařízení, jako je Google Chrome a Apple iPhone.<br><br>Pokud aplikace obsahuje vlastní definice prohlížeče, které dědí z jedné z definic prohlížeče, které byly odebrány, zobrazí se chyba.<br><br>Objekt <xref:System.Web.HttpBrowserCapabilities> (který je vystaven `Request.Browse` vlastností stránky) je řízen soubory definice prohlížeče. Proto informace, které jsou vráceny přístupem k vlastnosti tohoto objektu v ASP.NET 4 může lišit od informace, která byla vrácena v dřívější verzi ASP.NET. | Pokud vaše aplikace závisí na starých definičních souborech prohlížeče, můžete je zkopírovat z následující složky:<br><br>*Windows\\\\Microsoft.NET\\Framework v2.0.50727\\CONFIG\\prohlížeče*<br><br>Zkopírujte soubory do * \\\\* odpovídající složky CONFIG Browsers pro ASP.NET 4. Po zkopírování souborů spusťte nástroj příkazového řádku [Aspnet_regbrowsers.exe.](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms229858(v=vs.90)) Další informace naleznete [https://www.asp.net/mobile](/aspnet/mobile/overview) na webu. |
| **Podřízené aplikace spuštěné pod smíšenými verzemi ASP.NET** | ASP.NET 4 aplikace, které jsou konfigurovány jako podřízené aplikace, které používají starší verze ASP.NET může selhat ke spuštění z důvodu chyby konfigurace nebo kompilace. Konkrétní chyba, ke které dojde, závisí na tom, zda je aplikace spuštěna v rámci služby IIS 6.0 nebo ve službě IIS 7 nebo IIS 7.5. | Můžete provést změny v konfiguračních souborech ohrožených aplikací tak, aby konfigurační systém správně rozpoznal ASP.NET 4 aplikace. Informace o změnách, které je nutné provést, naleznete v části ASP.NET 4 Podřízených aplikací, které se nespustí, pokud jsou pod ASP.NET aplikace mise 2.0 nebo ASP.NET 3.5 v dokumentu [ASP.NET 4 Nejnovější změny](/aspnet/whitepapers/aspnet4/breaking-changes) na webu ASP.NET. |
| **Změny ID klienta** | Nové `clientIDMode` nastavení v ASP.NET 4 umožňuje určit, `id` jak ASP.NET generuje atribut pro elementy HTML. V předchozích verzích ASP.NET bylo výchozí `AutoID` chování `clientIDMode`ekvivalentní nastavení aplikace . Výchozí nastavení je `Predictable`nyní . Další informace naleznete [v tématu ASP.NET Identifikace ovládacího prvku webového serveru](https://docs.microsoft.com/previous-versions/aspnet/1d04y8ss%28v=vs.100%29). | Pokud používáte visual studio k upgradu aplikace z ASP.NET 2.0 nebo ASP.NET 3.5, nástroj automaticky přidá nastavení do souboru Web.config, který zachová chování předchozích verzí rozhraní .NET Framework. Pokud však inovujete aplikaci změnou fondu aplikací ve službách IIS na cílovou aplikaci .NET Framework 4, ASP.NET ve výchozím nastavení použije nový režim. Chcete-li zakázat nový režim ID klienta, přidejte do souboru Web.config následující nastavení:<br><br>`<pages clientIDMode="AutoID" />` |
| **Zabezpečení přístupu kódu (CAS)** | ASP.NET 2.0 NET funkce, které byly přidány v ASP.NET 3.5 použít .NET Framework 1.1 a .NET Framework 2.0 kód zabezpečení (CAS) model. Provádění CAS v ASP.NET 4 však bylo podstatně přepracováno. V důsledku toho může dojít k selhání ASP.NET aplikací s částečnou důvěryhodností, které spoléhají na důvěryhodný kód spuštěný v globální mezipaměti sestavení, s různými výjimkami zabezpečení. Aplikace s částečnou důvěryhodností, které spoléhají na rozsáhlé změny zásad CAS počítače, mohou také selhat a vyvolat výjimky zabezpečení. | Částečné důvěryhodnosti ASP.NET 4 aplikacím můžete vrátit k chování ASP.NET 1.1 `legacyCasModel` a 2.0 pomocí nového atributu v konfiguračním elementu, `trust` jak je znázorněno v následujícím příkladu:<br><br>`<trust level= "Medium" legacyCasModel="true" />`<br><br>Důležité: Návrat ke staršímu modelu CAS může představovat snížené zabezpečení.<br><br>Další informace o novém modelu zabezpečení přístupu kódu ASP.NET 4 naleznete [v tématu Zabezpečení přístupu ke kódu v ASP.NET 4 aplikace](https://docs.microsoft.com/previous-versions/dd984947(v=vs.100)). |
| **Konfigurační soubory** | Kořenové konfigurační soubory (soubor machine.config a kořenový soubor Web.config) pro rozhraní .NET Framework a ASP.NET 4 byly aktualizovány tak, aby zahrnovaly většinu často používaných konfiguračních informací, které byly nalezeny v souborech Web.config aplikace v ASP.NET 3.5. Vzhledem ke složitosti spravovaných konfiguračních systémů služby IIS 7 a IIS 7.5 může provoz ASP.NET 3,5 aplikací pod ASP.NET 4 a v rámci služby IIS 7 a IIS 7.5 způsobit chyby ASP.NET nebo iis. | Upgradujte ASP.NET 3,5 aplikací na ASP.NET 4 pomocí nástrojů pro upgrade projektu v sadě Visual Studio. Visual Studio 2010 automaticky upraví soubor Web.config aplikace ASP.NET 3.5 tak, aby obsahoval aobsahuje příslušná nastavení pro ASP.NET 4.<br><br>Můžete však spustit ASP.NET 3.5 aplikací pomocí rozhraní .NET Framework 4 bez rekompilace. V takovém případě bude pravděpodobně nutné ručně upravit soubor Web.config aplikace před spuštěním aplikace v rámci rozhraní .NET Framework 4 a iis 7 nebo IIS 7.5. Konkrétní změna, kterou musíte provést, závisí na kombinaci softwaru, se kterým pracujete, včetně verzí aktualizace Service Pack (SP). Informace o možných kombinacích softwaru, které jsou touto změnou ovlivněny, a o řešení problémů s určitými kombinacemi naleznete v části Chyby konfigurace související s novou ASP.NET kořenovou konfigurací 4 v dokumentu [ASP.NET 4 nejnovější změny](/aspnet/whitepapers/aspnet4/breaking-changes) na webu ASP.NET. |
| **Vykreslování ovládací** | V předchozích verzích ASP.NET některé ovládací prvky vyzařují značky, které nelze zakázat. Ve výchozím nastavení se tento typ značek již negeneruje v ASP.NET 4. Změny vykreslování ovlivní následující ovládací prvky:<br><br>* `Image` Ovládací `ImageButton` prvky a `border="0"` již vykreslují atribut.<br>* `BaseValidator` Třídy a ověřovací ovládací prvky, které jsou odvozeny z něj již vykreslovat červený text ve výchozím nastavení.<br>* `HtmlForm` Ovládací prvek nevykresluje `name` atribut.<br>* `Table` Ovládací prvek již `border="0"` vykreslí atribut.<br><br>Ovládací prvky, které nejsou určeny `Label` pro vstup uživatele `disabled="disabled"` (například `Enabled` ovládací prvek) již vykreslují atribut, pokud je jejich vlastnost nastavena na `false` (nebo pokud dědí toto nastavení z ovládacího prvku kontejneru). | Pokud používáte Visual Studio k upgradu aplikace z ASP.NET 2.0 nebo ASP.NET 3.5, nástroj automaticky přidá nastavení do souboru Web.config, který zachová starší vykreslování. Pokud však inovujete aplikaci změnou fondu aplikací ve službách IIS na cílovou aplikaci .NET Framework 4, ASP.NET ve výchozím nastavení použije nový režim vykreslování. Chcete-li zakázat nový režim vykreslování, přidejte do souboru Web.config následující nastavení:<br><br>`<pages controlRenderingCompatibilityVersion="3.5" />` |
| **Obslužné rutiny událostí ve výchozích dokumentech** | ASP.NET 4 vykreslí hodnotu `form` `action` atributu elementu HTML jako prázdný řetězec, když je požadavek na adresu URL bez rozšíření, která má namapovaný výchozí dokument. V dřívějších verzích ASP.NET `http://contoso.com` by požadavek na požadavek default.aspx. V tomto dokumentu `form` by byla počáteční značka vykreslena jako v následujícím příkladu:<br><br>`<form action="Default.aspx" />`<br><br>V ASP.NET 4, `http://contoso.com` požadavek také výsledkem požadavek default.aspx, ale `form` ASP.NET nyní vykreslí otevírací značku HTML jako v následujícím příkladu:<br><br>`<form action="" />`<br><br>Pokud `action` je atributem prázdný řetězec, `DefaultDocumentModule` vytvoří objekt služby IIS podřízený požadavek na soubor Default.aspx. Za většiny podmínek je tento podřízený požadavek transparentní pro kód aplikace a stránka Default.aspx se spouští normálně. Potenciální interakce mezi spravovaným kódem a integrovaným režimem služby IIS 7 nebo IIS 7.5 však může způsobit, že spravované stránky ASPX přestanou během podřízenéžádosti správně fungovat. Pokud nastanou následující podmínky, podřízený požadavek na výchozí dokument ASPX bude mít za následek chybu nebo neočekávané chování:<br><br>* Stránka ASPX je odeslána do `form` prohlížeče `action` s atributem prvku nastaveným na "".<br>* Formulář je zaúčtován zpět do ASP.NET.<br>* Spravovaný modul HTTP přečte určitou část těla entity, například `Request.Form` nebo `Request.Params`. To způsobí, že tělo entity požadavku POST číst do spravované paměti. V důsledku toho není tělo entity již k dispozici pro žádné moduly nativního kódu, které jsou spuštěny v integrovaném režimu služby IIS 7 nebo IIS 7.5.<br>* Objekt `DefaultDocumentModule` služby IIS se nakonec spustí a vytvoří podřízený požadavek do dokumentu Default.aspx. Protože však tělo entity již bylo přečteno částí spravovaného kódu, není k dispozici žádné tělo entity, které by bylo možné odeslat podřízenému požadavku.<br>* Při spuštění kanálu HTTP pro podřízený požadavek, obslužná rutina pro soubory ASPX spustí během fáze spuštění obslužné rutiny.<br><br>Vzhledem k tomu, že neexistuje žádné tělo entity, neexistují žádné proměnné formuláře a žádný stav zobrazení. Proto nejsou k dispozici žádné informace pro obslužnou rutinu stránky ASPX k určení, jaká událost (pokud existuje) by měla být vyvolána. V důsledku toho žádný z obslužné rutiny události postback pro ovlivněné stránky ASPX spustit. | Informace o způsobech řešení problémů, které mohou vzniknout v důsledku této změny, naleznete v tématu "Obslužné rutiny událostí nemusí být vyvolány ve výchozím dokumentu ve službě IIS 7 nebo iis 7.5 integrovaný režim" v dokumentu [ASP.NET 4 Nejnovější změny](/aspnet/whitepapers/aspnet4/breaking-changes) na webu ASP.NET. |
| **Algoritmus hash** | ASP.NET používá algoritmy šifrování i hašování k zabezpečení dat, jako jsou soubory cookie ověřování formulářů a stav zobrazení. Ve výchozím nastavení ASP.NET <xref:System.Security.Cryptography.HMACSHA256> 4 používá algoritmus pro operace hash na cookies a stav zobrazení. Starší verze ASP.NET používaly <xref:System.Security.Cryptography.HMACSHA1> starší algoritmus. | Pokud spouštěte aplikace, které kombinují ASP.NET 2.0 a ASP.NET 4, kde data, jako jsou soubory cookie <xref:System.Security.Cryptography.HMACSHA1> ověřování pomocí formulářů, musí fungovat ve verzích rozhraní .NET Framework, nakonfigurujte webovou aplikaci ASP.NET 4 tak, aby používala starší algoritmus přidáním následujícího nastavení do souboru Web.config:<br><br>`<machineKey validation="SHA1" />` |
| **Hostování ovládacích prvků v Internet Exploreru** | Ovládací prvky windows forms již nelze hostovat v aplikaci Internet Explorer, protože existují lepší řešení pro hostování ovládacích prvků na webu. Proto sestavení IEHost.dll a IEExec.exe byly odebrány z rozhraní .NET Framework. | Pro vývoj vlastních ovládacích prvku ve webových aplikacích můžete použít následující technologie:<br><br>* Můžete vytvořit aplikaci Silverlight a nakonfigurovat ji tak, aby běžela mimo prohlížeč. Další informace naleznete [v tématu Podpora mimo prohlížeč](https://docs.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/dd550721%28v=vs.95%29).<br>* Můžete vytvořit aplikaci prohlížeče XAML (XBAP) využít wpf schopnosti (vyžaduje rozhraní .NET Framework na klientských počítačích). Další informace naleznete v tématu [Přehled prohlížečů WPF XAML](../wpf/app-development/wpf-xaml-browser-applications-overview.md). |
| **Metody HtmlEncode a UrlEncode** | Metody `HtmlEncode` `UrlEncode` a <xref:System.Web.HttpUtility> a <xref:System.Web.HttpServerUtility> třídy byly aktualizovány tak, aby kódovali znak jedné uvozovky (') takto:<br><br>* `HtmlEncode` Metoda kóduje výskyty jednoduché uvozovky jako`&#39;`<br>* `UrlEncode` Metoda kóduje výskyty jednoduché uvozovky jako`%27` | Zkontrolujte kód pro místa, `HtmlEncode` `UrlEncode` kde používáte metody a a ujistěte se, že změna kódování nevede ke změně, která by ovlivnila vaši aplikaci. |
| **Chyby httpexception v aplikacích ASP.NET 2.0** | Po povolení ASP.NET 4 ve službě IIS 6 mohou aplikace ASP.NET 2.0 spuštěné ve službě IIS 6 (v systému Windows Server 2003 nebo Windows Server 2003 R2) generovat chyby, například následující:`System.Web.HttpException: Path '/[yourApplicationRoot]/eurl.axd/[Value]' was not found.` | * Pokud ASP.NET 4 není nutné pro spuštění webu, přemapovat stránky použít ASP.NET 2.0 místo.<br><br>-nebo-<br><br>* Pokud je pro spuštění webu vyžadovánASP.NET 4, přesuňte všechny podřízené ASP.NET virtuálních adresářů 2.0 na jiný web, který je mapován na ASP.NET 2.0.<br><br>-nebo-<br><br>* Zakázat bezprodlužované adresy URL. Další informace naleznete v tématu "ASP.NET 2.0 Aplikace mohou generovat chyby httpexception, které odkazují na eurl.axd" v dokumentu [ASP.NET 4 Nejnovější změny](/aspnet/whitepapers/aspnet4/breaking-changes) na webu ASP.NET. |
| **Typy členství** | Některé typy <xref:System.Web.Security.MembershipProvider>(například), které se používají v ASP.NET členství byly přesunuty ze souboru System.Web.dll do sestavení System.Web.ApplicationServices.dll. Typy byly přesunuty za účelem vyřešení architektury vrstvení závislostí mezi typy v klientovi a rozšířené .NET Framework SKU. | Knihovny tříd, které byly upgradovány z dřívějších verzí ASP.NET a které používají typy členství, které byly přesunuty, se nemusí zkompilovat při použití v projektu ASP.NET 4. Pokud ano, přidejte odkaz v projektu knihovny tříd na soubor System.Web.ApplicationServices.dll. |
| **Změny ovládacího prvku nabídky** | Změny ovládacího <xref:System.Web.UI.WebControls.Menu> prvku mají za následek následující chování:<br><br>* <xref:System.Web.UI.WebControls.MenuRenderingMode> Pokud je `List`nastavena <xref:System.Web.UI.WebControls.MenuRenderingMode> na `Default` , <xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> nebo `4.0` pokud je <xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> nastavena na a je nastavena na nebo novější, vlastnost nemá žádný vliv.<br>* Pokud cesta nastavená <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> v <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> a vlastnosti\\obsahuje zpětné lomítko ( ), obrázky nevykreslují. (V dřívějších verzích ASP.NET může cesta obsahovat zpětné lomítko.) | * Namísto <xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> nastavení vlastnosti pro jednotlivé <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> položky <xref:System.Web.UI.WebControls.Menu> nabídky nastavte ovládací prvek nebo nadřazený ovládací prvek.<br><br>-nebo-<br><br>Nastavte <xref:System.Web.UI.WebControls.MenuRenderingMode> `Table`na , <xref:System.Web.UI.WebControls.MenuRenderingMode> `Default` nebo <xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> nastavte `3.5`na a na . Tato nastavení <xref:System.Web.UI.WebControls.Menu> způsobí, že ovládací prvek použije rozložení založené na tabulce HTML, které používá v dřívějších verzích ASP.NET.<br>* Pokud cesta <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> v <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> vlastnosti nebo\\obsahuje zpětné lomítko ( ), nahraďte znak lomítka (/). |
| **Mobilní sestavení v souboru Web.config** | V předchozích verzích ASP.NET byl odkaz na sestavení System.Web.Mobile.dll zahrnut do kořenového `system.web` / `compilation`souboru Web.config v `assemblies` části pod . Chcete-li zlepšit výkon, odkaz na toto sestavení byla odebrána.<br><br>Poznámka: Sestava System.Web.Mobile.dll a ASP.NET mobilní ovládací prvky jsou součástí ASP.NET 4, ale jsou zastaralé. | Pokud chcete použít typy z tohoto sestavení, přidejte odkaz na sestavení v kořenovém souboru Web.config nebo v souboru Web.config aplikace. |
| **Ukládání výstupu do mezipaměti** | V ASP.NET 1.0, chyba způsobila `Location="ServerAndClient"` cache stránky, které určené jako výstup&euro;"cache nastavení vyzařovat hlavičku `Vary:*` HTTP v odpovědi. To mělo za následek sdělit prohlížečům klienta, aby nikdy do mezipaměti stránky místně. V ASP.NET 1.1 <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> byla přidána metoda, která může `Vary:*` být volána za účelem potlačení záhlaví. Zprávy o chybách však naznačují, `SetOmitVaryStar` že vývojáři nejsou vědomi existující chování.<br><br>V ASP.NET 4 `Vary:*` je hlavička HTTP již vyzařována z odpovědí, které určují následující direktivu:<br><br>`<%@ OutputCache Location="ServerAndClient" %>`<br><br>V důsledku toho <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> metoda již není potřeba k `Vary:*` potlačení záhlaví. V aplikacích, které pro `Location` atribut určují "ServerAndClient", budou stránky v <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A>prohlížeči uložit do mezipaměti, aniž by bylo nutné volat . | Pokud stránky v aplikaci `Vary:*`musí <xref:System.Web.HttpResponse.AppendHeader%2A> vyzařovat , zavolejte metodu, jak je znázorněno v následujícím příkladu:<br><br>`System.Web.HttpResponse.AppendHeader("Vary","*");`<br><br>Případně můžete změnit hodnotu výstupního atributu `Location` ukládání do mezipaměti na "Server". |
| **Analýza stránky** | Analyzátor stránek pro ASP.NET webových stránek (soubory aspx) a uživatelské ovládací prvky (.ascx soubory) je přísnější v ASP.NET 4 než v dřívějších verzích ASP.NET a označí více značek jako neplatné než v předchozích verzích. | Zkontrolujte chybové zprávy, které jsou vytvářeny při spuštění stránky a opravit chyby, které vyplývají z neplatné značky. |
| **Typy pasů** | Podpora služby Passport integrovaná do ASP.NET 2.0 je zastaralá a není podporována kvůli změnám v souboru Passport (nyní Live ID SDK). V důsledku toho jsou nyní <xref:System.Web.Security> typy související se `ObsoleteAttribute` službou Passport in označeny atributem. | Změňte libovolný kód, který <xref:System.Web.Security> používá typy služby Passport v oboru názvů <xref:System.Web.Security.PassportIdentity>(například) k použití sady Windows Live ID SDK. |
| **Informace pathinfo ve vlastnosti FilePath** | ASP.NET 4 již `PathInfo` neobsahuje hodnotu vrácené <xref:System.Web.HttpRequest.FilePath>hodnoty <xref:System.Web.HttpRequest.AppRelativeCurrentExecutionFilePath>z <xref:System.Web.HttpRequest.CurrentExecutionFilePath>vlastností, jako jsou například , a . Místo toho `PathInfo` jsou informace <xref:System.Web.HttpRequest.PathInfo>k dispozici v . Představte si například následující fragment adresy URL:<br><br>`/testapp/Action.mvc/SomeAction`<br><br>V dřívějších verzích <xref:System.Web.HttpRequest> ASP.NET mají vlastnosti následující hodnoty:<br><br>* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc/SomeAction`<br>* <xref:System.Web.HttpRequest.PathInfo>: (prázdné)<br><br>V ASP.NET <xref:System.Web.HttpRequest> 4 mají vlastnosti místo toho následující hodnoty:<br><br>* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc`<br>* <xref:System.Web.HttpRequest.PathInfo>: `SomeAction` | Zkontrolujte kód pro místa, kde <xref:System.Web.HttpRequest> můžete spoléhat na vlastnosti třídy vrátit informace o cestě; změňte kód tak, aby odrážel změny v tom, jak jsou vráceny informace o cestě. |
| **Žádost o ověření** | Chcete-li zlepšit ověření žádosti, ověření žádosti ASP.NET je vyvolána dříve v životním cyklu požadavku. V důsledku toho je ověření požadavku spuštěno pro požadavky, které nejsou pro soubory ASPX, například pro volání webové služby a pro vlastní obslužné rutiny. Ověření požadavku bude také aktivní, pokud jsou v kanálu zpracování požadavků spuštěny vlastní moduly HTTP.<br><br>V důsledku této změny mohou požadavky na jiné prostředky než soubory ASPX vyvolat chyby ověření požadavku. Vlastní kód, který běží v kanálu požadavku (například vlastní moduly HTTP) může také vyvolat chyby ověření požadavku. | V případě potřeby se můžete vrátit ke starému chování, kdy pouze stránky ASPX aktivují ověření žádosti pomocí následujícího nastavení v konfiguračním souboru webu:<br><br>`<httpRuntime requestValidationMode="2.0" />`<br><br>Upozornění: Pokud se vrátíte ke starému chování, ujistěte se, že veškerý kód v existujících obslužných rutinách, modulech a dalších vlastních kódech provádí kontroly potenciálně nebezpečných vstupů HTTP, které by mohly být vektory útoku XSS. |
| **Směrování** | Pokud vytvoříte web systému souborů v sadě Visual Studio 2010 a web je ve složce, která obsahuje tečku (.) v názvu složky, směrování adres URL nebude fungovat spolehlivě. Z některých virtuálních cest je vrácena chyba HTTP 404. K tomu dochází, protože Visual Studio 2010 spustí Visual Studio Development Server pomocí nesprávné cesty pro kořenový virtuální adresář. | * Na stránce **Vlastnosti** webu založeného na souborech změňte atribut **Virtuální cesta** na "/".<br><br>-nebo-<br><br>* Místo projektu webu vytvořte projekt webové aplikace. Projekty webových aplikací nemají tento problém a směrování adres URL funguje i v případě, že složka projektu má tečku v názvu.<br><br>-nebo-<br><br>* Vytvořte web založený na protokolu HTTP, který je hostován ve službě IIS. Weby hostované službou IIS mohou mít tečky ve virtuální cestě i ve složce souborů projektu. |
| **Weby SharePoint** | Pokud se pokusíte spustit web ASP.NET 4, který je nasazen jako podřízený web služby `WSS_Minimal`SharePoint, který obsahuje vlastní úroveň částečné důvěryhodnosti s názvem , zobrazí se následující chyba:<br><br>`Could not find permission set named 'ASP.Net'.` | V současné době nejsou žádné verze sharepointu kompatibilní s ASP.NET. V důsledku toho byste se neměli pokoušet spustit web ASP.NET 4 jako podřízený web služby SharePoint. |
| **Standardy XHTML 1.1** | Chcete-li povolit dodržování předpisů XHTML 1.1 pro nové weby, ASP.NET ovládací prvky v rozhraní .NET Framework 4 vygenerují html kompatibilní s XHTML 1.1. Toto vykreslování je povoleno pomocí `<system.Web>` následující možnosti v souboru Web.config uvnitř prvku:<br><br>`<pages controlRenderingCompatibilityVersion="4.0"/>`<br><br>Tato možnost je ve výchozím nastavení nastavena na hodnotu 4.0. Webové projekty, které jsou upgradovány z visual studio 2008 mají 3,5 nastavení povoleno kompatibility. | Žádné. |

## <a name="core"></a>Jádro

### <a name="general-features"></a>Obecné funkce

| Funkce | Rozdíly od 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **CardSpace** | Služba Windows CardSpace již není součástí rozhraní .NET Framework. je poskytována samostatně. | Stáhněte si službu Windows CardSpace ze [služby Stažení softwaru](https://go.microsoft.com/fwlink/?LinkId=199868). |
| **Konfigurační soubory** | Byly provedeny opravy v tom, jak rozhraní .NET Framework přistupuje ke konfiguračním souborům aplikací. | Pokud je konfigurační soubor aplikace pojmenován *application-name.config*, přejmenujte jej na *application-name.exe.config*. Přejmenujte například *MyApp.config* na *MyApp.exe.config*. |
| **Kompilátor kódu Jazyka C#** | `Compiler`Třídy `CompilerError`, `ErrorLevel` a třídy, které byly v oboru <xref:Microsoft.CSharp> názvů, již nejsou k dispozici a jejich sestavení (cscompmgd.dll) již není součástí rozhraní .NET Framework. | Použijte <xref:System.CodeDom.Compiler.CodeDomProvider> třídu a další <xref:System.CodeDom.Compiler> třídy v oboru názvů. Další informace naleznete [v tématu Použití CodeDOM](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/y2k85ax6%28v=vs.100%29). |
| **Hostování** (nespravované rozhraní API) | Chcete-li zlepšit možnosti hostování, některé z aktivačních API hostingu byly zastaralé. Funkce souběžného provádění umožňují aplikaci načíst a spustit více verzí rozhraní .NET Framework ve stejném procesu. Můžete například spustit aplikace, které načítají doplňky (nebo součásti), které jsou založeny na rozhraní .NET Framework 2.0 SP1 a doplněk, které jsou založeny na rozhraní .NET Framework 4 ve stejném procesu. Starší součásti nadále používají starší verzi rozhraní .NET Framework a nové součásti používají novou verzi rozhraní .NET Framework. | Použijte konfigurace popsané [v in-process side-by-side spuštění](../deployment/in-process-side-by-side-execution.md). |
| **Nový model zabezpečení** | Zásady zabezpečení přístupu kódu (CAS) byly vypnuty a nahrazeny zjednodušeným modelem, jak je popsáno v části [Změny zabezpečení v rozhraní .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd233103%28v=vs.100%29). | Změny mohou být vyžadovány, pokud jste závislí na CAS ve vašich aplikacích. Další informace naleznete v [tématu Kompatibilita a migrace zásad zabezpečení přístupu kódu](../misc/code-access-security-policy-compatibility-and-migration.md). |

### <a name="date-and-time"></a>Datum a čas

Namespace:<xref:System>

Sestava: mscorlib (v mscorlib.dll)

| Funkce | Rozdíly od 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Letní čas** | Chcete-li být konzistentní se systémovými <xref:System.TimeZoneInfo.Local> hodinami, vlastnosti času (například a <xref:System.DateTime.Now>) nyní používají pravidla operačního systému namísto jiných dat rozhraní .NET Framework pro operace letního času. | Žádné. |
| **Formátování řetězců** | Pro podporu formátování citlivé na <xref:System.TimeSpan> jazykovou verzi, struktura `ToString` `Parse`zahrnuje `TryParse` nové přetížení , `ParseExact` `TryParseExact` a metody kromě nové a metody. | Žádné. |

### <a name="globalization"></a>Globalizace

Seznam nových neutrálních a specifických kultur naleznete [v tématu Co je nového v globalizaci a lokalizaci](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd997383%28v=vs.100%29).

Namespace:<xref:System.Globalization>

Sestava: mscorlib (v mscorlib.dll)

| Funkce | Rozdíly od 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Názvy kultur** | Následující změny názvů ovlivňují německou, divehi a africkou kulturu:<br><br>* <xref:System.Globalization.CultureAndRegionInfoBuilder.CurrencyEnglishName>: Název měny pro německou (švýcarskou) (de-CH) jazykovou verzi se změnil z "sFr". na "Fr".<br>* <xref:System.Globalization.DateTimeFormatInfo.LongDatePattern>: Dlouhé datum vzor pro Divehi (Maledivy) (dv-MV) kultura se změnila z "dd/MMMM/yyyy" na "dd/MM/yyyy".<br>* <xref:System.Globalization.DateTimeFormatInfo.PMDesignator>: P.M. označení afrikánštiny (Jižní Afrika) (af-ZA) kultury se změnilo z "nm" na "PM". | Poznámka: změny názvu jazykové verze. |
| **Parametr LCID** | Chcete-li být konzistentní s očekávaným chováním v nastavení serveru `LCID` automatizace, CLR již předává aktuální jazykovou verzi pro parametr nespravované aplikace založené na modelu COM. Místo toho, to projde 1033 (en-us) pro kulturu. | Nejsou nutné žádné změny s výjimkou nativních aplikací, které vyžadují zadanou jazykovou verzi. |
| **Zastaralé typy kultur** | Typy <xref:System.Globalization.CultureTypes> <xref:System.Globalization.CultureTypes> a jazyková verze jsou nyní zastaralé.<br><br>Pro zpětnou <xref:System.Globalization.CultureTypes> kompatibilitu nyní vrátí neutrální a konkrétní jazykové verze, <xref:System.Globalization.CultureTypes> které byly součástí předchozího rozhraní .NET Framework a nyní vrátí prázdný seznam. | Použijte jiné hodnoty <xref:System.Globalization.CultureTypes> výčtu. |
| **Načítání jazykové verze** | Počínaje Windows 7, .NET Framework 4 načte informace o jazykové verzi z operačního systému namísto ukládání samotných dat. Rozhraní .NET Framework se navíc synchronizuje se systémem Windows pro řazení a pouzdře dat. | Žádné. |
| **Standardy Unicode 5.1** | Rozhraní .NET Framework nyní podporuje všechny znaky Unicode 5.1 – přidání přibližně 1400 znaků. Mezi další znaky patří nové symboly, šipky, diakritika, interpunkce, matematické symboly, tahy CJK a ideografy, další malayalamské a telugské číselné znaky a různé znaky Myanmaru, latinky, arabštiny, řečtiny, mongolštiny a cyrilice. Následující nové skripty jsou podporovány s Unicode 5.1: Sundanese, Lepcha, Ol Chiki, Vai, Saurashtra, Kayah Li, Rejang, Gurmukhi, Odia, Tamil, Telugu a Malayalam znaky a Cham. | Žádné. |

### <a name="exceptions"></a>Výjimky

Jmenné <xref:System>prostory: ,<xref:System.Runtime.ExceptionServices>

Sestava: mscorlib (v mscorlib.dll)

| Funkce | Rozdíly od 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Výjimky pro poškozený stav procesu** | CLR již neposkytuje výjimky pro poškozený stav procesu obslužné rutiny výjimek ve spravovaném kódu. | Tyto výjimky označují, že stav procesu byl poškozen. Nedoporučujeme spouštět aplikaci v tomto stavu.<br><br>Další informace naleznete <xref:System.Runtime.ExceptionServices.HandleProcessCorruptedStateExceptionsAttribute> v části A položka [Zpracování výjimek poškozeného stavu](https://docs.microsoft.com/archive/msdn-magazine/2009/february/clr-inside-out-handling-corrupted-state-exceptions) v časopise MSDN. |
| **Výjimky prováděcího modulu** | <xref:System.ExecutionEngineException>je nyní zastaralá, protože zachytitelná výjimka umožní pokračovat v spuštění nestabilního procesu. Tato změna zlepšuje předvídatelnost a spolehlivost za běhu. | Použijte <xref:System.InvalidOperationException> k signalizaci stavu. |

### <a name="reflection"></a>Reflexe

Namespace:<xref:System.Reflection>

Sestava: mscorlib (v mscorlib.dll)

| Funkce | Rozdíly od 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Algoritmy hash sestavení** | Vlastnost <xref:System.Reflection.AssemblyName.HashAlgorithm> nyní <xref:System.Configuration.Assemblies.AssemblyHashAlgorithm>vrátí , protože za běhu nezná algoritmus hash odkazované sestavení, když sestavení není načten. (To se týká použití vlastnosti na odkazované sestavení, <xref:System.Reflection.Assembly.GetReferencedAssemblies%2A> jako je například vrácena metodou.) | Žádné. |
| **Montážní zatížení** | Chcete-li zabránit redundantní načítání sestavení a ušetřit virtuální adresový prostor, CLR `MapViewOfFile` nyní načte sestavení pomocí pouze Win32 funkce. Již také volá `LoadLibrary` funkci.<br><br>Tato změna ovlivňuje diagnostické aplikace následujícími způsoby:<br><br>* <xref:System.Diagnostics.ProcessModuleCollection> A již nebude obsahovat žádné moduly z knihovny tříd (soubor `Process.GetCurrentProcess().Modules`dll), získané z volání .<br>* Win32 aplikace, `EnumProcessModules` které používají funkci neuvidí všechny spravované moduly uvedené. | Žádné. |
| **Deklarování typu** | Vlastnost <xref:System.Type.DeclaringType> nyní správně vrátí hodnotu null, pokud typ nemá deklarující typ. | Žádné. |
| **Delegáty** | Delegát nyní vyvolá <xref:System.ArgumentNullException> místo <xref:System.NullReferenceException> při při null hodnota je předána konstruktoru delegáta. | Ujistěte se, <xref:System.ArgumentNullException>že všechny výjimky zpracování úlovků . |
| **Změna umístění mezipaměti globálního sestavení** | U sestavení rozhraní .NET Framework 4 byla globální mezipaměť sestavení přesunuta z adresáře systému Windows (%WINDIR%) Microsoft.Net podadresáři (*%WINDIR%\\Microsoft.Net*). Sestavení z předchozích verzí zůstávají ve starším adresáři.<br><br>Nespravovaný [ASM_CACHE_FLAGS](../unmanaged-api/fusion/asm-cache-flags-enumeration.md) výčet `ASM_CACHE_ROOT_EX` obsahuje nový příznak. Tento příznak získá umístění mezipaměti pro sestavení rozhraní .NET Framework 4, které lze získat pomocí funkce [GetCachePath.](../unmanaged-api/fusion/getcachepath-function.md) | Žádné, za předpokladu, že aplikace nepoužívají explicitní cesty k sestavením, což není doporučený postup. |
| **Nástroj globální mezipaměti sestavení** | [Gacutil.exe (Global Assembly Cache Tool)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ex0ss12c%28v=vs.100%29) již nepodporuje prohlížeč modulů plug-in prostředí. | Žádné. |

### <a name="interoperability"></a>Interoperabilita

Namespace:<xref:System.Runtime.InteropServices>

Sestava: mscorlib (v mscorlib.dll)

| Funkce | Rozdíly od 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Délka vyrovnávací paměti** (nespravované rozhraní API) | Chcete-li uložit paměť, `pBufferLengthOffset` byla změněna funkce parametru metody [ICorProfilerInfo2::GetStringLayout](../unmanaged-api/profiling/icorprofilerinfo2-getstringlayout-method.md) tak, aby odpovídala parametru. `pStringLengthOffset` Oba parametry nyní odkazují na umístění posunu délky řetězce. Délka vyrovnávací paměti byla odebrána z reprezentace třídy řetězce. | Odeberte všechny závislosti na délce vyrovnávací paměti. |
| **Ladění JIT** | Chcete-li zjednodušit registraci pro ladění just-in-time (JIT), ladicí program rozhraní .NET Framework nyní používá pouze klíč registru AeDebug, který řídí chování ladění JIT pro nativní kód. Tato změna má za následek následující:<br><br>* Již nelze zaregistrovat dva různé ladicí programpro spravovaný a nativní kód.<br>* Ladicí program již nelze spustit automaticky pro neinteraktivní proces, ale můžete uživatele vyzvat k zadání interaktivního procesu.<br>* Již nebudete upozorněni, když se ladicí program nespustí nebo pokud neexistuje žádný registrovaný ladicí program, který by měl být spuštěn.<br>* Zásady automatického spuštění, které závisí na interaktivitě aplikace, již nejsou podporovány. | Podle potřeby upravte operace ladění. |
| **Vyvolání platformy** | Chcete-li zlepšit výkon v interoperabilitě s nespravovaný kód, nesprávné konvence volání v platformě vyvolat nyní způsobit selhání aplikace. V předchozích verzích zařazovací vrstva vyřešena tyto chyby do zásobníku. | Ladění aplikací v sadě Microsoft Visual Studio vás upozorní na tyto chyby, abyste je mohli opravit.<br><br>Pokud máte binární soubory, které nelze aktualizovat, můžete zahrnout [ \<prvek NetFx40_PInvokeStackResilience>](../configure-apps/file-schema/runtime/netfx40-pinvokestackresilience-element.md) do konfiguračního souboru aplikace, aby bylo možné vyřešit chyby volání v zásobníku jako v předchozích verzích. To však může ovlivnit výkon aplikace. |
| **Odstraněná rozhraní** (nespravované rozhraní API) | Aby nedošlo k nejasnostem vývojářů, byla odebrána následující rozhraní, protože neposkytovala žádné užitečné scénáře za běhu a clr neposkytla ani nepřijala žádné implementace:<br><br>* **INativeImageINativeImageDependency**<br>* **InativeImageInstallInfo**<br>* **InativeImageEvaluate**<br>* **INativeImageConverter**<br>* **Modul ICor**<br>* **IMetaDataConverter** | Žádné. |

## <a name="data"></a>Data

Tato část popisuje problémy s migrací pro použití datových sad a klientů SQL, entity Framework, LINQ na SQL a WCF datové servery (dříve známé jako ADO.NET datové služby).

### <a name="dataset-and-sql-client"></a>Sada dat a klient SQL

Následující tabulka popisuje vylepšení funkcí, které dříve měly omezení nebo jiné problémy.

Jmenné <xref:System.Data>prostory: , <xref:System.Data.Objects.DataClasses>,<xref:System.Data.SqlClient>

Sestavy: System.Data (v souboru System.Data.dll), System.Data.Entity (v souboru System.Data.Entity.dll)

| Funkce | Rozdíly od 3,5 SP1 |
| ------- | ------------------------ |
| **Scénáře POCO** | Rozhraní <xref:System.Data.Objects.DataClasses.IRelatedEnd> má nové metody pro zlepšení jeho použitelnosti ve scénářích prostý starý CLR objekt (POCO). Tyto nové metody <xref:System.Object> trvat <xref:System.Data.Objects.DataClasses.IEntityWithRelationships> místo entity jako parametr. |
| **Úpravy řádků** | Metoda, <xref:System.Collections.IList.IndexOf%2A> jak je <xref:System.Data.DataView> implementována třídy, nyní správně vrátí hodnotu řádku, který je upravován, namísto vrácení -1. |
| **Události** | Událost <xref:System.Data.DataRowView.PropertyChanged> je nyní vyvolána, když je řádek <xref:System.Data.DataRow.RejectChanges%2A> v změněném stavu a je volána metoda. Tato změna usnadňuje vytváření ovládacích prvků ui, <xref:System.Data.DataSet> které zveřejňují obsah objektu. |
| **Výjimky** | Metoda <xref:System.Data.SqlClient.SqlCommand.Prepare%2A> nyní vyvolá <xref:System.InvalidOperationException> při připojení není nastavena nebo <xref:System.NullReferenceException>otevřena namísto . |
| **Zobrazení mapování** | Chyby mapování zobrazení dotazu jsou nyní zachyceny v době návrhu namísto vyvolání <xref:System.NullReferenceException> za běhu.<br><br>Mapování ověření nyní zachytí chybu, ve kterém jsou dvě sady přidružení v koncepční schéma (CSDL) mapovány do stejného sloupce. |
| **Transakce** | Pokud se aplikace pokusí provést příkaz na připojení po dokončení transakce (včetně přerušeno nebo vrácena zpět), <xref:System.InvalidOperationException> je nyní vyvolána. Předchozí verze nevyvolaly výjimku a umožňují spustit další příkazy i v případě, že transakce byla přerušena. |

### <a name="entity-framework"></a>Entity Framework

Následující tabulka popisuje vylepšení funkcí, které dříve měly omezení nebo jiné problémy.

Jmenné <xref:System.Data>prostory: , <xref:System.Data.Objects>,<xref:System.Data.Objects.DataClasses>

Sestavení: System.Data.Entity (v souboru System.Data.Entity.dll)

| Funkce | Rozdíly od 3,5 SP1 |
| ------- | ------------------------ |
| **Objekty entit** | Nyní existuje parita <xref:System.Data.Objects.ObjectContext.Detach%2A> mezi metodou a stavem objektu entity při <xref:System.Data.Objects.ObjectContext.SaveChanges%2A> volání metody. Tato vylepšená konzistence zabraňuje vyvolání neočekávaných výjimek. |
| **Entity SQL** | Pravidla byla vylepšena pro rozlišení identifikátorů v entity SQL.<br><br>Analyzátor ENTITY SQL vylepšil logiku pro řešení vícedílných identifikátorů. |
| **Strukturální poznámky** | Entity Framework nyní rozpozná strukturální poznámky. |
| **Dotazy** | V dotazech byla provedena následující vylepšení:<br><br>* `GroupBy` Dotaz pomocí klíče null přes prázdnou kolekci nevrátí žádné řádky, bez ohledu na to, zda existují další výběry v dotazu.<br>* Generované dotazy SQL v LINQ a Entity-SQL nyní ve výchozím nastavení považují parametry řetězce za hodnoty, které nejsou unicode. |

### <a name="linq-to-sql"></a>Technologie LINQ to SQL

Následující tabulka popisuje vylepšení funkcí, které dříve měly omezení nebo jiné problémy.

Namespace:<xref:System.Data.Linq>

Sestava: System.Data.Linq (v souboru System.Data.Linq.dll)

| Funkce | Rozdíly od 3,5 SP1 |
| ------- | ------------------------ |
| **Události** | Kolekce <xref:System.Data.Linq.EntitySet%601> nyní vyvolá <xref:System.Data.Linq.EntitySet%601.ListChanged> událost pro přidání a <xref:System.Data.Linq.EntitySet%601> odebrání operace, pokud je uvolněna, kromě zvýšení události při načtení kolekce. |
| **Dotazy** | `Skip(0)`již není ignorována v linq na dotazy SQL. V důsledku toho dotazy, které mají tuto metodu může chovat odlišně. Například v některých `OrderBy` případech klauzule `Skip(0)`je vyžadována s <xref:System.NotSupportedException> , a `OrderBy` dotaz nyní vyvolá výjimku, pokud klauzule nebyla zahrnuta. |

### <a name="wcf-data-services"></a>WCF Data Services

Následující tabulka popisuje vylepšení funkcí, které dříve měly omezení nebo jiné problémy.

Jmenné <xref:System.Data.Services>prostory: , <xref:System.Data.Services.Client>, <xref:System.Data.Services.Common>,<xref:System.Data.Services.Providers>

Sestavení: System.Data.Services (v systému.Data.Services.dll), System.Data.Services.Client (v systému.Data.Services.Client.dll)

| Funkce | Rozdíly od 3,5 SP1 |
| ------- | ------------------------ |
| **Dávkový binární obsah** | WCF Data Services nyní podporuje dávkový binární obsah v požadavcích a odpovědích. |
| **Změna zachycovačů** | Zachycovače změn jsou nyní provedeny pro požadavek na odstranění.<br><br>Zachycovač změn je metoda, která se spustí při každém přijetí požadavku serverem na úpravu entity v sadě entit. Spustí se před spuštěním příchozího požadavku. Zachycovač změn poskytuje přístup k entitě, která se mění, a operaci, která je na ní prováděna. |
| **Výjimky** | Následující podmínky nyní vyvolat další užitečné <xref:System.NullReferenceException>výjimky namísto :<br><br>* <xref:System.ServiceProcess.TimeoutException> A při volání datové služby out.<br>* <xref:System.Data.Services.Client.DataServiceRequestException> A, když je podána chybná žádost datové služby.<br><br>Ve vašich aplikacích byste měli změnit zpracování výjimek zachytit nové výjimky. |
| **Hlavičky** | V záhlavích byla provedena následující vylepšení:<br><br>* WCF Data Services nyní `eTag` správně odmítne záhlaví, které má nespecifikovanou hodnotu.<br>* WCF Data Services nyní vrátí chybu a neprovede požadavek na `if-*` odstranění požadavku na odkaz, když je hlavička v požadavku.<br>* WCF Data Services nyní vrátí chybu klientovi ve formátu (Atom, JSON), který klient zadal v hlavičce Přijmout. |
| **Čtečka JSON** | JavaScript zápis objektu (JSON) čtenář nyní správně vrátí chybu při\\čtení jednoho zpětného lomítka (" ") escape znak, když zpracovává Datové části JSON odeslané wcf datové služby. |
| **Sloučí** | Ve výčtu <xref:System.Data.Services.Client.MergeOption> byla provedena následující vylepšení:<br><br>* <xref:System.Data.Services.Client.MergeOption> Možnost sloučení již neupravuje entitu na straně klienta v důsledku jakékoli následné odpovědi datové služby.<br>* <xref:System.Data.Services.Client.MergeOption> Možnost je nyní konzistentní mezi dynamické SQL a uložené aktualizace založené na postupech. |
| **Žádosti** | Metoda <xref:System.Data.Services.DataService%601.OnStartProcessingRequest%2A> je nyní volána před zpracováním požadavku na datové služby. To umožňuje požadavek pracovat <xref:System.Data.Services.Providers.ServiceOperation> správně pro služby. |
| **Datové proudy** | WCF datové služby již zavře základní datový proud pro operace čtení a zápisu. |
| **Identifikátory URI** | Únik identifikátorů URI klientem wcf datové služby byl opraven. |

## <a name="windows-communication-foundation-wcf"></a>Windows Communication Foundation (WCF)

Následující tabulka popisuje vylepšení funkcí, které dříve měly omezení nebo jiné problémy.

| Funkce | Rozdíly od 3,5 SP1 |
| ------- | ------------------------ |
| **Konfigurační soubory** | Chcete-li povolit dědičnost chování prostřednictvím hierarchie konfiguračních souborů, WCF nyní podporuje slučování mezi konfiguračními soubory.<br><br>Model dědičnosti konfigurace je nyní rozbalen tak, aby uživatelé definovali chování, které bude použito pro všechny služby spuštěné v počítači.<br><br>Změny chování může dojít, pokud existují chování se stejným názvem na různých úrovních hierarchie. |
| **Hosting služeb** | Již nelze zadat `<serviceHostingEnvironment>` konfigurační prvek na úrovni `allowDefinition="MachineToApplication"` služby přidáním atributu do definice prvku.<br><br>Zadání `<serviceHostingEnvironment>` prvku na úrovni služby je technicky nesprávné a způsobuje nekonzistentní chování. |

## <a name="windows-presentation-foundation-wpf"></a>Windows Presentation Foundation (WPF)

### <a name="applications"></a>Aplikace

Jmenné <xref:System.Windows>prostory: ,<xref:System.Windows.Controls>

Sestavení: PresentationFramework (v PresentationFramework.dll)

| Funkce | Rozdíly od 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Zpracování výjimek** | Chcete-li povolit chyby, které <xref:System.Reflection.TargetInvocationException> mají být <xref:System.Exception.InnerException> zjištěny dříve, WPF vyvolá a nastaví vlastnost na kritické výjimky, <xref:System.NullReferenceException>jako je například , <xref:System.OutOfMemoryException>, <xref:System.StackOverflowException>a <xref:System.Security.SecurityException>, místo zachycení původní výjimky. | Žádné. |
| **Propojené zdroje** | Chcete-li usnadnit propojení, soubory prostředků (například obrázky), které jsou umístěny v jiném umístění než struktury složek projektu použít soubor prostředků úplnou cestu namísto pouze jeho název souboru jako ID prostředku při vytvoření aplikace. Aplikace bude moci najít soubory za běhu. | Žádné. |
| **Aplikace s částečnou důvěryhodností** | Z bezpečnostních důvodů aplikace založené na systému Windows, <xref:System.Windows.Controls.WebBrowser> které <xref:System.Windows.Controls.Frame> běží v částečném <xref:System.Security.SecurityException> vztahu důvěryhodnosti a obsahují ovládací prvek nebo ovládací prvek, který obsahuje HTML vyvolá při vytvoření ovládacího prvku.<br><br>Aplikace prohlížeče vyvolá výjimku a zobrazí zprávu, pokud jsou splněny všechny následující podmínky:<br><br>* Aplikace běží ve Firefoxu.<br>* Aplikace je spuštěna v částečnédůvěře v zóně Internet z nedůvěryhodných webů.<br>* Aplikace obsahuje <xref:System.Windows.Controls.WebBrowser> ovládací <xref:System.Windows.Controls.Frame> prvek nebo ovládací prvek, který obsahuje HTML.<br><br>Aplikace, které běží z důvěryhodných serverů nebo ze zóny intranetu, nebudou ovlivněny. | V aplikacích prohlížeče můžete tuto změnu usnadnit provedením jedné z následujících akcí:<br><br>* Spusťte aplikaci prohlížeče v plné důvěře.<br>* Mají zákazníci přidat aplikace stránky do zóny důvěryhodných serverů.<br>* Mají zákazníci spustit aplikaci v aplikaci Internet Explorer. |
| **Slovníky prostředků** | Chcete-li zlepšit slovníky prostředků na úrovni motivu a zabránit jejich změně, zmrazivatelné prostředky, které jsou definovány ve slovníku prostředků a sloučeny do slovníku na úrovni motivu, jsou nyní vždy označeny jako zmrazené a jsou neměnné. Toto je očekávané chování pro freezable prostředky. | Aplikace, které upravují prostředek, který je definován ve sloučeném slovníku na úrovni motivu, by měly prostředek klonovat a upravovat klonohovou kopii. Alternativně prostředek může být `x:Shared="false"` označen <xref:System.Windows.ResourceDictionary> tak, aby vytvoří novou kopii při každém dotazování prostředku. |
| **Windows 7** | Chcete-li, aby aplikace WPF fungovaly lépe v systému Windows 7, byla provedena následující vylepšení, která opravují chování okna:<br><br>* Dock a gesta státy nyní fungují podle očekávání na základě interakcí s uživatelem.<br>* Příkazy na hlavním panelu **Kaskádová okna, Zobrazit skládaná okna**a **Zobrazit okna vedle sebe** mají nyní správné chování a aktualizují příslušné vlastnosti.<br>* `Top`Vlastnosti `Width`, `Height` `Left`a pro maximalizované nebo minimalizované okno nyní obsahují správné umístění obnovení okna namísto jiných hodnot v závislosti na monitoru. | Žádné. |
| **Styl a průhlednost systému Windows** | Je <xref:System.InvalidOperationException> vyvolána, pokud se <xref:System.Windows.Window.WindowStyle> pokusíte nastavit <xref:System.Windows.WindowStyle> <xref:System.Windows.Window.AllowsTransparency> na `true` <xref:System.Windows.WindowState> hodnotu jinou než kdy je a je <xref:System.Windows.WindowState>. | Pokud je nutné <xref:System.Windows.Window.WindowStyle> <xref:System.Windows.Window.AllowsTransparency> změnit `true`when is , můžete `SetWindowLongPtr` volat funkci Win32. |
| **Prohlížeč souborů ve formátu XPS** | WPF neobsahuje sadu Microsoft XML Paper Specification Essentials Pack (XPSEP). XPSEP je součástí systému Windows 7 a Windows Vista.<br><br>V počítači se systémem Windows XP bez nainstalovaného rozhraní .NET Framework 3.5 SP1 bude tisk pomocí rozhraní WPF API jiných než těch, které jsou v počítači, <xref:System.Windows.Controls.PrintDialog> spoléhat na rozhraní WINSPOOL. Některé možnosti tiskárny nebudou hlášeny a některá nastavení tiskárny nebudou během tisku použita. | V případě potřeby nainstalujte [sadu Microsoft XML Paper Specification Essentials Pack](https://www.microsoft.com/en-us/download/details.aspx?id=11816). |

### <a name="controls"></a>Ovládací prvky

Jmenné <xref:System.Windows>prostory: , <xref:System.Windows.Controls>, <xref:System.Windows.Data>,<xref:System.Windows.Input>

Sestavení: PresentationFramework (v presentationframework.dll), PresentationCore (v PresentationCore.dll), WindowsBase (v souboru WindowsBase.dll)

| Funkce | Rozdíly od 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Dialogových** | Chcete-li zlepšit <xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> spolehlivost, metoda je volána <xref:Microsoft.Win32.FileDialog> na stejné vlákno, které vytvořilo ovládací prvek. | Ujistěte se, <xref:Microsoft.Win32.FileDialog> že vytvořit <xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> ovládací prvek a volat metodu ve stejném vlákně. |
| **Plovoucí okna** | Chcete-li opravit logiku obnovení fokusu, která nesprávně udržuje opětovnou aktivaci plovoucího okna (takže se zobrazí jako modální dialogové okno), obnovení fokusu je nyní zabráněno, pokud kandidát není podřízeným oknem. | Žádné. |
| **Položky ve sbírkách** | Když je položka přesunuta nebo přidána do <xref:System.Windows.Data.CollectionView> podkladové kolekce, zobrazí <xref:System.Windows.Data.CollectionView> se ve stejném relativním umístění, pokud není seřazena. To poskytuje konzistenci mezi umístění položky v <xref:System.Windows.Data.CollectionView>kolekci a v přidružené . | Pomocí <xref:System.Windows.Controls.ItemContainerGenerator.ContainerFromItem%2A> metody <xref:System.Windows.Data.CollectionView.IndexOf%2A> or vyhledejte umístění položky <xref:System.Windows.Data.CollectionView> v a namísto spoléhání se na pevné umístění položky. |
| **Rozložení** | Chcete-li odstranit zbytečné přerozložení, změna <xref:System.Windows.Controls.Page.ShowsNavigationUI> již nezruší platnost rozložení nebo způsobí další průchod rozložení. | Pokud očekáváte, <xref:System.Windows.Controls.Page.ShowsNavigationUI> že změna způsobí <xref:System.Windows.UIElement.InvalidateVisual%2A> další průchod rozložení, volání po nastavení vlastnosti. |
| **Nabídky** | Chcete-li povolit text ClearType v rozbalovacích <xref:System.Windows.Controls.ControlTemplate> líacích <xref:System.Windows.Controls.MenuItem> nabídek, byly provedeny změny třídy a ovládacího prvku a dalších ovládacích prvků. | Aplikace by neměly spoléhat na vizuální strukturu šablon ovládacích prvku. Součástí veřejné zakázky <xref:System.Windows.Controls.ControlTemplate> jsou pouze uvedené části. Pokud aplikace musí najít určitý <xref:System.Windows.Controls.ControlTemplate>objekt v , vyhledejte vizuální strom pro určitý typ namísto spoléhání se na pevné umístění objektu ve stromu. |
| **Navigaci** | Pokud <xref:System.Windows.Controls.Frame> přímo přejde do umístění, <xref:System.Windows.Navigation.NavigatingCancelEventArgs.IsNavigationInitiator> `true` vlastnost je po počáteční navigaci. Tato změna zabraňuje další události jsou vyvolány během spuštění scénáře. | Žádné. |
| **Automaticky otevíraná okna** | Delegát <xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback> může být nyní volána vícekrát během průchodu rozložení namísto pouze jednou. | Pokud <xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback> delegát vypočítá pozici na <xref:System.Windows.Controls.Primitives.Popup> základě své předchozí pozice, přepočítejte pozici `popupSize`pouze `targetSize`v `offset` případě, že se změní hodnoty , nebo parametry. |
| **Hodnoty vlastností** | Metoda <xref:System.Windows.DependencyObject.SetCurrentValue%2A> nyní umožňuje nastavit vlastnost na efektivní hodnotu, i když nadále respektovat všechny vazby, styl nebo aktivační událost, která ovlivňuje vlastnost. | Autoři ovládacího <xref:System.Windows.DependencyObject.SetCurrentValue%2A> prvku by měli použít vždy, když se hodnota vlastnosti změní jako vedlejší účinek některé jiné akce, včetně manipulace s uživatelem. |
| **Textová** | Z hlediska zabezpečení <xref:System.Windows.Forms.TextBoxBase.Copy%2A> a <xref:System.Windows.Forms.TextBoxBase.Cut%2A> metody tiše nezdaří, pokud jsou volány v částečném vztahu důvěryhodnosti.<br><br>Kromě toho programové provádění <xref:System.Windows.Input.ApplicationCommands.Copy> <xref:System.Windows.Input.ApplicationCommands.Cut> nebo vlastnost na ovládací <xref:System.Windows.Controls.Primitives.TextBoxBase> prvek, který dědí z bude blokován v částečném vztahu důvěryhodnosti. Příkazy kopírování a vyjmutí iniciované uživatelem, například klepnutí na tlačítko, jehož <xref:System.Windows.Controls.Primitives.ButtonBase.Command> vlastnost je vázána na jeden z těchto příkazů, však budou fungovat. Standardní kopírování a vyjmutí klávesových zkratek a kontextové nabídky bude stále fungovat jako dříve v částečnédůvěře. | Spojte <xref:System.Windows.Input.ApplicationCommands.Copy> <xref:System.Windows.Input.ApplicationCommands.Cut> příkaz nebo s akcí iniciotou uživatelem, například klepnutí na tlačítko. |

### <a name="graphics"></a>Grafika

Jmenné <xref:System.Windows>prostory: , <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>,<xref:System.Windows.Media.Effects>

Sestavení: PresentationFramework (v presentationframework.dll), PresentationCore (v PresentationCore.dll), WindowsBase (v souboru WindowsBase.dll)

| Funkce | Rozdíly od 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Bitmapové efekty** | Chcete-li zlepšit <xref:System.Windows.Media.Effects.BitmapEffect> výkon, třídy a <xref:System.Windows.Media.Effects.BitmapEffect> třídy, které dědí z třídy, i když stále k dispozici, jsou zakázány. Efekt se vykreslí pomocí kanálu vykreslování akcelerovaného hardwaru, pokud jsou splněny následující podmínky:<br><br>* Aplikace používá <xref:System.Windows.Media.Effects.DropShadowBitmapEffect> <xref:System.Windows.Media.Effects.BlurBitmapEffect> nebo, která má vlastnost poloměr nastavit méně než 100 DIU.<br>* Grafická karta v počítači, který běží aplikace podporuje pixel shader 2.0.<br><br>Pokud tyto podmínky nejsou <xref:System.Windows.Media.Effects.BitmapEffect> splněny, objekt nebude mít žádný vliv.<br><br>Visual Studio také vytvoří upozornění kompilátoru, <xref:System.Windows.Media.Effects.BitmapEffect> když narazí na objekt nebo podtřídu.<br><br>Metoda <xref:System.Windows.Media.DrawingContext.PushEffect%2A> je označena jako zastaralá. | Přestaňte používat <xref:System.Windows.Media.Effects.BitmapEffect> starší a odvozené třídy a <xref:System.Windows.Media.Effects.Effect>místo <xref:System.Windows.Media.Effects.BlurEffect> <xref:System.Windows.Media.Effects.DropShadowEffect>toho <xref:System.Windows.Media.Effects.ShaderEffect>použijte nové třídy odvozené z : , , a .<br><br>Můžete také vytvořit vlastní efekty děděním <xref:System.Windows.Media.Effects.ShaderEffect> z třídy. |
| **Bitmapové rámečky** | Klonované <xref:System.Windows.Media.Imaging.BitmapFrame> objekty nyní <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress> <xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted>přijímají <xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed> události , a události. To umožňuje obrázky, které jsou staženy <xref:System.Windows.Controls.Image> z <xref:System.Windows.Style> webu a použity na ovládací prvek prostřednictvím správně.<br><br>Změna chování se zobrazí pouze v případě, že jsou splněny všechny následující příkazy:<br><br>* Přihlášení k <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress> <xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted>odběru <xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed> služby , , nebo event.<br>* Zdroj <xref:System.Windows.Media.Imaging.BitmapFrame> je z webu.<br>* <xref:System.Windows.Media.Imaging.BitmapFrame> Je klonován, zatímco stahování je stále v průběhu. | Zkontrolujte odesílatele v obslužné rutině události <xref:System.Windows.Media.Imaging.BitmapFrame>a akci provést pouze v případě, že odesílatel je původní . |
| **Dekódování obrazů** | Chcete-li <xref:System.IO.IOException> zabránit nezpracovává, když obrázky <xref:System.Windows.Media.Imaging.BitmapSource> nemusí dekódovat, třída vyvolá <xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed> událost, když není dekódovat image. | Odeberte zpracování <xref:System.IO.IOException>výjimek <xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed> pro a pomocí události zkontrolujte selhání dekódování. |

### <a name="input"></a>Vstup

Jmenné <xref:System.Windows>prostory: , <xref:System.Windows.Controls>, <xref:System.Windows.Data>,<xref:System.Windows.Input>

Sestavení: PresentationFramework (v presentationframework.dll), PresentationCore (v PresentationCore.dll), WindowsBase (v souboru WindowsBase.dll)

| Funkce | Rozdíly od 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Instance příkazů vazby** | Chcete-li poskytnout mechanismus pro vazbu instance příkazů založené na zobrazení <xref:System.Windows.Input.InputBinding> modelu na <xref:System.Windows.Freezable> zobrazení <xref:System.Windows.DependencyObject>vstupní gesta, třída nyní dědí z místo . Následující vlastnosti jsou nyní vlastnosti závislostí:<br><br>* <xref:System.Windows.Input.InputBinding.Command><br>* <xref:System.Windows.Input.InputBinding.CommandParameter><br>* <xref:System.Windows.Input.InputBinding.CommandTarget><br><br>Tato změna má za následek následující:<br><br>* <xref:System.Windows.Input.InputBinding> Objekt je nyní zmrazen, když je registrován namísto zbývající proměnlivé.<br>* Přístup k objektům na úrovni <xref:System.Windows.Input.InputBinding> instance z více <xref:System.Windows.DependencyObject> vláken z důvodu omezení třídy.<br>* Nemůžete mutovat vstupní vazby na úrovni třídy po <xref:System.Windows.Freezable> jejich registraci, z důvodu omezení třídy.<br>* Nelze zadat vstupní vazby na příkaz instance, které jsou vytvořeny v View-Model. | Vytvořte samostatné instance <xref:System.Windows.Input.InputBinding> třídy v samostatných vláknech, pokud mají být vazby proměnlivé, nebo je jinak zmrazte. Po zaregistrování nemutujujte statickou <xref:System.Windows.Input.InputBinding> úroveň na úrovni třídy. |
| **Aplikace prohlížeče** | WPF Aplikace prohlížeče (. XBAP) nyní zpracovávají klíčové události stejně jako samostatné aplikace WPF tak, aby objekty přijímají směrované klíčové události ve správném pořadí. | Žádné. |
| **Kombinace mrtvých kláves** | WPF obfuscates mrtvé klíče, které produkují žádný viditelný znak, ale místo toho označuje, že klíč má být kombinován s další písmeno klíč k vytvoření jednoho znaku. Klíčové vstupní události, jako <xref:System.Windows.Input.Keyboard.KeyDownEvent> je například událost, hlásí, když <xref:System.Windows.Input.KeyEventArgs.Key> je <xref:System.Windows.Input.Key> klíč mrtvý klíč nastavením vlastnosti na hodnotu. To je obvykle očekávané chování, protože aplikace obvykle nemají v úmyslu reagovat na vstup z klávesnice, který vytvoří kombinovaný znak. | Aplikace, které očekávají, že číst klíče, které byly součástí kombinovaných znaků <xref:System.Windows.Input.KeyEventArgs.DeadCharProcessedKey> můžete získat nyní zamlžený klíč pomocí vlastnosti. |
| **Správce fokusu** | Když <xref:System.Windows.Input.FocusManager.GetFocusedElement(System.Windows.DependencyObject)?displayProperty=nameWithType> je metoda předána prvek, který má [IsFocusScope](xref:System.Windows.Input.FocusManager.IsFocusScope%2A) připojené vlastnosti nastavena `true`na , metoda vrátí prvek, který je poslední prvek zaměřený <xref:System.Windows.PresentationSource> na klávesnici v rámci tohoto oboru fokus pouze v případě, že vrácený prvek patří do stejného objektu jako prvek, který je předán metodě. | Žádné. |

### <a name="ui-automation"></a>automatizace uživatelského rozhraní

<xref:System.Windows>Obor názvů: <xref:System.Windows.Automation.Peers> <xref:System.Windows.Automation.Provider>, <xref:System.Windows.Controls> <xref:System.Windows.Data>, , , , ,<xref:System.Windows.Input>

Sestavení: PresentationFramework (v PresentationFramework.dll), PresentationCore (v PresentationCore.dll), UIAutomationProvider (v UIAutomationProvider.dll), WindowsBase (v souboru WindowsBase.dll)

| Funkce | Rozdíly od 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Hierarchie zobrazení třídy** | A <xref:System.Windows.Automation.Peers.TreeViewAutomationPeer> <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer> třídy <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer> dědí <xref:System.Windows.Automation.Peers.FrameworkElementAutomationPeer>z místo . | Pokud dědíte <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer> z tříd <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer.GetChildrenCore%2A> a přepsat metodu, zvažte vrácení <xref:System.Windows.Automation.Peers.TreeViewDataItemAutomationPeer> objektu, který dědí z nové třídy. |
| **Kontejnery mimo obrazovku** | Chcete-li opravit nesprávnou <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.IsOffscreenCore%2A> vrácenou `false` hodnotu, metoda nyní správně vrátí pro kontejnery položek, které jsou posouvány mimo zobrazení. Hodnota metody také není ovlivněna okluzí jinými okny nebo zda je prvek viditelný na určitém monitoru. | Žádné. |
| **Nabídky a podřízené objekty** | Chcete-li povolit automatizaci uživatelského <xref:System.Windows.Controls.MenuItem> rozhraní nabídek, které obsahují podřízené než objekty, <xref:System.Windows.Automation.Peers.MenuItemAutomationPeer.GetChildrenCore%2A> metoda nyní vrátí <xref:System.Windows.Automation.Peers.AutomationPeer> objekt podřízeného <xref:System.Windows.UIElement> objektu namísto objektu. <xref:System.Windows.Automation.Peers.MenuItemAutomationPeer> | Žádné. |
| **Nová rozhraní a montáž** | Chcete-li povolit nové funkce pro automatizaci uživatelského rozhraní, byla přidána následující rozhraní:<br><br>* <xref:System.Windows.Automation.Provider.IItemContainerProvider><br>* <xref:System.Windows.Automation.Provider.ISynchronizedInputProvider><br>* <xref:System.Windows.Automation.Provider.IVirtualizedItemProvider> | Každý projekt, který vytváří partnerské partnery automatizace WPF, musí přidat explicitní odkaz na soubor UIAutomationProvider.dll. |
| **Palce** | Metoda <xref:System.Windows.Automation.Peers.ThumbAutomationPeer.GetClassNameCore%2A> vrátí hodnotu namísto null. Proto ovládací prvky, <xref:System.Windows.Controls.GridSplitter> jako <xref:System.Windows.Controls.Primitives.Thumb> je například dědí z třídy bude hlásit název automatizace uživatelského rozhraní. | Žádné. |
| **Virtualizované prvky** | Chcete-li zlepšit <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetChildrenCore%2A> výkon, metoda vrátí pouze podřízené objekty, které jsou ve skutečnosti ve vizuálním stromu, namísto všech podřízených objektů, bez ohledu na to, zda jsou virtualizovány. | Slouží <xref:System.Windows.Automation.ItemContainerPattern> k iterátu nad <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer>všemi položkami . |

### <a name="xaml"></a>XAML

Jmenné <xref:System.Windows>prostory: , <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>,<xref:System.Windows.Markup>

Sestavení: PresentationFramework (v presentationframework.dll), PresentationCore (v PresentationCore.dll), WindowsBase (v souboru WindowsBase.dll)

| Funkce | Rozdíly od 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Rozšíření o značky** | WPF nyní správně vždy používá <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A> hodnotu z <xref:System.Windows.Markup.MarkupExtension> metody namísto vrácení objektu v určitých případech, kdy se používá rozšíření značek k nastavení vlastnosti nebo k vytvoření položky v kolekci. Rozšíření značky může vrátit sám v některých případech. | Pokud vaše aplikace přistupuje k prostředku, který vrátil <xref:System.Windows.Markup.MarkupExtension> objekt <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A>v dřívějších <xref:System.Windows.Markup.MarkupExtension> verzích, odkazujte na objekt, který je vrácen z aplikace , namísto objektu. |
| **Analýza atributů** | Atributy v XAML nyní může mít pouze jedno období. Platí například následující:<br><br>`<Button Background="Red"/>`(bez období)<br><br>`<Button Button.Background = "Red"/>`(jedno období)<br><br>Následující již není platný:<br><br>`<Button Control.Button.Background = "Red"/>`(více než jedno období) | Opravte atributy XAML, které mají více než jedno období. |

## <a name="xml"></a>XML

Řádky v této tabulce popisují vylepšení funkcí, které dříve měly omezení nebo jiné problémy.

### <a name="schema-and-transforms"></a>Schéma a transformace

Jmenné <xref:System.Xml.Linq>prostory: ; <xref:System.Xml.Schema>,<xref:System.Xml.XPath>

Sestavení: System.Xml (v souboru System.Xml.dll), System.Xml.Linq (v souboru System.Xml.Linq.dll)

| Funkce | Rozdíly od 3,5 SP1 |
| ------- | ------------------------ |
| **Schémata chameleonů** | Chcete-li zabránit poškození dat, chameleon schémata jsou nyní klonovány správně, pokud jsou součástí více schémat.<br><br>Schémata chameleonjsou schémata, která nemají cílový obor názvů, a pokud jsou zahrnuty v jiném xsd, převezmou cílový obor názvů importujícího schématu. Často se používají k zahrnutí běžných typů do schématu. |
| **ID funkce** | [Funkce ID](/sql/xquery/functions-on-sequences-id) XSLT nyní vrací správnou hodnotu <xref:System.Xml.XmlReader> namísto null, když je objekt předán XLST.<br><br>Pokud uživatel vytvořil <xref:System.Xml.XmlReader> objekt z linq na třídu XML pomocí <xref:System.Xml.Linq.XNode.CreateReader%2A> metody a tento <xref:System.Xml.XmlReader> objekt byl předán `id` XSLT, všechny instance funkce v XSLT dříve vrátil null. Toto není povolená vrácená hodnota `id` pro funkci. |
| **Atribut Obor názvů** | Chcete-li zabránit <xref:System.Xml.XPath.XPathNavigator> poškození dat, objekt nyní `x:xmlns` vrátí místní název atributu správně. |
| **Deklarace oboru názvů** | Objekt <xref:System.Xml.XmlReader> v podstromu již nevytváří duplicitní deklarace oboru názvů v rámci jednoho prvku XML. |
| **Ověření schématu** | Chcete-li zabránit chybné ověření schématu, <xref:System.Xml.Schema.XmlSchemaSet> třída umožňuje schémata XSD správně a konzistentně. Tato schémata mohou zahrnovat další schémata; `A.xsd` může například `B.xsd`obsahovat , `C.xsd`které mohou zahrnovat . Kompilace některého z těchto způsobí, že tento graf závislostí, které mají být provázány. |
| **Funkce skriptu** | [Funkce k dispozici funkce](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256124(v=vs.100)) již `false` nesprávně vrátí, pokud je funkce skutečně k dispozici. |
| **Identifikátory URI** | Metoda <xref:System.Xml.Linq.XElement.Load%2A> nyní vrátí správné BaseURI v linq dotazy. |

### <a name="validation"></a>Ověřování

Jmenné <xref:System.Xml.Linq>prostory: ; <xref:System.Xml.Schema>,<xref:System.Xml.XPath>

Sestavení: System.Xml (v souboru System.Xml.dll), System.Xml.Linq (v souboru System.Xml.Linq.dll)

| Funkce | Rozdíly od 3,5 SP1 |
| ------- | ------------------------ |
| **Překladače oboru názvů** | Metoda <xref:System.Xml.XmlReader.ReadContentAs%2A> již ignoruje <xref:System.Xml.IXmlNamespaceResolver> překládání, které jí bylo předáno.<br><br>V předchozích verzích byl překladač zadaného <xref:System.Xml.XmlReader> oboru názvů ignorován a místo toho byl použit. |
| **Prázdné místo** | Chcete-li zabránit ztrátě dat při <xref:System.Xml.XmlReader.Create%2A> vytváření čtečky, metoda již zahodí významné prázdné místo.<br><br>Ověření XML rozpozná režim smíšeného obsahu, ve kterém lze text promíchat se značkami XML. Ve smíšeném režimu je důležité všechny prázdné znaky a měly by být hlášeny. |

### <a name="writing"></a>Psaní

Jmenné <xref:System.Xml.Linq>prostory: ; <xref:System.Xml.Schema>,<xref:System.Xml.XPath>

Sestavení: System.Xml (v souboru System.Xml.dll), System.Xml.Linq (v souboru System.Xml.Linq.dll)

| Funkce | Rozdíly od 3,5 SP1 |
| ------- | ------------------------ |
| **Odkazy na entity** | Chcete-li zabránit poškození dat, odkazy na entity již nejsou v atributech XML dvakrát entityňaty.<br><br>Pokud se uživatel pokusil zapsat `xmlns` entitu `xml:lang` `xml:space` do atributu <xref:System.Xml.XmlWriter.WriteEntityRef%2A> nebo do atributu nebo pomocí metody, entita byla ve výstupu dvakrát entita, čímž byla data poškozena. |
| **Nová manipulace s linkami** | Chcete-li zabránit <xref:System.Xml.XmlWriter> poškození <xref:System.Xml.NewLineHandling> dat, objekty respektují možnost. |

## <a name="see-also"></a>Viz také

- [Nové typy a členy v rozhraní .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff641764%28v=vs.100%29)
- [Průvodce migrací na rozhraní .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff657133%28v=vs.100%29)
- [Co je nového v rozhraní .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms171868%28v=vs.100%29)
- [Kompatibilita verzí v rozhraní .NET Framework](version-compatibility.md)
- [Migrace řešení Sady Office do rozhraní .NET Framework 4](/visualstudio/vsto/migrating-office-solutions-to-the-dotnet-framework-4-or-later)
- [Zastaralé položky v knihovně tříd rozhraní .NET Framework](../whats-new/whats-obsolete.md)
