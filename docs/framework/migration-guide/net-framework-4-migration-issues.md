---
title: Problémy s migrací rozhraní .NET Framework 4
ms.date: 05/02/2017
helpviewer_keywords:
- .NET Framework 4, migration
- application compatibility
ms.assetid: df478548-8c05-4de2-8ba7-adcdbe1c2a60
ms.openlocfilehash: 8e83859733f021afbe074a7b4818b155d74efdff
ms.sourcegitcommit: 9a4488a3625866335e83a20da5e9c5286b1f034c
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/15/2020
ms.locfileid: "83420458"
---
# <a name="net-framework-4-migration-issues"></a>Problémy s migrací rozhraní .NET Framework 4

Tento článek popisuje problémy s migrací mezi .NET Framework verze 3,5 Service Pack 1 a .NET Framework verze 4, včetně oprav, změn dodržování předpisů a zabezpečení standardů a změn na základě zpětné vazby od zákazníků. Většina těchto změn nevyžaduje žádné programové změny v aplikacích. Pro ty, které mohou zahrnovat změny, se podívejte na sloupec **Doporučené změny** v tabulce. Významné změny jsou rozdělené podle oblasti, například ASP.NET a Windows Presentation Foundation (WPF).

Podrobný přehled problémů v tomto článku najdete v tématu [Průvodce migrací na .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff657133%28v=vs.100%29).

Informace o nových funkcích najdete v článku [novinky v .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms171868%28v=vs.100%29).

## <a name="aspnet-and-web"></a>ASP.NET a Web

Obory názvů: <xref:System.Web> , <xref:System.Web.Mobile> , <xref:System.Web.Security> ,<xref:System.Web.UI.WebControls>

Assembly: System. Web (v System. Web. dll)

| Příznak  | Rozdíly z 3,5 SP1 | Doporučené změny |
| -------- | ------------------------ | ------------------- |
| **Soubory definic prohlížeče** | Soubory definic prohlížeče byly aktualizovány tak, aby obsahovaly informace o nových a aktualizovaných prohlížečích a zařízeních. Odebraly se starší prohlížeče a zařízení, jako je například Netscape Navigator, a přidaly se novější prohlížeče a zařízení, jako je Google Chrome a Apple iPhone.<br><br>Pokud vaše aplikace obsahuje vlastní definice prohlížečů, které dědí z jedné z odebraných definic prohlížeče, zobrazí se chyba.<br><br><xref:System.Web.HttpBrowserCapabilities>Objekt (který je vystaven `Request.Browse` vlastností stránky) je řízen definičními soubory prohlížeče. Proto se informace vracené přístupem k vlastnosti tohoto objektu v ASP.NET 4 mohou lišit od informací, které byly vráceny v dřívější verzi ASP.NET. | Pokud vaše aplikace spoléhá na staré soubory definice prohlížeče, můžete je zkopírovat z následující složky:<br><br>*Windows \\ Microsoft.NET \\ Framework \\ v 2.0.50727 \\ Configuration \\ Browsers*<br><br>Zkopírujte soubory do odpovídající složky * \\ konfiguračního \\ prohlížeče* pro ASP.NET 4. Po zkopírování souborů spusťte nástroj příkazového řádku [Aspnet_regbrowsers. exe](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms229858(v=vs.90)) . Další informace najdete na webu [https://www.asp.net/mobile](/aspnet/mobile/overview) . |
| **Podřízené aplikace běžící v rámci smíšených verzí ASP.NET** | ASP.NET 4 aplikace, které jsou nakonfigurované jako podřízené položky aplikací, které používají starší verze ASP.NET, se nemusí podařit spustit kvůli chybám konfigurace nebo kompilace. Konkrétní chyba, ke které dojde, závisí na tom, jestli je aplikace spuštěná ve službě IIS 6,0 nebo v části IIS 7 nebo IIS 7,5. | Můžete provádět změny v konfiguračních souborech ovlivněných aplikací, aby systém konfigurace správně rozpoznal aplikaci ASP.NET 4. Informace o změnách, které je třeba provést, naleznete v části "podřízené aplikace ASP.NET 4 se nepodaří spustit, když v části ASP.NET 2,0 nebo ASP.NET 3,5 aplikace" v dokumentu [ASP.NET 4 nejnovější změny](/aspnet/whitepapers/aspnet4/breaking-changes) na webu ASP.NET. |
| **Změny ClientID** | Nové `clientIDMode` nastavení v ASP.NET 4 umožňuje určit, jak ASP.NET generuje `id` atribut pro prvky jazyka HTML. V předchozích verzích ASP.NET bylo výchozí chování ekvivalentní s `AutoID` nastavením `clientIDMode` . Výchozí nastavení je nyní `Predictable` . Další informace naleznete v tématu [Identifikace ovládacího prvku webového serveru ASP.NET](https://docs.microsoft.com/previous-versions/aspnet/1d04y8ss%28v=vs.100%29). | Použijete-li sadu Visual Studio k upgradu aplikace z ASP.NET 2,0 nebo ASP.NET 3,5, nástroj automaticky přidá nastavení do souboru Web. config, který zachovává chování dřívějších verzí .NET Framework. Pokud však provedete upgrade aplikace tím, že změníte fond aplikací ve službě IIS tak, aby byl cílový .NET Framework 4, ASP.NET ve výchozím nastavení použije nový režim. Chcete-li zakázat nový režim ID klienta, přidejte do souboru Web. config následující nastavení:<br><br>`<pages clientIDMode="AutoID" />` |
| **Zabezpečení přístupu kódu (CAS)** | ASP.NET 2,0 – funkce sítě přidané v ASP.NET 3,5 používají model CAS (.NET Framework 1,1 a .NET Framework 2,0 Code Access Security). Implementace certifikačních autorit v ASP.NET 4 se ale podstatně převedla. V důsledku toho mohou ASP.NET aplikace s částečným vztahem důvěryhodnosti, které spoléhají na důvěryhodný kód spuštěný v globální mezipaměti sestavení, selhat s různými výjimkami zabezpečení. Aplikace s částečným vztahem důvěryhodnosti, které spoléhají na rozsáhlé změny v zásadách CAS počítače, můžou selhat i vyvolat výjimky zabezpečení. | Můžete vrátit částečně důvěryhodné aplikace ASP.NET 4 k chování ASP.NET 1,1 a 2,0 pomocí nového `legacyCasModel` atributu v `trust` konfiguračním elementu, jak je znázorněno v následujícím příkladu:<br><br>`<trust level= "Medium" legacyCasModel="true" />`<br><br>Důležité: návrat ke staršímu modelu CAS může představovat nižší zabezpečení.<br><br>Další informace o novém modelu zabezpečení přístupu kódu ASP.NET 4 najdete v tématu [zabezpečení přístupu kódu v aplikacích ASP.NET 4](https://docs.microsoft.com/previous-versions/dd984947(v=vs.100)). |
| **Konfigurační soubory** | Kořenové konfigurační soubory (soubor Machine. config a kořenový soubor Web. config) pro .NET Framework a ASP.NET 4 byly aktualizovány tak, aby obsahovaly většinu často se konfiguračních informací, které byly nalezeny v souborech Web. config aplikace v ASP.NET 3,5. Vzhledem ke složitosti spravovaných systémů konfigurace služby IIS 7 a IIS 7,5, které spouštějí aplikace ASP.NET 3,5 v ASP.NET 4 a v části IIS 7 a služba IIS 7,5 můžou způsobit chyby ASP.NET nebo chyby služby IIS. | Upgradujte aplikace ASP.NET 3,5 na ASP.NET 4 pomocí nástrojů pro upgrade projektu v aplikaci Visual Studio. Visual Studio 2010 automaticky upraví soubor Web. config aplikace ASP.NET 3,5 tak, aby obsahoval vhodné nastavení pro ASP.NET 4.<br><br>Aplikace ASP.NET 3,5 však můžete spouštět pomocí .NET Framework 4 bez nutnosti rekompilace. V takovém případě může být nutné ručně upravit soubor Web. config aplikace před spuštěním aplikace v části .NET Framework 4 a IIS 7 nebo IIS 7,5. Konkrétní změna, kterou je třeba provést, závisí na kombinaci softwaru, se kterým pracujete, včetně vydání aktualizace Service Pack (SP). Informace o možných kombinacích softwaru, které jsou ovlivněné touto změnou a jak řešit problémy s konkrétními kombinacemi, najdete v části "chyby konfigurace související s novou kořenovou konfigurací ASP.NET 4" v dokumentu [ASP.NET 4 průlomové změny](/aspnet/whitepapers/aspnet4/breaking-changes) na webu ASP.NET. |
| **Vykreslování ovládacího prvku** | V předchozích verzích ASP.NET byly některé ovládací prvky vygenerovány značkou, kterou nemůžete zakázat. Ve výchozím nastavení se tento typ značky už negeneruje v ASP.NET 4. Změny vykreslování mají vliv na následující ovládací prvky:<br><br>\*`Image` `ImageButton` Ovládací prvky a již nevykreslují `border="0"` atribut.<br>\*`BaseValidator`Třídy a ovládací prvky ověřování, které jsou z něho odvozené, již ve výchozím nastavení nevykresluje červený text.<br>\*`HtmlForm`Ovládací prvek nevykresluje `name` atribut.<br>\*`Table`Ovládací prvek již nevykresluje `border="0"` atribut.<br><br>Ovládací prvky, které nejsou navrženy pro vstup uživatele (například `Label` ovládací prvek), již nevykreslují `disabled="disabled"` atribut, pokud `Enabled` je jeho vlastnost nastavena na `false` (nebo pokud dědí toto nastavení z ovládacího prvku kontejneru). | Použijete-li aplikaci Visual Studio k upgradu aplikace z ASP.NET 2,0 nebo ASP.NET 3,5, nástroj automaticky přidá nastavení do souboru Web. config, který zachovává starší vykreslování. Pokud však provedete upgrade aplikace tím, že změníte fond aplikací ve službě IIS tak, aby byl cílový .NET Framework 4, ASP.NET ve výchozím nastavení použije nový režim vykreslování. Chcete-li zakázat nový režim vykreslování, přidejte do souboru Web. config následující nastavení:<br><br>`<pages controlRenderingCompatibilityVersion="3.5" />` |
| **Obslužné rutiny událostí ve výchozích dokumentech** | ASP.NET 4 vykreslí `form` hodnotu atributu HTML elementu v `action` podobě prázdného řetězce, když je proveden požadavek na nepřipojenou adresu URL s výchozím dokumentem. V dřívějších verzích ASP.NET vyžadoval požadavek na `http://contoso.com` Default. aspx požadavek. V tomto dokumentu se počáteční `form` značka vykreslí jako v následujícím příkladu:<br><br>`<form action="Default.aspx" />`<br><br>V ASP.NET 4 je požadavek, který má `http://contoso.com` také za následek požadavek na Default. aspx, ale ASP.NET nyní vykresluje značku otevření HTML `form` jako v následujícím příkladu:<br><br>`<form action="" />`<br><br>Když `action` je atribut prázdným řetězcem, `DefaultDocumentModule` objekt IIS vytvoří podřízený požadavek na Default. aspx. Ve většině podmínek je tato podřízená žádost transparentní pro kód aplikace a stránka default. aspx se spouští normálně. Potenciální interakce mezi spravovaným kódem a integrovaným režimem služby IIS 7 nebo IIS 7,5 může ale způsobit, že spravované stránky. aspx v rámci podřízeného požadavku přestanou fungovat správně. Pokud dojde k následujícím podmínkám, podřízené žádosti na výchozí dokument. aspx budou mít za následek chybu nebo neočekávané chování:<br><br>\*Do prohlížeče se pošle stránka. aspx s `form` `action` atributem elementu nastaveným na "".<br>\*Formulář je odeslán zpět do ASP.NET.<br>\*Spravovaný modul HTTP čte část těla entity, například `Request.Form` nebo `Request.Params` . To způsobí, že tělo entity požadavku POST bude načteno do spravované paměti. V důsledku toho již není tělo entity k dispozici pro žádné moduly nativního kódu, které jsou spuštěny v integrovaném režimu služby IIS 7 nebo IIS 7,5.<br>\*Objekt IIS `DefaultDocumentModule` nakonec spustí a vytvoří podřízený požadavek na dokument default. aspx. Vzhledem k tomu, že tělo entity již bylo přečteno částí spravovaného kódu, není k dispozici žádný obsah entity k odeslání podřízené žádosti.<br>\*Při spuštění kanálu HTTP pro podřízený požadavek se obslužná rutina souborů. aspx spustí během fáze spuštění obslužné rutiny.<br><br>Vzhledem k tomu, že není k dispozici žádné tělo entity, neexistují žádné proměnné formuláře ani stav zobrazení. Proto nejsou k dispozici žádné informace pro obslužnou rutinu stránky. aspx k určení, jakou událost (pokud existuje) by měla být vyvolána. V důsledku toho žádná z obslužných rutin události postback pro stránku ovlivnila. aspx nebude spuštěna. | Informace o způsobech řešení problémů, které mohou nastat v důsledku této změny, naleznete v části "obslužné rutiny událostí nemusí být vyvolány ve výchozím dokumentu v integrovaném režimu služby IIS 7 nebo IIS 7,5" v dokumentu [ASP.NET 4 zásadní změny](/aspnet/whitepapers/aspnet4/breaking-changes) na webu ASP.NET. |
| **Algoritmus hash** | ASP.NET používá šifrovací algoritmy i algoritmy hash k zabezpečení dat, jako jsou soubory cookie ověřování pomocí formulářů a stav zobrazení. Ve výchozím nastavení používá ASP.NET 4 <xref:System.Security.Cryptography.HMACSHA256> algoritmus pro operace hash pro soubory cookie a stav zobrazení. Starší verze ASP.NET používaly starší <xref:System.Security.Cryptography.HMACSHA1> algoritmus. | Pokud spouštíte aplikace, které smíchá ASP.NET 2,0 a ASP.NET 4, kde data, jako jsou soubory cookie ověřování pomocí formulářů, musí fungovat napříč verzemi .NET Framework, nakonfigurujte webovou aplikaci ASP.NET 4 tak, aby používala starší <xref:System.Security.Cryptography.HMACSHA1> algoritmus přidáním následujícího nastavení do souboru Web. config:<br><br>`<machineKey validation="SHA1" />` |
| **Hostování ovládacích prvků v aplikaci Internet Explorer** | V aplikaci Internet Explorer již nelze hostovat ovládací prvky model Windows Forms, protože existují lepší řešení pro hostování ovládacích prvků na webu. Proto byla z .NET Framework odebrána sestavení IEHost. dll a IEExec. exe. | Pro vývoj vlastních ovládacích prvků ve webových aplikacích můžete použít následující technologie:<br><br>\*Můžete vytvořit aplikaci Silverlight a nakonfigurovat ji tak, aby běžela mimo prohlížeč. Další informace najdete v tématu [podpora mimo prohlížeč](https://docs.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/dd550721%28v=vs.95%29).<br>\*Můžete sestavit aplikaci prohlížeče XAML (XBAP), která bude využívat možnosti WPF (vyžaduje .NET Framework na klientských počítačích). Další informace naleznete v tématu [Přehled aplikací prohlížeče WPF XAML](../wpf/app-development/wpf-xaml-browser-applications-overview.md). |
| **HtmlEncode a UrlEncode metody** | `HtmlEncode`Metody a `UrlEncode` <xref:System.Web.HttpUtility> tříd a byly <xref:System.Web.HttpServerUtility> aktualizovány tak, aby se zakódovat znak jednoduché uvozovky (') následujícím způsobem:<br><br>\*`HtmlEncode`Metoda kóduje instance jednoduché uvozovky jako`&#39;`<br>\*`UrlEncode`Metoda kóduje instance jednoduché uvozovky jako`%27` | Projděte si kód pro místa, kde používáte `HtmlEncode` `UrlEncode` metody a, a ujistěte se, že změna v kódování nemá za následek změnu, která by ovlivnila vaši aplikaci. |
| **HttpException – chyby v aplikacích ASP.NET 2,0** | Po povolení ASP.NET 4 ve službě IIS 6 mohou aplikace ASP.NET 2,0, které běží na službě IIS 6 (v systému Windows Server 2003 nebo Windows Server 2003 R2), způsobit chyby, jako například následující:`System.Web.HttpException: Path '/[yourApplicationRoot]/eurl.axd/[Value]' was not found.` | * Pokud se ASP.NET 4 nevyžaduje pro spuštění webu, přemapujte lokalitu na místo toho použití ASP.NET 2,0.<br><br>-nebo-<br><br>\*Pokud je pro spuštění webu vyžadován ASP.NET 4, přesuňte všechny podřízené virtuální adresáře ASP.NET 2,0 na jiný web, který je namapován na ASP.NET 2,0.<br><br>-nebo-<br><br>\*Zakažte adresy URL s příponou. Další informace naleznete v tématu "aplikace ASP.NET 2,0 mohou generovat chyby HttpException –, které odkazují na eurl. axd" v dokumentu [ASP.NET 4 nejnovější změny](/aspnet/whitepapers/aspnet4/breaking-changes) na webu ASP.NET. |
| **Typy členství** | Některé typy (například <xref:System.Web.Security.MembershipProvider> ) používané ve členství ASP.NET byly přesunuty ze souboru System. Web. dll do sestavení System. Web. ApplicationServices. dll. Typy byly přesunuty za účelem vyřešení závislostí architektonického vrstvení mezi typy v klientovi a v rozšířených .NET Framework SKU. | Knihovny tříd, které byly upgradovány z dřívějších verzí ASP.NET a které používají typy členství, které byly přesunuty, mohou být při použití v projektu ASP.NET 4 neúspěšné kompilovány. Pokud ano, přidejte odkaz do projektu knihovny tříd do třídy System. Web. ApplicationServices. dll. |
| **Změny ovládacího prvku nabídky** | Změny v <xref:System.Web.UI.WebControls.Menu> ovládacím prvku mají za následek následující chování:<br><br>\*Pokud <xref:System.Web.UI.WebControls.MenuRenderingMode> je nastaven na `List` , nebo pokud <xref:System.Web.UI.WebControls.MenuRenderingMode> je nastaven na `Default` a <xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> je nastaven na `4.0` nebo vyšší, <xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> vlastnost nemá žádný vliv.<br>\*Pokud cesta nastavená ve <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> vlastnostech a obsahuje zpětné lomítko ( \\ ), image se nevykreslují. (V dřívějších verzích nástroje ASP.NET může cesta obsahovat zpětné lomítko.) | * Místo nastavení <xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> vlastnosti pro jednotlivé položky nabídky, nastavte <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> nebo <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> nadřazeného <xref:System.Web.UI.WebControls.Menu> ovládacího prvku.<br><br>-nebo-<br><br>Nastavte <xref:System.Web.UI.WebControls.MenuRenderingMode> na `Table` , nebo nastavte <xref:System.Web.UI.WebControls.MenuRenderingMode> na `Default` a nastavte <xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> na `3.5` . Tato nastavení způsobí <xref:System.Web.UI.WebControls.Menu> , že ovládací prvek bude používat rozložení založené na tabulkách HTML, které používalo v dřívějších verzích ASP.NET.<br>\*Pokud cesta ve <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> vlastnosti nebo obsahuje zpětné lomítko ( \\ ), nahraďte znak lomítka (/). |
| **Mobilní sestavení v souboru Web. config** | V předchozích verzích nástroje ASP.NET byl do kořenového souboru Web. config zahrnut odkaz na sestavení System. Web. Mobile. dll v `assemblies` části v tématu `system.web` / `compilation` . Pro zvýšení výkonu byl odebrán odkaz na toto sestavení.<br><br>Poznámka: sestavení System. Web. Mobile. dll a mobilní ovládací prvky ASP.NET jsou součástí ASP.NET 4, ale jsou zastaralé. | Pokud chcete použít typy z tohoto sestavení, přidejte odkaz na sestavení buď v kořenovém souboru Web. config, nebo v souboru Web. config aplikace. |
| **Ukládání výstupu do mezipaměti** | V ASP.NET 1,0 vyvolala chyba stránky v mezipaměti, které `Location="ServerAndClient"` jsou zadané jako výstupní &euro; nastavení mezipaměti, aby `Vary:*` v odpovědi vygenerovala hlavičku HTTP. To mělo vliv na to, že klientské prohlížeče nebudou stránku ukládat místně do mezipaměti. V ASP.NET 1,1 <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> byla přidána metoda, která by mohla být volána, aby bylo možné záhlaví potlačit `Vary:*` . Zprávy o chybách ale naznačují, že vývojáři neznají stávající `SetOmitVaryStar` chování.<br><br>V ASP.NET 4 se `Vary:*` Hlavička protokolu HTTP už neemituje z odpovědí, které určují následující direktivu:<br><br>`<%@ OutputCache Location="ServerAndClient" %>`<br><br>V důsledku toho <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> už metoda není potřeba, aby se záhlaví potlačilo `Vary:*` . V aplikacích, které určují "ServerAndClient" pro `Location` atribut, budou stránky v prohlížeči ukládat do mezipaměti, aniž by to vyžadovalo volání <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> . | Pokud stránky v aplikaci musí generovat `Vary:*` , zavolejte metodu, <xref:System.Web.HttpResponse.AppendHeader%2A> jak je znázorněno v následujícím příkladu:<br><br>`System.Web.HttpResponse.AppendHeader("Vary","*");`<br><br>Alternativně můžete změnit hodnotu atributu výstupní ukládání do mezipaměti `Location` na "Server". |
| **Analýza stránky** | Analyzátor stránky pro webové stránky ASP.NET (soubory. aspx) a uživatelské ovládací prvky (soubory. ascx) jsou přísnější v ASP.NET 4 než v dřívějších verzích ASP.NET a označí více značek jako neplatné než v dřívějších verzích. | Prověřte chybové zprávy, které jsou vytvářeny při spuštění stránky, a opravte chyby, které jsou výsledkem neplatných značek. |
| **Typy Passport** | Podpora služby Passport integrovaná do ASP.NET 2,0 je zastaralá a není podporována z důvodu změn ve službě Passport (nyní Live ID SDK). V důsledku toho typy související se službou Passport v <xref:System.Web.Security> jsou nyní označeny `ObsoleteAttribute` atributem. | Změňte jakýkoli kód, který používá typy služby Passport v <xref:System.Web.Security> oboru názvů (například <xref:System.Web.Security.PassportIdentity> ), aby bylo možné použít sadu Windows Live ID SDK. |
| **PathInfo informace v vlastnosti FilePath** | ASP.NET 4 již nezahrnuje `PathInfo` hodnotu návratových hodnot z vlastností, jako jsou <xref:System.Web.HttpRequest.FilePath> , <xref:System.Web.HttpRequest.AppRelativeCurrentExecutionFilePath> a <xref:System.Web.HttpRequest.CurrentExecutionFilePath> . Místo toho jsou `PathInfo` informace k dispozici v <xref:System.Web.HttpRequest.PathInfo> . Představte si například následující fragment adresy URL:<br><br>`/testapp/Action.mvc/SomeAction`<br><br>V dřívějších verzích ASP.NET <xref:System.Web.HttpRequest> mají vlastnosti následující hodnoty:<br><br>\* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc/SomeAction`<br>\*<xref:System.Web.HttpRequest.PathInfo>: (prázdné)<br><br>V ASP.NET 4 <xref:System.Web.HttpRequest> mají vlastnosti místo toho následující hodnoty:<br><br>\* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc`<br>\* <xref:System.Web.HttpRequest.PathInfo>: `SomeAction` | Projděte si kód pro místa, kde se spoléháte na vlastnosti <xref:System.Web.HttpRequest> třídy, aby vracely informace o cestě; změňte kód tak, aby odrážel změny v způsobu, jakým jsou vraceny informace o cestě. |
| **Žádost o ověření** | Aby bylo možné vylepšit ověření žádosti, bude ověření žádosti ASP.NET vyvoláno dříve v životním cyklu žádosti. V důsledku toho ověření žádosti spustí pro požadavky, které nejsou pro soubory. aspx, například pro volání webové služby a pro vlastní obslužné rutiny. Pokud jsou v kanálu zpracování požadavků spuštěné vlastní moduly HTTP, ověření žádosti bude také aktivní.<br><br>V důsledku této změny můžou žádosti o jiné prostředky než soubory. aspx vyvolat chyby ověření žádosti. Vlastní kód, který běží v kanálu požadavků (například vlastní moduly HTTP), může také vyvolat chyby ověření žádosti. | V případě potřeby se můžete vrátit k původnímu chování, které spouští pouze stránky. aspx, a to pomocí následujícího nastavení v souboru webové konfigurace:<br><br>`<httpRuntime requestValidationMode="2.0" />`<br><br>Upozornění: Pokud se vrátíte ke starému chování, zajistěte, aby veškerý kód v existujících obslužných rutinách, modulech a jiném vlastním kódu prováděl kontroly potenciálně nebezpečných vstupů HTTP, které by mohly být vektory útoku XSS. |
| **Směrování** | Pokud vytvoříte web systému souborů v aplikaci Visual Studio 2010 a web je ve složce, která obsahuje tečku (.) v názvu složky, směrování adres URL nebude spolehlivě fungovat. Z některých virtuálních cest se vrátí chyba HTTP 404. K tomu dochází, protože Visual Studio 2010 spustí vývojový server sady Visual Studio, který používá nesprávnou cestu pro kořenový virtuální adresář. | * Na stránce **vlastností** webu založeného na souborech změňte atribut **virtuální cesta** na "/".<br><br>-nebo-<br><br>\*Vytvořte projekt webové aplikace místo projektu webu. Projekty webové aplikace nemají tento problém a směrování adres URL funguje i v případě, že složka projektu má tečku v názvu.<br><br>-nebo-<br><br>\*Vytvořte web založený na protokolu HTTP hostovaný ve službě IIS. Weby hostované službou IIS mohou obsahovat tečky ve virtuální cestě i ve složce souborů projektu. |
| **Weby SharePoint** | Pokud se pokusíte spustit web ASP.NET 4, který je nasazen jako podřízený webu služby SharePoint, který obsahuje vlastní úroveň částečného vztahu důvěryhodnosti s názvem, zobrazí se `WSS_Minimal` následující chyba:<br><br>`Could not find permission set named 'ASP.Net'.` | V současné době nejsou žádné verze SharePointu kompatibilní s ASP.NET. V důsledku toho byste se neměli pokoušet spustit web ASP.NET 4 jako podřízenou položku webu služby SharePoint. |
| **Standardy XHTML 1,1** | Aby bylo možné povolit dodržování předpisů XHTML 1,1 pro nové weby, ovládací prvky ASP.NET v .NET Framework 4 budou generovat HTML kompatibilní s NORMou XHTML 1,1. Toto vykreslování je povoleno pomocí následující možnosti v souboru Web. config v rámci `<system.Web>` elementu:<br><br>`<pages controlRenderingCompatibilityVersion="4.0"/>`<br><br>Tato možnost je ve výchozím nastavení nastavena na 4,0. Pro webové projekty, které jsou upgradovány ze sady Visual Studio 2008, je nastavení 3,5 povoleno pro zajištění kompatibility. | Žádné |

## <a name="core"></a>Jádro

### <a name="general-features"></a>Obecné funkce

| Příznak | Rozdíly z 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **CardSpace** | Služba Windows CardSpace již není součástí .NET Framework; je k dispozici samostatně. | Službu Windows CardSpace si stáhněte z webu [Microsoft Download Center](https://go.microsoft.com/fwlink/?LinkId=199868). |
| **Konfigurační soubory** | Byly provedeny opravy, jak .NET Framework přistupuje k konfiguračním souborům aplikace. | Pokud má konfigurační soubor aplikace název *Application-Name. config*, přejmenujte ho na *Application-Name. exe. config*. Například přejmenujte *MyApp. config* na *MyApp. exe. config*. |
| **Kompilátor kódu C#** | `Compiler`Třídy, `CompilerError` a `ErrorLevel` , které byly v <xref:Microsoft.CSharp> oboru názvů, již nejsou k dispozici a jejich sestavení (cscompmgd. dll) již není zahrnuto do .NET Framework. | Použijte <xref:System.CodeDom.Compiler.CodeDomProvider> třídu a jiné třídy v <xref:System.CodeDom.Compiler> oboru názvů. Další informace najdete v tématu [použití CodeDOM](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/y2k85ax6%28v=vs.100%29). |
| **Hostování** (NESPRAVOVANÉ rozhraní API) | Aby bylo možné vylepšit možnosti hostování, některá rozhraní API pro aktivaci hostování jsou zastaralá. Funkce souběžného spouštění v rámci procesu umožňují aplikaci načíst a spustit více verzí .NET Framework ve stejném procesu. Můžete například spouštět aplikace, které načítají doplňky (nebo komponenty) založené na .NET Framework 2,0 SP1 a doplňky založené na .NET Framework 4 ve stejném procesu. Starší součásti budou nadále používat starší verzi .NET Framework a nové komponenty používají novou verzi .NET Framework. | Použijte konfigurace popsané v [části proces souběžného spouštění](../deployment/in-process-side-by-side-execution.md). |
| **Nový model zabezpečení** | Zásady zabezpečení přístupu kódu (CAS) byly vypnuté a nahrazené zjednodušeným modelem, jak je popsáno v tématu [změny zabezpečení v .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd233103%28v=vs.100%29). | Pokud závisíte na certifikačních autoritách v aplikacích, může být nutné provést úpravy. Další informace najdete v tématu [Kompatibilita a migrace zásad zabezpečení přístupu kódu](../misc/code-access-security-policy-compatibility-and-migration.md). |

### <a name="date-and-time"></a>Datum a čas

Hosting<xref:System>

Sestavení: mscorlib (v mscorlib. dll)

| Příznak | Rozdíly z 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Letní úspory** | Aby byla zajištěna konzistence se systémovými hodinami, časové vlastnosti (například <xref:System.TimeZoneInfo.Local> a <xref:System.DateTime.Now> ) nyní používají pravidla operačního systému místo jiných .NET Frameworkch dat pro operace letního času. | Žádné |
| **Formátování řetězců** | Aby bylo možné podporovat formátování zohledňující jazykovou verzi, <xref:System.TimeSpan> zahrnuje struktura nová přetížení `ToString` metod, a `Parse` `TryParse` spolu s novými `ParseExact` `TryParseExact` metodami a. | Žádné |

### <a name="globalization"></a>Globalizace

Seznam nových neutrálních a specifických kultur naleznete v tématu [co je nového v globalizaci a lokalizaci](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd997383%28v=vs.100%29).

Hosting<xref:System.Globalization>

Sestavení: mscorlib (v mscorlib. dll)

| Příznak | Rozdíly z 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Názvy jazykových verzí** | Následující změny názvů mají vliv na německé, Divehština a africké kultury:<br><br>\*<xref:System.Globalization.CultureAndRegionInfoBuilder.CurrencyEnglishName>: Název měny pro Německo (Švýcarsko) (de-ch) jazykovou verzi se změnil z "SFR". na "fr.".<br>\*<xref:System.Globalization.DateTimeFormatInfo.LongDatePattern>: Vzor dlouhého data pro jazykovou verzi Divehština (Maledivy) (DV-MV) se změnil z "dd/MMMM/rrrr" na "dd/mm/rrrr".<br>\*<xref:System.Globalization.DateTimeFormatInfo.PMDesignator>: Odp. specifikátor jazykové verze Afrikánština (Jižní Afrika) (AF-ZA) se změnil z "nm" na "PM". | Všimněte si změny názvu jazykové verze. |
| **LCID – parametr** | Pro zajištění konzistence s očekávaným chováním v nastavení automatizačního serveru již CLR nepředá aktuální jazykovou verzi pro `LCID` parametr pro nespravované aplikace založené na modelu COM. Místo toho předává 1033 (EN-US) pro jazykovou verzi. | Nejsou potřebné žádné úpravy kromě nativních aplikací, které vyžadují určitou jazykovou verzi. |
| **Zastaralé typy jazykové verze** | <xref:System.Globalization.CultureTypes>Typy a <xref:System.Globalization.CultureTypes> jazykové verze jsou nyní zastaralé.<br><br>Z důvodu zpětné kompatibility <xref:System.Globalization.CultureTypes> nyní vrátí neutrální a specifické jazykové verze, které byly součástí předchozí .NET Framework, a <xref:System.Globalization.CultureTypes> nyní vrátí prázdný seznam. | Použijte další hodnoty <xref:System.Globalization.CultureTypes> výčtu. |
| **Načítání jazykové verze** | Počínaje systémem Windows 7 .NET Framework 4 načte informace o jazykové verzi z operačního systému místo uložení samotných dat. Kromě toho .NET Framework synchronizuje se systémem Windows pro řazení a data o velikosti písmen. | Žádné |
| **Standardy Unicode 5,1** | .NET Framework teď podporuje všechny znaky Unicode 5,1 – Přidání asi 1400 znaků. Mezi další znaky patří nové symboly, šipky, diakritiky, interpunkční znaménka, matematické symboly, tahy a znakové Symboly CJK, další Malajálamské a Telugské číselné znaky a různé znaky Myanmaru, Latin, arabské písmo, mongolský a tibetský. Pro Unicode 5,1 se podporují následující nové skripty: Sundanese, figurka, šachy, Vai, polotučné, Kayah, Rejang, Gurmukhí, Udijština, tamilština, telugština a Cham. | Žádné |

### <a name="exceptions"></a>Výjimky

Obory názvů: <xref:System> ,<xref:System.Runtime.ExceptionServices>

Sestavení: mscorlib (v mscorlib. dll)

| Příznak | Rozdíly z 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Výjimky pro poškozený stav procesu** | CLR již neposkytuje výjimky pro poškozený stav procesu do obslužných rutin výjimek ve spravovaném kódu. | Tyto výjimky signalizují, že stav procesu je poškozen. Nedoporučujeme spouštět aplikaci v tomto stavu.<br><br>Další informace naleznete v tématu <xref:System.Runtime.ExceptionServices.HandleProcessCorruptedStateExceptionsAttribute> a v položce [zpracování výjimek poškozených stavů](https://docs.microsoft.com/archive/msdn-magazine/2009/february/clr-inside-out-handling-corrupted-state-exceptions) v časopise MSDN Magazine. |
| **Výjimky prováděcího modulu** | <xref:System.ExecutionEngineException>je nyní zastaralá, protože výjimka zachytitelné umožní pokračovat v běhu nestabilního procesu. Tato změna zlepšuje předvídatelnost a spolehlivost v modulu runtime. | Použijte <xref:System.InvalidOperationException> k signalizaci podmínky. |

### <a name="reflection"></a>Reflexe

Hosting<xref:System.Reflection>

Sestavení: mscorlib (v mscorlib. dll)

| Příznak | Rozdíly z 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Algoritmy hash sestavení** | <xref:System.Reflection.AssemblyName.HashAlgorithm>Vlastnost nyní vrací hodnotu <xref:System.Configuration.Assemblies.AssemblyHashAlgorithm> , protože modul runtime neznáte algoritmus hash odkazovaného sestavení, když sestavení není načteno. (To odkazuje na použití vlastnosti v odkazovaném sestavení, jako například, které vrátila <xref:System.Reflection.Assembly.GetReferencedAssemblies%2A> metoda.) | Žádné |
| **Načítání sestavení** | Chcete-li zabránit redundantnímu načítání sestavení a uložit virtuální adresní prostor, modul CLR nyní načte sestavení pouze pomocí funkce Win32 `MapViewOfFile` . Již nevolá `LoadLibrary` funkci.<br><br>Tato změna má vliv na diagnostické aplikace následujícími způsoby:<br><br>\*<xref:System.Diagnostics.ProcessModuleCollection>Již nebude obsahovat žádné moduly z knihovny tříd (soubor. dll), jak získá volání `Process.GetCurrentProcess().Modules` .<br>\*Aplikace Win32, které používají `EnumProcessModules` funkci, nebudou zobrazovat všechny spravované moduly uvedené v seznamu. | Žádné |
| **Deklarující typ** | <xref:System.Type.DeclaringType>Vlastnost nyní správně vrací hodnotu null, pokud typ nemá deklarující typ. | Žádné |
| **Delegáti** | Delegát nyní vyvolá <xref:System.ArgumentNullException> namísto a, <xref:System.NullReferenceException> Pokud je hodnota null předána konstruktoru delegáta. | Zajistěte, aby všechny zpracování výjimek byly zachyceny <xref:System.ArgumentNullException> . |
| **Změna umístění globální mezipaměti sestavení** | Pro sestavení .NET Framework 4 se globální mezipaměť sestavení (GAC) přesunula z adresáře Windows (% WINDIR%). do podadresáře Microsoft.Net (*% windir% \\ Microsoft.NET*). Sestavení z dřívějších verzí zůstanou ve starším adresáři.<br><br>Nespravovaný výčet [ASM_CACHE_FLAGS](../unmanaged-api/fusion/asm-cache-flags-enumeration.md) obsahuje nový `ASM_CACHE_ROOT_EX` příznak. Tento příznak Získá umístění mezipaměti pro sestavení .NET Framework 4, které lze získat funkcí [GetCachePath –](../unmanaged-api/fusion/getcachepath-function.md) . | Žádné za předpokladu, že aplikace nepoužívají explicitní cesty k sestavením, což není doporučený postup. |
| **Nástroj globální mezipaměti sestavení** | Nástroj [Gacutil. exe (nástroj Global Assembly Cache Tool)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ex0ss12c%28v=vs.100%29) již nepodporuje prohlížeč modulů plug-in prostředí. | Žádné |

### <a name="interoperability"></a>Interoperabilita

Hosting<xref:System.Runtime.InteropServices>

Sestavení: mscorlib (v mscorlib. dll)

| Příznak | Rozdíly z 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Délka vyrovnávací paměti** (NESPRAVOVANÉ rozhraní API) | Pro ukládání paměti byla funkce pro `pBufferLengthOffset` parametr pro metodu [ICorProfilerInfo2:: GetStringLayout –](../unmanaged-api/profiling/icorprofilerinfo2-getstringlayout-method.md) změněna tak, aby odpovídala `pStringLengthOffset` parametru. Oba parametry nyní ukazují na umístění posunutí délky řetězce. Délka vyrovnávací paměti byla odebrána z reprezentace třídy řetězce. | Odeberte všechny závislosti na délce vyrovnávací paměti. |
| **Ladění JIT** | Aby bylo možné zjednodušit registraci JIT (just-in-time), ladicí program .NET Framework nyní používá pouze klíč registru AeDebug, který řídí chování ladění JIT pro nativní kód. Tato změna má za následek následující:<br><br>\*Již nelze registrovat dva různé ladicí programy pro spravovaný a nativní kód.<br>\*Již nemůžete spustit ladicí program automaticky pro neinteraktivní proces, ale můžete uživatele vyzvat k interaktivnímu procesu.<br>\*Už nebudete dostávat oznámení, když se ladicí program nepovede spustit, nebo když není k dispozici žádný registrovaný ladicí program, který by měl být spuštěný.<br>\*Automaticky spouštěné zásady, které závisejí na interaktivitě aplikace, už nejsou podporované. | Podle potřeby upravte operace ladění. |
| **Vyvolání platformy** | Aby bylo možné zvýšit výkon při interoperabilitě s nespravovaným kódem, nesprávná konvence volání ve volání platformy nyní způsobí selhání aplikace. V předchozích verzích zařazovací vrstva tyto chyby vyřešila v zásobníku. | Ladění aplikací v Microsoft Visual Studio vás upozorní na tyto chyby, abyste je mohli opravit.<br><br>Pokud máte binární soubory, které nelze aktualizovat, můžete do konfiguračního souboru aplikace zahrnout prvek [ \< NetFx40_PInvokeStackResilience>](../configure-apps/file-schema/runtime/netfx40-pinvokestackresilience-element.md) , aby bylo možné chyby při volání vyřešit v zásobníku jako v předchozích verzích. To však může ovlivnit výkon aplikace. |
| **Odebraná rozhraní** (NESPRAVOVANÉ rozhraní API) | Aby nedošlo k nejasnostem vývojářů, byla odebrána následující rozhraní, protože neposkytovaly žádné užitečné scénáře běhu a CLR neposkytoval ani nepřijal žádné implementace:<br><br>\***INativeImageINativeImageDependency**<br>\***INativeImageInstallInfo**<br>\***INativeImageEvaluate**<br>\***INativeImageConverter**<br>\***ICorModule**<br>\***IMetaDataConverter** | Žádné |

## <a name="data"></a>Data

Tato část popisuje problémy s migrací pro použití datových sad a klientů SQL, datových serverů Entity Framework, LINQ to SQL a WCF (dříve označovaných jako ADO.NET Data Services).

### <a name="dataset-and-sql-client"></a>Datová sada a klient SQL

V následující tabulce jsou popsána vylepšení funkcí, které dříve obsahovala určitá omezení nebo jiné problémy.

Obory názvů: <xref:System.Data> , <xref:System.Data.Objects.DataClasses> ,<xref:System.Data.SqlClient>

Sestavení: System. data (v System. data. dll), System. data. entity (v System. data. entity. dll)

| Příznak | Rozdíly z 3,5 SP1 |
| ------- | ------------------------ |
| **Scénáře POCO** | <xref:System.Data.Objects.DataClasses.IRelatedEnd>Rozhraní má nové metody pro zlepšení použitelnosti v jednoduchých starých scénářích CLR objektů (POCO). Tyto nové metody přijímají <xref:System.Object> místo <xref:System.Data.Objects.DataClasses.IEntityWithRelationships> entity jako parametr. |
| **Úpravy řádků** | <xref:System.Collections.IList.IndexOf%2A>Metoda, jak je implementována <xref:System.Data.DataView> třídou, nyní správně vrací hodnotu upravovaného řádku místo vrácení hodnoty-1. |
| **Události** | <xref:System.Data.DataRowView.PropertyChanged>Událost je nyní vyvolána, když je řádek v upraveném stavu a <xref:System.Data.DataRow.RejectChanges%2A> je volána metoda. Tato změna usnadňuje vytváření ovládacích prvků uživatelského rozhraní, které zpřístupňují obsah <xref:System.Data.DataSet> objektu. |
| **Výjimky** | <xref:System.Data.SqlClient.SqlCommand.Prepare%2A>Metoda teď vyvolá výjimku, <xref:System.InvalidOperationException> když připojení není nastavené nebo otevřené místo <xref:System.NullReferenceException> . |
| **Mapování zobrazení** | Chyby mapování zobrazení dotazu jsou nyní zachyceny v době návrhu namísto vyvolání za <xref:System.NullReferenceException> běhu.<br><br>Ověřování mapování nyní zachytí chybu, ve které jsou dvě sady přidružení v koncepčním schématu (CSDL) namapovány na stejný sloupec. |
| **Transakce** | Pokud se aplikace pokusí spustit příkaz na připojení po dokončení transakce (včetně přerušení nebo vrácení zpět), <xref:System.InvalidOperationException> je nyní vyvolána výjimka. Předchozí verze nevyvolaly výjimku a umožňují spustit další příkazy i v případě, že transakce byla přerušena. |

### <a name="entity-framework"></a>Entity Framework

V následující tabulce jsou popsána vylepšení funkcí, které dříve obsahovala určitá omezení nebo jiné problémy.

Obory názvů: <xref:System.Data> , <xref:System.Data.Objects> ,<xref:System.Data.Objects.DataClasses>

Sestavení: System. data. entity (v System. data. entity. dll)

| Příznak | Rozdíly z 3,5 SP1 |
| ------- | ------------------------ |
| **Objekty entit** | V případě, že je metoda volána, je nyní mezi <xref:System.Data.Objects.ObjectContext.Detach%2A> metodou a stavem objektu entity parita <xref:System.Data.Objects.ObjectContext.SaveChanges%2A> . Tato vylepšená konzistence zabraňuje vyvolání neočekávaných výjimek. |
| **Entity SQL** | Byla vylepšena pravidla pro rozlišení identifikátorů v Entity SQL.<br><br>Analyzátor Entity SQL má vylepšenou logiku pro překlad identifikátorů s více částmi. |
| **Strukturální poznámky** | Entity Framework teď rozpoznává strukturální poznámky. |
| **Dotazy** | V dotazech byly provedeny následující vylepšení:<br><br>\*`GroupBy`Dotaz používající null klíč přes prázdnou kolekci nevrátí žádné řádky bez ohledu na to, zda dotaz obsahuje další výběr.<br>\*Vygenerovaný SQL v LINQ a dotazech Entity-SQL teď ve výchozím nastavení považují řetězcové parametry za hodnoty, které nejsou Unicode. |

### <a name="linq-to-sql"></a>Technologie LINQ to SQL

V následující tabulce jsou popsána vylepšení funkcí, které dříve obsahovala určitá omezení nebo jiné problémy.

Hosting<xref:System.Data.Linq>

Assembly: System. data. Linq (v System. data. Linq. dll)

| Příznak | Rozdíly z 3,5 SP1 |
| ------- | ------------------------ |
| **Události** | <xref:System.Data.Linq.EntitySet%601>Kolekce nyní vyvolá <xref:System.Data.Linq.EntitySet%601.ListChanged> událost pro operace přidání a odebrání <xref:System.Data.Linq.EntitySet%601> , pokud je uvolněna, kromě vyvolání události při načtení kolekce. |
| **Dotazy** | `Skip(0)`už se v LINQ to SQLch dotazech Neignoruje. V důsledku toho se můžou dotazy, které mají tuto metodu, chovat jinak. Například v některých případech `OrderBy` je klauzule vyžadována s `Skip(0)` a dotaz nyní vyvolá <xref:System.NotSupportedException> výjimku, pokud `OrderBy` nebyla klauzule zahrnuta. |

### <a name="wcf-data-services"></a>WCF Data Services

V následující tabulce jsou popsána vylepšení funkcí, které dříve obsahovala určitá omezení nebo jiné problémy.

Obory názvů: <xref:System.Data.Services> , <xref:System.Data.Services.Client> , <xref:System.Data.Services.Common> ,<xref:System.Data.Services.Providers>

Sestavení: System. data. Services (v System. data. Services. dll), System. data. Services. Client (v System. data. Services. Client. dll)

| Příznak | Rozdíly z 3,5 SP1 |
| ------- | ------------------------ |
| **Dávkový binární obsah** | WCF Data Services teď v žádostech a odpovědích podporuje dávkový binární obsah. |
| **Zachycení změn** | Pro žádost o odstranění se teď spouštějí zachycení změn.<br><br>Zachytávací modul pro změny je metoda, která se spouští pokaždé, když server obdrží požadavek na úpravu entity v sadě entit. Spustí se před provedením příchozího požadavku. Zachytávací modul changeing poskytuje přístup ke změněné entitě a operaci, která se na ní provádí. |
| **Výjimky** | Následující podmínky nyní vyvolávají užitečnější výjimky namísto <xref:System.NullReferenceException> :<br><br>\*A <xref:System.ServiceProcess.TimeoutException> když dojde k vypršení časového limitu volání datové služby.<br>\*A <xref:System.Data.Services.Client.DataServiceRequestException> při provedení chybné žádosti o datovou službu.<br><br>Ve vašich aplikacích byste měli změnit zpracování výjimek, aby se zachytily nové výjimky. |
| **Hlavičky** | V hlavičkách byly provedeny následující vylepšení:<br><br>\*WCF Data Services nyní správně odmítne `eTag` hlavičku, která má nespecifikovanou hodnotu.<br>\*WCF Data Services nyní vrátí chybu a nespustí požadavek na požadavek DELETE na odkaz, pokud `if-*` je hlavička v žádosti.<br>\*WCF Data Services nyní vrátí chybu klientovi ve formátu (Atom, JSON), který klient zadal v hlavičce Accept. |
| **Čtečka JSON** | Čtecí modul JavaScript Object Notation (JSON) nyní správně vrátí chybu při čtení jednoduchého řídicího znaku zpětného lomítka (" \\ ") při zpracování datových částí JSON odesílaných do datové služby WCF. |
| **Sloučí** | Ve výčtu byly provedeny následující vylepšení <xref:System.Data.Services.Client.MergeOption> :<br><br>\*<xref:System.Data.Services.Client.MergeOption>Možnost sloučení již nemění entitu v klientovi v důsledku jakékoli následné reakce z datové služby.<br>\*<xref:System.Data.Services.Client.MergeOption>Možnost je nyní konzistentní mezi dynamickými aktualizacemi SQL a uloženými procedurami. |
| **Žádosti** | <xref:System.Data.Services.DataService%601.OnStartProcessingRequest%2A>Metoda je nyní volána před zpracováním žádosti o Data Services. To umožňuje, aby požadavek správně fungoval pro <xref:System.Data.Services.Providers.ServiceOperation> služby. |
| **Datové proudy** | WCF Data Services už nezavírá podkladový datový proud pro operace čtení a zápisu. |
| **Identifikátory URI** | Uvozovací znaky identifikátorů URI od klienta WCF Data Services byly opraveny. |

## <a name="windows-communication-foundation-wcf"></a>Windows Communication Foundation (WCF)

V následující tabulce jsou popsána vylepšení funkcí, které dříve obsahovala určitá omezení nebo jiné problémy.

| Příznak | Rozdíly z 3,5 SP1 |
| ------- | ------------------------ |
| **Konfigurační soubory** | Pokud chcete povolit dědění chování prostřednictvím hierarchie konfiguračního souboru, WCF teď podporuje sloučení mezi konfiguračními soubory.<br><br>Model dědičnosti konfigurace je nyní rozšířen tak, aby umožnil uživatelům definovat chování, které se použije na všechny služby spuštěné v počítači.<br><br>Pokud existuje chování se stejným názvem na různých úrovních hierarchie, můžete narazit na změny chování. |
| **Hostování služeb** | `<serviceHostingEnvironment>`Prvek konfigurace na úrovni služby již nelze zadat přidáním atributu `allowDefinition="MachineToApplication"` do definice elementu.<br><br>Určení `<serviceHostingEnvironment>` prvku na úrovni služby je technicky nesprávné a způsobuje nekonzistentní chování. |

## <a name="windows-presentation-foundation-wpf"></a>Windows Presentation Foundation (WPF)

### <a name="applications"></a>Aplikace

Obory názvů: <xref:System.Windows> ,<xref:System.Windows.Controls>

Sestavení: PresentationFramework (v PresentationFramework. dll)

| Příznak | Rozdíly z 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Zpracování výjimek** | Aby bylo možné zjistit chyby dříve, WPF vyvolá <xref:System.Reflection.TargetInvocationException> a nastaví <xref:System.Exception.InnerException> vlastnost na kritické výjimky, jako například <xref:System.NullReferenceException> , <xref:System.OutOfMemoryException> , <xref:System.StackOverflowException> a <xref:System.Security.SecurityException> , namísto zachycení původní výjimky. | Žádné |
| **Propojené prostředky** | Aby bylo propojování snazší, soubory prostředků (jako jsou obrázky), které jsou umístěny v jiném umístění než ve struktuře složky projektu, používají úplnou cestu souboru prostředků namísto pouze jeho názvu souboru jako ID prostředku při sestavení aplikace. Aplikace bude moci vyhledat soubory v době běhu. | Žádné |
| **Aplikace s částečným vztahem důvěryhodnosti** | Z hlediska zabezpečení jsou aplikace založené na systému Windows, které běží v částečném vztahu důvěryhodnosti a obsahují <xref:System.Windows.Controls.WebBrowser> ovládací prvek nebo <xref:System.Windows.Controls.Frame> ovládací prvek, který obsahuje kód HTML, vyvolána <xref:System.Security.SecurityException> při vytvoření ovládacího prvku.<br><br>Aplikace prohlížeče vyvolá výjimku a zobrazí zprávu, pokud jsou splněny všechny následující podmínky:<br><br>\*Aplikace běží v prohlížeči Firefox.<br>\*Aplikace běží v částečném vztahu důvěryhodnosti v zóně Internet z nedůvěryhodných webů.<br>\*Aplikace obsahuje <xref:System.Windows.Controls.WebBrowser> ovládací prvek nebo <xref:System.Windows.Controls.Frame> ovládací prvek, který obsahuje kód HTML.<br><br>Aplikace, které běží z důvěryhodných nebo ze zóny intranetu, nebudou ovlivněny. | V aplikacích v prohlížeči můžete tuto změnu zjednodušit jedním z následujících způsobů:<br><br>\*Spusťte aplikaci prohlížeče v úplném vztahu důvěryhodnosti.<br>\*Uživatelé přidávají web aplikace do zóny důvěryhodných serverů.<br>\*Mají zákazníci aplikaci spuštěnou v Internet Exploreru. |
| **Slovníky prostředků** | Chcete-li zlepšit slovníky prostředků na úrovni motivů a zabránit jejich změnám, Freezable prostředky, které jsou definovány ve slovníku prostředků a sloučeny do slovníku na úrovni motivu, jsou nyní vždy označeny jako zmrazené a jsou neměnné. Toto je očekávané chování prostředků Freezable. | Aplikace, které upravují prostředek definovaný ve sloučeném slovníku na úrovni motivů, by měly klonovat prostředek a upravovat Klonovaný kopii. Případně je možné prostředek označit `x:Shared="false"` tak, aby při <xref:System.Windows.ResourceDictionary> každém dotazování prostředku vytvořil novou kopii. |
| **Windows 7** | Pro zajištění lepšího fungování aplikací WPF v systému Windows 7 byly provedeny následující vylepšení pro opravu chování okna:<br><br>\*Stavy Dock a gesta teď fungují podle očekávání na základě interakcí uživatelů.<br>\*Příkazy hlavního panelu se **zobrazují v oknech okna, Zobrazit okna skládané**a **zobrazovat okna Windows vedle sebe** mají správné chování a aktualizují příslušné vlastnosti.<br>\*`Top`Vlastnosti, `Left` , `Width` a `Height` pro maximalizované nebo minimalizované okno nyní obsahují správné umístění pro obnovení okna místo jiných hodnot v závislosti na monitoru. | Žádné |
| **Styl a průhlednost Windows** | <xref:System.InvalidOperationException>Výjimka je vyvolána, pokud se pokusíte nastavit <xref:System.Windows.Window.WindowStyle> na jinou hodnotu než <xref:System.Windows.WindowStyle> kdy <xref:System.Windows.Window.AllowsTransparency> je `true` a <xref:System.Windows.WindowState> <xref:System.Windows.WindowState> . | Pokud je nutné změnit <xref:System.Windows.Window.WindowStyle> when <xref:System.Windows.Window.AllowsTransparency> `true` , můžete zavolat `SetWindowLongPtr` funkci Win32. |
| **Prohlížeč souborů ve formátu XPS** | WPF nezahrnuje Microsoft XML Paper Specification Essentials Pack (XPSEP). XPSEP je součástí systémů Windows 7 a Windows Vista.<br><br>V počítači se systémem Windows XP bez nainstalovaného .NET Framework 3,5 SP1, tisk pomocí rozhraní WPF API, které není v nástroji, <xref:System.Windows.Controls.PrintDialog> bude spoléhat na Winspool. Některé funkce tiskárny nebudou hlášeny a některá nastavení tiskárny nebudou během tisku použita. | V případě potřeby nainstalujte [sadu Microsoft XML Paper Specification Essentials Pack](https://www.microsoft.com/en-us/download/details.aspx?id=11816). |

### <a name="controls"></a>Ovládací prvky

Obory názvů: <xref:System.Windows> , <xref:System.Windows.Controls> , <xref:System.Windows.Data> ,<xref:System.Windows.Input>

Sestavení: PresentationFramework (v PresentationFramework. dll), PresentationCore (v PresentationCore. dll), WindowsBase (v WindowsBase. dll)

| Příznak | Rozdíly z 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Dialogová okna** | Pro zlepšení spolehlivosti je <xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> metoda volána ve stejném vlákně, které <xref:Microsoft.Win32.FileDialog> ovládací prvek vytvořil. | Nezapomeňte vytvořit <xref:Microsoft.Win32.FileDialog> ovládací prvek a volat <xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> metodu ve stejném vlákně. |
| **Plovoucí okna** | Chcete-li opravit logiku pro obnovení při obnově, která nesprávně udržuje v plovoucím okně (takže se zobrazí jako modální dialogové okno), je nyní znemožněno obnovení, pokud kandidát není podřízeným oknem. | Žádné |
| **Položky v kolekcích** | Pokud je položka přesunuta nebo přidána do podkladové kolekce, zobrazí se ve <xref:System.Windows.Data.CollectionView> stejném relativním umístění, pokud <xref:System.Windows.Data.CollectionView> není řazena. To poskytuje konzistenci mezi pozicí položky v kolekci a přidruženou <xref:System.Windows.Data.CollectionView> . | Použijte <xref:System.Windows.Controls.ItemContainerGenerator.ContainerFromItem%2A> metodu nebo <xref:System.Windows.Data.CollectionView.IndexOf%2A> k vyhledání umístění položky v <xref:System.Windows.Data.CollectionView> Místo spoléhání na pevné umístění položky. |
| **Rozložení** | Aby nedošlo k zbytečnému opětovnému rozložení, změňte <xref:System.Windows.Controls.Page.ShowsNavigationUI> již neplatnost rozložení, nebo vynutí jiné rozložení. | Pokud očekáváte, že změna <xref:System.Windows.Controls.Page.ShowsNavigationUI> způsobí jiné rozložení, zavolejte <xref:System.Windows.UIElement.InvalidateVisual%2A> po nastavení vlastnosti. |
| **Nabídky** | Chcete-li povolit text ClearType v nabídce automaticky otevíraných oken, byly provedeny úpravy <xref:System.Windows.Controls.ControlTemplate> třídy a <xref:System.Windows.Controls.MenuItem> ovládacího prvku a dalších ovládacích prvků. | Aplikace by neměly spoléhat na vizuální strukturu šablon ovládacích prvků. Pouze pojmenované části a <xref:System.Windows.Controls.ControlTemplate> jsou součástí veřejné smlouvy. Pokud aplikace musí najít určitý objekt v <xref:System.Windows.Controls.ControlTemplate> , vyhledejte ve vizuálním stromu konkrétní typ a nemusíte přitom spoléhat na pevné umístění objektu ve stromu. |
| **Navigace** | Pokud se <xref:System.Windows.Controls.Frame> přímo naviguje na umístění, <xref:System.Windows.Navigation.NavigatingCancelEventArgs.IsNavigationInitiator> vlastnost je `true` po počáteční navigaci. Tato změna zabrání vyvolání dalších událostí během spouštěcích scénářů. | Žádné |
| **Automaticky otevíraná okna** | <xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback>Delegáta se teď dá vyvolat víckrát během průchodu rozložení, a ne jenom jednou. | Pokud váš <xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback> delegát vypočítá pozici na <xref:System.Windows.Controls.Primitives.Popup> základě jeho předchozí pozice, Přepočítejte pozici pouze v případě, že se `popupSize` změní hodnoty `targetSize` parametrů, nebo `offset` . |
| **Hodnoty vlastností** | <xref:System.Windows.DependencyObject.SetCurrentValue%2A>Metoda teď umožňuje nastavit vlastnost na efektivní hodnotu, i když nadále respektuje jakékoli vazby, styl nebo Trigger, které mají vliv na vlastnost. | Autoři ovládacích prvků by měli použít <xref:System.Windows.DependencyObject.SetCurrentValue%2A> vždy, když se hodnota vlastnosti změní jako vedlejší účinek jiné akce, včetně manipulace s uživatelem. |
| **Textová pole** | Z hlediska zabezpečení <xref:System.Windows.Forms.TextBoxBase.Copy%2A> <xref:System.Windows.Forms.TextBoxBase.Cut%2A> nejsou metody a v tichém režimu úspěšné, když jsou volány v částečném vztahu důvěryhodnosti.<br><br>Kromě toho je programové spuštění <xref:System.Windows.Input.ApplicationCommands.Copy> <xref:System.Windows.Input.ApplicationCommands.Cut> vlastnosti nebo u ovládacího prvku, který dědí z, <xref:System.Windows.Controls.Primitives.TextBoxBase> blokováno v částečném vztahu důvěryhodnosti. Avšak uživatelem iniciované příkazy kopírování a vyjmutí, jako je například kliknutí na tlačítko, jehož <xref:System.Windows.Controls.Primitives.ButtonBase.Command> vlastnost je vázána na některý z těchto příkazů, bude fungovat. Standardní kopírování a vyjmutí prostřednictvím klávesových zkratek a místní nabídka bude i nadále fungovat jako předtím v částečném vztahu důvěryhodnosti. | Připojte <xref:System.Windows.Input.ApplicationCommands.Copy> příkaz nebo <xref:System.Windows.Input.ApplicationCommands.Cut> k akci iniciované uživatelem, například kliknutím na tlačítko. |

### <a name="graphics"></a>Grafika

Obory názvů: <xref:System.Windows> , <xref:System.Windows.Controls> , <xref:System.Windows.Data> , <xref:System.Windows.Input> ,<xref:System.Windows.Media.Effects>

Sestavení: PresentationFramework (v PresentationFramework. dll), PresentationCore (v PresentationCore. dll), WindowsBase (v WindowsBase. dll)

| Příznak | Rozdíly z 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Rastrové efekty** | Aby bylo možné zvýšit výkon, <xref:System.Windows.Media.Effects.BitmapEffect> Třída a třídy, které dědí z <xref:System.Windows.Media.Effects.BitmapEffect> třídy, i když jsou stále přítomny, jsou zakázány. Efekt se vykreslí pomocí kanálu vykreslování s hardwarovou akcelerací, pokud jsou splněné následující podmínky:<br><br>\*Aplikace používá <xref:System.Windows.Media.Effects.DropShadowBitmapEffect> nebo <xref:System.Windows.Media.Effects.BlurBitmapEffect> , která má vlastnost RADIUS nastavenou na méně než 100 diú.<br>\*Grafická karta v počítači, na kterém je spuštěna aplikace, podporuje Pixel Shader 2,0.<br><br>Nejsou-li tyto podmínky splněny, <xref:System.Windows.Media.Effects.BitmapEffect> objekt nebude mít žádný vliv.<br><br>Visual Studio také generuje upozornění kompilátoru při výskytu <xref:System.Windows.Media.Effects.BitmapEffect> objektu nebo podtřídy.<br><br><xref:System.Windows.Media.DrawingContext.PushEffect%2A>Metoda je označena jako zastaralá. | Přerušit používání starších <xref:System.Windows.Media.Effects.BitmapEffect> a odvozených tříd a místo toho použít nové třídy odvozené z <xref:System.Windows.Media.Effects.Effect> : <xref:System.Windows.Media.Effects.BlurEffect> , <xref:System.Windows.Media.Effects.DropShadowEffect> a <xref:System.Windows.Media.Effects.ShaderEffect> .<br><br>Můžete také vytvořit vlastní efekty děděním z <xref:System.Windows.Media.Effects.ShaderEffect> třídy. |
| **Rastrové snímky** | Naklonované <xref:System.Windows.Media.Imaging.BitmapFrame> objekty nyní přijímají <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress> <xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted> události, a <xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed> . To umožňuje, aby se obrázky stažené z webu stáhly a nastavily na <xref:System.Windows.Controls.Image> ovládacím prvku, <xref:System.Windows.Style> aby fungovaly správně.<br><br>Změna chování se projeví pouze v případě, že jsou splněné všechny následující příkazy:<br><br>\*Přihlásíte se k odběru <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress> <xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted> události, nebo <xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed> .<br>\*Zdroj <xref:System.Windows.Media.Imaging.BitmapFrame> je z webu.<br>\*Naklonuje se v <xref:System.Windows.Media.Imaging.BitmapFrame> době, kdy stahování stále probíhá. | Ověřte odesílatele v obslužné rutině události a proveďte akci pouze v případě, že je odesilatel původní <xref:System.Windows.Media.Imaging.BitmapFrame> . |
| **Dekódování obrázků** | Chcete-li zabránit tomu, aby nedošlo k <xref:System.IO.IOException> nezpracování, když obrázky nemusí být dekódovat, <xref:System.Windows.Media.Imaging.BitmapSource> Třída vyvolá <xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed> událost, když dekóduje obrázek. | Odeberte jakékoli zpracování výjimek pro <xref:System.IO.IOException> a pomocí <xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed> události vyhledejte chybu dekódování. |

### <a name="input"></a>Vstup

Obory názvů: <xref:System.Windows> , <xref:System.Windows.Controls> , <xref:System.Windows.Data> ,<xref:System.Windows.Input>

Sestavení: PresentationFramework (v PresentationFramework. dll), PresentationCore (v PresentationCore. dll), WindowsBase (v WindowsBase. dll)

| Příznak | Rozdíly z 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Instance příkazů vazby** | Chcete-li poskytnout mechanismus pro vytváření instancí příkazů založených na modelu zobrazení na vstupní gesta založené na zobrazení, <xref:System.Windows.Input.InputBinding> Třída teď dědí z <xref:System.Windows.Freezable> místo <xref:System.Windows.DependencyObject> . Následující vlastnosti jsou nyní vlastnosti závislosti:<br><br>\* <xref:System.Windows.Input.InputBinding.Command><br>\* <xref:System.Windows.Input.InputBinding.CommandParameter><br>\* <xref:System.Windows.Input.InputBinding.CommandTarget><br><br>Tato změna má za následek následující:<br><br>\*<xref:System.Windows.Input.InputBinding>Objekt je nyní zmrazen, pokud je zaregistrován místo zbývající měnitelné.<br>\*Z důvodu omezení třídy nelze přistupovat k objektům na úrovni instance <xref:System.Windows.Input.InputBinding> z více vláken <xref:System.Windows.DependencyObject> .<br>\*Vstupní vazby na úrovni třídy nelze po registraci provést z důvodu omezení <xref:System.Windows.Freezable> třídy.<br>\*Vstupní vazby nelze zadat pro instance příkazů, které jsou vytvořeny v modelu zobrazení. | Vytvořte samostatné instance <xref:System.Windows.Input.InputBinding> třídy v samostatných vláknech, pokud mají být vazby proměnlivé, nebo je zablokujte jinak. Nepoužívejte statickou úroveň třídy <xref:System.Windows.Input.InputBinding> po registraci. |
| **Prohlížeče aplikace** | Aplikace WPF pro prohlížeč (. XBAP) nyní zpracovává klíčové události stejně jako samostatné aplikace WPF, aby objekty dostaly směrované klíčové události ve správném pořadí. | Žádné |
| **Nedoručené kombinace klíčů** | WPF odprodukuje nedoručené klíče, které nevytváří žádný viditelný znak, ale místo toho označuje, že klíč se má zkombinovat s dalším písmenem, aby se vytvořil jeden znak. Klíčové události vstupu, jako je například <xref:System.Windows.Input.Keyboard.KeyDownEvent> událost, se zobrazí, když je klíč neaktivním klíčem nastavením <xref:System.Windows.Input.KeyEventArgs.Key> vlastnosti na <xref:System.Windows.Input.Key> hodnotu. Obvykle se očekává chování, protože aplikace obvykle nechtějí reagovat na vstup z klávesnice, který vytváří kombinovaný znak. | Aplikace, které očekávají čtení klíčů, které byly součástí kombinovaných znaků, mohou získat nyní zakódováný klíč pomocí <xref:System.Windows.Input.KeyEventArgs.DeadCharProcessedKey> Vlastnosti. |
| **Manažer Focus** | Když <xref:System.Windows.Input.FocusManager.GetFocusedElement(System.Windows.DependencyObject)?displayProperty=nameWithType> je metoda předána elementu, který má vlastnost [IsFocusScope](xref:System.Windows.Input.FocusManager.IsFocusScope%2A) připojené na `true` , metoda vrátí prvek, který je posledním prvkem zaměřeným na klávesnici v rámci tohoto oboru fokusu, pokud a pouze v případě, že vrácený element patří do stejného <xref:System.Windows.PresentationSource> objektu jako prvek, který je předán metodě. | Žádné |

### <a name="ui-automation"></a>automatizace uživatelského rozhraní

Obor názvů: <xref:System.Windows> , <xref:System.Windows.Automation.Peers> ,,, <xref:System.Windows.Automation.Provider> <xref:System.Windows.Controls> <xref:System.Windows.Data> ,<xref:System.Windows.Input>

Sestavení: PresentationFramework (v PresentationFramework. dll), PresentationCore (v PresentationCore. dll), UIAutomationProvider (v UIAutomationProvider. dll), WindowsBase (v WindowsBase. dll)

| Příznak | Rozdíly z 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Hierarchie tříd zobrazení** | <xref:System.Windows.Automation.Peers.TreeViewAutomationPeer>Třídy a <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer> dědí z <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer> místo <xref:System.Windows.Automation.Peers.FrameworkElementAutomationPeer> . | Pokud převezmete z <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer> tříd a přepište <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer.GetChildrenCore%2A> metodu, zvažte vrácení objektu, který dědí z nové <xref:System.Windows.Automation.Peers.TreeViewDataItemAutomationPeer> třídy. |
| **Kontejnery mimo obrazovku** | Chcete-li opravit nesprávnou návratovou hodnotu, <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.IsOffscreenCore%2A> Metoda nyní správně vrátí `false` pro kontejnery položek, které jsou posunuty mimo zobrazení. Také hodnota metody není ovlivněna překrytí jinými okny nebo podle toho, zda je prvek viditelný na konkrétním monitorování. | Žádné |
| **Nabídky a podřízené objekty** | Chcete-li povolit automatizaci uživatelského rozhraní nabídek, které obsahují podřízené objekty jiné než <xref:System.Windows.Controls.MenuItem> objekty, <xref:System.Windows.Automation.Peers.MenuItemAutomationPeer.GetChildrenCore%2A> Metoda nyní vrátí <xref:System.Windows.Automation.Peers.AutomationPeer> objekt podřízeného <xref:System.Windows.UIElement> objektu namísto <xref:System.Windows.Automation.Peers.MenuItemAutomationPeer> objektu. | Žádné |
| **Nová rozhraní a sestavení** | Chcete-li povolit nové funkce pro automatizaci uživatelského rozhraní, byla přidána následující rozhraní:<br><br>\* <xref:System.Windows.Automation.Provider.IItemContainerProvider><br>\* <xref:System.Windows.Automation.Provider.ISynchronizedInputProvider><br>\* <xref:System.Windows.Automation.Provider.IVirtualizedItemProvider> | Každý projekt, který sestavuje partnerské vztahy automatizace WPF, musí přidat explicitní odkaz na UIAutomationProvider. dll. |
| **Thumbs** | <xref:System.Windows.Automation.Peers.ThumbAutomationPeer.GetClassNameCore%2A>Metoda vrací hodnotu namísto hodnoty null. Proto ovládací prvky, jako například <xref:System.Windows.Controls.GridSplitter> , které dědí z <xref:System.Windows.Controls.Primitives.Thumb> třídy, budou nahlásit název automatizaci uživatelského rozhraní. | Žádné |
| **Virtualizované elementy** | Pro zvýšení výkonu <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetChildrenCore%2A> Metoda vrátí pouze podřízené objekty, které jsou ve skutečnosti ve vizuálním stromu, namísto všech podřízených objektů bez ohledu na to, zda jsou virtualizované. | Použijte <xref:System.Windows.Automation.ItemContainerPattern> k iterování všech položek v <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer> . |

### <a name="xaml"></a>XAML

Obory názvů: <xref:System.Windows> , <xref:System.Windows.Controls> , <xref:System.Windows.Data> , <xref:System.Windows.Input> ,<xref:System.Windows.Markup>

Sestavení: PresentationFramework (v PresentationFramework. dll), PresentationCore (v PresentationCore. dll), WindowsBase (v WindowsBase. dll)

| Příznak | Rozdíly z 3,5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Rozšíření značek** | WPF nyní vždy používá hodnotu z <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A> metody namísto vrácení <xref:System.Windows.Markup.MarkupExtension> objektu v určitých případech, pokud je rozšíření značek použito k nastavení vlastnosti nebo k vytvoření položky v kolekci. Rozšíření značek může v některých případech vracet sám sebe. | Pokud vaše aplikace přistupuje k prostředku, který vrátil <xref:System.Windows.Markup.MarkupExtension> objekt v dřívějších verzích, odkazujte na objekt, který je vrácen z <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A> , namísto <xref:System.Windows.Markup.MarkupExtension> objektu. |
| **Analýza atributů** | Atributy v XAML teď můžou mít jenom jednu tečku. Platné jsou například následující:<br><br>`<Button Background="Red"/>`(žádné tečky)<br><br>`<Button Button.Background = "Red"/>`(jedna tečka)<br><br>Následující akce již není platná:<br><br>`<Button Control.Button.Background = "Red"/>`(více než jedna tečka) | Správné atributy XAML, které mají více než jednu tečku. |

## <a name="xml"></a>XML

Řádky v této tabulce popisují vylepšení funkcí, které dříve obsahovaly omezení nebo jiné problémy.

### <a name="schema-and-transforms"></a>Schéma a transformace

Obory názvů: <xref:System.Xml.Linq> ; <xref:System.Xml.Schema> ,<xref:System.Xml.XPath>

Sestavení: System. XML (v System. XML. dll), System. XML. Linq (v System. XML. Linq. dll)

| Příznak | Rozdíly z 3,5 SP1 |
| ------- | ------------------------ |
| **Schémata Chameleon** | Aby nedošlo k poškození dat, schémata Chameleon se teď naklonují správně, když jsou zahrnutá v několika schématech.<br><br>Schémata Chameleon jsou schémata, která nemají cílový obor názvů a když jsou zahrnutá v jiném schématu XSD, přebírají cílový obor názvů importovaného schématu. Často se používají k zahrnutí běžných typů do schématu. |
| **Funkce ID** | [Funkce ID](/sql/xquery/functions-on-sequences-id) XSLT nyní vrací správnou hodnotu namísto hodnoty null, pokud <xref:System.Xml.XmlReader> je objekt předán do objektu XLST vztahuje.<br><br>Pokud uživatel vytvořil <xref:System.Xml.XmlReader> objekt z LINQ to XML třídy pomocí <xref:System.Xml.Linq.XNode.CreateReader%2A> metody a tento <xref:System.Xml.XmlReader> objekt byl předán do souboru XSLT, všechny instance `id` funkce v souboru XSLT dříve vrátily hodnotu null. Toto není povolená návratová hodnota pro `id` funkci. |
| **Atribut namespace** | Chcete-li zabránit poškození dat, <xref:System.Xml.XPath.XPathNavigator> objekt nyní vrátí místní název `x:xmlns` atributu správně. |
| **Deklarace oboru názvů** | <xref:System.Xml.XmlReader>Objekt v podstromu již nevytváří duplicitní deklarace oboru názvů v rámci jednoho elementu XML. |
| **Ověřování schématu** | Aby nedocházelo k chybnému ověření schématu, <xref:System.Xml.Schema.XmlSchemaSet> Třída umožňuje, aby schémata XSD byla správně kompilována a konzistentní. Tato schémata mohou zahrnovat další schémata; `A.xsd`může například zahrnovat `B.xsd` , který může obsahovat `C.xsd` . Při kompilování jedné z těchto příčin se tento graf závislostí prochází. |
| **Funkce skriptu** | Funkce, která je [k dispozici](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256124(v=vs.100)) , se už nesprávně nevrátí, `false` když je funkce skutečně dostupná. |
| **Identifikátory URI** | <xref:System.Xml.Linq.XElement.Load%2A>Metoda teď vrací správné BaseUri v dotazech LINQ. |

### <a name="validation"></a>Ověřování

Obory názvů: <xref:System.Xml.Linq> ; <xref:System.Xml.Schema> ,<xref:System.Xml.XPath>

Sestavení: System. XML (v System. XML. dll), System. XML. Linq (v System. XML. Linq. dll)

| Příznak | Rozdíly z 3,5 SP1 |
| ------- | ------------------------ |
| **Překladače oborů názvů** | <xref:System.Xml.XmlReader.ReadContentAs%2A>Metoda již neignoruje <xref:System.Xml.IXmlNamespaceResolver> překladač předaný do něj.<br><br>V předchozích verzích byl zadaný překladač oboru názvů ignorován a <xref:System.Xml.XmlReader> místo toho byl použit. |
| **Prázdné znaky** | Aby nedošlo ke ztrátě dat při vytváření čtecího zařízení, <xref:System.Xml.XmlReader.Create%2A> Metoda už nehodí významné prázdné znaky.<br><br>Ověřování XML rozpozná režim smíšeného obsahu, kde lze text vzájemně kombinovat s kódem XML. Ve smíšeném režimu je všechny prázdné znaky významné a měly by být hlášeny. |

### <a name="writing"></a>Zapsat

Obory názvů: <xref:System.Xml.Linq> ; <xref:System.Xml.Schema> ,<xref:System.Xml.XPath>

Sestavení: System. XML (v System. XML. dll), System. XML. Linq (v System. XML. Linq. dll)

| Příznak | Rozdíly z 3,5 SP1 |
| ------- | ------------------------ |
| **Odkazy na entity** | Aby nedošlo k poškození dat, odkazy na entity se už v atributech XML entitized dvakrát.<br><br>Pokud se uživatel pokusil zapsat entitu do `xmlns` atributu nebo do `xml:lang` `xml:space` atributu nebo pomocí <xref:System.Xml.XmlWriter.WriteEntityRef%2A> metody, entita byla ve výstupu entitized dvakrát, proto by poškodila data. |
| **Nové zpracování řádků** | Aby nedošlo k poškození dat, <xref:System.Xml.XmlWriter> tyto objekty respektují <xref:System.Xml.NewLineHandling> možnost. |

## <a name="see-also"></a>Viz také

- [Nové typy a členy v .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff641764%28v=vs.100%29)
- [Průvodce migrací na .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff657133%28v=vs.100%29)
- [Co je nového v .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms171868%28v=vs.100%29)
- [Kompatibilita verzí v .NET Framework](version-compatibility.md)
- [Migrace řešení Office na .NET Framework 4](/visualstudio/vsto/migrating-office-solutions-to-the-dotnet-framework-4-or-later)
- [Zastaralé položky v knihovně tříd rozhraní .NET Framework](../whats-new/whats-obsolete.md)
