---
title: Integrované ověřování systému Windows s rozšířenou ochranou
ms.date: 03/30/2017
ms.assetid: 81731998-d5e7-49e4-ad38-c8e6d01689d0
ms.openlocfilehash: c4afc008f600c9be0040f8d7623f5e20623dfd7d
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/15/2020
ms.locfileid: "74444241"
---
# <a name="integrated-windows-authentication-with-extended-protection"></a><span data-ttu-id="d49b4-102">Integrované ověřování systému Windows s rozšířenou ochranou</span><span class="sxs-lookup"><span data-stu-id="d49b4-102">Integrated Windows Authentication with Extended Protection</span></span>
<span data-ttu-id="d49b4-103">Byla provedena vylepšení, která ovlivňují způsob, <xref:System.Net.HttpWebRequest>jakým <xref:System.Net.HttpListener> <xref:System.Net.Mail.SmtpClient>je <xref:System.Net.Security.SslStream>integrované ověřování systému Windows zpracováváno třídami , , , <xref:System.Net.Security.NegotiateStream>, a souvisejícími v oborech názvů <xref:System.Net> a souvisejících s nimi.</span><span class="sxs-lookup"><span data-stu-id="d49b4-103">Enhancements were made that affect how integrated Windows authentication is handled by the <xref:System.Net.HttpWebRequest>, <xref:System.Net.HttpListener>, <xref:System.Net.Mail.SmtpClient>, <xref:System.Net.Security.SslStream>, <xref:System.Net.Security.NegotiateStream>, and related classes in the <xref:System.Net> and related namespaces.</span></span> <span data-ttu-id="d49b4-104">Byla přidána podpora pro rozšířenou ochranu pro zvýšení zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="d49b4-104">Support was added for extended protection to enhance security.</span></span>  
  
 <span data-ttu-id="d49b4-105">Tyto změny mohou ovlivnit aplikace, které používají tyto třídy k provádění webových požadavků a přijímání odpovědí tam, kde se používá integrované ověřování systému Windows.</span><span class="sxs-lookup"><span data-stu-id="d49b4-105">These changes can affect applications that use these classes to make web requests and receive responses where integrated Windows authentication is used.</span></span> <span data-ttu-id="d49b4-106">Tato změna může mít vliv také na webové servery a klientské aplikace, které jsou nakonfigurovány pro použití integrovaného ověřování systému Windows.</span><span class="sxs-lookup"><span data-stu-id="d49b4-106">This change can also impact web servers and client applications that are configured to use integrated Windows authentication.</span></span>  
  
 <span data-ttu-id="d49b4-107">Tyto změny mohou také ovlivnit aplikace, které používají tyto třídy k provádění jiných typů požadavků a přijímat odpovědi, kde se používá integrované ověřování systému Windows.</span><span class="sxs-lookup"><span data-stu-id="d49b4-107">These changes can also affect applications that use these classes to make other types of requests and receive responses where integrated Windows authentication is used.</span></span>  
  
 <span data-ttu-id="d49b4-108">Změny podpory rozšířené ochrany jsou k dispozici pouze pro aplikace v systémech Windows 7 a Windows Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="d49b4-108">The changes to support extended protection are available only for applications on Windows 7 and Windows Server 2008 R2.</span></span> <span data-ttu-id="d49b4-109">Funkce rozšířené ochrany nejsou k dispozici ve starších verzích systému Windows.</span><span class="sxs-lookup"><span data-stu-id="d49b4-109">The extended protection features are not available on earlier versions of Windows.</span></span>  
  
## <a name="overview"></a><span data-ttu-id="d49b4-110">Přehled</span><span class="sxs-lookup"><span data-stu-id="d49b4-110">Overview</span></span>  
 <span data-ttu-id="d49b4-111">Návrh integrovaného ověřování systému Windows umožňuje, aby některé odpovědi na výzvu pověření byly univerzální, což znamená, že mohou být znovu použity nebo předány.</span><span class="sxs-lookup"><span data-stu-id="d49b4-111">The design of integrated Windows authentication allows for some credential challenge responses to be universal, meaning they can be re-used or forwarded.</span></span> <span data-ttu-id="d49b4-112">Odpovědi na výzvy by měly být vytvořeny minimálně s konkrétními cílovými informacemi a pokud možno také s některými informacemi specifickými pro kanál.</span><span class="sxs-lookup"><span data-stu-id="d49b4-112">The challenge responses should be constructed at a minimum with target specific information and preferably also with some channel specific information.</span></span> <span data-ttu-id="d49b4-113">Služby pak mohou poskytovat rozšířenou ochranu, aby bylo zajištěno, že odpovědi na výzvu pověření obsahují informace specifické pro službu, jako je například hlavní název služby (SPN).</span><span class="sxs-lookup"><span data-stu-id="d49b4-113">Services can then provide extended protection to ensure that credential challenge responses contain service specific information such as a Service Principal Name (SPN).</span></span> <span data-ttu-id="d49b4-114">S těmito informacemi ve výměně přihlašovacích údajů jsou služby schopny lépe chránit před škodlivým použitím odpovědí na výzvu pověření, které mohly být nesprávně použity.</span><span class="sxs-lookup"><span data-stu-id="d49b4-114">With this information in the credential exchanges, services are able to better protect against malicious use of credential challenge responses that might have been improperly used.</span></span>  
  
 <span data-ttu-id="d49b4-115">Návrh rozšířené ochrany je vylepšení ověřovacích protokolů určených ke zmírnění útoků přenosu ověřování.</span><span class="sxs-lookup"><span data-stu-id="d49b4-115">The extended protection design is an enhancement to authentication protocols designed to mitigate authentication relay attacks.</span></span> <span data-ttu-id="d49b4-116">To se točí kolem konceptu kanálu a informace o vazbě služby.</span><span class="sxs-lookup"><span data-stu-id="d49b4-116">It revolves around the concept of channel and service binding information.</span></span>  
  
 <span data-ttu-id="d49b4-117">Celkové cíle jsou následující:</span><span class="sxs-lookup"><span data-stu-id="d49b4-117">The overall objectives are the following:</span></span>  
  
1. <span data-ttu-id="d49b4-118">Pokud je klient aktualizován na podporu rozšířené ochrany, aplikace by měly poskytnout informace o vazbě kanálu a služby všem podporovaným ověřovacím protokolům.</span><span class="sxs-lookup"><span data-stu-id="d49b4-118">If the client is updated to support the extended protection, applications should supply a channel binding and service binding information to all supported authentication protocols.</span></span> <span data-ttu-id="d49b4-119">Informace o vazbě kanálu lze poskytnout pouze v případě, že existuje kanál (TLS), na který se má vytvořit vazba.</span><span class="sxs-lookup"><span data-stu-id="d49b4-119">Channel binding information can only be supplied when there is a channel (TLS) to bind to.</span></span> <span data-ttu-id="d49b4-120">Informace o vazbě služby by měly být vždy poskytnuty.</span><span class="sxs-lookup"><span data-stu-id="d49b4-120">Service binding information should always be supplied.</span></span>  
  
2. <span data-ttu-id="d49b4-121">Aktualizované servery, které jsou správně nakonfigurovány, mohou ověřit informace o vazbě kanálu a služby, pokud jsou k dispozici v tokenu ověřování klienta, a odmítnout pokus o ověření, pokud se vazby kanálu neshodují.</span><span class="sxs-lookup"><span data-stu-id="d49b4-121">Updated servers which are properly configured may verify the channel and service binding information when it is present in the client authentication token and reject the authentication attempt if the channel bindings do not match.</span></span> <span data-ttu-id="d49b4-122">V závislosti na scénáři nasazení mohou servery ověřit vazbu kanálu, vazbu služby nebo obojí.</span><span class="sxs-lookup"><span data-stu-id="d49b4-122">Depending on the deployment scenario, servers may verify channel binding, service binding or both.</span></span>  
  
3. <span data-ttu-id="d49b4-123">Aktualizované servery mají možnost přijímat nebo zamítat požadavky klientů nižší úrovně, které neobsahují informace o vazbě kanálu založené na zásadách.</span><span class="sxs-lookup"><span data-stu-id="d49b4-123">Updated servers have the ability to accept or reject down-level client requests that do not contain the channel binding information based on policy.</span></span>  
  
 <span data-ttu-id="d49b4-124">Informace používané rozšířenou ochranou se skládají z jedné nebo obou následujících částí:</span><span class="sxs-lookup"><span data-stu-id="d49b4-124">Information used by extended protection consists of one or both of the following two parts:</span></span>  
  
1. <span data-ttu-id="d49b4-125">Token vazby kanálu nebo CBT.</span><span class="sxs-lookup"><span data-stu-id="d49b4-125">A Channel Binding Token or CBT.</span></span>  
  
2. <span data-ttu-id="d49b4-126">Informace o vazbě služby ve formě hlavního názvu služby nebo hlavního názvu služby.</span><span class="sxs-lookup"><span data-stu-id="d49b4-126">Service Binding information in the form of a Service Principal Name or SPN.</span></span>  
  
 <span data-ttu-id="d49b4-127">Informace o vazbě služby je známkou záměru klienta ověřit konkrétní koncový bod služby.</span><span class="sxs-lookup"><span data-stu-id="d49b4-127">Service Binding information is an indication of a client’s intent to authenticate to a particular service endpoint.</span></span> <span data-ttu-id="d49b4-128">Je komunikován z klienta na server s následujícími vlastnostmi:</span><span class="sxs-lookup"><span data-stu-id="d49b4-128">It is communicated from client to server with the following properties:</span></span>  
  
- <span data-ttu-id="d49b4-129">Hodnota spn musí být k dispozici serveru provádějícímu ověřování klienta ve formě prostého textu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-129">The SPN value must be available to the server performing client authentication in clear text form.</span></span>  
  
- <span data-ttu-id="d49b4-130">Hodnota hlavního spn je veřejná.</span><span class="sxs-lookup"><span data-stu-id="d49b4-130">The value of the SPN is public.</span></span>  
  
- <span data-ttu-id="d49b4-131">Hlavní aktualizace služeb při obslužné hodnotě musí být při přenosu kryptograficky chráněna tak, aby útok prostředníkem nemohl vložit, odebrat nebo změnit jeho hodnotu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-131">The SPN must be cryptographically protected in transit such that a man-in-the-middle attack cannot insert, remove or modify its value.</span></span>  
  
 <span data-ttu-id="d49b4-132">CBT je vlastnost vnější zabezpečený kanál (například TLS) slouží k vazbě (vázat) ji konverzační konverzace přes vnitřní, klient ověřený kanál.</span><span class="sxs-lookup"><span data-stu-id="d49b4-132">A CBT is a property of the outer secure channel (such as TLS) used to tie (bind) it to a conversation over an inner, client-authenticated channel.</span></span> <span data-ttu-id="d49b4-133">CBT musí mít následující vlastnosti (také definované IETF RFC 5056):</span><span class="sxs-lookup"><span data-stu-id="d49b4-133">The CBT must have the following properties (also defined by IETF RFC 5056):</span></span>  
  
- <span data-ttu-id="d49b4-134">Pokud existuje vnější kanál, hodnota CBT musí být vlastnost identifikující vnější kanál nebo koncový bod serveru, nezávisle přijatá klientem i serverem na straně konverzace.</span><span class="sxs-lookup"><span data-stu-id="d49b4-134">When an outer channel exists, the value of the CBT must be a property identifying either the outer channel or the server endpoint, independently arrived at by both client and server sides of a conversation.</span></span>  
  
- <span data-ttu-id="d49b4-135">Hodnota CBT odeslané klientem nesmí být něco, co útočník může ovlivnit.</span><span class="sxs-lookup"><span data-stu-id="d49b4-135">Value of the CBT sent by the client must not be something an attacker can influence.</span></span>  
  
- <span data-ttu-id="d49b4-136">Nejsou žádné záruky týkající se utajení hodnoty CBT.</span><span class="sxs-lookup"><span data-stu-id="d49b4-136">No guarantees are made about secrecy of the CBT value.</span></span> <span data-ttu-id="d49b4-137">To však neznamená, že hodnota vazby služby, jakož i informace o vazbě kanálu mohou být vždy zkontrolovány jiným, ale server provádějící ověřování, protože protokol nesoucí CBT může být šifrování.</span><span class="sxs-lookup"><span data-stu-id="d49b4-137">This does not however mean that the value of the service binding as well as channel binding information can always be examined by any other but the server performing authentication, as the protocol carrying the CBT may be encrypting it.</span></span>  
  
- <span data-ttu-id="d49b4-138">CBT musí být kryptograficky integrity chráněné při přenosu tak, aby útočník nemůže vložit, odebrat nebo změnit jeho hodnotu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-138">The CBT must be cryptographically integrity protected in transit such that an attacker cannot insert, remove or modify its value.</span></span>  
  
 <span data-ttu-id="d49b4-139">Vazba kanálu je dosaženo klientem přenosu SPN a CBT na server způsobem, který je odolný proti manipulaci.</span><span class="sxs-lookup"><span data-stu-id="d49b4-139">Channel binding is accomplished by the client transferring the SPN and the CBT to the server in a tamperproof fashion.</span></span> <span data-ttu-id="d49b4-140">Server ověří informace o vazbě kanálu v souladu se svými zásadami a odmítne pokusy o ověření, pro které se nedomnívá, že byl zamýšleným cílem.</span><span class="sxs-lookup"><span data-stu-id="d49b4-140">The server validates the channel binding information in accordance with its policy and rejects authentication attempts for which it does not believe itself to have been the intended target.</span></span> <span data-ttu-id="d49b4-141">Tímto způsobem se dva kanály stanou kryptograficky svázané dohromady.</span><span class="sxs-lookup"><span data-stu-id="d49b4-141">This way, the two channels become cryptographically bound together.</span></span>  
  
 <span data-ttu-id="d49b4-142">Chcete-li zachovat kompatibilitu s existujícími klienty a aplikacemi, může být server nakonfigurován tak, aby umožňoval pokusy o ověření klienty, kteří dosud nepodporují rozšířenou ochranu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-142">To preserve compatibility with existing clients and applications, a server may be configured to allow authentication attempts by clients that do not yet support extended protection.</span></span> <span data-ttu-id="d49b4-143">To se označuje jako "částečně tvrzené" konfigurace, na rozdíl od "plně tvrzené" konfigurace.</span><span class="sxs-lookup"><span data-stu-id="d49b4-143">This is referred to as a "partially hardened" configuration, in contrast to a "fully hardened" configuration.</span></span>  
  
 <span data-ttu-id="d49b4-144">Více součástí v <xref:System.Net> <xref:System.Net.Security> oborech názvů a provádění integrovaného ověřování systému Windows jménem volající aplikace.</span><span class="sxs-lookup"><span data-stu-id="d49b4-144">Multiple components in the <xref:System.Net> and <xref:System.Net.Security> namespaces perform integrated Windows authentication on behalf of a calling application.</span></span> <span data-ttu-id="d49b4-145">Tato část popisuje změny System.Net součástí pro přidání rozšířené ochrany při používání integrovaného ověřování systému Windows.</span><span class="sxs-lookup"><span data-stu-id="d49b4-145">This section describes changes to System.Net components to add extended protection in their use of integrated Windows authentication.</span></span>  
  
 <span data-ttu-id="d49b4-146">Rozšířená ochrana je v současné době podporována v systému Windows 7.</span><span class="sxs-lookup"><span data-stu-id="d49b4-146">Extended protection is currently supported on Windows 7.</span></span> <span data-ttu-id="d49b4-147">Mechanismus je k dispozici tak aplikace můžete určit, zda operační systém podporuje rozšířenou ochranu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-147">A mechanism is provided so an application can determine if the operating system supports extended protection.</span></span>  
  
## <a name="changes-to-support-extended-protection"></a><span data-ttu-id="d49b4-148">Změny rozšířené ochrany podpory</span><span class="sxs-lookup"><span data-stu-id="d49b4-148">Changes to Support Extended Protection</span></span>  
 <span data-ttu-id="d49b4-149">Proces ověřování používaný s integrovaným ověřováním systému Windows v závislosti na použitém ověřovacím protokolu často zahrnuje výzvu vydanou cílovým počítačem a odeslanou zpět do klientského počítače.</span><span class="sxs-lookup"><span data-stu-id="d49b4-149">The authentication process used with integrated Windows authentication, depending on the authentication protocol used, often includes a challenge issued by the destination computer and sent back to the client computer.</span></span> <span data-ttu-id="d49b4-150">Rozšířená ochrana přidává do tohoto procesu ověřování nové funkce.</span><span class="sxs-lookup"><span data-stu-id="d49b4-150">Extended protection adds new features to this authentication process</span></span>  
  
 <span data-ttu-id="d49b4-151">Obor <xref:System.Security.Authentication.ExtendedProtection> názvů poskytuje podporu pro ověřování pomocí rozšířené ochrany aplikací.</span><span class="sxs-lookup"><span data-stu-id="d49b4-151">The <xref:System.Security.Authentication.ExtendedProtection> namespace provides support for authentication using extended protection for applications.</span></span> <span data-ttu-id="d49b4-152">Třída <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> v tomto oboru názvů představuje vazbu kanálu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-152">The <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> class in this namespace represents a channel binding.</span></span> <span data-ttu-id="d49b4-153">Třída <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> v tomto oboru názvů představuje rozšířené zásady ochrany používané serverem k ověření příchozích klientských připojení.</span><span class="sxs-lookup"><span data-stu-id="d49b4-153">The <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> class in this namespace represents the extended protection policy used by the server to validate incoming client connections.</span></span> <span data-ttu-id="d49b4-154">Ostatní členové třídy se používají s rozšířenou ochranou.</span><span class="sxs-lookup"><span data-stu-id="d49b4-154">Other class members are used with extended protection.</span></span>  
  
 <span data-ttu-id="d49b4-155">Pro serverové aplikace tyto třídy zahrnují následující:</span><span class="sxs-lookup"><span data-stu-id="d49b4-155">For server applications, these classes include the following:</span></span>  
  
 <span data-ttu-id="d49b4-156">A, <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> který má následující prvky:</span><span class="sxs-lookup"><span data-stu-id="d49b4-156">A <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> that has the following elements:</span></span>  
  
- <span data-ttu-id="d49b4-157">Vlastnost, <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy.OSSupportsExtendedProtection%2A> která označuje, zda operační systém podporuje integrované ověřování systému Windows s rozšířenou ochranou.</span><span class="sxs-lookup"><span data-stu-id="d49b4-157">An <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy.OSSupportsExtendedProtection%2A> property that indicates whether the operating system supports integrated windows authentication with extended protection.</span></span>  
  
- <span data-ttu-id="d49b4-158">Hodnota, <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> která označuje, kdy by měly být vynuceny zásady rozšířené ochrany.</span><span class="sxs-lookup"><span data-stu-id="d49b4-158">A <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> value that indicates when the extended protection policy should be enforced.</span></span>  
  
- <span data-ttu-id="d49b4-159">Hodnota, <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> která označuje scénář nasazení.</span><span class="sxs-lookup"><span data-stu-id="d49b4-159">A <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> value that indicates the deployment scenario.</span></span> <span data-ttu-id="d49b4-160">To má vliv na kontrolu rozšířené ochrany.</span><span class="sxs-lookup"><span data-stu-id="d49b4-160">This influences how extended protection is checked.</span></span>  
  
- <span data-ttu-id="d49b4-161">Volitelné, <xref:System.Security.Authentication.ExtendedProtection.ServiceNameCollection> který obsahuje vlastní seznam spn, který se používá k porovnání s hlavní název služby poskytované klientem jako zamýšlený cíl ověřování.</span><span class="sxs-lookup"><span data-stu-id="d49b4-161">An optional <xref:System.Security.Authentication.ExtendedProtection.ServiceNameCollection> that contains the custom SPN list that is used to match against the SPN provided by the client as the intended target of the authentication.</span></span>  
  
- <span data-ttu-id="d49b4-162">Volitelné, <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> který obsahuje vlastní kanál vazby pro ověření.</span><span class="sxs-lookup"><span data-stu-id="d49b4-162">An optional <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> that contains a custom channel binding to use for validation.</span></span> <span data-ttu-id="d49b4-163">Tento scénář není běžným případem</span><span class="sxs-lookup"><span data-stu-id="d49b4-163">This scenario is not a common case</span></span>  
  
 <span data-ttu-id="d49b4-164">Obor <xref:System.Security.Authentication.ExtendedProtection.Configuration> názvů poskytuje podporu pro konfiguraci ověřování pomocí rozšířené ochrany aplikací.</span><span class="sxs-lookup"><span data-stu-id="d49b4-164">The <xref:System.Security.Authentication.ExtendedProtection.Configuration> namespace provides support for configuration of authentication using extended protection for applications.</span></span>  
  
 <span data-ttu-id="d49b4-165">Byla provedena řada změn funkcí, které podporují <xref:System.Net> rozšířenou ochranu v existujícím oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="d49b4-165">A number of feature changes were made to support extended protection in the existing <xref:System.Net> namespace.</span></span> <span data-ttu-id="d49b4-166">Mezi tyto změny patří následující:</span><span class="sxs-lookup"><span data-stu-id="d49b4-166">These changes include the following:</span></span>  
  
- <span data-ttu-id="d49b4-167">Nová <xref:System.Net.TransportContext> třída přidána <xref:System.Net> do oboru názvů, který představuje kontext přenosu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-167">A new <xref:System.Net.TransportContext> class added to the <xref:System.Net> namespace that represents a transport context.</span></span>  
  
- <span data-ttu-id="d49b4-168">Nové <xref:System.Net.HttpWebRequest.EndGetRequestStream%2A> <xref:System.Net.HttpWebRequest.GetRequestStream%2A> a přetížení <xref:System.Net.HttpWebRequest> metody ve třídě, <xref:System.Net.TransportContext> které umožňují načítání pro podporu rozšířené ochrany pro klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="d49b4-168">New <xref:System.Net.HttpWebRequest.EndGetRequestStream%2A> and <xref:System.Net.HttpWebRequest.GetRequestStream%2A> overload methods in the <xref:System.Net.HttpWebRequest> class that allow retrieving the <xref:System.Net.TransportContext> to support extended protection for client applications.</span></span>  
  
- <span data-ttu-id="d49b4-169">Dodatky <xref:System.Net.HttpListener> k <xref:System.Net.HttpListenerRequest> a třídy pro podporu serverových aplikací.</span><span class="sxs-lookup"><span data-stu-id="d49b4-169">Additions to the <xref:System.Net.HttpListener> and <xref:System.Net.HttpListenerRequest> classes to support server applications.</span></span>  
  
 <span data-ttu-id="d49b4-170">Byla provedena změna funkce pro podporu rozšířené ochrany klientských <xref:System.Net.Mail> aplikací SMTP v existujícím oboru názvů:</span><span class="sxs-lookup"><span data-stu-id="d49b4-170">A feature change was made to support extended protection for SMTP client applications in the existing <xref:System.Net.Mail> namespace:</span></span>  
  
- <span data-ttu-id="d49b4-171">Vlastnost <xref:System.Net.Mail.SmtpClient.TargetName%2A> ve <xref:System.Net.Mail.SmtpClient> třídě, která představuje název SPN pro ověřování při použití rozšířené ochrany pro klientské aplikace SMTP.</span><span class="sxs-lookup"><span data-stu-id="d49b4-171">A <xref:System.Net.Mail.SmtpClient.TargetName%2A> property in the <xref:System.Net.Mail.SmtpClient> class that represents the SPN to use for authentication when using extended protection for SMTP client applications.</span></span>  
  
 <span data-ttu-id="d49b4-172">Byla provedena řada změn funkcí, které podporují <xref:System.Net.Security> rozšířenou ochranu v existujícím oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="d49b4-172">A number of feature changes were made to support extended protection in the existing <xref:System.Net.Security> namespace.</span></span> <span data-ttu-id="d49b4-173">Mezi tyto změny patří následující:</span><span class="sxs-lookup"><span data-stu-id="d49b4-173">These changes include the following:</span></span>  
  
- <span data-ttu-id="d49b4-174">Nové <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsClient%2A> <xref:System.Net.Security.NegotiateStream.AuthenticateAsClient%2A> a přetížení <xref:System.Net.Security.NegotiateStream> metody ve třídě, které umožňují předávání CBT pro podporu rozšířené ochrany pro klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="d49b4-174">New <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsClient%2A> and <xref:System.Net.Security.NegotiateStream.AuthenticateAsClient%2A> overload methods in the <xref:System.Net.Security.NegotiateStream> class that allow passing a CBT to support extended protection for client applications.</span></span>  
  
- <span data-ttu-id="d49b4-175">Nové <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsServer%2A> <xref:System.Net.Security.NegotiateStream.AuthenticateAsServer%2A> a přetížení <xref:System.Net.Security.NegotiateStream> metody ve třídě, které umožňují předávání <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> pro podporu rozšířené ochrany pro serverové aplikace.</span><span class="sxs-lookup"><span data-stu-id="d49b4-175">New <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsServer%2A> and <xref:System.Net.Security.NegotiateStream.AuthenticateAsServer%2A> overload methods in the <xref:System.Net.Security.NegotiateStream> class that allow passing an <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> to support extended protection for server applications.</span></span>  
  
- <span data-ttu-id="d49b4-176">Nová <xref:System.Net.Security.SslStream.TransportContext%2A> vlastnost ve <xref:System.Net.Security.SslStream> třídě pro podporu rozšířené ochrany klientských a serverových aplikací.</span><span class="sxs-lookup"><span data-stu-id="d49b4-176">A new <xref:System.Net.Security.SslStream.TransportContext%2A> property in the <xref:System.Net.Security.SslStream> class to support extended protection for client and server applications.</span></span>  
  
 <span data-ttu-id="d49b4-177">Byla <xref:System.Net.Configuration.SmtpNetworkElement> přidána vlastnost pro podporu konfigurace rozšířené ochrany klientů <xref:System.Net.Security> SMTP v oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="d49b4-177">A <xref:System.Net.Configuration.SmtpNetworkElement> property was added to support configuration of extended protection for SMTP clients in the <xref:System.Net.Security> namespace.</span></span>  
  
## <a name="extended-protection-for-client-applications"></a><span data-ttu-id="d49b4-178">Rozšířená ochrana klientských aplikací</span><span class="sxs-lookup"><span data-stu-id="d49b4-178">Extended Protection for Client Applications</span></span>  
 <span data-ttu-id="d49b4-179">Rozšířená podpora ochrany pro většinu klientských aplikací probíhá automaticky.</span><span class="sxs-lookup"><span data-stu-id="d49b4-179">Extended protection support for most client applications happens automatically.</span></span> <span data-ttu-id="d49b4-180"><xref:System.Net.HttpWebRequest> Třídy <xref:System.Net.Mail.SmtpClient> a podporují rozšířenou ochranu vždy, když základní verze systému Windows podporuje rozšířenou ochranu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-180">The <xref:System.Net.HttpWebRequest> and <xref:System.Net.Mail.SmtpClient> classes support extended protection whenever the underlying version of Windows supports extended protection.</span></span> <span data-ttu-id="d49b4-181">Instance <xref:System.Net.HttpWebRequest> odešle hlavní název služby <xref:System.Uri>vytvořený z .</span><span class="sxs-lookup"><span data-stu-id="d49b4-181">An <xref:System.Net.HttpWebRequest> instance sends an SPN constructed from the <xref:System.Uri>.</span></span> <span data-ttu-id="d49b4-182">Ve výchozím <xref:System.Net.Mail.SmtpClient> nastavení instance odešle název SPN vytvořený z názvu hostitele poštovního serveru SMTP.</span><span class="sxs-lookup"><span data-stu-id="d49b4-182">By default, an <xref:System.Net.Mail.SmtpClient> instance sends an SPN constructed from the host name of the SMTP mail server.</span></span>  
  
 <span data-ttu-id="d49b4-183">Pro vlastní ověřování mohou klientské <xref:System.Net.HttpWebRequest.GetRequestStream%28System.Net.TransportContext%40%29?displayProperty=nameWithType> aplikace <xref:System.Net.HttpWebRequest> použít metody <xref:System.Net.HttpWebRequest.EndGetRequestStream%28System.IAsyncResult%2CSystem.Net.TransportContext%40%29?displayProperty=nameWithType> or <xref:System.Net.TransportContext> ve třídě, které <xref:System.Net.TransportContext.GetChannelBinding%2A> umožňují načítání a CBT pomocí metody.</span><span class="sxs-lookup"><span data-stu-id="d49b4-183">For custom authentication, client applications can use the <xref:System.Net.HttpWebRequest.EndGetRequestStream%28System.IAsyncResult%2CSystem.Net.TransportContext%40%29?displayProperty=nameWithType> or <xref:System.Net.HttpWebRequest.GetRequestStream%28System.Net.TransportContext%40%29?displayProperty=nameWithType> methods in the <xref:System.Net.HttpWebRequest> class that allow retrieving the <xref:System.Net.TransportContext> and the CBT using the <xref:System.Net.TransportContext.GetChannelBinding%2A> method.</span></span>  
  
 <span data-ttu-id="d49b4-184">Název SPN, který se má <xref:System.Net.HttpWebRequest> použít pro integrované ověřování systému Windows <xref:System.Net.AuthenticationManager.CustomTargetNameDictionary%2A> odeslané instancí dané službě, lze přemluvit nastavením vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="d49b4-184">The SPN to use for integrated Windows authentication sent by an <xref:System.Net.HttpWebRequest> instance to a given service can be overridden by setting the <xref:System.Net.AuthenticationManager.CustomTargetNameDictionary%2A> property.</span></span>  
  
 <span data-ttu-id="d49b4-185">Vlastnost <xref:System.Net.Mail.SmtpClient.TargetName%2A> lze nastavit vlastní hlavní název služby pro použití pro integrované ověřování systému Windows pro připojení SMTP.</span><span class="sxs-lookup"><span data-stu-id="d49b4-185">The <xref:System.Net.Mail.SmtpClient.TargetName%2A> property can be used to set a custom SPN to use for integrated Windows authentication for the SMTP connection.</span></span>  
  
## <a name="extended-protection-for-server-applications"></a><span data-ttu-id="d49b4-186">Rozšířená ochrana serverových aplikací</span><span class="sxs-lookup"><span data-stu-id="d49b4-186">Extended Protection for Server Applications</span></span>  
 <span data-ttu-id="d49b4-187"><xref:System.Net.HttpListener>automaticky poskytuje mechanismy pro ověřování vazeb služby při ověřování HTTP.</span><span class="sxs-lookup"><span data-stu-id="d49b4-187"><xref:System.Net.HttpListener> automatically provides mechanisms for validating service bindings when performing HTTP authentication.</span></span>  
  
 <span data-ttu-id="d49b4-188">Nejbezpečnější scénář je povolit rozšířenou ochranu pro HTTPS:// předpony.</span><span class="sxs-lookup"><span data-stu-id="d49b4-188">The most secure scenario is to enable extended protection for HTTPS:// prefixes.</span></span> <span data-ttu-id="d49b4-189">V tomto případě <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> nastavte <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> na <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> s <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>nastavenou <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected> na nebo <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> <xref:System.Net.HttpListener> , a <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> nastavte hodnotu A vloží v částečně tvrzené režimu, zatímco odpovídá plně tvrzené režimu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-189">In this case, set <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> to an <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> with <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> set to <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> or <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>, and <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> set to <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected> A value of  <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> puts <xref:System.Net.HttpListener> in partially hardened mode, while <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> corresponds to fully hardened mode.</span></span>  
  
 <span data-ttu-id="d49b4-190">V této konfiguraci při požadavku na server prostřednictvím vnějšího zabezpečeného kanálu je vnější kanál dotazován na vazbu kanálu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-190">In this configuration when a request is made to the server through an outer secure channel, the outer channel is queried for a channel binding.</span></span> <span data-ttu-id="d49b4-191">Tato vazba kanálu je předána volání ověřování SSPI, která ověřují, že vazba kanálu v objektu blob ověřování odpovídá.</span><span class="sxs-lookup"><span data-stu-id="d49b4-191">This channel binding is passed to the authentication SSPI calls, which validate that the channel binding in the authentication blob matches.</span></span> <span data-ttu-id="d49b4-192">Existují tři možné výsledky:</span><span class="sxs-lookup"><span data-stu-id="d49b4-192">There are three possible outcomes:</span></span>  
  
1. <span data-ttu-id="d49b4-193">Základní operační systém serveru nepodporuje rozšířenou ochranu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-193">The server’s underlying operating system does not support extended protection.</span></span> <span data-ttu-id="d49b4-194">Požadavek nebude vystaven aplikaci a neoprávněná odpověď (401) bude vrácena klientovi.</span><span class="sxs-lookup"><span data-stu-id="d49b4-194">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="d49b4-195">Zpráva bude zaznamenána do <xref:System.Net.HttpListener> zdroje trasování určující důvod selhání.</span><span class="sxs-lookup"><span data-stu-id="d49b4-195">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
2. <span data-ttu-id="d49b4-196">Volání SSPI se nezdaří označující, že klient zadal vazbu kanálu, která neodpovídá očekávané hodnotě načtené z vnějšího kanálu, <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>nebo klientnepodařilo zadat vazbu kanálu, když byla nakonfigurována rozšířená zásada ochrany na serveru .</span><span class="sxs-lookup"><span data-stu-id="d49b4-196">The SSPI call fails indicating that either the client specified a channel binding that did not match the expected value retrieved from the outer channel or the client failed to supply a channel binding when the extended protection policy on the server was configured for <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>.</span></span> <span data-ttu-id="d49b4-197">V obou případech nebude požadavek vystaven aplikaci a klientovi bude vrácena neoprávněná odpověď (401).</span><span class="sxs-lookup"><span data-stu-id="d49b4-197">In both cases, the request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="d49b4-198">Zpráva bude zaznamenána do <xref:System.Net.HttpListener> zdroje trasování určující důvod selhání.</span><span class="sxs-lookup"><span data-stu-id="d49b4-198">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
3. <span data-ttu-id="d49b4-199">Klient určuje správnou vazbu kanálu nebo je povoleno připojení bez zadání vazby kanálu, protože <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> rozšířené zásady ochrany na serveru jsou nakonfigurovány s Požadavek je vrácen do aplikace pro zpracování.</span><span class="sxs-lookup"><span data-stu-id="d49b4-199">The client specifies the correct channel binding or is allowed to connect without specifying a channel binding since the extended protection policy on the server is configured with <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> The request is returned to the application for processing.</span></span> <span data-ttu-id="d49b4-200">Kontrola názvu služby se neprovádí automaticky.</span><span class="sxs-lookup"><span data-stu-id="d49b4-200">No service name check is performed automatically.</span></span> <span data-ttu-id="d49b4-201">Aplikace se může rozhodnout provést vlastní <xref:System.Net.HttpListenerRequest.ServiceName%2A> ověření názvu služby pomocí vlastnosti, ale za těchto okolností je redundantní.</span><span class="sxs-lookup"><span data-stu-id="d49b4-201">An application may choose to perform its own service name validation using the <xref:System.Net.HttpListenerRequest.ServiceName%2A> property, but under these circumstances it is redundant.</span></span>  
  
 <span data-ttu-id="d49b4-202">Pokud aplikace provádí vlastní volání SSPI k provedení ověřování na základě objektů BLOB předaných tam a zpět v rámci těla požadavku HTTP <xref:System.Net.HttpListener> a chce podporovat vazbu kanálu, musí načíst očekávanou vazbu kanálu z vnějšího zabezpečeného kanálu pomocí k jeho předání nativní funkci [AcceptSecurityContext](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) aplikace Win32.</span><span class="sxs-lookup"><span data-stu-id="d49b4-202">If an application makes its own SSPI calls to perform authentication based on blobs passed back and forth within the body of an HTTP request and wishes to support channel binding, it needs to retrieve the expected channel binding from the outer secure channel using <xref:System.Net.HttpListener> in order to pass it to native Win32 [AcceptSecurityContext](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) function.</span></span> <span data-ttu-id="d49b4-203">Chcete-li to <xref:System.Net.HttpListenerRequest.TransportContext%2A> provést, <xref:System.Net.TransportContext.GetChannelBinding%2A> použijte vlastnost a metodu volání k načtení CBT.</span><span class="sxs-lookup"><span data-stu-id="d49b4-203">To do this, use the <xref:System.Net.HttpListenerRequest.TransportContext%2A> property and call <xref:System.Net.TransportContext.GetChannelBinding%2A> method to retrieve the CBT.</span></span> <span data-ttu-id="d49b4-204">Podporovány jsou pouze vazby koncového bodu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-204">Only endpoint bindings are supported.</span></span> <span data-ttu-id="d49b4-205">Pokud je <xref:System.Security.Authentication.ExtendedProtection.ChannelBindingKind.Endpoint> zadáno <xref:System.NotSupportedException> něco jiného, bude vyvolána.</span><span class="sxs-lookup"><span data-stu-id="d49b4-205">If anything other <xref:System.Security.Authentication.ExtendedProtection.ChannelBindingKind.Endpoint> is specified, a <xref:System.NotSupportedException> will be thrown.</span></span> <span data-ttu-id="d49b4-206">Pokud základní operační systém podporuje <xref:System.Net.TransportContext.GetChannelBinding%2A> vazbu kanálu, <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> <xref:System.Runtime.InteropServices.SafeHandle> metoda vrátí obtékání ukazatel na vazbu kanálu vhodné pro předávání [AcceptSecurityContext](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) funkce jako pvBuffer člen SecBuffer struktury předané v parametru. `pInput`</span><span class="sxs-lookup"><span data-stu-id="d49b4-206">If the underlying operating system supports channel binding, the <xref:System.Net.TransportContext.GetChannelBinding%2A> method will return a <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding><xref:System.Runtime.InteropServices.SafeHandle> wrapping a pointer to a channel binding suitable for passing to [AcceptSecurityContext](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) function as the pvBuffer member of a SecBuffer structure passed in the `pInput` parameter.</span></span> <span data-ttu-id="d49b4-207">Vlastnost <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding.Size%2A> obsahuje délku v bajtů vazby kanálu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-207">The <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding.Size%2A> property contains the length, in bytes, of the channel binding.</span></span> <span data-ttu-id="d49b4-208">Pokud základní operační systém nepodporuje vazby kanálu, `null`funkce vrátí .</span><span class="sxs-lookup"><span data-stu-id="d49b4-208">If the underlying operating system does not support channel bindings, the function will return `null`.</span></span>  
  
 <span data-ttu-id="d49b4-209">Dalším možným scénářem je povolení rozšířené ochrany pro HTTP:// předpony, pokud se nepoužívají proxy servery.</span><span class="sxs-lookup"><span data-stu-id="d49b4-209">Another possible scenario is to enable extended protection for HTTP:// prefixes when proxies are not used.</span></span> <span data-ttu-id="d49b4-210">V tomto případě <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> nastavte <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> na <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> s <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>nastavenou <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected> na nebo <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> <xref:System.Net.HttpListener> , a <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> nastavte hodnotu A vloží v částečně tvrzené režimu, zatímco odpovídá plně tvrzené režimu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-210">In this case, set <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> to an <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> with <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> set to <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> or <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>, and <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> set to <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected> A value of  <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> puts <xref:System.Net.HttpListener> in partially hardened mode, while <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> corresponds to fully hardened mode.</span></span>  
  
 <span data-ttu-id="d49b4-211">Výchozí seznam povolených názvů služeb je vytvořen na základě předpon, které byly zaregistrovány u <xref:System.Net.HttpListener>.</span><span class="sxs-lookup"><span data-stu-id="d49b4-211">A default list of allowed service names is created based on the prefixes which have been registered with the <xref:System.Net.HttpListener>.</span></span> <span data-ttu-id="d49b4-212">Tento výchozí seznam lze <xref:System.Net.HttpListener.DefaultServiceNames%2A> zkontrolovány prostřednictvím vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="d49b4-212">This default list can be examined through the <xref:System.Net.HttpListener.DefaultServiceNames%2A> property.</span></span> <span data-ttu-id="d49b4-213">Pokud tento seznam není vyčerpávající, aplikace můžete zadat vlastní kolekce názvů <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> služeb v konstruktoru pro třídu, která bude použita namísto výchozího seznamu názvů služeb.</span><span class="sxs-lookup"><span data-stu-id="d49b4-213">If this list is not comprehensive, an application can specify a custom service name collection in the constructor for the <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> class which will be used instead of the default service name list.</span></span>  
  
 <span data-ttu-id="d49b4-214">V této konfiguraci při požadavku na server bez vnější ho sazený kanál ověřování probíhá normálně bez kontroly vazby kanálu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-214">In this configuration, when a request is made to the server without an outer secure channel authentication proceeds normally without a channel binding check.</span></span> <span data-ttu-id="d49b4-215">Pokud je ověření úspěšné, kontext je dotazován na název služby, který klient poskytl a ověřil podle seznamu přijatelných názvů služeb.</span><span class="sxs-lookup"><span data-stu-id="d49b4-215">If the authentication succeeds, the context is queried for the service name that the client provided and validated against the list of acceptable service names.</span></span> <span data-ttu-id="d49b4-216">Existují čtyři možné výsledky:</span><span class="sxs-lookup"><span data-stu-id="d49b4-216">There are four possible outcomes:</span></span>  
  
1. <span data-ttu-id="d49b4-217">Základní operační systém serveru nepodporuje rozšířenou ochranu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-217">The server’s underlying operating system does not support extended protection.</span></span> <span data-ttu-id="d49b4-218">Požadavek nebude vystaven aplikaci a neoprávněná odpověď (401) bude vrácena klientovi.</span><span class="sxs-lookup"><span data-stu-id="d49b4-218">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="d49b4-219">Zpráva bude zaznamenána do <xref:System.Net.HttpListener> zdroje trasování určující důvod selhání.</span><span class="sxs-lookup"><span data-stu-id="d49b4-219">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
2. <span data-ttu-id="d49b4-220">Základní operační systém klienta nepodporuje rozšířenou ochranu.</span><span class="sxs-lookup"><span data-stu-id="d49b4-220">The client’s underlying operating system does not support extended protection.</span></span> <span data-ttu-id="d49b4-221">V <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> konfiguraci bude pokus o ověření úspěšný a požadavek bude vrácen do aplikace.</span><span class="sxs-lookup"><span data-stu-id="d49b4-221">In the <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> configuration, the authentication attempt will succeed and the request will be returned to the application.</span></span> <span data-ttu-id="d49b4-222">V <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> konfiguraci se pokus o ověření nezdaří.</span><span class="sxs-lookup"><span data-stu-id="d49b4-222">In the <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> configuration, the authentication attempt will fail.</span></span> <span data-ttu-id="d49b4-223">Požadavek nebude vystaven aplikaci a neoprávněná odpověď (401) bude vrácena klientovi.</span><span class="sxs-lookup"><span data-stu-id="d49b4-223">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="d49b4-224">Zpráva bude zaznamenána do <xref:System.Net.HttpListener> zdroje trasování určující důvod selhání.</span><span class="sxs-lookup"><span data-stu-id="d49b4-224">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
3. <span data-ttu-id="d49b4-225">Základní operační systém klienta podporuje rozšířenou ochranu, ale aplikace neurčila vazbu služby.</span><span class="sxs-lookup"><span data-stu-id="d49b4-225">The client’s underlying operating system supports extended protection, but the application did not specify a service binding.</span></span> <span data-ttu-id="d49b4-226">Požadavek nebude vystaven aplikaci a neoprávněná odpověď (401) bude vrácena klientovi.</span><span class="sxs-lookup"><span data-stu-id="d49b4-226">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="d49b4-227">Zpráva bude zaznamenána do <xref:System.Net.HttpListener> zdroje trasování určující důvod selhání.</span><span class="sxs-lookup"><span data-stu-id="d49b4-227">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
4. <span data-ttu-id="d49b4-228">Klient zadal vazbu služby.</span><span class="sxs-lookup"><span data-stu-id="d49b4-228">The client specified a service binding.</span></span> <span data-ttu-id="d49b4-229">Vazba služby je porovnána se seznamem povolených vazeb služby.</span><span class="sxs-lookup"><span data-stu-id="d49b4-229">The service binding is compared to the list of allowed service bindings.</span></span> <span data-ttu-id="d49b4-230">Pokud odpovídá, požadavek je vrácena do aplikace.</span><span class="sxs-lookup"><span data-stu-id="d49b4-230">If it matches, the request is returned to the application.</span></span> <span data-ttu-id="d49b4-231">V opačném případě nebude požadavek vystaven aplikaci a neoprávněná odpověď (401) bude automaticky vrácena klientovi.</span><span class="sxs-lookup"><span data-stu-id="d49b4-231">Otherwise, the request will not be exposed to the application, and an unauthorized (401) response will be automatically returned to the client.</span></span> <span data-ttu-id="d49b4-232">Zpráva bude zaznamenána do <xref:System.Net.HttpListener> zdroje trasování určující důvod selhání.</span><span class="sxs-lookup"><span data-stu-id="d49b4-232">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
 <span data-ttu-id="d49b4-233">Pokud tento jednoduchý přístup pomocí seznamu povolených názvů služeb je nedostatečná, aplikace může <xref:System.Net.HttpListenerRequest.ServiceName%2A> poskytnout vlastní název služby ověření dotazem na vlastnost.</span><span class="sxs-lookup"><span data-stu-id="d49b4-233">If this simple approach using an allowed list of acceptable service names is insufficient, an application may provide its own service name validation by querying the <xref:System.Net.HttpListenerRequest.ServiceName%2A> property.</span></span> <span data-ttu-id="d49b4-234">V případech 1 a 2 se `null`ubytování vrátí .</span><span class="sxs-lookup"><span data-stu-id="d49b4-234">In cases 1 and 2 above, the property will return `null`.</span></span> <span data-ttu-id="d49b4-235">V případě 3 vrátí prázdný řetězec.</span><span class="sxs-lookup"><span data-stu-id="d49b4-235">In case 3, it will return an empty string.</span></span> <span data-ttu-id="d49b4-236">V případě 4 bude vrácen název služby určený klientem.</span><span class="sxs-lookup"><span data-stu-id="d49b4-236">In case 4, the service name specified by the client will be returned.</span></span>  
  
 <span data-ttu-id="d49b4-237">Tyto rozšířené funkce ochrany mohou být také použity serverovými aplikacemi pro ověřování s jinými typy požadavků a při použití důvěryhodných proxy serverů.</span><span class="sxs-lookup"><span data-stu-id="d49b4-237">These extended protection features can also be used by server applications for authentication with other types of requests and when trusted proxies are used.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d49b4-238">Viz také</span><span class="sxs-lookup"><span data-stu-id="d49b4-238">See also</span></span>

- <xref:System.Security.Authentication.ExtendedProtection>
- <xref:System.Security.Authentication.ExtendedProtection.Configuration>
