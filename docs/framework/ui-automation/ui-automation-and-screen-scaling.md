---
title: Automatizace uživatelského rozhraní a změna velikosti obrazovky
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- scaling, screens
- screens, scaling
- UI (user interface), automation
- UI Automation
ms.assetid: 4380cad7-e509-448f-b9a5-6de042605fd4
ms.openlocfilehash: 2a68a74fa6aadcaba21f142d394a1f8a3d8af371
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/12/2020
ms.locfileid: "79179968"
---
# <a name="ui-automation-and-screen-scaling"></a><span data-ttu-id="f1188-102">Automatizace uživatelského rozhraní a změna velikosti obrazovky</span><span class="sxs-lookup"><span data-stu-id="f1188-102">UI Automation and Screen Scaling</span></span>
> [!NOTE]
> <span data-ttu-id="f1188-103">Tato dokumentace je určena pro vývojáře rozhraní [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] .NET Framework, kteří chtějí používat spravované třídy definované v oboru <xref:System.Windows.Automation> názvů.</span><span class="sxs-lookup"><span data-stu-id="f1188-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="f1188-104">Nejnovější informace o [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]rozhraní [WINDOWS Automation API: Automatizace uživatelského rozhraní](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="f1188-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>  
  
<span data-ttu-id="f1188-105">Počínaje systémem Windows Vista umožňuje systém Windows uživatelům změnit nastavení na palec (dpi) tak, aby většina prvků uživatelského rozhraní (UI) na obrazovce vypadala větší.</span><span class="sxs-lookup"><span data-stu-id="f1188-105">Starting with Windows Vista, Windows enables users to change the dots per inch (dpi) setting so that most user interface (UI) elements on the screen appear larger.</span></span> <span data-ttu-id="f1188-106">Ačkoli tato funkce je již dlouho k dispozici v systému Windows, v předchozích verzích škálování musely být implementovány aplikacemi.</span><span class="sxs-lookup"><span data-stu-id="f1188-106">Although this feature has long been available in Windows, in previous versions the scaling had to be implemented by applications.</span></span> <span data-ttu-id="f1188-107">Počínaje systémem Windows Vista provádí Správce oken plochy výchozí změnu měřítka pro všechny aplikace, které nezpracovávají vlastní měřítko.</span><span class="sxs-lookup"><span data-stu-id="f1188-107">Starting with Windows Vista, the Desktop Window Manager performs default scaling for all applications that do not handle their own scaling.</span></span> <span data-ttu-id="f1188-108">Klientské aplikace Automatizace uživatelského rozhraní musí tuto funkci zohlednit.</span><span class="sxs-lookup"><span data-stu-id="f1188-108">UI Automation client applications must take this feature into account.</span></span>  
  
<a name="Scaling_in_Windows_Vista"></a>
## <a name="scaling-in-windows-vista"></a><span data-ttu-id="f1188-109">Změna velikosti v systému Windows Vista</span><span class="sxs-lookup"><span data-stu-id="f1188-109">Scaling in Windows Vista</span></span>  
 <span data-ttu-id="f1188-110">Výchozí nastavení dpi je 96, což znamená, že 96 pixelů zabírá šířku nebo výšku jednoho pomyslného palce.</span><span class="sxs-lookup"><span data-stu-id="f1188-110">The default dpi setting is 96, which means that 96 pixels occupy a width or height of one notional inch.</span></span> <span data-ttu-id="f1188-111">Přesná míra "palce" závisí na velikosti a fyzickém rozlišení monitoru.</span><span class="sxs-lookup"><span data-stu-id="f1188-111">The exact measure of an "inch" depends on the size and physical resolution of the monitor.</span></span> <span data-ttu-id="f1188-112">Například na monitoru o šířce 12 palců při vodorovném rozlišení 1280 pixelů se vodorovná čára 96 pixelů rozprostírá přibližně 9/10 palce.</span><span class="sxs-lookup"><span data-stu-id="f1188-112">For example, on a monitor 12 inches wide, at a horizontal resolution of 1280 pixels, a horizontal line of 96 pixels extends about 9/10 of an inch.</span></span>  
  
 <span data-ttu-id="f1188-113">Změna nastavení dpi není stejná jako změna rozlišení obrazovky.</span><span class="sxs-lookup"><span data-stu-id="f1188-113">Changing the dpi setting is not the same as changing the screen resolution.</span></span> <span data-ttu-id="f1188-114">Při změně měřítka dpi zůstává počet fyzických pixelů na obrazovce stejný.</span><span class="sxs-lookup"><span data-stu-id="f1188-114">With dpi scaling, the number of physical pixels on the screen remains the same.</span></span> <span data-ttu-id="f1188-115">Změna měřítka se však použije [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] na velikost a umístění prvků.</span><span class="sxs-lookup"><span data-stu-id="f1188-115">However, scaling is applied to the size and location of [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements.</span></span> <span data-ttu-id="f1188-116">Toto škálování může provádět automaticky Správce oken plochy (DWM) pro plochu a pro aplikace, které explicitně nežádají, aby nebyly škálovány.</span><span class="sxs-lookup"><span data-stu-id="f1188-116">This scaling can be performed automatically by the Desktop Window Manager (DWM) for the desktop and for applications that do not explicitly ask not to be scaled.</span></span>  
  
 <span data-ttu-id="f1188-117">Ve skutečnosti, když uživatel nastaví faktor měřítka na 120 dpi, svislý nebo vodorovný palec na obrazovce se zvětší o 25 procent.</span><span class="sxs-lookup"><span data-stu-id="f1188-117">In effect, when the user sets the scale factor to 120 dpi, a vertical or horizontal inch on the screen becomes bigger by 25 percent.</span></span> <span data-ttu-id="f1188-118">Všechny rozměry jsou odpovídajícím způsobem změněny.</span><span class="sxs-lookup"><span data-stu-id="f1188-118">All dimensions are scaled accordingly.</span></span> <span data-ttu-id="f1188-119">Posun okna aplikace od horního a levého okraje obrazovky se zvýší o 25 procent.</span><span class="sxs-lookup"><span data-stu-id="f1188-119">The offset of an application window from the top and left edges of the screen increases by 25 percent.</span></span> <span data-ttu-id="f1188-120">Pokud je povoleno škálování aplikace a aplikace není dpi vědomi, velikost okna se zvětší ve stejném poměru, spolu s posuny a velikosti všech [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] prvků, které obsahuje.</span><span class="sxs-lookup"><span data-stu-id="f1188-120">If application scaling is enabled and the application is not dpi-aware, the size of the window increases in the same proportion, along with the offsets and sizes of all [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements it contains.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="f1188-121">Ve výchozím nastavení DWM neprovádí škálování pro aplikace, které nejsou vhodné pro dpi, když uživatel nastaví dpi na 120, ale provede jej, když je dpi nastavena na vlastní hodnotu 144 nebo vyšší.</span><span class="sxs-lookup"><span data-stu-id="f1188-121">By default, the DWM does not perform scaling for non-dpi-aware applications when the user sets the dpi to 120, but does perform it when the dpi is set to a custom value of 144 or higher.</span></span> <span data-ttu-id="f1188-122">Uživatel však může přepsat výchozí chování.</span><span class="sxs-lookup"><span data-stu-id="f1188-122">However, the user can override the default behavior.</span></span>  
  
 <span data-ttu-id="f1188-123">Škálování obrazovky vytváří nové výzvy pro aplikace, které se jakýmkoli způsobem týkají souřadnic obrazovky.</span><span class="sxs-lookup"><span data-stu-id="f1188-123">Screen scaling creates new challenges for applications that are concerned in any way with screen coordinates.</span></span> <span data-ttu-id="f1188-124">Obrazovka nyní obsahuje dva souřadné systémy: fyzické a logické.</span><span class="sxs-lookup"><span data-stu-id="f1188-124">The screen now contains two coordinate systems: physical and logical.</span></span> <span data-ttu-id="f1188-125">Fyzické souřadnice bodu jsou skutečné odsazení v obrazových bodech od levého horního rohu počátku.</span><span class="sxs-lookup"><span data-stu-id="f1188-125">The physical coordinates of a point are the actual offset in pixels from the top left of the origin.</span></span> <span data-ttu-id="f1188-126">Logické souřadnice jsou posuny, jako by byly, kdyby byly měřítko samotných obrazových bodů.</span><span class="sxs-lookup"><span data-stu-id="f1188-126">The logical coordinates are the offsets as they would be if the pixels themselves were scaled.</span></span>  
  
 <span data-ttu-id="f1188-127">Předpokládejme, že navrhnete dialogové okno s tlačítkem na souřadnicích (100, 48).</span><span class="sxs-lookup"><span data-stu-id="f1188-127">Suppose you design a dialog box with a button at coordinates (100, 48).</span></span> <span data-ttu-id="f1188-128">Pokud je toto dialogové okno zobrazeno ve výchozím 96 dpi, je tlačítko umístěno na fyzických souřadnicích (100, 48).</span><span class="sxs-lookup"><span data-stu-id="f1188-128">When this dialog box is displayed at the default 96 dpi, the button is located at physical coordinates of (100, 48).</span></span> <span data-ttu-id="f1188-129">Při 120 dpi se nachází na fyzických souřadnicích (125, 60).</span><span class="sxs-lookup"><span data-stu-id="f1188-129">At 120 dpi, it is located at physical coordinates of (125, 60).</span></span> <span data-ttu-id="f1188-130">Ale logické souřadnice jsou stejné v každém nastavení dpi: (100, 48).</span><span class="sxs-lookup"><span data-stu-id="f1188-130">But the logical coordinates are the same at any dpi setting: (100, 48).</span></span>  
  
 <span data-ttu-id="f1188-131">Logické souřadnice jsou důležité, protože chování operačního systému a aplikací konzistentní bez ohledu na nastavení dpi.</span><span class="sxs-lookup"><span data-stu-id="f1188-131">Logical coordinates are important, because they make the behavior of the operating system and applications consistent regardless of the dpi setting.</span></span> <span data-ttu-id="f1188-132">Například <xref:System.Windows.Forms.Cursor.Position%2A?displayProperty=nameWithType> obvykle vrátí logické souřadnice.</span><span class="sxs-lookup"><span data-stu-id="f1188-132">For example, <xref:System.Windows.Forms.Cursor.Position%2A?displayProperty=nameWithType> normally returns the logical coordinates.</span></span> <span data-ttu-id="f1188-133">Pokud přesunete kurzor nad prvek v dialogovém okně, budou vráceny stejné souřadnice bez ohledu na nastavení dpi.</span><span class="sxs-lookup"><span data-stu-id="f1188-133">If you move the cursor over an element in a dialog box, the same coordinates are returned regardless of the dpi setting.</span></span> <span data-ttu-id="f1188-134">Pokud nakreslíte ovládací prvek na (100, 100), je nakreslena na tyto logické souřadnice a bude zabírat stejnou relativní pozici v libovolném nastavení dpi.</span><span class="sxs-lookup"><span data-stu-id="f1188-134">If you draw a control at (100, 100), it is drawn to those logical coordinates, and will occupy the same relative position at any dpi setting.</span></span>  
  
<a name="Scaling_in_UI_Automation_Clients"></a>
## <a name="scaling-in-ui-automation-clients"></a><span data-ttu-id="f1188-135">Škálování v klientech automatizace uživatelského rozhraní</span><span class="sxs-lookup"><span data-stu-id="f1188-135">Scaling in UI Automation Clients</span></span>  
 <span data-ttu-id="f1188-136">Rozhraní [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] API nepoužívá logické souřadnice.</span><span class="sxs-lookup"><span data-stu-id="f1188-136">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] API does not use logical coordinates.</span></span> <span data-ttu-id="f1188-137">Následující metody a vlastnosti buď vrátit fyzické souřadnice nebo je považovat za parametry.</span><span class="sxs-lookup"><span data-stu-id="f1188-137">The following methods and properties either return physical coordinates or take them as parameters.</span></span>  
  
- <xref:System.Windows.Automation.AutomationElement.GetClickablePoint%2A>  
  
- <xref:System.Windows.Automation.AutomationElement.TryGetClickablePoint%2A>  
  
- <xref:System.Windows.Automation.AutomationElement.ClickablePointProperty>  
  
- <xref:System.Windows.Automation.AutomationElement.FromPoint%2A>  
  
- <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.BoundingRectangle%2A>  
  
 <span data-ttu-id="f1188-138">Ve výchozím nastavení klientská aplikace Automatizace uživatelského rozhraní spuštěná v prostředí s dpi s možností získat správné výsledky z těchto metod a vlastností.</span><span class="sxs-lookup"><span data-stu-id="f1188-138">By default, a UI Automation client application running in a non-96- dpi environment will not be able to obtain correct results from these methods and properties.</span></span> <span data-ttu-id="f1188-139">Například protože pozice kurzoru je v logické souřadnice, <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> klient nemůže jednoduše předat tyto souřadnice získat prvek, který je pod kurzorem.</span><span class="sxs-lookup"><span data-stu-id="f1188-139">For example, because the cursor position is in logical coordinates, the client cannot simply pass these coordinates to <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> to obtain the element that is under the cursor.</span></span> <span data-ttu-id="f1188-140">Kromě toho aplikace nebude moci správně umístit okna mimo svou klientskou oblast.</span><span class="sxs-lookup"><span data-stu-id="f1188-140">In addition, the application will not be able to correctly place windows outside its client area.</span></span>  
  
 <span data-ttu-id="f1188-141">Roztok je ve dvou částech.</span><span class="sxs-lookup"><span data-stu-id="f1188-141">The solution is in two parts.</span></span>  
  
1. <span data-ttu-id="f1188-142">Nejprve proveďte klientskou aplikaci dpi vědomi.</span><span class="sxs-lookup"><span data-stu-id="f1188-142">First, make the client application dpi-aware.</span></span> <span data-ttu-id="f1188-143">Chcete-li to provést, zavolejte funkci `SetProcessDPIAware` Win32 při spuštění.</span><span class="sxs-lookup"><span data-stu-id="f1188-143">To do this, call the Win32 function `SetProcessDPIAware` at startup.</span></span> <span data-ttu-id="f1188-144">Ve spravovaném kódu následující deklarace zpřístupňuje tuto funkci.</span><span class="sxs-lookup"><span data-stu-id="f1188-144">In managed code, the following declaration makes this function available.</span></span>  
  
     [!code-csharp[Highlighter#101](../../../samples/snippets/csharp/VS_Snippets_Wpf/Highlighter/CSharp/NativeMethods.cs#101)]
     [!code-vb[Highlighter#101](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/Highlighter/VisualBasic/NativeMethods.vb#101)]  
  
     <span data-ttu-id="f1188-145">Tato funkce umožňuje celý proces dpi vědomi, což znamená, že všechna okna, která patří do procesu jsou bez měřítka.</span><span class="sxs-lookup"><span data-stu-id="f1188-145">This function makes the entire process dpi-aware, meaning that all windows that belong to the process are unscaled.</span></span> <span data-ttu-id="f1188-146">V [ukázkové masce zvýrazňovače](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/Highlighter)jsou například čtyři okna, která tvoří obdélník zvýraznění, umístěna na fyzických souřadnicích získaných z automatizace uživatelského rozhraní, nikoli na logických souřadnicích.</span><span class="sxs-lookup"><span data-stu-id="f1188-146">In the [Highlighter Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/Highlighter), for instance, the four windows that make up the highlight rectangle are located at the physical coordinates obtained from UI Automation, not the logical coordinates.</span></span> <span data-ttu-id="f1188-147">Pokud ukázka nebyla dpi vědomi, zvýraznění by být vykreslen na logické souřadnice na ploše, což by mělo za následek nesprávné umístění v prostředí bez 96 dpi.</span><span class="sxs-lookup"><span data-stu-id="f1188-147">If the sample were not dpi-aware, the highlight would be drawn at the logical coordinates on the desktop, which would result in incorrect placement in a non-96- dpi environment.</span></span>  
  
2. <span data-ttu-id="f1188-148">Chcete-li získat souřadnice kurzoru, zavolejte funkci `GetPhysicalCursorPos`Win32 .</span><span class="sxs-lookup"><span data-stu-id="f1188-148">To get cursor coordinates, call the Win32 function `GetPhysicalCursorPos`.</span></span> <span data-ttu-id="f1188-149">Následující příklad ukazuje, jak deklarovat a používat tuto funkci.</span><span class="sxs-lookup"><span data-stu-id="f1188-149">The following example shows how to declare and use this function.</span></span>  
  
     [!code-csharp[UIAClient_snip#185](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAClient_snip/CSharp/ClientForm.cs#185)]
     [!code-vb[UIAClient_snip#185](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAClient_snip/VisualBasic/ClientForm.vb#185)]  
  
> [!CAUTION]
> <span data-ttu-id="f1188-150">Nepoužívejte <xref:System.Windows.Forms.Cursor.Position%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="f1188-150">Do not use <xref:System.Windows.Forms.Cursor.Position%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="f1188-151">Chování této vlastnosti mimo okna klienta v prostředí s měřítkem není definováno.</span><span class="sxs-lookup"><span data-stu-id="f1188-151">The behavior of this property outside client windows in a scaled environment is undefined.</span></span>  
  
 <span data-ttu-id="f1188-152">Pokud aplikace provádí přímou meziprocesovou komunikaci s aplikacemi, které nejsou uvědoměly dpi, můžete `PhysicalToLogicalPoint` provést `LogicalToPhysicalPoint`převod mezi logickými a fyzickými souřadnicemi pomocí funkcí Win32 a .</span><span class="sxs-lookup"><span data-stu-id="f1188-152">If your application performs direct cross-process communication with non- dpi-aware applications, you may have convert between logical and physical coordinates by using the Win32 functions `PhysicalToLogicalPoint` and `LogicalToPhysicalPoint`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f1188-153">Viz také</span><span class="sxs-lookup"><span data-stu-id="f1188-153">See also</span></span>

- [<span data-ttu-id="f1188-154">Ukázka zvýrazňovače</span><span class="sxs-lookup"><span data-stu-id="f1188-154">Highlighter Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/Highlighter)
