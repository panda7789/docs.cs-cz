---
title: Implementace zprostředkovatele automatizace uživatelského rozhraní na straně serveru
description: Pochopte, jak implementovat zprostředkovatele automatizace uživatelského rozhraní na straně serveru pro vlastní ovládací prvek v rozhraní .NET. Implementace pro WPF a non-WPF elementy se liší.
ms.date: 03/30/2017
helpviewer_keywords:
- server-side UI Automation provider implementation
- UI Automation, server-side provider implementation
- provider implementation, UI Automation
ms.assetid: 6acc6d08-bd67-4e2e-915c-9c1d34eb86fe
ms.openlocfilehash: ea1b5e668e29d854233d4dde4c0e6152d591da97
ms.sourcegitcommit: 3824ff187947572b274b9715b60c11269335c181
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/17/2020
ms.locfileid: "84903893"
---
# <a name="server-side-ui-automation-provider-implementation"></a><span data-ttu-id="3ca63-104">Implementace zprostředkovatele automatizace uživatelského rozhraní na straně serveru</span><span class="sxs-lookup"><span data-stu-id="3ca63-104">Server-Side UI Automation Provider Implementation</span></span>

> [!NOTE]
> <span data-ttu-id="3ca63-105">Tato dokumentace je určena pro .NET Framework vývojářů, kteří chtějí používat spravované [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] třídy definované v <xref:System.Windows.Automation> oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="3ca63-105">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="3ca63-106">Nejnovější informace o najdete [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] v tématu [rozhraní API služby Windows Automation: automatizace uživatelského rozhraní](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="3ca63-106">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>

<span data-ttu-id="3ca63-107">Tato část popisuje, jak implementovat zprostředkovatele automatizace uživatelského rozhraní na straně serveru pro vlastní ovládací prvek.</span><span class="sxs-lookup"><span data-stu-id="3ca63-107">This section describes how to implement a server-side UI Automation provider for a custom control.</span></span>

<span data-ttu-id="3ca63-108">Implementace pro prvky Windows Presentation Foundation (WPF) a non-WPF elementy (například ty, které jsou navrženy pro model Windows Forms), jsou zásadním rozdílem.</span><span class="sxs-lookup"><span data-stu-id="3ca63-108">The implementation for Windows Presentation Foundation (WPF) elements and non-WPF elements (such as those designed for Windows Forms) is fundamentally different.</span></span> <span data-ttu-id="3ca63-109">Prvky WPF poskytují podporu pro [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] třídu odvozenou z <xref:System.Windows.Automation.Peers.AutomationPeer> .</span><span class="sxs-lookup"><span data-stu-id="3ca63-109">WPF elements provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] through a class derived from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span> <span data-ttu-id="3ca63-110">Prvky jiného typu než WPF poskytují podporu prostřednictvím implementací rozhraní poskytovatele.</span><span class="sxs-lookup"><span data-stu-id="3ca63-110">Non-WPF elements provide support through implementations of provider interfaces.</span></span>

<a name="Security_Considerations"></a>

## <a name="security-considerations"></a><span data-ttu-id="3ca63-111">Aspekty zabezpečení</span><span class="sxs-lookup"><span data-stu-id="3ca63-111">Security Considerations</span></span>

<span data-ttu-id="3ca63-112">Poskytovatelé by měli být zapsáni tak, aby mohli pracovat v prostředí s částečným vztahem důvěryhodnosti.</span><span class="sxs-lookup"><span data-stu-id="3ca63-112">Providers should be written so that they can work in a partial-trust environment.</span></span> <span data-ttu-id="3ca63-113">Vzhledem k tomu, že UIAutomationClient.dll není nakonfigurován tak, aby běžel v rámci částečné důvěryhodnosti, váš kód poskytovatele by neměl odkazovat na toto sestavení.</span><span class="sxs-lookup"><span data-stu-id="3ca63-113">Because UIAutomationClient.dll is not configured to run under partial trust, your provider code should not reference that assembly.</span></span> <span data-ttu-id="3ca63-114">Pokud ano, může kód běžet v prostředí s plnou důvěryhodností, ale pak selže v prostředí s částečnou důvěryhodností.</span><span class="sxs-lookup"><span data-stu-id="3ca63-114">If it does so, the code may run in a full-trust environment but then fail in a partial-trust environment.</span></span>

<span data-ttu-id="3ca63-115">Konkrétně nepoužívejte pole ze tříd v UIAutomationClient.dll, jako jsou například v <xref:System.Windows.Automation.AutomationElement> .</span><span class="sxs-lookup"><span data-stu-id="3ca63-115">In particular, do not use fields from classes in UIAutomationClient.dll such as those in <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="3ca63-116">Místo toho použijte ekvivalentní pole z tříd v UIAutomationTypes.dll, například <xref:System.Windows.Automation.AutomationElementIdentifiers> .</span><span class="sxs-lookup"><span data-stu-id="3ca63-116">Instead, use the equivalent fields from classes in UIAutomationTypes.dll, such as <xref:System.Windows.Automation.AutomationElementIdentifiers>.</span></span>

<a name="Provider_Implementation_by_WPF_Elements"></a>

## <a name="provider-implementation-by-windows-presentation-foundation-elements"></a><span data-ttu-id="3ca63-117">Implementace poskytovatele pomocí Windows Presentation Foundationch prvků</span><span class="sxs-lookup"><span data-stu-id="3ca63-117">Provider Implementation by Windows Presentation Foundation Elements</span></span>

<span data-ttu-id="3ca63-118">Další informace o tomto tématu naleznete v tématu [automatizace uživatelského rozhraní vlastního ovládacího prvku WPF](../wpf/controls/ui-automation-of-a-wpf-custom-control.md).</span><span class="sxs-lookup"><span data-stu-id="3ca63-118">For more information on this topic, please see [UI Automation of a WPF Custom Control](../wpf/controls/ui-automation-of-a-wpf-custom-control.md).</span></span>

<a name="Provider_Implementation_by_non_WPF_Elements"></a>

## <a name="provider-implementation-by-non-wpf-elements"></a><span data-ttu-id="3ca63-119">Implementace poskytovatele pomocí elementů, které nejsou WPF</span><span class="sxs-lookup"><span data-stu-id="3ca63-119">Provider Implementation by non-WPF Elements</span></span>

<span data-ttu-id="3ca63-120">Vlastní ovládací prvky, které nejsou součástí architektury WPF, ale které jsou napsány ve spravovaném kódu (nejčastěji se jedná o model Windows Forms ovládacích prvků), poskytují podporu pro [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] implementací rozhraní.</span><span class="sxs-lookup"><span data-stu-id="3ca63-120">Custom controls that are not part of the WPF framework, but that are written in managed code (most often these are Windows Forms controls), provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] by implementing interfaces.</span></span> <span data-ttu-id="3ca63-121">Každý prvek musí implementovat alespoň jedno rozhraní uvedené v první tabulce v následující části.</span><span class="sxs-lookup"><span data-stu-id="3ca63-121">Every element must implement at least one of the interfaces listed in the first table in the next section.</span></span> <span data-ttu-id="3ca63-122">Kromě toho, pokud prvek podporuje jeden nebo více vzorů ovládacích prvků, musí implementovat příslušné rozhraní pro každý model ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="3ca63-122">In addition, if the element supports one or more control patterns, it must implement the appropriate interface for each control pattern.</span></span>

<span data-ttu-id="3ca63-123">Váš [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] projekt poskytovatele musí odkazovat na následující sestavení:</span><span class="sxs-lookup"><span data-stu-id="3ca63-123">Your [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider project must reference the following assemblies:</span></span>

- <span data-ttu-id="3ca63-124">UIAutomationProviders.dll</span><span class="sxs-lookup"><span data-stu-id="3ca63-124">UIAutomationProviders.dll</span></span>

- <span data-ttu-id="3ca63-125">UIAutomationTypes.dll</span><span class="sxs-lookup"><span data-stu-id="3ca63-125">UIAutomationTypes.dll</span></span>

- <span data-ttu-id="3ca63-126">WindowsBase.dll</span><span class="sxs-lookup"><span data-stu-id="3ca63-126">WindowsBase.dll</span></span>

<a name="Provider_Interfaces"></a>

### <a name="provider-interfaces"></a><span data-ttu-id="3ca63-127">Rozhraní poskytovatele</span><span class="sxs-lookup"><span data-stu-id="3ca63-127">Provider Interfaces</span></span>

<span data-ttu-id="3ca63-128">Každý [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] Zprostředkovatel musí implementovat jedno z následujících rozhraní.</span><span class="sxs-lookup"><span data-stu-id="3ca63-128">Every [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider must implement one of the following interfaces.</span></span>

|<span data-ttu-id="3ca63-129">Rozhraní</span><span class="sxs-lookup"><span data-stu-id="3ca63-129">Interface</span></span>|<span data-ttu-id="3ca63-130">Description</span><span class="sxs-lookup"><span data-stu-id="3ca63-130">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderSimple>|<span data-ttu-id="3ca63-131">Poskytuje funkce pro jednoduchý ovládací prvek hostovaný v okně, včetně podpory vzorů a vlastností ovládacích prvků.</span><span class="sxs-lookup"><span data-stu-id="3ca63-131">Provides functionality for a simple control hosted in a window, including support for control patterns and properties.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragment>|<span data-ttu-id="3ca63-132">Dědí z <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> .</span><span class="sxs-lookup"><span data-stu-id="3ca63-132">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple>.</span></span> <span data-ttu-id="3ca63-133">Přidává funkce pro element ve složitém ovládacím prvku, včetně navigace v rámci fragmentu, nastavení fokusu a vrácení ohraničujícího obdélníku elementu.</span><span class="sxs-lookup"><span data-stu-id="3ca63-133">Adds functionality for an element in a complex control, including navigation within the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>|<span data-ttu-id="3ca63-134">Dědí z <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> .</span><span class="sxs-lookup"><span data-stu-id="3ca63-134">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderFragment>.</span></span> <span data-ttu-id="3ca63-135">Přidává funkce pro kořenový prvek ve složitém ovládacím prvku, včetně vyhledání podřízeného prvku na zadaných souřadnicích a nastavení stavu fokusu pro celý ovládací prvek.</span><span class="sxs-lookup"><span data-stu-id="3ca63-135">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span>|

<span data-ttu-id="3ca63-136">Následující rozhraní poskytují přidané funkce, ale není nutné je implementovat.</span><span class="sxs-lookup"><span data-stu-id="3ca63-136">The following interfaces provide added functionality but are not required to be implemented.</span></span>

|<span data-ttu-id="3ca63-137">Rozhraní</span><span class="sxs-lookup"><span data-stu-id="3ca63-137">Interface</span></span>|<span data-ttu-id="3ca63-138">Description</span><span class="sxs-lookup"><span data-stu-id="3ca63-138">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="3ca63-139">Umožňuje poskytovateli sledovat požadavky na události.</span><span class="sxs-lookup"><span data-stu-id="3ca63-139">Enables the provider to track requests for events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride>|<span data-ttu-id="3ca63-140">Umožňuje přemístit prvky založené na oknech v rámci [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] stromu fragmentu.</span><span class="sxs-lookup"><span data-stu-id="3ca63-140">Enables repositioning of window-based elements within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree of a fragment.</span></span>|

<span data-ttu-id="3ca63-141">Všechna ostatní rozhraní v <xref:System.Windows.Automation.Provider> oboru názvů jsou pro podporu vzorů ovládacích prvků.</span><span class="sxs-lookup"><span data-stu-id="3ca63-141">All other interfaces in the <xref:System.Windows.Automation.Provider> namespace are for control pattern support.</span></span>

<a name="Requirements_for_Non_WPF_Providers"></a>

### <a name="requirements-for-non-wpf-providers"></a><span data-ttu-id="3ca63-142">Požadavky na zprostředkovatele jiných výrobců než WPF</span><span class="sxs-lookup"><span data-stu-id="3ca63-142">Requirements for Non-WPF Providers</span></span>

<span data-ttu-id="3ca63-143">Aby bylo možné komunikovat s [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , musí váš ovládací prvek implementovat následující hlavní oblasti funkčnosti:</span><span class="sxs-lookup"><span data-stu-id="3ca63-143">In order to communicate with [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], your control must implement the following main areas of functionality:</span></span>

|<span data-ttu-id="3ca63-144">Funkce</span><span class="sxs-lookup"><span data-stu-id="3ca63-144">Functionality</span></span>|<span data-ttu-id="3ca63-145">Implementace</span><span class="sxs-lookup"><span data-stu-id="3ca63-145">Implementation</span></span>|
|-------------------|--------------------|
|<span data-ttu-id="3ca63-146">Vystavení poskytovatele pro[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3ca63-146">Expose the provider to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span></span>|<span data-ttu-id="3ca63-147">V reakci na WM_GETOBJECT zprávu odeslanou oknu ovládacího prvku vrátí objekt, který implementuje <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (nebo odvozené rozhraní).</span><span class="sxs-lookup"><span data-stu-id="3ca63-147">In response to a WM_GETOBJECT message sent to the control window, return the object that implements <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (or a derived interface).</span></span> <span data-ttu-id="3ca63-148">U fragmentů musí být to zprostředkovatel pro kořen fragmentu.</span><span class="sxs-lookup"><span data-stu-id="3ca63-148">For fragments, this must be the provider for the fragment root.</span></span>|
|<span data-ttu-id="3ca63-149">Zadejte hodnoty vlastností.</span><span class="sxs-lookup"><span data-stu-id="3ca63-149">Provide property values</span></span>|<span data-ttu-id="3ca63-150">Implementujte <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> pro zadání nebo přepsání hodnot.</span><span class="sxs-lookup"><span data-stu-id="3ca63-150">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> to provide or override values.</span></span>|
|<span data-ttu-id="3ca63-151">Povolení interakce klienta s ovládacím prvkem</span><span class="sxs-lookup"><span data-stu-id="3ca63-151">Enable the client to interact with the control</span></span>|<span data-ttu-id="3ca63-152">Implementujte rozhraní, která podporují vzory ovládacích prvků, jako je například <xref:System.Windows.Automation.Provider.IInvokeProvider> .</span><span class="sxs-lookup"><span data-stu-id="3ca63-152">Implement interfaces that support control patterns, such as <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span></span> <span data-ttu-id="3ca63-153">Vrátí tyto poskytovatele vzorů v implementaci <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A> .</span><span class="sxs-lookup"><span data-stu-id="3ca63-153">Return these pattern providers in your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>.</span></span>|
|<span data-ttu-id="3ca63-154">Vyvolat události</span><span class="sxs-lookup"><span data-stu-id="3ca63-154">Raise events</span></span>|<span data-ttu-id="3ca63-155">Zavolejte jednu ze statických metod pro <xref:System.Windows.Automation.Provider.AutomationInteropProvider> k vyvolání události, na kterou může klient naslouchat.</span><span class="sxs-lookup"><span data-stu-id="3ca63-155">Call one of the static methods of <xref:System.Windows.Automation.Provider.AutomationInteropProvider> to raise an event that a client can listen for.</span></span>|
|<span data-ttu-id="3ca63-156">Povolit navigaci a zaostření v rámci fragmentu</span><span class="sxs-lookup"><span data-stu-id="3ca63-156">Enable navigation and focusing within a fragment</span></span>|<span data-ttu-id="3ca63-157">Implementujte <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> pro každý prvek v rámci fragmentu.</span><span class="sxs-lookup"><span data-stu-id="3ca63-157">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> for each element within the fragment.</span></span> <span data-ttu-id="3ca63-158">(Není nutné pro prvky, které nejsou součástí fragmentu.)</span><span class="sxs-lookup"><span data-stu-id="3ca63-158">(Not necessary for elements that are not part of a fragment.)</span></span>|
|<span data-ttu-id="3ca63-159">Povolit zaostření a umístění podřízeného prvku v fragmentu</span><span class="sxs-lookup"><span data-stu-id="3ca63-159">Enable focusing and location of child element in a fragment</span></span>|<span data-ttu-id="3ca63-160">Implementujte <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot> .</span><span class="sxs-lookup"><span data-stu-id="3ca63-160">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>.</span></span> <span data-ttu-id="3ca63-161">(Není nutné pro prvky, které nefragmentují kořeny.)</span><span class="sxs-lookup"><span data-stu-id="3ca63-161">(Not necessary for elements that are not fragment roots.)</span></span>|

<a name="Property_Values_in_Non_WPF_Providers"></a>

### <a name="property-values-in-non-wpf-providers"></a><span data-ttu-id="3ca63-162">Hodnoty vlastností v jiných zprostředkovatelích než WPF</span><span class="sxs-lookup"><span data-stu-id="3ca63-162">Property Values in Non-WPF Providers</span></span>

[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]<span data-ttu-id="3ca63-163">zprostředkovatelé pro vlastní ovládací prvky musí podporovat některé vlastnosti, které může použít systém automatizace a také klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="3ca63-163">providers for custom controls must support certain properties that can be used by the automation system as well as by client applications.</span></span> <span data-ttu-id="3ca63-164">U elementů, které jsou hostovány ve Windows (HWND), [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] může aplikace načíst některé vlastnosti z výchozího poskytovatele, ale musí si od vlastního poskytovatele získat jiné.</span><span class="sxs-lookup"><span data-stu-id="3ca63-164">For elements that are hosted in windows (HWNDs), [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>

<span data-ttu-id="3ca63-165">Zprostředkovatelé pro ovládací prvky na bázi HWND nemusejí obvykle zadávat následující vlastnosti (identifikované hodnotami polí):</span><span class="sxs-lookup"><span data-stu-id="3ca63-165">Providers for HWND based controls do not usually need to provide the following properties (identified by field values):</span></span>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.BoundingRectangleProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClickablePointProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ProcessIdProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClassNameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.HasKeyboardFocusProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsEnabledProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsPasswordProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty>

> [!NOTE]
> <span data-ttu-id="3ca63-166"><xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty>Z okna se získá jednoduchý element nebo kořen fragmentu, který je hostovaný v okně. fragmenty prvků pod kořenem (například položky seznamu v poli se seznamem) musí poskytovat své vlastní identifikátory.</span><span class="sxs-lookup"><span data-stu-id="3ca63-166">The <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> of a simple element or fragment root hosted in a window is obtained from the window; however, fragment elements below the root (such as list items in a list box) must provide their own identifiers.</span></span> <span data-ttu-id="3ca63-167">Další informace naleznete v tématu <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>.</span><span class="sxs-lookup"><span data-stu-id="3ca63-167">For more information, see <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>.</span></span>
>
> <span data-ttu-id="3ca63-168"><xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty>Měla by se vrátit pro poskytovatele hostované v ovládacím prvku model Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="3ca63-168">The <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty> should be returned for providers hosted in a Windows Forms control.</span></span> <span data-ttu-id="3ca63-169">V takovém případě nemůže být ve výchozím zprostředkovateli Windows načtena správná hodnota.</span><span class="sxs-lookup"><span data-stu-id="3ca63-169">In this case, the default window provider may be unable to retrieve the correct value.</span></span>
>
> <span data-ttu-id="3ca63-170"><xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty>Je obvykle dodán poskytovatelem hostitele.</span><span class="sxs-lookup"><span data-stu-id="3ca63-170">The <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> is usually supplied by the host provider.</span></span> <span data-ttu-id="3ca63-171">Například pokud je vlastní ovládací prvek odvozen z <xref:System.Windows.Forms.Control> , název je odvozen z `Text` vlastnosti ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="3ca63-171">For example, if a custom control is derived from <xref:System.Windows.Forms.Control>, the name is derived from the `Text` property of the control.</span></span>

<span data-ttu-id="3ca63-172">Příklad kódu naleznete v tématu [návratové vlastnosti ze zprostředkovatele automatizace uživatelského rozhraní](return-properties-from-a-ui-automation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="3ca63-172">For example code, see [Return Properties from a UI Automation Provider](return-properties-from-a-ui-automation-provider.md).</span></span>

<a name="Events_in_Non_WPF_Providers"></a>

### <a name="events-in-non-wpf-providers"></a><span data-ttu-id="3ca63-173">Události v jiných zprostředkovatelích než WPF</span><span class="sxs-lookup"><span data-stu-id="3ca63-173">Events in Non-WPF Providers</span></span>

[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]<span data-ttu-id="3ca63-174">Poskytovatelé by měli vyvolat události, které upozorňují klientské aplikace na změny ve stavu uživatelského rozhraní.</span><span class="sxs-lookup"><span data-stu-id="3ca63-174">providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="3ca63-175">Následující metody slouží k vyvolání událostí.</span><span class="sxs-lookup"><span data-stu-id="3ca63-175">The following methods are used to raise events.</span></span>

|<span data-ttu-id="3ca63-176">Metoda</span><span class="sxs-lookup"><span data-stu-id="3ca63-176">Method</span></span>|<span data-ttu-id="3ca63-177">Description</span><span class="sxs-lookup"><span data-stu-id="3ca63-177">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationEvent%2A>|<span data-ttu-id="3ca63-178">Vyvolává různé události, včetně událostí aktivovaných vzorci ovládacích prvků.</span><span class="sxs-lookup"><span data-stu-id="3ca63-178">Raises various events, including events triggered by control patterns.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationPropertyChangedEvent%2A>|<span data-ttu-id="3ca63-179">Vyvolá událost, když dojde ke [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] změně vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="3ca63-179">Raises an event when a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] property has changed.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseStructureChangedEvent%2A>|<span data-ttu-id="3ca63-180">Vyvolá událost při [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] změně struktury stromu, například odebráním nebo přidáním prvku.</span><span class="sxs-lookup"><span data-stu-id="3ca63-180">Raises an event when the structure of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree has changed; for example, by the removal or addition of an element.</span></span>|

<span data-ttu-id="3ca63-181">Účelem události je upozornit klienta na něco, co se koná v rámci [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] , bez ohledu na to, jestli je aktivita aktivovaná [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] samotným systémem.</span><span class="sxs-lookup"><span data-stu-id="3ca63-181">The purpose of an event is to notify the client of something taking place in the [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)], whether or not the activity is triggered by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] system itself.</span></span> <span data-ttu-id="3ca63-182">Například událost identifikovaná <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> by měla být vyvolána při každém vyvolání ovládacího prvku, buď prostřednictvím přímého vstupu uživatele nebo voláním klientské aplikace <xref:System.Windows.Automation.InvokePattern.Invoke%2A> .</span><span class="sxs-lookup"><span data-stu-id="3ca63-182">For example, the event identified by <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> should be raised whenever the control is invoked, either through direct user input or by the client application calling <xref:System.Windows.Automation.InvokePattern.Invoke%2A>.</span></span>

<span data-ttu-id="3ca63-183">Pro optimalizaci výkonu může poskytovatel selektivně vyvolat události nebo vyvolat žádné události, pokud není pro jejich příjem registrována žádná klientská aplikace.</span><span class="sxs-lookup"><span data-stu-id="3ca63-183">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="3ca63-184">Pro optimalizaci se používají následující metody.</span><span class="sxs-lookup"><span data-stu-id="3ca63-184">The following methods are used for optimization.</span></span>

|<span data-ttu-id="3ca63-185">Metoda</span><span class="sxs-lookup"><span data-stu-id="3ca63-185">Method</span></span>|<span data-ttu-id="3ca63-186">Description</span><span class="sxs-lookup"><span data-stu-id="3ca63-186">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.ClientsAreListening%2A>|<span data-ttu-id="3ca63-187">Tato statická vlastnost určuje, zda se některé klientské aplikace přihlásily k odběru [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] událostí.</span><span class="sxs-lookup"><span data-stu-id="3ca63-187">This static property specifies whether any client applications have subscribed to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="3ca63-188">Implementace poskytovatele tohoto rozhraní v kořenovém adresáři fragmentů umožňuje, aby bylo doporučeno, aby klienti zaregistrovali a zrušili registraci obslužných rutin událostí pro události v fragmentu.</span><span class="sxs-lookup"><span data-stu-id="3ca63-188">The provider's implementation of this interface on a fragment root enables it to be advised when clients register and unregister event handlers for events on the fragment.</span></span>|

<a name="Non_WPF_Provider_Navigation"></a>

### <a name="non-wpf-provider-navigation"></a><span data-ttu-id="3ca63-189">Navigace od jiného poskytovatele než WPF</span><span class="sxs-lookup"><span data-stu-id="3ca63-189">Non-WPF Provider Navigation</span></span>

<span data-ttu-id="3ca63-190">Poskytovatelé jednoduchých ovládacích prvků, jako je vlastní tlačítko hostovaná v okně (HWND), nemusejí podporovat navigaci v rámci [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] stromu.</span><span class="sxs-lookup"><span data-stu-id="3ca63-190">Providers for simple controls such as a custom button hosted in a window (HWND) do not need to support navigation within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.</span></span> <span data-ttu-id="3ca63-191">Navigace do a z prvku je zpracována výchozím zprostředkovatelem pro hostitelské okno, které je určeno v implementaci <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> .</span><span class="sxs-lookup"><span data-stu-id="3ca63-191">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>.</span></span> <span data-ttu-id="3ca63-192">Při implementaci poskytovatele pro komplexní vlastní ovládací prvek je však nutné podporovat navigaci mezi kořenovým uzlem fragmentu a jeho následníky a mezi uzly na stejné úrovni.</span><span class="sxs-lookup"><span data-stu-id="3ca63-192">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>

> [!NOTE]
> <span data-ttu-id="3ca63-193">Elementy jiné fragmenty než kořen musí vracet `null` odkaz z <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> , protože nejsou přímo hostovány v okně a žádný výchozí zprostředkovatel nemůže podporovat navigaci do a z nich.</span><span class="sxs-lookup"><span data-stu-id="3ca63-193">Elements of a fragment other than the root must return a `null` reference  from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>

<span data-ttu-id="3ca63-194">Struktura fragmentu je určena vaší implementací <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> .</span><span class="sxs-lookup"><span data-stu-id="3ca63-194">The structure of the fragment is determined by your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>.</span></span> <span data-ttu-id="3ca63-195">Pro každý možný směr z každého fragmentu vrátí tato metoda objekt Provider pro element v tomto směru.</span><span class="sxs-lookup"><span data-stu-id="3ca63-195">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="3ca63-196">Pokud v tomto směru není žádný element, metoda vrátí `null` referenci.</span><span class="sxs-lookup"><span data-stu-id="3ca63-196">If there is no element in that direction, the method returns a `null` reference.</span></span>

<span data-ttu-id="3ca63-197">Kořen fragmentu podporuje navigaci pouze na podřízené elementy.</span><span class="sxs-lookup"><span data-stu-id="3ca63-197">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="3ca63-198">Například seznam pole vrátí první položku v seznamu, když je směr <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild> a poslední položka, když je směr <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild> .</span><span class="sxs-lookup"><span data-stu-id="3ca63-198">For example, a list box returns the first item in the list when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>, and the last item when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>.</span></span> <span data-ttu-id="3ca63-199">Kořen fragmentu nepodporuje navigaci na nadřazený objekt nebo na stejné úrovni. to zpracovává poskytovatel hostitelského okna.</span><span class="sxs-lookup"><span data-stu-id="3ca63-199">The fragment root does not support navigation to a parent or siblings; this is handled by the host window provider.</span></span>

<span data-ttu-id="3ca63-200">Prvky fragmentu, které nejsou kořenem, musí podporovat navigaci na nadřazený objekt a na všechny členy na stejné úrovni a podřízené objekty.</span><span class="sxs-lookup"><span data-stu-id="3ca63-200">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>

<a name="Non_WPF_Provider_Reparenting"></a>

### <a name="non-wpf-provider-reparenting"></a><span data-ttu-id="3ca63-201">Opětovné řazení poskytovatele WPF Provider</span><span class="sxs-lookup"><span data-stu-id="3ca63-201">Non-WPF Provider Reparenting</span></span>

<span data-ttu-id="3ca63-202">Automaticky otevíraná okna jsou ve skutečnosti okna nejvyšší úrovně, takže ve stromové struktuře se ve výchozím nastavení zobrazí [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] jako podřízené položky plochy.</span><span class="sxs-lookup"><span data-stu-id="3ca63-202">Pop-up windows are actually top-level windows, and so by default appear in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree as children of the desktop.</span></span> <span data-ttu-id="3ca63-203">V mnoha případech jsou však automaticky otevíraná okna logicky podřízeny nějakému jinému ovládacímu prvku.</span><span class="sxs-lookup"><span data-stu-id="3ca63-203">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="3ca63-204">Například rozevírací seznam pole se seznamem je logicky podřízenou položkou pole se seznamem.</span><span class="sxs-lookup"><span data-stu-id="3ca63-204">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="3ca63-205">Podobně automaticky otevírané okno nabídky je logicky podřízenou položkou nabídky.</span><span class="sxs-lookup"><span data-stu-id="3ca63-205">Similarly, a menu pop-up window is logically a child of the menu.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]<span data-ttu-id="3ca63-206">poskytuje podporu pro nadřízená překryvná okna tak, aby se zobrazila jako podřízená položka přidruženého ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="3ca63-206">provides support to reparent pop-up windows so that they appear to be children of the associated control.</span></span>

<span data-ttu-id="3ca63-207">Postup pro opětovné vytvoření nadřazeného okna:</span><span class="sxs-lookup"><span data-stu-id="3ca63-207">To reparent a pop-up window:</span></span>

1. <span data-ttu-id="3ca63-208">Vytvořte poskytovatele pro místní okno.</span><span class="sxs-lookup"><span data-stu-id="3ca63-208">Create a provider for the pop-up window.</span></span> <span data-ttu-id="3ca63-209">To vyžaduje, aby byla třída místního okna známa předem.</span><span class="sxs-lookup"><span data-stu-id="3ca63-209">This requires that the class of the pop-up window is known in advance.</span></span>

2. <span data-ttu-id="3ca63-210">Implementujte všechny vlastnosti a vzory obvyklým způsobem pro automaticky otevírané okno, jako by šlo o ovládací prvek sám o sobě.</span><span class="sxs-lookup"><span data-stu-id="3ca63-210">Implement all properties and patterns as usual for that pop-up, as though it were a control in its own right.</span></span>

3. <span data-ttu-id="3ca63-211">Implementujte <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> vlastnost tak, aby vracela hodnotu získanou z <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A> , kde parametr je obslužná rutina okna v místním okně.</span><span class="sxs-lookup"><span data-stu-id="3ca63-211">Implement the <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> property so that it returns the value obtained from <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, where the parameter is the window handle of the pop-up window.</span></span>

4. <span data-ttu-id="3ca63-212">Implementujte <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> pro automaticky otevírané okno a jeho nadřazený ovládací prvek tak, aby navigace byla správně zpracována z logického nadřazeného objektu na logické podřízené položky a mezi podřízenými položkami na stejné úrovni.</span><span class="sxs-lookup"><span data-stu-id="3ca63-212">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>

<span data-ttu-id="3ca63-213">Když [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] dojde k místnímu oknu, rozpozná, že navigace je přepsána z výchozí hodnoty, a přeskočí v překryvném okně, když se objeví jako podřízená položka plochy.</span><span class="sxs-lookup"><span data-stu-id="3ca63-213">When [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="3ca63-214">Místo toho bude uzel dosažitelný pouze prostřednictvím fragmentu.</span><span class="sxs-lookup"><span data-stu-id="3ca63-214">Instead, the node will only be reachable through the fragment.</span></span>

<span data-ttu-id="3ca63-215">Opětovné vytvoření nadřazeného objektu není vhodné pro případy, kdy ovládací prvek může hostovat okno libovolné třídy.</span><span class="sxs-lookup"><span data-stu-id="3ca63-215">Reparenting is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="3ca63-216">Například matrice může hostovat libovolný typ HWND ve svých pásmech.</span><span class="sxs-lookup"><span data-stu-id="3ca63-216">For example, a rebar can host any type of HWND in its bands.</span></span> <span data-ttu-id="3ca63-217">Pro zpracování těchto případů [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] podporuje alternativní forma přemístění HWND, jak je popsáno v následující části.</span><span class="sxs-lookup"><span data-stu-id="3ca63-217">To handle these cases, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] supports an alternative form of HWND relocation, as described in the next section.</span></span>

<a name="Non_WPF_Provider_Repositioning"></a>

### <a name="non-wpf-provider-repositioning"></a><span data-ttu-id="3ca63-218">Přemístění poskytovatele rozhraní non-WPF</span><span class="sxs-lookup"><span data-stu-id="3ca63-218">Non-WPF Provider Repositioning</span></span>

[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]<span data-ttu-id="3ca63-219">fragmenty mohou obsahovat dva nebo více prvků, které jsou obsaženy v okně (HWND).</span><span class="sxs-lookup"><span data-stu-id="3ca63-219">fragments may contain two or more elements that are each contained in a window (HWND).</span></span> <span data-ttu-id="3ca63-220">Vzhledem k tomu, že každý HWND má svého vlastního výchozího poskytovatele, který považuje HWND za podřízenou položku obsahující HWND, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] strom ve výchozím nastavení zobrazí HWND v fragmentu jako podřízené objekty nadřazeného okna.</span><span class="sxs-lookup"><span data-stu-id="3ca63-220">Because each HWND has its own default provider that considers the HWND to be a child of a containing HWND, the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree will, by default, show the HWNDs in the fragment as children of the parent window.</span></span> <span data-ttu-id="3ca63-221">Ve většině případů to je žádoucí chování, ale někdy může vést k záměně, protože se neshoduje s logickou strukturou [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3ca63-221">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span>

<span data-ttu-id="3ca63-222">Dobrým příkladem toho je ovládací prvek matrice.</span><span class="sxs-lookup"><span data-stu-id="3ca63-222">A good example of this is a rebar control.</span></span> <span data-ttu-id="3ca63-223">Matrice obsahuje pruhy, z nichž každý může zase obsahovat ovládací prvek založený na HWND, jako je například panel nástrojů, textové pole nebo pole se seznamem.</span><span class="sxs-lookup"><span data-stu-id="3ca63-223">A rebar contains bands, each of which can in turn contain an HWND-based control such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="3ca63-224">Výchozí zprostředkovatel oken pro matrice HWND uvidí ovládací prvky pruhy HWND jako podřízené a poskytovatel matrice uvidí pásma jako podřízené objekty.</span><span class="sxs-lookup"><span data-stu-id="3ca63-224">The default window provider for the rebar HWND sees the band control HWNDs as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="3ca63-225">Vzhledem k tomu, že zprostředkovatel HWND a poskytovatel matrice pracují v kombinaci a kombinování jejich podřízených prvků, jsou pruhy i ovládací prvky založené na HWND zobrazeny jako podřízené objekty matrice.</span><span class="sxs-lookup"><span data-stu-id="3ca63-225">Because the HWND provider and the rebar provider are working in tandem and combining their children, both the bands and the HWND-based controls appear as children of the rebar.</span></span> <span data-ttu-id="3ca63-226">Logicky by však měly být pouze pruhy zobrazeny jako podřízené položky matrice a každý poskytovatel pásma by měl být spojen s výchozím zprostředkovatelem HWND pro ovládací prvek, který obsahuje.</span><span class="sxs-lookup"><span data-stu-id="3ca63-226">Logically, however, only the bands should appear as children of the rebar, and each band provider should be coupled with the default HWND provider for the control it contains.</span></span>

<span data-ttu-id="3ca63-227">K tomu je potřeba, aby poskytovatel kořene fragmentu pro matrice vystavil sadu podřízených prvků reprezentujících pásma.</span><span class="sxs-lookup"><span data-stu-id="3ca63-227">To accomplish this, the fragment root provider for the rebar exposes a set of children representing the bands.</span></span> <span data-ttu-id="3ca63-228">Každý panel má jednoho poskytovatele, který může vystavit vlastnosti a vzory.</span><span class="sxs-lookup"><span data-stu-id="3ca63-228">Each band has a single provider that may expose properties and patterns.</span></span> <span data-ttu-id="3ca63-229">V jeho implementaci <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> vrátí poskytovatel pásma výchozího zprostředkovatele pro HWND ovládacího prvku, který získá voláním <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A> , předání v popisovači okna ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="3ca63-229">In its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, the band provider returns the default window provider for the control HWND, which it obtains by calling <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, passing in the control's window handle.</span></span> <span data-ttu-id="3ca63-230">Nakonec poskytovatel kořenového prvku fragmentu pro matrice implementuje <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> rozhraní a v jeho implementaci <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> vrátí příslušného poskytovatele pásma pro ovládací prvek obsažený v zadaném HWND.</span><span class="sxs-lookup"><span data-stu-id="3ca63-230">Finally, the fragment root provider for the rebar implements the <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> interface, and in its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> it returns the appropriate band provider for the control contained in the specified HWND.</span></span>

## <a name="see-also"></a><span data-ttu-id="3ca63-231">Viz také</span><span class="sxs-lookup"><span data-stu-id="3ca63-231">See also</span></span>

- [<span data-ttu-id="3ca63-232">Přehled zprostředkovatelů automatizace uživatelského rozhraní</span><span class="sxs-lookup"><span data-stu-id="3ca63-232">UI Automation Providers Overview</span></span>](ui-automation-providers-overview.md)
- [<span data-ttu-id="3ca63-233">Vystavení zprostředkovatele automatizace uživatelského rozhraní na straně serveru</span><span class="sxs-lookup"><span data-stu-id="3ca63-233">Expose a Server-side UI Automation Provider</span></span>](expose-a-server-side-ui-automation-provider.md)
- [<span data-ttu-id="3ca63-234">Vrácení vlastností ze zprostředkovatele automatizace uživatelského rozhraní</span><span class="sxs-lookup"><span data-stu-id="3ca63-234">Return Properties from a UI Automation Provider</span></span>](return-properties-from-a-ui-automation-provider.md)
- [<span data-ttu-id="3ca63-235">Vyvolávání událostí ze zprostředkovatele automatizace uživatelského rozhraní</span><span class="sxs-lookup"><span data-stu-id="3ca63-235">Raise Events from a UI Automation Provider</span></span>](raise-events-from-a-ui-automation-provider.md)
- [<span data-ttu-id="3ca63-236">Povolení navigace u zprostředkovatele fragmentu automatizace uživatelského rozhraní na straně klienta</span><span class="sxs-lookup"><span data-stu-id="3ca63-236">Enable Navigation in a UI Automation Fragment Provider</span></span>](enable-navigation-in-a-ui-automation-fragment-provider.md)
- [<span data-ttu-id="3ca63-237">Podpora vzorů ovládacích prvků u zprostředkovatele automatizace uživatelského rozhraní</span><span class="sxs-lookup"><span data-stu-id="3ca63-237">Support Control Patterns in a UI Automation Provider</span></span>](support-control-patterns-in-a-ui-automation-provider.md)
