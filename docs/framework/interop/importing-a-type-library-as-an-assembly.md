---
title: Import knihovny typů ve formě sestavení
description: Importujte knihovnu typů, která obsahuje definice typu modelu COM, jako sestavení. Naučte se, jak vytvářet metadata z knihovny typů, což vede k sestavení vzájemné spolupráce.
ms.date: 03/30/2017
helpviewer_keywords:
- importing type library
- type metadata
- custom wrappers
- metadata
- exposing COM components to .NET Framework
- Type Library Importer
- interoperation with unmanaged code, importing type library
- interoperation with unmanaged code, exposing COM components
- type libraries
- TypeLibConverter class, importing type library as assembly
- COM interop, importing type library
- COM interop, exposing COM components
ms.assetid: d1898229-cd40-426e-a275-f3eb65fbc79f
ms.openlocfilehash: e5187e3c2ce533f25a38e93bc3715dd3e2e47c11
ms.sourcegitcommit: e02d17b2cf9c1258dadda4810a5e6072a0089aee
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/01/2020
ms.locfileid: "85622715"
---
# <a name="importing-a-type-library-as-an-assembly"></a><span data-ttu-id="9414a-104">Import knihovny typů ve formě sestavení</span><span class="sxs-lookup"><span data-stu-id="9414a-104">Importing a Type Library as an Assembly</span></span>

<span data-ttu-id="9414a-105">Definice typu modelu COM jsou obvykle umístěny v knihovně typů.</span><span class="sxs-lookup"><span data-stu-id="9414a-105">COM type definitions usually reside in a type library.</span></span> <span data-ttu-id="9414a-106">V kontrastu kompilátory odpovídající specifikaci CLS vytváří metadata typu v sestavení.</span><span class="sxs-lookup"><span data-stu-id="9414a-106">In contrast, CLS-compliant compilers produce type metadata in an assembly.</span></span> <span data-ttu-id="9414a-107">Dva zdroje informací o typu jsou poměrně odlišné.</span><span class="sxs-lookup"><span data-stu-id="9414a-107">The two sources of type information are quite different.</span></span> <span data-ttu-id="9414a-108">Toto téma popisuje techniky pro generování metadat z knihovny typů.</span><span class="sxs-lookup"><span data-stu-id="9414a-108">This topic describes techniques for generating metadata from a type library.</span></span> <span data-ttu-id="9414a-109">Výsledné sestavení se nazývá definiční sestavení a informace o typu, které obsahuje, umožňuje .NET Framework aplikacím používat typy COM.</span><span class="sxs-lookup"><span data-stu-id="9414a-109">The resulting assembly is called an interop assembly, and the type information it contains enables .NET Framework applications to use COM types.</span></span>

<span data-ttu-id="9414a-110">Existují dva způsoby, jak tyto informace o typu zpřístupnit vaší aplikaci:</span><span class="sxs-lookup"><span data-stu-id="9414a-110">There are two ways to make this type information available to your application:</span></span>

- <span data-ttu-id="9414a-111">Použití spolupracujících sestavení s pouze návrhem: počínaje .NET Framework 4 můžete instruovat kompilátor pro vložení informací o typu ze sestavení interop do spustitelného souboru.</span><span class="sxs-lookup"><span data-stu-id="9414a-111">Using design-time-only interop assemblies: Beginning with the .NET Framework 4, you can instruct the compiler to embed type information from the interop assembly into your executable.</span></span> <span data-ttu-id="9414a-112">Kompilátor vloží pouze informace o typu, které vaše aplikace používá.</span><span class="sxs-lookup"><span data-stu-id="9414a-112">The compiler embeds only the type information that your application uses.</span></span> <span data-ttu-id="9414a-113">Sestavení vzájemné spolupráce není nutné nasazovat do aplikace.</span><span class="sxs-lookup"><span data-stu-id="9414a-113">You do not have to deploy the interop assembly with your application.</span></span> <span data-ttu-id="9414a-114">Toto je doporučený postup.</span><span class="sxs-lookup"><span data-stu-id="9414a-114">This is the recommended technique.</span></span>

- <span data-ttu-id="9414a-115">Nasazení definičních sestavení: můžete vytvořit standardní odkaz na definiční sestavení.</span><span class="sxs-lookup"><span data-stu-id="9414a-115">Deploying interop assemblies: You can create a standard reference to the interop assembly.</span></span> <span data-ttu-id="9414a-116">V takovém případě musí být definiční sestavení nasazeno s vaší aplikací.</span><span class="sxs-lookup"><span data-stu-id="9414a-116">In this case, the interop assembly must be deployed with your application.</span></span> <span data-ttu-id="9414a-117">Pokud použijete tento postup a nepoužíváte privátní komponentu modelu COM, vždy se na primární definiční sestavení (PIA) publikované autorem komponenty modelu COM, kterou máte v úmyslu začlenit do spravovaného kódu, vždy odkázat.</span><span class="sxs-lookup"><span data-stu-id="9414a-117">If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code.</span></span> <span data-ttu-id="9414a-118">Další informace o vytváření a používání primárních sestavení vzájemné spolupráce naleznete v tématu [primární spolupracující sestavení](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="9414a-118">For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span></span>

<span data-ttu-id="9414a-119">Pokud používáte interoperabilní sestavení pouze pro návrh, můžete vložit informace o typu z primárního definičního sestavení publikovaného autorem komponenty modelu COM.</span><span class="sxs-lookup"><span data-stu-id="9414a-119">When you use design-time-only interop assemblies, you can embed type information from the primary interop assembly published by the author of the COM component.</span></span> <span data-ttu-id="9414a-120">Není však nutné nasazovat primární definiční sestavení s vaší aplikací.</span><span class="sxs-lookup"><span data-stu-id="9414a-120">However, you do not have to deploy the primary interop assembly with your application.</span></span>

<span data-ttu-id="9414a-121">Použití spolupracujících sestavení pouze při návrhu snižuje velikost vaší aplikace, protože většina aplikací nepoužívá všechny funkce komponenty modelu COM.</span><span class="sxs-lookup"><span data-stu-id="9414a-121">Using design-time-only interop assemblies reduces the size of your application, because most applications do not use all the features of a COM component.</span></span> <span data-ttu-id="9414a-122">Kompilátor je velmi efektivní při vložení informací o typu; Pokud vaše aplikace používá pouze některé metody rozhraní COM, kompilátor nevloží nepoužívané metody.</span><span class="sxs-lookup"><span data-stu-id="9414a-122">The compiler is very efficient when it embeds type information; if your application uses only some of the methods on a COM interface, the compiler does not embed the unused methods.</span></span> <span data-ttu-id="9414a-123">Když aplikace, která obsahuje informace o vloženém typu, spolupracuje s jinou takovou aplikací nebo komunikuje s aplikací, která používá primární definiční sestavení, modul CLR používá pravidla rovnocennosti typů k určení, zda dva typy se stejným názvem reprezentují stejný typ COM.</span><span class="sxs-lookup"><span data-stu-id="9414a-123">When an application that has embedded type information interacts with another such application, or interacts with an application that uses a primary interop assembly, the common language runtime uses type equivalence rules to determine whether two types with the same name represent the same COM type.</span></span> <span data-ttu-id="9414a-124">Tato pravidla nemusíte znát, chcete-li používat objekty COM.</span><span class="sxs-lookup"><span data-stu-id="9414a-124">You do not have to know these rules to use COM objects.</span></span> <span data-ttu-id="9414a-125">Nicméně pokud vás zajímá pravidla, přečtěte si téma [typ ekvivalence a vložené typy spolupráce](type-equivalence-and-embedded-interop-types.md).</span><span class="sxs-lookup"><span data-stu-id="9414a-125">However, if you are interested in the rules, see [Type Equivalence and Embedded Interop Types](type-equivalence-and-embedded-interop-types.md).</span></span>

## <a name="generating-metadata"></a><span data-ttu-id="9414a-126">Generování metadat</span><span class="sxs-lookup"><span data-stu-id="9414a-126">Generating Metadata</span></span>

<span data-ttu-id="9414a-127">Knihovny typů modelu COM můžou být samostatné soubory, které mají příponu. tlb, například LOANLib. tlb.</span><span class="sxs-lookup"><span data-stu-id="9414a-127">COM type libraries can be stand-alone files that have a .tlb extension, such as Loanlib.tlb.</span></span> <span data-ttu-id="9414a-128">Některé knihovny typů jsou vloženy do oddílu prostředků souboru. dll nebo. exe.</span><span class="sxs-lookup"><span data-stu-id="9414a-128">Some type libraries are embedded in the resource section of a .dll or .exe file.</span></span> <span data-ttu-id="9414a-129">Další zdroje informací o knihovně typů jsou soubory. olb a. ocx.</span><span class="sxs-lookup"><span data-stu-id="9414a-129">Other sources of type library information are .olb and .ocx files.</span></span>

<span data-ttu-id="9414a-130">Po nalezení knihovny typů, která obsahuje implementaci cílového typu modelu COM, máte následující možnosti pro generování sestavení vzájemné spolupráce obsahující metadata typu:</span><span class="sxs-lookup"><span data-stu-id="9414a-130">After you locate the type library that contains the implementation of your target COM type, you have the following options for generating an interop assembly containing type metadata:</span></span>

- <span data-ttu-id="9414a-131">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="9414a-131">Visual Studio</span></span>

  <span data-ttu-id="9414a-132">Visual Studio automaticky převede typy modelu COM v knihovně typů na metadata v sestavení.</span><span class="sxs-lookup"><span data-stu-id="9414a-132">Visual Studio automatically converts COM types in a type library to metadata in an assembly.</span></span> <span data-ttu-id="9414a-133">Pokyny najdete v tématu [Postupy: Přidání odkazů do knihoven typů](how-to-add-references-to-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="9414a-133">For instructions, see [How to: Add References to Type Libraries](how-to-add-references-to-type-libraries.md).</span></span>

- [<span data-ttu-id="9414a-134">Importér knihovny typů (Tlbimp.exe)</span><span class="sxs-lookup"><span data-stu-id="9414a-134">Type Library Importer (Tlbimp.exe)</span></span>](../tools/tlbimp-exe-type-library-importer.md)

  <span data-ttu-id="9414a-135">Importér knihovny typů poskytuje možnosti příkazového řádku pro úpravu metadat ve výsledném definičním souboru, naimportuje typy z existující knihovny typů a vygeneruje definiční sestavení a obor názvů.</span><span class="sxs-lookup"><span data-stu-id="9414a-135">The Type Library Importer provides command-line options to adjust metadata in the resulting interop file, imports types from an existing type library, and generates an interop assembly and a namespace.</span></span> <span data-ttu-id="9414a-136">Pokyny naleznete v tématu [How to: Generate spolupracující sestavení z knihoven typů](how-to-generate-interop-assemblies-from-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="9414a-136">For instructions, see [How to: Generate Interop Assemblies from Type Libraries](how-to-generate-interop-assemblies-from-type-libraries.md).</span></span>

- <span data-ttu-id="9414a-137">Třída <xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="9414a-137"><xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType> class</span></span>

  <span data-ttu-id="9414a-138">Tato třída poskytuje metody pro převod tříd typu coclass a rozhraní v knihovně typů na metadata v rámci sestavení.</span><span class="sxs-lookup"><span data-stu-id="9414a-138">This class provides methods to convert coclasses and interfaces in a type library to metadata within an assembly.</span></span> <span data-ttu-id="9414a-139">Vytvoří stejný výstup metadat jako Tlbimp.exe.</span><span class="sxs-lookup"><span data-stu-id="9414a-139">It produces the same metadata output as Tlbimp.exe.</span></span> <span data-ttu-id="9414a-140">Nicméně na rozdíl od Tlbimp.exe <xref:System.Runtime.InteropServices.TypeLibConverter> Třída může převést knihovnu typů v paměti na metadata.</span><span class="sxs-lookup"><span data-stu-id="9414a-140">However, unlike Tlbimp.exe, the <xref:System.Runtime.InteropServices.TypeLibConverter> class can convert an in-memory type library to metadata.</span></span>

- <span data-ttu-id="9414a-141">Vlastní obálky</span><span class="sxs-lookup"><span data-stu-id="9414a-141">Custom wrappers</span></span>

  <span data-ttu-id="9414a-142">Pokud není knihovna typů k dispozici nebo je nesprávná, jedna z možností je vytvořit duplicitní definici třídy nebo rozhraní ve spravovaném zdrojovém kódu.</span><span class="sxs-lookup"><span data-stu-id="9414a-142">When a type library is unavailable or incorrect, one option is to create a duplicate definition of the class or interface in managed source code.</span></span> <span data-ttu-id="9414a-143">Poté zkompilujete zdrojový kód s kompilátorem, který cílí na modul runtime, aby vytvořil metadata v sestavení.</span><span class="sxs-lookup"><span data-stu-id="9414a-143">You then compile the source code with a compiler that targets the runtime to produce metadata in an assembly.</span></span>

  <span data-ttu-id="9414a-144">Chcete-li definovat typy COM ručně, musíte mít přístup k následujícím položkám:</span><span class="sxs-lookup"><span data-stu-id="9414a-144">To define COM types manually, you must have access to the following items:</span></span>

  - <span data-ttu-id="9414a-145">Přesné popisy tříd a rozhraní, které jsou definovány.</span><span class="sxs-lookup"><span data-stu-id="9414a-145">Precise descriptions of the coclasses and interfaces being defined.</span></span>

  - <span data-ttu-id="9414a-146">Kompilátor, jako je například kompilátor jazyka C#, který může generovat příslušné definice .NET Framework třídy.</span><span class="sxs-lookup"><span data-stu-id="9414a-146">A compiler, such as the C# compiler, that can generate the appropriate .NET Framework class definitions.</span></span>

  - <span data-ttu-id="9414a-147">Znalosti typu pravidla převodu knihovny na sestavení.</span><span class="sxs-lookup"><span data-stu-id="9414a-147">Knowledge of the type library-to-assembly conversion rules.</span></span>

  <span data-ttu-id="9414a-148">Vytvoření vlastní obálky je pokročilá technika.</span><span class="sxs-lookup"><span data-stu-id="9414a-148">Writing a custom wrapper is an advanced technique.</span></span> <span data-ttu-id="9414a-149">Další informace o tom, jak vygenerovat vlastní obálku, najdete v tématu [přizpůsobení standardních obálek](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="9414a-149">For additional information about how to generate a custom wrapper, see [Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span></span>

 <span data-ttu-id="9414a-150">Další informace o procesu importu zprostředkovatele komunikace s objekty COM naleznete v tématu [Souhrn převodu knihovny typů na sestavení](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="9414a-150">For more information about the COM interop import process, see [Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span></span>

## <a name="see-also"></a><span data-ttu-id="9414a-151">Viz také:</span><span class="sxs-lookup"><span data-stu-id="9414a-151">See also</span></span>

- <xref:System.Runtime.InteropServices.TypeLibConverter>
- [<span data-ttu-id="9414a-152">Vystavení komponent COM pro rozhraní .NET Framework</span><span class="sxs-lookup"><span data-stu-id="9414a-152">Exposing COM Components to the .NET Framework</span></span>](exposing-com-components.md)
- <span data-ttu-id="9414a-153">[Souhrn převodu knihovny typů na sestavení](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="9414a-153">[Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span></span>
- [<span data-ttu-id="9414a-154">Tlbimp.exe (importér knihovny typů)</span><span class="sxs-lookup"><span data-stu-id="9414a-154">Tlbimp.exe (Type Library Importer)</span></span>](../tools/tlbimp-exe-type-library-importer.md)
- <span data-ttu-id="9414a-155">[Přizpůsobení standardních obálek](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="9414a-155">[Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span></span>
- <span data-ttu-id="9414a-156">[Použití typů modelu COM ve spravovaném kódu](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="9414a-156">[Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="9414a-157">Kompilace projektu interoperability</span><span class="sxs-lookup"><span data-stu-id="9414a-157">Compiling an Interop Project</span></span>](compiling-an-interop-project.md)
- [<span data-ttu-id="9414a-158">Nasazení aplikace spolupráce</span><span class="sxs-lookup"><span data-stu-id="9414a-158">Deploying an Interop Application</span></span>](deploying-an-interop-application.md)
- [<span data-ttu-id="9414a-159">Postupy: Přidávání odkazů do knihoven typů</span><span class="sxs-lookup"><span data-stu-id="9414a-159">How to: Add References to Type Libraries</span></span>](how-to-add-references-to-type-libraries.md)
- [<span data-ttu-id="9414a-160">Postupy: Generování sestavení vzájemné spolupráce z knihoven typů</span><span class="sxs-lookup"><span data-stu-id="9414a-160">How to: Generate Interop Assemblies from Type Libraries</span></span>](how-to-generate-interop-assemblies-from-type-libraries.md)
