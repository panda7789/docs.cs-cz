---
title: Definice a určení chyb
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- handling faults [WCF], specifying
- handling faults [WCF], defining
ms.assetid: c00c84f1-962d-46a7-b07f-ebc4f80fbfc1
ms.openlocfilehash: 840d26e4543d2c90c99ebba05b5bca7a48cbdeda
ms.sourcegitcommit: 628e8147ca10187488e6407dab4c4e6ebe0cac47
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/15/2019
ms.locfileid: "72320037"
---
# <a name="defining-and-specifying-faults"></a><span data-ttu-id="6799d-102">Definice a určení chyb</span><span class="sxs-lookup"><span data-stu-id="6799d-102">Defining and Specifying Faults</span></span>
<span data-ttu-id="6799d-103">Chyby protokolu SOAP vyjadřují informace chybové podmínky ze služby klientovi a v duplexovém případě od klienta až po službu.</span><span class="sxs-lookup"><span data-stu-id="6799d-103">SOAP faults convey error condition information from a service to a client and, in the duplex case, from a client to a service in an interoperable way.</span></span> <span data-ttu-id="6799d-104">Toto téma popisuje, kdy a jak definovat vlastní obsah chyby a určit, které operace se můžou vrátit.</span><span class="sxs-lookup"><span data-stu-id="6799d-104">This topic discusses when and how to define custom fault content and specify which operations can return them.</span></span> <span data-ttu-id="6799d-105">Další informace o tom, jak může služba nebo duplexní klient odesílat tyto chyby a jak aplikace klienta nebo služby tyto chyby zpracovává, najdete v tématu [odesílání a příjem chyb](sending-and-receiving-faults.md).</span><span class="sxs-lookup"><span data-stu-id="6799d-105">For more information about how a service, or duplex client, can send those faults and how a client or service application handles these faults, see [Sending and Receiving Faults](sending-and-receiving-faults.md).</span></span> <span data-ttu-id="6799d-106">Přehled zpracování chyb v aplikacích Windows Communication Foundation (WCF) najdete v tématu [určení a zpracování chyb v kontraktech a službách](specifying-and-handling-faults-in-contracts-and-services.md).</span><span class="sxs-lookup"><span data-stu-id="6799d-106">For an overview of error handling in Windows Communication Foundation (WCF) applications, see [Specifying and Handling Faults in Contracts and Services](specifying-and-handling-faults-in-contracts-and-services.md).</span></span>  
  
## <a name="overview"></a><span data-ttu-id="6799d-107">Přehled</span><span class="sxs-lookup"><span data-stu-id="6799d-107">Overview</span></span>  
 <span data-ttu-id="6799d-108">Deklarované chyby protokolu SOAP jsou ty, ve kterých operace obsahuje <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType>, která určuje vlastní typ chyby protokolu SOAP.</span><span class="sxs-lookup"><span data-stu-id="6799d-108">Declared SOAP faults are those in which an operation has a <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> that specifies a custom SOAP fault type.</span></span> <span data-ttu-id="6799d-109">Nedeklarované chyby protokolu SOAP jsou ty, které nejsou ve kontraktu pro operaci zadané.</span><span class="sxs-lookup"><span data-stu-id="6799d-109">Undeclared SOAP faults are those that are not specified in the contract for an operation.</span></span> <span data-ttu-id="6799d-110">Toto téma vám pomůže identifikovat tyto chybové podmínky a vytvořit kontrakt selhání pro vaši službu, kterou klienti můžou použít k řádnému zpracování těchto chybových stavů, když jsou upozorňováni vlastními chybami protokolu SOAP.</span><span class="sxs-lookup"><span data-stu-id="6799d-110">This topic helps you identify those error conditions and create a fault contract for your service that clients can use to properly handle those error conditions when notified by custom SOAP faults.</span></span> <span data-ttu-id="6799d-111">Základní úlohy jsou v uvedeném pořadí:</span><span class="sxs-lookup"><span data-stu-id="6799d-111">The basic tasks are, in order:</span></span>  
  
1. <span data-ttu-id="6799d-112">Definujte chybové stavy, o které by měl klient služby informovat.</span><span class="sxs-lookup"><span data-stu-id="6799d-112">Define the error conditions that a client of your service should know about.</span></span>  
  
2. <span data-ttu-id="6799d-113">Zadejte vlastní obsah chyb protokolu SOAP pro tyto chybové stavy.</span><span class="sxs-lookup"><span data-stu-id="6799d-113">Define the custom content of the SOAP faults for those error conditions.</span></span>  
  
3. <span data-ttu-id="6799d-114">Označte své operace tak, aby konkrétní chyby SOAP, které vyvolávají, byly vystaveny klientům v jazyce WSDL.</span><span class="sxs-lookup"><span data-stu-id="6799d-114">Mark your operations so that the specific SOAP faults that they throw are exposed to clients in WSDL.</span></span>  
  
### <a name="defining-error-conditions-that-clients-should-know-about"></a><span data-ttu-id="6799d-115">Definování chybových podmínek, o kterých mají klienti informace</span><span class="sxs-lookup"><span data-stu-id="6799d-115">Defining Error Conditions That Clients Should Know About</span></span>  
 <span data-ttu-id="6799d-116">Chyby protokolu SOAP jsou veřejně popsány zprávy, které obsahují informace o chybě konkrétní operace.</span><span class="sxs-lookup"><span data-stu-id="6799d-116">SOAP faults are publicly described messages that carry fault information for a particular operation.</span></span> <span data-ttu-id="6799d-117">Vzhledem k tomu, že jsou popsány spolu s jinými operačními zprávami v jazyce WSDL, klienti ví a, proto při vyvolání operace očekávat tyto chyby.</span><span class="sxs-lookup"><span data-stu-id="6799d-117">Because they are described along with other operation messages in WSDL, clients know and, therefore, expect to handle such faults when invoking an operation.</span></span> <span data-ttu-id="6799d-118">Vzhledem k tomu, že služby WCF jsou napsány ve spravovaném kódu, rozhodování o tom, které chybové stavy ve spravovaném kódu mají být převedeny na chyby a vráceny klientovi, získáte možnost oddělit chybové podmínky a chyby ve službě od formální chyby. konverzace, kterou máte s klientem.</span><span class="sxs-lookup"><span data-stu-id="6799d-118">But because WCF services are written in managed code, deciding which error conditions in managed code are to be converted into faults and returned to the client provides you the opportunity to separate error conditions and bugs in your service from the formal error conversation you have with a client.</span></span>  
  
 <span data-ttu-id="6799d-119">Například následující příklad kódu ukazuje operaci, která přijímá dvě celá čísla a vrací jiné celé číslo.</span><span class="sxs-lookup"><span data-stu-id="6799d-119">For example, the following code example shows an operation that takes two integers and returns another integer.</span></span> <span data-ttu-id="6799d-120">V tuto chvíli může být vyvoláno několik výjimek, takže při navrhování smlouvy o selhání je třeba určit, které chybové stavy jsou pro vašeho klienta důležité.</span><span class="sxs-lookup"><span data-stu-id="6799d-120">Several exceptions can be thrown here, so when designing the fault contract, you must determine which error conditions are important for your client.</span></span> <span data-ttu-id="6799d-121">V takovém případě by služba měla detekovat výjimku <xref:System.DivideByZeroException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6799d-121">In this case, the service should detect the <xref:System.DivideByZeroException?displayProperty=nameWithType> exception.</span></span>  
  
```csharp  
[ServiceContract]  
public class CalculatorService  
{  
    [OperationContract]   
    int Divide(int a, int b)  
    {  
      if (b==0) throw new Exception("Division by zero!");  
      return a/b;  
    }  
}  
```  
  
```vb
<ServiceContract> _
Public Class CalculatorService
    <OperationContract> _
    Public Function Divide(a As Integer, b As Integer) As Integer
        If b = 0 Then Throw New DivideByZeroException("Division by zero!")
        Return a / b
    End Function
End Class
```
  
 <span data-ttu-id="6799d-122">V předchozím příkladu může operace vrátit buď vlastní chybu SOAP, která je specifická pro dělení nulou, vlastní chybu, která je specifická pro matematické operace, ale obsahuje informace specifické pro dělení nulou, více chyb pro několik různých chybové situace nebo žádná chyba protokolu SOAP.</span><span class="sxs-lookup"><span data-stu-id="6799d-122">In the preceding example the operation can either return a custom SOAP fault that is specific to dividing by zero, a custom fault that is specific to math operations but that contains information specific to dividing by zero, multiple faults for several different error situations, or no SOAP fault at all.</span></span>  
  
### <a name="define-the-content-of-error-conditions"></a><span data-ttu-id="6799d-123">Definování obsahu chybových podmínek</span><span class="sxs-lookup"><span data-stu-id="6799d-123">Define the Content of Error Conditions</span></span>  
 <span data-ttu-id="6799d-124">Jakmile je zjištěna chybová podmínka jako ta, která může užitečné vrátit vlastní chybu SOAP, je dalším krokem definování obsahu této chyby a zajištění serializace struktury obsahu.</span><span class="sxs-lookup"><span data-stu-id="6799d-124">Once an error condition has been identified as one that can usefully return a custom SOAP fault, the next step is to define the contents of that fault and ensure that the content structure can be serialized.</span></span> <span data-ttu-id="6799d-125">Příklad kódu v předchozí části ukazuje chybu specifickou pro operaci `Divide`, ale pokud existují jiné operace služby `Calculator`, pak jedna vlastní chyba protokolu SOAP může informovat klienta o všech chybových podmínkách kalkulačky, `Divide` zahrnuty.</span><span class="sxs-lookup"><span data-stu-id="6799d-125">The code example in the preceding section shows an error specific to a `Divide` operation, but if there are other operations on the `Calculator` service, then a single custom SOAP fault can inform the client of all calculator error conditions, `Divide` included.</span></span> <span data-ttu-id="6799d-126">Následující příklad kódu ukazuje vytvoření vlastní chyby protokolu SOAP, `MathFault`, která může hlásit chyby vytvořené pomocí všech matematických operací, včetně `Divide`.</span><span class="sxs-lookup"><span data-stu-id="6799d-126">The following code example shows the creation of a custom SOAP fault, `MathFault`, which can report errors made using all math operations, including `Divide`.</span></span> <span data-ttu-id="6799d-127">I když třída může specifikovat operaci (vlastnost `Operation`) a hodnota, která popisuje problém (vlastnost `ProblemType`), musí být třída a tyto vlastnosti serializovatelné, aby je bylo možné přenést do klienta ve vlastní chybě protokolu SOAP.</span><span class="sxs-lookup"><span data-stu-id="6799d-127">While the class can specify an operation (the `Operation` property) and a value that describes the problem (the `ProblemType` property), the class and these properties must be serializable to be transferred to the client in a custom SOAP fault.</span></span> <span data-ttu-id="6799d-128">Proto jsou atributy <xref:System.Runtime.Serialization.DataContractAttribute?displayProperty=nameWithType> a <xref:System.Runtime.Serialization.DataMemberAttribute?displayProperty=nameWithType> použity k tomu, aby byl typ a jeho vlastnosti serializovatelný a co možná vzájemně ovladatelné.</span><span class="sxs-lookup"><span data-stu-id="6799d-128">Therefore, the <xref:System.Runtime.Serialization.DataContractAttribute?displayProperty=nameWithType> and <xref:System.Runtime.Serialization.DataMemberAttribute?displayProperty=nameWithType> attributes are used to make the type and its properties serializable and as interoperable as possible.</span></span>  
  
 [!code-csharp[Faults#2](../../../samples/snippets/csharp/VS_Snippets_CFX/faults/cs/service.cs#2)]
 [!code-vb[Faults#2](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faults/vb/service.vb#2)]  
  
 <span data-ttu-id="6799d-129">Další informace o tom, jak zajistit, aby vaše data byla serializovatelný, najdete v tématu [určení přenos dat v kontraktech služeb](./feature-details/specifying-data-transfer-in-service-contracts.md).</span><span class="sxs-lookup"><span data-stu-id="6799d-129">For more information about how to ensure your data is serializable, see [Specifying Data Transfer in Service Contracts](./feature-details/specifying-data-transfer-in-service-contracts.md).</span></span> <span data-ttu-id="6799d-130">Seznam podpory serializace, kterou <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType> poskytuje, najdete v tématu [typy podporované serializátorem kontraktu dat](./feature-details/types-supported-by-the-data-contract-serializer.md).</span><span class="sxs-lookup"><span data-stu-id="6799d-130">For a list of the serialization support that <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType> provides, see [Types Supported by the Data Contract Serializer](./feature-details/types-supported-by-the-data-contract-serializer.md).</span></span>  
  
### <a name="mark-operations-to-establish-the-fault-contract"></a><span data-ttu-id="6799d-131">Označení operací k navázání smlouvy o selhání</span><span class="sxs-lookup"><span data-stu-id="6799d-131">Mark Operations to Establish the Fault Contract</span></span>  
 <span data-ttu-id="6799d-132">Jakmile je definována serializovatelný datová struktura, která je vrácena jako součást vlastní chyby protokolu SOAP, je posledním krokem označení kontraktu operace jako vyvolání chyby protokolu SOAP tohoto typu.</span><span class="sxs-lookup"><span data-stu-id="6799d-132">Once a serializable data structure that is returned as part of a custom SOAP fault is defined, the last step is to mark your operation contract as throwing a SOAP fault of that type.</span></span> <span data-ttu-id="6799d-133">Chcete-li to provést, použijte atribut <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> a předejte typ vlastního typu dat, který jste sestavili.</span><span class="sxs-lookup"><span data-stu-id="6799d-133">To do this, use the <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> attribute and pass the type of the custom data type that you have constructed.</span></span> <span data-ttu-id="6799d-134">Následující příklad kódu ukazuje, jak použít atribut <xref:System.ServiceModel.FaultContractAttribute> k určení toho, že operace `Divide` může vracet chybu SOAP typu `MathFault`.</span><span class="sxs-lookup"><span data-stu-id="6799d-134">The following code example shows how to use the <xref:System.ServiceModel.FaultContractAttribute> attribute to specify that the `Divide` operation can return a SOAP fault of type `MathFault`.</span></span> <span data-ttu-id="6799d-135">Jiné operace založené na matematických operacích teď můžou také určit, že můžou vracet `MathFault`.</span><span class="sxs-lookup"><span data-stu-id="6799d-135">Other math-based operations can now also specify that they can return a `MathFault`.</span></span>  
  
 [!code-csharp[Faults#1](../../../samples/snippets/csharp/VS_Snippets_CFX/faults/cs/service.cs#1)]
 [!code-vb[Faults#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faults/vb/service.vb#1)]  
  
 <span data-ttu-id="6799d-136">Operace může určit, že vrátí více než jednu vlastní chybu tím, že označíte tuto operaci s více než jedním atributem <xref:System.ServiceModel.FaultContractAttribute>.</span><span class="sxs-lookup"><span data-stu-id="6799d-136">An operation can specify that it returns more than one custom fault by marking that operation with more than one <xref:System.ServiceModel.FaultContractAttribute> attribute.</span></span>  
  
 <span data-ttu-id="6799d-137">Dalším krokem je implementace kontraktu chyby v implementaci vaší operace, která je popsaná v tématu [odesílání a příjem chyb](sending-and-receiving-faults.md).</span><span class="sxs-lookup"><span data-stu-id="6799d-137">The next step, to implement the fault contract in your operation implementation, is described in the topic [Sending and Receiving Faults](sending-and-receiving-faults.md).</span></span>  
  
#### <a name="soap-wsdl-and-interoperability-considerations"></a><span data-ttu-id="6799d-138">Požadavky SOAP, WSDL a interoperability</span><span class="sxs-lookup"><span data-stu-id="6799d-138">SOAP, WSDL, and Interoperability Considerations</span></span>  
 <span data-ttu-id="6799d-139">V některých případech, zejména při spolupráci s jinými platformami, může být důležité řídit způsob, jakým se chyba objevuje ve zprávě SOAP, nebo jak je popsáno v metadatech WSDL.</span><span class="sxs-lookup"><span data-stu-id="6799d-139">In some circumstances, especially when interoperating with other platforms, it may be important to control the way a fault appears in a SOAP message or the way it is described in the WSDL metadata.</span></span>  
  
 <span data-ttu-id="6799d-140">Atribut <xref:System.ServiceModel.FaultContractAttribute> má vlastnost <xref:System.ServiceModel.FaultContractAttribute.Name%2A>, která umožňuje řízení názvu elementu chyby WSDL, který je generován v metadatech této chyby.</span><span class="sxs-lookup"><span data-stu-id="6799d-140">The <xref:System.ServiceModel.FaultContractAttribute> attribute has a <xref:System.ServiceModel.FaultContractAttribute.Name%2A> property that allows control of the WSDL fault element name that is generated in the metadata for that fault.</span></span>  
  
 <span data-ttu-id="6799d-141">Podle standardu SOAP může chyba mít `Action`, `Code`a `Reason`.</span><span class="sxs-lookup"><span data-stu-id="6799d-141">According to the SOAP standard, a fault can have an `Action`, a `Code`, and a `Reason`.</span></span> <span data-ttu-id="6799d-142">`Action` řídí vlastnost <xref:System.ServiceModel.FaultContractAttribute.Action%2A>.</span><span class="sxs-lookup"><span data-stu-id="6799d-142">The `Action` is controlled by the <xref:System.ServiceModel.FaultContractAttribute.Action%2A> property.</span></span> <span data-ttu-id="6799d-143">Vlastnost <xref:System.ServiceModel.FaultException.Code%2A> a vlastnost <xref:System.ServiceModel.FaultException.Reason%2A> jsou obě vlastnosti třídy <xref:System.ServiceModel.FaultException?displayProperty=nameWithType>, která je nadřazenou třídou obecného <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6799d-143">The <xref:System.ServiceModel.FaultException.Code%2A> property and <xref:System.ServiceModel.FaultException.Reason%2A> property are both properties of the <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> class, which is the parent class of the generic <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType>.</span></span> <span data-ttu-id="6799d-144">Vlastnost `Code` obsahuje člena <xref:System.ServiceModel.FaultCode.SubCode%2A>.</span><span class="sxs-lookup"><span data-stu-id="6799d-144">The `Code` property includes a <xref:System.ServiceModel.FaultCode.SubCode%2A> member.</span></span>  
  
 <span data-ttu-id="6799d-145">Při přístupu k jiným než službám, které generují chyby, existují určitá omezení.</span><span class="sxs-lookup"><span data-stu-id="6799d-145">When accessing non-services that generate faults, certain limitations exist.</span></span> <span data-ttu-id="6799d-146">WCF podporuje pouze chyby s typy podrobností, které schéma popisuje a které jsou kompatibilní s kontrakty dat.</span><span class="sxs-lookup"><span data-stu-id="6799d-146">WCF supports only faults with detail types that the schema describes and that are compatible with data contracts.</span></span> <span data-ttu-id="6799d-147">Například jak je uvedeno výše, WCF nepodporuje chyby, které používají atributy XML v jejich typech podrobností, nebo chyby s více než jedním prvkem nejvyšší úrovně v sekci podrobností.</span><span class="sxs-lookup"><span data-stu-id="6799d-147">For example, as mentioned above, WCF does not support faults that use XML attributes in their detail types, or faults with more than one top-level element in the detail section.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6799d-148">Viz také:</span><span class="sxs-lookup"><span data-stu-id="6799d-148">See also</span></span>

- <xref:System.ServiceModel.FaultContractAttribute>
- <xref:System.Runtime.Serialization.DataContractAttribute>
- <xref:System.Runtime.Serialization.DataMemberAttribute>
- [<span data-ttu-id="6799d-149">Určování a zpracování chyb v kontraktech a službách</span><span class="sxs-lookup"><span data-stu-id="6799d-149">Specifying and Handling Faults in Contracts and Services</span></span>](specifying-and-handling-faults-in-contracts-and-services.md)
- [<span data-ttu-id="6799d-150">Chyby při odesílání a příjmu</span><span class="sxs-lookup"><span data-stu-id="6799d-150">Sending and Receiving Faults</span></span>](sending-and-receiving-faults.md)
- [<span data-ttu-id="6799d-151">Postupy: Deklarace chyb v kontraktech služeb</span><span class="sxs-lookup"><span data-stu-id="6799d-151">How to: Declare Faults in Service Contracts</span></span>](how-to-declare-faults-in-service-contracts.md)
- [<span data-ttu-id="6799d-152">Princip úrovně ochrany</span><span class="sxs-lookup"><span data-stu-id="6799d-152">Understanding Protection Level</span></span>](understanding-protection-level.md)
- [<span data-ttu-id="6799d-153">Postupy: Nastavení vlastnosti ProtectionLevel</span><span class="sxs-lookup"><span data-stu-id="6799d-153">How to: Set the ProtectionLevel Property</span></span>](how-to-set-the-protectionlevel-property.md)
- [<span data-ttu-id="6799d-154">Určování přenosu dat v kontraktech služby</span><span class="sxs-lookup"><span data-stu-id="6799d-154">Specifying Data Transfer in Service Contracts</span></span>](./feature-details/specifying-data-transfer-in-service-contracts.md)
