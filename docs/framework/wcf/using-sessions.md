---
title: Použití relací
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- sessions [WCF]
ms.assetid: 864ba12f-3331-4359-a359-6d6d387f1035
ms.openlocfilehash: 898e5688ae08a59415c8b3116665eec6cb4cf904
ms.sourcegitcommit: 4b6490b2529707627ad77c3a43fbe64120397175
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 09/10/2018
ms.locfileid: "44260201"
---
# <a name="using-sessions"></a><span data-ttu-id="df582-102">Použití relací</span><span class="sxs-lookup"><span data-stu-id="df582-102">Using Sessions</span></span>
<span data-ttu-id="df582-103">V aplikacích Windows Communication Foundation (WCF) *relace* koreluje skupinu zpráv do konverzace.</span><span class="sxs-lookup"><span data-stu-id="df582-103">In Windows Communication Foundation (WCF) applications, a *session* correlates a group of messages into a conversation.</span></span> <span data-ttu-id="df582-104">Relace WCF se liší od objekt relace, která je k dispozici v [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] aplikace podporují různé chování a se řídí různými způsoby.</span><span class="sxs-lookup"><span data-stu-id="df582-104">WCF sessions are different than the session object available in [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] applications, support different behaviors, and are controlled in different ways.</span></span> <span data-ttu-id="df582-105">Toto téma popisuje funkce, které umožňují relace ve službě WCF aplikací a jejich použití.</span><span class="sxs-lookup"><span data-stu-id="df582-105">This topic describes the features that sessions enable in WCF applications and how to use them.</span></span>  
  
## <a name="sessions-in-windows-communication-foundation-applications"></a><span data-ttu-id="df582-106">Relace v aplikacích Windows Communication Foundation</span><span class="sxs-lookup"><span data-stu-id="df582-106">Sessions in Windows Communication Foundation Applications</span></span>  
 <span data-ttu-id="df582-107">Pokud kontrakt služby specifikuje, že vyžaduje relaci, zda kontrakt je určení, že všechna volání (to znamená, základní výměny zpráv, které podporují volání) musí být součástí stejné konverzaci.</span><span class="sxs-lookup"><span data-stu-id="df582-107">When a service contract specifies that it requires a session, that contract is specifying that all calls (that is, the underlying message exchanges that support the calls) must be part of the same conversation.</span></span> <span data-ttu-id="df582-108">Pokud kontrakt Určuje, že umožňuje relace, ale nevyžaduje, aby jeden, klienti můžou připojit a buď vytvořit relaci nebo nelze navázat relaci.</span><span class="sxs-lookup"><span data-stu-id="df582-108">If a contract specifies that it allows sessions but does not require one, clients can connect and either establish a session or not establish a session.</span></span> <span data-ttu-id="df582-109">Pokud relace skončí a zpráva se odesílá prostřednictvím stejné kanál, který je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="df582-109">If the session ends and a message is sent through the same channel an exception is thrown.</span></span>  
  
 <span data-ttu-id="df582-110">Relace WCF mají koncepční následující hlavní funkce:</span><span class="sxs-lookup"><span data-stu-id="df582-110">WCF sessions have the following main conceptual features:</span></span>  
  
-   <span data-ttu-id="df582-111">Jsou explicitně zahájeno a ukončeno volající aplikace (klient WCF).</span><span class="sxs-lookup"><span data-stu-id="df582-111">They are explicitly initiated and terminated by the calling application (the WCF client).</span></span>  
  
-   <span data-ttu-id="df582-112">Zprávy doručí během relace se zpracovávají v pořadí, ve kterém jsou přijímány.</span><span class="sxs-lookup"><span data-stu-id="df582-112">Messages delivered during a session are processed in the order in which they are received.</span></span>  
  
-   <span data-ttu-id="df582-113">Relace je možné korelovat skupinu zpráv do konverzace.</span><span class="sxs-lookup"><span data-stu-id="df582-113">Sessions correlate a group of messages into a conversation.</span></span> <span data-ttu-id="df582-114">Různé druhy korelace jsou možné.</span><span class="sxs-lookup"><span data-stu-id="df582-114">Different types of correlation are possible.</span></span> <span data-ttu-id="df582-115">Například jeden kanál na základě relace mohou souviset zprávy založen na sdílených síťových připojení jiného kanálu založeného na relacích mohou souviset zprávy na základě sdílené značky v textu zprávy.</span><span class="sxs-lookup"><span data-stu-id="df582-115">For instance, one session-based channel may correlate messages based on a shared network connection while another session-based channel may correlate messages based on a shared tag in the message body.</span></span> <span data-ttu-id="df582-116">Funkce, které mohou být odvozeny z relace závisí na povaze korelace.</span><span class="sxs-lookup"><span data-stu-id="df582-116">The features that can be derived from the session depend on the nature of the correlation.</span></span>  
  
-   <span data-ttu-id="df582-117">Neexistuje žádné úložiště obecná data související s relací WCF.</span><span class="sxs-lookup"><span data-stu-id="df582-117">There is no general data store associated with a WCF session.</span></span>  
  
 <span data-ttu-id="df582-118">Pokud jste se seznámili s <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> třídy v [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] poskytuje aplikace a funkce, můžete si všimnout následující rozdíly mezi tento druh relace a relace WCF:</span><span class="sxs-lookup"><span data-stu-id="df582-118">If you are familiar with the <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> class in [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] applications and the functionality it provides, you might notice the following differences between that kind of session and WCF sessions:</span></span>  
  
-   [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]<span data-ttu-id="df582-119"> relace jsou vždy zahajované serverem.</span><span class="sxs-lookup"><span data-stu-id="df582-119"> sessions are always server-initiated.</span></span>  
  
-   [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]<span data-ttu-id="df582-120"> relace jsou implicitně Neseřazený.</span><span class="sxs-lookup"><span data-stu-id="df582-120"> sessions are implicitly unordered.</span></span>  
  
-   [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]<span data-ttu-id="df582-121"> relace poskytují mechanismus pro ukládání obecná data napříč požadavky.</span><span class="sxs-lookup"><span data-stu-id="df582-121"> sessions provide a general data storage mechanism across requests.</span></span>  
  
 <span data-ttu-id="df582-122">Toto téma popisuje:</span><span class="sxs-lookup"><span data-stu-id="df582-122">This topic describes:</span></span>  
  
-   <span data-ttu-id="df582-123">Výchozí spuštění chování při používání vazeb na základě relace v vrstva modelu služby.</span><span class="sxs-lookup"><span data-stu-id="df582-123">The default execution behavior when using session-based bindings in the service model layer.</span></span>  
  
-   <span data-ttu-id="df582-124">Typy funkcí, které poskytují vazby WCF na základě relace, poskytované systémem.</span><span class="sxs-lookup"><span data-stu-id="df582-124">The types of features that the WCF session-based, system-provided bindings provide.</span></span>  
  
-   <span data-ttu-id="df582-125">Postup vytvoření kontrakt, který deklaruje požadavek relace.</span><span class="sxs-lookup"><span data-stu-id="df582-125">How to create a contract that declares a session requirement.</span></span>  
  
-   <span data-ttu-id="df582-126">Jak pochopit a řídit vytváření a ukončení relace a relace relace v instanci služby.</span><span class="sxs-lookup"><span data-stu-id="df582-126">How to understand and control the creation and termination of the session and the relationship of the session to the service instance.</span></span>  
  
## <a name="default-execution-behavior-using-sessions"></a><span data-ttu-id="df582-127">Výchozí spuštění chování pomocí relace</span><span class="sxs-lookup"><span data-stu-id="df582-127">Default Execution Behavior Using Sessions</span></span>  
 <span data-ttu-id="df582-128">Je volána vazbu, která se pokusí o zahájení relace *založeného na relacích* vazby.</span><span class="sxs-lookup"><span data-stu-id="df582-128">A binding that attempts to initiate a session is called a *session-based* binding.</span></span> <span data-ttu-id="df582-129">Kontrakty služeb zadat, že se vyžadují, povolit nebo odmítnout založeného na relacích vazby tak, že nastavíte <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> vlastnosti rozhraní kontraktu služby (nebo třídy) do jednoho z <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> hodnot výčtu.</span><span class="sxs-lookup"><span data-stu-id="df582-129">Service contracts specify that they require, permit, or refuse session-based bindings by setting the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property on the service contract interface (or class) to one of the <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> enumeration values.</span></span> <span data-ttu-id="df582-130">Výchozí hodnota této vlastnosti je <xref:System.ServiceModel.SessionMode.Allowed>, což znamená, že pokud klient používá vazbu na základě relace s implementací služby WCF, služba vytvoří a používá poskytnutou relaci.</span><span class="sxs-lookup"><span data-stu-id="df582-130">By default, the value of this property is <xref:System.ServiceModel.SessionMode.Allowed>, which means that if a client uses a session-based binding with a WCF service implementation, the service establishes and uses the session provided.</span></span>  
  
 <span data-ttu-id="df582-131">Když služba WCF přijímá klientské relace, jsou ve výchozím nastavení povoleny následující funkce:</span><span class="sxs-lookup"><span data-stu-id="df582-131">When a WCF service accepts a client session, the following features are enabled by default:</span></span>  
  
1.  <span data-ttu-id="df582-132">Všechna volání mezi objekt klienta WCF jsou zpracovávány stejné instance služby.</span><span class="sxs-lookup"><span data-stu-id="df582-132">All calls between a WCF client object are handled by the same service instance.</span></span>  
  
2.  <span data-ttu-id="df582-133">Různé na základě relace vazby poskytují další funkce.</span><span class="sxs-lookup"><span data-stu-id="df582-133">Different session-based bindings provide additional features.</span></span>  
  
## <a name="system-provided-session-types"></a><span data-ttu-id="df582-134">Typy poskytované systémem relace</span><span class="sxs-lookup"><span data-stu-id="df582-134">System-Provided Session Types</span></span>  
 <span data-ttu-id="df582-135">Vazba na základě relace podporuje výchozí přidružení instance služby s konkrétní relací.</span><span class="sxs-lookup"><span data-stu-id="df582-135">A session-based binding supports the default association of a service instance with a particular session.</span></span> <span data-ttu-id="df582-136">Různé na základě relace vazby však podporují různé funkce kromě povolení založeného na relacích vytvoření instance ovládacího prvku popsaných výše.</span><span class="sxs-lookup"><span data-stu-id="df582-136">However, different session-based bindings support different features in addition to enabling the session-based instancing control previously described.</span></span>  
  
 <span data-ttu-id="df582-137">WCF poskytuje následující typy chování na základě relace aplikace:</span><span class="sxs-lookup"><span data-stu-id="df582-137">WCF provides the following types of session-based application behavior:</span></span>  
  
-   <span data-ttu-id="df582-138"><xref:System.ServiceModel.Channels.SecurityBindingElement?displayProperty=nameWithType> Podporuje zabezpečení na základě relací, ve kterých oba konce komunikace dohodnutých konkrétní zabezpečené konverzace.</span><span class="sxs-lookup"><span data-stu-id="df582-138">The <xref:System.ServiceModel.Channels.SecurityBindingElement?displayProperty=nameWithType> supports security-based sessions, in which both ends of communication have agreed upon a specific secure conversation.</span></span> <span data-ttu-id="df582-139">Další informace najdete v tématu [zabezpečení služby](../../../docs/framework/wcf/securing-services.md).</span><span class="sxs-lookup"><span data-stu-id="df582-139">For more information, see [Securing Services](../../../docs/framework/wcf/securing-services.md).</span></span> <span data-ttu-id="df582-140">Například <xref:System.ServiceModel.WSHttpBinding?displayProperty=nameWithType> vazby, který obsahuje podporu pro relace zabezpečení a spolehlivé relace, ve výchozím nastavení používá pouze zabezpečenou relaci, která šifruje a digitálně podepisuje zprávy.</span><span class="sxs-lookup"><span data-stu-id="df582-140">For example, the <xref:System.ServiceModel.WSHttpBinding?displayProperty=nameWithType> binding, which contains support for both security sessions and reliable sessions, by default uses only a secure session that encrypts and digitally signs messages.</span></span>  
  
-   <span data-ttu-id="df582-141"><xref:System.ServiceModel.NetTcpBinding?displayProperty=nameWithType> Vazba podporuje relace založené na TCP/IP k zajištění, že všechny zprávy se korelují připojení na úrovni soketu.</span><span class="sxs-lookup"><span data-stu-id="df582-141">The <xref:System.ServiceModel.NetTcpBinding?displayProperty=nameWithType> binding supports TCP/IP-based sessions to ensure that all messages are correlated by the connection at the socket level.</span></span>  
  
-   <span data-ttu-id="df582-142"><xref:System.ServiceModel.Channels.ReliableSessionBindingElement?displayProperty=nameWithType> Element, který implementuje specifikaci WS-ReliableMessaging, poskytuje podporu pro spolehlivé relace, ve kterých lze nakonfigurovat zprávy pro doručeny v pořadí a přesně jednou, zajištění jsou zprávy přijímány i v případě, že zprávy mezi více uzlů během konverzace.</span><span class="sxs-lookup"><span data-stu-id="df582-142">The <xref:System.ServiceModel.Channels.ReliableSessionBindingElement?displayProperty=nameWithType> element, which implements the WS-ReliableMessaging specification, provides support for reliable sessions in which messages can be configured to be delivered in order and exactly once, ensuring messages are received even when messages travel across multiple nodes during the conversation.</span></span> <span data-ttu-id="df582-143">Další informace najdete v tématu [spolehlivé relace](../../../docs/framework/wcf/feature-details/reliable-sessions.md).</span><span class="sxs-lookup"><span data-stu-id="df582-143">For more information, see [Reliable Sessions](../../../docs/framework/wcf/feature-details/reliable-sessions.md).</span></span>  
  
-   <span data-ttu-id="df582-144"><xref:System.ServiceModel.NetMsmqBinding?displayProperty=nameWithType> Vazby poskytuje relace datagramem MSMQ.</span><span class="sxs-lookup"><span data-stu-id="df582-144">The <xref:System.ServiceModel.NetMsmqBinding?displayProperty=nameWithType> binding provides MSMQ datagram sessions.</span></span> <span data-ttu-id="df582-145">Další informace najdete v tématu [fronty ve WCF](../../../docs/framework/wcf/feature-details/queues-in-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="df582-145">For more information, see [Queues in WCF](../../../docs/framework/wcf/feature-details/queues-in-wcf.md).</span></span>  
  
 <span data-ttu-id="df582-146">Nastavení <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> vlastnost neurčuje typ relace kontrakt vyžaduje, jenom se vyžaduje jednu.</span><span class="sxs-lookup"><span data-stu-id="df582-146">Setting the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> property does not specify the type of session the contract requires, only that it requires one.</span></span>  
  
## <a name="creating-a-contract-that-requires-a-session"></a><span data-ttu-id="df582-147">Vytvoření smlouvy, která vyžaduje relaci</span><span class="sxs-lookup"><span data-stu-id="df582-147">Creating a Contract That Requires a Session</span></span>  
 <span data-ttu-id="df582-148">Vytvoření smlouvy, která vyžaduje že relaci hlásí, že skupiny operací, které deklaruje kontraktu služby se musí všechny provádět v rámci stejné relace se, že zprávy musí být dodávány v určitém pořadí.</span><span class="sxs-lookup"><span data-stu-id="df582-148">Creating a contract that requires a session states that the group of operations that the service contract declares must all be executed within the same session and that messages must be delivered in order.</span></span> <span data-ttu-id="df582-149">K vyhodnocení úrovně podporu relací, která vyžaduje kontraktu služby, nastavte <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> vlastnosti rozhraní kontraktu služby nebo třídy do hodnoty vlastnosti <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> výčet k určení, zda kontrakt:</span><span class="sxs-lookup"><span data-stu-id="df582-149">To assert the level of session support that a service contract requires, set the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property on your service contract interface or class to the value of the <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> enumeration to specify whether the contract:</span></span>  
  
-   <span data-ttu-id="df582-150">Vyžaduje relaci.</span><span class="sxs-lookup"><span data-stu-id="df582-150">Requires a session.</span></span>  
  
-   <span data-ttu-id="df582-151">Umožňuje klientům navázat relaci.</span><span class="sxs-lookup"><span data-stu-id="df582-151">Allows a client to establish a session.</span></span>  
  
-   <span data-ttu-id="df582-152">Zakazuje relace.</span><span class="sxs-lookup"><span data-stu-id="df582-152">Prohibits a session.</span></span>  
  
 <span data-ttu-id="df582-153">Nastavení <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> vlastnosti však neurčuje typu založeného na relacích chování kontrakt vyžaduje.</span><span class="sxs-lookup"><span data-stu-id="df582-153">Setting the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> property does not, however, specify the type of session-based behavior the contract requires.</span></span> <span data-ttu-id="df582-154">Nastaví WCF potvrďte za běhu, která nakonfigurovaná vazba (která vytvoří komunikační kanál) pro službu nemá, nikoli nebo můžete vytvořit relaci při implementaci služby.</span><span class="sxs-lookup"><span data-stu-id="df582-154">It instructs WCF to confirm at runtime that the configured binding (which creates the communication channel) for the service does, does not, or can establish a session when implementing a service.</span></span> <span data-ttu-id="df582-155">Znovu, lze vazbu splňují tento požadavek s žádným typem chování na základě relace zvolí – zabezpečení, přenosu, spolehlivým nebo jejich kombinaci.</span><span class="sxs-lookup"><span data-stu-id="df582-155">Again, the binding can satisfy that requirement with any type of session-based behavior it chooses—security, transport, reliable, or some combination.</span></span> <span data-ttu-id="df582-156">Přesné chování závisí <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> vybraná hodnota.</span><span class="sxs-lookup"><span data-stu-id="df582-156">The exact behavior depends on the <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> value selected.</span></span> <span data-ttu-id="df582-157">Pokud nakonfigurovanou vazbu služby není v souladu s hodnotu <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A>, je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="df582-157">If the configured binding of the service does not conform to the value of <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A>, an exception is thrown.</span></span> <span data-ttu-id="df582-158">Vazby a kanály, které vytvářejí, že podpora relací se označují jako založeného na relacích.</span><span class="sxs-lookup"><span data-stu-id="df582-158">Bindings and the channels they create that support sessions are said to be session-based.</span></span>  
  
 <span data-ttu-id="df582-159">Následující kontrakt služby specifikuje, že všechny operace `ICalculatorSession` musí bude vyměněn v rámci relace.</span><span class="sxs-lookup"><span data-stu-id="df582-159">The following service contract specifies that all operations in the `ICalculatorSession` must be exchanged within a session.</span></span> <span data-ttu-id="df582-160">Žádná z operací vrací hodnotu volajícímu s výjimkou `Equals` metody.</span><span class="sxs-lookup"><span data-stu-id="df582-160">None of the operations returns a value to the caller except the `Equals` method.</span></span> <span data-ttu-id="df582-161">Ale `Equals` metoda nepřijímá žádné parametry a proto může vrátit pouze nenulové hodnoty uvnitř relace, ve kterém datového již byl předán jiné operace.</span><span class="sxs-lookup"><span data-stu-id="df582-161">However, the `Equals` method takes no parameters and, therefore, can only return a non-zero value inside a session in which data has already been passed to the other operations.</span></span> <span data-ttu-id="df582-162">Tato smlouva vyžaduje relaci fungovat správně.</span><span class="sxs-lookup"><span data-stu-id="df582-162">This contract requires a session to function properly.</span></span> <span data-ttu-id="df582-163">Bez relace spojené s konkrétního klienta instance služby nemá možnost nijak zjistit, co předchozí data tohoto klienta odeslal.</span><span class="sxs-lookup"><span data-stu-id="df582-163">Without a session associated with a specific client, the service instance has no way of knowing what previous data this client has sent.</span></span>  
  
 [!code-csharp[S_Service_Session#1](../../../samples/snippets/csharp/VS_Snippets_CFX/s_service_session/cs/service.cs#1)]
 [!code-vb[S_Service_Session#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/s_service_session/vb/service.vb#1)]  
  
 <span data-ttu-id="df582-164">Pokud služba umožňuje relaci, pak relace je vytvořeno a použít iniciuje-li klienta. v opačném případě není třeba vytvořit relaci.</span><span class="sxs-lookup"><span data-stu-id="df582-164">If a service allows a session, then a session is established and used if the client initiates one; otherwise, no session is established.</span></span>  
  
## <a name="sessions-and-service-instances"></a><span data-ttu-id="df582-165">Relace a instance služby</span><span class="sxs-lookup"><span data-stu-id="df582-165">Sessions and Service Instances</span></span>  
 <span data-ttu-id="df582-166">Pokud používáte výchozí chování ve službě WCF vytváření instancí, jsou všechna volání mezi objekt klienta WCF zpracovat stejné instance služby.</span><span class="sxs-lookup"><span data-stu-id="df582-166">If you use the default instancing behavior in WCF, all calls between a WCF client object are handled by the same service instance.</span></span> <span data-ttu-id="df582-167">Proto na úrovni aplikace si můžete představit jako povolení chování aplikace, podobně jako na místní volání chování relace.</span><span class="sxs-lookup"><span data-stu-id="df582-167">Therefore, at the application level, you can think of a session as enabling application behavior similar to local call behavior.</span></span> <span data-ttu-id="df582-168">Když například vytvoříte místní objekt:</span><span class="sxs-lookup"><span data-stu-id="df582-168">For example, when you create a local object:</span></span>  
  
-   <span data-ttu-id="df582-169">Je volána konstruktor.</span><span class="sxs-lookup"><span data-stu-id="df582-169">A constructor is called.</span></span>  
  
-   <span data-ttu-id="df582-170">Všechny následné volání odkaz na objekt klienta WCF jsou zpracovány stejná instance objektu.</span><span class="sxs-lookup"><span data-stu-id="df582-170">All subsequent calls made to the WCF client object reference are processed by the same object instance.</span></span>  
  
-   <span data-ttu-id="df582-171">Destruktor se volá, když odkaz na objekt je zničen.</span><span class="sxs-lookup"><span data-stu-id="df582-171">A destructor is called when the object reference is destroyed.</span></span>  
  
 <span data-ttu-id="df582-172">Relace povolit podobné chování mezi klienty a služby, tak dlouho, dokud se použije výchozí chování instance služby.</span><span class="sxs-lookup"><span data-stu-id="df582-172">Sessions enable a similar behavior between clients and services as long as the default service instance behavior is used.</span></span> <span data-ttu-id="df582-173">Pokud kontrakt služby požaduje nebo podporuje relací, jednu nebo více operací smlouvy může být označený jako inicializace nebo ukončení relace tak, že nastavíte <xref:System.ServiceModel.OperationContractAttribute.IsInitiating%2A> a <xref:System.ServiceModel.OperationContractAttribute.IsTerminating%2A> vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="df582-173">If a service contract requires or supports sessions, one or more contract operations can be marked as initiating or terminating a session by setting the <xref:System.ServiceModel.OperationContractAttribute.IsInitiating%2A> and <xref:System.ServiceModel.OperationContractAttribute.IsTerminating%2A> properties.</span></span>  
  
 <span data-ttu-id="df582-174">*Zahajuje se operace* jsou ty, které musí být volána jako první operace novou relaci.</span><span class="sxs-lookup"><span data-stu-id="df582-174">*Initiating operations* are those that must be called as the first operation of a new session.</span></span> <span data-ttu-id="df582-175">Bez zahájení operace lze volat pouze po zavolání alespoň jednu operaci zahájil.</span><span class="sxs-lookup"><span data-stu-id="df582-175">Non-initiating operations can be called only after at least one initiating operation has been called.</span></span> <span data-ttu-id="df582-176">Proto můžete vytvořit typ konstruktoru relace pro vaši službu deklarováním zahájení operace, které jsou navržené tak, aby vstupní od klientů, třeba na začátek instance služby.</span><span class="sxs-lookup"><span data-stu-id="df582-176">You can therefore create a kind of session constructor for your service by declaring initiating operations designed to take input from clients appropriate to the beginning of the service instance.</span></span> <span data-ttu-id="df582-177">(Stav je přiřazený k této relaci, ale a nikoli objekt služby).</span><span class="sxs-lookup"><span data-stu-id="df582-177">(The state is associated with the session, however, and not the service object.)</span></span>  
  
 <span data-ttu-id="df582-178">*Operace se ukončuje*, a naopak, jsou ty, které musí být volána jako poslední zprávy v existující relaci.</span><span class="sxs-lookup"><span data-stu-id="df582-178">*Terminating operations*, conversely, are those that must be called as the last message in an existing session.</span></span> <span data-ttu-id="df582-179">Ve výchozím nastavení recykluje WCF objektu služby a její kontext po zavření relace, pomocí kterého byl k službě.</span><span class="sxs-lookup"><span data-stu-id="df582-179">In the default case, WCF recycles the service object and its context after the session with which the service was associated is closed.</span></span> <span data-ttu-id="df582-180">Druh destruktor můžete vytvořit proto deklarováním ukončující operace lze provádět na konec instance služby příslušné funkce.</span><span class="sxs-lookup"><span data-stu-id="df582-180">You can, therefore, create a kind of destructor by declaring terminating operations designed to perform a function appropriate to the end of the service instance.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="df582-181">I když výchozí chování je velmi podobný místní konstruktory a destruktory, je pouze velmi podobný.</span><span class="sxs-lookup"><span data-stu-id="df582-181">Although the default behavior bears a resemblance to local constructors and destructors, it is only a resemblance.</span></span> <span data-ttu-id="df582-182">Inicializaci ukončující operaci nebo obojí ve stejnou dobu může být žádné operaci služby WCF.</span><span class="sxs-lookup"><span data-stu-id="df582-182">Any WCF service operation can be an initiating or terminating operation, or both at the same time.</span></span> <span data-ttu-id="df582-183">Kromě toho ve výchozím nastavení, zahajuje se operace lze volat libovolný počet v libovolném pořadí; Vytvoří se žádné další relace, jakmile je vytvořeno a přidružené instance, pokud explicitně řídit dobu života instance služby relace (manipulací <xref:System.ServiceModel.InstanceContext?displayProperty=nameWithType> objekt).</span><span class="sxs-lookup"><span data-stu-id="df582-183">In addition, in the default case, initiating operations can be called any number of times in any order; no additional sessions are created once the session is established and associated with an instance unless you explicitly control the lifetime of the service instance (by manipulating the <xref:System.ServiceModel.InstanceContext?displayProperty=nameWithType> object).</span></span> <span data-ttu-id="df582-184">A konečně stav je přidružená relace a nikoli objekt služby.</span><span class="sxs-lookup"><span data-stu-id="df582-184">Finally, the state is associated with the session and not the service object.</span></span>  
  
 <span data-ttu-id="df582-185">Například `ICalculatorSession` smlouva použitých v předchozím příkladu vyžaduje, že klient WCF objektu první volání `Clear` operaci před žádné jiné operace a že relace s tímto objektem klienta WCF by měla ukončit při volání `Equals` operace.</span><span class="sxs-lookup"><span data-stu-id="df582-185">For example, the `ICalculatorSession` contract used in the preceding example requires that the WCF client object first call the `Clear` operation prior to any other operation and that the session with this WCF client object should terminate when it calls the `Equals` operation.</span></span> <span data-ttu-id="df582-186">Následující příklad kódu ukazuje kontrakt, který vynucuje tyto požadavky.</span><span class="sxs-lookup"><span data-stu-id="df582-186">The following code example shows a contract that enforces these requirements.</span></span> <span data-ttu-id="df582-187">`Clear` musí být nejdříve volána k zahájení relace, a že ukončení relace při `Equals` je volána.</span><span class="sxs-lookup"><span data-stu-id="df582-187">`Clear` must be called first to initiate a session, and that session ends when `Equals` is called.</span></span>  
  
 [!code-csharp[SCA.IsInitiatingIsTerminating#1](../../../samples/snippets/csharp/VS_Snippets_CFX/sca.isinitiatingisterminating/cs/service.cs#1)]
 [!code-vb[SCA.IsInitiatingIsTerminating#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/sca.isinitiatingisterminating/vb/service.vb#1)]  
  
 <span data-ttu-id="df582-188">Služba spuštěna relace s klienty.</span><span class="sxs-lookup"><span data-stu-id="df582-188">Services do not start sessions with clients.</span></span> <span data-ttu-id="df582-189">V klientských aplikací WCF přímý vztah existuje mezi dobu platnosti kanálu založeného na relacích a životnost relace samotný.</span><span class="sxs-lookup"><span data-stu-id="df582-189">In WCF client applications, a direct relationship exists between the lifetime of the session-based channel and the lifetime of the session itself.</span></span> <span data-ttu-id="df582-190">V důsledku toho klienti vytvoření nové relace tak, že vytvoříte nové kanály na základě relace a odstraňovat existující relace ukončením založeného na relacích kanály bez výpadku.</span><span class="sxs-lookup"><span data-stu-id="df582-190">As such, clients create new sessions by creating new session-based channels and tear down existing sessions by closing session-based channels gracefully.</span></span> <span data-ttu-id="df582-191">Klient spustí relaci s koncovým bodem služby voláním jedné z následujících akcí:</span><span class="sxs-lookup"><span data-stu-id="df582-191">A client starts a session with a service endpoint by calling one of the following:</span></span>  
  
-   <span data-ttu-id="df582-192"><xref:System.ServiceModel.ICommunicationObject.Open%2A?displayProperty=nameWithType> na kanálu vrácené voláním <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="df582-192"><xref:System.ServiceModel.ICommunicationObject.Open%2A?displayProperty=nameWithType> on the channel returned by a call to <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>.</span></span>  
  
-   <span data-ttu-id="df582-193"><xref:System.ServiceModel.ClientBase%601.Open%2A?displayProperty=nameWithType> u objektu klienta WCF generovaných [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span><span class="sxs-lookup"><span data-stu-id="df582-193"><xref:System.ServiceModel.ClientBase%601.Open%2A?displayProperty=nameWithType> on the WCF client object generated by the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span></span>  
  
-   <span data-ttu-id="df582-194">Zahájení operace na buď typ objektu klienta WCF (ve výchozím nastavení, všechny operace iniciují).</span><span class="sxs-lookup"><span data-stu-id="df582-194">An initiating operation on either type of WCF client object (by default, all operations are initiating).</span></span> <span data-ttu-id="df582-195">Při první operace je volána, objekt klienta WCF se automaticky otevře kanál a spustí relaci.</span><span class="sxs-lookup"><span data-stu-id="df582-195">When the first operation is called, the WCF client object automatically opens the channel and initiates a session.</span></span>  
  
 <span data-ttu-id="df582-196">Obvykle klient ukončí relaci s koncovým bodem služby voláním jedné z následujících akcí:</span><span class="sxs-lookup"><span data-stu-id="df582-196">Typically a client ends a session with a service endpoint by calling one of the following:</span></span>  
  
-   <span data-ttu-id="df582-197"><xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType> na kanálu vrácené voláním <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="df582-197"><xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType> on the channel returned by a call to <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>.</span></span>  
  
-   <span data-ttu-id="df582-198"><xref:System.ServiceModel.ClientBase%601.Close%2A?displayProperty=nameWithType> u objektu klienta WCF generovaných Svcutil.exe.</span><span class="sxs-lookup"><span data-stu-id="df582-198"><xref:System.ServiceModel.ClientBase%601.Close%2A?displayProperty=nameWithType> on the WCF client object generated by Svcutil.exe.</span></span>  
  
-   <span data-ttu-id="df582-199">Ukončující operace na buď typ objektu klienta WCF (ve výchozím nastavení, se ukončuje žádné operace, kontrakt musíte explicitně zadat ukončující operace).</span><span class="sxs-lookup"><span data-stu-id="df582-199">A terminating operation on either type of WCF client object (by default, no operations are terminating; the contract must explicitly specify a terminating operation).</span></span> <span data-ttu-id="df582-200">Při první operace je volána, objekt klienta WCF se automaticky otevře kanál a spustí relaci.</span><span class="sxs-lookup"><span data-stu-id="df582-200">When the first operation is called, the WCF client object automatically opens the channel and initiates a session.</span></span>  
  
 <span data-ttu-id="df582-201">Příklady najdete v tématu [postupy: vytváření služba, vyžaduje relací](../../../docs/framework/wcf/feature-details/how-to-create-a-service-that-requires-sessions.md) také [výchozí chování služby](../../../docs/framework/wcf/samples/default-service-behavior.md) a [Instancing](../../../docs/framework/wcf/samples/instancing.md) ukázky.</span><span class="sxs-lookup"><span data-stu-id="df582-201">For examples, see [How to: Create a Service That Requires Sessions](../../../docs/framework/wcf/feature-details/how-to-create-a-service-that-requires-sessions.md) as well as the [Default Service Behavior](../../../docs/framework/wcf/samples/default-service-behavior.md) and [Instancing](../../../docs/framework/wcf/samples/instancing.md) samples.</span></span>  
  
 <span data-ttu-id="df582-202">Další informace o klientech a relace najdete v tématu [přístup ke službám pomocí klienta WCF](../../../docs/framework/wcf/feature-details/accessing-services-using-a-client.md).</span><span class="sxs-lookup"><span data-stu-id="df582-202">For more information about clients and sessions, see [Accessing Services Using a WCF Client](../../../docs/framework/wcf/feature-details/accessing-services-using-a-client.md).</span></span>  
  
## <a name="sessions-interact-with-instancecontext-settings"></a><span data-ttu-id="df582-203">Relace interakci s InstanceContext nastavení</span><span class="sxs-lookup"><span data-stu-id="df582-203">Sessions Interact with InstanceContext Settings</span></span>  
 <span data-ttu-id="df582-204">Je interakce mezi <xref:System.ServiceModel.SessionMode> výčtu v kontraktu a <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> vlastnost, která řídí přidružení mezi kanály a konkrétní objekty.</span><span class="sxs-lookup"><span data-stu-id="df582-204">There is an interaction between the <xref:System.ServiceModel.SessionMode> enumeration in a contract and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property, which controls the association between channels and specific service objects.</span></span> <span data-ttu-id="df582-205">Další informace najdete v tématu [relací, Instancing a souběžnosti](../../../docs/framework/wcf/feature-details/sessions-instancing-and-concurrency.md).</span><span class="sxs-lookup"><span data-stu-id="df582-205">For more information, see [Sessions, Instancing, and Concurrency](../../../docs/framework/wcf/feature-details/sessions-instancing-and-concurrency.md).</span></span>  
  
### <a name="sharing-instancecontext-objects"></a><span data-ttu-id="df582-206">Třída InstanceContext objekty pro sdílení obsahu</span><span class="sxs-lookup"><span data-stu-id="df582-206">Sharing InstanceContext Objects</span></span>  
 <span data-ttu-id="df582-207">Můžete taky řídit, které využívají relace kanálu nebo volání je přidružený k který <xref:System.ServiceModel.InstanceContext> objektu pomocí provádí toto přidružení se sami.</span><span class="sxs-lookup"><span data-stu-id="df582-207">You can also control which session-based channel or call is associated with which <xref:System.ServiceModel.InstanceContext> object by performing that association yourself.</span></span> <span data-ttu-id="df582-208">Kompletní příklad naleznete v tématu [InstanceContextSharing](https://msdn.microsoft.com/library/4a6a46d7-b7d7-4bb5-a0dd-03ffa3cbc230).</span><span class="sxs-lookup"><span data-stu-id="df582-208">For a complete example, see [InstanceContextSharing](https://msdn.microsoft.com/library/4a6a46d7-b7d7-4bb5-a0dd-03ffa3cbc230).</span></span>  
  
## <a name="sessions-and-streaming"></a><span data-ttu-id="df582-209">Relace a streamování</span><span class="sxs-lookup"><span data-stu-id="df582-209">Sessions and Streaming</span></span>  
 <span data-ttu-id="df582-210">Pokud máte velký objem přenášených dat, je režim tvorby datového proudu přenosu ve službě WCF proveditelné alternativou k výchozí chování ukládání do vyrovnávací paměti a zpracování zpráv v paměti jako celek.</span><span class="sxs-lookup"><span data-stu-id="df582-210">When you have a large amount of data to transfer, the streaming transfer mode in WCF is a feasible alternative to the default behavior of buffering and processing messages in memory in their entirety.</span></span> <span data-ttu-id="df582-211">Můžete obdržet neočekávané chování při streamování volání s vazbou na základě relace.</span><span class="sxs-lookup"><span data-stu-id="df582-211">You may get unexpected behavior when streaming calls with a session-based binding.</span></span> <span data-ttu-id="df582-212">Všechna volání streamování se provádějí přes jeden kanál (kanálu datagramu), který nepodporuje relace, i v případě, že vazba používá je nakonfigurována pro použití relací.</span><span class="sxs-lookup"><span data-stu-id="df582-212">All streaming calls are made through a single channel (the datagram channel) that does not support sessions even if the binding being used is configured to use sessions.</span></span> <span data-ttu-id="df582-213">Pokud více klientů volání datových proudů na stejný objekt služby přes vazbu na základě relace, a objekt služby souběžný režim je nastavena na jednou a jeho režimu instance kontextu je nastavena na `PerSession`, kanálu datagramu a proto musí projít všechna volání současně je zpracována pouze jedno volání.</span><span class="sxs-lookup"><span data-stu-id="df582-213">If multiple clients make streaming calls to the same service object over a session-based binding, and the service object's concurrency mode is set to single and its instance context mode is set to `PerSession`, all calls must go through the datagram channel and so only one call is processed at a time.</span></span> <span data-ttu-id="df582-214">Jeden nebo více klientů může potom vypršení časového limitu. Tento problém můžete obejít tak, že nastavíte objekt služby `InstanceContextMode` k `PerCall` nebo souběžnost více.</span><span class="sxs-lookup"><span data-stu-id="df582-214">One or more clients may then time out. You can work around this issue by either setting the service object's `InstanceContextMode` to `PerCall` or Concurrency to multiple.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="df582-215">MaxConcurrentSessions nemají žádný vliv v tomto případě, protože není k dispozici pouze jeden "relace".</span><span class="sxs-lookup"><span data-stu-id="df582-215">MaxConcurrentSessions have no effect in this case because there is only one "session" available.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="df582-216">Viz také</span><span class="sxs-lookup"><span data-stu-id="df582-216">See Also</span></span>  
 <xref:System.ServiceModel.OperationContractAttribute.IsInitiating%2A>  
 <xref:System.ServiceModel.OperationContractAttribute.IsTerminating%2A>
