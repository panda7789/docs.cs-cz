---
title: Řízení spotřeby prostředků a zlepšení výkonu
ms.date: 03/30/2017
ms.assetid: 9a829669-5f76-4c88-80ec-92d0c62c0660
ms.openlocfilehash: 1e0512ce62f5a7b25546e8824a745fdaabb5ec72
ms.sourcegitcommit: efff8f331fd9467f093f8ab8d23a203d6ecb5b60
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 09/01/2018
ms.locfileid: "43397872"
---
# <a name="controlling-resource-consumption-and-improving-performance"></a><span data-ttu-id="6f02a-102">Řízení spotřeby prostředků a zlepšení výkonu</span><span class="sxs-lookup"><span data-stu-id="6f02a-102">Controlling Resource Consumption and Improving Performance</span></span>
<span data-ttu-id="6f02a-103">Toto téma popisuje různé vlastnosti v různých oblastech Architektura Windows Communication Foundation (WCF), které fungují při řízení spotřeby prostředků a ovlivňují metrik výkonu.</span><span class="sxs-lookup"><span data-stu-id="6f02a-103">This topic describes various properties in different areas of the Windows Communication Foundation (WCF) architecture that work to control resource consumption and affect performance metrics.</span></span>

## <a name="properties-that-constrain-resource-consumption-in-wcf"></a><span data-ttu-id="6f02a-104">Vlastnosti, které se omezila využití prostředků ve službě WCF</span><span class="sxs-lookup"><span data-stu-id="6f02a-104">Properties that Constrain Resource Consumption in WCF</span></span>
 <span data-ttu-id="6f02a-105">Windows Communication Foundation (WCF) platí omezení na určitých typech procesy pro účely zabezpečení ani výkon.</span><span class="sxs-lookup"><span data-stu-id="6f02a-105">Windows Communication Foundation (WCF) applies constraints on certain types of processes for either security or performance purposes.</span></span> <span data-ttu-id="6f02a-106">Tato omezení se dělí na dvě hlavní formulář, kvóty a omezení.</span><span class="sxs-lookup"><span data-stu-id="6f02a-106">These constraints come in two main forms, either quotas and throttles.</span></span> <span data-ttu-id="6f02a-107">*Kvóty* jsou omezení, která při dosáhlo nebo došlo k překročení spuštění okamžité výjimky v určitém okamžiku v systému.</span><span class="sxs-lookup"><span data-stu-id="6f02a-107">*Quotas* are limits that when reached or exceeded trigger an immediate exception at some point in the system.</span></span> <span data-ttu-id="6f02a-108">*Omezí* jsou omezení, která okamžitě nevyvolá výjimku, která je vyvolána.</span><span class="sxs-lookup"><span data-stu-id="6f02a-108">*Throttles* are limits that do not immediately cause an exception to be thrown.</span></span> <span data-ttu-id="6f02a-109">Místo toho při dosažení limitu omezení zpracování bude pokračovat, ale v rámci omezení nastavit hodnotu tohoto omezení.</span><span class="sxs-lookup"><span data-stu-id="6f02a-109">Instead, when a throttle limit is reached, processing continues but within the limits set by that throttle value.</span></span> <span data-ttu-id="6f02a-110">Tato omezená zpracování může aktivovat výjimku jinde, ale to závisí na aplikaci.</span><span class="sxs-lookup"><span data-stu-id="6f02a-110">This limited processing might trigger an exception elsewhere, but this depends upon the application.</span></span>

 <span data-ttu-id="6f02a-111">Kromě rozdílu mezi kvóty a omezení některé omezující vlastnosti jsou umístěné na úrovni serializace, některé na úrovni přenosu a některé na úrovni aplikace.</span><span class="sxs-lookup"><span data-stu-id="6f02a-111">In addition to the distinction between quotas and throttles, some constraining properties are located at the serialization level, some at the transport level, and some at the application level.</span></span> <span data-ttu-id="6f02a-112">Například kvóty <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>, které je implementované všechny elementy vazby přenosu poskytnuté systémem, je 65 536 bajtů ve výchozím nastavení brání škodlivým klientů ze smluvních denial-of-service útoků, které služba způsobením využívala příliš mnoho paměti Spotřeba.</span><span class="sxs-lookup"><span data-stu-id="6f02a-112">For example, the quota <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>, which is implemented by all system-supplied transport binding elements, is set to 65,536 bytes by default to hinder malicious clients from engaging in denial-of-service attacks against a service by causing excessive memory consumption.</span></span> <span data-ttu-id="6f02a-113">(Obvykle můžete zvýšit výkon snížením tuto hodnotu.)</span><span class="sxs-lookup"><span data-stu-id="6f02a-113">(Typically, you can increase performance by lowering this value.)</span></span>

 <span data-ttu-id="6f02a-114">Příklad kvótu serializace je <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> vlastnost, která určuje maximální počet objektů, které serializátoru, který serializuje a deserializuje v jediném <xref:System.Runtime.Serialization.DataContractSerializer.ReadObject%2A> volání metody.</span><span class="sxs-lookup"><span data-stu-id="6f02a-114">An example of a serialization quota is the <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property, which specifies the maximum number of objects that the serializer serializes or deserializes in a single <xref:System.Runtime.Serialization.DataContractSerializer.ReadObject%2A> method call.</span></span> <span data-ttu-id="6f02a-115">Je například omezení úrovni aplikace <xref:System.ServiceModel.Dispatcher.ServiceThrottle.MaxConcurrentSessions%2A?displayProperty=nameWithType> vlastnosti, která je ve výchozím nastavení omezuje počet souběžných kanál s relacemi připojení k 10.</span><span class="sxs-lookup"><span data-stu-id="6f02a-115">An example of an application-level throttle is the <xref:System.ServiceModel.Dispatcher.ServiceThrottle.MaxConcurrentSessions%2A?displayProperty=nameWithType> property, which by default restricts the number of concurrent sessionful channel connections to 10.</span></span> <span data-ttu-id="6f02a-116">(Na rozdíl od kvóty, při dosažení této hodnoty omezení aplikace pokračuje ve zpracování, ale přijímá žádné nové duplexních kanálů s relacemi, což znamená, že noví klienti nemůžou připojit, dokud jeden z jiných kanálů s relacemi je zakončeno.)</span><span class="sxs-lookup"><span data-stu-id="6f02a-116">(Unlike the quotas, if this throttle value is reached, the application continues processing but accepts no new sessionful channels, which means that new clients cannot connect until one of the other sessionful channels is ended.)</span></span>

 <span data-ttu-id="6f02a-117">Tyto ovládací prvky jsou určeny omezení rizik out-of-the-box s určitým typům útoků nebo ke zlepšení výkonu metriky, jako je paměť, čas spuštění a tak dále.</span><span class="sxs-lookup"><span data-stu-id="6f02a-117">These controls are designed to provide an out-of-the-box mitigation against certain types of attacks or to improve performance metrics such as memory footprint, start-up time, and so on.</span></span> <span data-ttu-id="6f02a-118">Ale v závislosti na aplikaci, tyto ovládací prvky bránit výkonu aplikací služby nebo zabránit aplikaci v pracovní době.</span><span class="sxs-lookup"><span data-stu-id="6f02a-118">However, depending on the application, these controls can impede service application performance or prevent the application from working at all.</span></span> <span data-ttu-id="6f02a-119">Například aplikace navržené tak, aby datový proud videa může snadno překročit výchozí <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="6f02a-119">For example, an application designed to stream video can easily exceed the default <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="6f02a-120">Toto téma obsahuje přehled různých ovládacích prvků použijí na aplikace na všech úrovních služby WCF, popisuje různé způsoby, jak získat další informace o tom, jestli je nastavení omezování aplikace a způsoby, jak opravit různé problémy.</span><span class="sxs-lookup"><span data-stu-id="6f02a-120">This topic provides an overview of the various controls applied to applications at all levels of WCF, describes various ways to obtain more information about whether a setting is hindering your application, and describes ways to correct various problems.</span></span> <span data-ttu-id="6f02a-121">Většinu omezení a některé kvóty jsou k dispozici na úrovni aplikace i v případě, že je vlastnost základní omezení serializace nebo přenos.</span><span class="sxs-lookup"><span data-stu-id="6f02a-121">Most throttles and some quotas are available at the application level, even when the base property is a serialization or transport constraint.</span></span> <span data-ttu-id="6f02a-122">Například můžete nastavit <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> pomocí vlastnosti <xref:System.ServiceModel.ServiceBehaviorAttribute.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> vlastnost ve třídě služby.</span><span class="sxs-lookup"><span data-stu-id="6f02a-122">For example, you can set the <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property using the <xref:System.ServiceModel.ServiceBehaviorAttribute.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property on the service class.</span></span>

> [!NOTE]
> <span data-ttu-id="6f02a-123">Pokud máte konkrétního problému, byste si měli nejdřív přečíst [rychlý start řešení potíží s WCF](../../../docs/framework/wcf/wcf-troubleshooting-quickstart.md) chcete zobrazit, zda je zde uvedeny váš problém (a řešení).</span><span class="sxs-lookup"><span data-stu-id="6f02a-123">If you have a particular problem, you should first read the [WCF Troubleshooting Quickstart](../../../docs/framework/wcf/wcf-troubleshooting-quickstart.md) to see whether your problem (and a solution) is listed there.</span></span>

 <span data-ttu-id="6f02a-124">Vlastnosti, které omezují procesů serializace jsou uvedeny v [aspekty zabezpečení pro Data](../../../docs/framework/wcf/feature-details/security-considerations-for-data.md).</span><span class="sxs-lookup"><span data-stu-id="6f02a-124">Properties that restrict serialization processes are listed in [Security Considerations for Data](../../../docs/framework/wcf/feature-details/security-considerations-for-data.md).</span></span> <span data-ttu-id="6f02a-125">Vlastnosti, které omezují spotřebu prostředků související s přenosy jsou uvedeny v [přenosové kvóty](../../../docs/framework/wcf/feature-details/transport-quotas.md).</span><span class="sxs-lookup"><span data-stu-id="6f02a-125">Properties that restrict the consumption of resources related to transports are listed in [Transport Quotas](../../../docs/framework/wcf/feature-details/transport-quotas.md).</span></span> <span data-ttu-id="6f02a-126">Jako objekty její členové jsou vlastnosti, které omezují spotřebu prostředků v aplikační vrstvě <xref:System.ServiceModel.Dispatcher.ServiceThrottle> třídy.</span><span class="sxs-lookup"><span data-stu-id="6f02a-126">Properties that restrict the consumption of resources at the application layer are the members of the <xref:System.ServiceModel.Dispatcher.ServiceThrottle> class.</span></span>

## <a name="detecting-application-and-performance-issues-related-to-quota-settings"></a><span data-ttu-id="6f02a-127">Detekce aplikací a problémy výkonu týkající se nastavení kvót</span><span class="sxs-lookup"><span data-stu-id="6f02a-127">Detecting Application and Performance Issues Related to Quota Settings</span></span>
 <span data-ttu-id="6f02a-128">Výchozí hodnoty předchozí hodnoty zvolili k dosažení funkce základní aplikaci v rámci široký rozsah typů aplikací poskytuje základní ochranu proti běžné problémy se zabezpečením.</span><span class="sxs-lookup"><span data-stu-id="6f02a-128">The defaults of the preceding values have been chosen to enable basic application functionality across a wide range of application types while providing basic protection against common security issues.</span></span> <span data-ttu-id="6f02a-129">Návrhy různé aplikace však může překročit minimálně jedno nastavení omezení, i když je zabezpečená jinak aplikace a bude fungovat tak, jak navrženo.</span><span class="sxs-lookup"><span data-stu-id="6f02a-129">However, different application designs might exceed one or more throttle settings although the application otherwise is secure and would work as designed.</span></span> <span data-ttu-id="6f02a-130">V těchto případech je nutné určit, které hodnoty omezení jsou překročení a na co úrovně a rozhodnout o vhodných opatření pro zvýšení propustnosti aplikace.</span><span class="sxs-lookup"><span data-stu-id="6f02a-130">In these cases, you must identify which throttle values are being exceeded and at what level, and decide on the appropriate course of action to increase application throughput.</span></span>

 <span data-ttu-id="6f02a-131">Obvykle při psaní aplikace a její ladění, nastavení <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> vlastnost `true` v konfiguračním souboru nebo prostřednictvím kódu programu.</span><span class="sxs-lookup"><span data-stu-id="6f02a-131">Typically, when writing the application and debugging it, you set the <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> property to `true` in the configuration file or programmatically.</span></span> <span data-ttu-id="6f02a-132">Toto dá pokyn WCF se vraťte do klientské aplikace pro zobrazení trasování zásobníku výjimky služby.</span><span class="sxs-lookup"><span data-stu-id="6f02a-132">This instructs WCF to return service exception stack traces to the client application for viewing.</span></span> <span data-ttu-id="6f02a-133">Tato funkce sestav většina výjimek úrovni aplikace v takovým způsobem, zobrazit nastavení kvóty, které může být zahrnut, pokud je to problém.</span><span class="sxs-lookup"><span data-stu-id="6f02a-133">This feature reports most application-level exceptions in such a way as to display which quota settings might be involved, if that is the problem.</span></span>

 <span data-ttu-id="6f02a-134">Některé výjimky nastávají v době spuštění pod viditelnost aplikační vrstvu a nejsou vráceny za použití tohoto mechanismu a nemusí být zpracovány vlastní <xref:System.ServiceModel.Dispatcher.IErrorHandler?displayProperty=nameWithType> implementace.</span><span class="sxs-lookup"><span data-stu-id="6f02a-134">Some exceptions happen at run time below the visibility of the application layer and are not returned using this mechanism, and they might not be handled by a custom <xref:System.ServiceModel.Dispatcher.IErrorHandler?displayProperty=nameWithType> implementation.</span></span> <span data-ttu-id="6f02a-135">Pokud jste ve vývojovém prostředí, jako je Microsoft Visual Studio, zobrazí se automaticky většinu těchto výjimek.</span><span class="sxs-lookup"><span data-stu-id="6f02a-135">If you are in a development environment like Microsoft Visual Studio, most of these exceptions are displayed automatically.</span></span> <span data-ttu-id="6f02a-136">Nicméně některé výjimky můžete maskovaná nastavení prostředí vývoje, jako [pouze můj kód](/visualstudio/debugger/just-my-code) sady Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="6f02a-136">However, some exceptions can be masked by development environment settings such as [Just My Code](/visualstudio/debugger/just-my-code) Visual Studio.</span></span>

 <span data-ttu-id="6f02a-137">Bez ohledu na funkce vývojového prostředí můžete použít možnosti WCF trasování a protokolování zpráv všechny výjimky ladění a optimalizace výkonu vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="6f02a-137">Regardless of the capabilities of your development environment, you can use capabilities of WCF tracing and message logging to debug all exceptions and tune the performance of your applications.</span></span> <span data-ttu-id="6f02a-138">Další informace najdete v tématu [pomocí trasování pro řešení potíží s aplikace](../../../docs/framework/wcf/diagnostics/tracing/using-tracing-to-troubleshoot-your-application.md).</span><span class="sxs-lookup"><span data-stu-id="6f02a-138">For more information, see [Using Tracing to Troubleshoot Your Application](../../../docs/framework/wcf/diagnostics/tracing/using-tracing-to-troubleshoot-your-application.md).</span></span>

## <a name="performance-issues-and-xmlserializer"></a><span data-ttu-id="6f02a-139">Problémy s výkonem a XmlSerializer</span><span class="sxs-lookup"><span data-stu-id="6f02a-139">Performance Issues and XmlSerializer</span></span>
 <span data-ttu-id="6f02a-140">Služby a klientské aplikace, které používají datové typy, které jsou serializovatelné pomocí <xref:System.Xml.Serialization.XmlSerializer> generování a kompilaci Serializační kód pro tyto datové typy v době běhu, což může vést k pomalé spouštění výkonu.</span><span class="sxs-lookup"><span data-stu-id="6f02a-140">Services and client applications that use data types that are serializable using the <xref:System.Xml.Serialization.XmlSerializer> generate and compile serialization code for those data types at run time, which can result in slow start-up performance.</span></span>

> [!NOTE]
> <span data-ttu-id="6f02a-141">Serializace předem generovaného kódu lze použít pouze v klientských aplikacích a ne v služeb.</span><span class="sxs-lookup"><span data-stu-id="6f02a-141">Pre-generated serialization code can be used only in client applications and not in services.</span></span>

 <span data-ttu-id="6f02a-142">[ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) výkon lze zvýšit objem požadovaný při spuštění pro tyto aplikace generování kódu serializace nezbytné ze zkompilovaných sestavení pro aplikaci.</span><span class="sxs-lookup"><span data-stu-id="6f02a-142">The [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) can improve start-up performance for these applications by generating the necessary serialization code from the compiled assemblies for the application.</span></span> <span data-ttu-id="6f02a-143">Další informace najdete v tématu [postupy: vylepšení spuštění čas z klientských aplikací WCF pomocí třídy XmlSerializer](../../../docs/framework/wcf/feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md).</span><span class="sxs-lookup"><span data-stu-id="6f02a-143">For more information, see [How to: Improve the Startup Time of WCF Client Applications using the XmlSerializer](../../../docs/framework/wcf/feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md).</span></span>

## <a name="performance-issues-when-hosting-wcf-services-under-aspnet"></a><span data-ttu-id="6f02a-144">Problémy s výkonem při hostování služby WCF v ASP.NET</span><span class="sxs-lookup"><span data-stu-id="6f02a-144">Performance Issues When Hosting WCF Services Under ASP.NET</span></span>
 <span data-ttu-id="6f02a-145">Když je služba WCF hostované na IIS a ASP.NET, nastavení konfigurace služby IIS a ASP.NET může ovlivnit nároky na propustnost a paměti služby WCF.</span><span class="sxs-lookup"><span data-stu-id="6f02a-145">When a WCF service is hosted under IIS and ASP.NET, the configuration settings of IIS and ASP.NET can affect the throughput and memory footprint of the WCF service.</span></span>  <span data-ttu-id="6f02a-146">Další informace o výkonu technologie ASP.NET, naleznete v tématu [zlepšení výkonu technologie ASP.NET](https://go.microsoft.com/fwlink/?LinkId=186462).</span><span class="sxs-lookup"><span data-stu-id="6f02a-146">For more information about ASP.NET performance, see [Improving ASP.NET Performance](https://go.microsoft.com/fwlink/?LinkId=186462).</span></span>  <span data-ttu-id="6f02a-147">Jedno nastavení, která může mít nežádoucí důsledky je <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A>, což je vlastnost <xref:System.Web.Configuration.ProcessModelSection>.</span><span class="sxs-lookup"><span data-stu-id="6f02a-147">One setting that might have unintended consequences is <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A>, which is a property of the <xref:System.Web.Configuration.ProcessModelSection>.</span></span> <span data-ttu-id="6f02a-148">Pokud vaše aplikace má pevný nebo malý počet klientů, nastavení <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A> 2 může poskytnout zvýšení propustnosti na počítači s více procesory, který má využití procesoru téměř 100 %.</span><span class="sxs-lookup"><span data-stu-id="6f02a-148">If your application has a fixed or small number of clients, setting <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A> to 2 might provide a throughput boost on a multiprocessor machine that has a CPU utilization close to 100%.</span></span> <span data-ttu-id="6f02a-149">Toto zvýšení výkonu se dodává s náklady: také způsobí zvýšení využití paměti, což může omezit škálovatelnost.</span><span class="sxs-lookup"><span data-stu-id="6f02a-149">This increase in performance comes with a cost: it will also cause an increase in memory usage, which could reduce scalability.</span></span>

## <a name="see-also"></a><span data-ttu-id="6f02a-150">Viz také</span><span class="sxs-lookup"><span data-stu-id="6f02a-150">See Also</span></span>

- [<span data-ttu-id="6f02a-151">Správa a diagnostika</span><span class="sxs-lookup"><span data-stu-id="6f02a-151">Administration and Diagnostics</span></span>](../../../docs/framework/wcf/diagnostics/index.md)
- [<span data-ttu-id="6f02a-152">Objemná data a streamování</span><span class="sxs-lookup"><span data-stu-id="6f02a-152">Large Data and Streaming</span></span>](../../../docs/framework/wcf/feature-details/large-data-and-streaming.md)
