---
title: Relace, vytváření instancí a souběžnost
description: Přečtěte si o relacích, vytváření instancí a souběžnosti, způsobu jejich použití a interakcích mezi nimi v WFC.
ms.date: 03/30/2017
ms.assetid: 50797a3b-7678-44ed-8138-49ac1602f35b
ms.openlocfilehash: 41eef5a962c702eebd6b9a34607b542ec6bbd97b
ms.sourcegitcommit: 358a28048f36a8dca39a9fe6e6ac1f1913acadd5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/23/2020
ms.locfileid: "85246542"
---
# <a name="sessions-instancing-and-concurrency"></a><span data-ttu-id="68af9-103">Relace, vytváření instancí a souběžnost</span><span class="sxs-lookup"><span data-stu-id="68af9-103">Sessions, Instancing, and Concurrency</span></span>
<span data-ttu-id="68af9-104">*Relace* je korelace všech zpráv posílaných mezi dvěma koncovými body.</span><span class="sxs-lookup"><span data-stu-id="68af9-104">A *session* is a correlation of all messages sent between two endpoints.</span></span> <span data-ttu-id="68af9-105">Vytváření *instancí* odkazuje na řízení životnosti uživatelem definovaných objektů služeb a jejich souvisejících <xref:System.ServiceModel.InstanceContext> objektů.</span><span class="sxs-lookup"><span data-stu-id="68af9-105">*Instancing* refers to controlling the lifetime of user-defined service objects and their related <xref:System.ServiceModel.InstanceContext> objects.</span></span> <span data-ttu-id="68af9-106">*Concurrency* je termín uvedený pro řízení počtu vláken spuštěných ve <xref:System.ServiceModel.InstanceContext> stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="68af9-106">*Concurrency* is the term given to the control of the number of threads executing in an <xref:System.ServiceModel.InstanceContext> at the same time.</span></span>  
  
 <span data-ttu-id="68af9-107">Toto téma popisuje tato nastavení, způsob jejich použití a různé interakce mezi nimi.</span><span class="sxs-lookup"><span data-stu-id="68af9-107">This topic describes these settings, how to use them, and the various interactions between them.</span></span>  
  
## <a name="sessions"></a><span data-ttu-id="68af9-108">Relace</span><span class="sxs-lookup"><span data-stu-id="68af9-108">Sessions</span></span>  
 <span data-ttu-id="68af9-109">Pokud kontrakt služby nastaví <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> vlastnost na hodnotu <xref:System.ServiceModel.SessionMode.Required?displayProperty=nameWithType> , znamená to, že všechna volání (tj. základní výměny zpráv podporující volání) musí být součástí stejné konverzace.</span><span class="sxs-lookup"><span data-stu-id="68af9-109">When a service contract sets the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.SessionMode.Required?displayProperty=nameWithType>, that contract is saying that all calls (that is, the underlying message exchanges that support the calls) must be part of the same conversation.</span></span> <span data-ttu-id="68af9-110">Pokud kontrakt určí, že umožňuje relace, ale nevyžaduje jednu, klienti se můžou připojit a navázat relaci nebo ne.</span><span class="sxs-lookup"><span data-stu-id="68af9-110">If a contract specifies that it allows sessions but does not require one, clients can connect and either establish a session or not.</span></span> <span data-ttu-id="68af9-111">V případě ukončení relace a odeslání zprávy přes stejný kanál založený na relaci je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="68af9-111">If the session ends and a message is sent over the same session-based channel an exception is thrown.</span></span>  
  
 <span data-ttu-id="68af9-112">Relace WCF mají následující hlavní koncepční funkce:</span><span class="sxs-lookup"><span data-stu-id="68af9-112">WCF sessions have the following main conceptual features:</span></span>  
  
- <span data-ttu-id="68af9-113">Jsou explicitně iniciovány a ukončeny volající aplikací.</span><span class="sxs-lookup"><span data-stu-id="68af9-113">They are explicitly initiated and terminated by the calling application.</span></span>  
  
- <span data-ttu-id="68af9-114">Zprávy dodávané během relace jsou zpracovávány v pořadí, ve kterém byly přijaty.</span><span class="sxs-lookup"><span data-stu-id="68af9-114">Messages delivered during a session are processed in the order in which they are received.</span></span>  
  
- <span data-ttu-id="68af9-115">Relace korelují skupinu zpráv do konverzace.</span><span class="sxs-lookup"><span data-stu-id="68af9-115">Sessions correlate a group of messages into a conversation.</span></span> <span data-ttu-id="68af9-116">Význam této korelace je abstrakce.</span><span class="sxs-lookup"><span data-stu-id="68af9-116">The meaning of that correlation is an abstraction.</span></span> <span data-ttu-id="68af9-117">Jeden kanál založený na relaci může například korelovat zprávy na základě sdíleného síťového připojení, zatímco jiný kanál založený na relaci může korelovat zprávy na základě sdílené značky v těle zprávy.</span><span class="sxs-lookup"><span data-stu-id="68af9-117">For instance, one session-based channel may correlate messages based on a shared network connection while another session-based channel may correlate messages based on a shared tag in the message body.</span></span> <span data-ttu-id="68af9-118">Funkce, které mohou být odvozeny z relace závisí na povaze korelace.</span><span class="sxs-lookup"><span data-stu-id="68af9-118">The features that can be derived from the session depend on the nature of the correlation.</span></span>  
  
- <span data-ttu-id="68af9-119">K relaci WCF není přidruženo žádné obecné úložiště dat.</span><span class="sxs-lookup"><span data-stu-id="68af9-119">There is no general data store associated with a WCF session.</span></span>  
  
 <span data-ttu-id="68af9-120">Pokud znáte <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> třídu v aplikacích ASP.NET a funkcích, které poskytuje, můžete si všimnout následujících rozdílů mezi tímto druhem relace a relacemi WCF:</span><span class="sxs-lookup"><span data-stu-id="68af9-120">If you are familiar with the <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> class in ASP.NET applications and the functionality it provides, you might notice the following differences between that kind of session and WCF sessions:</span></span>  
  
- <span data-ttu-id="68af9-121">ASP.NET relace jsou vždy iniciovány serverem.</span><span class="sxs-lookup"><span data-stu-id="68af9-121">ASP.NET sessions are always server-initiated.</span></span>  
  
- <span data-ttu-id="68af9-122">ASP.NET relace jsou implicitně neuspořádané.</span><span class="sxs-lookup"><span data-stu-id="68af9-122">ASP.NET sessions are implicitly unordered.</span></span>  
  
- <span data-ttu-id="68af9-123">ASP.NET relace poskytují obecný mechanismus pro ukládání dat napříč požadavky.</span><span class="sxs-lookup"><span data-stu-id="68af9-123">ASP.NET sessions provide a general data storage mechanism across requests.</span></span>  
  
 <span data-ttu-id="68af9-124">Klientské aplikace a aplikace služeb komunikují s relacemi různými způsoby.</span><span class="sxs-lookup"><span data-stu-id="68af9-124">Client applications and service applications interact with sessions in different ways.</span></span> <span data-ttu-id="68af9-125">Klientské aplikace zahajují relace a následně přijímají a zpracovávají zprávy odeslané v rámci relace.</span><span class="sxs-lookup"><span data-stu-id="68af9-125">Client applications initiate sessions and then receive and process the messages sent within the session.</span></span> <span data-ttu-id="68af9-126">Aplikace služby můžou používat relace jako bod rozšíření k přidání dalšího chování.</span><span class="sxs-lookup"><span data-stu-id="68af9-126">Service applications can use sessions as an extensibility point to add additional behavior.</span></span> <span data-ttu-id="68af9-127">K tomu je potřeba pracovat přímo s <xref:System.ServiceModel.InstanceContext> nebo implementací vlastního poskytovatele kontextu instance.</span><span class="sxs-lookup"><span data-stu-id="68af9-127">This is done by working directly with the <xref:System.ServiceModel.InstanceContext> or implementing a custom instance context provider.</span></span>  
  
## <a name="instancing"></a><span data-ttu-id="68af9-128">Vytváření instancí</span><span class="sxs-lookup"><span data-stu-id="68af9-128">Instancing</span></span>  
 <span data-ttu-id="68af9-129">Chování vytváření instancí (nastaveno pomocí <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> Vlastnosti) řídí, jak <xref:System.ServiceModel.InstanceContext> je vytvořena v reakci na příchozí zprávy.</span><span class="sxs-lookup"><span data-stu-id="68af9-129">The instancing behavior (set by using the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property) controls how the <xref:System.ServiceModel.InstanceContext> is created in response to incoming messages.</span></span> <span data-ttu-id="68af9-130">Ve výchozím nastavení je každá z nich <xref:System.ServiceModel.InstanceContext> přidružena k jednomu uživatelsky definovanému objektu služby, takže (ve výchozím případě) nastavení <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> vlastnosti také řídí vytváření instancí objektů služeb definovaných uživatelem.</span><span class="sxs-lookup"><span data-stu-id="68af9-130">By default, each <xref:System.ServiceModel.InstanceContext> is associated with one user-defined service object, so (in the default case) setting the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> property also controls the instancing of user-defined service objects.</span></span> <span data-ttu-id="68af9-131"><xref:System.ServiceModel.InstanceContextMode>Výčet definuje režimy vytváření instancí.</span><span class="sxs-lookup"><span data-stu-id="68af9-131">The <xref:System.ServiceModel.InstanceContextMode> enumeration defines the instancing modes.</span></span>  
  
 <span data-ttu-id="68af9-132">K dispozici jsou následující režimy vytváření instancí:</span><span class="sxs-lookup"><span data-stu-id="68af9-132">The following instancing modes are available:</span></span>  
  
- <span data-ttu-id="68af9-133"><xref:System.ServiceModel.InstanceContextMode.PerCall>: <xref:System.ServiceModel.InstanceContext> Pro každou žádost klienta se vytvoří nový objekt služby (a tudíž objekt služby).</span><span class="sxs-lookup"><span data-stu-id="68af9-133"><xref:System.ServiceModel.InstanceContextMode.PerCall>: A new <xref:System.ServiceModel.InstanceContext> (and therefore service object) is created for each client request.</span></span>  
  
- <span data-ttu-id="68af9-134"><xref:System.ServiceModel.InstanceContextMode.PerSession>: Vytvoří se nový <xref:System.ServiceModel.InstanceContext> (a proto objekt služby) pro každou novou relaci klienta a udržuje se po dobu života této relace (vyžaduje vazbu, která podporuje relace).</span><span class="sxs-lookup"><span data-stu-id="68af9-134"><xref:System.ServiceModel.InstanceContextMode.PerSession>: A new <xref:System.ServiceModel.InstanceContext> (and therefore service object) is created for each new client session and maintained for the lifetime of that session (this requires a binding that supports sessions).</span></span>  
  
- <span data-ttu-id="68af9-135"><xref:System.ServiceModel.InstanceContextMode.Single>: Jeden <xref:System.ServiceModel.InstanceContext> (a proto objekt služby) zpracovává všechny požadavky klientů po dobu života aplikace.</span><span class="sxs-lookup"><span data-stu-id="68af9-135"><xref:System.ServiceModel.InstanceContextMode.Single>: A single <xref:System.ServiceModel.InstanceContext> (and therefore service object) handles all client requests for the lifetime of the application.</span></span>  
  
 <span data-ttu-id="68af9-136">Následující příklad kódu ukazuje výchozí <xref:System.ServiceModel.InstanceContextMode> hodnotu, která je <xref:System.ServiceModel.InstanceContextMode.PerSession> explicitně nastavena pro třídu služby.</span><span class="sxs-lookup"><span data-stu-id="68af9-136">The following code example shows the default <xref:System.ServiceModel.InstanceContextMode> value, <xref:System.ServiceModel.InstanceContextMode.PerSession> being explicitly set on a service class.</span></span>  
  
```csharp  
[ServiceBehavior(InstanceContextMode=InstanceContextMode.PerSession)]
public class CalculatorService : ICalculatorInstance
{
    ...  
}  
```  
  
 <span data-ttu-id="68af9-137">A zatímco <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> vlastnost určuje, jak často <xref:System.ServiceModel.InstanceContext> je uvolněna, <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> a <xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A?displayProperty=nameWithType> ovládací prvek vlastnosti, když je objekt služby uvolněn.</span><span class="sxs-lookup"><span data-stu-id="68af9-137">And while the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property controls how often the <xref:System.ServiceModel.InstanceContext> is released, the <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> and <xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A?displayProperty=nameWithType> properties control when the service object is released.</span></span>  
  
### <a name="well-known-singleton-services"></a><span data-ttu-id="68af9-138">Dobře známé služby s jedním prvkem</span><span class="sxs-lookup"><span data-stu-id="68af9-138">Well-Known Singleton Services</span></span>  
 <span data-ttu-id="68af9-139">Jedna variace objektů služby s jednou instancí je někdy užitečná: objekt služby můžete vytvořit sami a vytvořit hostitele služby pomocí tohoto objektu.</span><span class="sxs-lookup"><span data-stu-id="68af9-139">One variation on single instance service objects is sometimes useful: you can create a service object yourself and create the service host using that object.</span></span> <span data-ttu-id="68af9-140">K tomu je nutné také nastavit <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> vlastnost na <xref:System.ServiceModel.InstanceContextMode.Single> nebo při otevření hostitele služby vyvolat výjimku.</span><span class="sxs-lookup"><span data-stu-id="68af9-140">To do so, you must also set the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.InstanceContextMode.Single> or an exception is thrown when the service host is opened.</span></span>  
  
 <span data-ttu-id="68af9-141"><xref:System.ServiceModel.ServiceHost.%23ctor%28System.Object%2CSystem.Uri%5B%5D%29>K vytvoření takové služby použijte konstruktor.</span><span class="sxs-lookup"><span data-stu-id="68af9-141">Use the <xref:System.ServiceModel.ServiceHost.%23ctor%28System.Object%2CSystem.Uri%5B%5D%29> constructor to create such a service.</span></span> <span data-ttu-id="68af9-142">Poskytuje alternativu k implementaci vlastního objektu, <xref:System.ServiceModel.Dispatcher.IInstanceContextInitializer?displayProperty=nameWithType> Pokud chcete zadat konkrétní instanci objektu pro použití ve službě typu singleton.</span><span class="sxs-lookup"><span data-stu-id="68af9-142">It provides an alternative to implementing a custom <xref:System.ServiceModel.Dispatcher.IInstanceContextInitializer?displayProperty=nameWithType> when you wish to provide a specific object instance for use by a singleton service.</span></span> <span data-ttu-id="68af9-143">Toto přetížení můžete použít, pokud je obtížné sestavit typ implementace služby (například pokud neimplementuje veřejný konstruktor bez parametrů).</span><span class="sxs-lookup"><span data-stu-id="68af9-143">You can use this overload when your service implementation type is difficult to construct (for example, if it does not implement a parameterless public constructor).</span></span>  
  
 <span data-ttu-id="68af9-144">Všimněte si, že když je objekt poskytnut tomuto konstruktoru, některé funkce související s chováním vytváření instancí služby Windows Communication Foundation (WCF) fungují jinak.</span><span class="sxs-lookup"><span data-stu-id="68af9-144">Note that when an object is provided to this constructor, some features related to the Windows Communication Foundation (WCF) instancing behavior work differently.</span></span> <span data-ttu-id="68af9-145">Volání například <xref:System.ServiceModel.InstanceContext.ReleaseServiceInstance%2A?displayProperty=nameWithType> nemá žádný vliv, pokud je poskytnuta instance objektu singleton.</span><span class="sxs-lookup"><span data-stu-id="68af9-145">For example, calling <xref:System.ServiceModel.InstanceContext.ReleaseServiceInstance%2A?displayProperty=nameWithType> has no effect when a singleton object instance is provided.</span></span> <span data-ttu-id="68af9-146">Podobně platí, že všechny ostatní mechanismy vydání instance se ignorují.</span><span class="sxs-lookup"><span data-stu-id="68af9-146">Similarly, any other instance-release mechanism is ignored.</span></span> <span data-ttu-id="68af9-147"><xref:System.ServiceModel.ServiceHost>Vždy se chová, jako by <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> vlastnost byla nastavena na hodnotu <xref:System.ServiceModel.ReleaseInstanceMode.None?displayProperty=nameWithType> pro všechny operace.</span><span class="sxs-lookup"><span data-stu-id="68af9-147">The <xref:System.ServiceModel.ServiceHost> always behaves as if the <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> property is set to <xref:System.ServiceModel.ReleaseInstanceMode.None?displayProperty=nameWithType> for all operations.</span></span>  
  
### <a name="sharing-instancecontext-objects"></a><span data-ttu-id="68af9-148">Sdílení objektů InstanceContext</span><span class="sxs-lookup"><span data-stu-id="68af9-148">Sharing InstanceContext Objects</span></span>  
 <span data-ttu-id="68af9-149">Můžete také řídit, který relační kanál nebo volání jsou přidruženy k <xref:System.ServiceModel.InstanceContext> objektu, který provádí přidružení sami.</span><span class="sxs-lookup"><span data-stu-id="68af9-149">You can also control which sessionful channel or call is associated with which <xref:System.ServiceModel.InstanceContext> object by performing that association yourself.</span></span>  
  
## <a name="concurrency"></a><span data-ttu-id="68af9-150">Souběžnost</span><span class="sxs-lookup"><span data-stu-id="68af9-150">Concurrency</span></span>  
 <span data-ttu-id="68af9-151">Souběžnost je ovládací prvek počtu aktivních vláken v <xref:System.ServiceModel.InstanceContext> jednom okamžiku.</span><span class="sxs-lookup"><span data-stu-id="68af9-151">Concurrency is the control of the number of threads active in an <xref:System.ServiceModel.InstanceContext> at any one time.</span></span> <span data-ttu-id="68af9-152">To se řídí pomocí <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> s <xref:System.ServiceModel.ConcurrencyMode> výčtem.</span><span class="sxs-lookup"><span data-stu-id="68af9-152">This is controlled by using the <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> with the <xref:System.ServiceModel.ConcurrencyMode> enumeration.</span></span>  
  
 <span data-ttu-id="68af9-153">K dispozici jsou následující tři režimy souběžnosti:</span><span class="sxs-lookup"><span data-stu-id="68af9-153">The following three concurrency modes are available:</span></span>  
  
- <span data-ttu-id="68af9-154"><xref:System.ServiceModel.ConcurrencyMode.Single>: Každý kontext instance může mít nejvýše jednu zprávu zpracovávající vlákna v kontextu instance v daném okamžiku.</span><span class="sxs-lookup"><span data-stu-id="68af9-154"><xref:System.ServiceModel.ConcurrencyMode.Single>: Each instance context is allowed to have a maximum of one thread processing messages in the instance context at a time.</span></span> <span data-ttu-id="68af9-155">Jiná vlákna, která chtějí použít stejný kontext instance, musí blokovat, dokud původní vlákno neukončí kontext instance.</span><span class="sxs-lookup"><span data-stu-id="68af9-155">Other threads wishing to use the same instance context must block until the original thread exits the instance context.</span></span>  
  
- <span data-ttu-id="68af9-156"><xref:System.ServiceModel.ConcurrencyMode.Multiple>: Každá instance služby může mít souběžně zpracovávané zprávy s více vlákny.</span><span class="sxs-lookup"><span data-stu-id="68af9-156"><xref:System.ServiceModel.ConcurrencyMode.Multiple>: Each service instance can have multiple threads processing messages concurrently.</span></span> <span data-ttu-id="68af9-157">Aby bylo možné používat tento režim souběžnosti, musí být implementace služby bezpečná pro přístup z více vláken.</span><span class="sxs-lookup"><span data-stu-id="68af9-157">The service implementation must be thread-safe to use this concurrency mode.</span></span>  
  
- <span data-ttu-id="68af9-158"><xref:System.ServiceModel.ConcurrencyMode.Reentrant>: Každá instance služby zpracovává jednu zprávu po druhém, ale přijímá volání operace znovu.</span><span class="sxs-lookup"><span data-stu-id="68af9-158"><xref:System.ServiceModel.ConcurrencyMode.Reentrant>: Each service instance processes one message at a time, but accepts re-entrant operation calls.</span></span> <span data-ttu-id="68af9-159">Služba akceptuje tato volání pouze při volání prostřednictvím objektu klienta WCF.</span><span class="sxs-lookup"><span data-stu-id="68af9-159">The service only accepts these calls when it is calling out through a WCF client object.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="68af9-160">Porozumění a vývoj kódu, který bezpečně používá více než jedno vlákno, může být obtížné zapsat do úspěšného zápisu.</span><span class="sxs-lookup"><span data-stu-id="68af9-160">Understanding and developing code that safely uses more than one thread can be difficult to write successfully.</span></span> <span data-ttu-id="68af9-161">Než použijete <xref:System.ServiceModel.ConcurrencyMode.Multiple> <xref:System.ServiceModel.ConcurrencyMode.Reentrant> hodnoty nebo, zajistěte, aby byla služba pro tyto režimy správně navržená.</span><span class="sxs-lookup"><span data-stu-id="68af9-161">Before using <xref:System.ServiceModel.ConcurrencyMode.Multiple> or <xref:System.ServiceModel.ConcurrencyMode.Reentrant> values, ensure that your service is properly designed for these modes.</span></span> <span data-ttu-id="68af9-162">Další informace naleznete v tématu <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A>.</span><span class="sxs-lookup"><span data-stu-id="68af9-162">For more information, see <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A>.</span></span>  
  
 <span data-ttu-id="68af9-163">Použití souběžnosti souvisí s režimem vytváření instancí.</span><span class="sxs-lookup"><span data-stu-id="68af9-163">The use of concurrency is related to the instancing mode.</span></span> <span data-ttu-id="68af9-164">V <xref:System.ServiceModel.InstanceContextMode.PerCall> rámci vytváření instancí není souběžnost relevantní vzhledem k tomu, že každá zpráva je zpracována novou <xref:System.ServiceModel.InstanceContext> a proto nikdy není více než jedno vlákno aktivní v <xref:System.ServiceModel.InstanceContext> .</span><span class="sxs-lookup"><span data-stu-id="68af9-164">In <xref:System.ServiceModel.InstanceContextMode.PerCall> instancing, concurrency is not relevant, because each message is processed by a new <xref:System.ServiceModel.InstanceContext> and, therefore, never more than one thread is active in the <xref:System.ServiceModel.InstanceContext>.</span></span>  
  
 <span data-ttu-id="68af9-165">Následující příklad kódu ukazuje nastavení <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> vlastnosti na <xref:System.ServiceModel.ConcurrencyMode.Multiple> .</span><span class="sxs-lookup"><span data-stu-id="68af9-165">The following code example demonstrates setting the <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> property to <xref:System.ServiceModel.ConcurrencyMode.Multiple>.</span></span>  
  
```csharp
[ServiceBehavior(ConcurrencyMode=ConcurrencyMode.Multiple, InstanceContextMode = InstanceContextMode.Single)]
public class CalculatorService : ICalculatorConcurrency
{
    ...  
}  
```  
  
## <a name="sessions-interact-with-instancecontext-settings"></a><span data-ttu-id="68af9-166">Relace pracují s nastavením InstanceContext</span><span class="sxs-lookup"><span data-stu-id="68af9-166">Sessions Interact with InstanceContext Settings</span></span>  
 <span data-ttu-id="68af9-167">Relace a <xref:System.ServiceModel.InstanceContext> interakce v závislosti na kombinaci hodnoty <xref:System.ServiceModel.SessionMode> výčtu ve smlouvě a <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> vlastnosti pro implementaci služby, která řídí přidružení mezi kanály a konkrétními objekty služby.</span><span class="sxs-lookup"><span data-stu-id="68af9-167">Sessions and <xref:System.ServiceModel.InstanceContext> interact depending upon the combination of the value of the <xref:System.ServiceModel.SessionMode> enumeration in a contract and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property on the service implementation, which controls the association between channels and specific service objects.</span></span>  
  
 <span data-ttu-id="68af9-168">V následující tabulce je uveden výsledek příchozího kanálu buď podporujícího relace, nebo nepodporující relace s ohledem na kombinaci hodnot vlastnosti a vlastnosti příslušné služby <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="68af9-168">The following table shows the result of an incoming channel either supporting sessions or not supporting sessions given a service's combination of the values of the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property.</span></span>  
  
|<span data-ttu-id="68af9-169">Hodnota InstanceContextMode</span><span class="sxs-lookup"><span data-stu-id="68af9-169">InstanceContextMode value</span></span>|<xref:System.ServiceModel.SessionMode.Required>|<xref:System.ServiceModel.SessionMode.Allowed>|<xref:System.ServiceModel.SessionMode.NotAllowed>|  
|-------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|  
|<span data-ttu-id="68af9-170">PerCall</span><span class="sxs-lookup"><span data-stu-id="68af9-170">PerCall</span></span>|<span data-ttu-id="68af9-171">– Chování s relačním kanálem: relace a <xref:System.ServiceModel.InstanceContext> pro každé volání.</span><span class="sxs-lookup"><span data-stu-id="68af9-171">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each call.</span></span><br /><span data-ttu-id="68af9-172">– Chování s kanálem bez relace: je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="68af9-172">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="68af9-173">– Chování s relačním kanálem: relace a <xref:System.ServiceModel.InstanceContext> pro každé volání.</span><span class="sxs-lookup"><span data-stu-id="68af9-173">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each call.</span></span><br /><span data-ttu-id="68af9-174">– Chování s kanálem bez relace: <xref:System.ServiceModel.InstanceContext> pro každé volání.</span><span class="sxs-lookup"><span data-stu-id="68af9-174">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|<span data-ttu-id="68af9-175">-Chování s kanálem relace: je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="68af9-175">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="68af9-176">– Chování s kanálem bez relace: <xref:System.ServiceModel.InstanceContext> pro každé volání.</span><span class="sxs-lookup"><span data-stu-id="68af9-176">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|  
|<span data-ttu-id="68af9-177">PerSession</span><span class="sxs-lookup"><span data-stu-id="68af9-177">PerSession</span></span>|<span data-ttu-id="68af9-178">– Chování s relačním kanálem: relace a <xref:System.ServiceModel.InstanceContext> pro každý kanál.</span><span class="sxs-lookup"><span data-stu-id="68af9-178">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each channel.</span></span><br /><span data-ttu-id="68af9-179">– Chování s kanálem bez relace: je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="68af9-179">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="68af9-180">– Chování s relačním kanálem: relace a <xref:System.ServiceModel.InstanceContext> pro každý kanál.</span><span class="sxs-lookup"><span data-stu-id="68af9-180">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each channel.</span></span><br /><span data-ttu-id="68af9-181">– Chování s kanálem bez relace: <xref:System.ServiceModel.InstanceContext> pro každé volání.</span><span class="sxs-lookup"><span data-stu-id="68af9-181">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|<span data-ttu-id="68af9-182">-Chování s kanálem relace: je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="68af9-182">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="68af9-183">– Chování s kanálem bez relace: <xref:System.ServiceModel.InstanceContext> pro každé volání.</span><span class="sxs-lookup"><span data-stu-id="68af9-183">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|  
|<span data-ttu-id="68af9-184">Jeden</span><span class="sxs-lookup"><span data-stu-id="68af9-184">Single</span></span>|<span data-ttu-id="68af9-185">– Chování s relačním kanálem: relace a jedna <xref:System.ServiceModel.InstanceContext> pro všechna volání.</span><span class="sxs-lookup"><span data-stu-id="68af9-185">-   Behavior with sessionful channel: A session and one <xref:System.ServiceModel.InstanceContext> for all calls.</span></span><br /><span data-ttu-id="68af9-186">– Chování s kanálem bez relace: je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="68af9-186">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="68af9-187">– Chování s kanálem relace: relace a <xref:System.ServiceModel.InstanceContext> pro vytvořeného nebo uživatelem zadaného typu singleton.</span><span class="sxs-lookup"><span data-stu-id="68af9-187">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for the created or user-specified singleton.</span></span><br /><span data-ttu-id="68af9-188">– Chování s kanálem bez relace: <xref:System.ServiceModel.InstanceContext> pro vytvořeného nebo uživatelem zadaného typu singleton.</span><span class="sxs-lookup"><span data-stu-id="68af9-188">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for the created or user-specified singleton.</span></span>|<span data-ttu-id="68af9-189">-Chování s kanálem relace: je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="68af9-189">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="68af9-190">– Chování s kanálem bez relace: <xref:System.ServiceModel.InstanceContext> pro každý vytvořený typ singleton nebo pro uživatelem zadaný typ singleton.</span><span class="sxs-lookup"><span data-stu-id="68af9-190">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each created singleton or for the user-specified singleton.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="68af9-191">Viz také</span><span class="sxs-lookup"><span data-stu-id="68af9-191">See also</span></span>

- [<span data-ttu-id="68af9-192">Použití relací</span><span class="sxs-lookup"><span data-stu-id="68af9-192">Using Sessions</span></span>](../using-sessions.md)
- [<span data-ttu-id="68af9-193">Postupy: Vytvoření služby vyžadující relace</span><span class="sxs-lookup"><span data-stu-id="68af9-193">How to: Create a Service That Requires Sessions</span></span>](how-to-create-a-service-that-requires-sessions.md)
- [<span data-ttu-id="68af9-194">Postupy: Řízení vytváření instancí služby</span><span class="sxs-lookup"><span data-stu-id="68af9-194">How to: Control Service Instancing</span></span>](how-to-control-service-instancing.md)
- [<span data-ttu-id="68af9-195">Souběžnost</span><span class="sxs-lookup"><span data-stu-id="68af9-195">Concurrency</span></span>](../samples/concurrency.md)
- [<span data-ttu-id="68af9-196">Vytváření instancí</span><span class="sxs-lookup"><span data-stu-id="68af9-196">Instancing</span></span>](../samples/instancing.md)
- [<span data-ttu-id="68af9-197">Relace</span><span class="sxs-lookup"><span data-stu-id="68af9-197">Session</span></span>](../samples/session.md)
