---
title: Relace, vytváření instancí a souběžnost
ms.date: 03/30/2017
ms.assetid: 50797a3b-7678-44ed-8138-49ac1602f35b
ms.openlocfilehash: a7466d819e15f3bfe8def2d9407dcf2c6e0c7346
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/12/2020
ms.locfileid: "79184446"
---
# <a name="sessions-instancing-and-concurrency"></a><span data-ttu-id="cda87-102">Relace, vytváření instancí a souběžnost</span><span class="sxs-lookup"><span data-stu-id="cda87-102">Sessions, Instancing, and Concurrency</span></span>
<span data-ttu-id="cda87-103">*Relace* je korelace všech zpráv odeslaných mezi dvěma koncovými body.</span><span class="sxs-lookup"><span data-stu-id="cda87-103">A *session* is a correlation of all messages sent between two endpoints.</span></span> <span data-ttu-id="cda87-104">*Instance* označuje řízení životnosti uživatelem definovaných objektů služby a jejich souvisejících <xref:System.ServiceModel.InstanceContext> objektů.</span><span class="sxs-lookup"><span data-stu-id="cda87-104">*Instancing* refers to controlling the lifetime of user-defined service objects and their related <xref:System.ServiceModel.InstanceContext> objects.</span></span> <span data-ttu-id="cda87-105">*Souběžnost* je termín daný řízení počtu podprocesů provádějících <xref:System.ServiceModel.InstanceContext> ve stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="cda87-105">*Concurrency* is the term given to the control of the number of threads executing in an <xref:System.ServiceModel.InstanceContext> at the same time.</span></span>  
  
 <span data-ttu-id="cda87-106">Toto téma popisuje tato nastavení, jak je používat a různé interakce mezi nimi.</span><span class="sxs-lookup"><span data-stu-id="cda87-106">This topic describes these settings, how to use them, and the various interactions between them.</span></span>  
  
## <a name="sessions"></a><span data-ttu-id="cda87-107">Relace</span><span class="sxs-lookup"><span data-stu-id="cda87-107">Sessions</span></span>  
 <span data-ttu-id="cda87-108">Pokud smlouva o <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> poskytování <xref:System.ServiceModel.SessionMode.Required?displayProperty=nameWithType>služeb nastaví vlastnost , tato smlouva říká, že všechna volání (to znamená, že základní zprávy výměny, které podporují volání) musí být součástí stejné konverzace.</span><span class="sxs-lookup"><span data-stu-id="cda87-108">When a service contract sets the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.SessionMode.Required?displayProperty=nameWithType>, that contract is saying that all calls (that is, the underlying message exchanges that support the calls) must be part of the same conversation.</span></span> <span data-ttu-id="cda87-109">Pokud smlouva určuje, že umožňuje relace, ale nevyžaduje ji, klienti se mohou připojit a buď vytvořit relaci, nebo ne.</span><span class="sxs-lookup"><span data-stu-id="cda87-109">If a contract specifies that it allows sessions but does not require one, clients can connect and either establish a session or not.</span></span> <span data-ttu-id="cda87-110">Pokud relace skončí a zpráva je odeslána prostředpo stejné relace založené kanálu je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="cda87-110">If the session ends and a message is sent over the same session-based channel an exception is thrown.</span></span>  
  
 <span data-ttu-id="cda87-111">Relace WCF mají následující hlavní koncepční funkce:</span><span class="sxs-lookup"><span data-stu-id="cda87-111">WCF sessions have the following main conceptual features:</span></span>  
  
- <span data-ttu-id="cda87-112">Jsou explicitně iniciovány a ukončeny volající aplikací.</span><span class="sxs-lookup"><span data-stu-id="cda87-112">They are explicitly initiated and terminated by the calling application.</span></span>  
  
- <span data-ttu-id="cda87-113">Zprávy doručené během relace jsou zpracovány v pořadí, ve kterém jsou přijímány.</span><span class="sxs-lookup"><span data-stu-id="cda87-113">Messages delivered during a session are processed in the order in which they are received.</span></span>  
  
- <span data-ttu-id="cda87-114">Relace korelují skupinu zpráv do konverzace.</span><span class="sxs-lookup"><span data-stu-id="cda87-114">Sessions correlate a group of messages into a conversation.</span></span> <span data-ttu-id="cda87-115">Význam této korelace je abstrakce.</span><span class="sxs-lookup"><span data-stu-id="cda87-115">The meaning of that correlation is an abstraction.</span></span> <span data-ttu-id="cda87-116">Jeden kanál založený na relaci může například korelovat zprávy založené na sdíleném síťovém připojení, zatímco jiný kanál založený na relaci může korelovat zprávy na základě sdílené značky v textu zprávy.</span><span class="sxs-lookup"><span data-stu-id="cda87-116">For instance, one session-based channel may correlate messages based on a shared network connection while another session-based channel may correlate messages based on a shared tag in the message body.</span></span> <span data-ttu-id="cda87-117">Funkce, které lze odvodit z relace závisí na povaze korelace.</span><span class="sxs-lookup"><span data-stu-id="cda87-117">The features that can be derived from the session depend on the nature of the correlation.</span></span>  
  
- <span data-ttu-id="cda87-118">Neexistuje žádné obecné úložiště dat přidružené k relaci WCF.</span><span class="sxs-lookup"><span data-stu-id="cda87-118">There is no general data store associated with a WCF session.</span></span>  
  
 <span data-ttu-id="cda87-119">Pokud jste obeznámeni <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> s třídou v ASP.NET aplikacích a funkce, které poskytuje, můžete si všimnout následující rozdíly mezi tento druh relace a WCF relací:</span><span class="sxs-lookup"><span data-stu-id="cda87-119">If you are familiar with the <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> class in ASP.NET applications and the functionality it provides, you might notice the following differences between that kind of session and WCF sessions:</span></span>  
  
- <span data-ttu-id="cda87-120">ASP.NET relací jsou vždy inicializovány serverem.</span><span class="sxs-lookup"><span data-stu-id="cda87-120">ASP.NET sessions are always server-initiated.</span></span>  
  
- <span data-ttu-id="cda87-121">ASP.NET relace jsou implicitně neuspořádané.</span><span class="sxs-lookup"><span data-stu-id="cda87-121">ASP.NET sessions are implicitly unordered.</span></span>  
  
- <span data-ttu-id="cda87-122">ASP.NET relace poskytují obecný mechanismus ukládání dat napříč požadavky.</span><span class="sxs-lookup"><span data-stu-id="cda87-122">ASP.NET sessions provide a general data storage mechanism across requests.</span></span>  
  
 <span data-ttu-id="cda87-123">Klientské aplikace a aplikace služeb interagují s relacemi různými způsoby.</span><span class="sxs-lookup"><span data-stu-id="cda87-123">Client applications and service applications interact with sessions in different ways.</span></span> <span data-ttu-id="cda87-124">Klientské aplikace iniciují relace a pak přijímají a zpracovávají zprávy odeslané v rámci relace.</span><span class="sxs-lookup"><span data-stu-id="cda87-124">Client applications initiate sessions and then receive and process the messages sent within the session.</span></span> <span data-ttu-id="cda87-125">Aplikace služby můžete použít relace jako bod rozšiřitelnosti přidat další chování.</span><span class="sxs-lookup"><span data-stu-id="cda87-125">Service applications can use sessions as an extensibility point to add additional behavior.</span></span> <span data-ttu-id="cda87-126">To se provádí přímo <xref:System.ServiceModel.InstanceContext> u poskytovatele kontextu vlastní instance.</span><span class="sxs-lookup"><span data-stu-id="cda87-126">This is done by working directly with the <xref:System.ServiceModel.InstanceContext> or implementing a custom instance context provider.</span></span>  
  
## <a name="instancing"></a><span data-ttu-id="cda87-127">Vytváření instancí</span><span class="sxs-lookup"><span data-stu-id="cda87-127">Instancing</span></span>  
 <span data-ttu-id="cda87-128">Instancing chování (nastavit pomocí <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> vlastnosti) <xref:System.ServiceModel.InstanceContext> určuje, jak je vytvořen v reakci na příchozí zprávy.</span><span class="sxs-lookup"><span data-stu-id="cda87-128">The instancing behavior (set by using the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property) controls how the <xref:System.ServiceModel.InstanceContext> is created in response to incoming messages.</span></span> <span data-ttu-id="cda87-129">Ve výchozím <xref:System.ServiceModel.InstanceContext> nastavení je každý z nich přidružen k jednomu uživatelem <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> definovanému objektu služby, takže (ve výchozím případě) nastavení vlastnosti také řídí instance uživatelem definovaných objektů služby.</span><span class="sxs-lookup"><span data-stu-id="cda87-129">By default, each <xref:System.ServiceModel.InstanceContext> is associated with one user-defined service object, so (in the default case) setting the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> property also controls the instancing of user-defined service objects.</span></span> <span data-ttu-id="cda87-130">Výčet <xref:System.ServiceModel.InstanceContextMode> definuje instance režimy.</span><span class="sxs-lookup"><span data-stu-id="cda87-130">The <xref:System.ServiceModel.InstanceContextMode> enumeration defines the instancing modes.</span></span>  
  
 <span data-ttu-id="cda87-131">K dispozici jsou následující instance:</span><span class="sxs-lookup"><span data-stu-id="cda87-131">The following instancing modes are available:</span></span>  
  
- <span data-ttu-id="cda87-132"><xref:System.ServiceModel.InstanceContextMode.PerCall>: Pro <xref:System.ServiceModel.InstanceContext> každý požadavek klienta je vytvořen nový (a proto objekt služby).</span><span class="sxs-lookup"><span data-stu-id="cda87-132"><xref:System.ServiceModel.InstanceContextMode.PerCall>: A new <xref:System.ServiceModel.InstanceContext> (and therefore service object) is created for each client request.</span></span>  
  
- <span data-ttu-id="cda87-133"><xref:System.ServiceModel.InstanceContextMode.PerSession>: Pro <xref:System.ServiceModel.InstanceContext> každou novou relaci klienta je vytvořen nový (a proto objekt služby) a udržován po dobu životnosti této relace (to vyžaduje vazbu, která podporuje relace).</span><span class="sxs-lookup"><span data-stu-id="cda87-133"><xref:System.ServiceModel.InstanceContextMode.PerSession>: A new <xref:System.ServiceModel.InstanceContext> (and therefore service object) is created for each new client session and maintained for the lifetime of that session (this requires a binding that supports sessions).</span></span>  
  
- <span data-ttu-id="cda87-134"><xref:System.ServiceModel.InstanceContextMode.Single>: Jeden <xref:System.ServiceModel.InstanceContext> (a proto objekt služby) zpracovává všechny požadavky klienta po dobu životnosti aplikace.</span><span class="sxs-lookup"><span data-stu-id="cda87-134"><xref:System.ServiceModel.InstanceContextMode.Single>: A single <xref:System.ServiceModel.InstanceContext> (and therefore service object) handles all client requests for the lifetime of the application.</span></span>  
  
 <span data-ttu-id="cda87-135">Následující příklad kódu ukazuje <xref:System.ServiceModel.InstanceContextMode> výchozí <xref:System.ServiceModel.InstanceContextMode.PerSession> hodnotu, která je explicitně nastavena na třídě služby.</span><span class="sxs-lookup"><span data-stu-id="cda87-135">The following code example shows the default <xref:System.ServiceModel.InstanceContextMode> value, <xref:System.ServiceModel.InstanceContextMode.PerSession> being explicitly set on a service class.</span></span>  
  
```csharp  
[ServiceBehavior(InstanceContextMode=InstanceContextMode.PerSession)]
public class CalculatorService : ICalculatorInstance
{
    ...  
}  
```  
  
 <span data-ttu-id="cda87-136">A zatímco <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> vlastnost určuje, <xref:System.ServiceModel.InstanceContext> jak často <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> <xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A?displayProperty=nameWithType> je uvolněna, a vlastnosti řídit, kdy je uvolněn objekt služby.</span><span class="sxs-lookup"><span data-stu-id="cda87-136">And while the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property controls how often the <xref:System.ServiceModel.InstanceContext> is released, the <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> and <xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A?displayProperty=nameWithType> properties control when the service object is released.</span></span>  
  
### <a name="well-known-singleton-services"></a><span data-ttu-id="cda87-137">Známé singleton služby</span><span class="sxs-lookup"><span data-stu-id="cda87-137">Well-Known Singleton Services</span></span>  
 <span data-ttu-id="cda87-138">Jedna varianta na objekty služby jedné instance je někdy užitečná: můžete vytvořit objekt služby sami a vytvořit hostitele služby pomocí tohoto objektu.</span><span class="sxs-lookup"><span data-stu-id="cda87-138">One variation on single instance service objects is sometimes useful: you can create a service object yourself and create the service host using that object.</span></span> <span data-ttu-id="cda87-139">Chcete-li tak učinit, <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> musíte <xref:System.ServiceModel.InstanceContextMode.Single> také nastavit vlastnost nebo je vyvolána výjimka při otevření hostitele služby.</span><span class="sxs-lookup"><span data-stu-id="cda87-139">To do so, you must also set the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.InstanceContextMode.Single> or an exception is thrown when the service host is opened.</span></span>  
  
 <span data-ttu-id="cda87-140">Pomocí <xref:System.ServiceModel.ServiceHost.%23ctor%28System.Object%2CSystem.Uri%5B%5D%29?displayProperty=nameWithType> konstruktoru vytvořit takovou službu.</span><span class="sxs-lookup"><span data-stu-id="cda87-140">Use the <xref:System.ServiceModel.ServiceHost.%23ctor%28System.Object%2CSystem.Uri%5B%5D%29?displayProperty=nameWithType> constructor to create such a service.</span></span> <span data-ttu-id="cda87-141">Poskytuje alternativu k implementaci <xref:System.ServiceModel.Dispatcher.IInstanceContextInitializer?displayProperty=nameWithType> vlastní, pokud chcete poskytnout konkrétní instance objektu pro použití službou singleton.</span><span class="sxs-lookup"><span data-stu-id="cda87-141">It provides an alternative to implementing a custom <xref:System.ServiceModel.Dispatcher.IInstanceContextInitializer?displayProperty=nameWithType> when you wish to provide a specific object instance for use by a singleton service.</span></span> <span data-ttu-id="cda87-142">Toto přetížení můžete použít, když je obtížné vytvořit typ implementace služby (například pokud neimplementuje public konstruktor bez parametrů).</span><span class="sxs-lookup"><span data-stu-id="cda87-142">You can use this overload when your service implementation type is difficult to construct (for example, if it does not implement a parameterless public constructor).</span></span>  
  
 <span data-ttu-id="cda87-143">Všimněte si, že když je objekt k dispozici tohoto konstruktoru, některé funkce související s Windows Communication Foundation (WCF) instance chování pracovat jinak.</span><span class="sxs-lookup"><span data-stu-id="cda87-143">Note that when an object is provided to this constructor, some features related to the Windows Communication Foundation (WCF) instancing behavior work differently.</span></span> <span data-ttu-id="cda87-144">Například volání <xref:System.ServiceModel.InstanceContext.ReleaseServiceInstance%2A?displayProperty=nameWithType> nemá žádný vliv, když je k dispozici instance objektu singleton.</span><span class="sxs-lookup"><span data-stu-id="cda87-144">For example, calling <xref:System.ServiceModel.InstanceContext.ReleaseServiceInstance%2A?displayProperty=nameWithType> has no effect when a singleton object instance is provided.</span></span> <span data-ttu-id="cda87-145">Podobně je ignorována jakákoli jiná instance release mechanism.</span><span class="sxs-lookup"><span data-stu-id="cda87-145">Similarly, any other instance-release mechanism is ignored.</span></span> <span data-ttu-id="cda87-146">Vždy <xref:System.ServiceModel.ServiceHost> se chová, jako <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> by vlastnost <xref:System.ServiceModel.ReleaseInstanceMode.None?displayProperty=nameWithType> je nastavena na pro všechny operace.</span><span class="sxs-lookup"><span data-stu-id="cda87-146">The <xref:System.ServiceModel.ServiceHost> always behaves as if the <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> property is set to <xref:System.ServiceModel.ReleaseInstanceMode.None?displayProperty=nameWithType> for all operations.</span></span>  
  
### <a name="sharing-instancecontext-objects"></a><span data-ttu-id="cda87-147">Sdílení objektů InstanceContext</span><span class="sxs-lookup"><span data-stu-id="cda87-147">Sharing InstanceContext Objects</span></span>  
 <span data-ttu-id="cda87-148">Můžete také určit, který kanál nebo volání <xref:System.ServiceModel.InstanceContext> relace je přidruženo k jakému objektu, provedením tohoto přidružení sami.</span><span class="sxs-lookup"><span data-stu-id="cda87-148">You can also control which sessionful channel or call is associated with which <xref:System.ServiceModel.InstanceContext> object by performing that association yourself.</span></span>  
  
## <a name="concurrency"></a><span data-ttu-id="cda87-149">Souběžnost</span><span class="sxs-lookup"><span data-stu-id="cda87-149">Concurrency</span></span>  
 <span data-ttu-id="cda87-150">Souběžnost je řízení počtu podprocesů aktivních <xref:System.ServiceModel.InstanceContext> v jednom okamžiku.</span><span class="sxs-lookup"><span data-stu-id="cda87-150">Concurrency is the control of the number of threads active in an <xref:System.ServiceModel.InstanceContext> at any one time.</span></span> <span data-ttu-id="cda87-151">To je řízenpomocí <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> s <xref:System.ServiceModel.ConcurrencyMode> výčtu.</span><span class="sxs-lookup"><span data-stu-id="cda87-151">This is controlled by using the <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> with the <xref:System.ServiceModel.ConcurrencyMode> enumeration.</span></span>  
  
 <span data-ttu-id="cda87-152">K dispozici jsou následující tři režimy souběžnosti:</span><span class="sxs-lookup"><span data-stu-id="cda87-152">The following three concurrency modes are available:</span></span>  
  
- <span data-ttu-id="cda87-153"><xref:System.ServiceModel.ConcurrencyMode.Single>: Každý kontext instance může mít maximálně jeden podproces zpracování zpráv v kontextu instance najednou.</span><span class="sxs-lookup"><span data-stu-id="cda87-153"><xref:System.ServiceModel.ConcurrencyMode.Single>: Each instance context is allowed to have a maximum of one thread processing messages in the instance context at a time.</span></span> <span data-ttu-id="cda87-154">Ostatní vlákna, která chtějí použít stejný kontext instance, musí blokovat, dokud původní vlákno neukončí kontext instance.</span><span class="sxs-lookup"><span data-stu-id="cda87-154">Other threads wishing to use the same instance context must block until the original thread exits the instance context.</span></span>  
  
- <span data-ttu-id="cda87-155"><xref:System.ServiceModel.ConcurrencyMode.Multiple>: Každá instance služby může mít více vláken zpracování zpráv současně.</span><span class="sxs-lookup"><span data-stu-id="cda87-155"><xref:System.ServiceModel.ConcurrencyMode.Multiple>: Each service instance can have multiple threads processing messages concurrently.</span></span> <span data-ttu-id="cda87-156">Implementace služby musí být bezpečné pro přístup z více vláken, aby bylo možné použít tento režim souběžnosti.</span><span class="sxs-lookup"><span data-stu-id="cda87-156">The service implementation must be thread-safe to use this concurrency mode.</span></span>  
  
- <span data-ttu-id="cda87-157"><xref:System.ServiceModel.ConcurrencyMode.Reentrant>: Každá instance služby zpracovává jednu zprávu najednou, ale přijímá volání operace opětovného účastníka.</span><span class="sxs-lookup"><span data-stu-id="cda87-157"><xref:System.ServiceModel.ConcurrencyMode.Reentrant>: Each service instance processes one message at a time, but accepts re-entrant operation calls.</span></span> <span data-ttu-id="cda87-158">Služba přijímá pouze tato volání, pokud volá prostřednictvím objektu klienta WCF.</span><span class="sxs-lookup"><span data-stu-id="cda87-158">The service only accepts these calls when it is calling out through a WCF client object.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="cda87-159">Pochopení a vývoj kódu, který bezpečně používá více než jedno vlákno může být obtížné úspěšně psát.</span><span class="sxs-lookup"><span data-stu-id="cda87-159">Understanding and developing code that safely uses more than one thread can be difficult to write successfully.</span></span> <span data-ttu-id="cda87-160">Před <xref:System.ServiceModel.ConcurrencyMode.Multiple> použitím <xref:System.ServiceModel.ConcurrencyMode.Reentrant> nebo hodnotami se ujistěte, že je služba pro tyto režimy správně navržena.</span><span class="sxs-lookup"><span data-stu-id="cda87-160">Before using <xref:System.ServiceModel.ConcurrencyMode.Multiple> or <xref:System.ServiceModel.ConcurrencyMode.Reentrant> values, ensure that your service is properly designed for these modes.</span></span> <span data-ttu-id="cda87-161">Další informace naleznete v tématu <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A>.</span><span class="sxs-lookup"><span data-stu-id="cda87-161">For more information, see <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A>.</span></span>  
  
 <span data-ttu-id="cda87-162">Použití souběžnosti souvisí s instance režimu.</span><span class="sxs-lookup"><span data-stu-id="cda87-162">The use of concurrency is related to the instancing mode.</span></span> <span data-ttu-id="cda87-163">V <xref:System.ServiceModel.InstanceContextMode.PerCall> instance není souběžnost relevantní, protože každá zpráva je <xref:System.ServiceModel.InstanceContext> zpracována novým, a proto nikdy není <xref:System.ServiceModel.InstanceContext>v rozhraní .</span><span class="sxs-lookup"><span data-stu-id="cda87-163">In <xref:System.ServiceModel.InstanceContextMode.PerCall> instancing, concurrency is not relevant, because each message is processed by a new <xref:System.ServiceModel.InstanceContext> and, therefore, never more than one thread is active in the <xref:System.ServiceModel.InstanceContext>.</span></span>  
  
 <span data-ttu-id="cda87-164">Následující příklad kódu ukazuje <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> nastavení <xref:System.ServiceModel.ConcurrencyMode.Multiple>vlastnosti na .</span><span class="sxs-lookup"><span data-stu-id="cda87-164">The following code example demonstrates setting the <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> property to <xref:System.ServiceModel.ConcurrencyMode.Multiple>.</span></span>  
  
```csharp
[ServiceBehavior(ConcurrencyMode=ConcurrencyMode.Multiple, InstanceContextMode = InstanceContextMode.Single)]
public class CalculatorService : ICalculatorConcurrency
{
    ...  
}  
```  
  
## <a name="sessions-interact-with-instancecontext-settings"></a><span data-ttu-id="cda87-165">Interakce relací s nastavením instancekontextu</span><span class="sxs-lookup"><span data-stu-id="cda87-165">Sessions Interact with InstanceContext Settings</span></span>  
 <span data-ttu-id="cda87-166">Relace <xref:System.ServiceModel.InstanceContext> a interakci v závislosti na <xref:System.ServiceModel.SessionMode> kombinaci hodnoty výčtu <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> ve smlouvě a vlastnost na implementaci služby, která řídí přidružení mezi kanály a konkrétní objekty služby.</span><span class="sxs-lookup"><span data-stu-id="cda87-166">Sessions and <xref:System.ServiceModel.InstanceContext> interact depending upon the combination of the value of the <xref:System.ServiceModel.SessionMode> enumeration in a contract and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property on the service implementation, which controls the association between channels and specific service objects.</span></span>  
  
 <span data-ttu-id="cda87-167">V následující tabulce je uveden výsledek příchozího kanálu, který podporuje relace nebo nepodporuje relace <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> dané kombinace <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> hodnot vlastnosti a vlastnosti službou.</span><span class="sxs-lookup"><span data-stu-id="cda87-167">The following table shows the result of an incoming channel either supporting sessions or not supporting sessions given a service's combination of the values of the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property.</span></span>  
  
|<span data-ttu-id="cda87-168">Hodnota InstanceContextMode</span><span class="sxs-lookup"><span data-stu-id="cda87-168">InstanceContextMode value</span></span>|<xref:System.ServiceModel.SessionMode.Required>|<xref:System.ServiceModel.SessionMode.Allowed>|<xref:System.ServiceModel.SessionMode.NotAllowed>|  
|-------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|  
|<span data-ttu-id="cda87-169">Percall</span><span class="sxs-lookup"><span data-stu-id="cda87-169">PerCall</span></span>|<span data-ttu-id="cda87-170">- Chování s sessionful kanál: relace a <xref:System.ServiceModel.InstanceContext> pro každý hovor.</span><span class="sxs-lookup"><span data-stu-id="cda87-170">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each call.</span></span><br /><span data-ttu-id="cda87-171">- Chování s kanálem bez relace: Je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="cda87-171">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="cda87-172">- Chování s sessionful kanál: relace a <xref:System.ServiceModel.InstanceContext> pro každý hovor.</span><span class="sxs-lookup"><span data-stu-id="cda87-172">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each call.</span></span><br /><span data-ttu-id="cda87-173">- Chování s kanálem <xref:System.ServiceModel.InstanceContext> bez relace: A pro každý hovor.</span><span class="sxs-lookup"><span data-stu-id="cda87-173">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|<span data-ttu-id="cda87-174">- Chování s sessionful kanál: Je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="cda87-174">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="cda87-175">- Chování s kanálem <xref:System.ServiceModel.InstanceContext> bez relace: A pro každý hovor.</span><span class="sxs-lookup"><span data-stu-id="cda87-175">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|  
|<span data-ttu-id="cda87-176">PerSession</span><span class="sxs-lookup"><span data-stu-id="cda87-176">PerSession</span></span>|<span data-ttu-id="cda87-177">- Chování s sessionful kanál: Relace a <xref:System.ServiceModel.InstanceContext> pro každý kanál.</span><span class="sxs-lookup"><span data-stu-id="cda87-177">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each channel.</span></span><br /><span data-ttu-id="cda87-178">- Chování s kanálem bez relace: Je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="cda87-178">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="cda87-179">- Chování s sessionful kanál: Relace a <xref:System.ServiceModel.InstanceContext> pro každý kanál.</span><span class="sxs-lookup"><span data-stu-id="cda87-179">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each channel.</span></span><br /><span data-ttu-id="cda87-180">- Chování s kanálem <xref:System.ServiceModel.InstanceContext> bez relace: A pro každý hovor.</span><span class="sxs-lookup"><span data-stu-id="cda87-180">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|<span data-ttu-id="cda87-181">- Chování s sessionful kanál: Je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="cda87-181">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="cda87-182">- Chování s kanálem <xref:System.ServiceModel.InstanceContext> bez relace: A pro každý hovor.</span><span class="sxs-lookup"><span data-stu-id="cda87-182">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|  
|<span data-ttu-id="cda87-183">Single</span><span class="sxs-lookup"><span data-stu-id="cda87-183">Single</span></span>|<span data-ttu-id="cda87-184">- Chování s sessionful kanál: <xref:System.ServiceModel.InstanceContext> relace a jeden pro všechny hovory.</span><span class="sxs-lookup"><span data-stu-id="cda87-184">-   Behavior with sessionful channel: A session and one <xref:System.ServiceModel.InstanceContext> for all calls.</span></span><br /><span data-ttu-id="cda87-185">- Chování s kanálem bez relace: Je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="cda87-185">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="cda87-186">- Chování s sessionful kanál: relace a <xref:System.ServiceModel.InstanceContext> pro vytvořené nebo uživatelem zadané singleton.</span><span class="sxs-lookup"><span data-stu-id="cda87-186">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for the created or user-specified singleton.</span></span><br /><span data-ttu-id="cda87-187">- Chování s kanálem <xref:System.ServiceModel.InstanceContext> bez relace: A pro vytvořený nebo uživatelem určený singleton.</span><span class="sxs-lookup"><span data-stu-id="cda87-187">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for the created or user-specified singleton.</span></span>|<span data-ttu-id="cda87-188">- Chování s sessionful kanál: Je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="cda87-188">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="cda87-189">- Chování s kanálem <xref:System.ServiceModel.InstanceContext> bez relace: A pro každý vytvořený singleton nebo pro uživatelem určený singleton.</span><span class="sxs-lookup"><span data-stu-id="cda87-189">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each created singleton or for the user-specified singleton.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="cda87-190">Viz také</span><span class="sxs-lookup"><span data-stu-id="cda87-190">See also</span></span>

- [<span data-ttu-id="cda87-191">Použití relací</span><span class="sxs-lookup"><span data-stu-id="cda87-191">Using Sessions</span></span>](../../../../docs/framework/wcf/using-sessions.md)
- [<span data-ttu-id="cda87-192">Postupy: Vytvoření služby vyžadující relace</span><span class="sxs-lookup"><span data-stu-id="cda87-192">How to: Create a Service That Requires Sessions</span></span>](../../../../docs/framework/wcf/feature-details/how-to-create-a-service-that-requires-sessions.md)
- [<span data-ttu-id="cda87-193">Postupy: Řízení vytváření instancí služby</span><span class="sxs-lookup"><span data-stu-id="cda87-193">How to: Control Service Instancing</span></span>](../../../../docs/framework/wcf/feature-details/how-to-control-service-instancing.md)
- [<span data-ttu-id="cda87-194">Souběžnost</span><span class="sxs-lookup"><span data-stu-id="cda87-194">Concurrency</span></span>](../../../../docs/framework/wcf/samples/concurrency.md)
- [<span data-ttu-id="cda87-195">Vytváření instancí</span><span class="sxs-lookup"><span data-stu-id="cda87-195">Instancing</span></span>](../../../../docs/framework/wcf/samples/instancing.md)
- [<span data-ttu-id="cda87-196">Relace</span><span class="sxs-lookup"><span data-stu-id="cda87-196">Session</span></span>](../../../../docs/framework/wcf/samples/session.md)
