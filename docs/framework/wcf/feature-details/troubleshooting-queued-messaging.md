---
title: Řešení potíží se zasíláním zpráv zařazovaných do front
ms.date: 03/30/2017
ms.assetid: a5f2836f-018d-42f5-a571-1e97e64ea5b0
ms.openlocfilehash: 5c039c34983647884561f33645f26e4a89280248
ms.sourcegitcommit: cdf5084648bf5e77970cbfeaa23f1cab3e6e234e
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 02/01/2020
ms.locfileid: "76921272"
---
# <a name="troubleshooting-queued-messaging"></a><span data-ttu-id="6eca9-102">Řešení potíží se zasíláním zpráv zařazovaných do front</span><span class="sxs-lookup"><span data-stu-id="6eca9-102">Troubleshooting Queued Messaging</span></span>

<span data-ttu-id="6eca9-103">Tato část obsahuje nejčastější dotazy a pomoc při odstraňování potíží s používáním front v Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="6eca9-103">This section contains common questions and troubleshooting help for using queues in Windows Communication Foundation (WCF).</span></span>

## <a name="common-questions"></a><span data-ttu-id="6eca9-104">Běžné dotazy</span><span class="sxs-lookup"><span data-stu-id="6eca9-104">Common Questions</span></span>

<span data-ttu-id="6eca9-105">**Otázka:** Použil (a) jsem WCF beta 1 a nainstaloval (a) opravu hotfix služby MSMQ.</span><span class="sxs-lookup"><span data-stu-id="6eca9-105">**Q:** I used WCF Beta 1 and I installed the MSMQ hotfix.</span></span> <span data-ttu-id="6eca9-106">Musím tuto opravu hotfix odebrat?</span><span class="sxs-lookup"><span data-stu-id="6eca9-106">Do I need to remove the hotfix?</span></span>

<span data-ttu-id="6eca9-107">**Odpověď:** Ano.</span><span class="sxs-lookup"><span data-stu-id="6eca9-107">**A:** Yes.</span></span> <span data-ttu-id="6eca9-108">Tato oprava hotfix již není podporována.</span><span class="sxs-lookup"><span data-stu-id="6eca9-108">This hotfix is no longer supported.</span></span> <span data-ttu-id="6eca9-109">WCF teď funguje v MSMQ bez požadavku na opravu hotfix.</span><span class="sxs-lookup"><span data-stu-id="6eca9-109">WCF now works on MSMQ without a hotfix requirement.</span></span>

<span data-ttu-id="6eca9-110">**Otázka:** Existují dvě vazby pro službu MSMQ: <xref:System.ServiceModel.NetMsmqBinding> a <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>.</span><span class="sxs-lookup"><span data-stu-id="6eca9-110">**Q:** There are two bindings for MSMQ: <xref:System.ServiceModel.NetMsmqBinding> and <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>.</span></span> <span data-ttu-id="6eca9-111">Co mám použít a kdy?</span><span class="sxs-lookup"><span data-stu-id="6eca9-111">What should I use and when?</span></span>

<span data-ttu-id="6eca9-112">**A:** Použijte <xref:System.ServiceModel.NetMsmqBinding>, pokud chcete použít službu MSMQ jako přenos pro komunikaci ve frontě mezi dvěma aplikacemi WCF.</span><span class="sxs-lookup"><span data-stu-id="6eca9-112">**A:** Use the <xref:System.ServiceModel.NetMsmqBinding> when you want to use MSMQ as a transport for queued communication between two WCF applications.</span></span> <span data-ttu-id="6eca9-113">Použijte <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>, pokud chcete použít existující aplikace služby MSMQ ke komunikaci s novými aplikacemi WCF.</span><span class="sxs-lookup"><span data-stu-id="6eca9-113">Use the <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> when you want to use existing MSMQ applications to communicate with new WCF applications.</span></span>

<span data-ttu-id="6eca9-114">**Otázka:** Je potřeba upgradovat službu MSMQ, aby používala vazby <xref:System.ServiceModel.NetMsmqBinding> a `MsmqIntegration`?</span><span class="sxs-lookup"><span data-stu-id="6eca9-114">**Q:** Do I have to upgrade MSMQ to use the <xref:System.ServiceModel.NetMsmqBinding> and `MsmqIntegration` bindings?</span></span>

<span data-ttu-id="6eca9-115">**Odpověď:** Ne.</span><span class="sxs-lookup"><span data-stu-id="6eca9-115">**A:** No.</span></span> <span data-ttu-id="6eca9-116">Obě vazby fungují s MSMQ 3,0 v systémech Windows XP a Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="6eca9-116">Both bindings work with MSMQ 3.0 on Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="6eca9-117">Při upgradu na službu MSMQ 4,0 v systému Windows Vista budou některé funkce vazeb dostupné.</span><span class="sxs-lookup"><span data-stu-id="6eca9-117">Certain features of the bindings become available when you upgrade to MSMQ 4.0 in Windows Vista.</span></span>

<span data-ttu-id="6eca9-118">**Otázka:** Jaké funkce <xref:System.ServiceModel.NetMsmqBinding> a <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> vazby jsou k dispozici ve službě MSMQ 4,0, ale ne v MSMQ 3,0?</span><span class="sxs-lookup"><span data-stu-id="6eca9-118">**Q:** What features of the <xref:System.ServiceModel.NetMsmqBinding> and <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> bindings are available in MSMQ 4.0 but not in MSMQ 3.0?</span></span>

<span data-ttu-id="6eca9-119">**A:** Ve službě MSMQ 4,0 jsou k dispozici následující funkce, které nejsou ve službě MSMQ 3,0:</span><span class="sxs-lookup"><span data-stu-id="6eca9-119">**A:** The following features are available in MSMQ 4.0 but not in MSMQ 3.0:</span></span>

- <span data-ttu-id="6eca9-120">Vlastní fronta nedoručených zpráv je podporována pouze ve službě MSMQ 4,0.</span><span class="sxs-lookup"><span data-stu-id="6eca9-120">Custom dead-letter queue is supported only on MSMQ 4.0.</span></span>

- <span data-ttu-id="6eca9-121">MSMQ 3,0 a 4,0 zpracovávají poškozené zprávy různě.</span><span class="sxs-lookup"><span data-stu-id="6eca9-121">MSMQ 3.0 and 4.0 handle poison messages differently.</span></span>

- <span data-ttu-id="6eca9-122">Pouze služba MSMQ 4,0 podporuje vzdálené čtení v transakčním režimu.</span><span class="sxs-lookup"><span data-stu-id="6eca9-122">Only MSMQ 4.0 supports remote transacted read.</span></span>

<span data-ttu-id="6eca9-123">Další informace najdete v tématu [rozdíly ve funkcích služby Řízení front v systémech Windows Vista, Windows Server 2003 a Windows XP](../../../../docs/framework/wcf/feature-details/diff-in-queue-in-vista-server-2003-windows-xp.md).</span><span class="sxs-lookup"><span data-stu-id="6eca9-123">For more information, see [Differences in Queuing Features in Windows Vista, Windows Server 2003, and Windows XP](../../../../docs/framework/wcf/feature-details/diff-in-queue-in-vista-server-2003-windows-xp.md).</span></span>

<span data-ttu-id="6eca9-124">**Otázka:** Můžu použít MSMQ 3,0 na jedné straně komunikace ve frontě a MSMQ 4,0 na druhé straně?</span><span class="sxs-lookup"><span data-stu-id="6eca9-124">**Q:** Can I use MSMQ 3.0 on one side of a queued communication and MSMQ 4.0 on the other side?</span></span>

<span data-ttu-id="6eca9-125">**Odpověď:** Ano.</span><span class="sxs-lookup"><span data-stu-id="6eca9-125">**A:** Yes.</span></span>

<span data-ttu-id="6eca9-126">**Otázka:** Chci integrovat stávající aplikace služby MSMQ s novými klienty nebo servery WCF.</span><span class="sxs-lookup"><span data-stu-id="6eca9-126">**Q:** I want to integrate existing MSMQ applications with new WCF clients or servers.</span></span> <span data-ttu-id="6eca9-127">Potřebuji upgradovat obě strany infrastruktury služby MSMQ?</span><span class="sxs-lookup"><span data-stu-id="6eca9-127">Do I need to upgrade both sides of my MSMQ infrastructure?</span></span>

<span data-ttu-id="6eca9-128">**Odpověď:** Ne.</span><span class="sxs-lookup"><span data-stu-id="6eca9-128">**A:** No.</span></span> <span data-ttu-id="6eca9-129">Nemusíte upgradovat na žádnou stranu na službu MSMQ 4,0.</span><span class="sxs-lookup"><span data-stu-id="6eca9-129">You do not have to upgrade to MSMQ 4.0 on either side.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="6eca9-130">Odstraňování problémů</span><span class="sxs-lookup"><span data-stu-id="6eca9-130">Troubleshooting</span></span>

<span data-ttu-id="6eca9-131">Tato část obsahuje odpovědi na nejčastější problémy při odstraňování potíží.</span><span class="sxs-lookup"><span data-stu-id="6eca9-131">This section contains answers to most common troubleshooting issues.</span></span> <span data-ttu-id="6eca9-132">Některé problémy, které jsou známá omezením, jsou popsány také v poznámkách k verzi.</span><span class="sxs-lookup"><span data-stu-id="6eca9-132">Some issues that are known limitations are also described in the release notes.</span></span>

<span data-ttu-id="6eca9-133">**Otázka:** Snažím se použít soukromou frontu a zobrazí se tato výjimka: `System.InvalidOperationException`: adresa URL je neplatná.</span><span class="sxs-lookup"><span data-stu-id="6eca9-133">**Q:** I am trying to use a private queue and I get the following exception: `System.InvalidOperationException`: The URL is invalid.</span></span> <span data-ttu-id="6eca9-134">Adresa URL pro frontu nesmí obsahovat znak $.</span><span class="sxs-lookup"><span data-stu-id="6eca9-134">The URL for the queue cannot contain the '$' character.</span></span> <span data-ttu-id="6eca9-135">Použijte syntaxi na adrese NET. MSMQ://machine/private/queueName a vyřešte soukromou frontu.</span><span class="sxs-lookup"><span data-stu-id="6eca9-135">Use the syntax in net.msmq://machine/private/queueName to address a private queue.</span></span>

<span data-ttu-id="6eca9-136">**A:** V konfiguraci a kódu prosím zkontrolujte identifikátor URI ve frontě.</span><span class="sxs-lookup"><span data-stu-id="6eca9-136">**A:** Please check the queue Uniform Resource Identifier (URI) in your configuration and code.</span></span> <span data-ttu-id="6eca9-137">Nepoužívejte v identifikátoru URI znak "$".</span><span class="sxs-lookup"><span data-stu-id="6eca9-137">Do not use the "$" character in the URI.</span></span> <span data-ttu-id="6eca9-138">Pokud například chcete adresovat soukromou frontu s názvem OrdersQueue, zadejte identifikátor URI as NET. MSMQ://localhost/private/ordersQueue.</span><span class="sxs-lookup"><span data-stu-id="6eca9-138">For example, to address a private queue named OrdersQueue, specify the URI as net.msmq://localhost/private/ordersQueue.</span></span>

<span data-ttu-id="6eca9-139">**Otázka:** Volání `ServiceHost.Open()` v naší aplikaci ve frontě vyvolá následující výjimku: `System.ArgumentException`: základní adresa nesmí obsahovat řetězec dotazu identifikátoru URI.</span><span class="sxs-lookup"><span data-stu-id="6eca9-139">**Q:** Calling `ServiceHost.Open()` on my queued application throws the following exception: `System.ArgumentException`: A base address cannot contain a URI query string.</span></span> <span data-ttu-id="6eca9-140">Proč?</span><span class="sxs-lookup"><span data-stu-id="6eca9-140">Why?</span></span>

<span data-ttu-id="6eca9-141">**A:** Ověřte identifikátor URI fronty v konfiguračním souboru a ve vašem kódu.</span><span class="sxs-lookup"><span data-stu-id="6eca9-141">**A:** Check the queue URI in your configuration file and in your code.</span></span> <span data-ttu-id="6eca9-142">I když fronty MSMQ podporují použití znaku "?", identifikátory URI interpretují tento znak jako začátek řetězcového dotazu.</span><span class="sxs-lookup"><span data-stu-id="6eca9-142">While MSMQ queues support the use of the '?' character, URIs interpret this character as the beginning of a string query.</span></span> <span data-ttu-id="6eca9-143">Chcete-li se tomuto problému vyhnout, použijte názvy front, které neobsahují znaky?.</span><span class="sxs-lookup"><span data-stu-id="6eca9-143">To avoid this issue, use queue names that do not contain '?' characters.</span></span>

<span data-ttu-id="6eca9-144">**Otázka:** Moje odeslání bylo úspěšné, ale na přijímači není vyvolána žádná operace služby.</span><span class="sxs-lookup"><span data-stu-id="6eca9-144">**Q:** My send succeeded but no service operation is invoked on the receiver.</span></span> <span data-ttu-id="6eca9-145">Proč?</span><span class="sxs-lookup"><span data-stu-id="6eca9-145">Why?</span></span>

<span data-ttu-id="6eca9-146">**A:** K určení odpovědi můžete použít následující kontrolní seznam:</span><span class="sxs-lookup"><span data-stu-id="6eca9-146">**A:** To determine the answer, work through the following check list:</span></span>

- <span data-ttu-id="6eca9-147">Ověřte, zda jsou požadavky transakční fronty kompatibilní se zadanými zárukami.</span><span class="sxs-lookup"><span data-stu-id="6eca9-147">Check that the transactional queue requirements are compatible with the assurances specified.</span></span> <span data-ttu-id="6eca9-148">Všimněte si následujících zásad:</span><span class="sxs-lookup"><span data-stu-id="6eca9-148">Note the following principles:</span></span>

  - <span data-ttu-id="6eca9-149">Můžete odesílat trvalé zprávy (datagramy a relace) s "právě jednou" ujištění (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `true`) pouze do transakční fronty.</span><span class="sxs-lookup"><span data-stu-id="6eca9-149">You can send durable messages (datagrams and sessions) with "exactly once" assurances (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `true`) only to a transactional queue.</span></span>

  - <span data-ttu-id="6eca9-150">Relace můžete odesílat pouze pomocí ujištění "právě jednou".</span><span class="sxs-lookup"><span data-stu-id="6eca9-150">You can send sessions only with "exactly once" assurances.</span></span>

  - <span data-ttu-id="6eca9-151">Aby bylo možné přijímat zprávy v relaci z transakční fronty, je nutné zadat transakci.</span><span class="sxs-lookup"><span data-stu-id="6eca9-151">A transaction is required to receive messages in a session from a transactional queue.</span></span>

  - <span data-ttu-id="6eca9-152">Můžete odesílat nebo přijímat nestálé nebo trvalé zprávy (pouze datagramy) bez ujištění (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `false`) pouze do netransakční fronty.</span><span class="sxs-lookup"><span data-stu-id="6eca9-152">You can send or receive volatile or durable messages (datagrams only) with no assurances (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `false`) only to a non-transactional queue.</span></span>

- <span data-ttu-id="6eca9-153">Ověřte frontu nedoručených zpráv.</span><span class="sxs-lookup"><span data-stu-id="6eca9-153">Check the dead-letter queue.</span></span> <span data-ttu-id="6eca9-154">Pokud se zde nacházejí zprávy, určete, proč nebyly dodány.</span><span class="sxs-lookup"><span data-stu-id="6eca9-154">If you find the messages there, determine why they were not delivered.</span></span>

- <span data-ttu-id="6eca9-155">Podívejte se na odchozí fronty pro připojení nebo problémy s adresou.</span><span class="sxs-lookup"><span data-stu-id="6eca9-155">Check the outgoing queues for connectivity or addressing problems.</span></span>

<span data-ttu-id="6eca9-156">**Otázka:** Zadal jsem vlastní frontu nedoručených zpráv, ale při spuštění aplikace odesílatele se zobrazí výjimka, že buď nebyla nalezena fronta nedoručených zpráv, nebo odesílající aplikace nemá oprávnění ke frontě nedoručených zpráv.</span><span class="sxs-lookup"><span data-stu-id="6eca9-156">**Q:** I have specified a custom dead-letter queue, but when I start the sender application, I get an exception that either the dead-letter queue is not found, or the sending application has no permission to the dead-letter queue.</span></span> <span data-ttu-id="6eca9-157">Proč se to děje?</span><span class="sxs-lookup"><span data-stu-id="6eca9-157">Why is this happening?</span></span>

<span data-ttu-id="6eca9-158">**A:** Vlastní identifikátor URI fronty nedoručených zpráv musí zahrnovat "localhost" nebo název počítače v prvním segmentu, například NET. MSMQ://localhost/private/myAppdead-letter Queue.</span><span class="sxs-lookup"><span data-stu-id="6eca9-158">**A:** The custom dead-letter queue URI must include a "localhost" or the computer name in the first segment, for example, net.msmq://localhost/private/myAppdead-letter queue.</span></span>

<span data-ttu-id="6eca9-159">**Otázka:** Je vždycky potřeba definovat vlastní frontu nedoručených zpráv, nebo má výchozí frontu nedoručených zpráv?</span><span class="sxs-lookup"><span data-stu-id="6eca9-159">**Q:** Is it always necessary to define a custom dead-letter queue, or is there a default dead-letter queue?</span></span>

<span data-ttu-id="6eca9-160">**A:** Pokud jsou záruky "právě jednou" (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `true`), a pokud nezadáte vlastní frontu nedoručených zpráv, výchozí hodnota je fronta nedoručených transakčních zpráv v rámci systému.</span><span class="sxs-lookup"><span data-stu-id="6eca9-160">**A:** If assurances are "exactly once" (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `true`), and if you do not specify a custom dead-letter queue, the default is a system-wide transactional dead-letter queue.</span></span>

<span data-ttu-id="6eca9-161">Pokud jsou záruky žádné (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `false`), není ve výchozím nastavení žádná funkce fronty nedoručených zpráv.</span><span class="sxs-lookup"><span data-stu-id="6eca9-161">If assurances are none (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `false`), then the default is no dead-letter queue functionality.</span></span>

<span data-ttu-id="6eca9-162">**Otázka:** Moje služba vyvolá v procesu SvcHost. Open se zprávou "požadavky na EndpointListener nelze splnit rozhraním ListenerFactory".</span><span class="sxs-lookup"><span data-stu-id="6eca9-162">**Q:** My service throws on SvcHost.Open with a message "EndpointListener requirements cannot be met by the ListenerFactory".</span></span> <span data-ttu-id="6eca9-163">Proč?</span><span class="sxs-lookup"><span data-stu-id="6eca9-163">Why?</span></span>

<span data-ttu-id="6eca9-164">A.</span><span class="sxs-lookup"><span data-stu-id="6eca9-164">A.</span></span> <span data-ttu-id="6eca9-165">Podívejte se na kontrakt služby.</span><span class="sxs-lookup"><span data-stu-id="6eca9-165">Check your service contract.</span></span> <span data-ttu-id="6eca9-166">Možná jste zapomněli do všech operací služby umístit "IsOneWay =`true`".</span><span class="sxs-lookup"><span data-stu-id="6eca9-166">You may have forgotten to put "IsOneWay=`true`" on all the service operations.</span></span> <span data-ttu-id="6eca9-167">Fronty podporují pouze jednosměrné operace služby.</span><span class="sxs-lookup"><span data-stu-id="6eca9-167">Queues support only one-way service operations.</span></span>

<span data-ttu-id="6eca9-168">**Otázka:** Ve frontě jsou zprávy, ale není vyvolána žádná operace služby.</span><span class="sxs-lookup"><span data-stu-id="6eca9-168">**Q:** There are messages in the queue but no service operation is invoked.</span></span> <span data-ttu-id="6eca9-169">Jaký je problém?</span><span class="sxs-lookup"><span data-stu-id="6eca9-169">What is the problem?</span></span>

<span data-ttu-id="6eca9-170">**A:** Zjistěte, jestli hostitel služby selhal.</span><span class="sxs-lookup"><span data-stu-id="6eca9-170">**A:** Determine if your service host is faulted.</span></span> <span data-ttu-id="6eca9-171">Můžete se podívat na trasování nebo implementaci `IErrorHandler`.</span><span class="sxs-lookup"><span data-stu-id="6eca9-171">You can check by looking at the trace or implementing `IErrorHandler`.</span></span> <span data-ttu-id="6eca9-172">Selhání hostitele služby ve výchozím nastavení, pokud je zjištěna nezpracovatelná zpráva.</span><span class="sxs-lookup"><span data-stu-id="6eca9-172">Service host faults, by default, if a poison message is detected.</span></span>

<span data-ttu-id="6eca9-173">**Otázka:** Ve frontě jsou zprávy, ale moje služba hostovaná ve frontě web není aktivovaná.</span><span class="sxs-lookup"><span data-stu-id="6eca9-173">**Q:** There are messages in the queue but my Web-hosted queued service is not getting activated.</span></span> <span data-ttu-id="6eca9-174">Proč?</span><span class="sxs-lookup"><span data-stu-id="6eca9-174">Why?</span></span>

<span data-ttu-id="6eca9-175">**A:** Nejběžnějším důvodem jsou oprávnění.</span><span class="sxs-lookup"><span data-stu-id="6eca9-175">**A:** The most common reason is permissions.</span></span>

1. <span data-ttu-id="6eca9-176">Zajistěte, aby byl proces `NetMsmqActivator` spuštěný, a identita `NetMsmqActivator` procesu má přidělené oprávnění ke čtení a hledání ve frontě.</span><span class="sxs-lookup"><span data-stu-id="6eca9-176">Ensure that the `NetMsmqActivator` process is running and the identity of the `NetMsmqActivator` process is given read and seek permission on the queue.</span></span>

2. <span data-ttu-id="6eca9-177">Pokud `NetMsmqActivator` sleduje fronty na vzdáleném počítači, zajistěte, aby `NetMsmqActivator` neběžely s omezeným tokenem.</span><span class="sxs-lookup"><span data-stu-id="6eca9-177">If the `NetMsmqActivator` is monitoring queues on a remote machine, ensure that `NetMsmqActivator` does not run under a restricted token.</span></span> <span data-ttu-id="6eca9-178">Spuštění `NetMsmqActivator` s neomezeným tokenem:</span><span class="sxs-lookup"><span data-stu-id="6eca9-178">To run the `NetMsmqActivator` with an unrestricted token:</span></span>

    ```console
    sc sidtype NetMsmqActivator unrestricted
    ```

<span data-ttu-id="6eca9-179">Problémy webového hostitele nesouvisející se zabezpečením odkazují na: [web hostující aplikaci ve frontě](../../../../docs/framework/wcf/feature-details/web-hosting-a-queued-application.md).</span><span class="sxs-lookup"><span data-stu-id="6eca9-179">For non-security related Web host issues refer to: [Web Hosting a Queued Application](../../../../docs/framework/wcf/feature-details/web-hosting-a-queued-application.md).</span></span>

<span data-ttu-id="6eca9-180">**Otázka:** Jaký je nejjednodušší způsob, jak získat přístup k relacím?</span><span class="sxs-lookup"><span data-stu-id="6eca9-180">**Q:** What is the easiest way to access sessions?</span></span>

<span data-ttu-id="6eca9-181">**A:** Nastavte AutoComplete =`true` u operace, která odpovídá poslední zprávě v relaci, a nastavte automatické dokončování =`false` u všech zbývajících operací služby.</span><span class="sxs-lookup"><span data-stu-id="6eca9-181">**A:** Set AutoComplete=`true` on the operation that corresponds to the last message in the session, and set AutoComplete=`false` on all remaining service operations.</span></span>

<span data-ttu-id="6eca9-182">**Otázka:** Proč moje služba při čtení z fronty, která obsahuje obě zprávy relace ve frontě a zprávy datagram zařazená do fronty, vyvolá `ProtocolException`?</span><span class="sxs-lookup"><span data-stu-id="6eca9-182">**Q:** Why does my service throw a `ProtocolException` when reading from a queue that contains both queued session messages and queued datagram messages?</span></span>

<span data-ttu-id="6eca9-183">**A:** Způsob, jakým se skládají zprávy ve frontě a zprávy datagramů, jsou tvořené zásadním rozdílem.</span><span class="sxs-lookup"><span data-stu-id="6eca9-183">**A:** There is a fundamental difference in the way queued session messages and queued datagram messages are composed.</span></span> <span data-ttu-id="6eca9-184">Proto služba, která očekává čtení zprávy ve frontě, nemůže přijmout zprávu datagramu ve frontě a služba, která očekává čtení zprávy datagramu ve frontě, nemůže získat zprávu relace.</span><span class="sxs-lookup"><span data-stu-id="6eca9-184">Because of this, a service that is expecting to read a queued session message cannot receive a queued datagram message and a service expecting to read a queued datagram message cannot receive a session message.</span></span> <span data-ttu-id="6eca9-185">Při pokusu o čtení obou typů zpráv ze stejné fronty je vyvolána následující výjimka:</span><span class="sxs-lookup"><span data-stu-id="6eca9-185">Attempting to read both types of messages from the same queue throws the following exception:</span></span>

```console
System.ServiceModel.MsmqPoisonMessageException: The transport channel detected a poison message. This occurred because the message exceeded the maximum number of delivery attempts or because the channel detected a fundamental problem with the message. The inner exception may contain additional information.
---> System.ServiceModel.ProtocolException: An incoming MSMQ message contained invalid or unexpected .NET Message Framing information in its body. The message cannot be received. Ensure that the sender is using a compatible service contract with a matching SessionMode.
```

<span data-ttu-id="6eca9-186">Fronta nedoručených zpráv systému, stejně jako jakákoli vlastní fronta nedoručených zpráv, je obzvláště náchylná k tomuto problému, pokud aplikace odesílá zprávy relace ve frontě i zprávy datagram ve stejném počítači.</span><span class="sxs-lookup"><span data-stu-id="6eca9-186">The system dead-letter queue, as well as any custom dead-letter queue, is particularly susceptible to this issue if an application sends both queued session messages and queued datagram messages from the same computer.</span></span> <span data-ttu-id="6eca9-187">Pokud zprávu nelze úspěšně odeslat, bude přesunuta do fronty nedoručených zpráv.</span><span class="sxs-lookup"><span data-stu-id="6eca9-187">If a message cannot be sent successfully, it is moved to the dead-letter queue.</span></span> <span data-ttu-id="6eca9-188">Za těchto okolností je možné mít ve frontě nedoručených zpráv obě relace i datagram.</span><span class="sxs-lookup"><span data-stu-id="6eca9-188">Under these circumstances, it is possible to have both session and datagram messages in the dead-letter queue.</span></span> <span data-ttu-id="6eca9-189">Neexistuje žádný způsob, jak při čtení z fronty oddělit oba typy zpráv za běhu, proto by aplikace neměly odesílat obě zprávy relací ve frontě a zprávy datagram ze stejného počítače.</span><span class="sxs-lookup"><span data-stu-id="6eca9-189">There is no way to separate both types of messages at runtime when reading from a queue, therefore, applications should not send both queued session messages and queued datagram messages from the same computer.</span></span>

### <a name="msmq-integration-specific-troubleshooting"></a><span data-ttu-id="6eca9-190">Integrace služby MSMQ: konkrétní řešení potíží</span><span class="sxs-lookup"><span data-stu-id="6eca9-190">MSMQ Integration: Specific Troubleshooting</span></span>

<span data-ttu-id="6eca9-191">**Otázka:** Při odeslání zprávy nebo při otevření hostitele služby se zobrazí chyba, která indikuje, že je schéma chybné.</span><span class="sxs-lookup"><span data-stu-id="6eca9-191">**Q:** When I send a message, or when I open the service host, I get an error that indicates the scheme is wrong.</span></span> <span data-ttu-id="6eca9-192">Proč?</span><span class="sxs-lookup"><span data-stu-id="6eca9-192">Why?</span></span>

<span data-ttu-id="6eca9-193">**A:** Při použití vazby integrace služby MSMQ je nutné použít schéma MSMQ. FormatName.</span><span class="sxs-lookup"><span data-stu-id="6eca9-193">**A:** When you use the MSMQ integration binding, you must use the msmq.formatname scheme.</span></span> <span data-ttu-id="6eca9-194">Například MSMQ. FormatName: DIRECT = OS: .\private $ \OrdersQueue.</span><span class="sxs-lookup"><span data-stu-id="6eca9-194">For example, msmq.formatname:DIRECT=OS:.\private$\OrdersQueue.</span></span> <span data-ttu-id="6eca9-195">Když ale zadáte vlastní frontu nedoručených zpráv, musíte použít schéma NET. MSMQ.</span><span class="sxs-lookup"><span data-stu-id="6eca9-195">But when you specify the custom dead-letter queue, you must use the net.msmq scheme.</span></span>

<span data-ttu-id="6eca9-196">**Otázka:** Když používám název veřejného nebo privátního formátu a v systému Windows Vista se otevře hostitel služby, zobrazí se chybová zpráva.</span><span class="sxs-lookup"><span data-stu-id="6eca9-196">**Q:** When I use a public or private format name and open the service host on Windows Vista, I get an error.</span></span> <span data-ttu-id="6eca9-197">Proč?</span><span class="sxs-lookup"><span data-stu-id="6eca9-197">Why?</span></span>

<span data-ttu-id="6eca9-198">**A:** Kanál pro integraci WCF v systému Windows Vista kontroluje, zda lze otevřít podfrontu pro hlavní frontu aplikace pro zpracování nezpracovatelných zpráv.</span><span class="sxs-lookup"><span data-stu-id="6eca9-198">**A:** The WCF integration channel on Windows Vista checks to see if a sub-queue can be opened for the main application queue for handling poison messages.</span></span> <span data-ttu-id="6eca9-199">Název podfronty je odvozen z identifikátoru URI služby MSMQ. FormatName předaného do naslouchacího procesu.</span><span class="sxs-lookup"><span data-stu-id="6eca9-199">The sub-queue name is derived from an msmq.formatname URI passed to the listener.</span></span> <span data-ttu-id="6eca9-200">Název podfronty v MSMQ může být pouze název přímého formátu.</span><span class="sxs-lookup"><span data-stu-id="6eca9-200">The sub-queue name in MSMQ can only be a direct format name.</span></span> <span data-ttu-id="6eca9-201">Zobrazí se chyba.</span><span class="sxs-lookup"><span data-stu-id="6eca9-201">So you see the error.</span></span> <span data-ttu-id="6eca9-202">Změňte identifikátor URI fronty na název přímého formátu.</span><span class="sxs-lookup"><span data-stu-id="6eca9-202">Change the queue URI to a direct format name.</span></span>

<span data-ttu-id="6eca9-203">**Otázka:** Při příjmu zprávy z aplikace služby MSMQ se zpráva nachází ve frontě a není přečtena přijímající aplikací WCF.</span><span class="sxs-lookup"><span data-stu-id="6eca9-203">**Q:** When receiving a message from an MSMQ application, the message sits in the queue and is not read by the receiving WCF application.</span></span> <span data-ttu-id="6eca9-204">Proč?</span><span class="sxs-lookup"><span data-stu-id="6eca9-204">Why?</span></span>

<span data-ttu-id="6eca9-205">**A:** Zkontrolujte, zda zpráva obsahuje tělo.</span><span class="sxs-lookup"><span data-stu-id="6eca9-205">**A:** Check to see whether the message has a body.</span></span> <span data-ttu-id="6eca9-206">Pokud zpráva neobsahuje žádné tělo, kanál integrace služby MSMQ zprávu ignoruje.</span><span class="sxs-lookup"><span data-stu-id="6eca9-206">If the message has no body, the MSMQ integration channel ignores the message.</span></span> <span data-ttu-id="6eca9-207">Implementujte `IErrorHandler` pro oznamování výjimek a kontrolu trasování.</span><span class="sxs-lookup"><span data-stu-id="6eca9-207">Implement `IErrorHandler` to be notified of exceptions and check the traces.</span></span>

### <a name="security-related-troubleshooting"></a><span data-ttu-id="6eca9-208">Řešení potíží souvisejících se zabezpečením</span><span class="sxs-lookup"><span data-stu-id="6eca9-208">Security-Related Troubleshooting</span></span>

<span data-ttu-id="6eca9-209">**Otázka:** Po spuštění ukázky, která používá výchozí vazbu v režimu pracovní skupiny, se zprávy jeví jako odesílané, ale příjemce je nikdy neobdrží.</span><span class="sxs-lookup"><span data-stu-id="6eca9-209">**Q:** When I run the sample that uses a default binding in workgroup mode, messages seem to get sent but are never received by the receiver.</span></span>

<span data-ttu-id="6eca9-210">**A:** Ve výchozím nastavení se zprávy podepisují pomocí interního certifikátu služby MSMQ, který vyžaduje adresářovou službu Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6eca9-210">**A:** By default, messages are signed using an MSMQ internal certificate that requires the Active Directory directory service.</span></span> <span data-ttu-id="6eca9-211">V režimu pracovní skupiny, protože služba Active Directory není k dispozici, podepisování zprávy se nezdařilo.</span><span class="sxs-lookup"><span data-stu-id="6eca9-211">In workgroup mode, because Active Directory is not available, signing the message fails.</span></span> <span data-ttu-id="6eca9-212">Proto je uvedena zpráva ve frontě nedoručených zpráv a příčině selhání, jako je například "chybný podpis".</span><span class="sxs-lookup"><span data-stu-id="6eca9-212">So the message lands in the dead-letter queue and failure cause, such as "Bad signature", is indicated.</span></span>

<span data-ttu-id="6eca9-213">Alternativním řešením je vypnout zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="6eca9-213">The workaround is to turn off security.</span></span> <span data-ttu-id="6eca9-214">Můžete to udělat nastavením <xref:System.ServiceModel.NetMsmqSecurity.Mode%2A> = <xref:System.ServiceModel.NetMsmqSecurityMode.None>, aby fungovalo v režimu pracovní skupiny.</span><span class="sxs-lookup"><span data-stu-id="6eca9-214">This is done by setting <xref:System.ServiceModel.NetMsmqSecurity.Mode%2A> = <xref:System.ServiceModel.NetMsmqSecurityMode.None> to make it work in workgroup mode.</span></span>

<span data-ttu-id="6eca9-215">Dalším řešením je získat <xref:System.ServiceModel.MsmqTransportSecurity> z vlastnosti <xref:System.ServiceModel.NetMsmqSecurity.Transport%2A> a nastavit ji na <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate>a nastavit klientský certifikát.</span><span class="sxs-lookup"><span data-stu-id="6eca9-215">Another workaround is to get the <xref:System.ServiceModel.MsmqTransportSecurity> from the <xref:System.ServiceModel.NetMsmqSecurity.Transport%2A> property and set it to <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate>, and set the client certificate.</span></span>

<span data-ttu-id="6eca9-216">Ještě dalším řešením je instalace služby MSMQ s integrací služby Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6eca9-216">Yet another workaround is to install MSMQ with Active Directory integration.</span></span>

<span data-ttu-id="6eca9-217">**Otázka:** Když pošlu zprávu s výchozí vazbou (zapnuté zabezpečení přenosu) ve službě Active Directory do fronty, zobrazí se zpráva "interní certifikát nebyl nalezen".</span><span class="sxs-lookup"><span data-stu-id="6eca9-217">**Q:** When I send a message with default binding (transport security turned on) in Active Directory to a queue, I get an "internal certificate not found" message.</span></span> <span data-ttu-id="6eca9-218">Návody opravit?</span><span class="sxs-lookup"><span data-stu-id="6eca9-218">How do I fix this?</span></span>

<span data-ttu-id="6eca9-219">**A:** To znamená, že certifikát ve službě Active Directory pro odesílatele musí být obnoven.</span><span class="sxs-lookup"><span data-stu-id="6eca9-219">**A:** This means that the certificate in Active Directory for the sender must be renewed.</span></span> <span data-ttu-id="6eca9-220">Provedete to tak, že otevřete **Ovládací panely**, **Nástroje pro správu**, **Správa počítače**, kliknete pravým tlačítkem myši na položku **MSMQ**a vyberete možnost **vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="6eca9-220">To do so, open **Control Panel**, **Administrative Tools**, **Computer Management**, right-click **MSMQ**, and select **Properties**.</span></span> <span data-ttu-id="6eca9-221">Vyberte kartu **certifikát uživatele** a klikněte na tlačítko **obnovit** .</span><span class="sxs-lookup"><span data-stu-id="6eca9-221">Select the **User Certificate** tab and click the **Renew** button.</span></span>

<span data-ttu-id="6eca9-222">**Otázka:** Když pošlu zprávu pomocí <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate> a určíte certifikát, který se má použít, zobrazí se zpráva "Neplatný certifikát".</span><span class="sxs-lookup"><span data-stu-id="6eca9-222">**Q:** When I send a message using <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate> and specify the certificate to use, I get an "Invalid certificate" message.</span></span> <span data-ttu-id="6eca9-223">Návody opravit?</span><span class="sxs-lookup"><span data-stu-id="6eca9-223">How do I fix this?</span></span>

<span data-ttu-id="6eca9-224">**A:** Nemůžete použít úložiště certifikátů místního počítače s režimem certifikátu.</span><span class="sxs-lookup"><span data-stu-id="6eca9-224">**A:** You cannot use a local machine certificate store with certificate mode.</span></span> <span data-ttu-id="6eca9-225">Je nutné zkopírovat certifikát z úložiště certifikátů počítače do úložiště s aktuálním uživatelem pomocí modulu snap-in Certifikáty.</span><span class="sxs-lookup"><span data-stu-id="6eca9-225">You have to copy the certificate from the machine certificate store to the current user store using the Certificate snap-in.</span></span> <span data-ttu-id="6eca9-226">Získání modulu snap-in certifikáty:</span><span class="sxs-lookup"><span data-stu-id="6eca9-226">To get the Certificate snap-in:</span></span>

1. <span data-ttu-id="6eca9-227">Klikněte na tlačítko **Start**, vyberte možnost **Spustit**, zadejte příkaz `mmc`a klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="6eca9-227">Click **Start**, select **Run**, type `mmc`, and click **OK**.</span></span>

2. <span data-ttu-id="6eca9-228">V **konzole Microsoft Management Console**otevřete nabídku **soubor** a vyberte možnost **Přidat nebo odebrat modul snap-in**.</span><span class="sxs-lookup"><span data-stu-id="6eca9-228">In the **Microsoft Management Console**, open the **File** menu and select **Add/Remove Snap-in**.</span></span>

3. <span data-ttu-id="6eca9-229">V dialogovém okně **Přidat nebo odebrat modul snap-in** klikněte na tlačítko **Přidat** .</span><span class="sxs-lookup"><span data-stu-id="6eca9-229">In the **Add/Remove Snap-in** dialog box, click the **Add** button.</span></span>

4. <span data-ttu-id="6eca9-230">V dialogovém okně **Přidat samostatný modul snap-in** vyberte certifikáty a klikněte na **Přidat**.</span><span class="sxs-lookup"><span data-stu-id="6eca9-230">In the **Add Standalone Snap-in** dialog box, select Certificates and click **Add**.</span></span>

5. <span data-ttu-id="6eca9-231">V dialogovém okně modul snap-in **certifikáty** vyberte **Můj uživatelský účet** a klikněte na **Dokončit**.</span><span class="sxs-lookup"><span data-stu-id="6eca9-231">In the **Certificates** snap-in dialog box, select **My user account,** and click **Finish**.</span></span>

6. <span data-ttu-id="6eca9-232">V dalším kroku přidejte další modul snap-in certifikáty pomocí předchozích kroků, ale tentokrát vyberte **účet počítače** a klikněte na **Další**.</span><span class="sxs-lookup"><span data-stu-id="6eca9-232">Next, add a second Certificates snap-in using the previous steps, but this time select **Computer account** and click **Next**.</span></span>

7. <span data-ttu-id="6eca9-233">Vyberte **místní počítač** a klikněte na **Dokončit**.</span><span class="sxs-lookup"><span data-stu-id="6eca9-233">Select **Local Computer** and click **Finish**.</span></span> <span data-ttu-id="6eca9-234">Nyní můžete přetahovat certifikáty z úložiště certifikátů počítače do aktuálního úložiště uživatele.</span><span class="sxs-lookup"><span data-stu-id="6eca9-234">You can now drag and drop certificates from the machine certificate store to the current user store.</span></span>

<span data-ttu-id="6eca9-235">**Otázka:** Když moje služba načte z fronty v jiném počítači v režimu pracovní skupiny, zobrazí se výjimka "přístup byl odepřen".</span><span class="sxs-lookup"><span data-stu-id="6eca9-235">**Q:** When my service reads from a queue on another computer in workgroup mode, I get an "access denied" exception.</span></span>

<span data-ttu-id="6eca9-236">**A:** V režimu pracovní skupiny, aby Vzdálená aplikace získala přístup do fronty, aplikace musí mít oprávnění pro přístup do fronty.</span><span class="sxs-lookup"><span data-stu-id="6eca9-236">**A:** In workgroup mode, for a remote application to gain access to the queue, the application must have permission to access the queue.</span></span> <span data-ttu-id="6eca9-237">Přidejte do seznamu řízení přístupu (ACL) fronty možnost anonymní přihlášení a udělte jí oprávnění ke čtení.</span><span class="sxs-lookup"><span data-stu-id="6eca9-237">Add "Anonymous login" to the queue's access control list (ACL) and give it read permission.</span></span>

<span data-ttu-id="6eca9-238">**Otázka:** Když klient síťové služby (nebo jakýkoli klient, který nemá účet domény) odešle zprávu ve frontě, odeslání se nezdařila s neplatným certifikátem.</span><span class="sxs-lookup"><span data-stu-id="6eca9-238">**Q:** When a network service client (or any client that does not have a domain account) sends a queued message, the send fails with an invalid certificate.</span></span> <span data-ttu-id="6eca9-239">Návody opravit?</span><span class="sxs-lookup"><span data-stu-id="6eca9-239">How do I fix this?</span></span>

<span data-ttu-id="6eca9-240">**A:** Ověřte konfiguraci vazby.</span><span class="sxs-lookup"><span data-stu-id="6eca9-240">**A:** Check the binding configuration.</span></span> <span data-ttu-id="6eca9-241">Výchozí vazba má zapnuté zabezpečení přenosu MSMQ pro podepsání zprávy.</span><span class="sxs-lookup"><span data-stu-id="6eca9-241">The default binding has MSMQ transport security turned on to sign the message.</span></span> <span data-ttu-id="6eca9-242">Vypnout.</span><span class="sxs-lookup"><span data-stu-id="6eca9-242">Turn it off.</span></span>

### <a name="remote-transacted-receives"></a><span data-ttu-id="6eca9-243">Vzdáleně transakční příjem</span><span class="sxs-lookup"><span data-stu-id="6eca9-243">Remote Transacted Receives</span></span>

<span data-ttu-id="6eca9-244">**Otázka:** Když mám frontu na počítači a a službu WCF, která čte zprávy z fronty v počítači B (scénář vzdáleného příjmu v provozu), zprávy se z fronty nečtou.</span><span class="sxs-lookup"><span data-stu-id="6eca9-244">**Q:** When I have a queue on machine A, and a WCF service that reads messages from a queue on machine B (the remote transacted receive scenario), messages are not read from the queue.</span></span> <span data-ttu-id="6eca9-245">Trasovací informace indikují, že se příjem nezdařil, zpráva "transakce nemůže být importována".</span><span class="sxs-lookup"><span data-stu-id="6eca9-245">Tracing information indicates the receive failed with the message "Transaction cannot be imported."</span></span> <span data-ttu-id="6eca9-246">Co můžete dělat na tento problém vyřešit?</span><span class="sxs-lookup"><span data-stu-id="6eca9-246">What can I do to fix this?</span></span>

<span data-ttu-id="6eca9-247">**A:** Existují tři možné příčiny:</span><span class="sxs-lookup"><span data-stu-id="6eca9-247">**A:** There are three possible reasons for this:</span></span>

- <span data-ttu-id="6eca9-248">Pokud pracujete v režimu domény, vzdálené transakční přijímání vyžaduje přístup k síti Microsoft DTC (Distributed Transaction Coordinator) (MSDTC).</span><span class="sxs-lookup"><span data-stu-id="6eca9-248">If you are in domain mode, remote transacted receive requires Microsoft Distributed Transaction Coordinator (MSDTC) network access.</span></span> <span data-ttu-id="6eca9-249">Tuto možnost můžete povolit pomocí **Přidat nebo odebrat součásti**.</span><span class="sxs-lookup"><span data-stu-id="6eca9-249">You can enable this using **Add/Remove Components**.</span></span>

  ![Snímek obrazovky, který ukazuje povolení přístupu k síti DTC.](./media/troubleshooting-queued-messaging/enable-distributed-transaction-coordinator-access.jpg)

- <span data-ttu-id="6eca9-251">Ověřte režim ověřování pro komunikaci se správcem transakcí.</span><span class="sxs-lookup"><span data-stu-id="6eca9-251">Check the authentication mode for communicating with the transaction manager.</span></span> <span data-ttu-id="6eca9-252">Pokud pracujete v režimu pracovní skupiny, je nutné vybrat možnost bez vyžadování ověřování.</span><span class="sxs-lookup"><span data-stu-id="6eca9-252">If you are in workgroup mode, "No Authentication Required" must be selected.</span></span> <span data-ttu-id="6eca9-253">Pokud jste v režimu domény, musíte vybrat možnost vzájemného ověřování.</span><span class="sxs-lookup"><span data-stu-id="6eca9-253">If you are in domain mode, then "Mutual Authentication Required" must be selected.</span></span>

  <span data-ttu-id="6eca9-254">![Povolování transakcí XA](../../../../docs/framework/wcf/feature-details/media/4f3695e0-fb0b-4c5b-afac-75f8860d2bb0.jpg "4f3695e0-fb0b-4c5b-afac-75f8860d2bb0")</span><span class="sxs-lookup"><span data-stu-id="6eca9-254">![Enabling XA transactions](../../../../docs/framework/wcf/feature-details/media/4f3695e0-fb0b-4c5b-afac-75f8860d2bb0.jpg "4f3695e0-fb0b-4c5b-afac-75f8860d2bb0")</span></span>

- <span data-ttu-id="6eca9-255">Ujistěte se, že je MSDTC v seznamu výjimek v nastavení **brány firewall pro připojení k Internetu** .</span><span class="sxs-lookup"><span data-stu-id="6eca9-255">Make sure that MSDTC is in the list of exceptions in the **Internet Connection Firewall** settings.</span></span>

- <span data-ttu-id="6eca9-256">Ujistěte se, že používáte systém Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="6eca9-256">Ensure that you are using Windows Vista.</span></span> <span data-ttu-id="6eca9-257">Služba MSMQ v systému Windows Vista podporuje vzdálené čtení v transakčním režimu.</span><span class="sxs-lookup"><span data-stu-id="6eca9-257">MSMQ on Windows Vista supports remote transacted read.</span></span> <span data-ttu-id="6eca9-258">Funkce MSMQ ve starších verzích Windows nepodporuje vzdálené čtení v režimu Transact.</span><span class="sxs-lookup"><span data-stu-id="6eca9-258">MSMQ on earlier Windows releases does not support remote transacted read.</span></span>

<span data-ttu-id="6eca9-259">**Otázka:** Když je služba čtena z fronty jako síťová služba, například na webovém hostiteli, proč se při čtení z fronty vyvolá výjimka odepření přístupu?</span><span class="sxs-lookup"><span data-stu-id="6eca9-259">**Q:** When the service reading from the queue is a network service, for example, in a Web host, why do I get an access-denied exception is raised when reading from the queue?</span></span>

<span data-ttu-id="6eca9-260">**A:** Přístup ke čtení síťové služby musí být přidán do seznamu ACL fronty, aby bylo zajištěno, že síťová služba bude moci číst z fronty.</span><span class="sxs-lookup"><span data-stu-id="6eca9-260">**A:** Network service read access must be added to the queue ACL to ensure that a network service can read from the queue.</span></span>

<span data-ttu-id="6eca9-261">**Otázka:** Můžu pomocí aktivační služby MSMQ aktivovat aplikace na základě zpráv ve frontě ve vzdáleném počítači?</span><span class="sxs-lookup"><span data-stu-id="6eca9-261">**Q:** Can I use the MSMQ activation service to activate applications based on messages in a queue on a remote machine?</span></span>

<span data-ttu-id="6eca9-262">**Odpověď:** Ano.</span><span class="sxs-lookup"><span data-stu-id="6eca9-262">**A:** Yes.</span></span> <span data-ttu-id="6eca9-263">K tomu je nutné nakonfigurovat aktivační službu MSMQ tak, aby běžela jako síťová služba, a do fronty ve vzdáleném počítači přidat přístup k síťové službě.</span><span class="sxs-lookup"><span data-stu-id="6eca9-263">To do this, you must configure the MSMQ activation service to run as a network service, and add network service access to the queue on the remote machine.</span></span>

## <a name="using-custom-msmq-bindings-with-receivecontext-enabled"></a><span data-ttu-id="6eca9-264">Použití vlastních vazeb MSMQ s povoleným kontextem ReceiveContext</span><span class="sxs-lookup"><span data-stu-id="6eca9-264">Using Custom MSMQ Bindings with ReceiveContext Enabled</span></span>

<span data-ttu-id="6eca9-265">Když použijete vlastní vazbu služby MSMQ s povoleným <xref:System.ServiceModel.Channels.ReceiveContext>m, příchozí zpráva bude používat vlákno fondu vláken, protože nativní služba MSMQ nepodporuje doplňování vstupu a výstupu pro asynchronní <xref:System.ServiceModel.Channels.ReceiveContext> přijímání.</span><span class="sxs-lookup"><span data-stu-id="6eca9-265">When using a custom MSMQ binding with <xref:System.ServiceModel.Channels.ReceiveContext> enabled processing an incoming message will use a thread pool thread because native MSMQ does not support I/O completion for asynchronous <xref:System.ServiceModel.Channels.ReceiveContext> receives.</span></span> <span data-ttu-id="6eca9-266">Důvodem je to, že zpracování takové zprávy používá interní transakce pro <xref:System.ServiceModel.Channels.ReceiveContext> a služba MSMQ nepodporuje asynchronní zpracování.</span><span class="sxs-lookup"><span data-stu-id="6eca9-266">This is because processing such a message uses internal transactions for <xref:System.ServiceModel.Channels.ReceiveContext> and MSMQ does not support asynchronous processing.</span></span> <span data-ttu-id="6eca9-267">Pokud chcete tento problém obejít, můžete do koncového bodu přidat <xref:System.ServiceModel.Description.SynchronousReceiveBehavior> pro vynucení synchronního zpracování nebo nastavení <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.MaxPendingReceives%2A> na 1.</span><span class="sxs-lookup"><span data-stu-id="6eca9-267">To work around this issue you can add a <xref:System.ServiceModel.Description.SynchronousReceiveBehavior> to the endpoint to force synchronous processing or set <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.MaxPendingReceives%2A> to 1.</span></span>
