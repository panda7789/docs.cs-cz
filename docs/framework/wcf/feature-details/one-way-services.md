---
title: Jednosměrné služby
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Communication Foundation [WCF], one-way service contracts
- WCF [WCF], one-way service contracts
- service contracts [WCF], defining one-way
ms.assetid: 19053a36-4492-45a3-bfe6-0365ee0205a3
ms.openlocfilehash: 0d69af40e4b9a0133e44b64b45466f9aac84ffe2
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/09/2020
ms.locfileid: "84598746"
---
# <a name="one-way-services"></a><span data-ttu-id="20af7-102">Jednosměrné služby</span><span class="sxs-lookup"><span data-stu-id="20af7-102">One-Way Services</span></span>
<span data-ttu-id="20af7-103">Výchozím chováním operace služby je vzor požadavek-odpověď.</span><span class="sxs-lookup"><span data-stu-id="20af7-103">The default behavior of a service operation is the request-reply pattern.</span></span> <span data-ttu-id="20af7-104">Ve vzoru požadavek-odpověď klient čeká na odpověď, a to i v případě, že je operace služby reprezentována v kódu jako `void` metoda.</span><span class="sxs-lookup"><span data-stu-id="20af7-104">In a request-reply pattern, the client waits for the reply message, even if the service operation is represented in code as a `void` method.</span></span> <span data-ttu-id="20af7-105">U jednosměrné operace se přenáší jenom jedna zpráva.</span><span class="sxs-lookup"><span data-stu-id="20af7-105">With a one-way operation, only one message is transmitted.</span></span> <span data-ttu-id="20af7-106">Příjemce neposílá zprávu s odpovědí ani odesílatel neočekává.</span><span class="sxs-lookup"><span data-stu-id="20af7-106">The receiver does not send a reply message, nor does the sender expect one.</span></span>  
  
 <span data-ttu-id="20af7-107">Použijte jednosměrný vzor návrhu:</span><span class="sxs-lookup"><span data-stu-id="20af7-107">Use the one-way design pattern:</span></span>  
  
- <span data-ttu-id="20af7-108">Když klient musí volat operace a není ovlivněn výsledkem operace na úrovni operace.</span><span class="sxs-lookup"><span data-stu-id="20af7-108">When the client must call operations and is not affected by the result of the operation at the operation level.</span></span>  
  
- <span data-ttu-id="20af7-109">Při použití <xref:System.ServiceModel.NetMsmqBinding> <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> třídy nebo.</span><span class="sxs-lookup"><span data-stu-id="20af7-109">When using the <xref:System.ServiceModel.NetMsmqBinding> or the <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> class.</span></span> <span data-ttu-id="20af7-110">(Další informace o tomto scénáři najdete v tématu [fronty v WCF](queues-in-wcf.md).)</span><span class="sxs-lookup"><span data-stu-id="20af7-110">(For more information about this scenario, see [Queues in WCF](queues-in-wcf.md).)</span></span>  
  
 <span data-ttu-id="20af7-111">Pokud je operace jednosměrná, není k dispozici žádná zpráva s odpovědí, která by mohla přenášet informace o chybách zpět do klienta.</span><span class="sxs-lookup"><span data-stu-id="20af7-111">When an operation is one-way, there is no response message to carry error information back to the client.</span></span> <span data-ttu-id="20af7-112">Chybové stavy můžete detekovat pomocí funkcí podkladové vazby. například spolehlivé relace nebo návrh duplexního kontraktu služby, který používá 2 1 operací – jednosměrná smlouva od klienta k volání operace služby a další jednosměrnou smlouvu mezi službou a klientem, aby služba mohla odesílat chyby do klienta pomocí zpětného volání, které klient implementuje.</span><span class="sxs-lookup"><span data-stu-id="20af7-112">You can detect error conditions by using features of the underlying binding, such as reliable sessions, or by designing a duplex service contract that uses two one-way operations—a one-way contract from the client to the service to call service operation and another one-way contract between the service and the client so that the service can send back faults to the client using a callback that the client implements.</span></span>  
  
 <span data-ttu-id="20af7-113">Chcete-li vytvořit jednosměrný kontrakt služby, definujte kontrakt služby, použijte <xref:System.ServiceModel.OperationContractAttribute> pro každou operaci třídu a nastavte <xref:System.ServiceModel.OperationContractAttribute.IsOneWay%2A> vlastnost na hodnotu `true` , jak je znázorněno v následujícím ukázkovém kódu.</span><span class="sxs-lookup"><span data-stu-id="20af7-113">To create a one-way service contract, define your service contract, apply the <xref:System.ServiceModel.OperationContractAttribute> class to each operation, and set the <xref:System.ServiceModel.OperationContractAttribute.IsOneWay%2A> property to `true`, as shown in the following sample code.</span></span>  
  
```csharp
[ServiceContract(Namespace="http://Microsoft.ServiceModel.Samples")]  
public interface IOneWayCalculator  
{  
    [OperationContract(IsOneWay=true)]  
    void Add(double n1, double n2);  
    [OperationContract(IsOneWay = true)]  
    void Subtract(double n1, double n2);  
    [OperationContract(IsOneWay = true)]  
    void Multiply(double n1, double n2);  
    [OperationContract(IsOneWay = true)]  
    void Divide(double n1, double n2);  
}  
```  
  
 <span data-ttu-id="20af7-114">Úplný příklad naleznete v ukázce [jednosměrového](../samples/one-way.md) vzorku.</span><span class="sxs-lookup"><span data-stu-id="20af7-114">For a complete example, see the [One-Way](../samples/one-way.md) sample.</span></span>  
  
## <a name="clients-blocking-with-one-way-operations"></a><span data-ttu-id="20af7-115">Klienti, kteří blokují jednosměrné operace</span><span class="sxs-lookup"><span data-stu-id="20af7-115">Clients Blocking with One-Way Operations</span></span>  
 <span data-ttu-id="20af7-116">Je důležité si uvědomit, že i když se některé jednosměrné aplikace vrátí hned po zápisu odchozích dat do síťového připojení, v několika scénářích může implementace vazby nebo služby způsobit, že klient WCF bude blokovat pomocí jednosměrných operací.</span><span class="sxs-lookup"><span data-stu-id="20af7-116">It is important to realize that while some one-way applications return as soon as the outbound data is written to the network connection, in several scenarios the implementation of a binding or of a service can cause a WCF client to block using one-way operations.</span></span> <span data-ttu-id="20af7-117">V klientských aplikacích WCF se objekt klienta WCF nevrátí, dokud nebudou výstupní data zapsána do síťového připojení.</span><span class="sxs-lookup"><span data-stu-id="20af7-117">In WCF client applications, the WCF client object does not return until the outbound data has been written to the network connection.</span></span> <span data-ttu-id="20af7-118">To platí pro všechny vzory výměny zpráv, včetně jednosměrných operací; To znamená, že při každém problému zápisu dat do přenosu nebude klient vracet.</span><span class="sxs-lookup"><span data-stu-id="20af7-118">This is true for all message exchange patterns, including one-way operations; this means that any problem writing the data to the transport prevents the client from returning.</span></span> <span data-ttu-id="20af7-119">V závislosti na problému může být výsledkem výjimka nebo zpoždění při odesílání zpráv službě.</span><span class="sxs-lookup"><span data-stu-id="20af7-119">Depending upon the problem, the result could be an exception or a delay in sending messages to the service.</span></span>  
  
 <span data-ttu-id="20af7-120">Například pokud přenos nemůže najít koncový bod, <xref:System.ServiceModel.EndpointNotFoundException?displayProperty=nameWithType> je vyvolána výjimka bez nadměrné prodlevy.</span><span class="sxs-lookup"><span data-stu-id="20af7-120">For example, if the transport cannot find the endpoint, a <xref:System.ServiceModel.EndpointNotFoundException?displayProperty=nameWithType> exception is thrown without much delay.</span></span> <span data-ttu-id="20af7-121">Je ale také možné, že služba nemůže z nějakého důvodu načíst data z nějakého z důvodů, což zabrání tomu, aby se operace odeslání přenosu od klienta vracela.</span><span class="sxs-lookup"><span data-stu-id="20af7-121">However, it is also possible that the service is unable to read the data off the wire for some reason, which prevents the client transport send operation from returning.</span></span> <span data-ttu-id="20af7-122">V takových případech, pokud <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A?displayProperty=nameWithType> je překročena doba pro vazbu přenosů klientů, <xref:System.TimeoutException?displayProperty=nameWithType> je vyvolána výjimka, ale ne až do překročení časového limitu.</span><span class="sxs-lookup"><span data-stu-id="20af7-122">In these cases, if the <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A?displayProperty=nameWithType> period on the client transport binding is exceeded, a <xref:System.TimeoutException?displayProperty=nameWithType> is thrown—but not until the timeout period has been exceeded.</span></span> <span data-ttu-id="20af7-123">Je také možné vyvolávat tolik zpráv ve službě, které ji služba nemůže zpracovat po určitou chvíli.</span><span class="sxs-lookup"><span data-stu-id="20af7-123">It is also possible to fire so many messages at a service that the service cannot process them past a certain point.</span></span> <span data-ttu-id="20af7-124">V takovém případě je to například jednosměrné klientské bloky, dokud služba nebude moci zpracovat zprávy nebo dokud není vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="20af7-124">In this case, too, the one-way client blocks until the service can process the messages or until an exception is thrown.</span></span>  
  
 <span data-ttu-id="20af7-125">Další variantou je situace, kdy <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> je vlastnost služby nastavená na <xref:System.ServiceModel.ConcurrencyMode.Single> a vazba používá relace.</span><span class="sxs-lookup"><span data-stu-id="20af7-125">Another variation is the situation in which the service <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> property is set to <xref:System.ServiceModel.ConcurrencyMode.Single> and the binding uses sessions.</span></span> <span data-ttu-id="20af7-126">V takovém případě dispečer vynutil řazení příchozích zpráv (požadavek relací), což brání v následném čtení těchto zpráv ze sítě, dokud služba nezpracovává předchozí zprávu pro danou relaci.</span><span class="sxs-lookup"><span data-stu-id="20af7-126">In this case, the dispatcher enforces ordering on the incoming messages (a requirement of sessions), which prevents subsequent messages from being read off the network until the service has processed the preceding message for that session.</span></span> <span data-ttu-id="20af7-127">Znovu klientské bloky, ale i to, jestli dojde k výjimce, závisí na tom, jestli je služba schopná zpracovat čekání na data před nastavením časového limitu v klientovi.</span><span class="sxs-lookup"><span data-stu-id="20af7-127">Again, the client blocks, but whether an exception occurs depends upon whether the service is able to process the waiting data prior to the timeout settings on the client.</span></span>  
  
 <span data-ttu-id="20af7-128">Některé z těchto potíží můžete zmírnit vložením vyrovnávací paměti mezi objektem klienta a operací odeslání klientského přenosu.</span><span class="sxs-lookup"><span data-stu-id="20af7-128">You can mitigate some of this problem by inserting a buffer between the client object and the client transport's send operation.</span></span> <span data-ttu-id="20af7-129">Například použití asynchronních volání nebo použití fronty zpráv v paměti může umožnit rychlé vrácení objektu klienta.</span><span class="sxs-lookup"><span data-stu-id="20af7-129">For example, using asynchronous calls or using an in-memory message queue can enable the client object to return quickly.</span></span> <span data-ttu-id="20af7-130">Oba přístupy můžou zvýšit funkčnost, ale velikost fondu vláken a fronty zpráv pořád vynutila omezení.</span><span class="sxs-lookup"><span data-stu-id="20af7-130">Both approaches may increase functionality, but the size of the thread pool and the message queue still enforce limits.</span></span>  
  
 <span data-ttu-id="20af7-131">Doporučuje se místo toho, abyste prozkoumali různé ovládací prvky ve službě i na straně klienta, a pak otestujete scénáře vaší aplikace a určíte nejlepší konfiguraci na obou stranách.</span><span class="sxs-lookup"><span data-stu-id="20af7-131">It is recommended, instead, that you examine the various controls on the service as well as on the client, and then test your application scenarios to determine the best configuration on either side.</span></span> <span data-ttu-id="20af7-132">Pokud například použití relací blokuje zpracování zpráv ve službě, můžete nastavit <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> vlastnost na <xref:System.ServiceModel.InstanceContextMode.PerCall> tak, aby každá zpráva mohla být zpracována jinou instancí služby, a nastavit na, aby <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> bylo možné <xref:System.ServiceModel.ConcurrencyMode.Multiple> odesílat zprávy najednou více než jedno vlákno.</span><span class="sxs-lookup"><span data-stu-id="20af7-132">For example, if the use of sessions is blocking the processing of messages on your service, you can set the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.InstanceContextMode.PerCall> so that each message can be processed by a different service instance, and set the <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> to <xref:System.ServiceModel.ConcurrencyMode.Multiple> in order to allow more than one thread to dispatch messages at a time.</span></span> <span data-ttu-id="20af7-133">Další možností je zvýšit kvóty čtení pro vazby služby a klienta.</span><span class="sxs-lookup"><span data-stu-id="20af7-133">Another approach is to increase the read quotas of the service and client bindings.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="20af7-134">Viz také</span><span class="sxs-lookup"><span data-stu-id="20af7-134">See also</span></span>

- [<span data-ttu-id="20af7-135">Jednosměrný</span><span class="sxs-lookup"><span data-stu-id="20af7-135">One-Way</span></span>](../samples/one-way.md)
