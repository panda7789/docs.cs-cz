---
title: Identita a ověřování služby
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- authentication [WCF], specifying the identity of a service
ms.assetid: a4c8f52c-5b30-45c4-a545-63244aba82be
ms.openlocfilehash: 6c12c3aadf53f9fddef2f0b0124994db15565cb5
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/09/2020
ms.locfileid: "84600371"
---
# <a name="service-identity-and-authentication"></a><span data-ttu-id="cd24d-102">Identita a ověřování služby</span><span class="sxs-lookup"><span data-stu-id="cd24d-102">Service Identity and Authentication</span></span>
<span data-ttu-id="cd24d-103">*Identita koncového bodu* služby je hodnota generovaná z jazyka WSDL (Service Web Services Description Language).</span><span class="sxs-lookup"><span data-stu-id="cd24d-103">A service's *endpoint identity* is a value generated from the service Web Services Description Language (WSDL).</span></span> <span data-ttu-id="cd24d-104">Tato hodnota se rozšíří na libovolného klienta, který se používá k ověření služby.</span><span class="sxs-lookup"><span data-stu-id="cd24d-104">This value, propagated to any client, is used to authenticate the service.</span></span> <span data-ttu-id="cd24d-105">Poté, co klient zahájí komunikaci s koncovým bodem a služba se sama ověří pro klienta, klient porovná hodnotu identity koncového bodu se skutečnou hodnotou vrácenou procesem ověřování koncového bodu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-105">After the client initiates a communication to an endpoint and the service authenticates itself to the client, the client compares the endpoint identity value with the actual value the endpoint authentication process returned.</span></span> <span data-ttu-id="cd24d-106">Pokud se shodují, je zajištěno, že klient kontaktoval očekávaný koncový bod služby.</span><span class="sxs-lookup"><span data-stu-id="cd24d-106">If they match, the client is assured it has contacted the expected service endpoint.</span></span> <span data-ttu-id="cd24d-107">Tato funkce je chráněná proti *útokům phishing* tím, že brání klientovi v přesměrování na koncový bod hostovaný škodlivou službou.</span><span class="sxs-lookup"><span data-stu-id="cd24d-107">This functions as a protection against *phishing* by preventing a client from being redirected to an endpoint hosted by a malicious service.</span></span>  
  
 <span data-ttu-id="cd24d-108">Ukázkovou aplikaci, která demonstruje nastavení identity, najdete v tématu [Ukázka identity služby](../samples/service-identity-sample.md).</span><span class="sxs-lookup"><span data-stu-id="cd24d-108">For a sample application that demonstrates identity setting, see [Service Identity Sample](../samples/service-identity-sample.md).</span></span> <span data-ttu-id="cd24d-109">Další informace o koncových bodech a adresách koncových bodů najdete v tématu [adresy](endpoint-addresses.md).</span><span class="sxs-lookup"><span data-stu-id="cd24d-109">For more information about endpoints and endpoint addresses, see [Addresses](endpoint-addresses.md).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="cd24d-110">Pokud pro ověřování použijete NT LanMan (NTLM), identita služby se neověří, protože v části NTLM není klient schopen Server ověřit.</span><span class="sxs-lookup"><span data-stu-id="cd24d-110">When you use NT LanMan (NTLM) for authentication, the service identity is not checked because, under NTLM, the client is unable to authenticate the server.</span></span> <span data-ttu-id="cd24d-111">Protokol NTLM se používá v případě, že jsou počítače součástí pracovní skupiny systému Windows nebo pokud používáte starší verzi systému Windows, která nepodporuje ověřování pomocí protokolu Kerberos.</span><span class="sxs-lookup"><span data-stu-id="cd24d-111">NTLM is used when computers are part of a Windows workgroup, or when running an older version of Windows that does not support Kerberos authentication.</span></span>  
  
 <span data-ttu-id="cd24d-112">Když klient inicializuje zabezpečený kanál pro odeslání zprávy službě přes něj, infrastruktura služby Windows Communication Foundation (WCF) ověří službu a pošle zprávu pouze v případě, že identita služby odpovídá identitě zadané v adrese koncového bodu, kterou klient používá.</span><span class="sxs-lookup"><span data-stu-id="cd24d-112">When the client initiates a secure channel to send a message to a service over it, the Windows Communication Foundation (WCF) infrastructure authenticates the service, and only sends the message if the service identity matches the identity specified in the endpoint address the client uses.</span></span>  
  
 <span data-ttu-id="cd24d-113">Zpracování identity se skládá z následujících fází:</span><span class="sxs-lookup"><span data-stu-id="cd24d-113">Identity processing consists of the following stages:</span></span>  
  
- <span data-ttu-id="cd24d-114">V době návrhu určí vývojář klienta identitu služby z metadat koncového bodu (zveřejněných prostřednictvím WSDL).</span><span class="sxs-lookup"><span data-stu-id="cd24d-114">At design time, the client developer determines the service's identity from the endpoint's metadata (exposed through WSDL).</span></span>  
  
- <span data-ttu-id="cd24d-115">Klientská aplikace za běhu kontroluje deklarace přihlašovacích údajů zabezpečení služby předtím, než posílá jakékoli zprávy službě.</span><span class="sxs-lookup"><span data-stu-id="cd24d-115">At runtime, the client application checks the claims of the service's security credentials before sending any messages to the service.</span></span>  
  
 <span data-ttu-id="cd24d-116">Zpracování identity na klientovi je obdobné jako ověřování klientů ve službě.</span><span class="sxs-lookup"><span data-stu-id="cd24d-116">Identity processing on the client is analogous to client authentication on the service.</span></span> <span data-ttu-id="cd24d-117">Zabezpečená služba nespustí kód, dokud nebudou pověření klienta ověřena.</span><span class="sxs-lookup"><span data-stu-id="cd24d-117">A secure service does not execute code until the client's credentials have been authenticated.</span></span> <span data-ttu-id="cd24d-118">Podobně klient neodesílá zprávy službě, dokud nejsou ověřeny přihlašovací údaje služby na základě toho, co je v metadatech služby známo předem.</span><span class="sxs-lookup"><span data-stu-id="cd24d-118">Likewise, the client does not send messages to the service until the service's credentials have been authenticated based on what is known in advance from the service's metadata.</span></span>  
  
 <span data-ttu-id="cd24d-119"><xref:System.ServiceModel.EndpointAddress.Identity%2A>Vlastnost <xref:System.ServiceModel.EndpointAddress> třídy představuje identitu služby volanou klientem.</span><span class="sxs-lookup"><span data-stu-id="cd24d-119">The <xref:System.ServiceModel.EndpointAddress.Identity%2A> property of the <xref:System.ServiceModel.EndpointAddress> class represents the identity of the service called by the client.</span></span> <span data-ttu-id="cd24d-120">Služba publikuje <xref:System.ServiceModel.EndpointAddress.Identity%2A> ve svých metadatech.</span><span class="sxs-lookup"><span data-stu-id="cd24d-120">The service publishes the <xref:System.ServiceModel.EndpointAddress.Identity%2A> in its metadata.</span></span> <span data-ttu-id="cd24d-121">Když vývojář klienta spustí nástroj pro dodané [metadata (Svcutil. exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md) proti koncovému bodu služby, vygenerovaná konfigurace obsahuje hodnotu <xref:System.ServiceModel.EndpointAddress.Identity%2A> Vlastnosti služby.</span><span class="sxs-lookup"><span data-stu-id="cd24d-121">When the client developer runs the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md) against the service endpoint, the generated configuration contains the value of the service's <xref:System.ServiceModel.EndpointAddress.Identity%2A> property.</span></span> <span data-ttu-id="cd24d-122">Infrastruktura WCF (Pokud je nakonfigurovaná s zabezpečením) ověří, že služba má zadanou identitu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-122">The WCF infrastructure (if configured with security) verifies that the service possesses the identity specified.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="cd24d-123">Metadata obsahují očekávanou identitu služby, proto doporučujeme, abyste metadata služby vystavili zabezpečeným způsobem, například vytvořením koncového bodu HTTPS pro službu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-123">The metadata contains the expected identity of the service, so it is recommended that you expose the service metadata through secure means, for example, by creating an HTTPS endpoint for the service.</span></span> <span data-ttu-id="cd24d-124">Další informace najdete v tématu [Postup: zabezpečení koncových bodů metadat](how-to-secure-metadata-endpoints.md).</span><span class="sxs-lookup"><span data-stu-id="cd24d-124">For more information, see [How to: Secure Metadata Endpoints](how-to-secure-metadata-endpoints.md).</span></span>  
  
## <a name="identity-types"></a><span data-ttu-id="cd24d-125">Typy identit</span><span class="sxs-lookup"><span data-stu-id="cd24d-125">Identity Types</span></span>  
 <span data-ttu-id="cd24d-126">Služba může poskytovat šest typů identit.</span><span class="sxs-lookup"><span data-stu-id="cd24d-126">A service can provide six types of identities.</span></span> <span data-ttu-id="cd24d-127">Každý typ identity odpovídá prvku, který může být obsažen uvnitř `<identity>` elementu v konfiguraci.</span><span class="sxs-lookup"><span data-stu-id="cd24d-127">Each identity type corresponds to an element that can be contained inside the `<identity>` element in configuration.</span></span> <span data-ttu-id="cd24d-128">Použitý typ závisí na scénáři a požadavcích na zabezpečení služby.</span><span class="sxs-lookup"><span data-stu-id="cd24d-128">The type used depends on the scenario and the service's security requirements.</span></span> <span data-ttu-id="cd24d-129">V následující tabulce jsou popsány jednotlivé typy identity.</span><span class="sxs-lookup"><span data-stu-id="cd24d-129">The following table describes each identity type.</span></span>  
  
|<span data-ttu-id="cd24d-130">Typ identity</span><span class="sxs-lookup"><span data-stu-id="cd24d-130">Identity type</span></span>|<span data-ttu-id="cd24d-131">Popis</span><span class="sxs-lookup"><span data-stu-id="cd24d-131">Description</span></span>|<span data-ttu-id="cd24d-132">Typický scénář</span><span class="sxs-lookup"><span data-stu-id="cd24d-132">Typical scenario</span></span>|  
|-------------------|-----------------|----------------------|  
|<span data-ttu-id="cd24d-133">DNS (Domain Name System)</span><span class="sxs-lookup"><span data-stu-id="cd24d-133">Domain Name System (DNS)</span></span>|<span data-ttu-id="cd24d-134">Tento prvek použijte s certifikáty X. 509 nebo účty systému Windows.</span><span class="sxs-lookup"><span data-stu-id="cd24d-134">Use this element with X.509 certificates or Windows accounts.</span></span> <span data-ttu-id="cd24d-135">Porovnává název DNS zadaný v přihlašovacích údajích s hodnotou zadanou v tomto elementu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-135">It compares the DNS name specified in the credential with the value specified in this element.</span></span>|<span data-ttu-id="cd24d-136">Kontrolu DNS umožňuje používat certifikáty s názvy DNS nebo subjektu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-136">A DNS check enables you to use certificates with DNS or subject names.</span></span> <span data-ttu-id="cd24d-137">Pokud se certifikát vydává znovu se stejným názvem DNS nebo subjektu, je tato kontroler identity stále platná.</span><span class="sxs-lookup"><span data-stu-id="cd24d-137">If a certificate is reissued with the same DNS or subject name, then the identity check is still valid.</span></span> <span data-ttu-id="cd24d-138">Když se certifikát znovu vydá, získá nový klíč RSA, ale uchová stejný název DNS nebo subjektu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-138">When a certificate is reissued, it gets a new RSA key but retains the same DNS or subject name.</span></span> <span data-ttu-id="cd24d-139">To znamená, že klienti nemusí aktualizovat informace o identitě služby.</span><span class="sxs-lookup"><span data-stu-id="cd24d-139">This means that clients do not have to update their identity information about the service.</span></span>|  
|<span data-ttu-id="cd24d-140">Certifikát.</span><span class="sxs-lookup"><span data-stu-id="cd24d-140">Certificate.</span></span> <span data-ttu-id="cd24d-141">Výchozí hodnota, pokud `ClientCredentialType` je nastavena na certifikát.</span><span class="sxs-lookup"><span data-stu-id="cd24d-141">The default when `ClientCredentialType` is set to Certificate.</span></span>|<span data-ttu-id="cd24d-142">Tento prvek určuje hodnotu certifikátu X. 509 zakódovaného ve formátu base64, která se má porovnat s klientem.</span><span class="sxs-lookup"><span data-stu-id="cd24d-142">This element specifies a Base64-encoded X.509 certificate value to compare with the client.</span></span><br /><br /> <span data-ttu-id="cd24d-143">Tento prvek použijte také při použití služby CardSpace jako přihlašovacích údajů pro ověření služby.</span><span class="sxs-lookup"><span data-stu-id="cd24d-143">Also use this element when using a CardSpace as a credential to authenticate the service.</span></span>|<span data-ttu-id="cd24d-144">Tento prvek omezuje ověřování na jeden certifikát na základě jeho hodnoty kryptografického otisku.</span><span class="sxs-lookup"><span data-stu-id="cd24d-144">This element restricts authentication to a single certificate based upon its thumbprint value.</span></span> <span data-ttu-id="cd24d-145">To umožňuje striktní ověřování, protože hodnoty kryptografických otisků jsou jedinečné.</span><span class="sxs-lookup"><span data-stu-id="cd24d-145">This enables stricter authentication because thumbprint values are unique.</span></span> <span data-ttu-id="cd24d-146">K tomu dochází s jednou výstrahou: Pokud se certifikát vydává znovu se stejným názvem subjektu, má také nový kryptografický otisk.</span><span class="sxs-lookup"><span data-stu-id="cd24d-146">This comes with one caveat: If the certificate is reissued with the same Subject name, it also has a new Thumbprint.</span></span> <span data-ttu-id="cd24d-147">Proto klienti nebudou moci ověřit službu, pokud není známý nový kryptografický otisk.</span><span class="sxs-lookup"><span data-stu-id="cd24d-147">Therefore, clients are not able to validate the service unless the new thumbprint is known.</span></span> <span data-ttu-id="cd24d-148">Další informace o hledání kryptografického otisku certifikátu naleznete v tématu [How to: načítají se kryptografický otisk certifikátu](how-to-retrieve-the-thumbprint-of-a-certificate.md).</span><span class="sxs-lookup"><span data-stu-id="cd24d-148">For more information about finding a certificate's thumbprint, see [How to: Retrieve the Thumbprint of a Certificate](how-to-retrieve-the-thumbprint-of-a-certificate.md).</span></span>|  
|<span data-ttu-id="cd24d-149">Odkaz na certifikát</span><span class="sxs-lookup"><span data-stu-id="cd24d-149">Certificate Reference</span></span>|<span data-ttu-id="cd24d-150">Stejné jako dříve popsaná možnost certifikátu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-150">Identical to the Certificate option described previously.</span></span> <span data-ttu-id="cd24d-151">Tento element však umožňuje zadat název certifikátu a umístění úložiště, ze kterého se má certifikát načíst.</span><span class="sxs-lookup"><span data-stu-id="cd24d-151">However, this element enables you to specify a certificate name and store location from which to retrieve the certificate.</span></span>|<span data-ttu-id="cd24d-152">Stejné jako scénář certifikátu popsaný výše.</span><span class="sxs-lookup"><span data-stu-id="cd24d-152">Same as the Certificate scenario described previously.</span></span><br /><br /> <span data-ttu-id="cd24d-153">Výhodou je, že umístění úložiště certifikátů se může změnit.</span><span class="sxs-lookup"><span data-stu-id="cd24d-153">The benefit is that the certificate store location can change.</span></span>|  
|<span data-ttu-id="cd24d-154">RSA</span><span class="sxs-lookup"><span data-stu-id="cd24d-154">RSA</span></span>|<span data-ttu-id="cd24d-155">Tento prvek určuje hodnotu klíče RSA pro porovnání s klientem.</span><span class="sxs-lookup"><span data-stu-id="cd24d-155">This element specifies an RSA key value to compare with the client.</span></span> <span data-ttu-id="cd24d-156">To se podobá možnosti certifikátu, ale místo použití kryptografického otisku certifikátu se místo toho použije klíč RSA certifikátu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-156">This is similar to the certificate option but rather than using the certificate's thumbprint, the certificate's RSA key is used instead.</span></span>|<span data-ttu-id="cd24d-157">Ověřování RSA umožňuje výslovně omezit ověřování na jeden certifikát založený na jeho klíči RSA.</span><span class="sxs-lookup"><span data-stu-id="cd24d-157">An RSA check enables you to specifically restrict authentication to a single certificate based upon its RSA key.</span></span> <span data-ttu-id="cd24d-158">To umožňuje striktní ověřování konkrétního klíče RSA na úkor služby, která už nefunguje se stávajícími klienty, pokud se změní hodnota klíče RSA.</span><span class="sxs-lookup"><span data-stu-id="cd24d-158">This enables stricter authentication of a specific RSA key at the expense of the service, which no longer works with existing clients if the RSA key value changes.</span></span>|  
|<span data-ttu-id="cd24d-159">Hlavní název uživatele (UPN).</span><span class="sxs-lookup"><span data-stu-id="cd24d-159">User principal name (UPN).</span></span> <span data-ttu-id="cd24d-160">Výchozí hodnota v případě, že `ClientCredentialType` je nastavena na hodnotu Windows a proces služby není spuštěn pod jedním ze systémových účtů.</span><span class="sxs-lookup"><span data-stu-id="cd24d-160">The default when the `ClientCredentialType` is set to Windows and the service process is not running under one of the system accounts.</span></span>|<span data-ttu-id="cd24d-161">Tento prvek určuje hlavní název uživatele (UPN), pod kterým je služba spuštěná.</span><span class="sxs-lookup"><span data-stu-id="cd24d-161">This element specifies the UPN that the service is running under.</span></span> <span data-ttu-id="cd24d-162">V části protokol a identita protokolu Kerberos [můžete přepsat identitu služby pro ověřování](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="cd24d-162">See the Kerberos Protocol and Identity section of [Overriding the Identity of a Service for Authentication](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span></span>|<span data-ttu-id="cd24d-163">Tím se zajistí, že služba bude běžet v rámci určitého uživatelského účtu systému Windows.</span><span class="sxs-lookup"><span data-stu-id="cd24d-163">This ensures that the service is running under a specific Windows user account.</span></span> <span data-ttu-id="cd24d-164">Uživatelský účet může být buď aktuálně přihlášený uživatel, nebo služba spuštěná v rámci určitého uživatelského účtu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-164">The user account can be either the current logged-on user or the service running under a particular user account.</span></span><br /><br /> <span data-ttu-id="cd24d-165">Toto nastavení využívá zabezpečení protokolu Kerberos systému Windows, pokud je služba spuštěna pod účtem domény v prostředí služby Active Directory.</span><span class="sxs-lookup"><span data-stu-id="cd24d-165">This setting takes advantage of Windows Kerberos security if the service is running under a domain account within an Active Directory environment.</span></span>|  
|<span data-ttu-id="cd24d-166">Hlavní název služby (SPN).</span><span class="sxs-lookup"><span data-stu-id="cd24d-166">Service principal name (SPN).</span></span> <span data-ttu-id="cd24d-167">Výchozí hodnota v případě, že `ClientCredentialType` je nastavena na hodnotu Windows a proces služby je spuštěn pod jedním ze systémových účtů – LocalService, LocalSystem nebo NetworkService.</span><span class="sxs-lookup"><span data-stu-id="cd24d-167">The default when the `ClientCredentialType` is set to Windows and the service process is running under one of the system accounts—LocalService, LocalSystem, or NetworkService.</span></span>|<span data-ttu-id="cd24d-168">Tento prvek určuje hlavní název služby (SPN) přidružený k účtu služby.</span><span class="sxs-lookup"><span data-stu-id="cd24d-168">This element specifies the SPN associated with the service's account.</span></span> <span data-ttu-id="cd24d-169">V části protokol a identita protokolu Kerberos [můžete přepsat identitu služby pro ověřování](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="cd24d-169">See the Kerberos Protocol and Identity section of [Overriding the Identity of a Service for Authentication](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span></span>|<span data-ttu-id="cd24d-170">Tím se zajistí, že hlavní název služby (SPN) a konkrétní účet systému Windows přidružený k hlavnímu názvu služby identifikují službu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-170">This ensures that the SPN and the specific Windows account associated with the SPN identify the service.</span></span><br /><br /> <span data-ttu-id="cd24d-171">K přidružení účtu počítače k uživatelskému účtu služby můžete použít nástroj Setspn. exe.</span><span class="sxs-lookup"><span data-stu-id="cd24d-171">You can use the Setspn.exe tool to associate a machine account for the service's user account.</span></span><br /><br /> <span data-ttu-id="cd24d-172">Toto nastavení využívá zabezpečení služby Windows Kerberos, pokud je služba spuštěna pod jedním z účtů systému nebo pod účtem domény, který má přidružený název SPN a počítač je členem domény v prostředí služby Active Directory.</span><span class="sxs-lookup"><span data-stu-id="cd24d-172">This setting takes advantage of Windows Kerberos security if the service is running under one of the system accounts or under a domain account that has an associated SPN name with it and the computer is a member of a domain within an Active Directory environment.</span></span>|  
  
## <a name="specifying-identity-at-the-service"></a><span data-ttu-id="cd24d-173">Zadání identity ve službě</span><span class="sxs-lookup"><span data-stu-id="cd24d-173">Specifying Identity at the Service</span></span>  
 <span data-ttu-id="cd24d-174">Obvykle není nutné nastavovat identitu na službě, protože výběr typu přihlašovacích údajů klienta Určuje typ identity, která je vystavena v metadatech služby.</span><span class="sxs-lookup"><span data-stu-id="cd24d-174">Typically, you do not have to set the identity on a service because the selection of a client credential type dictates the type of identity exposed in the service metadata.</span></span> <span data-ttu-id="cd24d-175">Další informace o tom, jak přepsat nebo zadat identitu služby, najdete v tématu [přepisující identitu služby pro ověřování](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="cd24d-175">For more information about how to override or specify service identity, see [Overriding the Identity of a Service for Authentication](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span></span>  
  
## <a name="using-the-identity-element-in-configuration"></a><span data-ttu-id="cd24d-176">Použití \<identity> elementu v konfiguraci</span><span class="sxs-lookup"><span data-stu-id="cd24d-176">Using the \<identity> Element in Configuration</span></span>  
 <span data-ttu-id="cd24d-177">Pokud změníte typ přihlašovacích údajů klienta ve vazbě, která se dřív zobrazila, `Certificate,` pak vygenerovaný WSDL obsahuje serializovaný certifikát X. 509 pro hodnotu identity, jak je znázorněno v následujícím kódu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-177">If you change the client credential type in the binding previously shown to `Certificate,` then the generated WSDL contains a Base64 serialized X.509 certificate for the identity value as shown in the following code.</span></span> <span data-ttu-id="cd24d-178">Toto je výchozí nastavení pro všechny typy přihlašovacích údajů klienta jiné než Windows.</span><span class="sxs-lookup"><span data-stu-id="cd24d-178">This is the default for all client credential types other than Windows.</span></span>  

 <span data-ttu-id="cd24d-179">Můžete změnit hodnotu výchozí identity služby nebo změnit typ identity pomocí `<identity>` elementu v konfiguraci nebo nastavením identity v kódu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-179">You can change the value of the default service identity or change the type of the identity by using the `<identity>` element in configuration or by setting the identity in code.</span></span> <span data-ttu-id="cd24d-180">Následující konfigurační kód nastaví identitu DNS (Domain Name System) s hodnotou `contoso.com` .</span><span class="sxs-lookup"><span data-stu-id="cd24d-180">The following configuration code sets a domain name system (DNS) identity with the value `contoso.com`.</span></span>  

## <a name="setting-identity-programmatically"></a><span data-ttu-id="cd24d-181">Nastavování identity prostřednictvím kódu programu</span><span class="sxs-lookup"><span data-stu-id="cd24d-181">Setting Identity Programmatically</span></span>  
 <span data-ttu-id="cd24d-182">Vaše služba nemusí explicitně určovat identitu, protože ji WCF automaticky určí.</span><span class="sxs-lookup"><span data-stu-id="cd24d-182">Your service does not have to explicitly specify an identity, because WCF automatically determines it.</span></span> <span data-ttu-id="cd24d-183">Služba WCF ale umožňuje v případě potřeby zadat identitu pro koncový bod.</span><span class="sxs-lookup"><span data-stu-id="cd24d-183">However, WCF allows you to specify an identity on an endpoint, if required.</span></span> <span data-ttu-id="cd24d-184">Následující kód přidá nový koncový bod služby s konkrétní identitou DNS.</span><span class="sxs-lookup"><span data-stu-id="cd24d-184">The following code adds a new service endpoint with a specific DNS identity.</span></span>  
  
 [!code-csharp[C_Identity#5](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_identity/cs/source.cs#5)]
 [!code-vb[C_Identity#5](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_identity/vb/source.vb#5)]  
  
## <a name="specifying-identity-at-the-client"></a><span data-ttu-id="cd24d-185">Určení identity na klientovi</span><span class="sxs-lookup"><span data-stu-id="cd24d-185">Specifying Identity at the Client</span></span>  
 <span data-ttu-id="cd24d-186">V době návrhu obvykle klientský vývojář k vygenerování konfigurace klienta používá nástroj pro dodávání [metadat (Svcutil. exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md) .</span><span class="sxs-lookup"><span data-stu-id="cd24d-186">At design time, a client developer typically uses the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md) to generate client configuration.</span></span> <span data-ttu-id="cd24d-187">Generovaný konfigurační soubor (určený pro použití klientem) obsahuje identitu serveru.</span><span class="sxs-lookup"><span data-stu-id="cd24d-187">The generated configuration file (intended for use by the client) contains the server's identity.</span></span> <span data-ttu-id="cd24d-188">Například následující kód je vygenerován ze služby, která určuje identitu DNS, jak je znázorněno v předchozím příkladu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-188">For example, the following code is generated from a service that specifies a DNS identity, as shown in the preceding example.</span></span> <span data-ttu-id="cd24d-189">Všimněte si, že hodnota identity koncového bodu klienta odpovídá hodnotě služby.</span><span class="sxs-lookup"><span data-stu-id="cd24d-189">Note that the client's endpoint identity value matches that of the service.</span></span> <span data-ttu-id="cd24d-190">V takovém případě, když klient obdrží pověření Windows (Kerberos) pro službu, očekává hodnotu `contoso.com` .</span><span class="sxs-lookup"><span data-stu-id="cd24d-190">In this case, when the client receives the Windows (Kerberos) credentials for the service, it expects the value to be `contoso.com`.</span></span>  

 <span data-ttu-id="cd24d-191">Pokud místo systému Windows služba Určuje certifikát jako typ pověření klienta, očekává se, že vlastnost DNS certifikátu bude hodnota `contoso.com` .</span><span class="sxs-lookup"><span data-stu-id="cd24d-191">If, instead of Windows, the service specifies a certificate as the client credential type, then the certificate's DNS property is expected to be the value `contoso.com`.</span></span> <span data-ttu-id="cd24d-192">(Nebo pokud je vlastnost DNS `null` , musí být název subjektu certifikátu `contoso.com` .)</span><span class="sxs-lookup"><span data-stu-id="cd24d-192">(Or if the DNS property is `null`, the certificate's subject name must be `contoso.com`.)</span></span>  
  
#### <a name="using-a-specific-value-for-identity"></a><span data-ttu-id="cd24d-193">Použití konkrétní hodnoty identity</span><span class="sxs-lookup"><span data-stu-id="cd24d-193">Using a Specific Value for Identity</span></span>  
 <span data-ttu-id="cd24d-194">Následující konfigurační soubor klienta ukazuje, jak se očekává, že identita služby bude konkrétní hodnotou.</span><span class="sxs-lookup"><span data-stu-id="cd24d-194">The following client configuration file shows how the service's identity is expected to be a specific value.</span></span> <span data-ttu-id="cd24d-195">V následujícím příkladu může klient komunikovat se dvěma koncovými body.</span><span class="sxs-lookup"><span data-stu-id="cd24d-195">In the following example, the client can communicate with two endpoints.</span></span> <span data-ttu-id="cd24d-196">První je identifikovaný s kryptografickým otiskem certifikátu a druhým s certifikátem RSA.</span><span class="sxs-lookup"><span data-stu-id="cd24d-196">The first is identified with a certificate thumbprint and the second with a certificate RSA key.</span></span> <span data-ttu-id="cd24d-197">To znamená certifikát, který obsahuje pouze dvojici veřejného klíče a privátního klíče, ale není vydán důvěryhodnou autoritou.</span><span class="sxs-lookup"><span data-stu-id="cd24d-197">That is, a certificate that contains only a public key/private key pair, but is not issued by a trusted authority.</span></span>  

## <a name="identity-checking-at-run-time"></a><span data-ttu-id="cd24d-198">Kontrola identity v době běhu</span><span class="sxs-lookup"><span data-stu-id="cd24d-198">Identity Checking at Run Time</span></span>  
 <span data-ttu-id="cd24d-199">V době návrhu určí vývojář klienta identitu serveru prostřednictvím svých metadat.</span><span class="sxs-lookup"><span data-stu-id="cd24d-199">At design time, a client developer determines the server's identity through its metadata.</span></span> <span data-ttu-id="cd24d-200">V době běhu se kontroler identity provede před voláním libovolných koncových bodů ve službě.</span><span class="sxs-lookup"><span data-stu-id="cd24d-200">At runtime, the identity check is performed before calling any endpoints on the service.</span></span>  
  
 <span data-ttu-id="cd24d-201">Hodnota identity je svázána s typem ověřování určeného metadaty. Jinými slovy typ přihlašovacích údajů, které se používají pro službu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-201">The identity value is tied to the type of authentication specified by metadata; in other words, the type of credentials used for the service.</span></span>  
  
 <span data-ttu-id="cd24d-202">Pokud je kanál nakonfigurovaný k ověřování pomocí protokolu SSL nebo SSL (Secure Sockets Layer) úrovně transportu (TLS) s certifikáty X. 509 pro ověřování, jsou platné následující hodnoty identity:</span><span class="sxs-lookup"><span data-stu-id="cd24d-202">If the channel is configured to authenticate using message- or transport-level Secure Sockets Layer (SSL) with X.509 certificates for authentication, the following identity values are valid:</span></span>  
  
- <span data-ttu-id="cd24d-203">Názv.</span><span class="sxs-lookup"><span data-stu-id="cd24d-203">DNS.</span></span> <span data-ttu-id="cd24d-204">Služba WCF zajišťuje, že certifikát poskytnutý během ověřování SSL obsahuje atribut DNS nebo `CommonName` (CN), který se rovná hodnotě zadané v identitě DNS na klientovi.</span><span class="sxs-lookup"><span data-stu-id="cd24d-204">WCF ensures that the certificate provided during the SSL handshake contains a DNS or `CommonName` (CN) attribute equal to the value specified in the DNS identity on the client.</span></span> <span data-ttu-id="cd24d-205">Všimněte si, že tyto kontroly se provádí Kromě určení platnosti certifikátu serveru.</span><span class="sxs-lookup"><span data-stu-id="cd24d-205">Note that these checks are done in addition to determining the validity of the server certificate.</span></span> <span data-ttu-id="cd24d-206">Ve výchozím nastavení služba WCF ověřuje, že certifikát serveru je vydaný důvěryhodnou kořenovou autoritou.</span><span class="sxs-lookup"><span data-stu-id="cd24d-206">By default, WCF validates that the server certificate is issued by a trusted root authority.</span></span>  
  
- <span data-ttu-id="cd24d-207">Certifikát.</span><span class="sxs-lookup"><span data-stu-id="cd24d-207">Certificate.</span></span> <span data-ttu-id="cd24d-208">Během ověřování SSL zajišťuje služba WCF, že vzdálený koncový bod poskytuje přesnou hodnotu certifikátu zadanou v identitě.</span><span class="sxs-lookup"><span data-stu-id="cd24d-208">During the SSL handshake, WCF ensures that the remote endpoint provides the exact certificate value specified in the identity.</span></span>  
  
- <span data-ttu-id="cd24d-209">Odkaz na certifikát</span><span class="sxs-lookup"><span data-stu-id="cd24d-209">Certificate Reference.</span></span> <span data-ttu-id="cd24d-210">Stejné jako certifikát.</span><span class="sxs-lookup"><span data-stu-id="cd24d-210">Same as Certificate.</span></span>  
  
- <span data-ttu-id="cd24d-211">RSA.</span><span class="sxs-lookup"><span data-stu-id="cd24d-211">RSA.</span></span> <span data-ttu-id="cd24d-212">Během ověřování SSL zajišťuje služba WCF, že vzdálený koncový bod poskytuje přesný klíč RSA zadaný v identitě.</span><span class="sxs-lookup"><span data-stu-id="cd24d-212">During the SSL handshake, WCF ensures that the remote endpoint provides the exact RSA key specified in the identity.</span></span>  
  
 <span data-ttu-id="cd24d-213">Pokud se služba ověřuje pomocí protokolu SSL nebo přenosu SSL s přihlašovacími údaji Windows pro ověřování a vyjednává přihlašovací údaje, jsou platné následující hodnoty identity:</span><span class="sxs-lookup"><span data-stu-id="cd24d-213">If the service authenticates using message- or transport-level SSL with a Windows credential for authentication, and negotiates the credential, the following identity values are valid:</span></span>  
  
- <span data-ttu-id="cd24d-214">Názv.</span><span class="sxs-lookup"><span data-stu-id="cd24d-214">DNS.</span></span> <span data-ttu-id="cd24d-215">Vyjednávání předá hlavní název služby (SPN), aby bylo možné zkontrolovat název DNS.</span><span class="sxs-lookup"><span data-stu-id="cd24d-215">The negotiation passes the service's SPN so that the DNS name can be checked.</span></span> <span data-ttu-id="cd24d-216">Hlavní název služby (SPN) je ve formátu `host/<dns name>` .</span><span class="sxs-lookup"><span data-stu-id="cd24d-216">The SPN is in the form `host/<dns name>`.</span></span>  
  
- <span data-ttu-id="cd24d-217">SPN.</span><span class="sxs-lookup"><span data-stu-id="cd24d-217">SPN.</span></span> <span data-ttu-id="cd24d-218">Vrátí se explicitní hlavní název služby (SPN), například `host/myservice` .</span><span class="sxs-lookup"><span data-stu-id="cd24d-218">An explicit service SPN is returned, for example, `host/myservice`.</span></span>  
  
- <span data-ttu-id="cd24d-219">Názvu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-219">UPN.</span></span> <span data-ttu-id="cd24d-220">Hlavní název uživatele (UPN) účtu služby.</span><span class="sxs-lookup"><span data-stu-id="cd24d-220">The UPN of the service account.</span></span> <span data-ttu-id="cd24d-221">Hlavní název uživatele (UPN) je ve formátu `username` @ `domain` .</span><span class="sxs-lookup"><span data-stu-id="cd24d-221">The UPN is in the form `username`@`domain`.</span></span> <span data-ttu-id="cd24d-222">Například pokud je služba spuštěna v uživatelském účtu, může být `username@contoso.com` .</span><span class="sxs-lookup"><span data-stu-id="cd24d-222">For example, when the service is running in a user account, it may be `username@contoso.com`.</span></span>  
  
 <span data-ttu-id="cd24d-223">Zadání identity programově (pomocí <xref:System.ServiceModel.EndpointAddress.Identity%2A> Vlastnosti) je volitelné.</span><span class="sxs-lookup"><span data-stu-id="cd24d-223">Specifying the identity programmatically (using the <xref:System.ServiceModel.EndpointAddress.Identity%2A> property) is optional.</span></span> <span data-ttu-id="cd24d-224">Pokud není zadaná žádná identita a typ přihlašovacích údajů klienta je Windows, výchozí hodnota je hlavní název služby (SPN) s hodnotou nastavenou na název hostitele v adrese koncového bodu služby s literálem Host/.</span><span class="sxs-lookup"><span data-stu-id="cd24d-224">If no identity is specified, and the client credential type is Windows, the default is SPN with the value set to the hostname part of the service endpoint address prefixed with the "host/" literal.</span></span> <span data-ttu-id="cd24d-225">Pokud není zadaná žádná identita a jako typ přihlašovacích údajů klienta je certifikát, výchozí hodnota je `Certificate` .</span><span class="sxs-lookup"><span data-stu-id="cd24d-225">If no identity is specified, and the client credential type is a certificate, the default is `Certificate`.</span></span> <span data-ttu-id="cd24d-226">To platí pro zabezpečení na úrovni zpráv i přenosů.</span><span class="sxs-lookup"><span data-stu-id="cd24d-226">This applies to both message- and transport-level security.</span></span>  
  
## <a name="identity-and-custom-bindings"></a><span data-ttu-id="cd24d-227">Identity a vlastní vazby</span><span class="sxs-lookup"><span data-stu-id="cd24d-227">Identity and Custom Bindings</span></span>  
 <span data-ttu-id="cd24d-228">Vzhledem k tomu, že identita služby závisí na použitém typu vazby, zajistěte, aby byla při vytváření vlastní vazby vystavena příslušná identita.</span><span class="sxs-lookup"><span data-stu-id="cd24d-228">Because the identity of a service depends on the binding type used, ensure that an appropriate identity is exposed when creating a custom binding.</span></span> <span data-ttu-id="cd24d-229">Například v následujícím příkladu kódu není vystavená identita kompatibilní s typem zabezpečení, protože identita pro spouštěcí vazby zabezpečené konverzace neodpovídá identitě vazby na koncovém bodu.</span><span class="sxs-lookup"><span data-stu-id="cd24d-229">For example, in the following code example, the identity exposed is not compatible with the security type, because the identity for the secure conversation bootstrap binding does not match the identity for the binding on the endpoint.</span></span> <span data-ttu-id="cd24d-230">Vazba zabezpečené konverzace nastavuje identitu DNS, zatímco <xref:System.ServiceModel.Channels.WindowsStreamSecurityBindingElement> nastavuje hlavní název uživatele (UPN) nebo hlavní název služby (SPN).</span><span class="sxs-lookup"><span data-stu-id="cd24d-230">The secure conversation binding sets the DNS identity, while the <xref:System.ServiceModel.Channels.WindowsStreamSecurityBindingElement> sets the UPN or SPN identity.</span></span>  
  
 [!code-csharp[C_Identity#8](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_identity/cs/source.cs#8)]
 [!code-vb[C_Identity#8](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_identity/vb/source.vb#8)]  
  
 <span data-ttu-id="cd24d-231">Další informace o tom, jak správně Stack prvků svázat pro vlastní vazbu, najdete v tématu [vytváření uživatelsky definovaných vazeb](../extending/creating-user-defined-bindings.md).</span><span class="sxs-lookup"><span data-stu-id="cd24d-231">For more information about how to stack binding elements correctly for a custom binding, see [Creating User-Defined Bindings](../extending/creating-user-defined-bindings.md).</span></span> <span data-ttu-id="cd24d-232">Další informace o vytvoření vlastní vazby s nástrojem naleznete <xref:System.ServiceModel.Channels.SecurityBindingElement> v tématu [How to: Create a SecurityBindingElement for the Authentication Mode](how-to-create-a-securitybindingelement-for-a-specified-authentication-mode.md).</span><span class="sxs-lookup"><span data-stu-id="cd24d-232">For more information about creating a custom binding with the <xref:System.ServiceModel.Channels.SecurityBindingElement>, see [How to: Create a SecurityBindingElement for a Specified Authentication Mode](how-to-create-a-securitybindingelement-for-a-specified-authentication-mode.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cd24d-233">Viz také</span><span class="sxs-lookup"><span data-stu-id="cd24d-233">See also</span></span>

- [<span data-ttu-id="cd24d-234">Postupy: Vytvoření vlastní vazby pomocí SecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="cd24d-234">How to: Create a Custom Binding Using the SecurityBindingElement</span></span>](how-to-create-a-custom-binding-using-the-securitybindingelement.md)
- [<span data-ttu-id="cd24d-235">Postupy: Vytvoření elementu SecurityBindingElement pro zadaný režim ověřování</span><span class="sxs-lookup"><span data-stu-id="cd24d-235">How to: Create a SecurityBindingElement for a Specified Authentication Mode</span></span>](how-to-create-a-securitybindingelement-for-a-specified-authentication-mode.md)
- [<span data-ttu-id="cd24d-236">Postupy: Vytvoření vlastního ověřovatele identity klientů</span><span class="sxs-lookup"><span data-stu-id="cd24d-236">How to: Create a Custom Client Identity Verifier</span></span>](../extending/how-to-create-a-custom-client-identity-verifier.md)
- [<span data-ttu-id="cd24d-237">Výběr typu přihlašovacích údajů</span><span class="sxs-lookup"><span data-stu-id="cd24d-237">Selecting a Credential Type</span></span>](selecting-a-credential-type.md)
- [<span data-ttu-id="cd24d-238">Práce s certifikáty</span><span class="sxs-lookup"><span data-stu-id="cd24d-238">Working with Certificates</span></span>](working-with-certificates.md)
- [<span data-ttu-id="cd24d-239">Nástroj ServiceModel Metadata Utility (Svcutil.exe)</span><span class="sxs-lookup"><span data-stu-id="cd24d-239">ServiceModel Metadata Utility Tool (Svcutil.exe)</span></span>](../servicemodel-metadata-utility-tool-svcutil-exe.md)
- [<span data-ttu-id="cd24d-240">Vytváření uživatelem definovaných vazeb</span><span class="sxs-lookup"><span data-stu-id="cd24d-240">Creating User-Defined Bindings</span></span>](../extending/creating-user-defined-bindings.md)
- [<span data-ttu-id="cd24d-241">Postupy: Načtení kryptografického otisku certifikátu</span><span class="sxs-lookup"><span data-stu-id="cd24d-241">How to: Retrieve the Thumbprint of a Certificate</span></span>](how-to-retrieve-the-thumbprint-of-a-certificate.md)
