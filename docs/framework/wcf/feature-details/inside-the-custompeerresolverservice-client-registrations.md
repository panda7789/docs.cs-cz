---
title: 'Uvnitř CustomPeerResolverService: registrace klienta'
ms.date: 03/30/2017
ms.assetid: 40236953-a916-4236-84a6-928859e1331a
ms.openlocfilehash: ce694408edbb40309d1750be49b8414ebcbce3f7
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/09/2020
ms.locfileid: "84596835"
---
# <a name="inside-the-custompeerresolverservice-client-registrations"></a><span data-ttu-id="28d23-102">Uvnitř CustomPeerResolverService: registrace klienta</span><span class="sxs-lookup"><span data-stu-id="28d23-102">Inside the CustomPeerResolverService: Client Registrations</span></span>
<span data-ttu-id="28d23-103">Každý uzel v síti publikuje informace o koncových bodech do služby překladače prostřednictvím `Register` funkce.</span><span class="sxs-lookup"><span data-stu-id="28d23-103">Each node in the mesh publishes its endpoint information to the resolver service through the `Register` function.</span></span> <span data-ttu-id="28d23-104">Služba překladače ukládá tyto informace jako registrační záznam.</span><span class="sxs-lookup"><span data-stu-id="28d23-104">The resolver service stores this information as a registration record.</span></span> <span data-ttu-id="28d23-105">Tento záznam obsahuje jedinečný identifikátor (RegistrationID) a informace o koncovém bodu (PeerNodeAddress) pro uzel.</span><span class="sxs-lookup"><span data-stu-id="28d23-105">This record contains a unique identifier (RegistrationID) and endpoint information (PeerNodeAddress) for the node.</span></span>  
  
## <a name="stale-records-and-expiration-time"></a><span data-ttu-id="28d23-106">Zastaralé záznamy a čas vypršení platnosti</span><span class="sxs-lookup"><span data-stu-id="28d23-106">Stale Records and Expiration Time</span></span>  
 <span data-ttu-id="28d23-107">V ideálním případě, když uzel opustí síť, zavolá `Unregister` funkci, která způsobí, že služba překladače odebere položku registrace.</span><span class="sxs-lookup"><span data-stu-id="28d23-107">Ideally, when a node leaves the mesh, it will call the `Unregister` function, which causes the resolver service to remove the registration entry.</span></span> <span data-ttu-id="28d23-108">V některých případech se uzly před voláním ukončí nebo nebudou přístupné `Unregister` , a to za zastaralým registračním záznamem.</span><span class="sxs-lookup"><span data-stu-id="28d23-108">Sometimes, nodes shut down or become inaccessible before calling `Unregister`, leaving behind a stale registration record.</span></span>  
  
 <span data-ttu-id="28d23-109">Zastaralé záznamy ve službě překladače můžou způsobit neúspěšná připojení.</span><span class="sxs-lookup"><span data-stu-id="28d23-109">Stale records in your resolver service can cause failed connections.</span></span> <span data-ttu-id="28d23-110">Pokud uzel, který se pokouší připojit k síti, obdrží zastaralé informace o připojení ze služby překladače, může trvat déle, než se úspěšně připojí k síti.</span><span class="sxs-lookup"><span data-stu-id="28d23-110">If a node trying to connect to a mesh receives stale connection information from the resolver service, it can take longer to successfully join the mesh.</span></span> <span data-ttu-id="28d23-111">Zastaralé záznamy také zabírají paměť.</span><span class="sxs-lookup"><span data-stu-id="28d23-111">Stale records also take up memory.</span></span> <span data-ttu-id="28d23-112">Bez efektivního procesu vyčištění by mohla mezipaměť používaná k uložení registrů nakonec přetečení a zhroucení služby překladače.</span><span class="sxs-lookup"><span data-stu-id="28d23-112">Without an efficient clean up process, the cache used to store registrations could eventually overflow and crash the resolver service.</span></span>  
  
 <span data-ttu-id="28d23-113"><xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService>Označuje každý záznam s časem vypršení platnosti (DateTime) a ukládá tyto informace jako součást záznamu.</span><span class="sxs-lookup"><span data-stu-id="28d23-113">The <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> marks each record with an expiration time (DateTime), and stores that information as part of the record.</span></span> <span data-ttu-id="28d23-114">Služba používá čas vypršení platnosti k identifikaci zastaralých záznamů.</span><span class="sxs-lookup"><span data-stu-id="28d23-114">The service uses the expiration time to identify stale records.</span></span> <span data-ttu-id="28d23-115">Vlastní implementace by měly dělat něco podobného.</span><span class="sxs-lookup"><span data-stu-id="28d23-115">Custom implementations should do something similar.</span></span>  
  
## <a name="refreshinterval-and-cleanupinterval"></a><span data-ttu-id="28d23-116">Třídy RefreshInterval a CleanupInterval</span><span class="sxs-lookup"><span data-stu-id="28d23-116">RefreshInterval and CleanupInterval</span></span>  
 <span data-ttu-id="28d23-117">`RefreshInterval`Vlastnost <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> definuje, jak dlouho budou registrační záznamy v tabulce vyhledávání registrace služby platné.</span><span class="sxs-lookup"><span data-stu-id="28d23-117">The `RefreshInterval` property of the <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> defines how long registration records remain valid in the service's registration lookup table.</span></span> <span data-ttu-id="28d23-118">Po předání doby do této vlastnosti u daného záznamu se tento záznam zastará a označí pro odstranění.</span><span class="sxs-lookup"><span data-stu-id="28d23-118">When the amount of time supplied to this property has passed for a given record, that record becomes stale and is marked for deletion.</span></span>  
  
 <span data-ttu-id="28d23-119">`CleanupInterval`Vlastnost <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> oznamuje službě, jak často se mají vyhledávat a odstraňovat zastaralé záznamy o registraci.</span><span class="sxs-lookup"><span data-stu-id="28d23-119">The `CleanupInterval` property of the <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> tells the service how often to search for and delete stale registration records.</span></span> <span data-ttu-id="28d23-120">`CleanupInterval`Měl by být nastaven na čas, který je větší nebo roven `RefreshInterval` sadě nastavené ve službě.</span><span class="sxs-lookup"><span data-stu-id="28d23-120">The `CleanupInterval` should be set to a time greater than or equal to the `RefreshInterval` set on the service.</span></span>  
  
 <span data-ttu-id="28d23-121">Chcete-li implementovat vlastní službu překladače, je nutné zapsat funkci údržby pro odebrání zastaralých záznamů registrace.</span><span class="sxs-lookup"><span data-stu-id="28d23-121">To implement your own resolver service, you need to write a maintenance function to remove stale registration records.</span></span> <span data-ttu-id="28d23-122">To lze provést několika způsoby:</span><span class="sxs-lookup"><span data-stu-id="28d23-122">There are several ways to do this:</span></span>  
  
- <span data-ttu-id="28d23-123">**Pravidelná údržba**: nastavte časovač pro pravidelné vypínání a přecházejte přes úložiště dat a odstraňte staré záznamy.</span><span class="sxs-lookup"><span data-stu-id="28d23-123">**Periodic maintenance**: Set a timer to go off periodically, and go through your data store to delete old records.</span></span> <span data-ttu-id="28d23-124"><xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService>Používá tento přístup.</span><span class="sxs-lookup"><span data-stu-id="28d23-124">The <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> uses this approach.</span></span>  
  
- <span data-ttu-id="28d23-125">**Pasivní odstranění**: místo aktivního hledání zastaralých záznamů v pravidelných intervalech můžete identifikovat a odstranit zastaralé záznamy, i když vaše služba již provádí jinou funkci.</span><span class="sxs-lookup"><span data-stu-id="28d23-125">**Passive deletion**: Instead of actively searching for stale records at regular intervals, you can identify and delete stale records when your service is already performing another function.</span></span> <span data-ttu-id="28d23-126">To může potenciálně zpomalit odezvu na žádosti od klientů překladače, ale eliminuje nutnost časovače a může být efektivnější, pokud se očekává, že zbývá jenom několik uzlů bez volání `Unregister` .</span><span class="sxs-lookup"><span data-stu-id="28d23-126">This may potentially slow down response time to requests from the resolver clients, but it eliminates the need for a timer, and may be more efficient if few nodes are expected to leave without calling `Unregister`.</span></span>  
  
## <a name="registrationlifetime-and-refresh"></a><span data-ttu-id="28d23-127">RegistrationLifetime a aktualizovat</span><span class="sxs-lookup"><span data-stu-id="28d23-127">RegistrationLifetime and Refresh</span></span>  
 <span data-ttu-id="28d23-128">Když se uzel registruje pomocí služby překladače, obdrží <xref:System.ServiceModel.PeerResolvers.RegisterResponseInfo> objekt ze služby.</span><span class="sxs-lookup"><span data-stu-id="28d23-128">When a node registers with a resolver service, it receives a <xref:System.ServiceModel.PeerResolvers.RegisterResponseInfo> object from the service.</span></span> <span data-ttu-id="28d23-129">Tento objekt má `RegistrationLifetime` vlastnost, která určuje, jak dlouho má uzel čas před vypršením platnosti registrace a který je odebrán službou překladače.</span><span class="sxs-lookup"><span data-stu-id="28d23-129">This object has a `RegistrationLifetime` property which indicates to the node how much time it has before the registration expires and is removed by the resolver service.</span></span> <span data-ttu-id="28d23-130">Pokud `RegistrationLifetime` je například 2 minuty, musí uzel zavolat za `Refresh` 2 minuty, aby bylo zajištěno, že záznam zůstane v čerstvém stavu a nebude odstraněn.</span><span class="sxs-lookup"><span data-stu-id="28d23-130">If, for example, the `RegistrationLifetime` is 2 minutes, the node needs to call `Refresh` in under 2 minutes to ensure the record stays fresh and is not deleted.</span></span> <span data-ttu-id="28d23-131">Když služba resolver obdrží `Refresh` požadavek, vyhledá záznam a obnoví čas vypršení platnosti.</span><span class="sxs-lookup"><span data-stu-id="28d23-131">When the resolver service receives a `Refresh` request, it looks up the record and resets the expiration time.</span></span> <span data-ttu-id="28d23-132">Funkce Refresh vrátí <xref:System.ServiceModel.PeerResolvers.RefreshResponseInfo> objekt s `RegistrationLifetime` vlastností.</span><span class="sxs-lookup"><span data-stu-id="28d23-132">Refresh returns a <xref:System.ServiceModel.PeerResolvers.RefreshResponseInfo> object with a `RegistrationLifetime` property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="28d23-133">Viz také</span><span class="sxs-lookup"><span data-stu-id="28d23-133">See also</span></span>

- [<span data-ttu-id="28d23-134">Překladače partnerských uzlů</span><span class="sxs-lookup"><span data-stu-id="28d23-134">Peer Resolvers</span></span>](peer-resolvers.md)
