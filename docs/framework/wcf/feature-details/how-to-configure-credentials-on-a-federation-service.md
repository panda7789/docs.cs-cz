---
title: 'Postupy: Konfigurace pověření ve službě Federation Service'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF, federation
- federation
ms.assetid: 149ab165-0ef3-490a-83a9-4322a07bd98a
ms.openlocfilehash: 5bfea40a500dc1355b439ae7d949b0d96d3ab08c
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/04/2018
ms.locfileid: "33495606"
---
# <a name="how-to-configure-credentials-on-a-federation-service"></a><span data-ttu-id="4f8f9-102">Postupy: Konfigurace pověření ve službě Federation Service</span><span class="sxs-lookup"><span data-stu-id="4f8f9-102">How to: Configure Credentials on a Federation Service</span></span>
<span data-ttu-id="4f8f9-103">Ve Windows Communication Foundation (WCF), vytváření federované služby se skládá z následujících postupů hlavní:</span><span class="sxs-lookup"><span data-stu-id="4f8f9-103">In Windows Communication Foundation (WCF), creating a federated service consists of the following main procedures:</span></span>  
  
1.  <span data-ttu-id="4f8f9-104">Konfigurace <xref:System.ServiceModel.WSFederationHttpBinding> nebo podobné vlastní vazby.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-104">Configuring a <xref:System.ServiceModel.WSFederationHttpBinding> or similar custom binding.</span></span> <span data-ttu-id="4f8f9-105">Další informace o vytváření odpovídající vazby, najdete v části [postupy: vytvoření třídy WSFederationHttpBinding](../../../../docs/framework/wcf/feature-details/how-to-create-a-wsfederationhttpbinding.md).</span><span class="sxs-lookup"><span data-stu-id="4f8f9-105">For more information about creating an appropriate binding, see [How to: Create a WSFederationHttpBinding](../../../../docs/framework/wcf/feature-details/how-to-create-a-wsfederationhttpbinding.md).</span></span>  
  
2.  <span data-ttu-id="4f8f9-106">Konfigurace <xref:System.ServiceModel.Security.IssuedTokenServiceCredential> který určuje, jak vystavené tokeny, které jsou uvedené ve službě jsou ověřeni.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-106">Configuring the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential> that controls how issued tokens presented to the service are authenticated.</span></span>  
  
 <span data-ttu-id="4f8f9-107">Toto téma obsahuje podrobné informace o druhém kroku.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-107">This topic provides details about the second step.</span></span> <span data-ttu-id="4f8f9-108">Další informace o fungování federované služby najdete v tématu [Federation](../../../../docs/framework/wcf/feature-details/federation.md).</span><span class="sxs-lookup"><span data-stu-id="4f8f9-108">For more information about how a federated service works, see [Federation](../../../../docs/framework/wcf/feature-details/federation.md).</span></span>  
  
### <a name="to-set-the-properties-of-issuedtokenservicecredential-in-code"></a><span data-ttu-id="4f8f9-109">Chcete-li nastavit vlastnosti IssuedTokenServiceCredential v kódu</span><span class="sxs-lookup"><span data-stu-id="4f8f9-109">To set the properties of IssuedTokenServiceCredential in code</span></span>  
  
1.  <span data-ttu-id="4f8f9-110">Použití <xref:System.ServiceModel.Description.ServiceCredentials.IssuedTokenAuthentication%2A> vlastnost <xref:System.ServiceModel.Description.ServiceCredentials> třídy vrátíte odkaz na <xref:System.ServiceModel.Security.IssuedTokenServiceCredential> instance.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-110">Use the <xref:System.ServiceModel.Description.ServiceCredentials.IssuedTokenAuthentication%2A> property of the <xref:System.ServiceModel.Description.ServiceCredentials> class to return a reference to an <xref:System.ServiceModel.Security.IssuedTokenServiceCredential> instance.</span></span> <span data-ttu-id="4f8f9-111">Vlastnost je k němu přistupovat z <xref:System.ServiceModel.ServiceHostBase.Credentials%2A> vlastnost <xref:System.ServiceModel.ServiceHostBase> třídy.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-111">The property is accessed from the <xref:System.ServiceModel.ServiceHostBase.Credentials%2A> property of the <xref:System.ServiceModel.ServiceHostBase> class.</span></span>  
  
2.  <span data-ttu-id="4f8f9-112">Nastavte <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.AllowUntrustedRsaIssuers%2A> vlastnost `true` Pokud samoobslužné vystavené tokeny [!INCLUDE[infocard](../../../../includes/infocard-md.md)] karty jsou ověřovány.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-112">Set the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.AllowUntrustedRsaIssuers%2A> property to `true` if self-issued tokens such as [!INCLUDE[infocard](../../../../includes/infocard-md.md)] cards are to be authenticated.</span></span> <span data-ttu-id="4f8f9-113">Výchozí hodnota je `false`.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-113">The default is `false`.</span></span>  
  
3.  <span data-ttu-id="4f8f9-114">Naplnění kolekce vrácené <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.KnownCertificates%2A> vlastnost s instancí <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> třídy.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-114">Populate the collection returned by the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.KnownCertificates%2A> property with instances of the <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> class.</span></span> <span data-ttu-id="4f8f9-115">Jednotlivé instance představují vystavitele ze kterého bude služba ověřovat tokeny.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-115">Each instance represents an issuer from which the service will authenticate tokens.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="4f8f9-116">Na rozdíl od klienta kolekce vrácené <xref:System.ServiceModel.Security.X509CertificateRecipientClientCredential.ScopedCertificates%2A> vlastnost, kolekci známých certifikátů není kolekci s klíčem.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-116">Unlike the client-side collection returned by the <xref:System.ServiceModel.Security.X509CertificateRecipientClientCredential.ScopedCertificates%2A> property, the known certificates collection is not a keyed collection.</span></span> <span data-ttu-id="4f8f9-117">Služba přijímá tokeny, které zadaný certifikáty vydávají bez ohledu na adresu klienta, který odeslal zprávu obsahující vystavený token (přičemž podléhá další omezení, která jsou popsána dále v tomto tématu).</span><span class="sxs-lookup"><span data-stu-id="4f8f9-117">The service accepts the tokens that the specified certificates issue regardless of the address of the client that sent the message containing the issued token (subject to the further constraints, which are described later in this topic).</span></span>  
  
4.  <span data-ttu-id="4f8f9-118">Nastavte <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.CertificateValidationMode%2A> vlastnost na jednu z <xref:System.ServiceModel.Security.X509CertificateValidationMode> hodnot výčtu.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-118">Set the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.CertificateValidationMode%2A> property to one of the <xref:System.ServiceModel.Security.X509CertificateValidationMode> enumeration values.</span></span> <span data-ttu-id="4f8f9-119">To lze provést pouze v kódu.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-119">This can be done only in code.</span></span> <span data-ttu-id="4f8f9-120">Výchozí hodnota je <xref:System.IdentityModel.Selectors.X509CertificateValidator.ChainTrust%2A>.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-120">The default is <xref:System.IdentityModel.Selectors.X509CertificateValidator.ChainTrust%2A>.</span></span>  
  
5.  <span data-ttu-id="4f8f9-121">Pokud <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.CertificateValidationMode%2A> je nastavena na <xref:System.ServiceModel.Security.X509CertificateValidationMode.Custom>, pak přiřaďte instanci vlastní <xref:System.IdentityModel.Selectors.X509CertificateValidator> třídy k <xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication.CustomCertificateValidator%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-121">If the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.CertificateValidationMode%2A> property is set to <xref:System.ServiceModel.Security.X509CertificateValidationMode.Custom>, then assign an instance of the custom <xref:System.IdentityModel.Selectors.X509CertificateValidator> class to the <xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication.CustomCertificateValidator%2A> property.</span></span>  
  
6.  <span data-ttu-id="4f8f9-122">Pokud <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.CertificateValidationMode%2A> je nastaven na `ChainTrust` nebo `PeerOrChainTrust`, nastavte <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.RevocationMode%2A> vlastnost na hodnotu odpovídající z <xref:System.Security.Cryptography.X509Certificates.X509RevocationMode> výčtu.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-122">If the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.CertificateValidationMode%2A> is set to `ChainTrust` or `PeerOrChainTrust`, set the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.RevocationMode%2A> property to an appropriate value from the <xref:System.Security.Cryptography.X509Certificates.X509RevocationMode> enumeration.</span></span> <span data-ttu-id="4f8f9-123">Všimněte si, že odvolání režimu se nepoužívá v `PeerTrust` nebo `Custom` režimy ověřování.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-123">Note that the revocation mode is not used in `PeerTrust` or `Custom` validation modes.</span></span>  
  
7.  <span data-ttu-id="4f8f9-124">V případě potřeby přiřadit instanci vlastní <xref:System.IdentityModel.Tokens.SamlSerializer> třídy k <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.SamlSerializer%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-124">If needed, assign an instance of a custom <xref:System.IdentityModel.Tokens.SamlSerializer> class to the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.SamlSerializer%2A> property.</span></span> <span data-ttu-id="4f8f9-125">Vlastní serializátor zabezpečení kontrolní výrazy Markup Language (SAML) je potřeba, například k analýze vlastní kontrolní výrazy SAML.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-125">A custom Security Assertions Markup Language (SAML) serializer is needed, for example, for parsing custom SAML assertions.</span></span>  
  
### <a name="to-set-the-properties-of-issuedtokenservicecredential-in-configuration"></a><span data-ttu-id="4f8f9-126">Chcete-li nastavit vlastnosti IssuedTokenServiceCredential v konfiguraci</span><span class="sxs-lookup"><span data-stu-id="4f8f9-126">To set the properties of IssuedTokenServiceCredential in configuration</span></span>  
  
1.  <span data-ttu-id="4f8f9-127">Vytvoření `<issuedTokenAuthentication>` jako podřízený element <`serviceCredentials`> elementu.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-127">Create an `<issuedTokenAuthentication>` element as a child of a <`serviceCredentials`> element.</span></span>  
  
2.  <span data-ttu-id="4f8f9-128">Nastavit `allowUntrustedRsaIssuers` atribut `<issuedTokenAuthentication>` element `true` Pokud ověřování vystavený token, jako například [!INCLUDE[infocard](../../../../includes/infocard-md.md)] karty.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-128">Set the `allowUntrustedRsaIssuers` attribute of the `<issuedTokenAuthentication>` element to `true` if authenticating a self-issued token, such as an [!INCLUDE[infocard](../../../../includes/infocard-md.md)] card.</span></span>  
  
3.  <span data-ttu-id="4f8f9-129">Vytvoření `<knownCertificates>` jako podřízený element `<issuedTokenAuthentication>` elementu.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-129">Create a `<knownCertificates>` element as a child of the `<issuedTokenAuthentication>` element.</span></span>  
  
4.  <span data-ttu-id="4f8f9-130">Vytvořit v počtu nula či více `<add>` elementy jako podřízené objekty `<knownCertificates>` elementu a určete, jak vyhledat certifikát pomocí `storeLocation`, `storeName`, `x509FindType`, a `findValue` atributy.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-130">Create zero or more `<add>` elements as children of the `<knownCertificates>` element, and specify how to locate the certificate using the `storeLocation`, `storeName`, `x509FindType`, and `findValue` attributes.</span></span>  
  
5.  <span data-ttu-id="4f8f9-131">V případě potřeby nastavte `samlSerializer` atribut <`issuedTokenAuthentication`> elementu, který chcete název typu vlastní <xref:System.IdentityModel.Tokens.SamlSerializer> třídy.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-131">If necessary, set the `samlSerializer` attribute of the <`issuedTokenAuthentication`> element to the type name of the custom <xref:System.IdentityModel.Tokens.SamlSerializer> class.</span></span>  
  
## <a name="example"></a><span data-ttu-id="4f8f9-132">Příklad</span><span class="sxs-lookup"><span data-stu-id="4f8f9-132">Example</span></span>  
 <span data-ttu-id="4f8f9-133">Následující příklad nastaví vlastnosti <xref:System.ServiceModel.Security.IssuedTokenServiceCredential> v kódu.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-133">The following example sets the properties of an <xref:System.ServiceModel.Security.IssuedTokenServiceCredential> in code.</span></span>  
  
 [!code-csharp[C_FederatedService#2](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_federatedservice/cs/source.cs#2)]
 [!code-vb[C_FederatedService#2](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_federatedservice/vb/source.vb#2)]  
  
 <span data-ttu-id="4f8f9-134">Aby federované služby pro ověření klienta musí být splněné o vydaných token následující podmínky:</span><span class="sxs-lookup"><span data-stu-id="4f8f9-134">In order for a federated service to authenticate a client, the following must be true about the issued token:</span></span>  
  
-   <span data-ttu-id="4f8f9-135">Pokud digitální podpis vystavený token používá klíče identifikátorem zabezpečení RSA <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.AllowUntrustedRsaIssuers%2A> musí být vlastnost `true`.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-135">When the issued token’s digital signature uses an RSA security key identifier, the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.AllowUntrustedRsaIssuers%2A> property must be `true`.</span></span>  
  
-   <span data-ttu-id="4f8f9-136">Při podpisu vystavený token používá X.509 vystavitele sériové číslo, identifikátor klíče subjektu X.509 nebo identifikátor zabezpečení kryptografický otisk X.509, vydaný token musí být podepsané certifikátem v kolekci vrácené <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.KnownCertificates%2A> vlastnost <xref:System.ServiceModel.Security.IssuedTokenServiceCredential>třídy.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-136">When the issued token’s signature uses an X.509 issuer serial number, X.509 subject key identifier, or X.509 thumbprint security identifier, the issued token must be signed by a certificate in the collection returned by the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.KnownCertificates%2A> property of the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential> class.</span></span>  
  
-   <span data-ttu-id="4f8f9-137">Při vydaný token je podepsaná pomocí certifikátu X.509, musíte ověřit certifikát na sémantiku zadaný hodnotou <xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication.CertificateValidationMode%2A> vlastnost, bez ohledu na to, jestli se certifikát odešle k předávající straně jako <xref:System.IdentityModel.Tokens.X509RawDataKeyIdentifierClause> nebo byl získán z <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.KnownCertificates%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-137">When the issued token is signed using an X.509 certificate, the certificate must validate per the semantics specified by the value of the <xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication.CertificateValidationMode%2A> property, regardless of whether the certificate was sent to the relying party as a <xref:System.IdentityModel.Tokens.X509RawDataKeyIdentifierClause> or was obtained from the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.KnownCertificates%2A> property.</span></span> <span data-ttu-id="4f8f9-138">Další informace o ověření certifikátu X.509 najdete v tématu [práce s certifikáty](../../../../docs/framework/wcf/feature-details/working-with-certificates.md).</span><span class="sxs-lookup"><span data-stu-id="4f8f9-138">For more information about X.509 certificate validation, see [Working with Certificates](../../../../docs/framework/wcf/feature-details/working-with-certificates.md).</span></span>  
  
 <span data-ttu-id="4f8f9-139">Například nastavení <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.CertificateValidationMode%2A> k <xref:System.ServiceModel.Security.X509CertificateValidationMode.PeerTrust> by ověření všechny vydané token, jejichž podpisový certifikát se nachází ve `TrustedPeople` úložiště certifikátů.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-139">For example, setting the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.CertificateValidationMode%2A> to <xref:System.ServiceModel.Security.X509CertificateValidationMode.PeerTrust> would authenticate any issued token whose signing certificate is in the `TrustedPeople` certificate store.</span></span> <span data-ttu-id="4f8f9-140">V takovém případě nastavte <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.TrustedStoreLocation%2A> vlastnost, která má buď <xref:System.Security.Cryptography.X509Certificates.StoreLocation.CurrentUser> nebo <xref:System.Security.Cryptography.X509Certificates.StoreLocation.LocalMachine>.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-140">In that case, set the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.TrustedStoreLocation%2A> property to either <xref:System.Security.Cryptography.X509Certificates.StoreLocation.CurrentUser> or <xref:System.Security.Cryptography.X509Certificates.StoreLocation.LocalMachine>.</span></span> <span data-ttu-id="4f8f9-141">Můžete vybrat jiné režimy, včetně <xref:System.ServiceModel.Security.X509CertificateValidationMode.Custom>.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-141">You can select other modes, including <xref:System.ServiceModel.Security.X509CertificateValidationMode.Custom>.</span></span> <span data-ttu-id="4f8f9-142">Když `Custom` je vybrána, je nutné přiřadit instanci <xref:System.IdentityModel.Selectors.X509CertificateValidator> třídy k <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.CustomCertificateValidator%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-142">When `Custom` is selected, you must assign an instance of the <xref:System.IdentityModel.Selectors.X509CertificateValidator> class to the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential.CustomCertificateValidator%2A> property.</span></span> <span data-ttu-id="4f8f9-143">Vlastní validátor můžete ověřit certifikáty pomocí všechna kritéria, která ho líbí.</span><span class="sxs-lookup"><span data-stu-id="4f8f9-143">The custom validator can validate certificates using any criteria it likes.</span></span> <span data-ttu-id="4f8f9-144">Další informace najdete v tématu [postupy: vytvoření služby, který využívá validátor certifikátu vlastní](../../../../docs/framework/wcf/extending/how-to-create-a-service-that-employs-a-custom-certificate-validator.md).</span><span class="sxs-lookup"><span data-stu-id="4f8f9-144">For more information, see [How to: Create a Service that Employs a Custom Certificate Validator](../../../../docs/framework/wcf/extending/how-to-create-a-service-that-employs-a-custom-certificate-validator.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4f8f9-145">Viz také</span><span class="sxs-lookup"><span data-stu-id="4f8f9-145">See Also</span></span>  
 [<span data-ttu-id="4f8f9-146">Federace</span><span class="sxs-lookup"><span data-stu-id="4f8f9-146">Federation</span></span>](../../../../docs/framework/wcf/feature-details/federation.md)  
 [<span data-ttu-id="4f8f9-147">Federace a důvěryhodnost</span><span class="sxs-lookup"><span data-stu-id="4f8f9-147">Federation and Trust</span></span>](../../../../docs/framework/wcf/feature-details/federation-and-trust.md)  
 [<span data-ttu-id="4f8f9-148">Ukázka federace</span><span class="sxs-lookup"><span data-stu-id="4f8f9-148">Federation Sample</span></span>](../../../../docs/framework/wcf/samples/federation-sample.md)  
 [<span data-ttu-id="4f8f9-149">Postupy: Zakázání zabezpečených relací u WSFederationHttpBinding</span><span class="sxs-lookup"><span data-stu-id="4f8f9-149">How to: Disable Secure Sessions on a WSFederationHttpBinding</span></span>](../../../../docs/framework/wcf/feature-details/how-to-disable-secure-sessions-on-a-wsfederationhttpbinding.md)  
 [<span data-ttu-id="4f8f9-150">Postupy: Vytvoření WSFederationHttpBinding</span><span class="sxs-lookup"><span data-stu-id="4f8f9-150">How to: Create a WSFederationHttpBinding</span></span>](../../../../docs/framework/wcf/feature-details/how-to-create-a-wsfederationhttpbinding.md)  
 [<span data-ttu-id="4f8f9-151">Postupy: Vytvoření federovaného klienta</span><span class="sxs-lookup"><span data-stu-id="4f8f9-151">How to: Create a Federated Client</span></span>](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md)  
 [<span data-ttu-id="4f8f9-152">Práce s certifikáty</span><span class="sxs-lookup"><span data-stu-id="4f8f9-152">Working with Certificates</span></span>](../../../../docs/framework/wcf/feature-details/working-with-certificates.md)  
 [<span data-ttu-id="4f8f9-153">Režimy ověřování SecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="4f8f9-153">SecurityBindingElement Authentication Modes</span></span>](../../../../docs/framework/wcf/feature-details/securitybindingelement-authentication-modes.md)
