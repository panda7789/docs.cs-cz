---
title: Streamování přenosu zpráv
ms.date: 03/30/2017
ms.assetid: 72a47a51-e5e7-4b76-b24a-299d51e0ae5a
ms.openlocfilehash: 462144856750a1b8726b574fdc82746da2d72ff7
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/09/2020
ms.locfileid: "84594787"
---
# <a name="streaming-message-transfer"></a><span data-ttu-id="de8a6-102">Streamování přenosu zpráv</span><span class="sxs-lookup"><span data-stu-id="de8a6-102">Streaming Message Transfer</span></span>
<span data-ttu-id="de8a6-103">Přenosy Windows Communication Foundation (WCF) podporují dva režimy přenosu zpráv:</span><span class="sxs-lookup"><span data-stu-id="de8a6-103">Windows Communication Foundation (WCF) transports support two modes for transferring messages:</span></span>  
  
- <span data-ttu-id="de8a6-104">Přenosy uložené do vyrovnávací paměti uchovávají celou zprávu ve vyrovnávací paměti, dokud se přenos nedokončí.</span><span class="sxs-lookup"><span data-stu-id="de8a6-104">Buffered transfers hold the entire message in a memory buffer until the transfer is complete.</span></span> <span data-ttu-id="de8a6-105">Zpráva uložená do vyrovnávací paměti musí být zcela doručena předtím, než ji příjemce může přečíst.</span><span class="sxs-lookup"><span data-stu-id="de8a6-105">A buffered message must be completely delivered before a receiver can read it.</span></span>  
  
- <span data-ttu-id="de8a6-106">Přenos streamů zveřejňuje zprávu jako datový proud.</span><span class="sxs-lookup"><span data-stu-id="de8a6-106">Streamed transfers expose the message as a stream.</span></span> <span data-ttu-id="de8a6-107">Příjemce spustí zpracování zprávy před úplným doručením.</span><span class="sxs-lookup"><span data-stu-id="de8a6-107">The receiver starts processing the message before it is completely delivered.</span></span>  
  
- <span data-ttu-id="de8a6-108">Přenos přes datový proud může zlepšit škálovatelnost služby tím, že eliminuje požadavky na vyrovnávací paměti pro velké objemy paměti.</span><span class="sxs-lookup"><span data-stu-id="de8a6-108">Streamed transfers can improve the scalability of a service by eliminating the requirement for large memory buffers.</span></span> <span data-ttu-id="de8a6-109">Bez ohledu na to, jestli změna režimu přenosu zlepšuje škálovatelnost, závisí na velikosti přenášených zpráv.</span><span class="sxs-lookup"><span data-stu-id="de8a6-109">Whether changing the transfer mode improves scalability depends on the size of the messages being transferred.</span></span> <span data-ttu-id="de8a6-110">Větší velikost zpráv upřednostňuje použití přenosů přes datový proud.</span><span class="sxs-lookup"><span data-stu-id="de8a6-110">Large message sizes favor using streamed transfers.</span></span>  
  
 <span data-ttu-id="de8a6-111">Ve výchozím nastavení používají přenosy HTTP, TCP/IP a pojmenované kanály přenosy ve vyrovnávací paměti.</span><span class="sxs-lookup"><span data-stu-id="de8a6-111">By default, the HTTP, TCP/IP, and named pipe transports use buffered transfers.</span></span> <span data-ttu-id="de8a6-112">Tento dokument popisuje, jak přepnout tyto přenosy z vyrovnávací paměti na režim přenosu streamování a důsledky jejich provedení.</span><span class="sxs-lookup"><span data-stu-id="de8a6-112">This document describes how to switch these transports from a buffered to streamed transfer mode and the consequences of doing so.</span></span>  
  
## <a name="enabling-streamed-transfers"></a><span data-ttu-id="de8a6-113">Povolení přenosů odeslaných datovým proudem</span><span class="sxs-lookup"><span data-stu-id="de8a6-113">Enabling Streamed Transfers</span></span>  
 <span data-ttu-id="de8a6-114">Výběr mezi mezipamětí a režimy přenosu s datovým proudem se provádí na elementu vazby přenosu.</span><span class="sxs-lookup"><span data-stu-id="de8a6-114">Selecting between buffered and streamed transfer modes is done on the binding element of the transport.</span></span> <span data-ttu-id="de8a6-115">Element Binding má <xref:System.ServiceModel.TransferMode> vlastnost, která může být nastavena na `Buffered` , `Streamed` , `StreamedRequest` nebo `StreamedResponse` .</span><span class="sxs-lookup"><span data-stu-id="de8a6-115">The binding element has a <xref:System.ServiceModel.TransferMode> property that can be set to `Buffered`, `Streamed`, `StreamedRequest`, or `StreamedResponse`.</span></span> <span data-ttu-id="de8a6-116">Nastavení režimu přenosu pro `Streamed` povolení komunikace streamování v obou směrech.</span><span class="sxs-lookup"><span data-stu-id="de8a6-116">Setting the transfer mode to `Streamed` enables streaming communication in both directions.</span></span> <span data-ttu-id="de8a6-117">Nastavení režimu přenosu na `StreamedRequest` nebo `StreamedResponse` umožňuje komunikaci streamování pouze v uvedeném směru.</span><span class="sxs-lookup"><span data-stu-id="de8a6-117">Setting the transfer mode to `StreamedRequest` or `StreamedResponse` enables streaming communication in the indicated direction only.</span></span>  
  
 <span data-ttu-id="de8a6-118"><xref:System.ServiceModel.BasicHttpBinding>Vazby, <xref:System.ServiceModel.NetTcpBinding> a <xref:System.ServiceModel.NetNamedPipeBinding> zpřístupňují <xref:System.ServiceModel.TransferMode> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="de8a6-118">The <xref:System.ServiceModel.BasicHttpBinding>, <xref:System.ServiceModel.NetTcpBinding>, and <xref:System.ServiceModel.NetNamedPipeBinding> bindings expose the <xref:System.ServiceModel.TransferMode> property.</span></span> <span data-ttu-id="de8a6-119">Pro jiné přenosy je nutné vytvořit vlastní vazbu pro nastavení režimu přenosu.</span><span class="sxs-lookup"><span data-stu-id="de8a6-119">For other transports, you must create a custom binding to set the transfer mode.</span></span>  
  
 <span data-ttu-id="de8a6-120">Rozhodnutí použít buď vyrovnávací paměť, nebo přenos streamování je místní rozhodnutí koncového bodu.</span><span class="sxs-lookup"><span data-stu-id="de8a6-120">The decision to use either buffered or streamed transfers is a local decision of the endpoint.</span></span> <span data-ttu-id="de8a6-121">V případě přenosů HTTP se režim přenosu nešíří v rámci připojení nebo na servery a další zprostředkovatele.</span><span class="sxs-lookup"><span data-stu-id="de8a6-121">For HTTP transports, the transfer mode does not propagate across a connection, or to servers and other intermediaries.</span></span> <span data-ttu-id="de8a6-122">Nastavení režimu přenosu se neprojeví v popisu rozhraní služby.</span><span class="sxs-lookup"><span data-stu-id="de8a6-122">Setting the transfer mode is not reflected in the description of the service interface.</span></span> <span data-ttu-id="de8a6-123">Po vygenerování klientské třídy pro službu musíte upravit konfigurační soubor pro služby určené pro použití s přenosy pomocí streamování pro nastavení režimu.</span><span class="sxs-lookup"><span data-stu-id="de8a6-123">After generating a client class for a service, you must edit the configuration file for services intended to be used with streamed transfers to set the mode.</span></span> <span data-ttu-id="de8a6-124">Pro přenosy TCP a pojmenovaného kanálu je Přenosový režim šířen jako kontrolní výraz zásady.</span><span class="sxs-lookup"><span data-stu-id="de8a6-124">For TCP and named pipe transports, the transfer mode is propagated as a policy assertion.</span></span>  
  
 <span data-ttu-id="de8a6-125">Ukázky kódu naleznete v tématu [How to: Enable Stream](how-to-enable-streaming.md).</span><span class="sxs-lookup"><span data-stu-id="de8a6-125">For code samples, see [How to: Enable Streaming](how-to-enable-streaming.md).</span></span>  
  
## <a name="enabling-asynchronous-streaming"></a><span data-ttu-id="de8a6-126">Povolení asynchronního streamování</span><span class="sxs-lookup"><span data-stu-id="de8a6-126">Enabling Asynchronous Streaming</span></span>  
 <span data-ttu-id="de8a6-127">Pokud chcete povolit asynchronní streamování, přidejte <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior> do hostitele služby chování koncového bodu a nastavte jeho <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.AsynchronousSendEnabled%2A> vlastnost na `true` .</span><span class="sxs-lookup"><span data-stu-id="de8a6-127">To enable asynchronous streaming, add the  <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior> endpoint behavior to the service host and set its <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.AsynchronousSendEnabled%2A> property to `true`.</span></span>  
  
 <span data-ttu-id="de8a6-128">Tato verze WCF také ADDE schopnost skutečného asynchronního streamování na straně odeslání.</span><span class="sxs-lookup"><span data-stu-id="de8a6-128">This version of WCF also adde the capability of true asynchronous streaming on the send side.</span></span> <span data-ttu-id="de8a6-129">To zlepšuje škálovatelnost služby ve scénářích, kdy je streamování zpráv do více klientů, jejichž čtení je pomalé; Pravděpodobnou příčinou zahlcení sítě nebo vůbec nečte.</span><span class="sxs-lookup"><span data-stu-id="de8a6-129">This improves scalability of the service in scenarios where it is streaming messages to multiple clients some of which are slow in reading; possibly due to network congestion or are not reading at all.</span></span> <span data-ttu-id="de8a6-130">V těchto scénářích už WCF neblokuje jednotlivá vlákna ve službě pro každého klienta.</span><span class="sxs-lookup"><span data-stu-id="de8a6-130">In these scenarios WCF no longer blocks individual threads on the service per client.</span></span> <span data-ttu-id="de8a6-131">Tím je zajištěno, že služba bude schopna zpracovat mnoho dalších klientů, což zlepšuje škálovatelnost služby.</span><span class="sxs-lookup"><span data-stu-id="de8a6-131">This ensures that the service is able to process many more clients thereby improving the scalability of the service.</span></span>  
  
## <a name="restrictions-on-streamed-transfers"></a><span data-ttu-id="de8a6-132">Omezení přenosů v datových proudech</span><span class="sxs-lookup"><span data-stu-id="de8a6-132">Restrictions on Streamed Transfers</span></span>  
 <span data-ttu-id="de8a6-133">Použití režimu přenosu datového proudu způsobí, že doba běhu vynutí další omezení.</span><span class="sxs-lookup"><span data-stu-id="de8a6-133">Using the streamed transfer mode causes the run time to enforce additional restrictions.</span></span>  
  
 <span data-ttu-id="de8a6-134">Operace, ke kterým dochází v přenosu datovým proudem, můžou mít kontrakt s maximálně jedním vstupním nebo výstupním parametrem.</span><span class="sxs-lookup"><span data-stu-id="de8a6-134">Operations that occur across a streamed transport can have a contract with at most one input or output parameter.</span></span> <span data-ttu-id="de8a6-135">Tento parametr odpovídá celému těle zprávy a musí být <xref:System.ServiceModel.Channels.Message> odvozený typ <xref:System.IO.Stream> nebo <xref:System.Xml.Serialization.IXmlSerializable> implementace.</span><span class="sxs-lookup"><span data-stu-id="de8a6-135">That parameter corresponds to the entire body of the message and must be a <xref:System.ServiceModel.Channels.Message>, a derived type of <xref:System.IO.Stream>, or an <xref:System.Xml.Serialization.IXmlSerializable> implementation.</span></span> <span data-ttu-id="de8a6-136">Návratová hodnota pro operaci je ekvivalentní s parametrem Output.</span><span class="sxs-lookup"><span data-stu-id="de8a6-136">Having a return value for an operation is equivalent to having an output parameter.</span></span>  
  
 <span data-ttu-id="de8a6-137">Některé funkce služby WCF, jako jsou spolehlivé zasílání zpráv, transakce a zabezpečení na úrovni zpráv SOAP, se při přenosech spoléhají na ukládání zpráv do vyrovnávací paměti.</span><span class="sxs-lookup"><span data-stu-id="de8a6-137">Some WCF features, such as reliable messaging, transactions, and SOAP message-level security, rely on buffering messages for transmissions.</span></span> <span data-ttu-id="de8a6-138">Použití těchto funkcí může snížit nebo odstranit výhody výkonu získané pomocí streamování.</span><span class="sxs-lookup"><span data-stu-id="de8a6-138">Using these features may reduce or eliminate the performance benefits gained by using streaming.</span></span> <span data-ttu-id="de8a6-139">Chcete-li zabezpečit přenos datovým proudem, použijte pouze zabezpečení na úrovni přenosu, nebo použijte zabezpečení zpráv na úrovni přenosu plus pouze ověřování.</span><span class="sxs-lookup"><span data-stu-id="de8a6-139">To secure a streamed transport, use transport-level security only or use transport-level security plus authentication-only message security.</span></span>  
  
 <span data-ttu-id="de8a6-140">Hlavičky SOAP jsou vždy uloženy do vyrovnávací paměti, i když je režim přenosu nastaven na streamování.</span><span class="sxs-lookup"><span data-stu-id="de8a6-140">SOAP headers are always buffered, even when the transfer mode is set to streamed.</span></span> <span data-ttu-id="de8a6-141">Záhlaví zprávy nesmí přesáhnout velikost `MaxBufferSize` přenosového kvóty.</span><span class="sxs-lookup"><span data-stu-id="de8a6-141">The headers for a message must not exceed the size of the `MaxBufferSize` transport quota.</span></span> <span data-ttu-id="de8a6-142">Další informace o tomto nastavení najdete v tématu [přenosové kvóty](transport-quotas.md).</span><span class="sxs-lookup"><span data-stu-id="de8a6-142">For more information about this setting, see [Transport Quotas](transport-quotas.md).</span></span>  
  
## <a name="differences-between-buffered-and-streamed-transfers"></a><span data-ttu-id="de8a6-143">Rozdíly mezi mezipamětí a přenosem datovými proudy</span><span class="sxs-lookup"><span data-stu-id="de8a6-143">Differences Between Buffered and Streamed Transfers</span></span>  
 <span data-ttu-id="de8a6-144">Změna režimu přenosu z vyrovnávací paměti na streamované změní také tvar nativního kanálu pro přenos TCP a pojmenovaného kanálu.</span><span class="sxs-lookup"><span data-stu-id="de8a6-144">Changing the transfer mode from buffered to streamed also changes the native channel shape of the TCP and named pipe transports.</span></span> <span data-ttu-id="de8a6-145">U přenosů ve vyrovnávací paměti je tvar nativního kanálu <xref:System.ServiceModel.Channels.IDuplexSessionChannel> .</span><span class="sxs-lookup"><span data-stu-id="de8a6-145">For buffered transfers, the native channel shape is <xref:System.ServiceModel.Channels.IDuplexSessionChannel>.</span></span> <span data-ttu-id="de8a6-146">V případě přenosů v datových proudech jsou nativní kanály <xref:System.ServiceModel.Channels.IRequestChannel> a <xref:System.ServiceModel.Channels.IReplyChannel> .</span><span class="sxs-lookup"><span data-stu-id="de8a6-146">For streamed transfers, the native channels are <xref:System.ServiceModel.Channels.IRequestChannel> and <xref:System.ServiceModel.Channels.IReplyChannel>.</span></span> <span data-ttu-id="de8a6-147">Změna režimu přenosu v existující aplikaci, která tyto přenosy používá přímo (tj. nikoli prostřednictvím kontraktu služby) vyžaduje změnu očekávaného tvaru kanálu pro objekty pro vytváření kanálů a naslouchací procesy.</span><span class="sxs-lookup"><span data-stu-id="de8a6-147">Changing the transfer mode in an existing application that uses these transports directly (that is, not through a service contract) requires changing the expected channel shape for channel factories and listeners.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="de8a6-148">Viz také</span><span class="sxs-lookup"><span data-stu-id="de8a6-148">See also</span></span>

- [<span data-ttu-id="de8a6-149">Postupy: Povolení streamování</span><span class="sxs-lookup"><span data-stu-id="de8a6-149">How to: Enable Streaming</span></span>](how-to-enable-streaming.md)
