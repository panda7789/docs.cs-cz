---
title: Doporučené postupy hostování Internetové informační služby
ms.date: 03/30/2017
ms.assetid: 0834768e-9665-46bf-86eb-d4b09ab91af5
ms.openlocfilehash: 0ca5e20b846a1b10f5a52748ff06a4af958b2f4c
ms.sourcegitcommit: c7f3e2e9d6ead6cc3acd0d66b10a251d0c66e59d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 09/08/2018
ms.locfileid: "44221945"
---
# <a name="internet-information-services-hosting-best-practices"></a><span data-ttu-id="e2d83-102">Doporučené postupy hostování Internetové informační služby</span><span class="sxs-lookup"><span data-stu-id="e2d83-102">Internet Information Services Hosting Best Practices</span></span>
<span data-ttu-id="e2d83-103">Toto téma popisuje některé osvědčené postupy pro hostování služby Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="e2d83-103">This topic outlines some best practices for hosting Windows Communication Foundation (WCF) services.</span></span>  
  
## <a name="implementing-wcf-services-as-dlls"></a><span data-ttu-id="e2d83-104">Implementace služby WCF jako knihovny DLL</span><span class="sxs-lookup"><span data-stu-id="e2d83-104">Implementing WCF Services as DLLs</span></span>  
 <span data-ttu-id="e2d83-105">Implementace WCF umožňuje služby jako knihovnu DLL, která je nasazena k adresáři \bin sady webovou aplikaci že můžete znovu použít službu mimo model webové aplikace, například v testovacím prostředí, která nemusí mít nasazený Internetové informační služby (IIS).</span><span class="sxs-lookup"><span data-stu-id="e2d83-105">Implementing a WCF service as a DLL that is deployed to the \bin directory of a Web application allows you reuse the service outside of the Web application model, for example, in a test environment that may not have Internet Information Services (IIS) deployed.</span></span>  
  
## <a name="service-hosts-in-iis-hosted-applications"></a><span data-ttu-id="e2d83-106">Obsluha hostitelů v aplikace hostované v IIS</span><span class="sxs-lookup"><span data-stu-id="e2d83-106">Service Hosts in IIS-Hosted Applications</span></span>  
 <span data-ttu-id="e2d83-107">Nepoužívejte imperativní rozhraní API hostování na vlastním serveru k vytvoření nové služby hostitele tohoto naslouchání na síťové přenosy, které jsou nativně podporovány službou IIS hostitelské prostředí (například [!INCLUDE[iis601](../../../../includes/iis601-md.md)] hostovat TCP služby, protože komunikaci TCP nativně nepodporuje [!INCLUDE[iis601](../../../../includes/iis601-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="e2d83-107">Do not use the imperative self-host APIs to create new service hosts that listen on network transports not natively supported by the IIS hosting environment (For example, [!INCLUDE[iis601](../../../../includes/iis601-md.md)] to host TCP services, because TCP communication is not natively supported on [!INCLUDE[iis601](../../../../includes/iis601-md.md)]).</span></span> <span data-ttu-id="e2d83-108">Tento přístup nedoporučuje.</span><span class="sxs-lookup"><span data-stu-id="e2d83-108">This approach is not recommended.</span></span> <span data-ttu-id="e2d83-109">Obsluha hostitelů vytvořené imperativně nejsou známy v rámci služby IIS hostitelského prostředí.</span><span class="sxs-lookup"><span data-stu-id="e2d83-109">Service hosts created imperatively are not known within the IIS hosting environment.</span></span> <span data-ttu-id="e2d83-110">Kritický bod je, že zpracování provádí imperativně vytvořené služby nepočítá službou IIS při určování, zda je hostování fondu aplikací nečinný.</span><span class="sxs-lookup"><span data-stu-id="e2d83-110">The critical point is that processing done by imperatively created services is not accounted for by IIS when it determines whether the hosting application pool is idle.</span></span> <span data-ttu-id="e2d83-111">Výsledkem je, že aplikace, které mají tyto hostitele imperativně vytvořené služby IIS hostitelské prostředí, které normálně agresivně uvolní hostitelské procesy služby IIS.</span><span class="sxs-lookup"><span data-stu-id="e2d83-111">The result is that applications that have such imperatively created service hosts have an IIS hosting environment that aggressively disposes of IIS host processes.</span></span>  
  
## <a name="uris-and-iis-hosted-endpoints"></a><span data-ttu-id="e2d83-112">Identifikátory URI a hostované v IIS koncových bodů</span><span class="sxs-lookup"><span data-stu-id="e2d83-112">URIs and IIS-Hosted Endpoints</span></span>  
 <span data-ttu-id="e2d83-113">Koncové body služby hostované v IIS musí být nakonfigurovaný pomocí relativní Uniform Resource Identifier (identifikátory URI), není absolutní adresy.</span><span class="sxs-lookup"><span data-stu-id="e2d83-113">Endpoints for an IIS-hosted service should be configured using relative Uniform Resource Identifiers (URIs), not absolute addresses.</span></span> <span data-ttu-id="e2d83-114">Zaručí se tak, že adresa koncového bodu spadá do sady adresy URI, které patří do hostitelské aplikace a zajišťuje, že se aktivace založená na zprávách stane dle očekávání.</span><span class="sxs-lookup"><span data-stu-id="e2d83-114">This guarantees that the endpoint address falls within the set of URI addresses that belong to the hosting application and ensures that message-based activation happens as expected.</span></span>  
  
## <a name="state-management-and-process-recycling"></a><span data-ttu-id="e2d83-115">Správa stavu a recyklace procesů</span><span class="sxs-lookup"><span data-stu-id="e2d83-115">State Management and Process Recycling</span></span>  
 <span data-ttu-id="e2d83-116">Hostitelské prostředí služby IIS je optimalizovaná pro služby, které nemají místní stavu v paměti.</span><span class="sxs-lookup"><span data-stu-id="e2d83-116">The IIS hosting environment is optimized for services that do not maintain local state in memory.</span></span> <span data-ttu-id="e2d83-117">Služba IIS recykluje hostitelský proces v reakci na různé události externí a interní způsobující žádné nestálá stav uloženy výhradně ve paměti ke ztrátě.</span><span class="sxs-lookup"><span data-stu-id="e2d83-117">IIS recycles the host process in response to a variety of external and internal events, causing any volatile state stored exclusively in memory to be lost.</span></span> <span data-ttu-id="e2d83-118">Služby hostované ve službě IIS byste uložit jejich stav externího procesu (například v databázi) nebo do mezipaměti v paměti, které mohou být snadno znovu vytvořit Pokud události recyklace aplikace dojde k.</span><span class="sxs-lookup"><span data-stu-id="e2d83-118">Services hosted in IIS should store their state external to the process (for example, in a database) or in an in-memory cache that can easily be re-created if an application recycle event occurs.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="e2d83-119">Protokoly používají WCF pro zprávu vrstvy spolehlivost a zabezpečení provedete používají nestálá stavu v paměti.</span><span class="sxs-lookup"><span data-stu-id="e2d83-119">The protocols WCF uses for message-layer reliability and security make use of the volatile in-memory state.</span></span> <span data-ttu-id="e2d83-120">WCF spolehlivé relace a relace zabezpečení pravděpodobně dojde k neočekávanému ukončení z důvodu aplikace recykluje.</span><span class="sxs-lookup"><span data-stu-id="e2d83-120">WCF reliable sessions and security sessions may terminate unexpectedly due to application recycles.</span></span> <span data-ttu-id="e2d83-121">Aplikace hostované službou IIS, kterým je použití těchto protokolů by neměly být buď závislé na něco jiného než klíč relace poskytované WCF ke korelaci stavu aplikační vrstvu (například aplikační vrstvu konstrukce nebo vlastní korelace záhlaví) nebo zakázat Proces služby IIS recykluje hostované aplikace.</span><span class="sxs-lookup"><span data-stu-id="e2d83-121">IIS-hosted applications that make use of these protocols should either depend on something other than the WCF-provided session key for correlating application-layer state (for example, an application-layer construct or custom correlation header) or disable IIS process recycling for the hosted application.</span></span>  
  
## <a name="optimizing-performance-in-middle-tier-scenarios"></a><span data-ttu-id="e2d83-122">Optimalizace výkonu ve scénářích střední vrstvy</span><span class="sxs-lookup"><span data-stu-id="e2d83-122">Optimizing Performance in Middle-Tier Scenarios</span></span>  
 <span data-ttu-id="e2d83-123">Pro optimální výkon *scénář střední vrstvy*– služba, která vám sdělí, k dalším službám v reakci na příchozí zprávy – po vytvoření instance klienta služby WCF ve vzdálené službě a opakovaně ji používat napříč více příchozí požadavky.</span><span class="sxs-lookup"><span data-stu-id="e2d83-123">For optimal performance in a *middle-tier scenario*—a service that calls out to other services in response to incoming messages—instantiate the WCF service client to the remote service once and reuse it across multiple incoming requests.</span></span> <span data-ttu-id="e2d83-124">Vytvoření instance klienty služby WCF je náročná operace vzhledem k provádění volání na existující instanci klienta služby a střední vrstvy scénáře vytváření zvýšení výkonu různých ukládáním vzdálených klientů napříč požadavky.</span><span class="sxs-lookup"><span data-stu-id="e2d83-124">Instantiating WCF service clients is an expensive operation relative to making a service call on a pre-existing client instance, and middle-tier scenarios produce distinct performance gains by caching remote clients across requests.</span></span> <span data-ttu-id="e2d83-125">Klienty služby WCF jsou bezpečná pro vlákno, takže není nutné k synchronizaci přístupu k klienta napříč více vlákny.</span><span class="sxs-lookup"><span data-stu-id="e2d83-125">WCF service clients are thread-safe, so it is not necessary to synchronize access to a client across multiple threads.</span></span>  
  
 <span data-ttu-id="e2d83-126">Zvýšení výkonu střední vrstvy scénáře také vytvořit pomocí asynchronního rozhraní API generovaný `svcutil /a` možnost.</span><span class="sxs-lookup"><span data-stu-id="e2d83-126">Middle-tier scenarios also produce performance gains by using the asynchronous APIs generated by the `svcutil /a` option.</span></span> <span data-ttu-id="e2d83-127">`/a` Možnost způsobí, že [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) ke generování `BeginXXX/EndXXX` metod pro každou operaci služby, které umožňuje vzdálené volání potenciálně dlouhotrvající na vlákna na pozadí.</span><span class="sxs-lookup"><span data-stu-id="e2d83-127">The `/a` option causes the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) to generate `BeginXXX/EndXXX` methods for each service operation, which allows potentially long-running calls to remote services to be made on background threads.</span></span>  
  
## <a name="wcf-in-multi-homed-or-multi-named-scenarios"></a><span data-ttu-id="e2d83-128">U scénářů s více adresami nebo více pojmenované WCF</span><span class="sxs-lookup"><span data-stu-id="e2d83-128">WCF in Multi-Homed or Multi-named scenarios</span></span>  
 <span data-ttu-id="e2d83-129">Nasadíte služby WCF v IIS webové farmy služby, kde sadu počítačů sdílet společný externí název (například http://www.contoso.com) ale jednotlivě řešený různé názvy hostitelů (například http://www.contoso.com může směrovat provoz do dvou různých počítačích s názvem http://machine1.internal.contoso.com a http://machine2.internal.contoso.com).</span><span class="sxs-lookup"><span data-stu-id="e2d83-129">You can deploy WCF services inside of an IIS Web farm, where a set of computers share a common external name (such as http://www.contoso.com) but are individually addressed by different hostnames (for example, http://www.contoso.com might direct traffic to two different machines named http://machine1.internal.contoso.com and http://machine2.internal.contoso.com).</span></span> <span data-ttu-id="e2d83-130">Tento scénář nasazení plně podporuje WCF, ale vyžaduje speciální konfigurace web služby IIS, který hostuje služby WCF k zobrazení správné (externí) název hostitele v metadatech služby (Web Services Description Language).</span><span class="sxs-lookup"><span data-stu-id="e2d83-130">This deployment scenario is fully supported by WCF, but requires special configuration of the IIS Web site hosting WCF services to display the correct (external) hostname in the service's metadata (Web Services Description Language).</span></span>  
  
 <span data-ttu-id="e2d83-131">Ujistěte se, že se zobrazí správný název hostitele v metadatech služby WCF generuje, nakonfigurujte výchozí identitu pro web služby IIS, který je hostitelem služeb WCF pro použití explicitní název hostitele.</span><span class="sxs-lookup"><span data-stu-id="e2d83-131">To ensure that the correct hostname appears in the service metadata WCF generates, configure the default identity for the IIS Web site that hosts WCF services to use an explicit hostname.</span></span> <span data-ttu-id="e2d83-132">Počítačů umístěných ve farmě www.contoso.com byste například použít vazbu webu služby IIS z \*:80:www.contoso.com pro protokol HTTP a \*: 443:www.contoso.com pro protokol HTTPS.</span><span class="sxs-lookup"><span data-stu-id="e2d83-132">For example, computers that reside inside of the www.contoso.com farm should use an IIS site binding of \*:80:www.contoso.com for HTTP and \*:443:www.contoso.com for HTTPS.</span></span>  
  
 <span data-ttu-id="e2d83-133">Vazby webu služby IIS můžete nakonfigurovat pomocí modulu snap-in Microsoft Management Console (MMC) služby IIS.</span><span class="sxs-lookup"><span data-stu-id="e2d83-133">You can configure IIS Web site bindings by using the IIS Microsoft Management Console (MMC) snap-in.</span></span>  
  
## <a name="application-pools-running-in-different-user-contexts-overwrite-assemblies-from-other-accounts-in-the-temporary-folder"></a><span data-ttu-id="e2d83-134">Fondy aplikací, které jsou spuštěné v kontextech jiný uživatel přepsat sestavení z ostatních účtů v dočasné složce</span><span class="sxs-lookup"><span data-stu-id="e2d83-134">Application Pools Running in Different User Contexts Overwrite Assemblies from Other Accounts in the Temporary Folder</span></span>  
 <span data-ttu-id="e2d83-135">K zajištění, že fondy aplikací, které jsou spuštěné v kontextu jiného uživatele nelze přepsat sestavení z ostatních účtů v dočasné [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] soubory, složky, použijte jiné identity a dočasných složek pro různé aplikace.</span><span class="sxs-lookup"><span data-stu-id="e2d83-135">To ensure that application pools running in different user contexts cannot overwrite assemblies from other accounts in the temporary [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] files folder, use different identities and temporary folders for different applications.</span></span> <span data-ttu-id="e2d83-136">Například, pokud máte dva/Application1 virtuální aplikace a / Application2, můžete vytvořit dvěma fondy aplikací A a B, s dvě různé identity.</span><span class="sxs-lookup"><span data-stu-id="e2d83-136">For example, if you have two virtual applications /Application1 and / Application2, you can create two Application pools, A and B, with two different identities.</span></span> <span data-ttu-id="e2d83-137">Fond aplikací A můžete spustit identitu v rámci jednoho uživatele (user1) zatímco můžete spustit fond aplikací B pod jinou identitou uživatele (uživatel2) a konfigurace/Application1 nepoužije a /Application2 používat služby serveru B.</span><span class="sxs-lookup"><span data-stu-id="e2d83-137">Application pool A can run under one user identity (user1) while application pool B can run under another user identity (user2), and configure /Application1 to use A and /Application2 to use B.</span></span>  
  
 <span data-ttu-id="e2d83-138">V souboru Web.config, můžete nakonfigurovat dočasnou složku použitím \< system.web/compilation/@tempFolder>.</span><span class="sxs-lookup"><span data-stu-id="e2d83-138">In Web.config, you can configure the temporary folder using \<system.web/compilation/@tempFolder>.</span></span> <span data-ttu-id="e2d83-139">Pro/Application1 může být "c:\tempForUser1" a pro application2 může být "c:\tempForUser2".</span><span class="sxs-lookup"><span data-stu-id="e2d83-139">For /Application1, it can be "c:\tempForUser1" and for application2 it can be "c:\tempForUser2".</span></span> <span data-ttu-id="e2d83-140">Udělte odpovídající oprávnění k zápisu do těchto složek pro dvě identity.</span><span class="sxs-lookup"><span data-stu-id="e2d83-140">Grant corresponding write permission to these folders for the two identities.</span></span>  
  
 <span data-ttu-id="e2d83-141">Potom uživatel2 nelze změnit složku generování kódu pro /application2 (v rámci c:\tempForUser1).</span><span class="sxs-lookup"><span data-stu-id="e2d83-141">Then user2 cannot change the code-generation folder for /application2 (under c:\tempForUser1).</span></span>  
  
## <a name="enabling-asynchronous-processing"></a><span data-ttu-id="e2d83-142">Povolení asynchronní zpracování</span><span class="sxs-lookup"><span data-stu-id="e2d83-142">Enabling asynchronous processing</span></span>  
 <span data-ttu-id="e2d83-143">Ve výchozím nastavení jsou zpracována zprávy odeslané do služby WCF hostované v rámci služby IIS 6.0 a starší synchronním způsobem.</span><span class="sxs-lookup"><span data-stu-id="e2d83-143">By default messages sent to a WCF service hosted under IIS 6.0 and earlier are processed in a synchronous manner.</span></span> <span data-ttu-id="e2d83-144">ASP.NET zavolá WCF ve vlastním vlákně (pracovní vlákno technologie ASP.NET) a WCF používá jiné vlákno zpracovat požadavek.</span><span class="sxs-lookup"><span data-stu-id="e2d83-144">ASP.NET calls into WCF on its own thread (the ASP.NET worker thread) and WCF uses another thread to process the request.</span></span> <span data-ttu-id="e2d83-145">WCF obsahuje do vlákna pracovního procesu ASP.NET, dokud se nedokončí její zpracování.</span><span class="sxs-lookup"><span data-stu-id="e2d83-145">WCF holds onto the ASP.NET worker thread until it completes its processing.</span></span> <span data-ttu-id="e2d83-146">To vede k synchronní zpracování požadavků.</span><span class="sxs-lookup"><span data-stu-id="e2d83-146">This leads to synchronous processing of requests.</span></span> <span data-ttu-id="e2d83-147">Asynchronní zpracování požadavků umožňuje větší škálovatelnost, protože snižuje počet vláken potřebný ke zpracování žádosti – WCF neobsahuje vlákno ASP.NET během zpracování požadavku.</span><span class="sxs-lookup"><span data-stu-id="e2d83-147">Processing requests asynchronously enables greater scalability because it reduces the number of threads required to process a request –WCF does not hold on to the ASP.NET thread while processing the request.</span></span> <span data-ttu-id="e2d83-148">Pro počítače, které běží služby IIS 6.0, protože neexistuje žádný způsob, jak omezit příchozí žádosti, které otevřete serveru se nedoporučuje použití asynchronní chování *DOS* útoky (DOS).</span><span class="sxs-lookup"><span data-stu-id="e2d83-148">Use of asynchronous behavior is not recommended for machines running IIS 6.0 because there is no way to throttle incoming requests that open up the server to *Denial Of Service* (DOS) attacks.</span></span> <span data-ttu-id="e2d83-149">Od verze služby IIS 7.0, bylo zavedeno omezení souběžný požadavek: `[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ASP.NET\2.0.50727.0]"MaxConcurrentRequestsPerCpu`.</span><span class="sxs-lookup"><span data-stu-id="e2d83-149">Starting with IIS 7.0, a concurrent request throttle has been introduced: `[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ASP.NET\2.0.50727.0]"MaxConcurrentRequestsPerCpu`.</span></span> <span data-ttu-id="e2d83-150">Pomocí této nové omezení je bezpečné používat asynchronní zpracování.</span><span class="sxs-lookup"><span data-stu-id="e2d83-150">With this new throttle it is safe to use the asynchronous processing.</span></span>  <span data-ttu-id="e2d83-151">Ve výchozím nastavení ve službě IIS 7.0 jsou registrované asynchronní obslužné rutiny a modul.</span><span class="sxs-lookup"><span data-stu-id="e2d83-151">By default in IIS 7.0, the asynchronous handler and module are registered.</span></span> <span data-ttu-id="e2d83-152">Pokud to bylo vypnuto, můžete ručně povolit asynchronní zpracování požadavků v souboru Web.config vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="e2d83-152">If this has been turned off, you can manually enable asynchronous processing of requests in your application's Web.config file.</span></span> <span data-ttu-id="e2d83-153">Nastavení použijete, závisí na vaší `aspNetCompatibilityEnabled` nastavení.</span><span class="sxs-lookup"><span data-stu-id="e2d83-153">The settings you use depend on your `aspNetCompatibilityEnabled` setting.</span></span> <span data-ttu-id="e2d83-154">Pokud máte `aspNetCompatibilityEnabled` nastavena na `false`, nakonfigurujte `System.ServiceModel.Activation.ServiceHttpModule` jak je znázorněno v následujícím fragmentu kódu konfigurace.</span><span class="sxs-lookup"><span data-stu-id="e2d83-154">If you have `aspNetCompatibilityEnabled` set to `false`, configure the `System.ServiceModel.Activation.ServiceHttpModule` as shown in the following configuration snippet.</span></span>  
  
```xml  
<system.serviceModel>  
    <serviceHostingEnvironment aspNetCompatibilityEnabled="false" />      
  </system.serviceModel>  
  <system.webServer>  
    <modules>  
      <remove name="ServiceModel"/>  
      <add name="ServiceModel"   
           preCondition="integratedMode,runtimeVersionv2.0"   
           type="System.ServiceModel.Activation.ServiceHttpModule, System.ServiceModel,Version=3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/>  
    </modules>  
    </system.webServer>  
```  
  
 <span data-ttu-id="e2d83-155">Pokud máte `aspNetCompatibilityEnabled` nastavena na `true`, nakonfigurujte `System.ServiceModel.Activation.ServiceHttpHandlerFactory` jak je znázorněno v následujícím fragmentu kódu config.</span><span class="sxs-lookup"><span data-stu-id="e2d83-155">If you have `aspNetCompatibilityEnabled` set to `true`, configure the `System.ServiceModel.Activation.ServiceHttpHandlerFactory` as shown in the following config snippet.</span></span>  
  
```xml  
<system.serviceModel>  
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />      
  </system.serviceModel>  
  <system.webServer>  
    <handlers>  
          <clear/>  
          <add name="TestAsyncHttpHandler"   
               path="*.svc"   
               verb="*"   
               type="System.ServiceModel.Activation.ServiceHttpHandlerFactory, System.ServiceModel, Version=3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"           
               />  
    </handlers>      
  </system.webServer>  
```  
  
## <a name="see-also"></a><span data-ttu-id="e2d83-156">Viz také</span><span class="sxs-lookup"><span data-stu-id="e2d83-156">See Also</span></span>  
 [<span data-ttu-id="e2d83-157">Služba, která hostuje ukázky</span><span class="sxs-lookup"><span data-stu-id="e2d83-157">Service Hosting Samples</span></span>](https://msdn.microsoft.com/library/f703a3f6-0fba-418a-a92f-7ce75ccfa47e)  
 [<span data-ttu-id="e2d83-158">Hostování funkcí systému Windows Server App Fabric</span><span class="sxs-lookup"><span data-stu-id="e2d83-158">Windows Server App Fabric Hosting Features</span></span>](https://go.microsoft.com/fwlink/?LinkId=201276)
