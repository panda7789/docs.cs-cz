---
title: Federace a důvěryhodnost
ms.date: 03/30/2017
helpviewer_keywords:
- federation [WCF], and trust
ms.assetid: 4bdec4f2-f8a2-4512-bdcf-14ef54b5877a
ms.openlocfilehash: 8b924a4aeb9c667592e99d65666cd8f048d34c22
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/09/2020
ms.locfileid: "84595476"
---
# <a name="federation-and-trust"></a><span data-ttu-id="717e1-102">Federace a důvěryhodnost</span><span class="sxs-lookup"><span data-stu-id="717e1-102">Federation and Trust</span></span>
<span data-ttu-id="717e1-103">Toto téma popisuje různé aspekty týkající se federovaných aplikací, hranic vztahů důvěryhodnosti a konfigurace a používání vydaných tokenů ve službě Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="717e1-103">This topic covers various aspects related to federated applications, trust boundaries and configuration, and use of issued tokens in Windows Communication Foundation (WCF).</span></span>  
  
## <a name="services-security-token-services-and-trust"></a><span data-ttu-id="717e1-104">Služby, služby tokenů zabezpečení a důvěryhodnost</span><span class="sxs-lookup"><span data-stu-id="717e1-104">Services, Security Token Services, and Trust</span></span>  
 <span data-ttu-id="717e1-105">Služby, které zveřejňují federované koncové body, obvykle očekávají, že se klienti ověřují pomocí tokenu poskytnutého konkrétním vystavitelem.</span><span class="sxs-lookup"><span data-stu-id="717e1-105">Services that expose federated endpoints typically expect clients to authenticate using a token provided by a specific issuer.</span></span> <span data-ttu-id="717e1-106">Je důležité, aby byla služba nakonfigurovaná se správnými přihlašovacími údaji pro vystavitele. v opačném případě nebude schopen ověřit podpisy přes vydané tokeny a klient nebude moci komunikovat se službou.</span><span class="sxs-lookup"><span data-stu-id="717e1-106">It is important that the service is configured with the correct credentials for the issuer; otherwise, it will not be able to verify signatures over the issued tokens, and the client will be unable to communicate with the service.</span></span> <span data-ttu-id="717e1-107">Další informace o konfiguraci přihlašovacích údajů vystavitele ve službě najdete v tématu [Postup: konfigurace přihlašovacích údajů na služba FS (Federation Service)](how-to-configure-credentials-on-a-federation-service.md).</span><span class="sxs-lookup"><span data-stu-id="717e1-107">For more information about configuring issuer credentials on the service, see [How to: Configure Credentials on a Federation Service](how-to-configure-credentials-on-a-federation-service.md).</span></span>  
  
 <span data-ttu-id="717e1-108">Podobně při použití symetrických klíčů jsou klíče pro cílovou službu šifrované, takže musíte nakonfigurovat službu tokenu zabezpečení se správnými přihlašovacími údaji pro cílovou službu; v opačném případě nebude možné zašifrovat klíč pro cílovou službu a klient nebude moci komunikovat se službou.</span><span class="sxs-lookup"><span data-stu-id="717e1-108">Similarly, when using symmetric keys, the keys are encrypted for the target service, so you must configure the security token service with the correct credentials for the target service; otherwise, it will be unable to encrypt the key for the target service, and again, the client will be unable to communicate with the service.</span></span>  
  
 <span data-ttu-id="717e1-109">Služby WCF používají hodnotu <xref:System.ServiceModel.Channels.LocalServiceSecuritySettings.MaxClockSkew%2A> vlastnosti v [SecurityBindingElement](../diagnostics/wmi/securitybindingelement.md) , aby bylo možné vyhodnotit časové zkosení mezi klientem a službou.</span><span class="sxs-lookup"><span data-stu-id="717e1-109">WCF services use the value of the <xref:System.ServiceModel.Channels.LocalServiceSecuritySettings.MaxClockSkew%2A> property on the [SecurityBindingElement](../diagnostics/wmi/securitybindingelement.md) to allow for clock skew between the client and service.</span></span> <span data-ttu-id="717e1-110">Ve federaci se `MaxClockSkew` nastavení vztahuje na hodinové zkosení mezi klientem a službou tokenu zabezpečení, ze kterého klient získal vydaný token.</span><span class="sxs-lookup"><span data-stu-id="717e1-110">In federation, the `MaxClockSkew` setting applies to clock skews between both the client and the security token service from where the client obtained the issued token.</span></span> <span data-ttu-id="717e1-111">Proto služba tokenů zabezpečení nemusí při nastavování účinnosti a doby vypršení platnosti vydaných tokenů dělat odchylky s časovým posunem.</span><span class="sxs-lookup"><span data-stu-id="717e1-111">Therefore, security token services need not make clock-skew allowances when setting the issued token's effective and expiration times.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="717e1-112">Důležitost hodinového zkosení se zvyšuje jako doba životnosti vydaného tokenu.</span><span class="sxs-lookup"><span data-stu-id="717e1-112">The importance of clock skew increases as the lifetime of the issued token shortens.</span></span> <span data-ttu-id="717e1-113">Ve většině případů se hodinový posun nejedná o významný problém, pokud je životnost tokenu 30 minut nebo více.</span><span class="sxs-lookup"><span data-stu-id="717e1-113">In most cases, clock skew is not a significant issue if the token lifetime is 30 minutes or more.</span></span> <span data-ttu-id="717e1-114">Scénáře s kratšími dobami života nebo tam, kde je důležité přesný čas platnosti tokenu, by měly být navržené tak, aby se přihlédlo k časově rozchodu.</span><span class="sxs-lookup"><span data-stu-id="717e1-114">Scenarios with shorter lifetimes or where the exact validity time of the token is important should be designed to take clock skew into account.</span></span>  
  
## <a name="federated-endpoints-and-time-outs"></a><span data-ttu-id="717e1-115">Federované koncové body a časové limity</span><span class="sxs-lookup"><span data-stu-id="717e1-115">Federated Endpoints and Time-Outs</span></span>  
 <span data-ttu-id="717e1-116">Když klient komunikuje s federovaným koncovým bodem, musí nejdřív získat příslušný token ze služby tokenu zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="717e1-116">When a client communicates with a federated endpoint, it must first acquire an appropriate token from a security token service.</span></span> <span data-ttu-id="717e1-117">Pokud služba tokenů zabezpečení zveřejňuje federovaný koncový bod, klient musí nejdřív získat token od vystavitele tohoto koncového bodu.</span><span class="sxs-lookup"><span data-stu-id="717e1-117">If the security token service exposes a federated endpoint, the client must first obtain a token from the issuer for that endpoint.</span></span> <span data-ttu-id="717e1-118">Každé pořízení tokenu trvá čas a tento čas se vztahuje na celkový časový limit pro odeslání skutečné zprávy do konečného koncového bodu.</span><span class="sxs-lookup"><span data-stu-id="717e1-118">Each token acquisition takes time, and that time is subject to the overall time-out for sending the actual message to the final endpoint.</span></span>  
  
 <span data-ttu-id="717e1-119">Například časový limit kanálu na straně klienta je nastavený na 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="717e1-119">For example, the time-out on the client-side channel is set to 30 seconds.</span></span> <span data-ttu-id="717e1-120">Aby bylo možné načíst tokeny před odesláním zprávy do konečného koncového bodu, musí být volány dva vydavatelé tokenů, přičemž každý z nich trvá 15 sekund, než se token vystaví.</span><span class="sxs-lookup"><span data-stu-id="717e1-120">Two token issuers need to be called to retrieve tokens before sending the message to the final endpoint, and each takes 15 seconds to issue a token.</span></span> <span data-ttu-id="717e1-121">V tomto případě se pokus nezdaří a <xref:System.TimeoutException> dojde k vyvolání.</span><span class="sxs-lookup"><span data-stu-id="717e1-121">In this case, the attempt will fail and a <xref:System.TimeoutException> is thrown.</span></span> <span data-ttu-id="717e1-122">Proto je potřeba nastavit <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> hodnotu v kanálu klienta na dostatečně velkou hodnotu, aby se zahrnula doba potřebná k načtení všech vystavených tokenů.</span><span class="sxs-lookup"><span data-stu-id="717e1-122">Thus, you need to set the <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> value on the client channel to a value large enough to include the time taken to retrieve all issued tokens.</span></span> <span data-ttu-id="717e1-123">V případě, že pro vlastnost není zadána hodnota <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> , je <xref:System.ServiceModel.Channels.Binding.OpenTimeout%2A> třeba vlastnost nebo <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A> vlastnost (nebo obojí) nastavit na dostatečně velký, aby zahrnovaly čas potřebný k načtení všech vydaných tokenů.</span><span class="sxs-lookup"><span data-stu-id="717e1-123">In the case where a value is not specified for the <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> property, the <xref:System.ServiceModel.Channels.Binding.OpenTimeout%2A> property or the <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A> property (or both) need to be set to a value large enough to include the time taken to retrieve all issued tokens.</span></span>  
  
## <a name="token-lifetime-and-renewal"></a><span data-ttu-id="717e1-124">Životnost a obnovení tokenu</span><span class="sxs-lookup"><span data-stu-id="717e1-124">Token Lifetime and Renewal</span></span>  
 <span data-ttu-id="717e1-125">Klienti WCF nekontrolují vydaný token při vytváření počátečních požadavků na službu.</span><span class="sxs-lookup"><span data-stu-id="717e1-125">WCF clients do not check the issued token when making an initial request to a service.</span></span>  <span data-ttu-id="717e1-126">Místo toho WCF důvěřuje službě tokenů zabezpečení, aby vydávala token s odpovídající efektivitou a časem vypršení platnosti.</span><span class="sxs-lookup"><span data-stu-id="717e1-126">Rather, WCF trusts the security token service to issue a token with appropriate effective and expiration times.</span></span> <span data-ttu-id="717e1-127">Pokud klient a znovu použije token do mezipaměti, vyhradí se u následujících požadavků platnost tokenu a klient v případě potřeby automaticky obnoví token.</span><span class="sxs-lookup"><span data-stu-id="717e1-127">If the token is cached by the client and reused, the token lifetime is checked on subsequent requests and the client automatically renews the token if necessary.</span></span> <span data-ttu-id="717e1-128">Další informace o ukládání tokenů do mezipaměti najdete v tématu [Postupy: vytvoření federovaného klienta](how-to-create-a-federated-client.md).</span><span class="sxs-lookup"><span data-stu-id="717e1-128">For more information about token caching, see [How to: Create a Federated Client](how-to-create-a-federated-client.md).</span></span>  
  
 <span data-ttu-id="717e1-129">Určení krátkých životností, v pořadí 30 sekund nebo méně pro vydané tokeny nebo tokeny kontextu zabezpečení, může vést k vypršení časového limitu vyjednávání nebo k vygenerování jiných výjimek klienty WCF při vyžádání vydaných tokenů nebo při vyjednávání nebo obnovování tokenů kontextu zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="717e1-129">Specifying short lifetimes, on the order of 30 seconds or less for issued tokens or security context tokens, may result in negotiation time-outs or other exceptions being thrown by WCF clients when requesting issued tokens or when negotiating or renewing security context tokens.</span></span>  
  
## <a name="issued-tokens-and-inclusionmode"></a><span data-ttu-id="717e1-130">Vydané tokeny a InclusionMode</span><span class="sxs-lookup"><span data-stu-id="717e1-130">Issued Tokens and InclusionMode</span></span>  
 <span data-ttu-id="717e1-131">Zda je vystavený token serializován ve zprávě odeslané z klienta do federovaného koncového bodu nebo není kontrolován nastavením <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters.InclusionMode%2A> vlastnosti <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters> třídy.</span><span class="sxs-lookup"><span data-stu-id="717e1-131">Whether an issued token is serialized in a message sent from a client to a federated endpoint or not is controlled by setting the <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters.InclusionMode%2A> property of the <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters> class.</span></span> <span data-ttu-id="717e1-132">Tato vlastnost může být nastavena na jednu z <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode> hodnot výčtu, ale není užitečná ve většině federovaných scénářů.</span><span class="sxs-lookup"><span data-stu-id="717e1-132">This property can be set to one of the <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode> enumeration values, but it is not useful in most federated scenarios.</span></span> <span data-ttu-id="717e1-133">`SecurityTokenInclusionMode.Never`Hodnoty a `SecurityTokenInclusionMode.AlwaysToInitiator` způsobí, že klient pošle odkaz na token vydaný službou tokenu zabezpečení pro předávající stranu.</span><span class="sxs-lookup"><span data-stu-id="717e1-133">The `SecurityTokenInclusionMode.Never` and `SecurityTokenInclusionMode.AlwaysToInitiator` values cause the client to send a reference to the token issued by the security token service to the relying party.</span></span> <span data-ttu-id="717e1-134">Pokud předávající strana nemá kopii vydaného tokenu, ověření se nezdaří, protože odkaz na token není možné přeložit.</span><span class="sxs-lookup"><span data-stu-id="717e1-134">Unless the relying party possesses a copy of the issued token, authentication will fail because the token reference is not resolvable.</span></span> <span data-ttu-id="717e1-135">WCF považuje `SecurityTokenInclusionMode.Once` za ekvivalentní `SecurityTokenInclusionMode.AlwaysToRecipient` .</span><span class="sxs-lookup"><span data-stu-id="717e1-135">WCF treats `SecurityTokenInclusionMode.Once` as equivalent to `SecurityTokenInclusionMode.AlwaysToRecipient`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="717e1-136">Viz také</span><span class="sxs-lookup"><span data-stu-id="717e1-136">See also</span></span>

- <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode>
- [<span data-ttu-id="717e1-137">Postupy: Vytvoření federovaného klienta</span><span class="sxs-lookup"><span data-stu-id="717e1-137">How to: Create a Federated Client</span></span>](how-to-create-a-federated-client.md)
- [<span data-ttu-id="717e1-138">Postupy: Konfigurace pověření ve službě Federation Service</span><span class="sxs-lookup"><span data-stu-id="717e1-138">How to: Configure Credentials on a Federation Service</span></span>](how-to-configure-credentials-on-a-federation-service.md)
- [<span data-ttu-id="717e1-139">Postupy: Vytvoření WSFederationHttpBinding</span><span class="sxs-lookup"><span data-stu-id="717e1-139">How to: Create a WSFederationHttpBinding</span></span>](how-to-create-a-wsfederationhttpbinding.md)
