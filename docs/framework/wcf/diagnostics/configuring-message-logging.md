---
title: Konfigurace protokolování zpráv
ms.date: 03/30/2017
helpviewer_keywords:
- message logging [WCF]
ms.assetid: 0ff4c857-8f09-4b85-9dc0-89084706e4c9
ms.openlocfilehash: 283f43239d6cf5aea5ea668397a52313ff526e2a
ms.sourcegitcommit: 59e36e65ac81cdd094a5a84617625b2a0ff3506e
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/27/2020
ms.locfileid: "80345187"
---
# <a name="configuring-message-logging"></a><span data-ttu-id="53df8-102">Konfigurace protokolování zpráv</span><span class="sxs-lookup"><span data-stu-id="53df8-102">Configuring Message Logging</span></span>

<span data-ttu-id="53df8-103">Toto téma popisuje, jak můžete nakonfigurovat protokolování zpráv pro různé scénáře.</span><span class="sxs-lookup"><span data-stu-id="53df8-103">This topic describes how you can configure message logging for different scenarios.</span></span>

## <a name="enabling-message-logging"></a><span data-ttu-id="53df8-104">Povolení protokolování zpráv</span><span class="sxs-lookup"><span data-stu-id="53df8-104">Enabling Message Logging</span></span>

<span data-ttu-id="53df8-105">Windows Communication Foundation (WCF) neprotokoluje zprávy ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="53df8-105">Windows Communication Foundation (WCF) does not log messages by default.</span></span> <span data-ttu-id="53df8-106">Chcete-li aktivovat protokolování zpráv, `System.ServiceModel.MessageLogging` je nutné přidat posluchače `<messagelogging>` trasování do zdroje trasování a nastavit atributy prvku v konfiguračním souboru.</span><span class="sxs-lookup"><span data-stu-id="53df8-106">To activate message logging, you must add a trace listener to the `System.ServiceModel.MessageLogging` trace source and set attributes for the `<messagelogging>` element in the configuration file.</span></span>

<span data-ttu-id="53df8-107">Následující příklad ukazuje, jak povolit protokolování a zadat další možnosti.</span><span class="sxs-lookup"><span data-stu-id="53df8-107">The following example shows how to enable logging and specify additional options.</span></span>

```xml
<system.diagnostics>
  <sources>
    <source name="System.ServiceModel.MessageLogging">
      <listeners>
         <add name="messages"
              type="System.Diagnostics.XmlWriterTraceListener"
              initializeData="c:\logs\messages.svclog" />
        </listeners>
    </source>
  </sources>
</system.diagnostics>

<system.serviceModel>
  <diagnostics>
    <messageLogging
         logEntireMessage="true"
         logMalformedMessages="false"
         logMessagesAtServiceLevel="true"
         logMessagesAtTransportLevel="false"
         maxMessagesToLog="3000"
         maxSizeOfMessageToLog="2000"/>
  </diagnostics>
</system.serviceModel>
```

<span data-ttu-id="53df8-108">Další informace o nastavení protokolování zpráv naleznete v [tématu Doporučená nastavení trasování a protokolování zpráv](./tracing/recommended-settings-for-tracing-and-message-logging.md).</span><span class="sxs-lookup"><span data-stu-id="53df8-108">For more information about message logging settings, see [Recommended Settings for Tracing and Message Logging](./tracing/recommended-settings-for-tracing-and-message-logging.md).</span></span>

<span data-ttu-id="53df8-109">Můžete zadat `add` název a typ naslouchacího procesu, který chcete použít.</span><span class="sxs-lookup"><span data-stu-id="53df8-109">You can use `add` to specify the name and type of the listener you want to use.</span></span> <span data-ttu-id="53df8-110">V příkladu konfigurace listener s názvem "zprávy" a přidá standardní`System.Diagnostics.XmlWriterTraceListener`.NET Framework naslouchací proces trasování ( ) jako typ, který má být používán.</span><span class="sxs-lookup"><span data-stu-id="53df8-110">In the example configuration, the Listener is named "messages" and adds the standard .NET Framework trace listener (`System.Diagnostics.XmlWriterTraceListener`) as the type to use.</span></span> <span data-ttu-id="53df8-111">Pokud používáte `System.Diagnostics.XmlWriterTraceListener`, musíte zadat umístění výstupního souboru a název v konfiguračním souboru.</span><span class="sxs-lookup"><span data-stu-id="53df8-111">If you use `System.Diagnostics.XmlWriterTraceListener`, you must specify the output file location and name in the configuration file.</span></span> <span data-ttu-id="53df8-112">To se provádí `initializeData` nastavením názvu souboru protokolu.</span><span class="sxs-lookup"><span data-stu-id="53df8-112">This is done by setting `initializeData` to the name of the log file.</span></span> <span data-ttu-id="53df8-113">V opačném případě systém vyvolá výjimku.</span><span class="sxs-lookup"><span data-stu-id="53df8-113">Otherwise, the system throws an exception.</span></span> <span data-ttu-id="53df8-114">Můžete také implementovat vlastní naslouchací proces, který vydává protokoly do výchozího souboru.</span><span class="sxs-lookup"><span data-stu-id="53df8-114">You can also implement a custom listener that emits logs to a default file.</span></span>

> [!NOTE]
> <span data-ttu-id="53df8-115">Vzhledem k tomu, že protokolování zpráv přistupuje k místu na disku, měli byste omezit počet zpráv zapsaných na disk pro určitou službu.</span><span class="sxs-lookup"><span data-stu-id="53df8-115">Because message logging accesses disk space, you should limit the number of messages that are written to disk for a particular service.</span></span> <span data-ttu-id="53df8-116">Po dosažení limitu zprávy je vytvořeno trasování na úrovni Informace a všechny aktivity protokolování zpráv zastavit.</span><span class="sxs-lookup"><span data-stu-id="53df8-116">When the message limit is reached, a trace at the Information level is produced and all message logging activities stop.</span></span>

<span data-ttu-id="53df8-117">Úroveň protokolování, stejně jako další možnosti, jsou popsány v části Úroveň protokolování a možnosti.</span><span class="sxs-lookup"><span data-stu-id="53df8-117">The logging level, as well as the additional options, are discussed in the Logging Level and Options section.</span></span>

<span data-ttu-id="53df8-118">Atribut `switchValue` a `source` je platný pouze pro trasování.</span><span class="sxs-lookup"><span data-stu-id="53df8-118">The `switchValue` attribute of a `source` is only valid for tracing.</span></span> <span data-ttu-id="53df8-119">Pokud zadáte `switchValue` atribut pro `System.ServiceModel.MessageLogging` zdroj trasování následujícím způsobem, nemá žádný vliv.</span><span class="sxs-lookup"><span data-stu-id="53df8-119">If you specify a `switchValue` attribute for the `System.ServiceModel.MessageLogging` trace source as follows, it has no effect.</span></span>

```xml
<source name="System.ServiceModel.MessageLogging" switchValue="Verbose">
</source>
```

<span data-ttu-id="53df8-120">Chcete-li zakázat zdroj trasování, `logMessagesAtServiceLevel`měli `logMalformedMessages`byste `logMessagesAtTransportLevel` místo toho `messageLogging` použít atributy , a atributy prvku.</span><span class="sxs-lookup"><span data-stu-id="53df8-120">If you want to disable the trace source, you should use the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element instead.</span></span> <span data-ttu-id="53df8-121">Všechny tyto atributy byste `false`měli nastavit na .</span><span class="sxs-lookup"><span data-stu-id="53df8-121">You should set all these attributes to `false`.</span></span> <span data-ttu-id="53df8-122">To lze provést pomocí konfiguračního souboru v předchozím příkladu kódu, prostřednictvím rozhraní uživatelského rozhraní editoru konfigurace nebo pomocí služby WMI.</span><span class="sxs-lookup"><span data-stu-id="53df8-122">This can be done by using the configuration file in the previous code example, through the Configuration Editor UI interface, or using WMI.</span></span> <span data-ttu-id="53df8-123">Další informace o nástroji Editor konfigurace naleznete v [tématu Configuration Editor Tool (SvcConfigEditor.exe)](../configuration-editor-tool-svcconfigeditor-exe.md).</span><span class="sxs-lookup"><span data-stu-id="53df8-123">For more information about the Configuration Editor tool, see [Configuration Editor Tool (SvcConfigEditor.exe)](../configuration-editor-tool-svcconfigeditor-exe.md).</span></span> <span data-ttu-id="53df8-124">Další informace o službě WMI naleznete [v tématu Použití nástroje Pro diagnostiku systému Windows](./wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="53df8-124">For more information about WMI, see [Using Windows Management Instrumentation for Diagnostics](./wmi/index.md).</span></span>

## <a name="logging-levels-and-options"></a><span data-ttu-id="53df8-125">Úrovně protokolování a možnosti</span><span class="sxs-lookup"><span data-stu-id="53df8-125">Logging Levels and Options</span></span>

<span data-ttu-id="53df8-126">U příchozích zpráv protokolování dochází bezprostředně po vytvoření zprávy, bezprostředně před zpráva se dostane do uživatelského kódu na úrovni služby a při zjištění poškozených zpráv.</span><span class="sxs-lookup"><span data-stu-id="53df8-126">For incoming messages, logging happens immediately after the message is formed, immediately before the message gets to user code in the service level, and when malformed messages are detected.</span></span>

<span data-ttu-id="53df8-127">U odchozích zpráv protokolování dochází ihned po zprávě opustí uživatelský kód a bezprostředně před zpráva přejde na lince.</span><span class="sxs-lookup"><span data-stu-id="53df8-127">For outgoing messages, logging happens immediately after the message leaves user code and immediately before the message goes on the wire.</span></span>

<span data-ttu-id="53df8-128">WCF protokoluje zprávy na dvou různých úrovních, služby a přenos.</span><span class="sxs-lookup"><span data-stu-id="53df8-128">WCF logs messages at two different levels, service and transport.</span></span> <span data-ttu-id="53df8-129">Jsou také protokolovány poškozené zprávy.</span><span class="sxs-lookup"><span data-stu-id="53df8-129">Malformed messages are also logged.</span></span> <span data-ttu-id="53df8-130">Tyto tři kategorie jsou na sobě nezávislé a lze je aktivovat samostatně v konfiguraci.</span><span class="sxs-lookup"><span data-stu-id="53df8-130">The three categories are independent from each other and can be activated separately in configuration.</span></span>

<span data-ttu-id="53df8-131">Úroveň protokolování můžete řídit `logMessagesAtServiceLevel`nastavením `logMalformedMessages` `logMessagesAtTransportLevel` , a `messageLogging` atributy prvku.</span><span class="sxs-lookup"><span data-stu-id="53df8-131">You can control the logging level by setting the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element.</span></span>

### <a name="service-level"></a><span data-ttu-id="53df8-132">Úroveň služeb</span><span class="sxs-lookup"><span data-stu-id="53df8-132">Service Level</span></span>

<span data-ttu-id="53df8-133">Zprávy zaznamenané v této vrstvě se chystají zadat (při příjmu) nebo nechat (při odesílání) uživatelský kód.</span><span class="sxs-lookup"><span data-stu-id="53df8-133">Messages logged at this layer are about to enter (on receiving) or leave (on sending) user code.</span></span> <span data-ttu-id="53df8-134">Pokud byly definovány filtry, jsou protokolovány pouze zprávy, které odpovídají filtrům.</span><span class="sxs-lookup"><span data-stu-id="53df8-134">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="53df8-135">V opačném případě jsou protokolovány všechny zprávy na úrovni služby.</span><span class="sxs-lookup"><span data-stu-id="53df8-135">Otherwise, all messages at the service level are logged.</span></span> <span data-ttu-id="53df8-136">Zprávy infrastruktury (transakce, kanál peer a zabezpečení) jsou také protokolovány na této úrovni, s výjimkou spolehlivé zprávy zpráv.</span><span class="sxs-lookup"><span data-stu-id="53df8-136">Infrastructure messages (transactions, peer channel, and security) are also logged at this level, except for Reliable Messaging messages.</span></span> <span data-ttu-id="53df8-137">U streamovaných zpráv jsou protokolovány pouze záhlaví.</span><span class="sxs-lookup"><span data-stu-id="53df8-137">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="53df8-138">Kromě toho jsou na této úrovni zaznamenány zabezpečené zprávy.</span><span class="sxs-lookup"><span data-stu-id="53df8-138">In addition, secure messages are logged decrypted at this level.</span></span>

### <a name="transport-level"></a><span data-ttu-id="53df8-139">Úroveň přepravy</span><span class="sxs-lookup"><span data-stu-id="53df8-139">Transport Level</span></span>

<span data-ttu-id="53df8-140">Zprávy zaznamenané v této vrstvě jsou připraveny k zakódování nebo dekódování pro nebo po přepravě po lince.</span><span class="sxs-lookup"><span data-stu-id="53df8-140">Messages logged at this layer are ready to be encoded or decoded for or after transportation on the wire.</span></span> <span data-ttu-id="53df8-141">Pokud byly definovány filtry, jsou protokolovány pouze zprávy, které odpovídají filtrům.</span><span class="sxs-lookup"><span data-stu-id="53df8-141">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="53df8-142">V opačném případě jsou protokolovány všechny zprávy ve vrstvě přenosu.</span><span class="sxs-lookup"><span data-stu-id="53df8-142">Otherwise, all messages at the transport layer are logged.</span></span> <span data-ttu-id="53df8-143">Všechny zprávy infrastruktury jsou protokolovány v této vrstvě, včetně spolehlivé zprávy zpráv.</span><span class="sxs-lookup"><span data-stu-id="53df8-143">All infrastructure messages are logged at this layer, including reliable messaging messages.</span></span> <span data-ttu-id="53df8-144">U streamovaných zpráv jsou protokolovány pouze záhlaví.</span><span class="sxs-lookup"><span data-stu-id="53df8-144">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="53df8-145">Kromě toho jsou zabezpečené zprávy protokolovány jako šifrované na této úrovni, s výjimkou případů, kdy je použit zabezpečený přenos, jako je https.</span><span class="sxs-lookup"><span data-stu-id="53df8-145">In addition, secure messages are logged as encrypted at this level, except if a secure transport such as HTTPS is used.</span></span>

### <a name="malformed-level"></a><span data-ttu-id="53df8-146">Nepoškozená úroveň</span><span class="sxs-lookup"><span data-stu-id="53df8-146">Malformed Level</span></span>

<span data-ttu-id="53df8-147">Poškozené zprávy jsou zprávy, které jsou odmítnuty zásobníku WCF v jakékoli fázi zpracování.</span><span class="sxs-lookup"><span data-stu-id="53df8-147">Malformed messages are messages that are rejected by the WCF stack at any stage of processing.</span></span> <span data-ttu-id="53df8-148">Poškozené zprávy jsou protokolovány tak, jak jsou: šifrovány, pokud tomu tak je, s nesprávným XML a tak dále.</span><span class="sxs-lookup"><span data-stu-id="53df8-148">Malformed messages are logged as-is: encrypted if they are so, with non-proper XML, and so on.</span></span> <span data-ttu-id="53df8-149">`maxSizeOfMessageToLog`definována velikost zprávy, která má být zaznamenána jako CDATA.</span><span class="sxs-lookup"><span data-stu-id="53df8-149">`maxSizeOfMessageToLog` defined the size of the message to be logged as CDATA.</span></span> <span data-ttu-id="53df8-150">Ve výchozím `maxSizeOfMessageToLog` nastavení se rovná 256 kM.</span><span class="sxs-lookup"><span data-stu-id="53df8-150">By default, `maxSizeOfMessageToLog` is equal to 256K.</span></span> <span data-ttu-id="53df8-151">Další informace o tomto atributu naleznete v části Další možnosti.</span><span class="sxs-lookup"><span data-stu-id="53df8-151">For more information about this attribute, see the Other Options section.</span></span>

### <a name="other-options"></a><span data-ttu-id="53df8-152">Další možnosti</span><span class="sxs-lookup"><span data-stu-id="53df8-152">Other Options</span></span>

<span data-ttu-id="53df8-153">Kromě úrovní protokolování může uživatel zadat následující možnosti:</span><span class="sxs-lookup"><span data-stu-id="53df8-153">In addition to the logging levels, the user can specify the following options:</span></span>

- <span data-ttu-id="53df8-154">Protokolovat celou`logEntireMessage` zprávu (atribut): Tato hodnota určuje, zda je protokolována celá zpráva (záhlaví a text zprávy).</span><span class="sxs-lookup"><span data-stu-id="53df8-154">Log Entire Message (`logEntireMessage` attribute): This value specifies whether the entire message (message header and body) is logged.</span></span> <span data-ttu-id="53df8-155">Výchozí hodnota `false`je , což znamená, že je zaznamenána pouze hlavička.</span><span class="sxs-lookup"><span data-stu-id="53df8-155">The default value is `false`, meaning that only the header is logged.</span></span> <span data-ttu-id="53df8-156">Toto nastavení ovlivňuje úrovně protokolování zpráv o službách a přenosu..</span><span class="sxs-lookup"><span data-stu-id="53df8-156">This setting affects service and transport message logging levels..</span></span>

- <span data-ttu-id="53df8-157">Maximální počet zpráv`maxMessagesToLog` k protokolu ( atribut): Tato hodnota určuje maximální počet zpráv, které mají být protokolovat.</span><span class="sxs-lookup"><span data-stu-id="53df8-157">Max messages to log (`maxMessagesToLog` attribute): This value specifies the maximum number of messages to log.</span></span> <span data-ttu-id="53df8-158">Všechny zprávy (služby, přenosy a poškozené zprávy) se započítávají do této kvóty.</span><span class="sxs-lookup"><span data-stu-id="53df8-158">All messages (service, transport, and malformed messages) are counted towards this quota.</span></span> <span data-ttu-id="53df8-159">Po dosažení kvóty je vyzařováno trasování a je zaznamenána žádná další zpráva.</span><span class="sxs-lookup"><span data-stu-id="53df8-159">When the quota is reached, a trace is emitted and no additional message is logged.</span></span> <span data-ttu-id="53df8-160">Výchozí hodnota je 10000.</span><span class="sxs-lookup"><span data-stu-id="53df8-160">The default value is 10000.</span></span>

- <span data-ttu-id="53df8-161">Maximální velikost zprávy pro`maxSizeOfMessageToLog` protokol (atribut): Tato hodnota určuje maximální velikost zpráv pro přihlášení bajtů.</span><span class="sxs-lookup"><span data-stu-id="53df8-161">Max size of message to log (`maxSizeOfMessageToLog` attribute): This value specifies the maximum size of messages to log in bytes.</span></span> <span data-ttu-id="53df8-162">Zprávy, které překračují limit velikosti, nejsou protokolovány a pro tuto zprávu se neprovádí žádná jiná aktivita.</span><span class="sxs-lookup"><span data-stu-id="53df8-162">Messages that exceed the size limit are not logged, and no other activity is performed for that message.</span></span> <span data-ttu-id="53df8-163">Toto nastavení ovlivní všechny úrovně trasování.</span><span class="sxs-lookup"><span data-stu-id="53df8-163">This setting affects all trace levels.</span></span> <span data-ttu-id="53df8-164">Pokud servicemodel trasování je zapnuto, sledování úrovně upozornění je emitován v prvním bodě protokolování (ServiceModelSend\* nebo TransportReceive) upozornit uživatele.</span><span class="sxs-lookup"><span data-stu-id="53df8-164">If ServiceModel tracing is on, a Warning level trace is emitted at the first logging point (ServiceModelSend\* or TransportReceive) to notify the user.</span></span> <span data-ttu-id="53df8-165">Výchozí hodnota pro zprávy na úrovni služeb a přenosu je 256 kN, zatímco výchozí hodnota pro poškozené zprávy je 4 K.</span><span class="sxs-lookup"><span data-stu-id="53df8-165">The default value for service level and transport level messages is 256K, while the default value for malformed messages is 4K.</span></span>

  > [!CAUTION]
  > <span data-ttu-id="53df8-166">Velikost zprávy, která je vypočítána porovnat proti `maxSizeOfMessageToLog` je velikost zprávy v paměti před serializace.</span><span class="sxs-lookup"><span data-stu-id="53df8-166">The message size that is computed to compare against `maxSizeOfMessageToLog` is the message size in memory before serialization.</span></span> <span data-ttu-id="53df8-167">Tato velikost se může lišit od skutečné délky řetězce zprávy, který je protokolován a v mnoha případech je větší než skutečná velikost.</span><span class="sxs-lookup"><span data-stu-id="53df8-167">This size can differ from the actual length of the message string that is being logged, and in many occasions is bigger than the actual size.</span></span> <span data-ttu-id="53df8-168">V důsledku toho zprávy nemusí být protokolovány.</span><span class="sxs-lookup"><span data-stu-id="53df8-168">As a result, messages may not be logged.</span></span> <span data-ttu-id="53df8-169">Tuto skutečnost můžete vysvětlit zadáním `maxSizeOfMessageToLog` atributu o 10 % větší než očekávaná velikost zprávy.</span><span class="sxs-lookup"><span data-stu-id="53df8-169">You can account for this fact by specifying the `maxSizeOfMessageToLog` attribute to be 10% larger than the expected message size.</span></span> <span data-ttu-id="53df8-170">Kromě toho pokud jsou protokolovány poškozené zprávy, skutečné místo na disku využité protokoly zpráv může být `maxSizeOfMessageToLog`až 5 krát velikost hodnoty určené .</span><span class="sxs-lookup"><span data-stu-id="53df8-170">In addition, if malformed messages are logged, the actual disk space utilized by the message logs can be up to 5 times the size of the value specified by `maxSizeOfMessageToLog`.</span></span>

<span data-ttu-id="53df8-171">Pokud v konfiguračním souboru není definován žádný posluchač trasování, není generován žádný výstup protokolování bez ohledu na zadanou úroveň protokolování.</span><span class="sxs-lookup"><span data-stu-id="53df8-171">If no trace listener is defined in the configuration file, no logging output is generated regardless of the specified logging level.</span></span>

<span data-ttu-id="53df8-172">Možnosti protokolování zpráv, jako jsou atributy popsané v této části, lze změnit za běhu pomocí nástroje WMI (WMI).</span><span class="sxs-lookup"><span data-stu-id="53df8-172">Message logging options, such as the attributes described in this section, can be changed at runtime using Windows Management Instrumentation (WMI).</span></span> <span data-ttu-id="53df8-173">To lze provést přístupem k instanci [AppDomainInfo,](./wmi/appdomaininfo.md) která `LogMessagesAtServiceLevel`zpřístupňuje tyto logické vlastnosti: , `LogMessagesAtTransportLevel`a `LogMalformedMessages`.</span><span class="sxs-lookup"><span data-stu-id="53df8-173">This can be done by accessing the [AppDomainInfo](./wmi/appdomaininfo.md) instance, which exposes these Boolean properties: `LogMessagesAtServiceLevel`, `LogMessagesAtTransportLevel`, and `LogMalformedMessages`.</span></span> <span data-ttu-id="53df8-174">Proto pokud nakonfigurujete naslouchací proces trasování pro protokolování zpráv, ale nastavte tyto možnosti v `false` konfiguraci, můžete je později změnit na `true` při spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="53df8-174">Therefore, if you configure a trace listener for message logging, but set these options to `false` in configuration, you can later change them to `true` when the application is running.</span></span> <span data-ttu-id="53df8-175">To efektivně umožňuje protokolování zpráv za běhu.</span><span class="sxs-lookup"><span data-stu-id="53df8-175">This effectively enables message logging at runtime.</span></span> <span data-ttu-id="53df8-176">Podobně pokud povolíte protokolování zpráv v konfiguračním souboru, můžete jej zakázat za běhu pomocí služby WMI.</span><span class="sxs-lookup"><span data-stu-id="53df8-176">Similarly, if you enable message logging in your configuration file, you can disable it at runtime using WMI.</span></span> <span data-ttu-id="53df8-177">Další informace naleznete [v tématu Using Windows Management Instrumentation for Diagnostics](./wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="53df8-177">For more information, see [Using Windows Management Instrumentation for Diagnostics](./wmi/index.md).</span></span>

<span data-ttu-id="53df8-178">Pole `source` v protokolu zpráv určuje, ve kterém kontextu je zpráva zaznamenána: při odesílání/přijímání zprávy požadavku, pro požadavek odpověď nebo požadavek na 1 cestu, na modelu služby nebo transportní vrstvě nebo v případě poškozené zprávy.</span><span class="sxs-lookup"><span data-stu-id="53df8-178">The `source` field in a message log specifies in which context the message is logged: when sending/receiving a request message, for a request-reply or 1-way request, at service model or transport layer, or in the case of a malformed message.</span></span>

<span data-ttu-id="53df8-179">U poškozených `source` zpráv se `Malformed`rovná .</span><span class="sxs-lookup"><span data-stu-id="53df8-179">For malformed messages, `source`  is equal to `Malformed`.</span></span> <span data-ttu-id="53df8-180">Jinak zdroj má následující hodnoty založené na kontextu.</span><span class="sxs-lookup"><span data-stu-id="53df8-180">Otherwise, source has the following values based on the context.</span></span>

<span data-ttu-id="53df8-181">Pro požadavek/odpověď</span><span class="sxs-lookup"><span data-stu-id="53df8-181">For Request/Reply</span></span>

||<span data-ttu-id="53df8-182">Odeslat požadavek</span><span class="sxs-lookup"><span data-stu-id="53df8-182">Send Request</span></span>|<span data-ttu-id="53df8-183">Žádost o přijetí</span><span class="sxs-lookup"><span data-stu-id="53df8-183">Receive Request</span></span>|<span data-ttu-id="53df8-184">Odeslat odpověď</span><span class="sxs-lookup"><span data-stu-id="53df8-184">Send Reply</span></span>|<span data-ttu-id="53df8-185">Přijímat odpovědi</span><span class="sxs-lookup"><span data-stu-id="53df8-185">Receive Reply</span></span>|
|-|------------------|---------------------|----------------|-------------------|
|<span data-ttu-id="53df8-186">Vrstva modelu služby</span><span class="sxs-lookup"><span data-stu-id="53df8-186">Service Model layer</span></span>|<span data-ttu-id="53df8-187">Služba</span><span class="sxs-lookup"><span data-stu-id="53df8-187">Service</span></span><br /><br /> <span data-ttu-id="53df8-188">Úroveň</span><span class="sxs-lookup"><span data-stu-id="53df8-188">Level</span></span><br /><br /> <span data-ttu-id="53df8-189">Odeslat</span><span class="sxs-lookup"><span data-stu-id="53df8-189">Send</span></span><br /><br /> <span data-ttu-id="53df8-190">Žádost</span><span class="sxs-lookup"><span data-stu-id="53df8-190">Request</span></span>|<span data-ttu-id="53df8-191">Služba</span><span class="sxs-lookup"><span data-stu-id="53df8-191">Service</span></span><br /><br /> <span data-ttu-id="53df8-192">Úroveň</span><span class="sxs-lookup"><span data-stu-id="53df8-192">Level</span></span><br /><br /> <span data-ttu-id="53df8-193">Přijmout</span><span class="sxs-lookup"><span data-stu-id="53df8-193">Receive</span></span><br /><br /> <span data-ttu-id="53df8-194">Žádost</span><span class="sxs-lookup"><span data-stu-id="53df8-194">Request</span></span>|<span data-ttu-id="53df8-195">Služba</span><span class="sxs-lookup"><span data-stu-id="53df8-195">Service</span></span><br /><br /> <span data-ttu-id="53df8-196">Úroveň</span><span class="sxs-lookup"><span data-stu-id="53df8-196">Level</span></span><br /><br /> <span data-ttu-id="53df8-197">Odeslat</span><span class="sxs-lookup"><span data-stu-id="53df8-197">Send</span></span><br /><br /> <span data-ttu-id="53df8-198">Odpovědět</span><span class="sxs-lookup"><span data-stu-id="53df8-198">Reply</span></span>|<span data-ttu-id="53df8-199">Služba</span><span class="sxs-lookup"><span data-stu-id="53df8-199">Service</span></span><br /><br /> <span data-ttu-id="53df8-200">Úroveň</span><span class="sxs-lookup"><span data-stu-id="53df8-200">Level</span></span><br /><br /> <span data-ttu-id="53df8-201">Přijmout</span><span class="sxs-lookup"><span data-stu-id="53df8-201">Receive</span></span><br /><br /> <span data-ttu-id="53df8-202">Odpovědět</span><span class="sxs-lookup"><span data-stu-id="53df8-202">Reply</span></span>|
|<span data-ttu-id="53df8-203">Transportní vrstva</span><span class="sxs-lookup"><span data-stu-id="53df8-203">Transport layer</span></span>|<span data-ttu-id="53df8-204">Přenos</span><span class="sxs-lookup"><span data-stu-id="53df8-204">Transport</span></span><br /><br /> <span data-ttu-id="53df8-205">Odeslat</span><span class="sxs-lookup"><span data-stu-id="53df8-205">Send</span></span>|<span data-ttu-id="53df8-206">Přenos</span><span class="sxs-lookup"><span data-stu-id="53df8-206">Transport</span></span><br /><br /> <span data-ttu-id="53df8-207">Přijmout</span><span class="sxs-lookup"><span data-stu-id="53df8-207">Receive</span></span>|<span data-ttu-id="53df8-208">Přenos</span><span class="sxs-lookup"><span data-stu-id="53df8-208">Transport</span></span><br /><br /> <span data-ttu-id="53df8-209">Odeslat</span><span class="sxs-lookup"><span data-stu-id="53df8-209">Send</span></span>|<span data-ttu-id="53df8-210">Přenos</span><span class="sxs-lookup"><span data-stu-id="53df8-210">Transport</span></span><br /><br /> <span data-ttu-id="53df8-211">Přijmout</span><span class="sxs-lookup"><span data-stu-id="53df8-211">Receive</span></span>|

<span data-ttu-id="53df8-212">Pro jednosměrný požadavek</span><span class="sxs-lookup"><span data-stu-id="53df8-212">For One-way Request</span></span>

||<span data-ttu-id="53df8-213">Odeslat požadavek</span><span class="sxs-lookup"><span data-stu-id="53df8-213">Send Request</span></span>|<span data-ttu-id="53df8-214">Žádost o přijetí</span><span class="sxs-lookup"><span data-stu-id="53df8-214">Receive Request</span></span>|
|-|------------------|---------------------|
|<span data-ttu-id="53df8-215">Vrstva modelu služby</span><span class="sxs-lookup"><span data-stu-id="53df8-215">Service Model layer</span></span>|<span data-ttu-id="53df8-216">Služba</span><span class="sxs-lookup"><span data-stu-id="53df8-216">Service</span></span><br /><br /> <span data-ttu-id="53df8-217">Úroveň</span><span class="sxs-lookup"><span data-stu-id="53df8-217">Level</span></span><br /><br /> <span data-ttu-id="53df8-218">Odeslat</span><span class="sxs-lookup"><span data-stu-id="53df8-218">Send</span></span><br /><br /> <span data-ttu-id="53df8-219">Datagram</span><span class="sxs-lookup"><span data-stu-id="53df8-219">Datagram</span></span>|<span data-ttu-id="53df8-220">Služba</span><span class="sxs-lookup"><span data-stu-id="53df8-220">Service</span></span><br /><br /> <span data-ttu-id="53df8-221">Úroveň</span><span class="sxs-lookup"><span data-stu-id="53df8-221">Level</span></span><br /><br /> <span data-ttu-id="53df8-222">Přijmout</span><span class="sxs-lookup"><span data-stu-id="53df8-222">Receive</span></span><br /><br /> <span data-ttu-id="53df8-223">Datagram</span><span class="sxs-lookup"><span data-stu-id="53df8-223">Datagram</span></span>|
|<span data-ttu-id="53df8-224">Transportní vrstva</span><span class="sxs-lookup"><span data-stu-id="53df8-224">Transport layer</span></span>|<span data-ttu-id="53df8-225">Přenos</span><span class="sxs-lookup"><span data-stu-id="53df8-225">Transport</span></span><br /><br /> <span data-ttu-id="53df8-226">Odeslat</span><span class="sxs-lookup"><span data-stu-id="53df8-226">Send</span></span>|<span data-ttu-id="53df8-227">Přenos</span><span class="sxs-lookup"><span data-stu-id="53df8-227">Transport</span></span><br /><br /> <span data-ttu-id="53df8-228">Přijmout</span><span class="sxs-lookup"><span data-stu-id="53df8-228">Receive</span></span>|

## <a name="message-filters"></a><span data-ttu-id="53df8-229">Filtry zpráv</span><span class="sxs-lookup"><span data-stu-id="53df8-229">Message Filters</span></span>

<span data-ttu-id="53df8-230">Filtry zpráv jsou `messageLogging` definovány `diagnostics` v konfiguračním prvku konfigurační části.</span><span class="sxs-lookup"><span data-stu-id="53df8-230">Message filters are defined in the `messageLogging` configuration element of the `diagnostics` configuration section.</span></span> <span data-ttu-id="53df8-231">Používají se na úrovni služeb a dopravy.</span><span class="sxs-lookup"><span data-stu-id="53df8-231">They are applied at the service and transport level.</span></span> <span data-ttu-id="53df8-232">Pokud je definován jeden nebo více filtrů, jsou protokolovány pouze zprávy, které odpovídají alespoň jednomu z filtrů.</span><span class="sxs-lookup"><span data-stu-id="53df8-232">When one or more filters are defined, only messages that match at least one of the filters are logged.</span></span> <span data-ttu-id="53df8-233">Pokud není definován žádný filtr, všechny zprávy projít.</span><span class="sxs-lookup"><span data-stu-id="53df8-233">If no filter is defined, all messages pass through.</span></span>

<span data-ttu-id="53df8-234">Filtry podporují úplnou syntaxi XPath a jsou použity v pořadí, v jakém se zobrazují v konfiguračním souboru.</span><span class="sxs-lookup"><span data-stu-id="53df8-234">Filters support the full XPath syntax and are applied in the order they appear in the configuration file.</span></span> <span data-ttu-id="53df8-235">Syntakticky nesprávný filtr má za následek výjimku konfigurace.</span><span class="sxs-lookup"><span data-stu-id="53df8-235">A syntactically incorrect filter results in a configuration exception.</span></span>

<span data-ttu-id="53df8-236">Filtry také poskytují bezpečnostní `nodeQuota` funkci pomocí atributu, který omezuje maximální počet uzlů v XPath DOM, které lze zkontrolovány tak, aby odpovídaly filtru.</span><span class="sxs-lookup"><span data-stu-id="53df8-236">Filters also provide a safety feature using the `nodeQuota` attribute, which limits the maximum number of nodes in the XPath DOM that can be examined to match the filter.</span></span>

<span data-ttu-id="53df8-237">Následující příklad ukazuje, jak nakonfigurovat filtr, který zaznamenává pouze zprávy, které mají oddíl hlavičky SOAP.</span><span class="sxs-lookup"><span data-stu-id="53df8-237">The following example shows how to configure a filter that records only messages that have a SOAP header section.</span></span>

```xml
<messageLogging logEntireMessage="true"
    logMalformedMessages="true"
    logMessagesAtServiceLevel="true"
    logMessagesAtTransportLevel="true"
    maxMessagesToLog="420">
    <filters>
        <add nodeQuota="10" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
                 /soap:Envelope/soap:Header
        </add>
     </filters>
</messageLogging>
```

<span data-ttu-id="53df8-238">Filtry nelze použít na text zprávy.</span><span class="sxs-lookup"><span data-stu-id="53df8-238">Filters cannot be applied to the body of a message.</span></span> <span data-ttu-id="53df8-239">Filtry, které se pokoušejí manipulovat s tělem zprávy, budou odebrány ze seznamu filtrů.</span><span class="sxs-lookup"><span data-stu-id="53df8-239">Filters that attempt to manipulate the body of a message are removed from the list of filters.</span></span> <span data-ttu-id="53df8-240">Událost je také emitován, který označuje toto.</span><span class="sxs-lookup"><span data-stu-id="53df8-240">An event is also emitted that indicates this.</span></span> <span data-ttu-id="53df8-241">Následující filtr by byl například odebrán z tabulky filtrů.</span><span class="sxs-lookup"><span data-stu-id="53df8-241">For example, the following filter would be removed from the filter table.</span></span>

```xml
<add xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">/s:Envelope/s:Body[contains(text(), "Hello")]</add>
```

## <a name="configuring-a-custom-listener"></a><span data-ttu-id="53df8-242">Konfigurace vlastního naslouchací procesu</span><span class="sxs-lookup"><span data-stu-id="53df8-242">Configuring a Custom Listener</span></span>

<span data-ttu-id="53df8-243">Můžete také nakonfigurovat vlastní naslouchací proces s dalšími možnostmi.</span><span class="sxs-lookup"><span data-stu-id="53df8-243">You can also configure a custom listener with additional options.</span></span> <span data-ttu-id="53df8-244">Vlastní naslouchací proces může být užitečné při filtrování prvků PII specifické pro aplikaci ze zpráv před protokolováním.</span><span class="sxs-lookup"><span data-stu-id="53df8-244">A custom listener can be useful in filtering application-specific PII elements from messages before logging.</span></span> <span data-ttu-id="53df8-245">Následující příklad ukazuje vlastní konfiguraci naslouchací proces.</span><span class="sxs-lookup"><span data-stu-id="53df8-245">The following example demonstrates a custom listener configuration.</span></span>

```xml
<system.diagnostics>
   <sources>
     <source name="System.ServiceModel.MessageLogging">
           <listeners>
             <add name="MyListener"
                    type="YourCustomListener"
                    initializeData="c:\logs\messages.svclog"
                    maxDiskSpace="1000"/>
           </listeners>
     </source>
   </sources>
</system.diagnostics>
```

<span data-ttu-id="53df8-246">Měli byste si `type` být vědomi toho, že atribut by měl být nastaven na kvalifikovaný název sestavení typu.</span><span class="sxs-lookup"><span data-stu-id="53df8-246">You should be aware that the `type` attribute should be set to a qualified assembly name of the type.</span></span>

## <a name="see-also"></a><span data-ttu-id="53df8-247">Viz také</span><span class="sxs-lookup"><span data-stu-id="53df8-247">See also</span></span>

- [<span data-ttu-id="53df8-248">\<messageLogging></span><span class="sxs-lookup"><span data-stu-id="53df8-248">\<messageLogging></span></span>](../../configure-apps/file-schema/wcf/messagelogging.md)
- [<span data-ttu-id="53df8-249">Protokolování zpráv</span><span class="sxs-lookup"><span data-stu-id="53df8-249">Message Logging</span></span>](message-logging.md)
- [<span data-ttu-id="53df8-250">Doporučené nastavení pro trasování a protokolování zpráv</span><span class="sxs-lookup"><span data-stu-id="53df8-250">Recommended Settings for Tracing and Message Logging</span></span>](./tracing/recommended-settings-for-tracing-and-message-logging.md)
