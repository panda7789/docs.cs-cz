---
title: Konfigurace protokolování zpráv
description: Naučte se konfigurovat protokolování zpráv, včetně toho, jak povolit protokolování, úrovně protokolování, filtry zpráv a jak nakonfigurovat vlastní naslouchací proces ve službě WCF.
ms.date: 03/30/2017
helpviewer_keywords:
- message logging [WCF]
ms.assetid: 0ff4c857-8f09-4b85-9dc0-89084706e4c9
ms.openlocfilehash: 5203f19a18e5fa6b0ed7f68e1d1de0447da41abd
ms.sourcegitcommit: 358a28048f36a8dca39a9fe6e6ac1f1913acadd5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/23/2020
ms.locfileid: "85247659"
---
# <a name="configuring-message-logging"></a><span data-ttu-id="a911d-103">Konfigurace protokolování zpráv</span><span class="sxs-lookup"><span data-stu-id="a911d-103">Configuring Message Logging</span></span>

<span data-ttu-id="a911d-104">Toto téma popisuje, jak můžete nakonfigurovat protokolování zpráv pro různé scénáře.</span><span class="sxs-lookup"><span data-stu-id="a911d-104">This topic describes how you can configure message logging for different scenarios.</span></span>

## <a name="enabling-message-logging"></a><span data-ttu-id="a911d-105">Povolení protokolování zpráv</span><span class="sxs-lookup"><span data-stu-id="a911d-105">Enabling Message Logging</span></span>

<span data-ttu-id="a911d-106">Windows Communication Foundation (WCF) neprotokoluje zprávy ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="a911d-106">Windows Communication Foundation (WCF) does not log messages by default.</span></span> <span data-ttu-id="a911d-107">Chcete-li aktivovat protokolování zpráv, je nutné přidat naslouchací proces trasování do `System.ServiceModel.MessageLogging` zdroje trasování a nastavit atributy `<messagelogging>` prvku v konfiguračním souboru.</span><span class="sxs-lookup"><span data-stu-id="a911d-107">To activate message logging, you must add a trace listener to the `System.ServiceModel.MessageLogging` trace source and set attributes for the `<messagelogging>` element in the configuration file.</span></span>

<span data-ttu-id="a911d-108">Následující příklad ukazuje, jak povolit protokolování a zadat další možnosti.</span><span class="sxs-lookup"><span data-stu-id="a911d-108">The following example shows how to enable logging and specify additional options.</span></span>

```xml
<system.diagnostics>
  <sources>
    <source name="System.ServiceModel.MessageLogging">
      <listeners>
         <add name="messages"
              type="System.Diagnostics.XmlWriterTraceListener"
              initializeData="c:\logs\messages.svclog" />
        </listeners>
    </source>
  </sources>
</system.diagnostics>

<system.serviceModel>
  <diagnostics>
    <messageLogging
         logEntireMessage="true"
         logMalformedMessages="false"
         logMessagesAtServiceLevel="true"
         logMessagesAtTransportLevel="false"
         maxMessagesToLog="3000"
         maxSizeOfMessageToLog="2000"/>
  </diagnostics>
</system.serviceModel>
```

<span data-ttu-id="a911d-109">Další informace o nastavení protokolování zpráv najdete v tématu [Doporučené nastavení pro trasování a protokolování zpráv](./tracing/recommended-settings-for-tracing-and-message-logging.md).</span><span class="sxs-lookup"><span data-stu-id="a911d-109">For more information about message logging settings, see [Recommended Settings for Tracing and Message Logging](./tracing/recommended-settings-for-tracing-and-message-logging.md).</span></span>

<span data-ttu-id="a911d-110">Můžete použít `add` k zadání názvu a typu naslouchacího procesu, který chcete použít.</span><span class="sxs-lookup"><span data-stu-id="a911d-110">You can use `add` to specify the name and type of the listener you want to use.</span></span> <span data-ttu-id="a911d-111">V ukázkové konfiguraci má naslouchací proces název "zprávy" a přidává standardní .NET Framework trasování trasování ( `System.Diagnostics.XmlWriterTraceListener` ) jako typ, který se má použít.</span><span class="sxs-lookup"><span data-stu-id="a911d-111">In the example configuration, the Listener is named "messages" and adds the standard .NET Framework trace listener (`System.Diagnostics.XmlWriterTraceListener`) as the type to use.</span></span> <span data-ttu-id="a911d-112">Pokud používáte `System.Diagnostics.XmlWriterTraceListener` , musíte zadat umístění a název výstupního souboru do konfiguračního souboru.</span><span class="sxs-lookup"><span data-stu-id="a911d-112">If you use `System.Diagnostics.XmlWriterTraceListener`, you must specify the output file location and name in the configuration file.</span></span> <span data-ttu-id="a911d-113">To se provádí nastavením `initializeData` na název souboru protokolu.</span><span class="sxs-lookup"><span data-stu-id="a911d-113">This is done by setting `initializeData` to the name of the log file.</span></span> <span data-ttu-id="a911d-114">V opačném případě systém vyvolá výjimku.</span><span class="sxs-lookup"><span data-stu-id="a911d-114">Otherwise, the system throws an exception.</span></span> <span data-ttu-id="a911d-115">Můžete také implementovat vlastní naslouchací proces, který vysílá protokoly do výchozího souboru.</span><span class="sxs-lookup"><span data-stu-id="a911d-115">You can also implement a custom listener that emits logs to a default file.</span></span>

> [!NOTE]
> <span data-ttu-id="a911d-116">Vzhledem k tomu, že protokolování zpráv přistupuje místo na disku, měli byste omezit počet zpráv zapsaných na disk pro konkrétní službu.</span><span class="sxs-lookup"><span data-stu-id="a911d-116">Because message logging accesses disk space, you should limit the number of messages that are written to disk for a particular service.</span></span> <span data-ttu-id="a911d-117">Po dosažení limitu zpráv se vyprodukuje trasování na úrovni informací a zastaví se všechny aktivity protokolování zpráv.</span><span class="sxs-lookup"><span data-stu-id="a911d-117">When the message limit is reached, a trace at the Information level is produced and all message logging activities stop.</span></span>

<span data-ttu-id="a911d-118">Úroveň protokolování, jakož i další možnosti, jsou popsány v části úroveň protokolování a možnosti.</span><span class="sxs-lookup"><span data-stu-id="a911d-118">The logging level, as well as the additional options, are discussed in the Logging Level and Options section.</span></span>

<span data-ttu-id="a911d-119">`switchValue`Atribut `source` je platný pouze pro trasování.</span><span class="sxs-lookup"><span data-stu-id="a911d-119">The `switchValue` attribute of a `source` is only valid for tracing.</span></span> <span data-ttu-id="a911d-120">Pokud zadáte `switchValue` atribut pro `System.ServiceModel.MessageLogging` zdroj trasování následujícím způsobem, nemá žádný vliv.</span><span class="sxs-lookup"><span data-stu-id="a911d-120">If you specify a `switchValue` attribute for the `System.ServiceModel.MessageLogging` trace source as follows, it has no effect.</span></span>

```xml
<source name="System.ServiceModel.MessageLogging" switchValue="Verbose">
</source>
```

<span data-ttu-id="a911d-121">Chcete-li zakázat zdroj trasování, použijte `logMessagesAtServiceLevel` `logMalformedMessages` `logMessagesAtTransportLevel` místo toho atributy, a `messageLogging` elementu.</span><span class="sxs-lookup"><span data-stu-id="a911d-121">If you want to disable the trace source, you should use the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element instead.</span></span> <span data-ttu-id="a911d-122">Všechny tyto atributy byste měli nastavit na `false` .</span><span class="sxs-lookup"><span data-stu-id="a911d-122">You should set all these attributes to `false`.</span></span> <span data-ttu-id="a911d-123">To lze provést pomocí konfiguračního souboru v předchozím příkladu kódu, prostřednictvím rozhraní Editor konfigurací uživatelského rozhraní nebo pomocí rozhraní WMI.</span><span class="sxs-lookup"><span data-stu-id="a911d-123">This can be done by using the configuration file in the previous code example, through the Configuration Editor UI interface, or using WMI.</span></span> <span data-ttu-id="a911d-124">Další informace o nástroji Editor konfigurací najdete v tématu [Nástroj Configuration Editor (SvcConfigEditor.exe)](../configuration-editor-tool-svcconfigeditor-exe.md).</span><span class="sxs-lookup"><span data-stu-id="a911d-124">For more information about the Configuration Editor tool, see [Configuration Editor Tool (SvcConfigEditor.exe)](../configuration-editor-tool-svcconfigeditor-exe.md).</span></span> <span data-ttu-id="a911d-125">Další informace o rozhraní WMI najdete v tématu [použití rozhraní WMI (Windows Management Instrumentation) pro diagnostiku](./wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="a911d-125">For more information about WMI, see [Using Windows Management Instrumentation for Diagnostics](./wmi/index.md).</span></span>

## <a name="logging-levels-and-options"></a><span data-ttu-id="a911d-126">Úrovně a možnosti protokolování</span><span class="sxs-lookup"><span data-stu-id="a911d-126">Logging Levels and Options</span></span>

<span data-ttu-id="a911d-127">Pro příchozí zprávy probíhá protokolování ihned po vytvoření zprávy, bezprostředně před tím, než se zpráva dostane do uživatelského kódu na úrovni služby a při zjištění poškozených zpráv.</span><span class="sxs-lookup"><span data-stu-id="a911d-127">For incoming messages, logging happens immediately after the message is formed, immediately before the message gets to user code in the service level, and when malformed messages are detected.</span></span>

<span data-ttu-id="a911d-128">U odchozích zpráv probíhá protokolování ihned poté, co zpráva opustí uživatelský kód a hned před tím, než se zpráva dostane na kabel.</span><span class="sxs-lookup"><span data-stu-id="a911d-128">For outgoing messages, logging happens immediately after the message leaves user code and immediately before the message goes on the wire.</span></span>

<span data-ttu-id="a911d-129">WCF protokoluje zprávy na dvou různých úrovních, službách a přenosu.</span><span class="sxs-lookup"><span data-stu-id="a911d-129">WCF logs messages at two different levels, service and transport.</span></span> <span data-ttu-id="a911d-130">Protokolují se také poškozené zprávy.</span><span class="sxs-lookup"><span data-stu-id="a911d-130">Malformed messages are also logged.</span></span> <span data-ttu-id="a911d-131">Tři kategorie jsou vzájemně nezávislé a je možné je aktivovat samostatně v konfiguraci.</span><span class="sxs-lookup"><span data-stu-id="a911d-131">The three categories are independent from each other and can be activated separately in configuration.</span></span>

<span data-ttu-id="a911d-132">Úroveň protokolování můžete řídit nastavením `logMessagesAtServiceLevel` `logMalformedMessages` atributů, a `logMessagesAtTransportLevel` `messageLogging` elementu.</span><span class="sxs-lookup"><span data-stu-id="a911d-132">You can control the logging level by setting the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element.</span></span>

### <a name="service-level"></a><span data-ttu-id="a911d-133">Úroveň služby</span><span class="sxs-lookup"><span data-stu-id="a911d-133">Service Level</span></span>

<span data-ttu-id="a911d-134">Zprávy zaznamenávané v této vrstvě se chystá zadat (při přijetí) nebo nechávají (při odesílání) uživatelský kód.</span><span class="sxs-lookup"><span data-stu-id="a911d-134">Messages logged at this layer are about to enter (on receiving) or leave (on sending) user code.</span></span> <span data-ttu-id="a911d-135">Pokud byly definovány filtry, budou protokolovány pouze zprávy, které odpovídají filtrům.</span><span class="sxs-lookup"><span data-stu-id="a911d-135">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="a911d-136">V opačném případě budou všechny zprávy na úrovni služby protokolovány.</span><span class="sxs-lookup"><span data-stu-id="a911d-136">Otherwise, all messages at the service level are logged.</span></span> <span data-ttu-id="a911d-137">Zprávy infrastruktury (transakce, rovnocenný kanál a zabezpečení) se protokolují i na této úrovni, s výjimkou zpráv spolehlivého zasílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="a911d-137">Infrastructure messages (transactions, peer channel, and security) are also logged at this level, except for Reliable Messaging messages.</span></span> <span data-ttu-id="a911d-138">U zpráv v proudu jsou protokolovány pouze hlavičky.</span><span class="sxs-lookup"><span data-stu-id="a911d-138">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="a911d-139">Kromě toho se na této úrovni šifrují protokolované zabezpečené zprávy.</span><span class="sxs-lookup"><span data-stu-id="a911d-139">In addition, secure messages are logged decrypted at this level.</span></span>

### <a name="transport-level"></a><span data-ttu-id="a911d-140">Úroveň transportu</span><span class="sxs-lookup"><span data-stu-id="a911d-140">Transport Level</span></span>

<span data-ttu-id="a911d-141">Zprávy zaznamenávané v této vrstvě jsou připravené k kódování nebo dekódování pro nebo po přepravení na drátě.</span><span class="sxs-lookup"><span data-stu-id="a911d-141">Messages logged at this layer are ready to be encoded or decoded for or after transportation on the wire.</span></span> <span data-ttu-id="a911d-142">Pokud byly definovány filtry, budou protokolovány pouze zprávy, které odpovídají filtrům.</span><span class="sxs-lookup"><span data-stu-id="a911d-142">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="a911d-143">V opačném případě jsou všechny zprávy na transportní vrstvě protokolovány.</span><span class="sxs-lookup"><span data-stu-id="a911d-143">Otherwise, all messages at the transport layer are logged.</span></span> <span data-ttu-id="a911d-144">Všechny zprávy infrastruktury jsou protokolovány v této vrstvě, včetně spolehlivých zpráv o zasílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="a911d-144">All infrastructure messages are logged at this layer, including reliable messaging messages.</span></span> <span data-ttu-id="a911d-145">U zpráv v proudu jsou protokolovány pouze hlavičky.</span><span class="sxs-lookup"><span data-stu-id="a911d-145">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="a911d-146">Zabezpečené zprávy se navíc protokolují jako šifrované na této úrovni, s výjimkou případů, kdy se používá zabezpečená přeprava, jako je HTTPS.</span><span class="sxs-lookup"><span data-stu-id="a911d-146">In addition, secure messages are logged as encrypted at this level, except if a secure transport such as HTTPS is used.</span></span>

### <a name="malformed-level"></a><span data-ttu-id="a911d-147">Poškozená úroveň</span><span class="sxs-lookup"><span data-stu-id="a911d-147">Malformed Level</span></span>

<span data-ttu-id="a911d-148">Poškozené zprávy jsou zprávy, které jsou odmítnuty zásobníkem WCF v jakékoli fázi zpracování.</span><span class="sxs-lookup"><span data-stu-id="a911d-148">Malformed messages are messages that are rejected by the WCF stack at any stage of processing.</span></span> <span data-ttu-id="a911d-149">Poškozené zprávy jsou protokolovány tak, jak jsou: šifrované, pokud jsou tak, s nesprávnými XML a tak dále.</span><span class="sxs-lookup"><span data-stu-id="a911d-149">Malformed messages are logged as-is: encrypted if they are so, with non-proper XML, and so on.</span></span> <span data-ttu-id="a911d-150">`maxSizeOfMessageToLog`definuje velikost zprávy, která má být zaznamenána jako CDATA.</span><span class="sxs-lookup"><span data-stu-id="a911d-150">`maxSizeOfMessageToLog` defined the size of the message to be logged as CDATA.</span></span> <span data-ttu-id="a911d-151">Ve výchozím nastavení `maxSizeOfMessageToLog` se rovná 256.</span><span class="sxs-lookup"><span data-stu-id="a911d-151">By default, `maxSizeOfMessageToLog` is equal to 256K.</span></span> <span data-ttu-id="a911d-152">Další informace o tomto atributu naleznete v části Další možnosti.</span><span class="sxs-lookup"><span data-stu-id="a911d-152">For more information about this attribute, see the Other Options section.</span></span>

### <a name="other-options"></a><span data-ttu-id="a911d-153">Další možnosti</span><span class="sxs-lookup"><span data-stu-id="a911d-153">Other Options</span></span>

<span data-ttu-id="a911d-154">Kromě úrovní protokolování může uživatel zadat následující možnosti:</span><span class="sxs-lookup"><span data-stu-id="a911d-154">In addition to the logging levels, the user can specify the following options:</span></span>

- <span data-ttu-id="a911d-155">Protokolovat celou zprávu ( `logEntireMessage` atribut): Tato hodnota určuje, zda má být zaznamenána celá zpráva (hlavička a tělo zprávy).</span><span class="sxs-lookup"><span data-stu-id="a911d-155">Log Entire Message (`logEntireMessage` attribute): This value specifies whether the entire message (message header and body) is logged.</span></span> <span data-ttu-id="a911d-156">Výchozí hodnota je `false` , což znamená, že je protokolována pouze hlavička.</span><span class="sxs-lookup"><span data-stu-id="a911d-156">The default value is `false`, meaning that only the header is logged.</span></span> <span data-ttu-id="a911d-157">Toto nastavení má vliv na úrovně protokolování zpráv služby a přenosu.</span><span class="sxs-lookup"><span data-stu-id="a911d-157">This setting affects service and transport message logging levels..</span></span>

- <span data-ttu-id="a911d-158">Maximální počet zpráv, které se mají protokolovat ( `maxMessagesToLog` atribut): Tato hodnota určuje maximální počet zpráv, které se mají protokolovat.</span><span class="sxs-lookup"><span data-stu-id="a911d-158">Max messages to log (`maxMessagesToLog` attribute): This value specifies the maximum number of messages to log.</span></span> <span data-ttu-id="a911d-159">K této kvótě se počítají všechny zprávy (služba, přenos a poškozené zprávy).</span><span class="sxs-lookup"><span data-stu-id="a911d-159">All messages (service, transport, and malformed messages) are counted towards this quota.</span></span> <span data-ttu-id="a911d-160">Po dosažení kvóty je vygenerováno trasování a nebude zaznamenána žádná další zpráva.</span><span class="sxs-lookup"><span data-stu-id="a911d-160">When the quota is reached, a trace is emitted and no additional message is logged.</span></span> <span data-ttu-id="a911d-161">Výchozí hodnota je 10000.</span><span class="sxs-lookup"><span data-stu-id="a911d-161">The default value is 10000.</span></span>

- <span data-ttu-id="a911d-162">Maximální velikost zprávy na protokol ( `maxSizeOfMessageToLog` atribut): Tato hodnota určuje maximální velikost zpráv pro přihlášení v bajtech.</span><span class="sxs-lookup"><span data-stu-id="a911d-162">Max size of message to log (`maxSizeOfMessageToLog` attribute): This value specifies the maximum size of messages to log in bytes.</span></span> <span data-ttu-id="a911d-163">Zprávy, které překračují limit velikosti, se neprotokolují a u této zprávy se neprovádí žádná jiná aktivita.</span><span class="sxs-lookup"><span data-stu-id="a911d-163">Messages that exceed the size limit are not logged, and no other activity is performed for that message.</span></span> <span data-ttu-id="a911d-164">Toto nastavení má vliv na všechny úrovně trasování.</span><span class="sxs-lookup"><span data-stu-id="a911d-164">This setting affects all trace levels.</span></span> <span data-ttu-id="a911d-165">Pokud je zapnuto trasování ServiceModel, vygeneruje se trasování úrovně upozornění v prvním bodu protokolování (ServiceModelSend \* nebo TransportReceive), které uživatele upozorní.</span><span class="sxs-lookup"><span data-stu-id="a911d-165">If ServiceModel tracing is on, a Warning level trace is emitted at the first logging point (ServiceModelSend\* or TransportReceive) to notify the user.</span></span> <span data-ttu-id="a911d-166">Výchozí hodnota pro zprávy na úrovni služby a na úrovni přenosu je 256, zatímco výchozí hodnota pro poškozené zprávy je 4K.</span><span class="sxs-lookup"><span data-stu-id="a911d-166">The default value for service level and transport level messages is 256K, while the default value for malformed messages is 4K.</span></span>

  > [!CAUTION]
  > <span data-ttu-id="a911d-167">Velikost zprávy, která je vypočítána pro porovnání, `maxSizeOfMessageToLog` je velikost zprávy v paměti před serializací.</span><span class="sxs-lookup"><span data-stu-id="a911d-167">The message size that is computed to compare against `maxSizeOfMessageToLog` is the message size in memory before serialization.</span></span> <span data-ttu-id="a911d-168">Tato velikost se může lišit od skutečné délky zaznamenaného řetězce zprávy a v mnoha případech je větší než skutečná velikost.</span><span class="sxs-lookup"><span data-stu-id="a911d-168">This size can differ from the actual length of the message string that is being logged, and in many occasions is bigger than the actual size.</span></span> <span data-ttu-id="a911d-169">V důsledku toho nemusí být zprávy protokolovány.</span><span class="sxs-lookup"><span data-stu-id="a911d-169">As a result, messages may not be logged.</span></span> <span data-ttu-id="a911d-170">K tomuto faktu se můžete přihlédnout zadáním `maxSizeOfMessageToLog` atributu, který bude větší než očekávaná velikost zprávy: 10%.</span><span class="sxs-lookup"><span data-stu-id="a911d-170">You can account for this fact by specifying the `maxSizeOfMessageToLog` attribute to be 10% larger than the expected message size.</span></span> <span data-ttu-id="a911d-171">Kromě toho, pokud jsou poškozené zprávy protokolovány, skutečné místo na disku využité protokoly zpráv může být až o 5 časů velikosti hodnoty určené parametrem `maxSizeOfMessageToLog` .</span><span class="sxs-lookup"><span data-stu-id="a911d-171">In addition, if malformed messages are logged, the actual disk space utilized by the message logs can be up to 5 times the size of the value specified by `maxSizeOfMessageToLog`.</span></span>

<span data-ttu-id="a911d-172">Pokud v konfiguračním souboru není definován naslouchací proces trasování, negeneruje se výstup protokolování bez ohledu na zadanou úroveň protokolování.</span><span class="sxs-lookup"><span data-stu-id="a911d-172">If no trace listener is defined in the configuration file, no logging output is generated regardless of the specified logging level.</span></span>

<span data-ttu-id="a911d-173">Možnosti protokolování zpráv, například atributy popsané v této části, lze změnit za běhu pomocí rozhraní WMI (Windows Management Instrumentation) (WMI).</span><span class="sxs-lookup"><span data-stu-id="a911d-173">Message logging options, such as the attributes described in this section, can be changed at runtime using Windows Management Instrumentation (WMI).</span></span> <span data-ttu-id="a911d-174">To lze provést přístupem k instanci [AppDomainInfo](./wmi/appdomaininfo.md) , která zpřístupňuje tyto logické vlastnosti: `LogMessagesAtServiceLevel` , `LogMessagesAtTransportLevel` a `LogMalformedMessages` .</span><span class="sxs-lookup"><span data-stu-id="a911d-174">This can be done by accessing the [AppDomainInfo](./wmi/appdomaininfo.md) instance, which exposes these Boolean properties: `LogMessagesAtServiceLevel`, `LogMessagesAtTransportLevel`, and `LogMalformedMessages`.</span></span> <span data-ttu-id="a911d-175">Proto pokud nakonfigurujete naslouchací proces trasování pro protokolování zpráv, ale tyto možnosti nastavíte na `false` v konfiguraci, můžete je později změnit na, `true` Pokud je aplikace spuštěná.</span><span class="sxs-lookup"><span data-stu-id="a911d-175">Therefore, if you configure a trace listener for message logging, but set these options to `false` in configuration, you can later change them to `true` when the application is running.</span></span> <span data-ttu-id="a911d-176">To efektivně povoluje protokolování zpráv za běhu.</span><span class="sxs-lookup"><span data-stu-id="a911d-176">This effectively enables message logging at runtime.</span></span> <span data-ttu-id="a911d-177">Podobně platí, že pokud povolíte protokolování zpráv v konfiguračním souboru, můžete ho za běhu zakázat pomocí rozhraní WMI.</span><span class="sxs-lookup"><span data-stu-id="a911d-177">Similarly, if you enable message logging in your configuration file, you can disable it at runtime using WMI.</span></span> <span data-ttu-id="a911d-178">Další informace najdete v tématu [použití rozhraní WMI (Windows Management Instrumentation) pro diagnostiku](./wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="a911d-178">For more information, see [Using Windows Management Instrumentation for Diagnostics](./wmi/index.md).</span></span>

<span data-ttu-id="a911d-179">`source`Pole v protokolu zpráv určuje, v němž kontextu je zpráva zaznamenána: při odesílání/přijímání zprávy požadavku, pro požadavek-odpověď nebo na jednosměrnou žádost, v modelu služby nebo transportní vrstvě nebo v případě poškozené zprávy.</span><span class="sxs-lookup"><span data-stu-id="a911d-179">The `source` field in a message log specifies in which context the message is logged: when sending/receiving a request message, for a request-reply or 1-way request, at service model or transport layer, or in the case of a malformed message.</span></span>

<span data-ttu-id="a911d-180">Pro poškozené zprávy `source` se rovná `Malformed` .</span><span class="sxs-lookup"><span data-stu-id="a911d-180">For malformed messages, `source`  is equal to `Malformed`.</span></span> <span data-ttu-id="a911d-181">V opačném případě má zdroj následující hodnoty na základě kontextu.</span><span class="sxs-lookup"><span data-stu-id="a911d-181">Otherwise, source has the following values based on the context.</span></span>

<span data-ttu-id="a911d-182">Pro požadavek nebo odpověď</span><span class="sxs-lookup"><span data-stu-id="a911d-182">For Request/Reply</span></span>

||<span data-ttu-id="a911d-183">Odeslat žádost</span><span class="sxs-lookup"><span data-stu-id="a911d-183">Send Request</span></span>|<span data-ttu-id="a911d-184">Žádost o přijetí</span><span class="sxs-lookup"><span data-stu-id="a911d-184">Receive Request</span></span>|<span data-ttu-id="a911d-185">Odeslat odpověď</span><span class="sxs-lookup"><span data-stu-id="a911d-185">Send Reply</span></span>|<span data-ttu-id="a911d-186">Přijmout odpověď</span><span class="sxs-lookup"><span data-stu-id="a911d-186">Receive Reply</span></span>|
|-|------------------|---------------------|----------------|-------------------|
|<span data-ttu-id="a911d-187">Vrstva modelu služby</span><span class="sxs-lookup"><span data-stu-id="a911d-187">Service Model layer</span></span>|<span data-ttu-id="a911d-188">Služba</span><span class="sxs-lookup"><span data-stu-id="a911d-188">Service</span></span><br /><br /> <span data-ttu-id="a911d-189">Úroveň</span><span class="sxs-lookup"><span data-stu-id="a911d-189">Level</span></span><br /><br /> <span data-ttu-id="a911d-190">Odeslat</span><span class="sxs-lookup"><span data-stu-id="a911d-190">Send</span></span><br /><br /> <span data-ttu-id="a911d-191">Žádost</span><span class="sxs-lookup"><span data-stu-id="a911d-191">Request</span></span>|<span data-ttu-id="a911d-192">Služba</span><span class="sxs-lookup"><span data-stu-id="a911d-192">Service</span></span><br /><br /> <span data-ttu-id="a911d-193">Úroveň</span><span class="sxs-lookup"><span data-stu-id="a911d-193">Level</span></span><br /><br /> <span data-ttu-id="a911d-194">Přijmout</span><span class="sxs-lookup"><span data-stu-id="a911d-194">Receive</span></span><br /><br /> <span data-ttu-id="a911d-195">Žádost</span><span class="sxs-lookup"><span data-stu-id="a911d-195">Request</span></span>|<span data-ttu-id="a911d-196">Služba</span><span class="sxs-lookup"><span data-stu-id="a911d-196">Service</span></span><br /><br /> <span data-ttu-id="a911d-197">Úroveň</span><span class="sxs-lookup"><span data-stu-id="a911d-197">Level</span></span><br /><br /> <span data-ttu-id="a911d-198">Odeslat</span><span class="sxs-lookup"><span data-stu-id="a911d-198">Send</span></span><br /><br /> <span data-ttu-id="a911d-199">Odpovědět</span><span class="sxs-lookup"><span data-stu-id="a911d-199">Reply</span></span>|<span data-ttu-id="a911d-200">Služba</span><span class="sxs-lookup"><span data-stu-id="a911d-200">Service</span></span><br /><br /> <span data-ttu-id="a911d-201">Úroveň</span><span class="sxs-lookup"><span data-stu-id="a911d-201">Level</span></span><br /><br /> <span data-ttu-id="a911d-202">Přijmout</span><span class="sxs-lookup"><span data-stu-id="a911d-202">Receive</span></span><br /><br /> <span data-ttu-id="a911d-203">Odpovědět</span><span class="sxs-lookup"><span data-stu-id="a911d-203">Reply</span></span>|
|<span data-ttu-id="a911d-204">Transportní vrstva</span><span class="sxs-lookup"><span data-stu-id="a911d-204">Transport layer</span></span>|<span data-ttu-id="a911d-205">Přenos</span><span class="sxs-lookup"><span data-stu-id="a911d-205">Transport</span></span><br /><br /> <span data-ttu-id="a911d-206">Odeslat</span><span class="sxs-lookup"><span data-stu-id="a911d-206">Send</span></span>|<span data-ttu-id="a911d-207">Přenos</span><span class="sxs-lookup"><span data-stu-id="a911d-207">Transport</span></span><br /><br /> <span data-ttu-id="a911d-208">Přijmout</span><span class="sxs-lookup"><span data-stu-id="a911d-208">Receive</span></span>|<span data-ttu-id="a911d-209">Přenos</span><span class="sxs-lookup"><span data-stu-id="a911d-209">Transport</span></span><br /><br /> <span data-ttu-id="a911d-210">Odeslat</span><span class="sxs-lookup"><span data-stu-id="a911d-210">Send</span></span>|<span data-ttu-id="a911d-211">Přenos</span><span class="sxs-lookup"><span data-stu-id="a911d-211">Transport</span></span><br /><br /> <span data-ttu-id="a911d-212">Přijmout</span><span class="sxs-lookup"><span data-stu-id="a911d-212">Receive</span></span>|

<span data-ttu-id="a911d-213">Jednosměrná žádost</span><span class="sxs-lookup"><span data-stu-id="a911d-213">For One-way Request</span></span>

||<span data-ttu-id="a911d-214">Odeslat žádost</span><span class="sxs-lookup"><span data-stu-id="a911d-214">Send Request</span></span>|<span data-ttu-id="a911d-215">Žádost o přijetí</span><span class="sxs-lookup"><span data-stu-id="a911d-215">Receive Request</span></span>|
|-|------------------|---------------------|
|<span data-ttu-id="a911d-216">Vrstva modelu služby</span><span class="sxs-lookup"><span data-stu-id="a911d-216">Service Model layer</span></span>|<span data-ttu-id="a911d-217">Služba</span><span class="sxs-lookup"><span data-stu-id="a911d-217">Service</span></span><br /><br /> <span data-ttu-id="a911d-218">Úroveň</span><span class="sxs-lookup"><span data-stu-id="a911d-218">Level</span></span><br /><br /> <span data-ttu-id="a911d-219">Odeslat</span><span class="sxs-lookup"><span data-stu-id="a911d-219">Send</span></span><br /><br /> <span data-ttu-id="a911d-220">Pohybuje</span><span class="sxs-lookup"><span data-stu-id="a911d-220">Datagram</span></span>|<span data-ttu-id="a911d-221">Služba</span><span class="sxs-lookup"><span data-stu-id="a911d-221">Service</span></span><br /><br /> <span data-ttu-id="a911d-222">Úroveň</span><span class="sxs-lookup"><span data-stu-id="a911d-222">Level</span></span><br /><br /> <span data-ttu-id="a911d-223">Přijmout</span><span class="sxs-lookup"><span data-stu-id="a911d-223">Receive</span></span><br /><br /> <span data-ttu-id="a911d-224">Pohybuje</span><span class="sxs-lookup"><span data-stu-id="a911d-224">Datagram</span></span>|
|<span data-ttu-id="a911d-225">Transportní vrstva</span><span class="sxs-lookup"><span data-stu-id="a911d-225">Transport layer</span></span>|<span data-ttu-id="a911d-226">Přenos</span><span class="sxs-lookup"><span data-stu-id="a911d-226">Transport</span></span><br /><br /> <span data-ttu-id="a911d-227">Odeslat</span><span class="sxs-lookup"><span data-stu-id="a911d-227">Send</span></span>|<span data-ttu-id="a911d-228">Přenos</span><span class="sxs-lookup"><span data-stu-id="a911d-228">Transport</span></span><br /><br /> <span data-ttu-id="a911d-229">Přijmout</span><span class="sxs-lookup"><span data-stu-id="a911d-229">Receive</span></span>|

## <a name="message-filters"></a><span data-ttu-id="a911d-230">Filtry zpráv</span><span class="sxs-lookup"><span data-stu-id="a911d-230">Message Filters</span></span>

<span data-ttu-id="a911d-231">Filtry zpráv jsou definovány v `messageLogging` konfiguračním elementu `diagnostics` konfiguračního oddílu.</span><span class="sxs-lookup"><span data-stu-id="a911d-231">Message filters are defined in the `messageLogging` configuration element of the `diagnostics` configuration section.</span></span> <span data-ttu-id="a911d-232">Jsou aplikovány na úrovni služby a přenosu.</span><span class="sxs-lookup"><span data-stu-id="a911d-232">They are applied at the service and transport level.</span></span> <span data-ttu-id="a911d-233">Při definování jednoho nebo více filtrů jsou protokolovány pouze zprávy, které odpovídají alespoň jednomu z filtrů.</span><span class="sxs-lookup"><span data-stu-id="a911d-233">When one or more filters are defined, only messages that match at least one of the filters are logged.</span></span> <span data-ttu-id="a911d-234">Pokud není definován žádný filtr, všechny zprávy procházejí.</span><span class="sxs-lookup"><span data-stu-id="a911d-234">If no filter is defined, all messages pass through.</span></span>

<span data-ttu-id="a911d-235">Filtry podporují úplnou syntaxi XPath a jsou aplikovány v pořadí, v jakém jsou uvedeny v konfiguračním souboru.</span><span class="sxs-lookup"><span data-stu-id="a911d-235">Filters support the full XPath syntax and are applied in the order they appear in the configuration file.</span></span> <span data-ttu-id="a911d-236">Syntakticky nesprávný filtr má za následek výjimku konfigurace.</span><span class="sxs-lookup"><span data-stu-id="a911d-236">A syntactically incorrect filter results in a configuration exception.</span></span>

<span data-ttu-id="a911d-237">Filtry také poskytují bezpečnostní funkci s použitím `nodeQuota` atributu, který omezuje maximální počet uzlů v modelu DOM elementu XPath, které lze prozkoumat tak, aby odpovídaly filtru.</span><span class="sxs-lookup"><span data-stu-id="a911d-237">Filters also provide a safety feature using the `nodeQuota` attribute, which limits the maximum number of nodes in the XPath DOM that can be examined to match the filter.</span></span>

<span data-ttu-id="a911d-238">Následující příklad ukazuje, jak nakonfigurovat filtr, který zaznamenává pouze zprávy, které mají hlavičku SOAP.</span><span class="sxs-lookup"><span data-stu-id="a911d-238">The following example shows how to configure a filter that records only messages that have a SOAP header section.</span></span>

```xml
<messageLogging logEntireMessage="true"
    logMalformedMessages="true"
    logMessagesAtServiceLevel="true"
    logMessagesAtTransportLevel="true"
    maxMessagesToLog="420">
    <filters>
        <add nodeQuota="10" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
                 /soap:Envelope/soap:Header
        </add>
     </filters>
</messageLogging>
```

<span data-ttu-id="a911d-239">Filtry nelze použít pro tělo zprávy.</span><span class="sxs-lookup"><span data-stu-id="a911d-239">Filters cannot be applied to the body of a message.</span></span> <span data-ttu-id="a911d-240">Filtry, které se pokoušejí manipulovat s textem zprávy, se ze seznamu filtrů odeberou.</span><span class="sxs-lookup"><span data-stu-id="a911d-240">Filters that attempt to manipulate the body of a message are removed from the list of filters.</span></span> <span data-ttu-id="a911d-241">Vygeneruje se taky událost, která to indikuje.</span><span class="sxs-lookup"><span data-stu-id="a911d-241">An event is also emitted that indicates this.</span></span> <span data-ttu-id="a911d-242">Například následující filtr by byl odebrán z tabulky filtru.</span><span class="sxs-lookup"><span data-stu-id="a911d-242">For example, the following filter would be removed from the filter table.</span></span>

```xml
<add xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">/s:Envelope/s:Body[contains(text(), "Hello")]</add>
```

## <a name="configuring-a-custom-listener"></a><span data-ttu-id="a911d-243">Konfigurace vlastního naslouchacího procesu</span><span class="sxs-lookup"><span data-stu-id="a911d-243">Configuring a Custom Listener</span></span>

<span data-ttu-id="a911d-244">Můžete také nakonfigurovat vlastní naslouchací proces s dalšími možnostmi.</span><span class="sxs-lookup"><span data-stu-id="a911d-244">You can also configure a custom listener with additional options.</span></span> <span data-ttu-id="a911d-245">Vlastní naslouchací proces může být užitečný pro filtrování prvků PII specifických pro aplikaci ze zpráv před přihlášením.</span><span class="sxs-lookup"><span data-stu-id="a911d-245">A custom listener can be useful in filtering application-specific PII elements from messages before logging.</span></span> <span data-ttu-id="a911d-246">Následující příklad ukazuje vlastní konfiguraci naslouchacího procesu.</span><span class="sxs-lookup"><span data-stu-id="a911d-246">The following example demonstrates a custom listener configuration.</span></span>

```xml
<system.diagnostics>
   <sources>
     <source name="System.ServiceModel.MessageLogging">
           <listeners>
             <add name="MyListener"
                    type="YourCustomListener"
                    initializeData="c:\logs\messages.svclog"
                    maxDiskSpace="1000"/>
           </listeners>
     </source>
   </sources>
</system.diagnostics>
```

<span data-ttu-id="a911d-247">Měli byste si uvědomit, že `type` atribut by měl být nastaven na kvalifikovaný název sestavení typu.</span><span class="sxs-lookup"><span data-stu-id="a911d-247">You should be aware that the `type` attribute should be set to a qualified assembly name of the type.</span></span>

## <a name="see-also"></a><span data-ttu-id="a911d-248">Viz také</span><span class="sxs-lookup"><span data-stu-id="a911d-248">See also</span></span>

- [\<messageLogging>](../../configure-apps/file-schema/wcf/messagelogging.md)
- [<span data-ttu-id="a911d-249">Protokolování zpráv</span><span class="sxs-lookup"><span data-stu-id="a911d-249">Message Logging</span></span>](message-logging.md)
- [<span data-ttu-id="a911d-250">Doporučené nastavení pro trasování a protokolování zpráv</span><span class="sxs-lookup"><span data-stu-id="a911d-250">Recommended Settings for Tracing and Message Logging</span></span>](./tracing/recommended-settings-for-tracing-and-message-logging.md)
