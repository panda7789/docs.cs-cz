---
title: Bezpečnostní problémy v generování reflexe
ms.date: 03/30/2017
helpviewer_keywords:
- partially trusted code
- emitting dynamic assemblies, security
- reflection emit, security
- reflection emit, partial trust scenarios
- partial trust,emitting dynamic methods
- anonymously hosted dynamic methods [.NET Framework]
- emitting dynamic assemblies,partial trust scenarios
- dynamic assemblies, security
ms.assetid: 0f8bf8fa-b993-478f-87ab-1a1a7976d298
ms.openlocfilehash: f04b40edde0755315f3b4fd4284fc7c804a54313
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/30/2019
ms.locfileid: "73130047"
---
# <a name="security-issues-in-reflection-emit"></a><span data-ttu-id="3ccd8-102">Bezpečnostní problémy v generování reflexe</span><span class="sxs-lookup"><span data-stu-id="3ccd8-102">Security Issues in Reflection Emit</span></span>
<span data-ttu-id="3ccd8-103">.NET Framework poskytuje tři způsoby, jak vygenerovat jazyk MSIL (Microsoft Intermediate Language), z nichž každá má vlastní problémy se zabezpečením:</span><span class="sxs-lookup"><span data-stu-id="3ccd8-103">The .NET Framework provides three ways to emit Microsoft intermediate language (MSIL), each with its own security issues:</span></span>  
  
- [<span data-ttu-id="3ccd8-104">Dynamická sestavení</span><span class="sxs-lookup"><span data-stu-id="3ccd8-104">Dynamic assemblies</span></span>](#Dynamic_Assemblies)  
  
- [<span data-ttu-id="3ccd8-105">Anonymně hostované dynamické metody</span><span class="sxs-lookup"><span data-stu-id="3ccd8-105">Anonymously hosted dynamic methods</span></span>](#Anonymously_Hosted_Dynamic_Methods)  
  
- [<span data-ttu-id="3ccd8-106">Dynamické metody přidružené k existujícím sestavením</span><span class="sxs-lookup"><span data-stu-id="3ccd8-106">Dynamic methods associated with existing assemblies</span></span>](#Dynamic_Methods_Associated_with_Existing_Assemblies)  
  
 <span data-ttu-id="3ccd8-107">Bez ohledu na způsob generování dynamického kódu vyžaduje spuštění vygenerovaného kódu všechna oprávnění, která jsou vyžadována typy a metodami, které vygenerovaný kód používá.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-107">Regardless of the way you generate dynamic code, executing the generated code requires all the permissions that are required by the types and methods the generated code uses.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3ccd8-108">Oprávnění, která jsou vyžadována pro reflektování kódu a vygenerování kódu, se změnila pomocí následujících vydání .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-108">The permissions that are required for reflecting on code and emitting code have changed with succeeding releases of the .NET Framework.</span></span> <span data-ttu-id="3ccd8-109">Viz [informace o verzi](#Version_Information)dále v tomto tématu.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-109">See [Version Information](#Version_Information), later in this topic.</span></span>  
  
<a name="Dynamic_Assemblies"></a>   
## <a name="dynamic-assemblies"></a><span data-ttu-id="3ccd8-110">Dynamická sestavení</span><span class="sxs-lookup"><span data-stu-id="3ccd8-110">Dynamic Assemblies</span></span>  
 <span data-ttu-id="3ccd8-111">Dynamická sestavení jsou vytvořena pomocí přetížení metody <xref:System.AppDomain.DefineDynamicAssembly%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-111">Dynamic assemblies are created by using overloads of the <xref:System.AppDomain.DefineDynamicAssembly%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="3ccd8-112">Většina přetížení této metody je zastaralá v .NET Framework 4 z důvodu eliminace zásad zabezpečení na úrovni počítače.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-112">Most overloads of this method are deprecated in the .NET Framework 4, because of the elimination of machine-wide security policy.</span></span> <span data-ttu-id="3ccd8-113">(Viz [změny zabezpečení](../security/security-changes.md).) Zbývající přetížení lze spustit libovolným kódem bez ohledu na úroveň důvěryhodnosti.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-113">(See [Security Changes](../security/security-changes.md).) The remaining overloads can be executed by any code, regardless of trust level.</span></span> <span data-ttu-id="3ccd8-114">Tato přetížení spadají do dvou skupin: těch, které určují seznam atributů, které mají být použity pro dynamické sestavení při jeho vytvoření, a těch, které ne.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-114">These overloads fall into two groups: those that specify a list of attributes to apply to the dynamic assembly when it is created, and those that do not.</span></span> <span data-ttu-id="3ccd8-115">Pokud nezadáte model transparentnosti pro sestavení, při použití atributu <xref:System.Security.SecurityRulesAttribute> při jeho vytváření, je model transparentnosti zděděn z vygenerování sestavení.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-115">If you do not specify the transparency model for the assembly, by applying the <xref:System.Security.SecurityRulesAttribute> attribute when you create it, the transparency model is inherited from the emitting assembly.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3ccd8-116">Atributy, které lze použít na dynamické sestavení po jeho vytvoření, pomocí metody <xref:System.Reflection.Emit.AssemblyBuilder.SetCustomAttribute%2A> se neprojeví, dokud nebude sestavení uloženo na disk a znovu načteno do paměti.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-116">Attributes that you apply to the dynamic assembly after it is created, by using the <xref:System.Reflection.Emit.AssemblyBuilder.SetCustomAttribute%2A> method, do not take effect until the assembly has been saved to disk and loaded into memory again.</span></span>  
  
 <span data-ttu-id="3ccd8-117">Kód v dynamickém sestavení může přistupovat ke viditelným typům a členům v jiných sestaveních.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-117">Code in a dynamic assembly can access visible types and members in other assemblies.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3ccd8-118">Dynamická sestavení nepoužívají příznaky <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> a <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, které umožňují dynamickým metodám přístup k NonPublic typům a členům.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-118">Dynamic assemblies do not use the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> and <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flags that allow dynamic methods to access nonpublic types and members.</span></span>  
  
 <span data-ttu-id="3ccd8-119">Přechodná dynamická sestavení se vytvoří v paměti a nikdy se neukládají na disk, takže nevyžadují oprávnění k přístupu k souboru.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-119">Transient dynamic assemblies are created in memory and never saved to disk, so they require no file access permissions.</span></span> <span data-ttu-id="3ccd8-120">Uložení dynamického sestavení na disk vyžaduje <xref:System.Security.Permissions.FileIOPermission> s příslušnými příznaky.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-120">Saving a dynamic assembly to disk requires <xref:System.Security.Permissions.FileIOPermission> with the appropriate flags.</span></span>  
  
### <a name="generating-dynamic-assemblies-from-partially-trusted-code"></a><span data-ttu-id="3ccd8-121">Generování dynamických sestavení z částečně důvěryhodného kódu</span><span class="sxs-lookup"><span data-stu-id="3ccd8-121">Generating Dynamic Assemblies from Partially Trusted Code</span></span>  
 <span data-ttu-id="3ccd8-122">Vezměte v úvahu podmínky, ve kterých sestavení s oprávněními k Internetu může generovat přechodné dynamické sestavení a provést svůj kód:</span><span class="sxs-lookup"><span data-stu-id="3ccd8-122">Consider the conditions in which an assembly with Internet permissions can generate a transient dynamic assembly and execute its code:</span></span>  
  
- <span data-ttu-id="3ccd8-123">Dynamické sestavení používá pouze veřejné typy a členy jiných sestavení.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-123">The dynamic assembly uses only public types and members of other assemblies.</span></span>  
  
- <span data-ttu-id="3ccd8-124">Oprávnění vydaná těmito typy a členy jsou obsažena v sadě udělení částečně důvěryhodného sestavení.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-124">The permissions demanded by those types and members are included in the grant set of the partially trusted assembly.</span></span>  
  
- <span data-ttu-id="3ccd8-125">Sestavení není uloženo na disk.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-125">The assembly is not saved to disk.</span></span>  
  
- <span data-ttu-id="3ccd8-126">Symboly ladění nejsou vygenerovány.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-126">Debug symbols are not generated.</span></span> <span data-ttu-id="3ccd8-127">(`Internet` a `LocalIntranet` sady oprávnění nezahrnují potřebná oprávnění.)</span><span class="sxs-lookup"><span data-stu-id="3ccd8-127">(`Internet` and `LocalIntranet` permission sets do not include the necessary permissions.)</span></span>  
  
<a name="Anonymously_Hosted_Dynamic_Methods"></a>   
## <a name="anonymously-hosted-dynamic-methods"></a><span data-ttu-id="3ccd8-128">Anonymně hostované dynamické metody</span><span class="sxs-lookup"><span data-stu-id="3ccd8-128">Anonymously Hosted Dynamic Methods</span></span>  
 <span data-ttu-id="3ccd8-129">Anonymně hostované dynamické metody jsou vytvářeny pomocí dvou konstruktorů <xref:System.Reflection.Emit.DynamicMethod>, které nespecifikují přidružený typ nebo modul, <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%29> a <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%2CSystem.Boolean%29>.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-129">Anonymously hosted dynamic methods are created by using the two <xref:System.Reflection.Emit.DynamicMethod> constructors that do not specify an associated type or module, <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%29> and <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%2CSystem.Boolean%29>.</span></span> <span data-ttu-id="3ccd8-130">Tyto konstruktory umísťují dynamické metody do plně důvěryhodného sestavení v rámci systému, které je transparentní pro zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-130">These constructors place the dynamic methods in a system-provided, fully trusted, security-transparent assembly.</span></span> <span data-ttu-id="3ccd8-131">K použití těchto konstruktorů nebo k vygenerování kódu pro dynamické metody nejsou nutná žádná oprávnění.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-131">No permissions are required to use these constructors or to emit code for the dynamic methods.</span></span>  
  
 <span data-ttu-id="3ccd8-132">Místo toho, když je vytvořena anonymně hostovaná dynamická metoda, je zachycen zásobník volání.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-132">Instead, when an anonymously hosted dynamic method is created, the call stack is captured.</span></span> <span data-ttu-id="3ccd8-133">Při konstrukci metody jsou požadavky na zabezpečení provedeny proti zachycenému zásobníku volání.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-133">When the method is constructed, security demands are made against the captured call stack.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3ccd8-134">V koncepčních případech jsou požadavky provedeny během konstrukce metody.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-134">Conceptually, demands are made during the construction of the method.</span></span> <span data-ttu-id="3ccd8-135">To znamená, že požadavky mohou být provedeny při vygenerování každé instrukce jazyka MSIL.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-135">That is, demands could be made as each MSIL instruction is emitted.</span></span> <span data-ttu-id="3ccd8-136">V aktuální implementaci jsou všechny požadavky provedeny, když je volána metoda <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A?displayProperty=nameWithType> nebo když je vyvolána kompilátor JIT (just-in-time), pokud je metoda vyvolána bez volání <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-136">In the current implementation, all demands are made when the <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A?displayProperty=nameWithType> method is called or when the just-in-time (JIT) compiler is invoked, if the method is invoked without calling <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>.</span></span>  
  
 <span data-ttu-id="3ccd8-137">Pokud to doména aplikace povoluje, můžou anonymně hostované dynamické metody přeskočit kontroly viditelnosti JIT, a to v souladu s následujícím omezením: typy NonPublic a členové, ke kterým přistupovala anonymně hostovaná dynamická metoda, musí být v sestaveních, jejichž sady udělení udělují. jsou rovny nebo podmnožinám, udělení sady volání zásobníku volání.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-137">If the application domain permits it, anonymously hosted dynamic methods can skip JIT visibility checks, subject to the following restriction: The nonpublic types and members accessed by an anonymously hosted dynamic method must be in assemblies whose grant sets are equal to, or subsets of, the grant set of the emitting call stack.</span></span> <span data-ttu-id="3ccd8-138">Tato omezená schopnost přeskočit kontroly viditelnosti JIT je povolena, pokud aplikační doména udělí <xref:System.Security.Permissions.ReflectionPermission> s příznakem <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-138">This restricted ability to skip JIT visibility checks is enabled if the application domain grants <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="3ccd8-139">Pokud vaše metoda používá pouze veřejné typy a členy, během konstrukce nejsou požadována žádná oprávnění.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-139">If your method uses only public types and members, no permissions are required during construction.</span></span>  
  
- <span data-ttu-id="3ccd8-140">Pokud určíte, že se mají přeskočit kontroly viditelnosti JIT, požadavek, který je vytvořen při vytvoření metody, zahrnuje <xref:System.Security.Permissions.ReflectionPermission> s příznakem <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> a sadou udělení sestavení, která obsahuje přistupující člena NonPublic.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-140">If you specify that JIT visibility checks should be skipped, the demand that is made when the method is constructed includes <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag and the grant set of the assembly that contains the nonpublic member that is being accessed.</span></span>  
  
 <span data-ttu-id="3ccd8-141">Vzhledem k tomu, že se udělí sada udělení NonPublic člena, částečně důvěryhodný kód, který byl udělen <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> nemůže zvýšit oprávnění tím, že spouští NonPublic členy důvěryhodných sestavení.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-141">Because the grant set of the nonpublic member is taken into consideration, partially trusted code that has been granted <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> cannot elevate its privileges by executing nonpublic members of trusted assemblies.</span></span>  
  
 <span data-ttu-id="3ccd8-142">Stejně jako u jakéhokoli jiného vygenerovaného kódu vyžaduje spuštění dynamické metody libovolné oprávnění metody, které používá dynamická metoda.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-142">As with any other emitted code, executing the dynamic method requires whatever permissions are demanded by the methods the dynamic method uses.</span></span>  
  
 <span data-ttu-id="3ccd8-143">Systémové sestavení, které je hostitelem anonymních dynamických metod, používá <xref:System.Security.SecurityRuleSet.Level1?displayProperty=nameWithType> model transparentnosti, což je model transparentnosti, který byl použit v .NET Framework před .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-143">The system assembly that hosts anonymously-hosted dynamic methods uses the <xref:System.Security.SecurityRuleSet.Level1?displayProperty=nameWithType> transparency model, which is the transparency model that was used in the .NET Framework before the .NET Framework 4.</span></span>  
  
 <span data-ttu-id="3ccd8-144">Další informace naleznete v tématu Třída <xref:System.Reflection.Emit.DynamicMethod>.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-144">For more information, see the <xref:System.Reflection.Emit.DynamicMethod> class.</span></span>  
  
### <a name="generating-anonymously-hosted-dynamic-methods-from-partially-trusted-code"></a><span data-ttu-id="3ccd8-145">Generování anonymně hostovaných dynamických metod z částečně důvěryhodného kódu</span><span class="sxs-lookup"><span data-stu-id="3ccd8-145">Generating Anonymously Hosted Dynamic Methods from Partially Trusted Code</span></span>  
 <span data-ttu-id="3ccd8-146">Vezměte v úvahu podmínky, ve kterých sestavení s oprávněními k Internetu může generovat anonymně hostovanou dynamickou metodu a provést ji:</span><span class="sxs-lookup"><span data-stu-id="3ccd8-146">Consider the conditions in which an assembly with Internet permissions can generate an anonymously hosted dynamic method and execute it:</span></span>  
  
- <span data-ttu-id="3ccd8-147">Dynamická metoda používá pouze veřejné typy a členy.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-147">The dynamic method uses only public types and members.</span></span> <span data-ttu-id="3ccd8-148">Pokud jeho sada udělení zahrnuje <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, může použít typy NonPublic a členy všech sestavení, jejichž udělený přístup se rovná nebo je podmnožinou udělené sestavení pro generování.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-148">If its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, it can use nonpublic types and members of any assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly.</span></span>  
  
- <span data-ttu-id="3ccd8-149">Oprávnění, která jsou vyžadována všemi typy a členy použitými dynamickou metodou, jsou součástí sady udělení částečně důvěryhodného sestavení.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-149">The permissions that are required by all the types and members used by the dynamic method are included in the grant set of the partially trusted assembly.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3ccd8-150">Dynamické metody nepodporují symboly ladění.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-150">Dynamic methods do not support debug symbols.</span></span>  
  
<a name="Dynamic_Methods_Associated_with_Existing_Assemblies"></a>   
## <a name="dynamic-methods-associated-with-existing-assemblies"></a><span data-ttu-id="3ccd8-151">Dynamické metody přidružené k existujícím sestavením</span><span class="sxs-lookup"><span data-stu-id="3ccd8-151">Dynamic Methods Associated with Existing Assemblies</span></span>  
 <span data-ttu-id="3ccd8-152">Chcete-li přidružit dynamickou metodu k typu nebo modulu v existujícím sestavení, použijte libovolný konstruktor <xref:System.Reflection.Emit.DynamicMethod>, který určuje přidružený typ nebo modul.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-152">To associate a dynamic method with a type or module in an existing assembly, use any of the <xref:System.Reflection.Emit.DynamicMethod> constructors that specify the associated type or module.</span></span> <span data-ttu-id="3ccd8-153">Oprávnění, která jsou vyžadována pro volání těchto konstruktorů, se liší, protože přidružení dynamické metody s existujícím typem nebo modul poskytuje přístup dynamické metody k NonPublic typům a členům:</span><span class="sxs-lookup"><span data-stu-id="3ccd8-153">The permissions that are required to call these constructors vary, because associating a dynamic method with an existing type or module gives the dynamic method access to nonpublic types and members:</span></span>  
  
- <span data-ttu-id="3ccd8-154">Dynamická metoda, která je přidružena k typu, má přístup ke všem členům daného typu, dokonce i k soukromým členům a všem interním typům a členům v sestavení, které obsahují přidružený typ.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-154">A dynamic method that is associated with a type has access to all members of that type, even private members, and to all internal types and members in the assembly that contains the associated type.</span></span>  
  
- <span data-ttu-id="3ccd8-155">Dynamická metoda, která je přidružená k modulu, má přístup ke všem typům `internal` a členům (`Friend` v Visual Basic, `assembly` v metadatech Common Language Runtime) v modulu.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-155">A dynamic method that is associated with a module has access to all the `internal` types and members (`Friend` in Visual Basic, `assembly` in common language runtime metadata) in the module.</span></span>  
  
 <span data-ttu-id="3ccd8-156">Kromě toho můžete použít konstruktor, který určuje schopnost přeskočit kontroly viditelnosti kompilátoru JIT.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-156">In addition, you can use a constructor that specifies the ability to skip the visibility checks of the JIT compiler.</span></span> <span data-ttu-id="3ccd8-157">Tím zajistíte přístup k dynamické metodě všem typům a členům ve všech sestaveních bez ohledu na úroveň přístupu.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-157">Doing so gives your dynamic method access to all types and members in all assemblies, regardless of access level.</span></span>  
  
 <span data-ttu-id="3ccd8-158">Oprávnění, která jsou vyvolána konstruktorem závisí na tom, kolik přístupu se rozhodnete poskytnout dynamickou metodu:</span><span class="sxs-lookup"><span data-stu-id="3ccd8-158">The permissions demanded by the constructor depend on how much access you decide to give your dynamic method:</span></span>  
  
- <span data-ttu-id="3ccd8-159">Pokud vaše metoda používá pouze veřejné typy a členy a přidružíte ji k vlastnímu typu nebo vlastnímu modulu, nejsou vyžadována žádná oprávnění.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-159">If your method uses only public types and members, and you associate it with your own type or your own module, no permissions are required.</span></span>  
  
- <span data-ttu-id="3ccd8-160">Pokud určíte, že se mají přeskočit kontroly viditelnosti JIT, konstruktor požaduje <xref:System.Security.Permissions.ReflectionPermission> s příznakem <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-160">If you specify that JIT visibility checks should be skipped, the constructor demands <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="3ccd8-161">Pokud přidružíte dynamickou metodu k jinému typu, dokonce i jiný typ ve vašem vlastním sestavení, konstruktor požaduje <xref:System.Security.Permissions.ReflectionPermission> s příznakem <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> a <xref:System.Security.Permissions.SecurityPermission> s příznakem <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-161">If you associate the dynamic method with another type, even another type in your own assembly, the constructor demands <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag and <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="3ccd8-162">Pokud přidružíte dynamickou metodu k typu nebo modulu v jiném sestavení, konstruktor požaduje dvě věci: <xref:System.Security.Permissions.ReflectionPermission> s příznakem <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> a sadou udělení sestavení, která obsahuje jiný modul.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-162">If you associate the dynamic method with a type or module in another assembly, the constructor demands two things: <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag, and the grant set of the assembly that contains the other module.</span></span> <span data-ttu-id="3ccd8-163">To znamená, že váš zásobník volání musí zahrnovat všechna oprávnění v sadě udělení cílového modulu a navíc <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-163">That is, your call stack must include all the permissions in the grant set of the target module, plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span></span>  
  
    > [!NOTE]
    > <span data-ttu-id="3ccd8-164">Z důvodu zpětné kompatibility, pokud poptávka pro cílovou sadu udělení a <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> selžou, konstruktor vyžaduje <xref:System.Security.Permissions.SecurityPermission> s příznakem <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-164">For backward compatibility, if the demand for the target grant set plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> fails, the constructor demands <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> flag.</span></span>  
  
 <span data-ttu-id="3ccd8-165">I když jsou položky v tomto seznamu popsány v tématu udělení sady pro udělení sestavení, mějte na paměti, že požadavky jsou provedeny proti úplnému zásobníku volání, včetně hranice domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-165">Although the items in this list are described in terms of the grant set of the emitting assembly, remember that the demands are made against the full call stack, including the application domain boundary.</span></span>  
  
 <span data-ttu-id="3ccd8-166">Další informace naleznete v tématu Třída <xref:System.Reflection.Emit.DynamicMethod>.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-166">For more information, see the <xref:System.Reflection.Emit.DynamicMethod> class.</span></span>  
  
### <a name="generating-dynamic-methods-from-partially-trusted-code"></a><span data-ttu-id="3ccd8-167">Generování dynamických metod z částečně důvěryhodného kódu</span><span class="sxs-lookup"><span data-stu-id="3ccd8-167">Generating Dynamic Methods from Partially Trusted Code</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3ccd8-168">Doporučený způsob, jak generovat dynamické metody z částečně důvěryhodného kódu, je použití [anonymně hostovaných dynamických metod](#Anonymously_Hosted_Dynamic_Methods).</span><span class="sxs-lookup"><span data-stu-id="3ccd8-168">The recommended way to generate dynamic methods from partially trusted code is to use [anonymously hosted dynamic methods](#Anonymously_Hosted_Dynamic_Methods).</span></span>  
  
 <span data-ttu-id="3ccd8-169">Vezměte v úvahu podmínky, ve kterých sestavení s oprávněními k Internetu může generovat dynamickou metodu a provést ji:</span><span class="sxs-lookup"><span data-stu-id="3ccd8-169">Consider the conditions in which an assembly with Internet permissions can generate a dynamic method and execute it:</span></span>  
  
- <span data-ttu-id="3ccd8-170">Buď je dynamická metoda asociována s modulem nebo typem, který ji emituje, nebo její sada udělení zahrnuje <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> a je spojena s modulem v sestavení, jehož sada udělení je rovna nebo podmnožině, pro udělení sestavení pro generování.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-170">Either the dynamic method is associated with the module or type that emits it, or its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> and it is associated with a module in an assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly.</span></span>  
  
- <span data-ttu-id="3ccd8-171">Dynamická metoda používá pouze veřejné typy a členy.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-171">The dynamic method uses only public types and members.</span></span> <span data-ttu-id="3ccd8-172">Pokud jeho sada udělení zahrnuje <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> a je spojena s modulem v sestavení, jehož sada udělení je rovna nebo podmnožině, sada udělení sestavení pro generování, může použít typy a členy označené `internal` (`Friend` v Visual Basic , `assembly` v metadatech Common Language Runtime) v přidruženém modulu.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-172">If its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> and it is associated with a module in an assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly, it can use types and members marked `internal` (`Friend` in Visual Basic, `assembly` in common language runtime metadata) in the associated module.</span></span>  
  
- <span data-ttu-id="3ccd8-173">Oprávnění požadovaná všemi typy a členy, které používá dynamická metoda, jsou součástí sady udělení částečně důvěryhodného sestavení.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-173">The permissions demanded by all the types and members used by the dynamic method are included in the grant set of the partially trusted assembly.</span></span>  
  
- <span data-ttu-id="3ccd8-174">Dynamická metoda neskočí kontroly viditelnosti JIT.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-174">The dynamic method does not skip JIT visibility checks.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3ccd8-175">Dynamické metody nepodporují symboly ladění.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-175">Dynamic methods do not support debug symbols.</span></span>  
  
<a name="Version_Information"></a>   
## <a name="version-information"></a><span data-ttu-id="3ccd8-176">Informace o verzi</span><span class="sxs-lookup"><span data-stu-id="3ccd8-176">Version Information</span></span>  
 <span data-ttu-id="3ccd8-177">Počínaje .NET Framework 4 jsou zásady zabezpečení na úrovni počítače eliminovány a transparentnost zabezpečení se bude nacházet jako s výchozím mechanismem vynucování.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-177">Starting with the .NET Framework 4, machine-wide security policy is eliminated and security transparency becomes the default enforcement mechanism.</span></span> <span data-ttu-id="3ccd8-178">Viz téma [změny zabezpečení](../security/security-changes.md).</span><span class="sxs-lookup"><span data-stu-id="3ccd8-178">See [Security Changes](../security/security-changes.md).</span></span>  
  
 <span data-ttu-id="3ccd8-179">Počínaje verzí .NET Framework 2,0 Service Pack 1 <xref:System.Security.Permissions.ReflectionPermission> s příznakem <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> již není při generování dynamických sestavení a dynamických metod vyžadován.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-179">Starting with the .NET Framework 2.0 Service Pack 1, <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> flag is no longer required when emitting dynamic assemblies and dynamic methods.</span></span> <span data-ttu-id="3ccd8-180">Tento příznak je vyžadován ve všech starších verzích .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-180">This flag is required in all earlier versions of the .NET Framework.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3ccd8-181"><xref:System.Security.Permissions.ReflectionPermission> s příznakem <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> je ve výchozím nastavení zahrnutá v `FullTrust` a `LocalIntranet` pojmenované sady oprávnění, ale ne v sadě oprávnění `Internet`.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-181"><xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> flag is included by default in the `FullTrust` and `LocalIntranet` named permission sets, but not in the `Internet` permission set.</span></span> <span data-ttu-id="3ccd8-182">Proto v dřívějších verzích .NET Framework knihovna může být použita s oprávněními k Internetu pouze v případě, že spustí <xref:System.Security.PermissionSet.Assert%2A> pro <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-182">Therefore, in earlier versions of the .NET Framework, a library can be used with Internet permissions only if it executes an <xref:System.Security.PermissionSet.Assert%2A> for <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>.</span></span> <span data-ttu-id="3ccd8-183">Tyto knihovny vyžadují pečlivou kontrolu zabezpečení, protože chyby kódování můžou vést k bezpečnostním otvorům.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-183">Such libraries require careful security review because coding errors could result in security holes.</span></span> <span data-ttu-id="3ccd8-184">.NET Framework 2,0 SP1 umožňuje, aby byl kód generován ve scénářích s částečnou důvěryhodností bez nutnosti vydávat požadavky na zabezpečení, protože generování kódu není podstatou privilegované operace.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-184">The .NET Framework 2.0 SP1 allows code to be emitted in partial trust scenarios without issuing any security demands, because generating code is not inherently a privileged operation.</span></span> <span data-ttu-id="3ccd8-185">To znamená, že generovaný kód nemá žádná další oprávnění, než sestavení, které ho emituje.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-185">That is, the generated code has no more permissions than the assembly that emits it.</span></span> <span data-ttu-id="3ccd8-186">To umožňuje, aby knihovny, které generují kód, byly transparentní pro zabezpečení a odebraly nutnost vyhodnotit <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>, což zjednodušuje úlohu psaní zabezpečené knihovny.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-186">This allows libraries that emit code to be security transparent and removes the need to assert <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>, which simplifies the task of writing a secure library.</span></span>  
  
 <span data-ttu-id="3ccd8-187">Kromě toho .NET Framework 2,0 SP1 zavádí příznak <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> pro přístup k NonPublic typům a členům z částečně důvěryhodných dynamických metod.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-187">In addition, the .NET Framework 2.0 SP1 introduces the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag for accessing nonpublic types and members from partially trusted dynamic methods.</span></span> <span data-ttu-id="3ccd8-188">Starší verze .NET Framework vyžadují příznak <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> pro dynamické metody, které přistupují k typům a členům NonPublic; Toto je oprávnění, které by nikdy nemělo být uděleno částečně důvěryhodnému kódu.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-188">Earlier versions of the .NET Framework require the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag for dynamic methods that access nonpublic types and members; this is a permission that should never be granted to partially trusted code.</span></span>  
  
 <span data-ttu-id="3ccd8-189">Nakonec .NET Framework 2,0 SP1 zavádí anonymně hostované metody.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-189">Finally, the .NET Framework 2.0 SP1 introduces anonymously hosted methods.</span></span>  
  
### <a name="obtaining-information-on-types-and-members"></a><span data-ttu-id="3ccd8-190">Získání informací o typech a členech</span><span class="sxs-lookup"><span data-stu-id="3ccd8-190">Obtaining Information on Types and Members</span></span>  
 <span data-ttu-id="3ccd8-191">Počínaje .NET Framework 2,0 nejsou k získání informací o typech a členech NonPublic potřeba žádná oprávnění.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-191">Starting with the .NET Framework 2.0, no permissions are required to obtain information about nonpublic types and members.</span></span> <span data-ttu-id="3ccd8-192">Reflexe se používá k získání informací potřebných k vygenerování dynamických metod.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-192">Reflection is used to obtain information needed to emit dynamic methods.</span></span> <span data-ttu-id="3ccd8-193">Například <xref:System.Reflection.MethodInfo> objektů slouží k vygenerování volání metody.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-193">For example, <xref:System.Reflection.MethodInfo> objects are used to emit method calls.</span></span> <span data-ttu-id="3ccd8-194">Starší verze .NET Framework vyžadují <xref:System.Security.Permissions.ReflectionPermission> s příznakem <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3ccd8-194">Earlier versions of the .NET Framework require <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType> flag.</span></span> <span data-ttu-id="3ccd8-195">Další informace najdete v tématu [požadavky na zabezpečení pro reflexi](security-considerations-for-reflection.md).</span><span class="sxs-lookup"><span data-stu-id="3ccd8-195">For more information, see [Security Considerations for Reflection](security-considerations-for-reflection.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3ccd8-196">Viz také:</span><span class="sxs-lookup"><span data-stu-id="3ccd8-196">See also</span></span>

- [<span data-ttu-id="3ccd8-197">Důležité informace o zabezpečení pro reflexi</span><span class="sxs-lookup"><span data-stu-id="3ccd8-197">Security Considerations for Reflection</span></span>](security-considerations-for-reflection.md)
- [<span data-ttu-id="3ccd8-198">Generování dynamických metod a sestavení</span><span class="sxs-lookup"><span data-stu-id="3ccd8-198">Emitting Dynamic Methods and Assemblies</span></span>](emitting-dynamic-methods-and-assemblies.md)
