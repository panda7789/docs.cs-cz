---
title: Aximp.exe (importér ovládacích prvků ActiveX Windows Forms)
description: Pochopení Aximp.exe, model Windows Forms Importér ovládacího prvku ActiveX. Tento nástroj převede definice typu v knihovně typů modelu COM pro ovládací prvek ActiveX na model Windows Forms.
ms.date: 03/30/2017
helpviewer_keywords:
- ActiveX controls, hosting in Windows Forms
- ActiveX Control Importer
- type definitions, converting
- Aximp.exe
- Windows Forms ActiveX Control Importer
ms.assetid: 482c0d83-7144-4497-b626-87d2351b78d0
ms.openlocfilehash: d4fd6762195078963b43392178996a61f90feb94
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/24/2020
ms.locfileid: "87167343"
---
# <a name="aximpexe-windows-forms-activex-control-importer"></a><span data-ttu-id="4fada-104">Aximp.exe (importér ovládacích prvků ActiveX Windows Forms)</span><span class="sxs-lookup"><span data-stu-id="4fada-104">Aximp.exe (Windows Forms ActiveX Control Importer)</span></span>
<span data-ttu-id="4fada-105">Importér ovládacích prvků ActiveX převede definice typů v knihovně typů modelu COM pro ovládací prvek ActiveX na ovládací prvek Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="4fada-105">The ActiveX Control Importer converts type definitions in a COM type library for an ActiveX control into a Windows Forms control.</span></span>  
  
 <span data-ttu-id="4fada-106">Model Windows Forms mohou hostovat pouze model Windows Forms ovládací prvky – to znamená třídy, které jsou odvozeny z <xref:System.Windows.Forms.Control> .</span><span class="sxs-lookup"><span data-stu-id="4fada-106">Windows Forms can only host Windows Forms controls — that is, classes that are derived from <xref:System.Windows.Forms.Control>.</span></span> <span data-ttu-id="4fada-107">Aximp.exe generuje obálkovou třídu pro ovládací prvek ActiveX, který může být hostován na Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="4fada-107">Aximp.exe generates a wrapper class for an ActiveX control that can be hosted on a Windows Form.</span></span> <span data-ttu-id="4fada-108">To umožňuje použít stejnou podporu návrhu a programovací metody jako pro ostatní ovládací prvky Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="4fada-108">This allows you to use the same design-time support and programming methodology applicable to other Windows Forms controls.</span></span>  
  
 <span data-ttu-id="4fada-109">Chcete-li hostovat ovládací prvek ActiveX, je nutné vygenerovat ovládací prvek obálky, který je odvozen z <xref:System.Windows.Forms.AxHost> .</span><span class="sxs-lookup"><span data-stu-id="4fada-109">To host the ActiveX control, you must generate a wrapper control that derives from <xref:System.Windows.Forms.AxHost>.</span></span> <span data-ttu-id="4fada-110">Tento ovládací prvek obálky obsahuje instanci původního ovládacího prvku ActiveX.</span><span class="sxs-lookup"><span data-stu-id="4fada-110">This wrapper control contains an instance of the underlying ActiveX control.</span></span> <span data-ttu-id="4fada-111">Dokáže komunikovat s ovládacím prvkem ActiveX, ale je zobrazen jako ovládací prvek Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="4fada-111">It knows how to communicate with the ActiveX control, but it appears as a Windows Forms control.</span></span> <span data-ttu-id="4fada-112">Tento vygenerovaný ovládací prvek hostuje ovládací prvek ActiveX a zpřístupňuje jeho vlastnosti, metody a události, jako by náležely vygenerovanému ovládacímu prvku.</span><span class="sxs-lookup"><span data-stu-id="4fada-112">This generated control hosts the ActiveX control and exposes its properties, methods, and events as those of the generated control.</span></span>  
  
 <span data-ttu-id="4fada-113">Tento nástroj je automaticky nainstalován se sadou Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="4fada-113">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="4fada-114">Chcete-li spustit nástroj, použijte Developer Command Prompt pro Visual Studio (nebo příkazový řádek sady Visual Studio v systému Windows 7).</span><span class="sxs-lookup"><span data-stu-id="4fada-114">To run the tool, use the Developer Command Prompt for Visual Studio (or the Visual Studio Command Prompt in Windows 7).</span></span> <span data-ttu-id="4fada-115">Další informace najdete v tématu [výzvy k zadání příkazu](developer-command-prompt-for-vs.md).</span><span class="sxs-lookup"><span data-stu-id="4fada-115">For more information, see [Command Prompts](developer-command-prompt-for-vs.md).</span></span>  
  
 <span data-ttu-id="4fada-116">V příkazovém řádku zadejte následující:</span><span class="sxs-lookup"><span data-stu-id="4fada-116">At the command prompt, type the following:</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="4fada-117">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="4fada-117">Syntax</span></span>  
  
```console  
aximp [options]{file.dll | file.ocx}  
```  
  
## <a name="remarks"></a><span data-ttu-id="4fada-118">Poznámky</span><span class="sxs-lookup"><span data-stu-id="4fada-118">Remarks</span></span>  
  
|<span data-ttu-id="4fada-119">Argument</span><span class="sxs-lookup"><span data-stu-id="4fada-119">Argument</span></span>|<span data-ttu-id="4fada-120">Popis</span><span class="sxs-lookup"><span data-stu-id="4fada-120">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="4fada-121">*souborů*</span><span class="sxs-lookup"><span data-stu-id="4fada-121">*file*</span></span>|<span data-ttu-id="4fada-122">Název zdrojového souboru obsahujícího ovládací prvek ActiveX, který má být převeden.</span><span class="sxs-lookup"><span data-stu-id="4fada-122">The name of the source file that contains the ActiveX control to convert.</span></span> <span data-ttu-id="4fada-123">Argument souboru musí mít příponu .dll nebo .ocx.</span><span class="sxs-lookup"><span data-stu-id="4fada-123">The file argument must have the extension .dll or .ocx.</span></span>|  
  
|<span data-ttu-id="4fada-124">Možnost</span><span class="sxs-lookup"><span data-stu-id="4fada-124">Option</span></span>|<span data-ttu-id="4fada-125">Popis</span><span class="sxs-lookup"><span data-stu-id="4fada-125">Description</span></span>|  
|------------|-----------------|  
|`/delaysign`|<span data-ttu-id="4fada-126">Určuje, že Aximp.exe podepíše výsledný ovládací prvek pomocí zpožděného podepisování.</span><span class="sxs-lookup"><span data-stu-id="4fada-126">Specifies to Aximp.exe to sign the resulting control using delayed signing.</span></span> <span data-ttu-id="4fada-127">Tuto možnost je nutné zadat buď pomocí `/keycontainer:` Možnosti, `/keyfile:` nebo `/publickey:` .</span><span class="sxs-lookup"><span data-stu-id="4fada-127">You must specify this option with either the `/keycontainer:`, `/keyfile:`, or `/publickey:` option.</span></span> <span data-ttu-id="4fada-128">Další informace o procesu opožděného podepisování naleznete v tématu [Zpožděné podepisování sestavení](../../standard/assembly/delay-sign.md).</span><span class="sxs-lookup"><span data-stu-id="4fada-128">For more information on the delayed signing process, see [Delay Signing an Assembly](../../standard/assembly/delay-sign.md).</span></span>|  
|`/help`|<span data-ttu-id="4fada-129">Zobrazí syntaxi příkazu a možnosti nástroje.</span><span class="sxs-lookup"><span data-stu-id="4fada-129">Displays command syntax and options for the tool.</span></span>|  
|<span data-ttu-id="4fada-130">`/keycontainer:`*ContainerName*</span><span class="sxs-lookup"><span data-stu-id="4fada-130">`/keycontainer:` *containerName*</span></span>|<span data-ttu-id="4fada-131">Podepíše výsledný ovládací prvek se silným názvem pomocí dvojice veřejného a privátního klíče nalezené v kontejneru klíčů určeném parametrem *ContainerName*.</span><span class="sxs-lookup"><span data-stu-id="4fada-131">Signs the resulting control with a strong name using the public/private key pair found in the key container specified by *containerName*.</span></span>|  
|<span data-ttu-id="4fada-132">`/keyfile:`*název souboru*</span><span class="sxs-lookup"><span data-stu-id="4fada-132">`/keyfile:` *filename*</span></span>|<span data-ttu-id="4fada-133">Podepíše výsledný ovládací prvek se silným názvem pomocí páru oficiálního veřejného/soukromého klíče vydavatele, který se nachází v *souboru filename*.</span><span class="sxs-lookup"><span data-stu-id="4fada-133">Signs the resulting control with a strong name using the publisher's official public/private key pair found in *filename*.</span></span>|  
|`/nologo`|<span data-ttu-id="4fada-134">Potlačí zobrazení úvodního nápisu společnosti Microsoft.</span><span class="sxs-lookup"><span data-stu-id="4fada-134">Suppresses the Microsoft startup banner display.</span></span>|  
|<span data-ttu-id="4fada-135">`/out:`*název souboru*</span><span class="sxs-lookup"><span data-stu-id="4fada-135">`/out:` *filename*</span></span>|<span data-ttu-id="4fada-136">Určuje název sestavení, které se má vytvořit.</span><span class="sxs-lookup"><span data-stu-id="4fada-136">Specifies the name of the assembly to create.</span></span>|  
|<span data-ttu-id="4fada-137">`/publickey:`*název souboru*</span><span class="sxs-lookup"><span data-stu-id="4fada-137">`/publickey:` *filename*</span></span>|<span data-ttu-id="4fada-138">Podepíše výsledný ovládací prvek se silným názvem pomocí veřejného klíče, který se nachází v souboru určeném parametrem *filename*.</span><span class="sxs-lookup"><span data-stu-id="4fada-138">Signs the resulting control with a strong name using the public key found in the file specified by *filename*.</span></span>|  
|<span data-ttu-id="4fada-139">`/rcw:`*název souboru*</span><span class="sxs-lookup"><span data-stu-id="4fada-139">`/rcw:` *filename*</span></span>|<span data-ttu-id="4fada-140">Používá určenou obálku volatelnou modulem runtime namísto generování nové.</span><span class="sxs-lookup"><span data-stu-id="4fada-140">Uses the specified runtime callable wrapper instead of generating a new one.</span></span> <span data-ttu-id="4fada-141">Můžete zadat více instancí.</span><span class="sxs-lookup"><span data-stu-id="4fada-141">You may specify multiple instances.</span></span> <span data-ttu-id="4fada-142">Aktuální adresář se používá pro relativní cesty.</span><span class="sxs-lookup"><span data-stu-id="4fada-142">The current directory is used for relative paths.</span></span> <span data-ttu-id="4fada-143">Další informace najdete v tématu [obálka s vydanou modulem runtime](../../standard/native-interop/runtime-callable-wrapper.md).</span><span class="sxs-lookup"><span data-stu-id="4fada-143">For more information, see [Runtime Callable Wrapper](../../standard/native-interop/runtime-callable-wrapper.md).</span></span>|  
|`/silent`|<span data-ttu-id="4fada-144">Potlačí zobrazování zpráv o úspěšném dokončení.</span><span class="sxs-lookup"><span data-stu-id="4fada-144">Suppresses the display of success messages.</span></span>|  
|`/source`|<span data-ttu-id="4fada-145">Generuje zdrojový kód jazyka C# pro obálku Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="4fada-145">Generates C# source code for the Windows Forms wrapper.</span></span>|  
|`/verbose`|<span data-ttu-id="4fada-146">Určuje režim podrobného vypisování; zobrazuje dodatečné informace o průběhu.</span><span class="sxs-lookup"><span data-stu-id="4fada-146">Specifies verbose mode; displays additional progress information.</span></span>|  
|`/?`|<span data-ttu-id="4fada-147">Zobrazí syntaxi příkazu a možnosti nástroje.</span><span class="sxs-lookup"><span data-stu-id="4fada-147">Displays command syntax and options for the tool.</span></span>|  
  
 <span data-ttu-id="4fada-148">Aximp.exe najednou převede celé knihovny typů ovládacího prvku ActiveX a vytvoří sadu sestavení, která obsahují metadata Common Language Runtime (CML) a implementaci ovládacích prvků pro typy definované v původní knihovně typů.</span><span class="sxs-lookup"><span data-stu-id="4fada-148">Aximp.exe converts an entire ActiveX Control type library at one time and produces a set of assemblies that contain the common language runtime metadata and control implementation for the types defined in the original type library.</span></span> <span data-ttu-id="4fada-149">Generované soubory jsou pojmenovány podle následujícího vzoru:</span><span class="sxs-lookup"><span data-stu-id="4fada-149">The generated files are named according to the following pattern:</span></span>  
  
 <span data-ttu-id="4fada-150">proxy pro modul CLR (Common Language Runtime) pro typy COM: *ProgID*. dll</span><span class="sxs-lookup"><span data-stu-id="4fada-150">common language runtime proxy for COM types: *progid*.dll</span></span>  
  
 <span data-ttu-id="4fada-151">Model Windows Forms proxy pro ovládací prvky ActiveX (kde AX označuje ActiveX): AX*ProgID*. dll</span><span class="sxs-lookup"><span data-stu-id="4fada-151">Windows Forms proxy for ActiveX controls (where Ax signifies ActiveX): Ax*progid*.dll</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4fada-152">Pokud název členu ovládacího prvku ActiveX odpovídá názvu definovanému v rozhraní .NET Framework, Aximp.exe při vytváření odvozené třídy AxHost před název člena přidá „Ctl“.</span><span class="sxs-lookup"><span data-stu-id="4fada-152">If the name of a member of the ActiveX control matches a name defined in the .NET Framework, Aximp.exe will prefix the member name with "Ctl" when it creates the AxHost derived class.</span></span> <span data-ttu-id="4fada-153">Například, pokud ovládací prvek ActiveX má člen nazvaný „Layout“, přejmenuje se v odvozené třídě AxHost na „CtlLayout“, protože událost Layout je definována v rámci .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="4fada-153">For example, if your ActiveX control has a member named "Layout," it is renamed "CtlLayout" in the AxHost derived class because the Layout event is defined within the .NET Framework.</span></span>  
  
 <span data-ttu-id="4fada-154">Tyto generované soubory můžete prozkoumávat pomocí nástrojů, jako je [Ildasm.exe (IL Disassembler)](ildasm-exe-il-disassembler.md).</span><span class="sxs-lookup"><span data-stu-id="4fada-154">You can examine these generated files with tools such as [Ildasm.exe (IL Disassembler)](ildasm-exe-il-disassembler.md).</span></span>  
  
 <span data-ttu-id="4fada-155">Použití Aximp.exe za účelem generování sestavení .NET pro ovládací prvek ActiveX pro webový prohlížeč (shdocvw.dll) není podporováno.</span><span class="sxs-lookup"><span data-stu-id="4fada-155">Using Aximp.exe to generate a .NET assembly for the ActiveX WebBrowser control (shdocvw.dll) is not supported.</span></span>  
  
 <span data-ttu-id="4fada-156">Při spuštění Aximp.exe přes shdocvw.dll se vždy vytvoří další soubor s názvem shdocvw.dll v adresáři, ze kterého je nástroj spuštěn.</span><span class="sxs-lookup"><span data-stu-id="4fada-156">When you run Aximp.exe over shdocvw.dll, it will always create another file named shdocvw.dll in the directory from which the tool is run.</span></span> <span data-ttu-id="4fada-157">Pokud je tento vygenerovaný soubor umístěn v adresáři Documents and Settings, způsobuje problémy v aplikacích Microsoft Internet Explorer a Průzkumník Windows.</span><span class="sxs-lookup"><span data-stu-id="4fada-157">If this generated file is placed in the Documents and Settings directory, it causes problems for Microsoft Internet Explorer and Windows Explorer.</span></span> <span data-ttu-id="4fada-158">Po restartování počítače systém Windows hledá v adresáři Documents and Settings před adresářem system32, aby našel kopii souboru shdocvw.dll.</span><span class="sxs-lookup"><span data-stu-id="4fada-158">When the computer is rebooted, Windows looks in the Documents and Settings directory before the system32 directory to find a copy of shdocvw.dll.</span></span> <span data-ttu-id="4fada-159">Použije kopii, kterou najde v adresáři Documents and Settings a pokusí se načíst spravované obálky.</span><span class="sxs-lookup"><span data-stu-id="4fada-159">It will use the copy it finds in Documents and Settings and attempt to load the managed wrappers.</span></span> <span data-ttu-id="4fada-160">Aplikace Internet Explorer a Průzkumník Windows nebudou správně fungovat, protože spoléhají na vykreslovací modul ve verzi shdocvw.dll v adresáři system32.</span><span class="sxs-lookup"><span data-stu-id="4fada-160">Internet Explorer and Windows Explorer will not function properly because they rely on the rendering engine in the version of shdocvw.dll located in the system32 directory.</span></span> <span data-ttu-id="4fada-161">Pokud nastane tento problém, odstraňte kopii souboru shdocvw.dll v adresáři Documents and Settings a restartujte počítač.</span><span class="sxs-lookup"><span data-stu-id="4fada-161">If this problem occurs, delete the copy of shdocvw.dll in the Documents and Settings directory and reboot the computer.</span></span>  
  
 <span data-ttu-id="4fada-162">Použití Aximp.exe se souborem shdocvw.dll k vytvoření sestavení .NET pro použití při vývoji aplikace může také způsobit problémy.</span><span class="sxs-lookup"><span data-stu-id="4fada-162">Using Aximp.exe with shdocvw.dll to create a .NET assembly for use in application development can also cause problems.</span></span> <span data-ttu-id="4fada-163">V tomto případě aplikace načte systémovou verzi souboru shdocvw.dll i vygenerovanou verzi a může dát přednost verzi systému.</span><span class="sxs-lookup"><span data-stu-id="4fada-163">In this case, your application will load both the system version of shdocvw.dll and the generated version, and may give the system version priority.</span></span> <span data-ttu-id="4fada-164">V takovém případě se při pokusu o načtení webové stránky uvnitř ovládacího prvku ActiveX webového prohlížeče uživatelům může zobrazit dialogové okno Otevřít/Uložit.</span><span class="sxs-lookup"><span data-stu-id="4fada-164">In this case, when you attempt to load a Web page inside the WebBrowser ActiveX control, users may be prompted with an Open/Save dialog box.</span></span> <span data-ttu-id="4fada-165">Když uživatel klikne na tlačítko **otevřít**, Webová stránka se otevře v aplikaci Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="4fada-165">When the user clicks **Open**, the Web page will be opened in Internet Explorer.</span></span> <span data-ttu-id="4fada-166">K této situaci dochází pouze u počítačů používajících aplikaci Internet Explorer verze 6 nebo starší.</span><span class="sxs-lookup"><span data-stu-id="4fada-166">This occurs only with computers that are running Internet Explorer version 6 or earlier.</span></span> <span data-ttu-id="4fada-167">Chcete-li předejít tomuto problému, použijte spravovaný <xref:System.Windows.Forms.WebBrowser> ovládací prvek nebo použijte Visual Studio k vygenerování spravovaného shdocvw.dll, jak je popsáno v tématu [Postupy: Přidání odkazů do knihoven typů](../interop/how-to-add-references-to-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="4fada-167">To prevent this problem, use the managed <xref:System.Windows.Forms.WebBrowser> control or use Visual Studio to generate the managed shdocvw.dll as described in [How to: Add References to Type Libraries](../interop/how-to-add-references-to-type-libraries.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="4fada-168">Příklad</span><span class="sxs-lookup"><span data-stu-id="4fada-168">Example</span></span>  
 <span data-ttu-id="4fada-169">Následující příkaz vygeneruje MediaPlayer.dll a AxMediaPlayer.dll pro ovládací prvek Media Player `msdxm.ocx` .</span><span class="sxs-lookup"><span data-stu-id="4fada-169">The following command generates MediaPlayer.dll and AxMediaPlayer.dll for the Media Player control `msdxm.ocx`.</span></span>  
  
```console
aximp c:\systemroot\system32\msdxm.ocx  
```  
  
## <a name="see-also"></a><span data-ttu-id="4fada-170">Viz také</span><span class="sxs-lookup"><span data-stu-id="4fada-170">See also</span></span>

- [<span data-ttu-id="4fada-171">Nástroje</span><span class="sxs-lookup"><span data-stu-id="4fada-171">Tools</span></span>](index.md)
- [<span data-ttu-id="4fada-172">Ildasm.exe (IL Disassembler)</span><span class="sxs-lookup"><span data-stu-id="4fada-172">Ildasm.exe (IL Disassembler)</span></span>](ildasm-exe-il-disassembler.md)
