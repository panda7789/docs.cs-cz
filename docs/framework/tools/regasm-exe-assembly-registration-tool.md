---
title: Regasm.exe (nástroj registrace sestavení)
ms.date: 03/30/2017
helpviewer_keywords:
- Assembly Registration tool
- assemblies [.NET Framework], registering
- Regasm.exe
- registering assemblies
ms.assetid: e190e342-36ef-4651-a0b4-0e8c2c0281cb
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 30b13c75907ad0bc4d6dbce6a3ecd07f1fbede11
ms.sourcegitcommit: 2350a091ef6459f0fcfd894301242400374d8558
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 09/21/2018
ms.locfileid: "46539106"
---
# <a name="regasmexe-assembly-registration-tool"></a><span data-ttu-id="fa29a-102">Regasm.exe (nástroj registrace sestavení)</span><span class="sxs-lookup"><span data-stu-id="fa29a-102">Regasm.exe (Assembly Registration Tool)</span></span>

<span data-ttu-id="fa29a-103">Nástroj Assembly Registration načte metadata v rámci sestavení a přidá nezbytné položky registru, které umožní klientům modelu COM transparentní vytvoření tříd rozhraní .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="fa29a-103">The Assembly Registration tool reads the metadata within an assembly and adds the necessary entries to the registry, which allows COM clients to create .NET Framework classes transparently.</span></span> <span data-ttu-id="fa29a-104">Jakmile je třída zaregistrována, může ji libovolný klient COM použít jako třídu COM.</span><span class="sxs-lookup"><span data-stu-id="fa29a-104">Once a class is registered, any COM client can use it as though the class were a COM class.</span></span> <span data-ttu-id="fa29a-105">Třída je registrována pouze jednou, při instalaci sestavení.</span><span class="sxs-lookup"><span data-stu-id="fa29a-105">The class is registered only once, when the assembly is installed.</span></span> <span data-ttu-id="fa29a-106">Instance tříd z modelu COM v rámci sestavení nelze vytvořit, dokud nedojde k jejich registraci.</span><span class="sxs-lookup"><span data-stu-id="fa29a-106">Instances of classes within the assembly cannot be created from COM until they are actually registered.</span></span>

<span data-ttu-id="fa29a-107">Ke spuštění nástroje, použijte příkazový řádek pro vývojáře pro sadu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="fa29a-107">To run the tool, use the Developer Command Prompt for Visual Studio.</span></span> <span data-ttu-id="fa29a-108">Další informace najdete v tématu [příkazové řádky](../../../docs/framework/tools/developer-command-prompt-for-vs.md).</span><span class="sxs-lookup"><span data-stu-id="fa29a-108">For more information, see [Command Prompts](../../../docs/framework/tools/developer-command-prompt-for-vs.md).</span></span>

<span data-ttu-id="fa29a-109">V příkazovém řádku zadejte následující:</span><span class="sxs-lookup"><span data-stu-id="fa29a-109">At the command prompt, type the following:</span></span>

## <a name="syntax"></a><span data-ttu-id="fa29a-110">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="fa29a-110">Syntax</span></span>

```
regasm assemblyFile [options]
```

#### <a name="parameters"></a><span data-ttu-id="fa29a-111">Parametry</span><span class="sxs-lookup"><span data-stu-id="fa29a-111">Parameters</span></span>

|<span data-ttu-id="fa29a-112">Parametr</span><span class="sxs-lookup"><span data-stu-id="fa29a-112">Parameter</span></span>|<span data-ttu-id="fa29a-113">Popis</span><span class="sxs-lookup"><span data-stu-id="fa29a-113">Description</span></span>|
|---------------|-----------------|
|<span data-ttu-id="fa29a-114">*AssemblyFile*</span><span class="sxs-lookup"><span data-stu-id="fa29a-114">*assemblyFile*</span></span>|<span data-ttu-id="fa29a-115">Sestavení, která mají být registrována pomocí modelu COM.</span><span class="sxs-lookup"><span data-stu-id="fa29a-115">The assembly to be registered with COM.</span></span>|

|<span data-ttu-id="fa29a-116">Možnost</span><span class="sxs-lookup"><span data-stu-id="fa29a-116">Option</span></span>|<span data-ttu-id="fa29a-117">Popis</span><span class="sxs-lookup"><span data-stu-id="fa29a-117">Description</span></span>|
|------------|-----------------|
|<span data-ttu-id="fa29a-118">**/ codebase**</span><span class="sxs-lookup"><span data-stu-id="fa29a-118">**/codebase**</span></span>|<span data-ttu-id="fa29a-119">Vytvoří položku základu kódu v registru.</span><span class="sxs-lookup"><span data-stu-id="fa29a-119">Creates a Codebase entry in the registry.</span></span> <span data-ttu-id="fa29a-120">Položka základu kódu určuje cestu k souboru sestavení, které není nainstalováno v globální mezipaměti sestavení (GAC).</span><span class="sxs-lookup"><span data-stu-id="fa29a-120">The Codebase entry specifies the file path for an assembly that is not installed in the global assembly cache.</span></span> <span data-ttu-id="fa29a-121">Tuto možnost byste neměli zadávat, pokud následně instalujete sestavení, které budete registrovat do globální mezipaměti sestavení (GAC).</span><span class="sxs-lookup"><span data-stu-id="fa29a-121">You should not specify this option if you will subsequently install the assembly that you are registering into the global assembly cache.</span></span> <span data-ttu-id="fa29a-122">*AssemblyFile* argument, který zadáte **/ codebase** možnost musí být [sestavení se silným názvem](../../../docs/framework/app-domains/strong-named-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="fa29a-122">The *assemblyFile* argument that you specify with the **/codebase** option must be a [strong-named assembly](../../../docs/framework/app-domains/strong-named-assemblies.md).</span></span>|
|<span data-ttu-id="fa29a-123">**/ registrované**</span><span class="sxs-lookup"><span data-stu-id="fa29a-123">**/registered**</span></span>|<span data-ttu-id="fa29a-124">Určuje, že tento nástroj bude odkazovat pouze na knihovny typů, které již byly zaregistrovány.</span><span class="sxs-lookup"><span data-stu-id="fa29a-124">Specifies that this tool will only refer to type libraries that have already been registered.</span></span>|
|<span data-ttu-id="fa29a-125">**/asmpath:Directory**</span><span class="sxs-lookup"><span data-stu-id="fa29a-125">**/asmpath:directory**</span></span>|<span data-ttu-id="fa29a-126">Určuje adresář obsahující odkazy na sestavení.</span><span class="sxs-lookup"><span data-stu-id="fa29a-126">Specifies a directory containing assembly references.</span></span> <span data-ttu-id="fa29a-127">Je nutné použít s **/RegFile** možnost.</span><span class="sxs-lookup"><span data-stu-id="fa29a-127">Must be used with the **/regfile** option.</span></span>|
|<span data-ttu-id="fa29a-128">**/nologo**</span><span class="sxs-lookup"><span data-stu-id="fa29a-128">**/nologo**</span></span>|<span data-ttu-id="fa29a-129">Potlačí zobrazení úvodního nápisu společnosti Microsoft.</span><span class="sxs-lookup"><span data-stu-id="fa29a-129">Suppresses the Microsoft startup banner display.</span></span>|
|<span data-ttu-id="fa29a-130">**/ RegFile** [**:** *regFile*]</span><span class="sxs-lookup"><span data-stu-id="fa29a-130">**/regfile** [**:** *regFile*]</span></span>|<span data-ttu-id="fa29a-131">Generuje soubor .reg určený pro sestavení, která obsahují potřebné položky registru.</span><span class="sxs-lookup"><span data-stu-id="fa29a-131">Generates the specified .reg file for the assembly, which contains the needed registry entries.</span></span> <span data-ttu-id="fa29a-132">Použití této možnosti nezmění registr.</span><span class="sxs-lookup"><span data-stu-id="fa29a-132">Specifying this option does not change the registry.</span></span> <span data-ttu-id="fa29a-133">Tuto možnost s nelze použít **/u** nebo **/TLB** možnosti.</span><span class="sxs-lookup"><span data-stu-id="fa29a-133">You cannot use this option with the **/u** or **/tlb** options.</span></span>|
|<span data-ttu-id="fa29a-134">**/ silent** nebo **/s**</span><span class="sxs-lookup"><span data-stu-id="fa29a-134">**/silent** or **/s**</span></span>|<span data-ttu-id="fa29a-135">Potlačí zobrazování zpráv o úspěšném dokončení.</span><span class="sxs-lookup"><span data-stu-id="fa29a-135">Suppresses the display of success messages.</span></span>|
|<span data-ttu-id="fa29a-136">**/ TLB** [**:** *typeLibFile*]</span><span class="sxs-lookup"><span data-stu-id="fa29a-136">**/tlb** [**:** *typeLibFile*]</span></span>|<span data-ttu-id="fa29a-137">Ze zadaného sestavení vytvoří knihovnu typů obsahující definice dostupných typů definovaných v rámci sestavení.</span><span class="sxs-lookup"><span data-stu-id="fa29a-137">Generates a type library from the specified assembly containing definitions of the accessible types defined within the assembly.</span></span>|
|<span data-ttu-id="fa29a-138">**/ unregister** nebo **/u**</span><span class="sxs-lookup"><span data-stu-id="fa29a-138">**/unregister** or **/u**</span></span>|<span data-ttu-id="fa29a-139">Zruší registraci vytvořitelné třídy v *assemblyFile*.</span><span class="sxs-lookup"><span data-stu-id="fa29a-139">Unregisters the creatable classes found in *assemblyFile*.</span></span> <span data-ttu-id="fa29a-140">Vynechání této možnosti způsobí, že nástroj Regasm.exe zaregistruje vytvořitelné třídy v rámci sestavení.</span><span class="sxs-lookup"><span data-stu-id="fa29a-140">Omitting this option causes Regasm.exe to register the creatable classes in the assembly.</span></span>|
|<span data-ttu-id="fa29a-141">**/verbose**</span><span class="sxs-lookup"><span data-stu-id="fa29a-141">**/verbose**</span></span>|<span data-ttu-id="fa29a-142">Určuje režim podrobného vypisování; Zobrazí seznam veškerých odkazovaných sestavení, pro které knihovnu typů musí být vytvořen, pokud zadaný **/TLB** možnost.</span><span class="sxs-lookup"><span data-stu-id="fa29a-142">Specifies verbose mode; displays a list of any referenced assemblies for which a type library needs to be generated, when specified with the **/tlb** option.</span></span>|
|<span data-ttu-id="fa29a-143">**/?**</span><span class="sxs-lookup"><span data-stu-id="fa29a-143">**/?**</span></span> <span data-ttu-id="fa29a-144">nebo   **/help**</span><span class="sxs-lookup"><span data-stu-id="fa29a-144">or **/help**</span></span>|<span data-ttu-id="fa29a-145">Zobrazí syntaxi příkazu a možnosti nástroje.</span><span class="sxs-lookup"><span data-stu-id="fa29a-145">Displays command syntax and options for the tool.</span></span>|

> [!NOTE]
> <span data-ttu-id="fa29a-146">Možnosti příkazového řádku nástroje Regasm.exe nerozlišují malá a velká písmena.</span><span class="sxs-lookup"><span data-stu-id="fa29a-146">The Regasm.exe command-line options are case insensitive.</span></span> <span data-ttu-id="fa29a-147">Pro jednoznačnou identifikaci je potřeba zadat dostatek parametrů.</span><span class="sxs-lookup"><span data-stu-id="fa29a-147">You only need to provide enough of the option to uniquely identify it.</span></span> <span data-ttu-id="fa29a-148">Například **/n** je ekvivalentní **/nologo** a **t:** *outfile.tlb* je ekvivalentní **/tlb:**  *OutFile.tlb*.</span><span class="sxs-lookup"><span data-stu-id="fa29a-148">For example, **/n** is equivalent to **/nologo** and **/t:** *outfile.tlb* is equivalent to **/tlb:** *outfile.tlb*.</span></span>

## <a name="remarks"></a><span data-ttu-id="fa29a-149">Poznámky</span><span class="sxs-lookup"><span data-stu-id="fa29a-149">Remarks</span></span>

<span data-ttu-id="fa29a-150">Můžete použít **/RegFile** možnost k vytvoření souboru .reg obsahujícího položky registru namísto změn přímo do registru.</span><span class="sxs-lookup"><span data-stu-id="fa29a-150">You can use the **/regfile** option to generate a .reg file that contains the registry entries instead of making the changes directly to the registry.</span></span> <span data-ttu-id="fa29a-151">Registr lze na počítači aktualizovat importováním souboru .reg pomocí nástroje Editor registru (Regedit.exe).</span><span class="sxs-lookup"><span data-stu-id="fa29a-151">You can update the registry on a computer by importing the .reg file with the Registry Editor tool (Regedit.exe).</span></span> <span data-ttu-id="fa29a-152">Soubor .reg neobsahuje žádné aktualizace registru, které lze provést pomocí funkcí registru definovaných uživatelem.</span><span class="sxs-lookup"><span data-stu-id="fa29a-152">Note that the .reg file does not contain any registry updates that can be made by user-defined register functions.</span></span>  <span data-ttu-id="fa29a-153">Všimněte si, **/RegFile** možnost generuje pouze položky registru pro spravované třídy.</span><span class="sxs-lookup"><span data-stu-id="fa29a-153">Note that the **/regfile** option only emits registry entries for managed classes.</span></span>  <span data-ttu-id="fa29a-154">Tato možnost negeneruje položky pro `TypeLibID`s nebo `InterfaceID`s.</span><span class="sxs-lookup"><span data-stu-id="fa29a-154">This option does not emit entries for `TypeLibID`s or `InterfaceID`s.</span></span>

<span data-ttu-id="fa29a-155">Pokud zadáte **/TLB** možnost Regasm.exe vygeneruje a zaregistruje knihovnu typů popisující typy nalezené v sestavení.</span><span class="sxs-lookup"><span data-stu-id="fa29a-155">When you specify the **/tlb** option, Regasm.exe generates and registers a type library describing the types found in the assembly.</span></span> <span data-ttu-id="fa29a-156">Nástroj Regasm.exe umístí vytvořenou knihovnu typů do aktuálního pracovního adresáře nebo do adresáře určeného pro výstupní soubor.</span><span class="sxs-lookup"><span data-stu-id="fa29a-156">Regasm.exe places the generated type libraries in the current working directory or the directory specified for the output file.</span></span> <span data-ttu-id="fa29a-157">Vytváření knihovny typů pro sestavení, které odkazuje na jiné sestavení, může způsobit vytvoření několika knihoven typů najednou.</span><span class="sxs-lookup"><span data-stu-id="fa29a-157">Generating a type library for an assembly that references other assemblies may cause several type libraries to be generated at once.</span></span> <span data-ttu-id="fa29a-158">Knihovny typů můžete použít k poskytnutí informací o typech vývojovým nástrojům jako například Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="fa29a-158">You can use the type library to provide type information to development tools like Visual Studio.</span></span> <span data-ttu-id="fa29a-159">Neměli byste používat **/TLB** možnost sestavení při registraci se vytvořil parametrem Type Library Importer ([Tlbimp.exe](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)).</span><span class="sxs-lookup"><span data-stu-id="fa29a-159">You should not use the **/tlb** option if the assembly you are registering was produced by the Type Library Importer ([Tlbimp.exe](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)).</span></span> <span data-ttu-id="fa29a-160">Knihovnu typů nelze exportovat ze sestavení, které bylo importováno z knihovny typů.</span><span class="sxs-lookup"><span data-stu-id="fa29a-160">You cannot export a type library from an assembly that was imported from a type library.</span></span> <span data-ttu-id="fa29a-161">Použití **/TLB** možnost má stejný účinek jako použití Exportér knihovny typů ([Tlbexp.exe](../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md)) a Regasm.exe, s tím rozdílem, že Tlbexp.exe nezaregistruje knihovnu typů, vyvolá.</span><span class="sxs-lookup"><span data-stu-id="fa29a-161">Using the **/tlb** option has the same effect as using the Type Library Exporter ([Tlbexp.exe](../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md)) and Regasm.exe, with the exception that Tlbexp.exe does not register the type library it produces.</span></span>  <span data-ttu-id="fa29a-162">Pokud používáte **/TLB** možnost zaregistrovat knihovnu typů, můžete použít **/TLB** spolu s možností **/ unregister** pro zrušení registrace knihovny typů.</span><span class="sxs-lookup"><span data-stu-id="fa29a-162">If you use the **/tlb** option to registered a type library, you can use **/tlb** option with the **/unregister** option to unregistered the type library.</span></span> <span data-ttu-id="fa29a-163">Použitím obou možností společně dojde ke zrušení registrace knihovny typů a položek rozhraní, čímž lze značně pročistit registr.</span><span class="sxs-lookup"><span data-stu-id="fa29a-163">Using the two options together will unregister the type library and interface entries, which can clean the registry considerably.</span></span>

<span data-ttu-id="fa29a-164">Při registraci sestavení pro použití modelem COM nástroj Regasm.exe přidá položky do registru místního počítače.</span><span class="sxs-lookup"><span data-stu-id="fa29a-164">When you register an assembly for use by COM, Regasm.exe adds entries to the registry on the local computer.</span></span> <span data-ttu-id="fa29a-165">Přesněji řečeno vytvoří klíče registru závislé na verzi, které dovolují v počítači paralelně spustit více verzí stejného sestavení.</span><span class="sxs-lookup"><span data-stu-id="fa29a-165">More specifically, it creates version-dependent registry keys that allow multiple versions of the same assembly to run side by side on a computer.</span></span> <span data-ttu-id="fa29a-166">Při první registraci sestavení je pro sestavení vytvořen jeden klíč na nejvyšší úrovni a je vytvořen jedinečný podklíč pro konkrétní verzi.</span><span class="sxs-lookup"><span data-stu-id="fa29a-166">The first time an assembly is registered, one top-level key is created for the assembly and a unique subkey is created for the specific version.</span></span> <span data-ttu-id="fa29a-167">Při každé registraci nové verze sestavení nástroj Regasm.exe vytvoří podklíč pro novou verzi.</span><span class="sxs-lookup"><span data-stu-id="fa29a-167">Each time you register a new version of the assembly, Regasm.exe creates a subkey for the new version.</span></span>

<span data-ttu-id="fa29a-168">Jako příklad lze uvést registraci spravované komponenty, myComp.dll, verze 1.0.0.0 pro použití modelem COM.</span><span class="sxs-lookup"><span data-stu-id="fa29a-168">For example, consider a scenario where you register the managed component, myComp.dll, version 1.0.0.0 for use by COM.</span></span> <span data-ttu-id="fa29a-169">Později zaregistrujete myComp.dll verze 2.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="fa29a-169">Later, you register myComp.dll, version 2.0.0.0.</span></span> <span data-ttu-id="fa29a-170">Je možné určit, že všechny klientské aplikace modelu COM v počítači používají myComp.dll verze 2.0.0.0 a rozhodnout o zrušení registrace myComponent.dll verze 1.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="fa29a-170">You determine that all COM client applications on the computer are using myComp.dll version 2.0.0.0 and you decide to unregister myComponent.dll version 1.0.0.0.</span></span> <span data-ttu-id="fa29a-171">Toto schéma registru umožňuje zrušit registraci myComp.dll verze 1.0.0.0, protože je odebrán pouze podklíč verze 1.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="fa29a-171">This registry scheme allows you to unregister myComp.dll version 1.0.0.0 because only the version 1.0.0.0 subkey is removed.</span></span>

<span data-ttu-id="fa29a-172">Po registraci sestavení pomocí Regasm.exe, můžete nainstalovat ho [globální mezipaměti sestavení](../../../docs/framework/app-domains/gac.md) tak, aby mohlo být aktivováno z libovolného klientu com.</span><span class="sxs-lookup"><span data-stu-id="fa29a-172">After registering an assembly using Regasm.exe, you can install it in the [global assembly cache](../../../docs/framework/app-domains/gac.md) so that it can be activated from any COM client.</span></span> <span data-ttu-id="fa29a-173">Pokud bude sestavení aktivováno jednou aplikací, je možné je umístit do adresáře dané aplikace.</span><span class="sxs-lookup"><span data-stu-id="fa29a-173">If the assembly is only going to be activated by a single application, you can place it in that application's directory.</span></span>

## <a name="examples"></a><span data-ttu-id="fa29a-174">Příklady</span><span class="sxs-lookup"><span data-stu-id="fa29a-174">Examples</span></span>

<span data-ttu-id="fa29a-175">Následující příkaz zaregistruje všechny veřejné třídy obsažené v `myTest.dll`.</span><span class="sxs-lookup"><span data-stu-id="fa29a-175">The following command registers all public classes contained in `myTest.dll`.</span></span>

```
regasm myTest.dll
```

<span data-ttu-id="fa29a-176">Následující příkaz vytvoří soubor `myTest.reg`, která obsahuje všechny nezbytné položky registru.</span><span class="sxs-lookup"><span data-stu-id="fa29a-176">The following command generates the file `myTest.reg`, which contains all the necessary registry entries.</span></span> <span data-ttu-id="fa29a-177">Tento příkaz neprovede aktualizaci registru.</span><span class="sxs-lookup"><span data-stu-id="fa29a-177">This command does not update the registry.</span></span>

```
regasm myTest.dll /regfile:myTest.reg
```

<span data-ttu-id="fa29a-178">Následující příkaz zaregistruje všechny veřejné třídy obsažené v `myTest.dll`, vygeneruje a zaregistruje knihovnu typů `myTest.tlb`, která obsahuje definice veřejných typů definovaných v `myTest.dll`.</span><span class="sxs-lookup"><span data-stu-id="fa29a-178">The following command registers all public classes contained in `myTest.dll`, and generates and registers the type library `myTest.tlb`, which contains definitions of all the public types defined in `myTest.dll`.</span></span>

```
regasm myTest.dll /tlb:myTest.tlb
```

## <a name="see-also"></a><span data-ttu-id="fa29a-179">Viz také:</span><span class="sxs-lookup"><span data-stu-id="fa29a-179">See also</span></span>

- [<span data-ttu-id="fa29a-180">Nástroje</span><span class="sxs-lookup"><span data-stu-id="fa29a-180">Tools</span></span>](../../../docs/framework/tools/index.md)
- [<span data-ttu-id="fa29a-181">Tlbexp.exe (exportér knihovny typů)</span><span class="sxs-lookup"><span data-stu-id="fa29a-181">Tlbexp.exe (Type Library Exporter)</span></span>](../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md)
- [<span data-ttu-id="fa29a-182">Tlbimp.exe (importér knihovny typů)</span><span class="sxs-lookup"><span data-stu-id="fa29a-182">Tlbimp.exe (Type Library Importer)</span></span>](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)
- [<span data-ttu-id="fa29a-183">Registrování sestav pomocí modelu COM</span><span class="sxs-lookup"><span data-stu-id="fa29a-183">Registering Assemblies with COM</span></span>](../../../docs/framework/interop/registering-assemblies-with-com.md)
- [<span data-ttu-id="fa29a-184">Příkazové řádky</span><span class="sxs-lookup"><span data-stu-id="fa29a-184">Command Prompts</span></span>](../../../docs/framework/tools/developer-command-prompt-for-vs.md)
