---
title: Připojovací řetězce a konfigurační soubory
description: Naučte se, jak ukládat připojovací řetězce pro aplikace ADO.NET do konfiguračního souboru aplikace, jako osvědčený postup pro zabezpečení a údržbu.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 37df2641-661e-407a-a3fb-7bf9540f01e8
ms.openlocfilehash: 572c5be1bd639e8d4b38935f5be49782f0b0316e
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/02/2020
ms.locfileid: "84287035"
---
# <a name="connection-strings-and-configuration-files"></a><span data-ttu-id="859d3-103">Připojovací řetězce a konfigurační soubory</span><span class="sxs-lookup"><span data-stu-id="859d3-103">Connection Strings and Configuration Files</span></span>

<span data-ttu-id="859d3-104">Vkládání připojovacích řetězců do kódu aplikace může vést k ohrožení zabezpečení a problémům s údržbou.</span><span class="sxs-lookup"><span data-stu-id="859d3-104">Embedding connection strings in your application's code can lead to security vulnerabilities and maintenance problems.</span></span> <span data-ttu-id="859d3-105">Nešifrované připojovací řetězce zkompilované do zdrojového kódu aplikace lze zobrazit pomocí nástroje [Ildasm. exe (IL Disassembler)](../../tools/ildasm-exe-il-disassembler.md) .</span><span class="sxs-lookup"><span data-stu-id="859d3-105">Unencrypted connection strings compiled into an application's source code can be viewed using the [Ildasm.exe (IL Disassembler)](../../tools/ildasm-exe-il-disassembler.md) tool.</span></span> <span data-ttu-id="859d3-106">Navíc platí, že pokud se připojovací řetězec někdy změní, vaše aplikace musí být znovu zkompilována.</span><span class="sxs-lookup"><span data-stu-id="859d3-106">Moreover, if the connection string ever changes, your application must be recompiled.</span></span> <span data-ttu-id="859d3-107">Z těchto důvodů doporučujeme ukládat připojovací řetězce do konfiguračního souboru aplikace.</span><span class="sxs-lookup"><span data-stu-id="859d3-107">For these reasons, we recommend storing connection strings in an application configuration file.</span></span>  
  
## <a name="working-with-application-configuration-files"></a><span data-ttu-id="859d3-108">Práce s konfiguračními soubory aplikace</span><span class="sxs-lookup"><span data-stu-id="859d3-108">Working with Application Configuration Files</span></span>  
 <span data-ttu-id="859d3-109">Konfigurační soubory aplikace obsahují nastavení, která jsou specifická pro konkrétní aplikaci.</span><span class="sxs-lookup"><span data-stu-id="859d3-109">Application configuration files contain settings that are specific to a particular application.</span></span> <span data-ttu-id="859d3-110">Například aplikace ASP.NET může mít jeden nebo více souborů **Web. config** a aplikace systému Windows může mít volitelný soubor **App. config** .</span><span class="sxs-lookup"><span data-stu-id="859d3-110">For example, an ASP.NET application can have one or more **web.config** files, and a Windows application can have an optional **app.config** file.</span></span> <span data-ttu-id="859d3-111">Konfigurační soubory sdílejí společné prvky, i když se název a umístění konfiguračního souboru liší v závislosti na hostiteli aplikace.</span><span class="sxs-lookup"><span data-stu-id="859d3-111">Configuration files share common elements, although the name and location of a configuration file vary depending on the application's host.</span></span>  
  
### <a name="the-connectionstrings-section"></a><span data-ttu-id="859d3-112">Oddíl connectionStrings</span><span class="sxs-lookup"><span data-stu-id="859d3-112">The connectionStrings Section</span></span>  
 <span data-ttu-id="859d3-113">Připojovací řetězce mohou být uloženy jako páry klíč/hodnota v sekci **connectionStrings** **konfiguračního souboru** aplikace.</span><span class="sxs-lookup"><span data-stu-id="859d3-113">Connection strings can be stored as key/value pairs in the **connectionStrings** section of the **configuration** element of an application configuration file.</span></span> <span data-ttu-id="859d3-114">Podřízené elementy zahrnují **Přidání**, **zrušení**a **Odebrání**.</span><span class="sxs-lookup"><span data-stu-id="859d3-114">Child elements include **add**, **clear**, and **remove**.</span></span>  
  
 <span data-ttu-id="859d3-115">Následující fragment konfiguračního souboru ukazuje schéma a syntaxi pro uložení připojovacího řetězce.</span><span class="sxs-lookup"><span data-stu-id="859d3-115">The following configuration file fragment demonstrates the schema and syntax for storing a connection string.</span></span> <span data-ttu-id="859d3-116">Atribut **Name** je název, který zadáte k jedinečné identifikaci připojovacího řetězce, aby jej bylo možné načíst v době běhu.</span><span class="sxs-lookup"><span data-stu-id="859d3-116">The **name** attribute is a name that you provide to uniquely identify a connection string so that it can be retrieved at run time.</span></span> <span data-ttu-id="859d3-117">Název **ProviderName** je neutrální název poskytovatele dat .NET Framework, který je zaregistrován v souboru Machine. config.</span><span class="sxs-lookup"><span data-stu-id="859d3-117">The **providerName** is the invariant name of the .NET Framework data provider, which is registered in the machine.config file.</span></span>  
  
```xml  
<?xml version='1.0' encoding='utf-8'?>  
  <configuration>  
    <connectionStrings>  
      <clear />  
      <add name="Name"
       providerName="System.Data.ProviderName"
       connectionString="Valid Connection String;" />  
    </connectionStrings>  
  </configuration>  
```  
  
> [!NOTE]
> <span data-ttu-id="859d3-118">Můžete uložit část připojovacího řetězce do konfiguračního souboru a použít <xref:System.Data.Common.DbConnectionStringBuilder> třídu k jeho dokončení za běhu.</span><span class="sxs-lookup"><span data-stu-id="859d3-118">You can save part of a connection string in a configuration file and use the <xref:System.Data.Common.DbConnectionStringBuilder> class to complete it at run time.</span></span> <span data-ttu-id="859d3-119">To je užitečné ve scénářích, kdy neznáte prvky připojovacího řetězce před časem, nebo pokud nechcete ukládat citlivé informace do konfiguračního souboru.</span><span class="sxs-lookup"><span data-stu-id="859d3-119">This is useful in scenarios where you do not know elements of the connection string ahead of time, or when you do not want to save sensitive information in a configuration file.</span></span> <span data-ttu-id="859d3-120">Další informace najdete v tématu [tvůrci připojovacích řetězců](connection-string-builders.md).</span><span class="sxs-lookup"><span data-stu-id="859d3-120">For more information, see [Connection String Builders](connection-string-builders.md).</span></span>  
  
### <a name="using-external-configuration-files"></a><span data-ttu-id="859d3-121">Použití externích konfiguračních souborů</span><span class="sxs-lookup"><span data-stu-id="859d3-121">Using External Configuration Files</span></span>  
 <span data-ttu-id="859d3-122">Externí konfigurační soubory jsou samostatné soubory, které obsahují fragment konfiguračního souboru skládajícího se z jednoho oddílu.</span><span class="sxs-lookup"><span data-stu-id="859d3-122">External configuration files are separate files that contain a fragment of a configuration file consisting of a single section.</span></span> <span data-ttu-id="859d3-123">Na externí konfigurační soubor se pak odkazuje pomocí hlavního konfiguračního souboru.</span><span class="sxs-lookup"><span data-stu-id="859d3-123">The external configuration file is then referenced by the main configuration file.</span></span> <span data-ttu-id="859d3-124">Uložení oddílu **connectionStrings** do fyzicky odděleného souboru je užitečné v situacích, kdy je možné upravit připojovací řetězce po nasazení aplikace.</span><span class="sxs-lookup"><span data-stu-id="859d3-124">Storing the **connectionStrings** section in a physically separate file is useful in situations where connection strings may be edited after the application is deployed.</span></span> <span data-ttu-id="859d3-125">Například standardní chování ASP.NET je restartování domény aplikace při úpravě konfiguračních souborů, což vede ke ztrátě informací o stavu.</span><span class="sxs-lookup"><span data-stu-id="859d3-125">For example, the standard ASP.NET behavior is to restart an application domain when configuration files are modified, which results in state information being lost.</span></span> <span data-ttu-id="859d3-126">Úpravy externího konfiguračního souboru ale nezpůsobí restart aplikace.</span><span class="sxs-lookup"><span data-stu-id="859d3-126">However, modifying an external configuration file does not cause an application restart.</span></span> <span data-ttu-id="859d3-127">Externí konfigurační soubory nejsou omezené na ASP.NET; je možné je používat i v aplikacích pro Windows.</span><span class="sxs-lookup"><span data-stu-id="859d3-127">External configuration files are not limited to ASP.NET; they can also be used by Windows applications.</span></span> <span data-ttu-id="859d3-128">Kromě toho je možné k omezení přístupu k externím konfiguračním souborům použít oprávnění a zabezpečení přístupu k souborům.</span><span class="sxs-lookup"><span data-stu-id="859d3-128">In addition, file access security and permissions can be used to restrict access to external configuration files.</span></span> <span data-ttu-id="859d3-129">Práce s externími konfiguračními soubory v době běhu je transparentní a nevyžaduje žádné speciální kódování.</span><span class="sxs-lookup"><span data-stu-id="859d3-129">Working with external configuration files at run time is transparent, and requires no special coding.</span></span>  
  
 <span data-ttu-id="859d3-130">Chcete-li uložit připojovací řetězce v externím konfiguračním souboru, vytvořte samostatný soubor, který obsahuje pouze část **connectionStrings** .</span><span class="sxs-lookup"><span data-stu-id="859d3-130">To store connection strings in an external configuration file, create a separate file that contains only the **connectionStrings** section.</span></span> <span data-ttu-id="859d3-131">Nezahrnujte žádné další prvky, oddíly ani atributy.</span><span class="sxs-lookup"><span data-stu-id="859d3-131">Do not include any additional elements, sections, or attributes.</span></span> <span data-ttu-id="859d3-132">Tento příklad ukazuje syntaxi pro externí konfigurační soubor.</span><span class="sxs-lookup"><span data-stu-id="859d3-132">This example shows the syntax for an external configuration file.</span></span>  
  
```xml  
<connectionStrings>  
  <add name="Name"
   providerName="System.Data.ProviderName"
   connectionString="Valid Connection String;" />  
</connectionStrings>  
```  
  
 <span data-ttu-id="859d3-133">V hlavním konfiguračním souboru aplikace použijete atribut **configSource** k určení plně kvalifikovaného názvu a umístění externího souboru.</span><span class="sxs-lookup"><span data-stu-id="859d3-133">In the main application configuration file, you use the **configSource** attribute to specify the fully qualified name and location of the external file.</span></span> <span data-ttu-id="859d3-134">Tento příklad odkazuje na externí konfigurační soubor s názvem `connections.config` .</span><span class="sxs-lookup"><span data-stu-id="859d3-134">This example refers to an external configuration file named `connections.config`.</span></span>  
  
```xml  
<?xml version='1.0' encoding='utf-8'?>  
<configuration>  
    <connectionStrings configSource="connections.config"/>  
</configuration>  
```  
  
## <a name="retrieving-connection-strings-at-run-time"></a><span data-ttu-id="859d3-135">Načítání připojovacích řetězců v době běhu</span><span class="sxs-lookup"><span data-stu-id="859d3-135">Retrieving Connection Strings at Run Time</span></span>  
 <span data-ttu-id="859d3-136">.NET Framework 2,0 zavedl nové třídy v <xref:System.Configuration> oboru názvů, aby bylo možné zjednodušit načítání připojovacích řetězců z konfiguračních souborů v době běhu.</span><span class="sxs-lookup"><span data-stu-id="859d3-136">The .NET Framework 2.0 introduced new classes in the <xref:System.Configuration> namespace to simplify retrieving connection strings from configuration files at run time.</span></span> <span data-ttu-id="859d3-137">Připojovací řetězec můžete programově načíst podle názvu nebo podle názvu poskytovatele.</span><span class="sxs-lookup"><span data-stu-id="859d3-137">You can programmatically retrieve a connection string by name or by provider name.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="859d3-138">Soubor **Machine. config** také obsahuje oddíl **connectionStrings** , který obsahuje připojovací řetězce používané v aplikaci Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="859d3-138">The **machine.config** file also contains a **connectionStrings** section, which contains connection strings used by Visual Studio.</span></span> <span data-ttu-id="859d3-139">Při načítání připojovacích řetězců podle názvu poskytovatele ze souboru **App. config** v aplikaci systému Windows jsou nejprve načteny připojovací řetězce v souboru **Machine. config** a následně položky z **App. config**. Přidání **jasných** hodnot ihned poté, co prvek **connectionStrings** odebere všechny zděděné odkazy z struktury dat v paměti, aby byly zváženy pouze připojovací řetězce definované v souboru místní soubor **App. config** .</span><span class="sxs-lookup"><span data-stu-id="859d3-139">When retrieving connection strings by provider name from the **app.config** file in a Windows application, the connection strings in **machine.config** get loaded first, and then the entries from **app.config**. Adding **clear** immediately after the **connectionStrings** element removes all inherited references from the data structure in memory, so that only the connection strings defined in the local **app.config** file are considered.</span></span>  
  
### <a name="working-with-the-configuration-classes"></a><span data-ttu-id="859d3-140">Práce s třídami konfigurace</span><span class="sxs-lookup"><span data-stu-id="859d3-140">Working with the Configuration Classes</span></span>  
 <span data-ttu-id="859d3-141">Počínaje .NET Framework 2,0 <xref:System.Configuration.ConfigurationManager> se používá při práci s konfiguračními soubory v místním počítači a nahrazuje zastaralé <xref:System.Configuration.ConfigurationSettings> .</span><span class="sxs-lookup"><span data-stu-id="859d3-141">Starting with the .NET Framework 2.0, <xref:System.Configuration.ConfigurationManager> is used when working with configuration files on the local computer, replacing the deprecated <xref:System.Configuration.ConfigurationSettings>.</span></span> <span data-ttu-id="859d3-142"><xref:System.Web.Configuration.WebConfigurationManager>se používá pro práci s konfiguračními soubory ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="859d3-142"><xref:System.Web.Configuration.WebConfigurationManager> is used to work with ASP.NET configuration files.</span></span> <span data-ttu-id="859d3-143">Je navržená pro práci s konfiguračními soubory na webovém serveru a umožňuje programový přístup k oddílům konfiguračního souboru, jako je **System. Web**.</span><span class="sxs-lookup"><span data-stu-id="859d3-143">It is designed to work with configuration files on a Web server, and allows programmatic access to configuration file sections such as **system.web**.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="859d3-144">Přístup ke konfiguračním souborům v době běhu vyžaduje udělení oprávnění volajícímu; požadovaná oprávnění závisí na typu aplikace, konfiguračním souboru a umístění.</span><span class="sxs-lookup"><span data-stu-id="859d3-144">Accessing configuration files at run time requires granting permissions to the caller; the required permissions depend on the type of application, configuration file, and location.</span></span> <span data-ttu-id="859d3-145">Další informace najdete v tématech [použití tříd konfigurace](https://docs.microsoft.com/previous-versions/aspnet/ms228063(v=vs.100)) a <xref:System.Web.Configuration.WebConfigurationManager> pro aplikace ASP.NET a <xref:System.Configuration.ConfigurationManager> pro aplikace pro Windows.</span><span class="sxs-lookup"><span data-stu-id="859d3-145">For more information, see [Using the Configuration Classes](https://docs.microsoft.com/previous-versions/aspnet/ms228063(v=vs.100)) and <xref:System.Web.Configuration.WebConfigurationManager> for ASP.NET applications, and <xref:System.Configuration.ConfigurationManager> for Windows applications.</span></span>  
  
 <span data-ttu-id="859d3-146">Můžete použít <xref:System.Configuration.ConnectionStringSettingsCollection> k načtení připojovacích řetězců z konfiguračních souborů aplikace.</span><span class="sxs-lookup"><span data-stu-id="859d3-146">You can use the <xref:System.Configuration.ConnectionStringSettingsCollection> to retrieve connection strings from application configuration files.</span></span> <span data-ttu-id="859d3-147">Obsahuje kolekci <xref:System.Configuration.ConnectionStringSettings> objektů, z nichž každý představuje jednu položku v sekci **connectionStrings** .</span><span class="sxs-lookup"><span data-stu-id="859d3-147">It contains a collection of <xref:System.Configuration.ConnectionStringSettings> objects, each of which represents a single entry in the **connectionStrings** section.</span></span> <span data-ttu-id="859d3-148">Jeho vlastnosti jsou mapovány na atributy připojovacího řetězce, což vám umožní načíst připojovací řetězec zadáním názvu nebo názvu poskytovatele.</span><span class="sxs-lookup"><span data-stu-id="859d3-148">Its properties map to connection string attributes, allowing you to retrieve a connection string by specifying the name or the provider name.</span></span>  
  
|<span data-ttu-id="859d3-149">Vlastnost</span><span class="sxs-lookup"><span data-stu-id="859d3-149">Property</span></span>|<span data-ttu-id="859d3-150">Popis</span><span class="sxs-lookup"><span data-stu-id="859d3-150">Description</span></span>|  
|--------------|-----------------|  
|<xref:System.Configuration.ConnectionStringSettings.Name%2A>|<span data-ttu-id="859d3-151">Název připojovacího řetězce</span><span class="sxs-lookup"><span data-stu-id="859d3-151">The name of the connection string.</span></span> <span data-ttu-id="859d3-152">Provede mapování na atribut **Name** .</span><span class="sxs-lookup"><span data-stu-id="859d3-152">Maps to the **name** attribute.</span></span>|  
|<xref:System.Configuration.ConnectionStringSettings.ProviderName%2A>|<span data-ttu-id="859d3-153">Plně kvalifikovaný název poskytovatele.</span><span class="sxs-lookup"><span data-stu-id="859d3-153">The fully qualified provider name.</span></span> <span data-ttu-id="859d3-154">Provede mapování na atribut **ProviderName** .</span><span class="sxs-lookup"><span data-stu-id="859d3-154">Maps to the **providerName** attribute.</span></span>|  
|<xref:System.Configuration.ConnectionStringSettings.ConnectionString%2A>|<span data-ttu-id="859d3-155">Připojovací řetězec</span><span class="sxs-lookup"><span data-stu-id="859d3-155">The connection string.</span></span> <span data-ttu-id="859d3-156">Provede mapování na atribut **ConnectionString** .</span><span class="sxs-lookup"><span data-stu-id="859d3-156">Maps to the **connectionString** attribute.</span></span>|  
  
### <a name="example-listing-all-connection-strings"></a><span data-ttu-id="859d3-157">Příklad: výpis všech připojovacích řetězců</span><span class="sxs-lookup"><span data-stu-id="859d3-157">Example: Listing All Connection Strings</span></span>  
 <span data-ttu-id="859d3-158">Tento příklad provede iteraci <xref:System.Configuration.ConnectionStringSettingsCollection> a zobrazí <xref:System.Configuration.ConnectionStringSettings.Name%2A?displayProperty=nameWithType> <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A?displayProperty=nameWithType> vlastnosti, a <xref:System.Configuration.ConnectionStringSettings.ConnectionString%2A?displayProperty=nameWithType> v okně konzoly.</span><span class="sxs-lookup"><span data-stu-id="859d3-158">This example iterates through the <xref:System.Configuration.ConnectionStringSettingsCollection> and displays the <xref:System.Configuration.ConnectionStringSettings.Name%2A?displayProperty=nameWithType>, <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A?displayProperty=nameWithType>, and <xref:System.Configuration.ConnectionStringSettings.ConnectionString%2A?displayProperty=nameWithType> properties in the console window.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="859d3-159">System. Configuration. dll není zahrnut ve všech typech projektů a může být nutné nastavit odkaz na něj, aby bylo možné použít třídy konfigurace.</span><span class="sxs-lookup"><span data-stu-id="859d3-159">System.Configuration.dll is not included in all project types, and you may need to set a reference to it in order to use the configuration classes.</span></span> <span data-ttu-id="859d3-160">Název a umístění konkrétního konfiguračního souboru aplikace se liší podle typu aplikace a hostitelského procesu.</span><span class="sxs-lookup"><span data-stu-id="859d3-160">The name and location of a particular application configuration file varies by the type of application and the hosting process.</span></span>  
  
 [!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfig#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfig/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfig#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfig/VB/source.vb#1)]  
  
### <a name="example-retrieving-a-connection-string-by-name"></a><span data-ttu-id="859d3-161">Příklad: Načtení připojovacího řetězce podle názvu</span><span class="sxs-lookup"><span data-stu-id="859d3-161">Example: Retrieving a Connection String by Name</span></span>  
 <span data-ttu-id="859d3-162">Tento příklad ukazuje, jak načíst připojovací řetězec z konfiguračního souboru zadáním jeho názvu.</span><span class="sxs-lookup"><span data-stu-id="859d3-162">This example demonstrates how to retrieve a connection string from a configuration file by specifying its name.</span></span> <span data-ttu-id="859d3-163">Kód vytvoří <xref:System.Configuration.ConnectionStringSettings> objekt, který odpovídá zadanému vstupnímu parametru <xref:System.Configuration.ConfigurationManager.ConnectionStrings%2A> názvu.</span><span class="sxs-lookup"><span data-stu-id="859d3-163">The code creates a <xref:System.Configuration.ConnectionStringSettings> object, matching the supplied input parameter to the <xref:System.Configuration.ConfigurationManager.ConnectionStrings%2A> name.</span></span> <span data-ttu-id="859d3-164">Pokud se nenajde žádný shodný název, funkce vrátí `null` ( `Nothing` v Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="859d3-164">If no matching name is found, the function returns `null` (`Nothing` in Visual Basic).</span></span>  
  
 [!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfigByName#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByName/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfigByName#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByName/VB/source.vb#1)]  
  
### <a name="example-retrieving-a-connection-string-by-provider-name"></a><span data-ttu-id="859d3-165">Příklad: Načtení připojovacího řetězce podle názvu poskytovatele</span><span class="sxs-lookup"><span data-stu-id="859d3-165">Example: Retrieving a Connection String by Provider Name</span></span>  
 <span data-ttu-id="859d3-166">Tento příklad ukazuje, jak načíst připojovací řetězec zadáním neutrálního názvu poskytovatele ve formátu *System. data. ProviderName*.</span><span class="sxs-lookup"><span data-stu-id="859d3-166">This example demonstrates how to retrieve a connection string by specifying the provider-invariant name in the format *System.Data.ProviderName*.</span></span> <span data-ttu-id="859d3-167">Kód provede iteraci pomocí <xref:System.Configuration.ConnectionStringSettingsCollection> a vrátí připojovací řetězec pro první <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A> nalezený řetězec.</span><span class="sxs-lookup"><span data-stu-id="859d3-167">The code iterates through the <xref:System.Configuration.ConnectionStringSettingsCollection> and returns the connection string for the first <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A> found.</span></span> <span data-ttu-id="859d3-168">Pokud se název poskytovatele nenajde, funkce vrátí `null` ( `Nothing` v Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="859d3-168">If the provider name is not found, the function returns `null` (`Nothing` in Visual Basic).</span></span>  
  
 [!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/VB/source.vb#1)]  
  
## <a name="encrypting-configuration-file-sections-using-protected-configuration"></a><span data-ttu-id="859d3-169">Šifrování oddílů konfiguračního souboru pomocí chráněné konfigurace</span><span class="sxs-lookup"><span data-stu-id="859d3-169">Encrypting Configuration File Sections Using Protected Configuration</span></span>  
 <span data-ttu-id="859d3-170">ASP.NET 2,0 představil novou funkci nazvanou *Protected Configuration*, která umožňuje šifrování citlivých informací v konfiguračním souboru.</span><span class="sxs-lookup"><span data-stu-id="859d3-170">ASP.NET 2.0 introduced a new feature, called *protected configuration*, that enables you to encrypt sensitive information in a configuration file.</span></span> <span data-ttu-id="859d3-171">I když jsou primárně určené pro ASP.NET, můžete chráněnou konfiguraci použít také k šifrování oddílů konfiguračního souboru v aplikacích pro Windows.</span><span class="sxs-lookup"><span data-stu-id="859d3-171">Although primarily designed for ASP.NET, protected configuration can also be used to encrypt configuration file sections in Windows applications.</span></span> <span data-ttu-id="859d3-172">Podrobný popis možností chráněné konfigurace najdete v tématu [šifrování informací o konfiguraci pomocí chráněné konfigurace](https://docs.microsoft.com/previous-versions/aspnet/53tyfkaw(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="859d3-172">For a detailed description of the protected configuration capabilities, see [Encrypting Configuration Information Using Protected Configuration](https://docs.microsoft.com/previous-versions/aspnet/53tyfkaw(v=vs.100)).</span></span>  
  
 <span data-ttu-id="859d3-173">Následující fragment konfiguračního souboru ukazuje sekci **connectionStrings** poté, co byla zašifrována.</span><span class="sxs-lookup"><span data-stu-id="859d3-173">The following configuration file fragment shows the **connectionStrings** section after it has been encrypted.</span></span> <span data-ttu-id="859d3-174">**ConfigProtectionProvider** Určuje poskytovatele chráněné konfigurace, který se používá k šifrování a dešifrování připojovacích řetězců.</span><span class="sxs-lookup"><span data-stu-id="859d3-174">The **configProtectionProvider** specifies the protected configuration provider used to encrypt and decrypt the connection strings.</span></span> <span data-ttu-id="859d3-175">Oddíl **EncryptedData** obsahuje text šifry.</span><span class="sxs-lookup"><span data-stu-id="859d3-175">The **EncryptedData** section contains the cipher text.</span></span>  
  
```xml  
<connectionStrings configProtectionProvider="DataProtectionConfigurationProvider">  
  <EncryptedData>  
    <CipherData>  
      <CipherValue>AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAH2... </CipherValue>  
    </CipherData>  
  </EncryptedData>  
</connectionStrings>  
```  
  
 <span data-ttu-id="859d3-176">Při načtení šifrovaného připojovacího řetězce v době běhu .NET Framework používá zadaného poskytovatele k dešifrování **element CipherValue** a zpřístupnění pro vaši aplikaci.</span><span class="sxs-lookup"><span data-stu-id="859d3-176">When the encrypted connection string is retrieved at run time, the .NET Framework uses the specified provider to decrypt the **CipherValue** and make it available to your application.</span></span> <span data-ttu-id="859d3-177">Pro správu procesu dešifrování není nutné psát žádný další kód.</span><span class="sxs-lookup"><span data-stu-id="859d3-177">You do not need to write any additional code to manage the decryption process.</span></span>  
  
### <a name="protected-configuration-providers"></a><span data-ttu-id="859d3-178">Poskytovatelé chráněných konfigurací</span><span class="sxs-lookup"><span data-stu-id="859d3-178">Protected Configuration Providers</span></span>  
 <span data-ttu-id="859d3-179">Poskytovatelé chráněných konfigurací jsou registrováni v části **configProtectedData** souboru **Machine. config** v místním počítači, jak je znázorněno v následujícím fragmentu, který zobrazuje dva poskytovatele chráněných konfigurací dodaných s .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="859d3-179">Protected configuration providers are registered in the **configProtectedData** section of the **machine.config** file on the local computer, as shown in the following fragment, which shows the two protected configuration providers supplied with the .NET Framework.</span></span> <span data-ttu-id="859d3-180">Hodnoty, které jsou zde zobrazeny, byly zkráceny pro čitelnost.</span><span class="sxs-lookup"><span data-stu-id="859d3-180">The values shown here have been truncated for readability.</span></span>  
  
```xml  
<configProtectedData defaultProvider="RsaProtectedConfigurationProvider">  
  <providers>  
    <add name="RsaProtectedConfigurationProvider"
      type="System.Configuration.RsaProtectedConfigurationProvider" />  
    <add name="DataProtectionConfigurationProvider"
      type="System.Configuration.DpapiProtectedConfigurationProvider" />  
  </providers>  
</configProtectedData>  
```  
  
 <span data-ttu-id="859d3-181">Další poskytovatele chráněných konfigurací můžete nakonfigurovat tak, že je přidáte do souboru **Machine. config** .</span><span class="sxs-lookup"><span data-stu-id="859d3-181">You can configure additional protected configuration providers by adding them to the **machine.config** file.</span></span> <span data-ttu-id="859d3-182">Můžete také vytvořit vlastního poskytovatele chráněné konfigurace děděním z <xref:System.Configuration.ProtectedConfigurationProvider> abstraktní základní třídy.</span><span class="sxs-lookup"><span data-stu-id="859d3-182">You can also create your own protected configuration provider by inheriting from the <xref:System.Configuration.ProtectedConfigurationProvider> abstract base class.</span></span> <span data-ttu-id="859d3-183">Následující tabulka popisuje dva konfigurační soubory, které jsou součástí .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="859d3-183">The following table describes the two configuration files included with the .NET Framework.</span></span>  
  
|<span data-ttu-id="859d3-184">Poskytovatel</span><span class="sxs-lookup"><span data-stu-id="859d3-184">Provider</span></span>|<span data-ttu-id="859d3-185">Popis</span><span class="sxs-lookup"><span data-stu-id="859d3-185">Description</span></span>|  
|--------------|-----------------|  
|<xref:System.Configuration.RsaProtectedConfigurationProvider>|<span data-ttu-id="859d3-186">K šifrování a dešifrování dat používá šifrovací algoritmus RSA.</span><span class="sxs-lookup"><span data-stu-id="859d3-186">Uses the RSA encryption algorithm to encrypt and decrypt data.</span></span> <span data-ttu-id="859d3-187">Algoritmus RSA lze použít jak pro šifrování veřejného klíče, tak pro digitální podpisy.</span><span class="sxs-lookup"><span data-stu-id="859d3-187">The RSA algorithm can be used for both public key encryption and digital signatures.</span></span> <span data-ttu-id="859d3-188">Označuje se také jako "veřejný klíč" nebo asymetrické šifrování, protože používá dva různé klíče.</span><span class="sxs-lookup"><span data-stu-id="859d3-188">It is also known as "public key" or asymmetrical encryption because it employs two different keys.</span></span> <span data-ttu-id="859d3-189">K šifrování oddílů v souboru Web. config a správě šifrovacích klíčů můžete použít [registrační nástroj ASP.NET služby IIS (Aspnet_regiis. exe)](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/k6h9cz8h(v=vs.90)) .</span><span class="sxs-lookup"><span data-stu-id="859d3-189">You can use the [ASP.NET IIS Registration Tool (Aspnet_regiis.exe)](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/k6h9cz8h(v=vs.90)) to encrypt sections in a Web.config file and manage the encryption keys.</span></span> <span data-ttu-id="859d3-190">ASP.NET dešifruje konfigurační soubor při zpracovávání souboru.</span><span class="sxs-lookup"><span data-stu-id="859d3-190">ASP.NET decrypts the configuration file when it processes the file.</span></span> <span data-ttu-id="859d3-191">Identita aplikace ASP.NET musí mít oprávnění ke čtení šifrovacího klíče, který se používá k šifrování a dešifrování šifrovaných oddílů.</span><span class="sxs-lookup"><span data-stu-id="859d3-191">The identity of the ASP.NET application must have read access to the encryption key that is used to encrypt and decrypt the encrypted sections.</span></span>|  
|<xref:System.Configuration.DpapiProtectedConfigurationProvider>|<span data-ttu-id="859d3-192">K šifrování konfiguračních oddílů používá Windows Data Protection API (DPAPI).</span><span class="sxs-lookup"><span data-stu-id="859d3-192">Uses the Windows Data Protection API (DPAPI) to encrypt configuration sections.</span></span> <span data-ttu-id="859d3-193">Používá integrované kryptografické služby systému Windows a je možné ji nakonfigurovat pro ochranu specifickou pro konkrétní počítač nebo pro uživatelské účty.</span><span class="sxs-lookup"><span data-stu-id="859d3-193">It uses the Windows built-in cryptographic services and can be configured for either machine-specific or user-account-specific protection.</span></span> <span data-ttu-id="859d3-194">Ochrana specifická pro konkrétní počítač je užitečná pro více aplikací na stejném serveru, které potřebují sdílet informace.</span><span class="sxs-lookup"><span data-stu-id="859d3-194">Machine-specific protection is useful for multiple applications on the same server that need to share information.</span></span> <span data-ttu-id="859d3-195">Ochranu pomocí uživatelského účtu lze použít se službami, které se spouštějí s konkrétní identitou uživatele, jako je například sdílené hostitelské prostředí.</span><span class="sxs-lookup"><span data-stu-id="859d3-195">User-account-specific protection can be used with services that run with a specific user identity, such as a shared hosting environment.</span></span> <span data-ttu-id="859d3-196">Každá aplikace běží v rámci samostatné identity, která omezuje přístup k prostředkům, jako jsou soubory a databáze.</span><span class="sxs-lookup"><span data-stu-id="859d3-196">Each application runs under a separate identity which restricts access to resources such as files and databases.</span></span>|  
  
 <span data-ttu-id="859d3-197">Oba poskytovatelé nabízejí silné šifrování dat.</span><span class="sxs-lookup"><span data-stu-id="859d3-197">Both providers offer strong encryption of data.</span></span> <span data-ttu-id="859d3-198">Pokud však plánujete použít stejný zašifrovaný konfigurační soubor na více serverech, jako je například webová farma, <xref:System.Configuration.RsaProtectedConfigurationProvider> umožňuje exportovat šifrovací klíče používané k šifrování dat a importovat je na jiný server.</span><span class="sxs-lookup"><span data-stu-id="859d3-198">However, if you are planning to use the same encrypted configuration file on multiple servers, such as a Web farm, only the <xref:System.Configuration.RsaProtectedConfigurationProvider> enables you to export the encryption keys used to encrypt the data and import them on another server.</span></span> <span data-ttu-id="859d3-199">Další informace najdete v tématu [Import a export chráněných konfigurací kontejnerů klíčů RSA](https://docs.microsoft.com/previous-versions/aspnet/yxw286t2(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="859d3-199">For more information, see [Importing and Exporting Protected Configuration RSA Key Containers](https://docs.microsoft.com/previous-versions/aspnet/yxw286t2(v=vs.100)).</span></span>  
  
### <a name="using-the-configuration-classes"></a><span data-ttu-id="859d3-200">Použití tříd konfigurace</span><span class="sxs-lookup"><span data-stu-id="859d3-200">Using the Configuration Classes</span></span>  
 <span data-ttu-id="859d3-201"><xref:System.Configuration>Obor názvů poskytuje třídy pro práci s nastavením konfigurace programově.</span><span class="sxs-lookup"><span data-stu-id="859d3-201">The <xref:System.Configuration> namespace provides classes to work with configuration settings programmatically.</span></span> <span data-ttu-id="859d3-202"><xref:System.Configuration.ConfigurationManager>Třída poskytuje přístup k souborům konfigurace počítače, aplikace a uživatele.</span><span class="sxs-lookup"><span data-stu-id="859d3-202">The <xref:System.Configuration.ConfigurationManager> class provides access to machine, application, and user configuration files.</span></span> <span data-ttu-id="859d3-203">Pokud vytváříte aplikaci ASP.NET, můžete použít <xref:System.Web.Configuration.WebConfigurationManager> třídu, která poskytuje stejné funkce a zároveň umožňuje přístup k nastavení, která jsou jedinečná pro aplikace ASP.NET, jako jsou ty, které se nacházejí v **\<system.web>** .</span><span class="sxs-lookup"><span data-stu-id="859d3-203">If you are creating an ASP.NET application, you can use the <xref:System.Web.Configuration.WebConfigurationManager> class, which provides the same functionality while also allowing you to access settings that are unique to ASP.NET applications, such as those found in **\<system.web>**.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="859d3-204"><xref:System.Security.Cryptography>Obor názvů obsahuje třídy, které poskytují další možnosti pro šifrování a dešifrování dat.</span><span class="sxs-lookup"><span data-stu-id="859d3-204">The <xref:System.Security.Cryptography> namespace contains classes that provide additional options for encrypting and decrypting data.</span></span> <span data-ttu-id="859d3-205">Tyto třídy použijte, pokud požadujete kryptografické služby, které nejsou k dispozici pomocí chráněné konfigurace.</span><span class="sxs-lookup"><span data-stu-id="859d3-205">Use these classes if you require cryptographic services that are not available using protected configuration.</span></span> <span data-ttu-id="859d3-206">Některé z těchto tříd jsou obálky pro nespravované rozhraní Microsoft CryptoAPI, zatímco jiné jsou čistě spravované implementace.</span><span class="sxs-lookup"><span data-stu-id="859d3-206">Some of these classes are wrappers for the unmanaged Microsoft CryptoAPI, while others are purely managed implementations.</span></span> <span data-ttu-id="859d3-207">Další informace najdete v tématu [kryptografické služby](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/93bskf9z(v=vs.90)).</span><span class="sxs-lookup"><span data-stu-id="859d3-207">For more information, see [Cryptographic Services](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/93bskf9z(v=vs.90)).</span></span>  
  
### <a name="appconfig-example"></a><span data-ttu-id="859d3-208">Příklad App. config</span><span class="sxs-lookup"><span data-stu-id="859d3-208">App.config Example</span></span>  
 <span data-ttu-id="859d3-209">Tento příklad ukazuje, jak přepnout šifrování oddílu **connectionStrings** v souboru **App. config** pro aplikaci systému Windows.</span><span class="sxs-lookup"><span data-stu-id="859d3-209">This example demonstrates how to toggle encrypting the **connectionStrings** section in an **app.config** file for a Windows application.</span></span> <span data-ttu-id="859d3-210">V tomto příkladu procedura převezme název aplikace jako argument, například "MyApplication. exe".</span><span class="sxs-lookup"><span data-stu-id="859d3-210">In this example, the procedure takes the name of the application as an argument, for example, "MyApplication.exe".</span></span> <span data-ttu-id="859d3-211">Soubor **App. config** bude poté zašifrován a zkopírován do složky, která obsahuje spustitelný soubor pod názvem "MyApplication. exe. config".</span><span class="sxs-lookup"><span data-stu-id="859d3-211">The **app.config** file will then be encrypted and copied to the folder that contains the executable under the name of "MyApplication.exe.config".</span></span>  
  
> [!NOTE]
> <span data-ttu-id="859d3-212">Připojovací řetězec lze dešifrovat pouze v počítači, ve kterém byl zašifrovaný.</span><span class="sxs-lookup"><span data-stu-id="859d3-212">The connection string can only be decrypted on the computer on which it was encrypted.</span></span>  
  
 <span data-ttu-id="859d3-213">Kód používá <xref:System.Configuration.ConfigurationManager.OpenExeConfiguration%2A> metodu k otevření souboru **App. config** pro úpravy a <xref:System.Configuration.ConfigurationManager.GetSection%2A> Metoda vrátí oddíl **connectionStrings** .</span><span class="sxs-lookup"><span data-stu-id="859d3-213">The code uses the <xref:System.Configuration.ConfigurationManager.OpenExeConfiguration%2A> method to open the **app.config** file for editing, and the <xref:System.Configuration.ConfigurationManager.GetSection%2A> method returns the **connectionStrings** section.</span></span> <span data-ttu-id="859d3-214">Kód pak kontroluje <xref:System.Configuration.SectionInformation.IsProtected%2A> vlastnost, voláním metody <xref:System.Configuration.SectionInformation.ProtectSection%2A> k zašifrování oddílu, pokud není zašifrovaný.</span><span class="sxs-lookup"><span data-stu-id="859d3-214">The code then checks the <xref:System.Configuration.SectionInformation.IsProtected%2A> property, calling the <xref:System.Configuration.SectionInformation.ProtectSection%2A> to encrypt the section if it is not encrypted.</span></span> <span data-ttu-id="859d3-215"><xref:System.Configuration.SectionInformation.UnprotectSection%2A>Metoda je vyvolána pro dešifrování oddílu.</span><span class="sxs-lookup"><span data-stu-id="859d3-215">The <xref:System.Configuration.SectionInformation.UnprotectSection%2A> method is invoked to decrypt the section.</span></span> <span data-ttu-id="859d3-216"><xref:System.Configuration.Configuration.Save%2A>Metoda dokončí operaci a uloží změny.</span><span class="sxs-lookup"><span data-stu-id="859d3-216">The <xref:System.Configuration.Configuration.Save%2A> method completes the operation and saves the changes.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="859d3-217">Chcete-li spustit kód, je nutné nastavit odkaz na `System.Configuration.dll` v projektu.</span><span class="sxs-lookup"><span data-stu-id="859d3-217">You must set a reference to `System.Configuration.dll` in your project for the code to run.</span></span>  
  
 [!code-csharp[DataWorks ConnectionStrings.Encrypt#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStrings.Encrypt/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStrings.Encrypt#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStrings.Encrypt/VB/source.vb#1)]  
  
### <a name="webconfig-example"></a><span data-ttu-id="859d3-218">Příklad souboru Web. config</span><span class="sxs-lookup"><span data-stu-id="859d3-218">Web.config Example</span></span>  
 <span data-ttu-id="859d3-219">V tomto příkladu se používá <xref:System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration%2A> Metoda `WebConfigurationManager` .</span><span class="sxs-lookup"><span data-stu-id="859d3-219">This example uses the <xref:System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration%2A> method of the `WebConfigurationManager`.</span></span> <span data-ttu-id="859d3-220">Všimněte si, že v tomto případě můžete použít relativní cestu k souboru **Web. config** pomocí tildy.</span><span class="sxs-lookup"><span data-stu-id="859d3-220">Note that in this case you can supply the relative path to the **Web.config** file by using a tilde.</span></span> <span data-ttu-id="859d3-221">Kód vyžaduje odkaz na `System.Web.Configuration` třídu.</span><span class="sxs-lookup"><span data-stu-id="859d3-221">The code requires a reference to the `System.Web.Configuration` class.</span></span>  
  
 [!code-csharp[DataWorks ConnectionStringsWeb.Encrypt#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringsWeb.Encrypt/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStringsWeb.Encrypt#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringsWeb.Encrypt/VB/source.vb#1)]  
  
 <span data-ttu-id="859d3-222">Další informace o zabezpečení aplikací ASP.NET najdete v tématu [zabezpečení webů ASP.NET](https://docs.microsoft.com/previous-versions/aspnet/91f66yxt(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="859d3-222">For more information about securing ASP.NET applications, see [Securing ASP.NET web sites](https://docs.microsoft.com/previous-versions/aspnet/91f66yxt(v=vs.100)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="859d3-223">Viz také</span><span class="sxs-lookup"><span data-stu-id="859d3-223">See also</span></span>

- [<span data-ttu-id="859d3-224">Tvůrci připojovacích řetězců</span><span class="sxs-lookup"><span data-stu-id="859d3-224">Connection String Builders</span></span>](connection-string-builders.md)
- [<span data-ttu-id="859d3-225">Ochrana informací o připojení</span><span class="sxs-lookup"><span data-stu-id="859d3-225">Protecting Connection Information</span></span>](protecting-connection-information.md)
- <span data-ttu-id="859d3-226">[Použití tříd konfigurace](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ms228063(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="859d3-226">[Using the Configuration Classes](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ms228063(v=vs.90))</span></span>
- [<span data-ttu-id="859d3-227">Konfigurace aplikací</span><span class="sxs-lookup"><span data-stu-id="859d3-227">Configuring Apps</span></span>](../../configure-apps/index.md)
- <span data-ttu-id="859d3-228">[Správa webu ASP.NET](https://docs.microsoft.com/previous-versions/aspnet/6hy1xzbw(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="859d3-228">[ASP.NET Web Site Administration](https://docs.microsoft.com/previous-versions/aspnet/6hy1xzbw(v=vs.100))</span></span>
- [<span data-ttu-id="859d3-229">Přehled ADO.NET</span><span class="sxs-lookup"><span data-stu-id="859d3-229">ADO.NET Overview</span></span>](ado-net-overview.md)
