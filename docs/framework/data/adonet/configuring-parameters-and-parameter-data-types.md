---
title: Konfigurace parametrů a datových typů parametrů
description: Objekty příkazu používají parametry k předávání hodnot příkazům SQL nebo uloženým procedurám, což zajišťuje kontrolu a ověřování typu v ADO.NET.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 537d8a2c-d40b-4000-83eb-bc1fcc93f707
ms.openlocfilehash: a426eeae785274b0484a84a2fae2dce4572fb4c4
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/02/2020
ms.locfileid: "84287113"
---
# <a name="configuring-parameters-and-parameter-data-types"></a><span data-ttu-id="a4a08-103">Konfigurace parametrů a datových typů parametrů</span><span class="sxs-lookup"><span data-stu-id="a4a08-103">Configuring parameters and parameter data types</span></span>

<span data-ttu-id="a4a08-104">Objekty příkazu používají parametry k předávání hodnot příkazům SQL nebo uloženým procedurám, což zajišťuje kontrolu a ověřování typu.</span><span class="sxs-lookup"><span data-stu-id="a4a08-104">Command objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation.</span></span> <span data-ttu-id="a4a08-105">Na rozdíl od textu příkazu je vstup parametru považován za hodnotu literálu, nikoli jako spustitelný kód.</span><span class="sxs-lookup"><span data-stu-id="a4a08-105">Unlike command text, parameter input is treated as a literal value, not as executable code.</span></span> <span data-ttu-id="a4a08-106">To pomáhá chránit před útoky typu "injektáže SQL", kdy útočník vloží příkaz, který ohrozí zabezpečení serveru, do příkazu SQL.</span><span class="sxs-lookup"><span data-stu-id="a4a08-106">This helps guard against "SQL injection" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.</span></span>

<span data-ttu-id="a4a08-107">Parametrizované příkazy mohou také zlepšit výkon při provádění dotazů, protože pomůžou databázovému serveru přesně odpovídat příchozímu příkazu s řádným plánem dotazů v mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="a4a08-107">Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan.</span></span> <span data-ttu-id="a4a08-108">Další informace najdete v tématu [ukládání do mezipaměti, opakované](/sql/relational-databases/query-processing-architecture-guide#execution-plan-caching-and-reuse) použití a [parametry a opakované použití plánu](/sql/relational-databases/query-processing-architecture-guide#PlanReuse)spuštění.</span><span class="sxs-lookup"><span data-stu-id="a4a08-108">For more information, see [Execution Plan Caching and Reuse](/sql/relational-databases/query-processing-architecture-guide#execution-plan-caching-and-reuse) and [Parameters and Execution Plan Reuse](/sql/relational-databases/query-processing-architecture-guide#PlanReuse).</span></span> <span data-ttu-id="a4a08-109">Kromě výhod zabezpečení a výkonu poskytují parametrizované příkazy pohodlný způsob, jak uspořádat hodnoty předané zdroji dat.</span><span class="sxs-lookup"><span data-stu-id="a4a08-109">In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.</span></span>

<span data-ttu-id="a4a08-110"><xref:System.Data.Common.DbParameter>Objekt lze vytvořit pomocí jeho konstruktoru nebo jeho přidáním do objektu <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> voláním `Add` metody <xref:System.Data.Common.DbParameterCollection> kolekce.</span><span class="sxs-lookup"><span data-stu-id="a4a08-110">A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection.</span></span> <span data-ttu-id="a4a08-111">`Add`Metoda provede jako vstup buď argumenty konstruktoru, nebo existující objekt parametru v závislosti na poskytovateli dat.</span><span class="sxs-lookup"><span data-stu-id="a4a08-111">The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider.</span></span>

## <a name="supplying-the-parameterdirection-property"></a><span data-ttu-id="a4a08-112">Poskytnutí vlastnosti ParameterDirection</span><span class="sxs-lookup"><span data-stu-id="a4a08-112">Supplying the ParameterDirection property</span></span>

<span data-ttu-id="a4a08-113">Při přidávání parametrů je nutné zadat <xref:System.Data.ParameterDirection> vlastnost pro jiné parametry než vstupní parametry.</span><span class="sxs-lookup"><span data-stu-id="a4a08-113">When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters.</span></span> <span data-ttu-id="a4a08-114">V následující tabulce jsou uvedeny `ParameterDirection` hodnoty, které lze použít s <xref:System.Data.ParameterDirection> výčtem.</span><span class="sxs-lookup"><span data-stu-id="a4a08-114">The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration.</span></span>

|<span data-ttu-id="a4a08-115">Název členu</span><span class="sxs-lookup"><span data-stu-id="a4a08-115">Member name</span></span>|<span data-ttu-id="a4a08-116">Popis</span><span class="sxs-lookup"><span data-stu-id="a4a08-116">Description</span></span>|
|-----------------|-----------------|
|<xref:System.Data.ParameterDirection.Input>|<span data-ttu-id="a4a08-117">Parametr je vstupní parametr.</span><span class="sxs-lookup"><span data-stu-id="a4a08-117">The parameter is an input parameter.</span></span> <span data-ttu-id="a4a08-118">Toto nastavení je výchozí.</span><span class="sxs-lookup"><span data-stu-id="a4a08-118">This is the default.</span></span>|
|<xref:System.Data.ParameterDirection.InputOutput>|<span data-ttu-id="a4a08-119">Parametr může provádět vstup i výstup.</span><span class="sxs-lookup"><span data-stu-id="a4a08-119">The parameter can perform both input and output.</span></span>|
|<xref:System.Data.ParameterDirection.Output>|<span data-ttu-id="a4a08-120">Parametr je výstupní parametr.</span><span class="sxs-lookup"><span data-stu-id="a4a08-120">The parameter is an output parameter.</span></span>|
|<xref:System.Data.ParameterDirection.ReturnValue>|<span data-ttu-id="a4a08-121">Parametr představuje návratovou hodnotu z operace, jako je uložená procedura, integrovaná funkce nebo uživatelsky definovaná funkce.</span><span class="sxs-lookup"><span data-stu-id="a4a08-121">The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.</span></span>|

## <a name="working-with-parameter-placeholders"></a><span data-ttu-id="a4a08-122">Práce se zástupnými symboly parametrů</span><span class="sxs-lookup"><span data-stu-id="a4a08-122">Working with parameter placeholders</span></span>

<span data-ttu-id="a4a08-123">Syntaxe zástupných symbolů parametrů závisí na zdroji dat.</span><span class="sxs-lookup"><span data-stu-id="a4a08-123">The syntax for parameter placeholders depends on the data source.</span></span> <span data-ttu-id="a4a08-124">Poskytovatelé dat .NET Framework řídí pojmenování a zadání parametrů a zástupných symbolů parametrů odlišně.</span><span class="sxs-lookup"><span data-stu-id="a4a08-124">The .NET Framework data providers handle naming and specifying parameters and parameter placeholders differently.</span></span> <span data-ttu-id="a4a08-125">Tato syntaxe je přizpůsobená konkrétnímu zdroji dat, jak je popsáno v následující tabulce.</span><span class="sxs-lookup"><span data-stu-id="a4a08-125">This syntax is customized to a specific data source, as described in the following table.</span></span>

|<span data-ttu-id="a4a08-126">Poskytovatel dat</span><span class="sxs-lookup"><span data-stu-id="a4a08-126">Data provider</span></span>|<span data-ttu-id="a4a08-127">Syntaxe pojmenovávání parametrů</span><span class="sxs-lookup"><span data-stu-id="a4a08-127">Parameter naming syntax</span></span>|
|-------------------|-----------------------------|
|<xref:System.Data.SqlClient>|<span data-ttu-id="a4a08-128">Používá pojmenované parametry ve formátu `@` *ParameterName*.</span><span class="sxs-lookup"><span data-stu-id="a4a08-128">Uses named parameters in the format `@`*parametername*.</span></span>|
|<xref:System.Data.OleDb>|<span data-ttu-id="a4a08-129">Používá poziční značky parametrů, které jsou označeny otazníkem ( `?` ).</span><span class="sxs-lookup"><span data-stu-id="a4a08-129">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|
|<xref:System.Data.Odbc>|<span data-ttu-id="a4a08-130">Používá poziční značky parametrů, které jsou označeny otazníkem ( `?` ).</span><span class="sxs-lookup"><span data-stu-id="a4a08-130">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|
|<xref:System.Data.OracleClient>|<span data-ttu-id="a4a08-131">Používá pojmenované parametry ve formátu `:` *parmname* (nebo *parmname*).</span><span class="sxs-lookup"><span data-stu-id="a4a08-131">Uses named parameters in the format `:`*parmname* (or *parmname*).</span></span>|

## <a name="specifying-parameter-data-types"></a><span data-ttu-id="a4a08-132">Určení datových typů parametrů</span><span class="sxs-lookup"><span data-stu-id="a4a08-132">Specifying parameter data types</span></span>

<span data-ttu-id="a4a08-133">Datový typ parametru je specifický pro poskytovatele .NET Framework dat.</span><span class="sxs-lookup"><span data-stu-id="a4a08-133">The data type of a parameter is specific to the .NET Framework data provider.</span></span> <span data-ttu-id="a4a08-134">Určení typu převede hodnotu `Parameter` typu na .NET Framework typ poskytovatele dat před předáním hodnoty zdroji dat.</span><span class="sxs-lookup"><span data-stu-id="a4a08-134">Specifying the type converts the value of the `Parameter` to the .NET Framework data provider type before passing the value to the data source.</span></span> <span data-ttu-id="a4a08-135">Můžete také určit typ `Parameter` obecného způsobu nastavením `DbType` vlastnosti `Parameter` objektu na určitou hodnotu <xref:System.Data.DbType> .</span><span class="sxs-lookup"><span data-stu-id="a4a08-135">You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>.</span></span>

<span data-ttu-id="a4a08-136">Typ poskytovatele .NET Framework dat `Parameter` objektu je odvozený od .NET Frameworkho typu `Value` `Parameter` objektu nebo z `DbType` `Parameter` objektu.</span><span class="sxs-lookup"><span data-stu-id="a4a08-136">The .NET Framework data provider type of a `Parameter` object is inferred from the .NET Framework type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object.</span></span> <span data-ttu-id="a4a08-137">Následující tabulka ukazuje odvozený `Parameter` typ založený na objektu předaném jako `Parameter` hodnota nebo zadané `DbType` .</span><span class="sxs-lookup"><span data-stu-id="a4a08-137">The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`.</span></span>

|<span data-ttu-id="a4a08-138">Typ rozhraní .NET Framework</span><span class="sxs-lookup"><span data-stu-id="a4a08-138">.NET Framework type</span></span>|<span data-ttu-id="a4a08-139">DbType</span><span class="sxs-lookup"><span data-stu-id="a4a08-139">DbType</span></span>|<span data-ttu-id="a4a08-140">Platná</span><span class="sxs-lookup"><span data-stu-id="a4a08-140">SqlDbType</span></span>|<span data-ttu-id="a4a08-141">OleDbType</span><span class="sxs-lookup"><span data-stu-id="a4a08-141">OleDbType</span></span>|<span data-ttu-id="a4a08-142">OdbcType:</span><span class="sxs-lookup"><span data-stu-id="a4a08-142">OdbcType</span></span>|<span data-ttu-id="a4a08-143">OracleType</span><span class="sxs-lookup"><span data-stu-id="a4a08-143">OracleType</span></span>|
|-------------------------|------------|---------------|---------------|--------------|----------------|
|<xref:System.Boolean>|<span data-ttu-id="a4a08-144">Logická hodnota</span><span class="sxs-lookup"><span data-stu-id="a4a08-144">Boolean</span></span>|<span data-ttu-id="a4a08-145">40bitového</span><span class="sxs-lookup"><span data-stu-id="a4a08-145">Bit</span></span>|<span data-ttu-id="a4a08-146">Logická hodnota</span><span class="sxs-lookup"><span data-stu-id="a4a08-146">Boolean</span></span>|<span data-ttu-id="a4a08-147">40bitového</span><span class="sxs-lookup"><span data-stu-id="a4a08-147">Bit</span></span>|<span data-ttu-id="a4a08-148">Byte</span><span class="sxs-lookup"><span data-stu-id="a4a08-148">Byte</span></span>|
|<xref:System.Byte>|<span data-ttu-id="a4a08-149">Byte</span><span class="sxs-lookup"><span data-stu-id="a4a08-149">Byte</span></span>|<span data-ttu-id="a4a08-150">TinyInt</span><span class="sxs-lookup"><span data-stu-id="a4a08-150">TinyInt</span></span>|<span data-ttu-id="a4a08-151">UnsignedTinyInt</span><span class="sxs-lookup"><span data-stu-id="a4a08-151">UnsignedTinyInt</span></span>|<span data-ttu-id="a4a08-152">TinyInt</span><span class="sxs-lookup"><span data-stu-id="a4a08-152">TinyInt</span></span>|<span data-ttu-id="a4a08-153">Byte</span><span class="sxs-lookup"><span data-stu-id="a4a08-153">Byte</span></span>|
|<span data-ttu-id="a4a08-154">Byte []</span><span class="sxs-lookup"><span data-stu-id="a4a08-154">byte[]</span></span>|<span data-ttu-id="a4a08-155">Binární</span><span class="sxs-lookup"><span data-stu-id="a4a08-155">Binary</span></span>|<span data-ttu-id="a4a08-156">VarBinary.</span><span class="sxs-lookup"><span data-stu-id="a4a08-156">VarBinary.</span></span> <span data-ttu-id="a4a08-157">Pokud je bajtové pole větší než maximální velikost VarBinary, což je 8000 bajtů, tento implicitní převod selže. Pro Bajtová pole větší než 8000 bajtů nastavte explicitně <xref:System.Data.SqlDbType> .</span><span class="sxs-lookup"><span data-stu-id="a4a08-157">This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="a4a08-158">VarBinary</span><span class="sxs-lookup"><span data-stu-id="a4a08-158">VarBinary</span></span>|<span data-ttu-id="a4a08-159">Binární</span><span class="sxs-lookup"><span data-stu-id="a4a08-159">Binary</span></span>|<span data-ttu-id="a4a08-160">Žádný</span><span class="sxs-lookup"><span data-stu-id="a4a08-160">Raw</span></span>|
|<xref:System.Char>| |<span data-ttu-id="a4a08-161">Odvození od typu <xref:System.Data.SqlDbType> char není podporováno.</span><span class="sxs-lookup"><span data-stu-id="a4a08-161">Inferring a <xref:System.Data.SqlDbType> from char is not supported.</span></span>|<span data-ttu-id="a4a08-162">Char</span><span class="sxs-lookup"><span data-stu-id="a4a08-162">Char</span></span>|<span data-ttu-id="a4a08-163">Char</span><span class="sxs-lookup"><span data-stu-id="a4a08-163">Char</span></span>|<span data-ttu-id="a4a08-164">Byte</span><span class="sxs-lookup"><span data-stu-id="a4a08-164">Byte</span></span>|
|<xref:System.DateTime>|<span data-ttu-id="a4a08-165">DateTime</span><span class="sxs-lookup"><span data-stu-id="a4a08-165">DateTime</span></span>|<span data-ttu-id="a4a08-166">DateTime</span><span class="sxs-lookup"><span data-stu-id="a4a08-166">DateTime</span></span>|<span data-ttu-id="a4a08-167">DBTimeStamp</span><span class="sxs-lookup"><span data-stu-id="a4a08-167">DBTimeStamp</span></span>|<span data-ttu-id="a4a08-168">DateTime</span><span class="sxs-lookup"><span data-stu-id="a4a08-168">DateTime</span></span>|<span data-ttu-id="a4a08-169">DateTime</span><span class="sxs-lookup"><span data-stu-id="a4a08-169">DateTime</span></span>|
|<xref:System.DateTimeOffset>|<span data-ttu-id="a4a08-170">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="a4a08-170">DateTimeOffset</span></span>|<span data-ttu-id="a4a08-171">DateTimeOffset v SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="a4a08-171">DateTimeOffset in SQL Server 2008.</span></span> <span data-ttu-id="a4a08-172">Odvození od typu <xref:System.Data.SqlDbType> DateTimeOffset není podporováno ve verzích SQL Server starších než SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="a4a08-172">Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|||<span data-ttu-id="a4a08-173">DateTime</span><span class="sxs-lookup"><span data-stu-id="a4a08-173">DateTime</span></span>|
|<xref:System.Decimal>|<span data-ttu-id="a4a08-174">Desetinné číslo</span><span class="sxs-lookup"><span data-stu-id="a4a08-174">Decimal</span></span>|<span data-ttu-id="a4a08-175">Desetinné číslo</span><span class="sxs-lookup"><span data-stu-id="a4a08-175">Decimal</span></span>|<span data-ttu-id="a4a08-176">Desetinné číslo</span><span class="sxs-lookup"><span data-stu-id="a4a08-176">Decimal</span></span>|<span data-ttu-id="a4a08-177">Numeric</span><span class="sxs-lookup"><span data-stu-id="a4a08-177">Numeric</span></span>|<span data-ttu-id="a4a08-178">Číslo</span><span class="sxs-lookup"><span data-stu-id="a4a08-178">Number</span></span>|
|<xref:System.Double>|<span data-ttu-id="a4a08-179">Double</span><span class="sxs-lookup"><span data-stu-id="a4a08-179">Double</span></span>|<span data-ttu-id="a4a08-180">Float</span><span class="sxs-lookup"><span data-stu-id="a4a08-180">Float</span></span>|<span data-ttu-id="a4a08-181">Double</span><span class="sxs-lookup"><span data-stu-id="a4a08-181">Double</span></span>|<span data-ttu-id="a4a08-182">Double</span><span class="sxs-lookup"><span data-stu-id="a4a08-182">Double</span></span>|<span data-ttu-id="a4a08-183">Double</span><span class="sxs-lookup"><span data-stu-id="a4a08-183">Double</span></span>|
|<xref:System.Single>|<span data-ttu-id="a4a08-184">Single</span><span class="sxs-lookup"><span data-stu-id="a4a08-184">Single</span></span>|<span data-ttu-id="a4a08-185">Skutečné</span><span class="sxs-lookup"><span data-stu-id="a4a08-185">Real</span></span>|<span data-ttu-id="a4a08-186">Single</span><span class="sxs-lookup"><span data-stu-id="a4a08-186">Single</span></span>|<span data-ttu-id="a4a08-187">Skutečné</span><span class="sxs-lookup"><span data-stu-id="a4a08-187">Real</span></span>|<span data-ttu-id="a4a08-188">Float</span><span class="sxs-lookup"><span data-stu-id="a4a08-188">Float</span></span>|
|<xref:System.Guid>|<span data-ttu-id="a4a08-189">Identifikátor GUID</span><span class="sxs-lookup"><span data-stu-id="a4a08-189">Guid</span></span>|<span data-ttu-id="a4a08-190">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="a4a08-190">UniqueIdentifier</span></span>|<span data-ttu-id="a4a08-191">Identifikátor GUID</span><span class="sxs-lookup"><span data-stu-id="a4a08-191">Guid</span></span>|<span data-ttu-id="a4a08-192">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="a4a08-192">UniqueIdentifier</span></span>|<span data-ttu-id="a4a08-193">Žádný</span><span class="sxs-lookup"><span data-stu-id="a4a08-193">Raw</span></span>|
|<xref:System.Int16>|<span data-ttu-id="a4a08-194">Int16</span><span class="sxs-lookup"><span data-stu-id="a4a08-194">Int16</span></span>|<span data-ttu-id="a4a08-195">SmallInt</span><span class="sxs-lookup"><span data-stu-id="a4a08-195">SmallInt</span></span>|<span data-ttu-id="a4a08-196">SmallInt</span><span class="sxs-lookup"><span data-stu-id="a4a08-196">SmallInt</span></span>|<span data-ttu-id="a4a08-197">SmallInt</span><span class="sxs-lookup"><span data-stu-id="a4a08-197">SmallInt</span></span>|<span data-ttu-id="a4a08-198">Int16</span><span class="sxs-lookup"><span data-stu-id="a4a08-198">Int16</span></span>|
|<xref:System.Int32>|<span data-ttu-id="a4a08-199">Int32</span><span class="sxs-lookup"><span data-stu-id="a4a08-199">Int32</span></span>|<span data-ttu-id="a4a08-200">Int</span><span class="sxs-lookup"><span data-stu-id="a4a08-200">Int</span></span>|<span data-ttu-id="a4a08-201">Int</span><span class="sxs-lookup"><span data-stu-id="a4a08-201">Int</span></span>|<span data-ttu-id="a4a08-202">Int</span><span class="sxs-lookup"><span data-stu-id="a4a08-202">Int</span></span>|<span data-ttu-id="a4a08-203">Int32</span><span class="sxs-lookup"><span data-stu-id="a4a08-203">Int32</span></span>|
|<xref:System.Int64>|<span data-ttu-id="a4a08-204">Int64</span><span class="sxs-lookup"><span data-stu-id="a4a08-204">Int64</span></span>|<span data-ttu-id="a4a08-205">BigInt</span><span class="sxs-lookup"><span data-stu-id="a4a08-205">BigInt</span></span>|<span data-ttu-id="a4a08-206">BigInt</span><span class="sxs-lookup"><span data-stu-id="a4a08-206">BigInt</span></span>|<span data-ttu-id="a4a08-207">BigInt</span><span class="sxs-lookup"><span data-stu-id="a4a08-207">BigInt</span></span>|<span data-ttu-id="a4a08-208">Číslo</span><span class="sxs-lookup"><span data-stu-id="a4a08-208">Number</span></span>|
|<xref:System.Object>|<span data-ttu-id="a4a08-209">Objekt</span><span class="sxs-lookup"><span data-stu-id="a4a08-209">Object</span></span>|<span data-ttu-id="a4a08-210">Variantní</span><span class="sxs-lookup"><span data-stu-id="a4a08-210">Variant</span></span>|<span data-ttu-id="a4a08-211">Variantní</span><span class="sxs-lookup"><span data-stu-id="a4a08-211">Variant</span></span>|<span data-ttu-id="a4a08-212">Odvození OdbcType: z objektu není podporováno.</span><span class="sxs-lookup"><span data-stu-id="a4a08-212">Inferring an OdbcType from Object is not supported.</span></span>|<span data-ttu-id="a4a08-213">Objekt blob</span><span class="sxs-lookup"><span data-stu-id="a4a08-213">Blob</span></span>|
|<xref:System.String>|<span data-ttu-id="a4a08-214">Řetězec</span><span class="sxs-lookup"><span data-stu-id="a4a08-214">String</span></span>|<span data-ttu-id="a4a08-215">NVarChar.</span><span class="sxs-lookup"><span data-stu-id="a4a08-215">NVarChar.</span></span> <span data-ttu-id="a4a08-216">Tento implicitní převod se nezdaří, pokud je řetězec větší než maximální velikost NVarChar, což je 4000 znaků.</span><span class="sxs-lookup"><span data-stu-id="a4a08-216">This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters.</span></span> <span data-ttu-id="a4a08-217">Pro řetězce větší než 4000 znaků explicitně nastavte <xref:System.Data.SqlDbType> .</span><span class="sxs-lookup"><span data-stu-id="a4a08-217">For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="a4a08-218">VarWChar</span><span class="sxs-lookup"><span data-stu-id="a4a08-218">VarWChar</span></span>|<span data-ttu-id="a4a08-219">NVarChar</span><span class="sxs-lookup"><span data-stu-id="a4a08-219">NVarChar</span></span>|<span data-ttu-id="a4a08-220">NVarChar</span><span class="sxs-lookup"><span data-stu-id="a4a08-220">NVarChar</span></span>|
|<xref:System.TimeSpan>|<span data-ttu-id="a4a08-221">Čas</span><span class="sxs-lookup"><span data-stu-id="a4a08-221">Time</span></span>|<span data-ttu-id="a4a08-222">Čas v SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="a4a08-222">Time in SQL Server 2008.</span></span> <span data-ttu-id="a4a08-223">Odvození typu <xref:System.Data.SqlDbType> z TimeSpan není podporováno ve verzích SQL Server starších než SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="a4a08-223">Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="a4a08-224">DBTime</span><span class="sxs-lookup"><span data-stu-id="a4a08-224">DBTime</span></span>|<span data-ttu-id="a4a08-225">Čas</span><span class="sxs-lookup"><span data-stu-id="a4a08-225">Time</span></span>|<span data-ttu-id="a4a08-226">DateTime</span><span class="sxs-lookup"><span data-stu-id="a4a08-226">DateTime</span></span>|
|<xref:System.UInt16>|<span data-ttu-id="a4a08-227">UInt16</span><span class="sxs-lookup"><span data-stu-id="a4a08-227">UInt16</span></span>|<span data-ttu-id="a4a08-228">Odvození <xref:System.Data.SqlDbType> od UInt16 se nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="a4a08-228">Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported.</span></span>|<span data-ttu-id="a4a08-229">UnsignedSmallInt</span><span class="sxs-lookup"><span data-stu-id="a4a08-229">UnsignedSmallInt</span></span>|<span data-ttu-id="a4a08-230">Int</span><span class="sxs-lookup"><span data-stu-id="a4a08-230">Int</span></span>|<span data-ttu-id="a4a08-231">UInt16</span><span class="sxs-lookup"><span data-stu-id="a4a08-231">UInt16</span></span>|
|<xref:System.UInt32>|<span data-ttu-id="a4a08-232">UInt32</span><span class="sxs-lookup"><span data-stu-id="a4a08-232">UInt32</span></span>|<span data-ttu-id="a4a08-233">Odvození z typu <xref:System.Data.SqlDbType> UInt32 není podporováno.</span><span class="sxs-lookup"><span data-stu-id="a4a08-233">Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported.</span></span>|<span data-ttu-id="a4a08-234">UnsignedInt</span><span class="sxs-lookup"><span data-stu-id="a4a08-234">UnsignedInt</span></span>|<span data-ttu-id="a4a08-235">BigInt</span><span class="sxs-lookup"><span data-stu-id="a4a08-235">BigInt</span></span>|<span data-ttu-id="a4a08-236">UInt32</span><span class="sxs-lookup"><span data-stu-id="a4a08-236">UInt32</span></span>|
|<xref:System.UInt64>|<span data-ttu-id="a4a08-237">UInt64</span><span class="sxs-lookup"><span data-stu-id="a4a08-237">UInt64</span></span>|<span data-ttu-id="a4a08-238">Odvození <xref:System.Data.SqlDbType> od UInt64 se nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="a4a08-238">Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported.</span></span>|<span data-ttu-id="a4a08-239">UnsignedBigInt</span><span class="sxs-lookup"><span data-stu-id="a4a08-239">UnsignedBigInt</span></span>|<span data-ttu-id="a4a08-240">Numeric</span><span class="sxs-lookup"><span data-stu-id="a4a08-240">Numeric</span></span>|<span data-ttu-id="a4a08-241">Číslo</span><span class="sxs-lookup"><span data-stu-id="a4a08-241">Number</span></span>|
||<span data-ttu-id="a4a08-242">AnsiString</span><span class="sxs-lookup"><span data-stu-id="a4a08-242">AnsiString</span></span>|<span data-ttu-id="a4a08-243">VarChar</span><span class="sxs-lookup"><span data-stu-id="a4a08-243">VarChar</span></span>|<span data-ttu-id="a4a08-244">VarChar</span><span class="sxs-lookup"><span data-stu-id="a4a08-244">VarChar</span></span>|<span data-ttu-id="a4a08-245">VarChar</span><span class="sxs-lookup"><span data-stu-id="a4a08-245">VarChar</span></span>|<span data-ttu-id="a4a08-246">VarChar</span><span class="sxs-lookup"><span data-stu-id="a4a08-246">VarChar</span></span>|
||<span data-ttu-id="a4a08-247">AnsiStringFixedLength</span><span class="sxs-lookup"><span data-stu-id="a4a08-247">AnsiStringFixedLength</span></span>|<span data-ttu-id="a4a08-248">Char</span><span class="sxs-lookup"><span data-stu-id="a4a08-248">Char</span></span>|<span data-ttu-id="a4a08-249">Char</span><span class="sxs-lookup"><span data-stu-id="a4a08-249">Char</span></span>|<span data-ttu-id="a4a08-250">Char</span><span class="sxs-lookup"><span data-stu-id="a4a08-250">Char</span></span>|<span data-ttu-id="a4a08-251">Char</span><span class="sxs-lookup"><span data-stu-id="a4a08-251">Char</span></span>|
||<span data-ttu-id="a4a08-252">Měna</span><span class="sxs-lookup"><span data-stu-id="a4a08-252">Currency</span></span>|<span data-ttu-id="a4a08-253">Peněžní částka</span><span class="sxs-lookup"><span data-stu-id="a4a08-253">Money</span></span>|<span data-ttu-id="a4a08-254">Měna</span><span class="sxs-lookup"><span data-stu-id="a4a08-254">Currency</span></span>|<span data-ttu-id="a4a08-255">Odvození `OdbcType` od `Currency` není podporováno.</span><span class="sxs-lookup"><span data-stu-id="a4a08-255">Inferring an `OdbcType` from `Currency` is not supported.</span></span>|<span data-ttu-id="a4a08-256">Číslo</span><span class="sxs-lookup"><span data-stu-id="a4a08-256">Number</span></span>|
||<span data-ttu-id="a4a08-257">Datum</span><span class="sxs-lookup"><span data-stu-id="a4a08-257">Date</span></span>|<span data-ttu-id="a4a08-258">Datum v SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="a4a08-258">Date in SQL Server 2008.</span></span> <span data-ttu-id="a4a08-259">Odvození <xref:System.Data.SqlDbType> od data není podporováno ve verzích SQL Server starších než SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="a4a08-259">Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="a4a08-260">DBDate</span><span class="sxs-lookup"><span data-stu-id="a4a08-260">DBDate</span></span>|<span data-ttu-id="a4a08-261">Datum</span><span class="sxs-lookup"><span data-stu-id="a4a08-261">Date</span></span>|<span data-ttu-id="a4a08-262">DateTime</span><span class="sxs-lookup"><span data-stu-id="a4a08-262">DateTime</span></span>|
||<span data-ttu-id="a4a08-263">SByte</span><span class="sxs-lookup"><span data-stu-id="a4a08-263">SByte</span></span>|<span data-ttu-id="a4a08-264">Odvození <xref:System.Data.SqlDbType> od SByte se nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="a4a08-264">Inferring a <xref:System.Data.SqlDbType> from SByte is not supported.</span></span>|<span data-ttu-id="a4a08-265">TinyInt</span><span class="sxs-lookup"><span data-stu-id="a4a08-265">TinyInt</span></span>|<span data-ttu-id="a4a08-266">Odvození `OdbcType` od SByte se nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="a4a08-266">Inferring an `OdbcType` from SByte is not supported.</span></span>|<span data-ttu-id="a4a08-267">SByte</span><span class="sxs-lookup"><span data-stu-id="a4a08-267">SByte</span></span>|
||<span data-ttu-id="a4a08-268">StringFixedLength</span><span class="sxs-lookup"><span data-stu-id="a4a08-268">StringFixedLength</span></span>|<span data-ttu-id="a4a08-269">NChar</span><span class="sxs-lookup"><span data-stu-id="a4a08-269">NChar</span></span>|<span data-ttu-id="a4a08-270">WChar</span><span class="sxs-lookup"><span data-stu-id="a4a08-270">WChar</span></span>|<span data-ttu-id="a4a08-271">NChar</span><span class="sxs-lookup"><span data-stu-id="a4a08-271">NChar</span></span>|<span data-ttu-id="a4a08-272">NChar</span><span class="sxs-lookup"><span data-stu-id="a4a08-272">NChar</span></span>|
||<span data-ttu-id="a4a08-273">Čas</span><span class="sxs-lookup"><span data-stu-id="a4a08-273">Time</span></span>|<span data-ttu-id="a4a08-274">Čas v SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="a4a08-274">Time in SQL Server 2008.</span></span> <span data-ttu-id="a4a08-275">Odvození <xref:System.Data.SqlDbType> od času není podporováno ve verzích SQL Server starších než SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="a4a08-275">Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="a4a08-276">DBTime</span><span class="sxs-lookup"><span data-stu-id="a4a08-276">DBTime</span></span>|<span data-ttu-id="a4a08-277">Čas</span><span class="sxs-lookup"><span data-stu-id="a4a08-277">Time</span></span>|<span data-ttu-id="a4a08-278">DateTime</span><span class="sxs-lookup"><span data-stu-id="a4a08-278">DateTime</span></span>|
||<span data-ttu-id="a4a08-279">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="a4a08-279">VarNumeric</span></span>|<span data-ttu-id="a4a08-280">Odvození <xref:System.Data.SqlDbType> od VarNumeric se nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="a4a08-280">Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported.</span></span>|<span data-ttu-id="a4a08-281">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="a4a08-281">VarNumeric</span></span>|<span data-ttu-id="a4a08-282">Odvození `OdbcType` od VarNumeric se nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="a4a08-282">Inferring an `OdbcType` from VarNumeric is not supported.</span></span>|<span data-ttu-id="a4a08-283">Číslo</span><span class="sxs-lookup"><span data-stu-id="a4a08-283">Number</span></span>|
|<span data-ttu-id="a4a08-284">uživatelsky definovaný typ (objekt s<xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span><span class="sxs-lookup"><span data-stu-id="a4a08-284">user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span></span>|<span data-ttu-id="a4a08-285">Objekt nebo řetězec, v závislosti na poskytovateli (SqlClient vždy vrátí objekt, rozhraní ODBC vždycky vrátí řetězec a zprostředkovatel spravovaných dat OleDb uvidí buď</span><span class="sxs-lookup"><span data-stu-id="a4a08-285">Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either</span></span>|<span data-ttu-id="a4a08-286">SqlDbType. UDT <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> , pokud je k dispozici, jinak varianta</span><span class="sxs-lookup"><span data-stu-id="a4a08-286">SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant</span></span>|<span data-ttu-id="a4a08-287">OleDbType. VarWChar (Pokud je hodnota null) jinak OleDbType. variant.</span><span class="sxs-lookup"><span data-stu-id="a4a08-287">OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.</span></span>|<span data-ttu-id="a4a08-288">OdbcType:. NVarChar</span><span class="sxs-lookup"><span data-stu-id="a4a08-288">OdbcType.NVarChar</span></span>|<span data-ttu-id="a4a08-289">nepodporováno</span><span class="sxs-lookup"><span data-stu-id="a4a08-289">not supported</span></span>|

> [!NOTE]
> <span data-ttu-id="a4a08-290">Převody z typu Decimal na jiné typy jsou zužující převody, které zaokrouhlují desítkovou hodnotu na nejbližší celočíselnou hodnotu směrem nula.</span><span class="sxs-lookup"><span data-stu-id="a4a08-290">Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero.</span></span> <span data-ttu-id="a4a08-291">Pokud výsledek převodu není reprezentovatelné v cílovém typu, <xref:System.OverflowException> je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="a4a08-291">If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.</span></span>

> [!NOTE]
> <span data-ttu-id="a4a08-292">Když odešlete hodnotu parametru s hodnotou null na server, je nutné zadat <xref:System.DBNull> , ne `null` ( `Nothing` v Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="a4a08-292">When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in Visual Basic).</span></span> <span data-ttu-id="a4a08-293">Hodnota null v systému je prázdný objekt, který nemá žádnou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="a4a08-293">The null value in the system is an empty object that has no value.</span></span> <span data-ttu-id="a4a08-294"><xref:System.DBNull>slouží k reprezentaci hodnot null.</span><span class="sxs-lookup"><span data-stu-id="a4a08-294"><xref:System.DBNull> is used to represent null values.</span></span> <span data-ttu-id="a4a08-295">Další informace o hodnotách null databáze naleznete v tématu [zpracování hodnot null](./sql/handling-null-values.md).</span><span class="sxs-lookup"><span data-stu-id="a4a08-295">For more information about database nulls, see [Handling Null Values](./sql/handling-null-values.md).</span></span>

## <a name="deriving-parameter-information"></a><span data-ttu-id="a4a08-296">Odvození informací o parametrech</span><span class="sxs-lookup"><span data-stu-id="a4a08-296">Deriving parameter information</span></span>

<span data-ttu-id="a4a08-297">Parametry lze také odvodit z uložené procedury pomocí `DbCommandBuilder` třídy.</span><span class="sxs-lookup"><span data-stu-id="a4a08-297">Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class.</span></span> <span data-ttu-id="a4a08-298">`SqlCommandBuilder` `OleDbCommandBuilder` Třídy i poskytují statickou metodu, `DeriveParameters` která automaticky naplní kolekci Parameters pro objekt příkazu, který používá informace o parametrech z uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="a4a08-298">Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure.</span></span> <span data-ttu-id="a4a08-299">Všimněte si, že `DeriveParameters` přepíše všechny existující informace o parametrech pro příkaz.</span><span class="sxs-lookup"><span data-stu-id="a4a08-299">Note that `DeriveParameters` overwrites any existing parameter information for the command.</span></span>

> [!NOTE]
> <span data-ttu-id="a4a08-300">Vyloučení informací o parametrech má vliv na výkon, protože ke zdroji dat vyžaduje další zpáteční cestu, aby se tyto informace načetly.</span><span class="sxs-lookup"><span data-stu-id="a4a08-300">Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information.</span></span> <span data-ttu-id="a4a08-301">Pokud jsou informace o parametrech známy v době návrhu, můžete zvýšit výkon aplikace nastavením parametrů explicitně.</span><span class="sxs-lookup"><span data-stu-id="a4a08-301">If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.</span></span>

<span data-ttu-id="a4a08-302">Další informace najdete v tématu [generování příkazů pomocí CommandBuilders](generating-commands-with-commandbuilders.md).</span><span class="sxs-lookup"><span data-stu-id="a4a08-302">For more information, see [Generating Commands with CommandBuilders](generating-commands-with-commandbuilders.md).</span></span>

## <a name="using-parameters-with-a-sqlcommand-and-a-stored-procedure"></a><span data-ttu-id="a4a08-303">Použití parametrů s metodami SqlCommand a uloženou procedurou</span><span class="sxs-lookup"><span data-stu-id="a4a08-303">Using parameters with a SqlCommand and a stored procedure</span></span>

<span data-ttu-id="a4a08-304">Uložené procedury nabízejí mnoho výhod v aplikacích řízených daty.</span><span class="sxs-lookup"><span data-stu-id="a4a08-304">Stored procedures offer many advantages in data-driven applications.</span></span> <span data-ttu-id="a4a08-305">Pomocí uložených procedur je možné databázové operace zapouzdřit do jediného příkazu, optimalizace pro zajištění nejlepšího výkonu a vylepšení s vyšším zabezpečením.</span><span class="sxs-lookup"><span data-stu-id="a4a08-305">By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security.</span></span> <span data-ttu-id="a4a08-306">I když uloženou proceduru lze volat předáním názvu uložené procedury následovaný argumenty parametru jako příkaz jazyka SQL, pomocí <xref:System.Data.Common.DbCommand.Parameters%2A> kolekce <xref:System.Data.Common.DbCommand> objektu ADO.NET můžete explicitně definovat parametry uložené procedury a získat přístup k výstupním parametrům a návratovým hodnotám.</span><span class="sxs-lookup"><span data-stu-id="a4a08-306">Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the ADO.NET <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.</span></span>

> [!NOTE]
> <span data-ttu-id="a4a08-307">Parametrizované příkazy jsou spouštěny na serveru pomocí příkazu `sp_executesql,` , který umožňuje opakované použití plánu dotazů.</span><span class="sxs-lookup"><span data-stu-id="a4a08-307">Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse.</span></span> <span data-ttu-id="a4a08-308">Místní kurzory nebo proměnné v `sp_executesql` dávce nejsou viditelné pro dávku, která volá `sp_executesql` .</span><span class="sxs-lookup"><span data-stu-id="a4a08-308">Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`.</span></span> <span data-ttu-id="a4a08-309">Změny v kontextu databáze poslední pouze na konci `sp_executesql` příkazu.</span><span class="sxs-lookup"><span data-stu-id="a4a08-309">Changes in database context last only to the end of the `sp_executesql` statement.</span></span> <span data-ttu-id="a4a08-310">Další informace naleznete v tématu [sp_executesql (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="a4a08-310">For more information, see [sp_executesql (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql).</span></span>

<span data-ttu-id="a4a08-311">Při použití parametrů s a <xref:System.Data.SqlClient.SqlCommand> ke spuštění uložené procedury SQL Server musí názvy parametrů přidaných do <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> kolekce odpovídat názvům značek parametrů v uložené proceduře.</span><span class="sxs-lookup"><span data-stu-id="a4a08-311">When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure.</span></span> <span data-ttu-id="a4a08-312">.NET Framework Zprostředkovatel dat pro SQL Server nepodporuje zástupné znaky otazníku (?) pro předávání parametrů příkazu SQL nebo uložené proceduře.</span><span class="sxs-lookup"><span data-stu-id="a4a08-312">The .NET Framework Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="a4a08-313">Zpracovává parametry v uložené proceduře jako pojmenované parametry a hledá vyhovující značky parametrů.</span><span class="sxs-lookup"><span data-stu-id="a4a08-313">It treats parameters in the stored procedure as named parameters and searches for matching parameter markers.</span></span> <span data-ttu-id="a4a08-314">Například `CustOrderHist` uložená procedura je definována pomocí parametru s názvem `@CustomerID` .</span><span class="sxs-lookup"><span data-stu-id="a4a08-314">For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`.</span></span> <span data-ttu-id="a4a08-315">Když váš kód provede uloženou proceduru, musí také použít parametr s názvem `@CustomerID` .</span><span class="sxs-lookup"><span data-stu-id="a4a08-315">When your code executes the stored procedure, it must also use a parameter named `@CustomerID`.</span></span>

```sql
CREATE PROCEDURE dbo.CustOrderHist @CustomerID varchar(5)
```

### <a name="example"></a><span data-ttu-id="a4a08-316">Příklad</span><span class="sxs-lookup"><span data-stu-id="a4a08-316">Example</span></span>

<span data-ttu-id="a4a08-317">Tento příklad ukazuje, jak volat SQL Server uloženou proceduru v `Northwind` ukázkové databázi.</span><span class="sxs-lookup"><span data-stu-id="a4a08-317">This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database.</span></span> <span data-ttu-id="a4a08-318">Název uložené procedury je `dbo.SalesByCategory` a má vstupní parametr s názvem `@CategoryName` s datovým typem `nvarchar(15)` .</span><span class="sxs-lookup"><span data-stu-id="a4a08-318">The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`.</span></span> <span data-ttu-id="a4a08-319">Kód vytvoří nový <xref:System.Data.SqlClient.SqlConnection> uvnitř bloku using, aby připojení bylo uvolněno při ukončení procedury.</span><span class="sxs-lookup"><span data-stu-id="a4a08-319">The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends.</span></span> <span data-ttu-id="a4a08-320"><xref:System.Data.SqlClient.SqlCommand>Objekty a <xref:System.Data.SqlClient.SqlParameter> jsou vytvořeny a jejich vlastnosti nastaveny.</span><span class="sxs-lookup"><span data-stu-id="a4a08-320">The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set.</span></span> <span data-ttu-id="a4a08-321"><xref:System.Data.SqlClient.SqlDataReader>Provede `SqlCommand` a vrátí sadu výsledků z uložené procedury a zobrazí výstup v okně konzoly.</span><span class="sxs-lookup"><span data-stu-id="a4a08-321">A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window.</span></span>

> [!NOTE]
> <span data-ttu-id="a4a08-322">Namísto vytváření `SqlCommand` a `SqlParameter` nastavování objektů a pak nastavení vlastností v samostatných příkazech můžete místo toho použít jeden z přetížených konstruktorů k nastavení více vlastností v jednom příkazu.</span><span class="sxs-lookup"><span data-stu-id="a4a08-322">Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.</span></span>

[!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]
[!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]

## <a name="using-parameters-with-an-oledbcommand-or-odbccommand"></a><span data-ttu-id="a4a08-323">Použití parametrů s OleDbCommand nebo OdbcCommand</span><span class="sxs-lookup"><span data-stu-id="a4a08-323">Using parameters with an OleDbCommand or OdbcCommand</span></span>

<span data-ttu-id="a4a08-324">Při použití parametrů s <xref:System.Data.OleDb.OleDbCommand> nebo se <xref:System.Data.Odbc.OdbcCommand> musí pořadí parametrů přidaných do `Parameters` kolekce shodovat s pořadím parametrů definovaných v uložené proceduře.</span><span class="sxs-lookup"><span data-stu-id="a4a08-324">When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure.</span></span> <span data-ttu-id="a4a08-325">.NET Framework Zprostředkovatel dat pro OLE DB a .NET Framework Zprostředkovatel dat pro rozhraní ODBC považovat parametry v uložené proceduře jako zástupné symboly a hodnoty parametrů v daném pořadí.</span><span class="sxs-lookup"><span data-stu-id="a4a08-325">The .NET Framework Data Provider for OLE DB and .NET Framework Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order.</span></span> <span data-ttu-id="a4a08-326">Kromě toho musí být parametry návratové hodnoty prvními parametry přidanými do `Parameters` kolekce.</span><span class="sxs-lookup"><span data-stu-id="a4a08-326">In addition, return value parameters must be the first parameters added to the `Parameters` collection.</span></span>

<span data-ttu-id="a4a08-327">Zprostředkovatel dat .NET Framework pro OLE DB a .NET Framework Zprostředkovatel dat pro rozhraní ODBC nepodporují pojmenované parametry pro předávání parametrů příkazu SQL nebo uložené proceduře.</span><span class="sxs-lookup"><span data-stu-id="a4a08-327">The .NET Framework Data Provider for OLE DB and .NET Framework Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="a4a08-328">V takovém případě je nutné použít zástupný znak otazník (?), jak je uvedeno v následujícím příkladu.</span><span class="sxs-lookup"><span data-stu-id="a4a08-328">In this case, you must use the question mark (?) placeholder, as in the following example.</span></span>

```sql
SELECT * FROM Customers WHERE CustomerID = ?
```

<span data-ttu-id="a4a08-329">V důsledku toho je pořadí, ve kterém `Parameter` jsou objekty přidány do `Parameters` kolekce, musí přímo odpovídat pozici?</span><span class="sxs-lookup"><span data-stu-id="a4a08-329">As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ?</span></span> <span data-ttu-id="a4a08-330">zástupný symbol pro parametr</span><span class="sxs-lookup"><span data-stu-id="a4a08-330">placeholder for the parameter.</span></span>

### <a name="oledb-example"></a><span data-ttu-id="a4a08-331">Příklad OleDb</span><span class="sxs-lookup"><span data-stu-id="a4a08-331">OleDb Example</span></span>

```vb
Dim command As OleDbCommand = New OleDbCommand( _
  "SampleProc", connection)
command.CommandType = CommandType.StoredProcedure

Dim parameter As OleDbParameter = command.Parameters.Add( _
  "RETURN_VALUE", OleDbType.Integer)
parameter.Direction = ParameterDirection.ReturnValue

parameter = command.Parameters.Add( _
  "@InputParm", OleDbType.VarChar, 12)
parameter.Value = "Sample Value"

parameter = command.Parameters.Add( _
  "@OutputParm", OleDbType.VarChar, 28)
parameter.Direction = ParameterDirection.Output
```

```csharp
OleDbCommand command = new OleDbCommand("SampleProc", connection);
command.CommandType = CommandType.StoredProcedure;

OleDbParameter parameter = command.Parameters.Add(
  "RETURN_VALUE", OleDbType.Integer);
parameter.Direction = ParameterDirection.ReturnValue;

parameter = command.Parameters.Add(
  "@InputParm", OleDbType.VarChar, 12);
parameter.Value = "Sample Value";

parameter = command.Parameters.Add(
  "@OutputParm", OleDbType.VarChar, 28);
parameter.Direction = ParameterDirection.Output;
```

## <a name="odbc-example"></a><span data-ttu-id="a4a08-332">Příklad ODBC</span><span class="sxs-lookup"><span data-stu-id="a4a08-332">Odbc Example</span></span>

```vb
Dim command As OdbcCommand = New OdbcCommand( _
  "{ ? = CALL SampleProc(?, ?) }", connection)
command.CommandType = CommandType.StoredProcedure

Dim parameter As OdbcParameter = command.Parameters.Add("RETURN_VALUE", OdbcType.Int)
parameter.Direction = ParameterDirection.ReturnValue

parameter = command.Parameters.Add( _
  "@InputParm", OdbcType.VarChar, 12)
parameter.Value = "Sample Value"

parameter = command.Parameters.Add( _
  "@OutputParm", OdbcType.VarChar, 28)
parameter.Direction = ParameterDirection.Output
```

```csharp
OdbcCommand command = new OdbcCommand( _
  "{ ? = CALL SampleProc(?, ?) }", connection);
command.CommandType = CommandType.StoredProcedure;

OdbcParameter parameter = command.Parameters.Add( _
  "RETURN_VALUE", OdbcType.Int);
parameter.Direction = ParameterDirection.ReturnValue;

parameter = command.Parameters.Add( _
  "@InputParm", OdbcType.VarChar, 12);
parameter.Value = "Sample Value";

parameter = command.Parameters.Add( _
  "@OutputParm", OdbcType.VarChar, 28);
parameter.Direction = ParameterDirection.Output;
```

## <a name="see-also"></a><span data-ttu-id="a4a08-333">Viz také</span><span class="sxs-lookup"><span data-stu-id="a4a08-333">See also</span></span>

- [<span data-ttu-id="a4a08-334">Příkazy a parametry</span><span class="sxs-lookup"><span data-stu-id="a4a08-334">Commands and Parameters</span></span>](commands-and-parameters.md)
- [<span data-ttu-id="a4a08-335">Parametry adaptéru dat</span><span class="sxs-lookup"><span data-stu-id="a4a08-335">DataAdapter Parameters</span></span>](dataadapter-parameters.md)
- [<span data-ttu-id="a4a08-336">Mapování datového typu v ADO.NET</span><span class="sxs-lookup"><span data-stu-id="a4a08-336">Data Type Mappings in ADO.NET</span></span>](data-type-mappings-in-ado-net.md)
- [<span data-ttu-id="a4a08-337">Přehled ADO.NET</span><span class="sxs-lookup"><span data-stu-id="a4a08-337">ADO.NET Overview</span></span>](ado-net-overview.md)
