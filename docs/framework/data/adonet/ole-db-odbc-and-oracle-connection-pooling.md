---
title: Sdružování připojení OLE DB, ODBC a Oracle
ms.date: 03/30/2017
ms.assetid: 2bd83b1e-3ea9-43c4-bade-d9cdb9bbbb04
ms.openlocfilehash: 58ea5aa54a0f6acbc8d2400dd04eeba9ff498055
ms.sourcegitcommit: 8c99457955fc31785b36b3330c4ab6ce7984a7ba
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 12/29/2019
ms.locfileid: "75545039"
---
# <a name="ole-db-odbc-and-oracle-connection-pooling"></a><span data-ttu-id="406ea-102">Sdružování připojení OLE DB, ODBC a Oracle</span><span class="sxs-lookup"><span data-stu-id="406ea-102">OLE DB, ODBC, and Oracle connection pooling</span></span>

<span data-ttu-id="406ea-103">Připojení sdružování můžou významně zlepšit výkon a škálovatelnost vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="406ea-103">Pooling connections can significantly enhance the performance and scalability of your application.</span></span> <span data-ttu-id="406ea-104">Tato část popisuje sdružování připojení pro poskytovatele .NET Framework dat pro OLE DB, ODBC a Oracle.</span><span class="sxs-lookup"><span data-stu-id="406ea-104">This section discusses connection pooling for the .NET Framework data providers for OLE DB, ODBC, and Oracle.</span></span>

## <a name="oledb"></a><span data-ttu-id="406ea-105">OleDb</span><span class="sxs-lookup"><span data-stu-id="406ea-105">OleDb</span></span>

<span data-ttu-id="406ea-106">Zprostředkovatel dat .NET Framework pro OLE DB automaticky poolují připojení pomocí sdružování relací OLE DB.</span><span class="sxs-lookup"><span data-stu-id="406ea-106">The .NET Framework Data Provider for OLE DB automatically pools connections using OLE DB session pooling.</span></span> <span data-ttu-id="406ea-107">Argumenty připojovacího řetězce se dají použít k povolení nebo zakázání OLE DBch služeb, včetně sdružování.</span><span class="sxs-lookup"><span data-stu-id="406ea-107">Connection string arguments can be used to enable or disable OLE DB services including pooling.</span></span> <span data-ttu-id="406ea-108">Například následující připojovací řetězec zakáže OLE DB sdružování relací a automatické zařazení transakce.</span><span class="sxs-lookup"><span data-stu-id="406ea-108">For example, the following connection string disables OLE DB session pooling and automatic transaction enlistment.</span></span>

```csharp
Provider=SQLOLEDB;OLE DB Services=-4;Data Source=localhost;Integrated Security=SSPI;
```

 <span data-ttu-id="406ea-109">Doporučujeme, abyste připojení vždy zavřeli nebo odstranili, až ho dokončíte, aby se mohlo vrátit připojení ke fondu.</span><span class="sxs-lookup"><span data-stu-id="406ea-109">We recommend that you always close or dispose of a connection when you are finished using it in order to return the connection to the pool.</span></span> <span data-ttu-id="406ea-110">Připojení, která nejsou explicitně uzavřena, se nemusí vrátit do fondu.</span><span class="sxs-lookup"><span data-stu-id="406ea-110">Connections that are not explicitly closed may not get returned to the pool.</span></span> <span data-ttu-id="406ea-111">Například připojení, které se odchází z oboru, ale které nebylo explicitně uzavřeno, bude vráceno do fondu připojení pouze v případě, že byla dosažena maximální velikost fondu a připojení je stále platné.</span><span class="sxs-lookup"><span data-stu-id="406ea-111">For example, a connection that has gone out of scope but that has not been explicitly closed will only be returned to the connection pool if the maximum pool size has been reached and the connection is still valid.</span></span>

 <span data-ttu-id="406ea-112">Další informace o OLE DB relace nebo sdružování prostředků a o tom, jak zakázat sdružování přepsáním výchozích nastavení služby OLE DB poskytovatele, najdete v [příručce pro programátory OLE DB](https://docs.microsoft.com/previous-versions/windows/desktop/ms713643(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="406ea-112">For more information about OLE DB session or resource pooling, as well as how to disable pooling by overriding OLE DB provider service defaults, see the [OLE DB Programmer's Guide](https://docs.microsoft.com/previous-versions/windows/desktop/ms713643(v=vs.85)).</span></span>

## <a name="odbc"></a><span data-ttu-id="406ea-113">ODBC</span><span class="sxs-lookup"><span data-stu-id="406ea-113">ODBC</span></span>
 <span data-ttu-id="406ea-114">Sdružování připojení pro .NET Framework Zprostředkovatel dat pro rozhraní ODBC spravuje správce ovladačů ODBC, který se používá pro připojení a není ovlivněn .NET Framework Zprostředkovatel dat pro rozhraní ODBC.</span><span class="sxs-lookup"><span data-stu-id="406ea-114">Connection pooling for the .NET Framework Data Provider for ODBC is managed by the ODBC Driver Manager that is used for the connection, and is not affected by the .NET Framework Data Provider for ODBC.</span></span>

 <span data-ttu-id="406ea-115">Chcete-li povolit nebo zakázat sdružování připojení, otevřete **Správce zdrojů dat ODBC** ve složce Nástroje pro správu v Ovládacích panelech.</span><span class="sxs-lookup"><span data-stu-id="406ea-115">To enable or disable connection pooling, open **ODBC Data Source Administrator** in the Administrative Tools folder of Control Panel.</span></span> <span data-ttu-id="406ea-116">Karta **sdružování připojení** umožňuje zadat parametry sdružování připojení pro každý nainstalovaný ovladač ODBC.</span><span class="sxs-lookup"><span data-stu-id="406ea-116">The **Connection Pooling** tab allows you to specify connection pooling parameters for each ODBC driver installed.</span></span> <span data-ttu-id="406ea-117">Změny sdružování připojení pro určitý ovladač ODBC mají vliv na všechny aplikace, které používají daný ovladač ODBC.</span><span class="sxs-lookup"><span data-stu-id="406ea-117">Connection pooling changes for a specific ODBC driver affect all applications that use that ODBC driver.</span></span>

## <a name="oracleclient"></a><span data-ttu-id="406ea-118">OracleClient</span><span class="sxs-lookup"><span data-stu-id="406ea-118">OracleClient</span></span>
 <span data-ttu-id="406ea-119">Zprostředkovatel dat .NET Framework pro Oracle poskytuje pro klientskou aplikaci ADO.NET automatické sdružování připojení.</span><span class="sxs-lookup"><span data-stu-id="406ea-119">The .NET Framework Data Provider for Oracle provides connection pooling automatically for your ADO.NET client application.</span></span> <span data-ttu-id="406ea-120">Můžete také dodat několik modifikátorů připojovacího řetězce pro řízení chování sdružování připojení (viz "řízení sdružování připojení pomocí klíčových slov připojovacího řetězce" dále v tomto tématu).</span><span class="sxs-lookup"><span data-stu-id="406ea-120">You can also supply several connection string modifiers to control connection pooling behavior (see "Controlling Connection Pooling with Connection String Keywords," later in this topic).</span></span>

### <a name="create-and-assign-pools"></a><span data-ttu-id="406ea-121">Vytváření a přiřazování fondů</span><span class="sxs-lookup"><span data-stu-id="406ea-121">Create and assign pools</span></span>
 <span data-ttu-id="406ea-122">Po otevření připojení se vytvoří fond připojení založený na přesně odpovídajícím algoritmu, který přidruží fond k připojovacímu řetězci v připojení.</span><span class="sxs-lookup"><span data-stu-id="406ea-122">When a connection is opened, a connection pool is created based on an exact matching algorithm that associates the pool with the connection string in the connection.</span></span> <span data-ttu-id="406ea-123">Každý fond připojení je přidružený k jedinečnému připojovacímu řetězci.</span><span class="sxs-lookup"><span data-stu-id="406ea-123">Each connection pool is associated with a distinct connection string.</span></span> <span data-ttu-id="406ea-124">Pokud se při otevření nového připojení nejedná o přesný řetězec odpovídající existujícímu fondu, vytvoří se nový fond.</span><span class="sxs-lookup"><span data-stu-id="406ea-124">When a new connection is opened, if the connection string is not an exact match to an existing pool, a new pool is created.</span></span>

 <span data-ttu-id="406ea-125">Po vytvoření fondy připojení nebudou zničeny, dokud se neukončí aktivní proces.</span><span class="sxs-lookup"><span data-stu-id="406ea-125">Once created, connection pools are not destroyed until the active process ends.</span></span> <span data-ttu-id="406ea-126">Údržba neaktivních nebo prázdných fondů používá hodně systémových prostředků.</span><span class="sxs-lookup"><span data-stu-id="406ea-126">Maintaining inactive or empty pools uses very few system resources.</span></span>

### <a name="connection-addition"></a><span data-ttu-id="406ea-127">Přidání připojení</span><span class="sxs-lookup"><span data-stu-id="406ea-127">Connection Addition</span></span>
 <span data-ttu-id="406ea-128">U každého jedinečného připojovacího řetězce se vytvoří fond připojení.</span><span class="sxs-lookup"><span data-stu-id="406ea-128">A connection pool is created for each unique connection string.</span></span> <span data-ttu-id="406ea-129">Při vytvoření fondu se vytvoří víc objektů připojení a přidají se do fondu, aby se splnil minimální požadavek na velikost fondu.</span><span class="sxs-lookup"><span data-stu-id="406ea-129">When a pool is created, multiple connection objects are created and added to the pool so that the minimum pool size requirement is satisfied.</span></span> <span data-ttu-id="406ea-130">Připojení se do fondu přidají podle potřeby až do maximální velikosti fondu.</span><span class="sxs-lookup"><span data-stu-id="406ea-130">Connections are added to the pool as needed, up to the maximum pool size.</span></span>

 <span data-ttu-id="406ea-131">Pokud je požadován objekt <xref:System.Data.OracleClient.OracleConnection>, získá se z fondu, pokud je k dispozici použitelné připojení.</span><span class="sxs-lookup"><span data-stu-id="406ea-131">When an <xref:System.Data.OracleClient.OracleConnection> object is requested, it is obtained from the pool if a usable connection is available.</span></span> <span data-ttu-id="406ea-132">Aby bylo možné připojení použít, musí být aktuálně nepoužitelné, mít odpovídající kontext transakce nebo nemusí být přidruženo k žádnému kontextu transakce a musí obsahovat platný odkaz na server.</span><span class="sxs-lookup"><span data-stu-id="406ea-132">To be usable, the connection must currently be unused, have a matching transaction context or not be associated with any transaction context, and have a valid link to the server.</span></span>

 <span data-ttu-id="406ea-133">Pokud byla dosažena maximální velikost fondu a není k dispozici žádné použitelné připojení, je požadavek zařazen do fronty.</span><span class="sxs-lookup"><span data-stu-id="406ea-133">If the maximum pool size has been reached and no usable connection is available, the request is queued.</span></span> <span data-ttu-id="406ea-134">Pooler připojení splňuje tyto požadavky tím, že je znovu přidělí, protože se uvolní do fondu.</span><span class="sxs-lookup"><span data-stu-id="406ea-134">The connection pooler satisfies these requests by reallocating connections as they are released back into the pool.</span></span> <span data-ttu-id="406ea-135">Připojení se uvolní zpátky do fondu, když se zavřou nebo odstraněly.</span><span class="sxs-lookup"><span data-stu-id="406ea-135">Connections are released back into the pool when they are closed or disposed.</span></span>

### <a name="connection-removal"></a><span data-ttu-id="406ea-136">Odebrání připojení</span><span class="sxs-lookup"><span data-stu-id="406ea-136">Connection Removal</span></span>
 <span data-ttu-id="406ea-137">Připojení Pooler Odebere připojení z fondu poté, co bylo delší dobu nečinné, nebo pokud Pooler zjistí, že spojení se serverem bylo přerušeno.</span><span class="sxs-lookup"><span data-stu-id="406ea-137">The connection pooler removes a connection from the pool after it has been idle for an extended period of time or if the pooler detects that the connection with the server has been severed.</span></span> <span data-ttu-id="406ea-138">Tato možnost se dá zjistit až po pokusu o komunikaci se serverem.</span><span class="sxs-lookup"><span data-stu-id="406ea-138">This can be detected only after attempting to communicate with the server.</span></span> <span data-ttu-id="406ea-139">Pokud se zjistí připojení, které už není připojené k serveru, je označený jako neplatný.</span><span class="sxs-lookup"><span data-stu-id="406ea-139">If a connection is found that is no longer connected to the server, it is marked as invalid.</span></span> <span data-ttu-id="406ea-140">Připojení Pooler pravidelně prohledává fondy připojení, které hledají objekty, které byly vydány do fondu, a jsou označeny jako neplatné.</span><span class="sxs-lookup"><span data-stu-id="406ea-140">The connection pooler periodically scans connection pools looking for objects that have been released to the pool and are marked as invalid.</span></span> <span data-ttu-id="406ea-141">Tato připojení se pak trvale odeberou.</span><span class="sxs-lookup"><span data-stu-id="406ea-141">These connections are then permanently removed.</span></span>

 <span data-ttu-id="406ea-142">Pokud připojení existuje na serveru, který zmizel, může být toto připojení vykresleno z fondu, pokud Pooler připojení nerozpoznalo vážné připojení a označil ho jako neplatný.</span><span class="sxs-lookup"><span data-stu-id="406ea-142">If a connection exists to a server that has disappeared, this connection can be drawn from the pool if the connection pooler has not detected the severed connection and marked it as invalid.</span></span> <span data-ttu-id="406ea-143">Pokud k tomu dojde, je vygenerována výjimka.</span><span class="sxs-lookup"><span data-stu-id="406ea-143">When this occurs, an exception is generated.</span></span> <span data-ttu-id="406ea-144">Je však nutné připojení ukončit, aby bylo možné ho uvolnit zpátky do fondu.</span><span class="sxs-lookup"><span data-stu-id="406ea-144">However, you must still close the connection in order to release it back into the pool.</span></span>

 <span data-ttu-id="406ea-145">Nevolejte `Close` ani `Dispose` na `Connection`, `DataReader`nebo jiném spravovaném objektu v metodě `Finalize` vaší třídy.</span><span class="sxs-lookup"><span data-stu-id="406ea-145">Do not call `Close` or `Dispose` on a `Connection`, a `DataReader`, or any other managed object in the `Finalize` method of your class.</span></span> <span data-ttu-id="406ea-146">V finalizační metodě pouze uvolní nespravované prostředky, které vaše třída vlastní.</span><span class="sxs-lookup"><span data-stu-id="406ea-146">In a finalizer, only release unmanaged resources that your class owns directly.</span></span> <span data-ttu-id="406ea-147">Pokud vaše třída nevlastní žádné nespravované prostředky, nezahrnujte metodu `Finalize` do definice třídy.</span><span class="sxs-lookup"><span data-stu-id="406ea-147">If your class does not own any unmanaged resources, do not include a `Finalize` method in your class definition.</span></span> <span data-ttu-id="406ea-148">Další informace najdete v tématu [uvolňování paměti](../../../standard/garbage-collection/index.md).</span><span class="sxs-lookup"><span data-stu-id="406ea-148">For more information, see [Garbage Collection](../../../standard/garbage-collection/index.md).</span></span>

### <a name="transaction-support"></a><span data-ttu-id="406ea-149">Podpora transakcí</span><span class="sxs-lookup"><span data-stu-id="406ea-149">Transaction Support</span></span>
 <span data-ttu-id="406ea-150">Připojení jsou vykreslena z fondu a přiřazena na základě kontextu transakce.</span><span class="sxs-lookup"><span data-stu-id="406ea-150">Connections are drawn from the pool and assigned based on transaction context.</span></span> <span data-ttu-id="406ea-151">Kontext žádajícího vlákna a přiřazeného připojení se musí shodovat.</span><span class="sxs-lookup"><span data-stu-id="406ea-151">The context of the requesting thread and the assigned connection must match.</span></span> <span data-ttu-id="406ea-152">Proto je každý fond připojení rozdělen na připojení bez přidruženého kontextu transakce a do *N* dílčích dělení, které obsahují připojení s konkrétním kontextem transakce.</span><span class="sxs-lookup"><span data-stu-id="406ea-152">Therefore, each connection pool is subdivided into connections with no associated transaction context and into *N* subdivisions that each contain connections with a particular transaction context.</span></span>

 <span data-ttu-id="406ea-153">Když je připojení ukončeno, je uvolněno zpátky do fondu a do příslušného dílčího dělení na základě jeho transakčního kontextu.</span><span class="sxs-lookup"><span data-stu-id="406ea-153">When a connection is closed, it is released back into the pool and into the appropriate subdivision based on its transaction context.</span></span> <span data-ttu-id="406ea-154">Proto můžete připojení zavřít bez vygenerování chyby, i když distribuovaná transakce stále čeká na vyřízení.</span><span class="sxs-lookup"><span data-stu-id="406ea-154">Therefore, you can close the connection without generating an error, even though a distributed transaction is still pending.</span></span> <span data-ttu-id="406ea-155">Díky tomu můžete distribuovanou transakci potvrdit nebo přerušit v pozdějším čase.</span><span class="sxs-lookup"><span data-stu-id="406ea-155">This allows you to commit or abort the distributed transaction at a later time.</span></span>

### <a name="control-connection-pooling-with-connection-string-keywords"></a><span data-ttu-id="406ea-156">Řízení sdružování připojení pomocí klíčových slov připojovacích řetězců</span><span class="sxs-lookup"><span data-stu-id="406ea-156">Control Connection Pooling with Connection String Keywords</span></span>
 <span data-ttu-id="406ea-157">Vlastnost <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> objektu <xref:System.Data.OracleClient.OracleConnection> podporuje páry klíč/hodnota připojovacího řetězce, které lze použít k úpravě chování logiky sdružování připojení.</span><span class="sxs-lookup"><span data-stu-id="406ea-157">The <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> property of the <xref:System.Data.OracleClient.OracleConnection> object supports connection string key/value pairs that can be used to adjust the behavior of the connection pooling logic.</span></span>

 <span data-ttu-id="406ea-158">Následující tabulka popisuje <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> hodnoty, které můžete použít k úpravě chování sdružování připojení.</span><span class="sxs-lookup"><span data-stu-id="406ea-158">The following table describes the <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> values you can use to adjust connection pooling behavior.</span></span>

|<span data-ttu-id="406ea-159">Name</span><span class="sxs-lookup"><span data-stu-id="406ea-159">Name</span></span>|<span data-ttu-id="406ea-160">Výchozí</span><span class="sxs-lookup"><span data-stu-id="406ea-160">Default</span></span>|<span data-ttu-id="406ea-161">Popis</span><span class="sxs-lookup"><span data-stu-id="406ea-161">Description</span></span>|
|----------|-------------|-----------------|
|`Connection Lifetime`|<span data-ttu-id="406ea-162">0</span><span class="sxs-lookup"><span data-stu-id="406ea-162">0</span></span>|<span data-ttu-id="406ea-163">Při vrácení připojení do fondu se jeho čas vytvoření porovná s aktuálním časem a připojení je zničeno, pokud časový rozsah (v sekundách) překračuje hodnotu zadanou v `Connection Lifetime`.</span><span class="sxs-lookup"><span data-stu-id="406ea-163">When a connection is returned to the pool, its creation time is compared with the current time, and the connection is destroyed if that time span (in seconds) exceeds the value specified by `Connection Lifetime`.</span></span> <span data-ttu-id="406ea-164">To je užitečné v clusterovaných konfiguracích, aby vynutilo vyrovnávání zatížení mezi běžícím serverem a serverem, který je právě online.</span><span class="sxs-lookup"><span data-stu-id="406ea-164">This is useful in clustered configurations to force load balancing between a running server and a server just brought online.</span></span><br /><br /> <span data-ttu-id="406ea-165">Hodnota nula (0) způsobí maximální časový limit připojení ve fondu.</span><span class="sxs-lookup"><span data-stu-id="406ea-165">A value of zero (0) will cause pooled connections to have the maximum time-out.</span></span>|
|`Enlist`|<span data-ttu-id="406ea-166">podmínka</span><span class="sxs-lookup"><span data-stu-id="406ea-166">'true'</span></span>|<span data-ttu-id="406ea-167">Když `true`, Pooler automaticky zařadí připojení v kontextu aktuálního transakce vlákna vytváření, pokud existuje kontext transakce.</span><span class="sxs-lookup"><span data-stu-id="406ea-167">When `true`, the pooler automatically enlists the connection in the current transaction context of the creation thread if a transaction context exists.</span></span>|
|`Max Pool Size`|<span data-ttu-id="406ea-168">100</span><span class="sxs-lookup"><span data-stu-id="406ea-168">100</span></span>|<span data-ttu-id="406ea-169">Maximální počet připojení povolených ve fondu.</span><span class="sxs-lookup"><span data-stu-id="406ea-169">The maximum number of connections allowed in the pool.</span></span>|
|`Min Pool Size`|<span data-ttu-id="406ea-170">0</span><span class="sxs-lookup"><span data-stu-id="406ea-170">0</span></span>|<span data-ttu-id="406ea-171">Minimální počet připojení udržovaných ve fondu.</span><span class="sxs-lookup"><span data-stu-id="406ea-171">The minimum number of connections maintained in the pool.</span></span>|
|`Pooling`|<span data-ttu-id="406ea-172">podmínka</span><span class="sxs-lookup"><span data-stu-id="406ea-172">'true'</span></span>|<span data-ttu-id="406ea-173">Když `true`, připojení se vykreslí z příslušného fondu nebo v případě potřeby se vytvoří a přidá do příslušného fondu.</span><span class="sxs-lookup"><span data-stu-id="406ea-173">When `true`, the connection is drawn from the appropriate pool, or if necessary, created and added to the appropriate pool.</span></span>|

## <a name="see-also"></a><span data-ttu-id="406ea-174">Viz také:</span><span class="sxs-lookup"><span data-stu-id="406ea-174">See also</span></span>

- [<span data-ttu-id="406ea-175">Sdružování připojení</span><span class="sxs-lookup"><span data-stu-id="406ea-175">Connection Pooling</span></span>](connection-pooling.md)
- [<span data-ttu-id="406ea-176">Čítače výkonu</span><span class="sxs-lookup"><span data-stu-id="406ea-176">Performance Counters</span></span>](performance-counters.md)
- [<span data-ttu-id="406ea-177">Přehled ADO.NET</span><span class="sxs-lookup"><span data-stu-id="406ea-177">ADO.NET Overview</span></span>](ado-net-overview.md)
