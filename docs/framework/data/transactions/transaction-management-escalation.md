---
title: Eskalace správy transakcí
description: Přečtěte si o eskalaci správy transakcí v rozhraní .NET, což je proces migrace transakce z komponent jednoho správce transakcí do jiné.
ms.date: 03/30/2017
ms.assetid: 1e96331e-31b6-4272-bbbd-29ed1e110460
ms.openlocfilehash: a0b70f4be0f041be95b02537e06f9ec19a9b6183
ms.sourcegitcommit: 6219b1e1feccb16d88656444210fed3297f5611e
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/22/2020
ms.locfileid: "85141654"
---
# <a name="transaction-management-escalation"></a><span data-ttu-id="8bfc0-103">Eskalace správy transakcí</span><span class="sxs-lookup"><span data-stu-id="8bfc0-103">Transaction Management Escalation</span></span>
<span data-ttu-id="8bfc0-104">Windows je hostitelem sadu služeb a moduly, které společně tvoří transakcí správce.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-104">Windows hosts a set of services and modules that together constitute a transaction manager.</span></span> <span data-ttu-id="8bfc0-105">Transakce řízení eskalace popisuje proces migrace transakcí z jednoho z komponenty správce transakcí.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-105">Transaction management escalation describes the process of migrating a transaction from one of the transaction manager's components to another.</span></span>  
  
 <span data-ttu-id="8bfc0-106"><xref:System.Transactions>zahrnuje komponentu správce transakcí, která koordinuje transakci zahrnující maximálně jeden trvalý prostředek nebo více těkavých prostředků.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-106"><xref:System.Transactions> includes a transaction manager component that coordinates a transaction involving at most, a single durable resource or multiple volatile resources.</span></span> <span data-ttu-id="8bfc0-107">Vzhledem k tomu, že správce transakcí se používá pouze volání uvnitř aplikační domény, bude vrácen nejlepší výkon.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-107">Because the transaction manager uses only intra-application domain calls, it yields the best performance.</span></span> <span data-ttu-id="8bfc0-108">Vývojáři nemusí přímo spolupracovat se správcem transakcí.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-108">Developers need not interact with the transaction manager directly.</span></span> <span data-ttu-id="8bfc0-109">Místo toho je poskytována běžné infrastruktury, který definuje rozhraní, běžné chování a pomocné třídy <xref:System.Transactions> oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-109">Instead, a common infrastructure that defines interfaces, common behavior, and helper classes is provided by the <xref:System.Transactions> namespace.</span></span>  
  
 <span data-ttu-id="8bfc0-110">Pokud chcete transakci uvést do objektu v jiné doméně aplikace (včetně hranic mezi procesy a počítači) na stejném počítači, <xref:System.Transactions> infrastruktura automaticky předává transakci, která má být spravována službou Microsoft DTC (Distributed Transaction Coordinator) (MSDTC).</span><span class="sxs-lookup"><span data-stu-id="8bfc0-110">When you want to provide the transaction to an object in another application domain (including across process and machine boundaries) on the same computer, the <xref:System.Transactions> infrastructure automatically escalates the transaction to be managed by the Microsoft Distributed Transaction Coordinator (MSDTC).</span></span> <span data-ttu-id="8bfc0-111">Eskalace také dochází v případě zařazení jiného správce prostředků trvalý.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-111">The escalation also occurs if you enlist another durable resource manager.</span></span> <span data-ttu-id="8bfc0-112">Když eskalován, transakce zůstane spravovaných ve stavu zvýšenými až do jeho dokončení.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-112">When escalated, the transaction remains managed in its elevated state until its completion.</span></span>  
  
 <span data-ttu-id="8bfc0-113">Mezi <xref:System.Transactions> transakce a transakce MSDTC, je zprostředkovatel druh transakce, které jsou k dispozici prostřednictvím možné jedné fáze zařazení (PSPE).</span><span class="sxs-lookup"><span data-stu-id="8bfc0-113">Between the <xref:System.Transactions> transaction and MSDTC transaction, there is an intermediary type of transaction that is made available through the Promotable Single Phase Enlistment (PSPE).</span></span> <span data-ttu-id="8bfc0-114">PSPE je jiný důležité mechanismus v <xref:System.Transactions> pro optimalizaci výkonu.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-114">PSPE is another important mechanism in <xref:System.Transactions> for performance optimization.</span></span> <span data-ttu-id="8bfc0-115">Umožňuje vzdálený trvalý prostředek umístěný v různých aplikační domény, procesu nebo počítače se účastnit programu <xref:System.Transactions> transakce, aniž by ji chcete-li být rozšířena na transakci MSDTC.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-115">It allows a remote durable resource, located in a different application domain, process or computer, to participate in a <xref:System.Transactions> transaction without causing it to be escalated to an MSDTC transaction.</span></span> <span data-ttu-id="8bfc0-116">Další informace o PSPE najdete v tématu [zařazení prostředků jako účastníků v transakci](enlisting-resources-as-participants-in-a-transaction.md).</span><span class="sxs-lookup"><span data-stu-id="8bfc0-116">For more information about PSPE, see [Enlisting Resources as Participants in a Transaction](enlisting-resources-as-participants-in-a-transaction.md).</span></span>  
  
## <a name="how-escalation-is-initiated"></a><span data-ttu-id="8bfc0-117">Jak zahájit eskalaci</span><span class="sxs-lookup"><span data-stu-id="8bfc0-117">How Escalation is Initiated</span></span>  
 <span data-ttu-id="8bfc0-118">Eskalace transakce snižuje výkon, protože příkaz MSDTC nachází v samostatném procesu a escalating transakcí MSDTC výsledků u odesílaných v rámci procesu.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-118">Transaction escalation reduces performance because the MSDTC resides in a separate process, and escalating a transaction to the MSDTC results in messages being sent across process.</span></span> <span data-ttu-id="8bfc0-119">Chcete-li zvýšit výkon, měli byste zpozdit nebo vyhnout eskalaci MSDTC; Proto potřebujete znát, jak a kdy je možné zahájit eskalaci.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-119">To improve performance, you should delay or avoid escalation to MSDTC; thus, you need to know how and when the escalation is initiated.</span></span>  
  
 <span data-ttu-id="8bfc0-120">Dokud <xref:System.Transactions> infrastruktury zpracovává těkavých materiály a maximálně jeden trvalý prostředek, který podporuje jednofázové oznámení, transakce zůstává ve vlastnictví <xref:System.Transactions> infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-120">As long as the <xref:System.Transactions> infrastructure handles volatile resources and at most one durable resource that supports single-phase notifications, the transaction remains in the ownership of the <xref:System.Transactions> infrastructure.</span></span> <span data-ttu-id="8bfc0-121">Správce transakcí využije pouze na tyto prostředky, že živé ve stejné doméně aplikace a pro které protokolování (zápis výsledek transakce na disk) není povinný.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-121">The transaction manager avails itself only to those resources that live in the same application domain and for which logging (writing the transaction outcome to disk) is not required.</span></span> <span data-ttu-id="8bfc0-122">Eskalaci, která způsobí, že <xref:System.Transactions> infrastruktury přenos vlastnictví transakce do MSDTC se stane, když:</span><span class="sxs-lookup"><span data-stu-id="8bfc0-122">An escalation that results in the <xref:System.Transactions> infrastructure transferring the ownership of the transaction to MSDTC happens when:</span></span>  
  
- <span data-ttu-id="8bfc0-123">Nejméně jeden trvalý prostředek, který nepodporuje jednofázové oznámení je uveden v transakci.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-123">At least one durable resource that does not support single-phase notifications is enlisted in the transaction.</span></span>  
  
- <span data-ttu-id="8bfc0-124">Nejméně dva trvalý prostředky, které podporují jednofázové oznámení jsou v transakci zapsán.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-124">At least two durable resources that support single-phase notifications are enlisted in the transaction.</span></span> <span data-ttu-id="8bfc0-125">Například zařazení jednoho spojení s SQL Server 2005 nezpůsobí povýšení transakce.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-125">For example, enlisting a single connection with SQL Server 2005 does not cause a transaction to be promoted.</span></span> <span data-ttu-id="8bfc0-126">Kdykoli ale otevřete druhé připojení k databázi SQL Server 2005, která způsobila zařazení databáze, <xref:System.Transactions> infrastruktura zjistí, že se jedná o druhý trvalý prostředek v transakci, a předává ho do transakce MSDTC.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-126">However, whenever you open a second connection to a SQL Server 2005 database causing the database to enlist, the <xref:System.Transactions> infrastructure detects that it is the second durable resource in the transaction, and escalates it to an MSDTC transaction.</span></span>  
  
- <span data-ttu-id="8bfc0-127">Požadavek na "zařazování" různé aplikační domény nebo jiný proces transakce je vyvolána.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-127">A request to "marshal" the transaction to a different application domain or different process is invoked.</span></span> <span data-ttu-id="8bfc0-128">Můžete například serializace objektu transakce v rámci hranice domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-128">For example, the serialization of the transaction object across an application domain boundary.</span></span> <span data-ttu-id="8bfc0-129">Objekt transakce je zařazené hodnotou, což znamená, že jakýkoliv pokus o ji předejte hranice domény aplikace (i ve stejném procesu) má za následek serializace objektu transakce.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-129">The transaction object is marshaled-by-value, meaning that any attempt to pass it across an application domain boundary (even in the same process) results in serialization of the transaction object.</span></span> <span data-ttu-id="8bfc0-130">Objekty transakce můžete předat tím, že zavoláte na vzdálené metody, která přebírá <xref:System.Transactions.Transaction> jako parametr nebo vám může pokusu o přístup k vzdálené transakční obsluhovaná komponenty.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-130">You can pass the transaction objects by making a call on a remote method that takes a <xref:System.Transactions.Transaction> as a parameter or you can try to access a remote transactional-serviced component.</span></span> <span data-ttu-id="8bfc0-131">Toto serializuje objekt transakce a má za následek eskalaci jako při serializován transakcí v rámci domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-131">This serializes the transaction object and results in an escalation, as when a transaction is serialized across an application domain.</span></span> <span data-ttu-id="8bfc0-132">Že distribuovaná a místní správce transakcí již není dostatečné.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-132">It is being distributed and the local transaction manager is no longer adequate.</span></span>  
  
 <span data-ttu-id="8bfc0-133">V následující tabulce jsou uvedeny všechny výjimky, které mohou být vyvolány během eskalace.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-133">The following table lists all the possible exceptions that can be thrown during escalation.</span></span>  
  
|<span data-ttu-id="8bfc0-134">Typ výjimky</span><span class="sxs-lookup"><span data-stu-id="8bfc0-134">Exception type</span></span>|<span data-ttu-id="8bfc0-135">Podmínka</span><span class="sxs-lookup"><span data-stu-id="8bfc0-135">Condition</span></span>|  
|--------------------|---------------|  
|<xref:System.InvalidOperationException>|<span data-ttu-id="8bfc0-136">Pokus o eskalovat transakce se rovná úroveň izolace <xref:System.Transactions.IsolationLevel.Snapshot>.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-136">An attempt to escalate a transaction with isolation level equal to <xref:System.Transactions.IsolationLevel.Snapshot>.</span></span>|  
|<xref:System.Transactions.TransactionAbortedException>|<span data-ttu-id="8bfc0-137">Správce transakcí je nefunkční.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-137">The transaction manager is down.</span></span>|  
|<xref:System.Transactions.TransactionException>|<span data-ttu-id="8bfc0-138">Eskalace nezdaří a aplikace je přerušeno.</span><span class="sxs-lookup"><span data-stu-id="8bfc0-138">The escalation fails and the application is aborted.</span></span>|
