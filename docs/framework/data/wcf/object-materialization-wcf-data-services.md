---
title: Materializace objektů (WCF Data Services)
ms.date: 03/30/2017
helpviewer_keywords:
- WCF Data Services, client library
- WCF Data Services, querying
ms.assetid: f0dbf7b0-0292-4e31-9ae4-b98288336dc1
ms.openlocfilehash: 7a2b201e5690c4304e663e9429c54f377e05f556
ms.sourcegitcommit: 79a2d6a07ba4ed08979819666a0ee6927bbf1b01
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/28/2019
ms.locfileid: "74568907"
---
# <a name="object-materialization-wcf-data-services"></a><span data-ttu-id="ad552-102">Materializace objektů (WCF Data Services)</span><span class="sxs-lookup"><span data-stu-id="ad552-102">Object Materialization (WCF Data Services)</span></span>

<span data-ttu-id="ad552-103">Při použití dialogového okna **Přidat odkaz na službu** ke využívání informačního kanálu protokolu OData (Open Data Protocol) v klientské aplikaci založené na .NET Framework se pro každý typ entity v datovém modelu, který je vystavený informačním kanálem, vygenerují ekvivalentní datové třídy.</span><span class="sxs-lookup"><span data-stu-id="ad552-103">When you use the **Add Service Reference** dialog to consume an Open Data Protocol (OData) feed in a .NET Framework-based client application, equivalent data classes are generated for each entity type in the data model exposed by the feed.</span></span> <span data-ttu-id="ad552-104">Další informace najdete v tématu [generování klientské knihovny datové služby](generating-the-data-service-client-library-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="ad552-104">For more information, see [Generating the Data Service Client Library](generating-the-data-service-client-library-wcf-data-services.md).</span></span> <span data-ttu-id="ad552-105">Data entity, která jsou vrácena dotazem, jsou vyhodnocena jako instance jedné z těchto generovaných tříd služby data a klienta.</span><span class="sxs-lookup"><span data-stu-id="ad552-105">Entity data that is returned by a query is materialized into an instance of one of these generated client data service classes.</span></span> <span data-ttu-id="ad552-106">Informace o možnostech sloučení a rozlišení identity pro sledované objekty najdete v tématu [Správa kontextu datové služby](managing-the-data-service-context-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="ad552-106">For information about merge options and identity resolution for tracked objects, see [Managing the Data Service Context](managing-the-data-service-context-wcf-data-services.md).</span></span>

<span data-ttu-id="ad552-107">WCF Data Services také umožňuje definovat vlastní třídy klientské datové služby místo použití datových tříd generovaných nástrojem.</span><span class="sxs-lookup"><span data-stu-id="ad552-107">WCF Data Services also enables you to define your own client data service classes rather than using the tool-generated data classes.</span></span> <span data-ttu-id="ad552-108">To vám umožňuje používat vlastní datové třídy, označované také jako "obyčejné, staré" objekty CLR (POCO) datové třídy.</span><span class="sxs-lookup"><span data-stu-id="ad552-108">This enables you to use your own data classes, also known as "plain-old CLR object" (POCO) data classes.</span></span> <span data-ttu-id="ad552-109">Při použití těchto typů vlastních datových tříd byste měli mít atribut datové třídy buď <xref:System.Data.Services.Common.DataServiceKeyAttribute>, nebo <xref:System.Data.Services.Common.DataServiceEntityAttribute> a zajistěte, aby názvy typů v klientovi odpovídaly názvům typu v datovém modelu datové služby.</span><span class="sxs-lookup"><span data-stu-id="ad552-109">When using these types of custom data classes, you should attribute the data class with either <xref:System.Data.Services.Common.DataServiceKeyAttribute> or <xref:System.Data.Services.Common.DataServiceEntityAttribute> and ensure that type names on the client match type names in the data model of the data service.</span></span>

<span data-ttu-id="ad552-110">Poté, co Knihovna obdrží zprávu odpovědi na dotaz, materializuje vrácená data z datového kanálu OData do instancí tříd klientských dat služby, které jsou typu dotazu.</span><span class="sxs-lookup"><span data-stu-id="ad552-110">After the library receives the query response message, it materializes the returned data from the OData feed into instances of client data service classes that are of the type of the query.</span></span> <span data-ttu-id="ad552-111">Obecný proces pro vyhodnocování těchto objektů je následující:</span><span class="sxs-lookup"><span data-stu-id="ad552-111">The general process for materializing these objects is as follows:</span></span>

1. <span data-ttu-id="ad552-112">Klientská knihovna přečte serializovaný typ z prvku `entry` v kanálu zpráv odpovědi a pokusí se vytvořit novou instanci správného typu, a to jedním z následujících způsobů:</span><span class="sxs-lookup"><span data-stu-id="ad552-112">The client library reads the serialized type from the `entry` element in the response message feed and attempts to create a new instance of the correct type, in one of the following ways:</span></span>

    - <span data-ttu-id="ad552-113">Když typ deklarovaný v informačním kanálu má stejný název jako typ <xref:System.Data.Services.Client.DataServiceQuery%601>, vytvoří se nová instance tohoto typu pomocí prázdného konstruktoru.</span><span class="sxs-lookup"><span data-stu-id="ad552-113">When the type declared in the feed has the same name as the type of the <xref:System.Data.Services.Client.DataServiceQuery%601>, a new instance of this type is created by using the empty constructor.</span></span>

    - <span data-ttu-id="ad552-114">Když typ deklarovaný v informačním kanálu má stejný název jako typ odvozený od typu <xref:System.Data.Services.Client.DataServiceQuery%601>, vytvoří se nová instance tohoto odvozeného typu pomocí prázdného konstruktoru.</span><span class="sxs-lookup"><span data-stu-id="ad552-114">When the type declared in the feed has the same name as a type that is derived from the type of the <xref:System.Data.Services.Client.DataServiceQuery%601>, a new instance of this derived type is created by using the empty constructor.</span></span>

    - <span data-ttu-id="ad552-115">Pokud typ deklarovaný v informačním kanálu nelze spárovat s typem <xref:System.Data.Services.Client.DataServiceQuery%601> ani žádné odvozené typy, je vytvořena nová instance typu dotazované pomocí prázdného konstruktoru.</span><span class="sxs-lookup"><span data-stu-id="ad552-115">When the type declared in the feed cannot be matched to the type of the <xref:System.Data.Services.Client.DataServiceQuery%601> or any derived types, a new instance of the queried type is created by using the empty constructor.</span></span>

    - <span data-ttu-id="ad552-116">Pokud je nastavena vlastnost <xref:System.Data.Services.Client.DataServiceContext.ResolveType%2A>, je zavolán poskytnutý delegát, který přepíše výchozí mapování typu založeného na názvu a vytvoří novou instanci typu vráceného <xref:System.Func%602> je namísto toho vytvořen.</span><span class="sxs-lookup"><span data-stu-id="ad552-116">When the <xref:System.Data.Services.Client.DataServiceContext.ResolveType%2A> property is set, the supplied delegate is called to override the default name-based type mapping and a new instance of the type returned by the <xref:System.Func%602> is created instead.</span></span> <span data-ttu-id="ad552-117">Pokud tento delegát vrátí hodnotu null, je místo toho vytvořena nová instance typu dotazu.</span><span class="sxs-lookup"><span data-stu-id="ad552-117">If this delegate returns a null value, a new instance of the queried type is created instead.</span></span> <span data-ttu-id="ad552-118">Pro podporu scénářů dědičnosti může být nutné přepsat výchozí mapování názvu typu na základě názvu.</span><span class="sxs-lookup"><span data-stu-id="ad552-118">It may be required to override the default name-based type name mapping to support inheritance scenarios.</span></span>

2. <span data-ttu-id="ad552-119">Klientská knihovna přečte hodnotu identifikátoru URI z prvku `id` `entry`, což je hodnota identity entity.</span><span class="sxs-lookup"><span data-stu-id="ad552-119">The client library reads the URI value from the `id` element of the `entry`, which is the identity value of the entity.</span></span> <span data-ttu-id="ad552-120">Není-li použita hodnota <xref:System.Data.Services.Client.DataServiceContext.MergeOption%2A> <xref:System.Data.Services.Client.MergeOption.NoTracking>, je použita hodnota identity ke sledování objektu v <xref:System.Data.Services.Client.DataServiceContext>.</span><span class="sxs-lookup"><span data-stu-id="ad552-120">Unless a <xref:System.Data.Services.Client.DataServiceContext.MergeOption%2A> value of <xref:System.Data.Services.Client.MergeOption.NoTracking> is used, the identity value is used to track the object in the <xref:System.Data.Services.Client.DataServiceContext>.</span></span> <span data-ttu-id="ad552-121">Hodnota identity se také používá k zajištění, že se vytvoří jenom jedna instance entity, a to i v případě, že se entita vrátí v odpovědi na dotaz víckrát.</span><span class="sxs-lookup"><span data-stu-id="ad552-121">The identity value is also used to guarantee that only a single entity instance is created, even when an entity is returned multiple times in the query response.</span></span>

3. <span data-ttu-id="ad552-122">Klientská knihovna přečte z položky informačního kanálu vlastnosti a nastaví odpovídající vlastnosti nově vytvořeného objektu.</span><span class="sxs-lookup"><span data-stu-id="ad552-122">The client library reads properties from the feed entry and set the corresponding properties on the newly created object.</span></span> <span data-ttu-id="ad552-123">Pokud objekt, který má stejnou hodnotu identity, již v <xref:System.Data.Services.Client.DataServiceContext>dojde, vlastnosti jsou nastaveny na základě <xref:System.Data.Services.Client.MergeOption> nastavení <xref:System.Data.Services.Client.DataServiceContext>.</span><span class="sxs-lookup"><span data-stu-id="ad552-123">When an object that has the same identity value already occurs in the <xref:System.Data.Services.Client.DataServiceContext>, the properties are set based on the <xref:System.Data.Services.Client.MergeOption> setting of the <xref:System.Data.Services.Client.DataServiceContext>.</span></span> <span data-ttu-id="ad552-124">Odpověď může obsahovat hodnoty vlastností, pro které se v typu klienta nevyskytují odpovídající vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="ad552-124">The response might contain property values for which a corresponding property does not occur in the client type.</span></span> <span data-ttu-id="ad552-125">Pokud k tomu dojde, akce závisí na hodnotě vlastnosti <xref:System.Data.Services.Client.DataServiceContext.IgnoreMissingProperties%2A> <xref:System.Data.Services.Client.DataServiceContext>.</span><span class="sxs-lookup"><span data-stu-id="ad552-125">When this occurs, the action depends on the value of the <xref:System.Data.Services.Client.DataServiceContext.IgnoreMissingProperties%2A> property of the <xref:System.Data.Services.Client.DataServiceContext>.</span></span> <span data-ttu-id="ad552-126">Pokud je tato vlastnost nastavena na `true`, chybějící vlastnost je ignorována.</span><span class="sxs-lookup"><span data-stu-id="ad552-126">When this property is set to `true`, the missing property is ignored.</span></span> <span data-ttu-id="ad552-127">V opačném případě je vyvolána chyba.</span><span class="sxs-lookup"><span data-stu-id="ad552-127">Otherwise, an error is raised.</span></span> <span data-ttu-id="ad552-128">Vlastnosti se nastaví takto:</span><span class="sxs-lookup"><span data-stu-id="ad552-128">Properties are set as follows:</span></span>

    - <span data-ttu-id="ad552-129">Skalární vlastnosti jsou nastaveny na odpovídající hodnotu v záznamu zprávy s odpovědí.</span><span class="sxs-lookup"><span data-stu-id="ad552-129">Scalar properties are set to the corresponding value in the entry in the response message.</span></span>

    - <span data-ttu-id="ad552-130">Komplexní vlastnosti jsou nastaveny na novou instanci komplexního typu, která je nastavena pomocí vlastností komplexního typu z odpovědi.</span><span class="sxs-lookup"><span data-stu-id="ad552-130">Complex properties are set to a new complex type instance, which are set with the properties of the complex type from the response.</span></span>

    - <span data-ttu-id="ad552-131">Navigační vlastnosti, které vracejí kolekci souvisejících entit, jsou nastaveny na novou nebo existující instanci <xref:System.Collections.Generic.ICollection%601>, kde `T` je typ související entity.</span><span class="sxs-lookup"><span data-stu-id="ad552-131">Navigation properties that return a collection of related entities are set to a new or existing instance of <xref:System.Collections.Generic.ICollection%601>, where `T` is the type of the related entity.</span></span> <span data-ttu-id="ad552-132">Tato kolekce je prázdná, pokud nebyly do <xref:System.Data.Services.Client.DataServiceContext>načteny související objekty.</span><span class="sxs-lookup"><span data-stu-id="ad552-132">This collection is empty unless the related objects have been loaded into the <xref:System.Data.Services.Client.DataServiceContext>.</span></span> <span data-ttu-id="ad552-133">Další informace najdete v tématu [načítání odloženého obsahu](loading-deferred-content-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="ad552-133">For more information, see [Loading Deferred Content](loading-deferred-content-wcf-data-services.md).</span></span>

      > [!NOTE]
      > <span data-ttu-id="ad552-134">Pokud vygenerované klientské datové třídy podporují datovou vazbu, vlastnosti navigace vrátí instance <xref:System.Data.Services.Client.DataServiceCollection%601> třídy místo toho.</span><span class="sxs-lookup"><span data-stu-id="ad552-134">When the generated client data classes support data binding, navigation properties return instances of the <xref:System.Data.Services.Client.DataServiceCollection%601> class instead.</span></span> <span data-ttu-id="ad552-135">Další informace najdete v tématu [vázání dat na ovládací prvky](binding-data-to-controls-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="ad552-135">For more information, see [Binding Data to Controls](binding-data-to-controls-wcf-data-services.md).</span></span>

4. <span data-ttu-id="ad552-136">Vyvolá se událost <xref:System.Data.Services.Client.DataServiceContext.ReadingEntity>.</span><span class="sxs-lookup"><span data-stu-id="ad552-136">The <xref:System.Data.Services.Client.DataServiceContext.ReadingEntity> event is raised.</span></span>

5. <span data-ttu-id="ad552-137">Klientská knihovna připojí objekt k <xref:System.Data.Services.Client.DataServiceContext>.</span><span class="sxs-lookup"><span data-stu-id="ad552-137">The client library attaches the object to the <xref:System.Data.Services.Client.DataServiceContext>.</span></span> <span data-ttu-id="ad552-138">Objekt není připojen, je-li <xref:System.Data.Services.Client.MergeOption> <xref:System.Data.Services.Client.MergeOption.NoTracking>.</span><span class="sxs-lookup"><span data-stu-id="ad552-138">The object is not attached when the <xref:System.Data.Services.Client.MergeOption> is <xref:System.Data.Services.Client.MergeOption.NoTracking>.</span></span>

## <a name="see-also"></a><span data-ttu-id="ad552-139">Viz také:</span><span class="sxs-lookup"><span data-stu-id="ad552-139">See also</span></span>

- [<span data-ttu-id="ad552-140">Dotazování v datové službě</span><span class="sxs-lookup"><span data-stu-id="ad552-140">Querying the Data Service</span></span>](querying-the-data-service-wcf-data-services.md)
- [<span data-ttu-id="ad552-141">Projekce dotazů</span><span class="sxs-lookup"><span data-stu-id="ad552-141">Query Projections</span></span>](query-projections-wcf-data-services.md)
