---
title: Zprostředkovatel streamování (WCF Data Services)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, providers
- WCF Data Services, binary data
- streaming data provider [WCF Data Services]
- WCF Data Services, streams
ms.assetid: f0978fe4-5f9f-42aa-a5c2-df395d7c9495
ms.openlocfilehash: 543d095c88670024a53fad7c865883ecaab1c6e0
ms.sourcegitcommit: a885cc8c3e444ca6471348893d5373c6e9e49a47
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 09/07/2018
ms.locfileid: "44046837"
---
# <a name="streaming-provider-wcf-data-services"></a><span data-ttu-id="3c5e4-102">Zprostředkovatel streamování (WCF Data Services)</span><span class="sxs-lookup"><span data-stu-id="3c5e4-102">Streaming Provider (WCF Data Services)</span></span>
<span data-ttu-id="3c5e4-103">Datové služby může vystavit data binárního rozsáhlého objektu.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-103">A data service can expose large object binary data.</span></span> <span data-ttu-id="3c5e4-104">Tento binární data mohou představovat video a audiostreamů, obrázky, soubory dokumentů nebo jiných typů médií binární.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-104">This binary data might represent video and audio streams, images, document files, or other types of binary media.</span></span> <span data-ttu-id="3c5e4-105">Pokud entita v datovém modelu obsahuje jeden nebo více binárních vlastností, datové služby vrátí tato binární data kódováním base-64 uvnitř položky v odpovědi informačního kanálu.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-105">When an entity in the data model includes one or more binary properties, the data service returns this binary data encoded as base-64 inside the entry in the response feed.</span></span> <span data-ttu-id="3c5e4-106">Protože načítání a serializaci velkému objemu binárních dat tímto způsobem může ovlivnit výkon, [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)] definuje mechanismus pro načítání binárních dat, které jsou nezávislé na entitu, do které patří.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-106">Because loading and serializing large binary data in this manner can affect performance, the [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)] defines a mechanism for retrieving binary data independent of the entity to which it belongs.</span></span> <span data-ttu-id="3c5e4-107">Toho dosahuje oddělením binární data z entity do jednoho nebo více datových proudů.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-107">This is accomplished by separating the binary data from the entity into one or more data streams.</span></span>  
  
-   <span data-ttu-id="3c5e4-108">Mediální zdroj - binární data, která patří do entity, jako jsou videa, zvuk, image nebo jiný typ média datový proud prostředků.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-108">Media resource - binary data that belongs to an entity, such as a video, audio, image or other type of media resource stream.</span></span>  
  
-   <span data-ttu-id="3c5e4-109">Odkaz na médium položky - entita, která obsahuje odkaz na datový proud prostředků souvisejících média.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-109">Media link entry - an entity that has a reference to a related media resource stream.</span></span>  
  
 <span data-ttu-id="3c5e4-110">S [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)], definovat datový proud binárních prostředků díky implementaci zprostředkovatele streamovaná data.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-110">With [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)], you define a binary resource stream by implementing a streaming data provider.</span></span> <span data-ttu-id="3c5e4-111">Streamování implementace poskytovatele poskytuje datové služby s datový proud prostředků média přidružený k konkrétní entity jako <xref:System.IO.Stream> objektu.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-111">The streaming provider implementation supplies the data service with the media resource stream associated with a specific entity as an <xref:System.IO.Stream> object.</span></span> <span data-ttu-id="3c5e4-112">Tato implementace umožňuje datové službě dovoluje přijímají a vrací zdroje médií prostřednictvím protokolu HTTP jako binární datové proudy zadaného typu MIME.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-112">This implementation enables the data service to accept and return media resources over HTTP as binary data streams of a specified MIME type.</span></span>  
  
 <span data-ttu-id="3c5e4-113">Konfigurace datové služby podporovat datový proud binárních dat vyžaduje následující kroky:</span><span class="sxs-lookup"><span data-stu-id="3c5e4-113">Configuring a data service to support the streaming of binary data requires the following steps:</span></span>  
  
1.  <span data-ttu-id="3c5e4-114">Atribut jeden nebo více entit v datovém modelu, jak položkou odkazu na média.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-114">Attribute one or more entities in the data model as a media link entry.</span></span> <span data-ttu-id="3c5e4-115">Tyto entity by neměl obsahovat binární data, která mají Streamovat.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-115">These entities should not include the binary data to be streamed.</span></span> <span data-ttu-id="3c5e4-116">Žádné binární vlastnosti entity jsou vždy vrátí v položce jako kódování base-64 binární.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-116">Any binary properties of an entity are always returned in the entry as base-64 encoded binary.</span></span>  
  
2.  <span data-ttu-id="3c5e4-117">Implementujte rozhraní T:System.Data.Services.Providers.IDataServiceStreamProvider.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-117">Implement the T:System.Data.Services.Providers.IDataServiceStreamProvider interface.</span></span>  
  
3.  <span data-ttu-id="3c5e4-118">Definování datové služby, který implementuje <xref:System.IServiceProvider> rozhraní.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-118">Define a data service that implements the <xref:System.IServiceProvider> interface.</span></span> <span data-ttu-id="3c5e4-119">Služba používá data <xref:System.IServiceProvider.GetService%2A> implementace pro přístup k streamování implementace poskytovatele dat.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-119">The data service uses the <xref:System.IServiceProvider.GetService%2A> implementation to access the streaming data provider implementation.</span></span> <span data-ttu-id="3c5e4-120">Tato metoda vrátí odpovídající streamování implementace poskytovatele.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-120">This method returns the appropriate streaming provider implementation.</span></span>  
  
4.  <span data-ttu-id="3c5e4-121">Povolte datové proudy velké zprávy v konfiguraci webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-121">Enable large message streams in the Web application configuration.</span></span>  
  
5.  <span data-ttu-id="3c5e4-122">Povolení přístupu k binární prostředky na serveru nebo ve zdroji dat.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-122">Enable access to binary resources on the server or in a data source.</span></span>  
  
 <span data-ttu-id="3c5e4-123">Příklady v tomto tématu jsou založené na vzorku služba pro streamování fotek, která je podrobně popsané v příspěvku [datové služby streamování poskytovatele řady: implementace poskytovatele datových proudů (část 1)](https://go.microsoft.com/fwlink/?LinkID=198989).</span><span class="sxs-lookup"><span data-stu-id="3c5e4-123">The examples in this topic are based on a sample streaming photo service, which is discussed in depth in the post [Data Services Streaming Provider Series: Implementing a Streaming Provider (Part 1)](https://go.microsoft.com/fwlink/?LinkID=198989).</span></span> <span data-ttu-id="3c5e4-124">Zdrojový kód pro tuto službu ukázka je k dispozici na [streamování fotek ukázková Data pro službu stránky](https://go.microsoft.com/fwlink/?LinkID=198988) Galerie kódu MSDN.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-124">The source code for this sample service is available on the [Streaming Photo Data Service Sample page](https://go.microsoft.com/fwlink/?LinkID=198988) on MSDN Code Gallery.</span></span>  
  
## <a name="defining-a-media-link-entry-in-the-data-model"></a><span data-ttu-id="3c5e4-125">Definování položku Media Link Entry v datovém modelu</span><span class="sxs-lookup"><span data-stu-id="3c5e4-125">Defining a Media Link Entry in the Data Model</span></span>  
 <span data-ttu-id="3c5e4-126">Zprostředkovatel zdroje dat určuje způsob, jakým, že entita je definován jako položku media link entry v datovém modelu.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-126">The data source provider determines the way that an entity is defined as a media link entry in the data model.</span></span>  
  
 <span data-ttu-id="3c5e4-127">**Zprostředkovatel Entity Framework**</span><span class="sxs-lookup"><span data-stu-id="3c5e4-127">**Entity Framework Provider**</span></span>  
 <span data-ttu-id="3c5e4-128">Označuje, že entita položkou odkazu na média, přidejte `HasStream` atributu na definici typu entity v konceptuálním modelu, jako v následujícím příkladu:</span><span class="sxs-lookup"><span data-stu-id="3c5e4-128">To indicate that an entity is a media link entry, add the `HasStream` attribute to the entity type definition in the conceptual model, as in the following example:</span></span>  
  
 [!code-xml[Astoria Photo Streaming Service#HasStream](../../../../samples/snippets/xml/VS_Snippets_Misc/astoria photo streaming service/xml/photodata.edmx#hasstream)]  
  
 <span data-ttu-id="3c5e4-129">Musíte taky přidat obor názvů `xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata` k entitě nebo do kořenového adresáře souboru .edmx nebo .csdl, který definuje datový model.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-129">You must also add the namespace `xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata` either to the entity or to the root of the .edmx or .csdl file that defines the data model.</span></span>  
  
 <span data-ttu-id="3c5e4-130">Příklad z datové služby, který používá [!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)] zprostředkovatele a zveřejňuje mediální zdroj, najdete v příspěvku [datové služby streamování poskytovatele řady: implementace poskytovatele datových proudů (část 1)](https://go.microsoft.com/fwlink/?LinkID=198989).</span><span class="sxs-lookup"><span data-stu-id="3c5e4-130">For an example of a data service that uses the [!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)] provider and exposes a media resource, see the post [Data Services Streaming Provider Series: Implementing a Streaming Provider (Part 1)](https://go.microsoft.com/fwlink/?LinkID=198989).</span></span>  
  
 <span data-ttu-id="3c5e4-131">**Zprostředkovatel reflexe**</span><span class="sxs-lookup"><span data-stu-id="3c5e4-131">**Reflection Provider**</span></span>  
 <span data-ttu-id="3c5e4-132">Označuje, že entita položkou odkazu na média, přidejte <xref:System.Data.Services.Common.HasStreamAttribute> do třídy, která definuje typ entity v zprostředkovatel reflexe.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-132">To indicate that an entity is a media link entry, add the <xref:System.Data.Services.Common.HasStreamAttribute> to the class that defines the entity type in the reflection provider.</span></span>  
  
 <span data-ttu-id="3c5e4-133">**Poskytovatel služeb vlastních dat**</span><span class="sxs-lookup"><span data-stu-id="3c5e4-133">**Custom Data Service Provider**</span></span>  
 <span data-ttu-id="3c5e4-134">Při použití vlastních zprostředkovatelů, můžete implementovat <xref:System.Data.Services.Providers.IDataServiceMetadataProvider> rozhraní definují metadata pro datové služby.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-134">When using custom service providers, you implement the <xref:System.Data.Services.Providers.IDataServiceMetadataProvider> interface to define the metadata for your data service.</span></span> <span data-ttu-id="3c5e4-135">Další informace najdete v tématu [Vlastní zprostředkovatelé datových služeb](../../../../docs/framework/data/wcf/custom-data-service-providers-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="3c5e4-135">For more information, see [Custom Data Service Providers](../../../../docs/framework/data/wcf/custom-data-service-providers-wcf-data-services.md).</span></span> <span data-ttu-id="3c5e4-136">Označuje, že datový proud binární prostředek patří do <xref:System.Data.Services.Providers.ResourceType> nastavením <xref:System.Data.Services.Providers.ResourceType.IsMediaLinkEntry%2A> vlastnost `true` na <xref:System.Data.Services.Providers.ResourceType> , který představuje typ entity, která je položka media link entry.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-136">You indicate that a binary resource stream belongs to a <xref:System.Data.Services.Providers.ResourceType> by setting the <xref:System.Data.Services.Providers.ResourceType.IsMediaLinkEntry%2A> property to `true` on the <xref:System.Data.Services.Providers.ResourceType> that represents the entity type, which is a media link entry.</span></span>  
  
## <a name="implementing-the-idataservicestreamprovider-interface"></a><span data-ttu-id="3c5e4-137">Implementace rozhraní IDataServiceStreamProvider</span><span class="sxs-lookup"><span data-stu-id="3c5e4-137">Implementing the IDataServiceStreamProvider Interface</span></span>  
 <span data-ttu-id="3c5e4-138">K vytvoření datové služby, který podporuje binární datové proudy, je nutné implementovat <xref:System.Data.Services.Providers.IDataServiceStreamProvider> rozhraní.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-138">To create a data service that supports binary data streams, you must implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> interface.</span></span> <span data-ttu-id="3c5e4-139">Tato implementace umožňuje službě data a vrátit binární data jako datový proud do klienta a zpracování binárních dat jako datový proud odeslaných z klienta.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-139">This implementation enables the data service to return binary data as a stream to the client and consume binary data as a stream sent from the client.</span></span> <span data-ttu-id="3c5e4-140">Datové služby vytvoří instanci tohoto rozhraní pokaždé, když jej potřebuje přístup k binárních dat jako datový proud.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-140">The data service creates an instance of this interface whenever it needs to access binary data as a stream.</span></span> <span data-ttu-id="3c5e4-141"><xref:System.Data.Services.Providers.IDataServiceStreamProvider> Rozhraní určuje následující členy:</span><span class="sxs-lookup"><span data-stu-id="3c5e4-141">The <xref:System.Data.Services.Providers.IDataServiceStreamProvider> interface specifies the following members:</span></span>  
  
|<span data-ttu-id="3c5e4-142">Název členu</span><span class="sxs-lookup"><span data-stu-id="3c5e4-142">Member name</span></span>|<span data-ttu-id="3c5e4-143">Popis</span><span class="sxs-lookup"><span data-stu-id="3c5e4-143">Description</span></span>|  
|-----------------|-----------------|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>|<span data-ttu-id="3c5e4-144">Tato metoda vyvolá datové službě dovoluje při odstranění jeho položka media link entry odstranění odpovídající mediální zdroj.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-144">This method is invoked by the data service to delete the corresponding media resource when its media link entry is deleted.</span></span> <span data-ttu-id="3c5e4-145">Při implementaci <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, tato metoda obsahuje kód, který odstraní přidružené položka zadaná media link entry mediální zdroj.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-145">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, this method contains the code that deletes the media resource associated with the supplied media link entry.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A>|<span data-ttu-id="3c5e4-146">Tato metoda vyvolá datové služby se vraťte mediální zdroj jako datový proud.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-146">This method is invoked by the data service to return a media resource as a stream.</span></span> <span data-ttu-id="3c5e4-147">Při implementaci <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, tato metoda obsahuje kód, který poskytuje datový proud, který je používán službou data do prostředku vrátit média, který je spojen s položka zadaná media link entry.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-147">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, this method contains the code that provides a stream that is used by the data service to the return media resource that is associated with the provided media link entry.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStreamUri%2A>|<span data-ttu-id="3c5e4-148">Tato metoda vyvolána datová služba vrátit identifikátor URI, který slouží k vyžádání mediální zdroj pro položka media link entry.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-148">This method is invoked by the data service to return the URI that is used to request the media resource for the media link entry.</span></span> <span data-ttu-id="3c5e4-149">Tato hodnota se používá k vytvoření `src` atribut v obsahu elementu položka media link entry a, který slouží k vyžádání datového proudu.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-149">This value is used to create the `src` attribute in the content element of the media link entry and that is used to request the data stream.</span></span> <span data-ttu-id="3c5e4-150">Při návratu tato metoda `null`, datové služby automaticky určuje identifikátor URI.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-150">When this method returns `null`, the data service automatically determines the URI.</span></span> <span data-ttu-id="3c5e4-151">Tuto metodu použijte, pokud je potřeba zadat klientů s přímým přístupem k binárních dat bez použití zprostředkovatele datový proud.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-151">Use this method when you need to provide clients with direct access to binary data without using the steam provider.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetStreamContentType%2A>|<span data-ttu-id="3c5e4-152">Tato metoda vyvolá datové službě dovoluje návratová hodnota Content-Type mediální zdroj, který je přidružen položka zadaná media link entry.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-152">This method is invoked by the data service to return the Content-Type value of the media resource that is associated with the specified media link entry.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetStreamETag%2A>|<span data-ttu-id="3c5e4-153">Datová služba k vrácení eTag datový proud, který je spojen s zadaná entita byla tato metoda vyvolána.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-153">This method is invoked by the data service to return the eTag of the data stream that is associated with the specified entity.</span></span> <span data-ttu-id="3c5e4-154">Tato metoda se používá při správě souběžnosti pro binární data.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-154">This method is used when you manage concurrency for the binary data.</span></span> <span data-ttu-id="3c5e4-155">Když tato metoda vrátí hodnotu null, nesleduje datové služby souběžnosti.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-155">When this method returns null, the data service does not track concurrency.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A>|<span data-ttu-id="3c5e4-156">Datová služba k získání datového proudu, který se používá při přijímání datový proud odeslaných z klienta byla tato metoda vyvolána.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-156">This method is invoked by the data service to obtain the stream that is used when receiving the stream sent from the client.</span></span> <span data-ttu-id="3c5e4-157">Při implementaci <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, musí vracet zapisovatelný datový proud, do které datové služby zápisy přijatá data datového proudu.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-157">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, you must return a writable stream to which the data service writes received stream data.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.ResolveType%2A>|<span data-ttu-id="3c5e4-158">Vrátí název typu kvalifikovaného oboru názvů, který představuje typ, který modul runtime služby data musíte vytvořit pro položka media link entry, který je spojen s datovým proudem pro mediální zdroj, který bude vložen.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-158">Returns a namespace-qualified type name that represents the type that the data service runtime must create for the media link entry that is associated with the data stream for the media resource that is being inserted.</span></span>|  
  
## <a name="creating-the-streaming-data-service"></a><span data-ttu-id="3c5e4-159">Vytvoření datových proudů datové služby</span><span class="sxs-lookup"><span data-stu-id="3c5e4-159">Creating the Streaming Data Service</span></span>  
 <span data-ttu-id="3c5e4-160">K poskytování [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] modulu runtime s přístupem k <xref:System.Data.Services.Providers.IDataServiceStreamProvider> implementace, datové služby, kterou vytvoříte musí implementovat taky <xref:System.IServiceProvider> rozhraní.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-160">To provide the [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] runtime with access to the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> implementation, the data service that you create must also implement the <xref:System.IServiceProvider> interface.</span></span> <span data-ttu-id="3c5e4-161">Následující příklad ukazuje, jak implementovat <xref:System.IServiceProvider.GetService%2A> metoda vrátí instanci `PhotoServiceStreamProvider` třídu, která implementuje <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-161">The following example shows how to implement the <xref:System.IServiceProvider.GetService%2A> method to return an instance of the `PhotoServiceStreamProvider` class that implements <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span></span>  
  
 [!code-csharp[Astoria Photo Streaming Service#PhotoServiceStreamingProvider](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria photo streaming service/cs/photodata.svc.cs#photoservicestreamingprovider)]
 [!code-vb[Astoria Photo Streaming Service#PhotoServiceStreamingProvider](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria photo streaming service/vb/photodata.svc.vb#photoservicestreamingprovider)]  
  
 <span data-ttu-id="3c5e4-162">Obecné informace o tom, jak vytvořit datovou službu, naleznete v tématu [konfigurace datové služby](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="3c5e4-162">For general information about how to create a data service, see [Configuring the Data Service](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span></span>  
  
## <a name="enabling-large-binary-streams-in-the-hosting-environment"></a><span data-ttu-id="3c5e4-163">Povolení velké binární datové proudy v hostitelském prostředí</span><span class="sxs-lookup"><span data-stu-id="3c5e4-163">Enabling Large Binary Streams in the Hosting Environment</span></span>  
 <span data-ttu-id="3c5e4-164">Při vytváření datové služby v [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] webové aplikace, Windows Communication Foundation (WCF) slouží k poskytování implementace protokolu HTTP.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-164">When you create a data service in an [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Web application, Windows Communication Foundation (WCF) is used to provide the HTTP protocol implementation.</span></span> <span data-ttu-id="3c5e4-165">Ve výchozím nastavení WCF omezení velikosti zpráv HTTP na pouze 65 kB.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-165">By default, WCF limits the size of HTTP messages to only 65K bytes.</span></span> <span data-ttu-id="3c5e4-166">Aby bylo možné do datového proudu velkému objemu binárních dat do a z datové služby, musíte také nakonfigurovat webovou aplikaci povolit velkých binárních souborů a použití datových proudů pro přenos.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-166">To be able to stream large binary data to and from the data service, you must also configure the Web application to enable large binary files and to use streams for transfer.</span></span> <span data-ttu-id="3c5e4-167">Chcete-li to provést, přidejte následující kód do `<configuration />` prvek souboru Web.config aplikace:</span><span class="sxs-lookup"><span data-stu-id="3c5e4-167">To do this, add the following in the `<configuration />` element of the application's Web.config file:</span></span>  
  
  
  
> [!NOTE]
>  <span data-ttu-id="3c5e4-168">Je nutné použít <xref:System.ServiceModel.TransferMode.Streamed?displayProperty=nameWithType> přenosový režim na binární data ve zprávách žádost a odpověď streamování a nejsou ukládány do vyrovnávací paměti ve WCF.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-168">You must use a <xref:System.ServiceModel.TransferMode.Streamed?displayProperty=nameWithType> transfer mode to ensure that the binary data in both the request and response messages are streamed and not buffered by WCF.</span></span>  
  
 <span data-ttu-id="3c5e4-169">Další informace najdete v tématu [streamování přenosu zpráv](../../../../docs/framework/wcf/feature-details/streaming-message-transfer.md) a [přenosové kvóty](../../../../docs/framework/wcf/feature-details/transport-quotas.md).</span><span class="sxs-lookup"><span data-stu-id="3c5e4-169">For more information, see [Streaming Message Transfer](../../../../docs/framework/wcf/feature-details/streaming-message-transfer.md) and [Transport Quotas](../../../../docs/framework/wcf/feature-details/transport-quotas.md).</span></span>  
  
 <span data-ttu-id="3c5e4-170">Ve výchozím nastavení Internetové informační služby (IIS) také omezuje množství požadavků na 4MB.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-170">By default, Internet Information Services (IIS) also limits the size of requests to 4MB.</span></span> <span data-ttu-id="3c5e4-171">Pokud chcete povolit datové služby přijímat datové proudy, které jsou větší než 4MB, když ve službě IIS, musíte taky nastavit `maxRequestLength` atribut [httpRuntime – Element (schéma nastavení technologie ASP.NET)](https://msdn.microsoft.com/library/e9b81350-8aaf-47cc-9843-5f7d0c59f369) v `<system.web />` konfiguračního oddílu jako můžete vidět v následujícím příkladu:</span><span class="sxs-lookup"><span data-stu-id="3c5e4-171">To enable your data service to receive streams larger than 4MB when running on IIS, you must also set the `maxRequestLength` attribute of the [httpRuntime Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/e9b81350-8aaf-47cc-9843-5f7d0c59f369) in the `<system.web />` configuration section, as shown in the following example:</span></span>  
  
  
  
## <a name="using-data-streams-in-a-client-application"></a><span data-ttu-id="3c5e4-172">Použití datových proudů v klientské aplikaci</span><span class="sxs-lookup"><span data-stu-id="3c5e4-172">Using Data Streams in a Client Application</span></span>  
 <span data-ttu-id="3c5e4-173">[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] Klientská knihovna umožňuje načíst i aktualizovat tyto materiály vystavené jako binární datové proudy na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-173">The [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client library enables you to both retrieve and update these exposed resources as binary streams on the client.</span></span> <span data-ttu-id="3c5e4-174">Další informace najdete v tématu [práce s binárními daty](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="3c5e4-174">For more information, see [Working with Binary Data](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span></span>  
  
## <a name="considerations-for-working-with-a-streaming-provider"></a><span data-ttu-id="3c5e4-175">Důležité informace týkající se práce se zprostředkovateli datových proudů</span><span class="sxs-lookup"><span data-stu-id="3c5e4-175">Considerations for Working with a Streaming Provider</span></span>  
 <span data-ttu-id="3c5e4-176">Níže jsou věci k uvážení při implementaci zprostředkovatele datových proudů a když je přístup k prostředkům média z datové služby.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-176">The following are things to consider when you implement a streaming provider and when you access media resources from a data service.</span></span>  
  
-   <span data-ttu-id="3c5e4-177">Požadavky na SLOUČENÍ nejsou podporovány pro prostředky médií.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-177">MERGE requests are not supported for media resources.</span></span> <span data-ttu-id="3c5e4-178">Chcete-li změnit mediální zdroj existující entity použijte požadavek PUT.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-178">Use a PUT request to change the media resource of an existing entity.</span></span>  
  
-   <span data-ttu-id="3c5e4-179">Požadavek POST nelze použít k vytvoření nového média odkazů.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-179">A POST request cannot be used to create a new media link entry.</span></span> <span data-ttu-id="3c5e4-180">Místo toho musíte vydat požadavek POST vytvořit nový prostředek služby media a datové služby vytvoří nové médium odkazů s výchozími hodnotami.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-180">Instead, you must issue a POST request to create a new media resource, and the data service creates a new media link entry with default values.</span></span> <span data-ttu-id="3c5e4-181">Tato nová entita je možné aktualizovat podle další požadavek SLOUČENÍ nebo PUT.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-181">This new entity can be updated by a subsequent MERGE or PUT request.</span></span> <span data-ttu-id="3c5e4-182">Zvažte možnost ukládání do mezipaměti entity, kde můžete provést aktualizace v zneškodňovatel, jako je například nastavení hodnoty vlastnosti na hodnotu záhlaví zkráceného názvu stránky v požadavku POST.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-182">You may also consider caching the entity and make updates in the disposer, such as setting the property value to the value of the Slug header in the POST request.</span></span>  
  
-   <span data-ttu-id="3c5e4-183">Při přijetí požadavku POST data servisní volání <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> a vytvoří prostředek služby media dříve, než se zavolá <xref:System.Data.Services.IUpdatable.SaveChanges%2A> k vytvoření médií záznamu odkazu.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-183">When a POST request is received, the data service calls <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> to create the media resource before it calls <xref:System.Data.Services.IUpdatable.SaveChanges%2A> to create the media link entry.</span></span>  
  
-   <span data-ttu-id="3c5e4-184">Implementace <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> by neměly vracet <xref:System.IO.MemoryStream> objektu.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-184">An implementation of <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> should not return a <xref:System.IO.MemoryStream> object.</span></span> <span data-ttu-id="3c5e4-185">Pokud použijete tento druh datového proudu, dojde k potížím prostředků paměti když služba přijímá velmi velkých datových proudů.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-185">When you use this kind of stream, memory resource issues will occur when the service receives very large data streams.</span></span>  
  
-   <span data-ttu-id="3c5e4-186">Tady jsou věci k uvážení při ukládání zdroje médií v databázi:</span><span class="sxs-lookup"><span data-stu-id="3c5e4-186">The following are things to consider when storing media resources in a database:</span></span>  
  
    -   <span data-ttu-id="3c5e4-187">Binární vlastnost, která je příslušný mediální zdroj by neměl být zařazen datového modelu.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-187">A binary property that is a media resource should not be included in the data model.</span></span> <span data-ttu-id="3c5e4-188">Všechny vlastnosti, které jsou zveřejněné v datovém modelu se vrátí v položce v odpovědi informačního kanálu.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-188">All properties exposed in a data model are returned in the entry in a response feed.</span></span>  
  
    -   <span data-ttu-id="3c5e4-189">Zlepšení výkonu pomocí velké binární datový proud, doporučujeme vám, že vytvoříte vlastní datový proud třídu pro ukládání binárních dat v databázi.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-189">To improve performance with a large binary stream, we recommend that you create a custom stream class to store binary data in the database.</span></span> <span data-ttu-id="3c5e4-190">Tato třída je vrácený vaše <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> provádění a odešle binární data do databáze v blocích.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-190">This class is returned by your <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> implementation and sends the binary data to the database in chunks.</span></span> <span data-ttu-id="3c5e4-191">Pro databázi serveru SQL Server doporučujeme použít FILESTREAM pro streamování dat do databáze, pokud binárních dat je větší než 1MB.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-191">For a SQL Server database, we recommend that you use a FILESTREAM to stream data into the database when the binary data is larger than 1MB.</span></span>  
  
    -   <span data-ttu-id="3c5e4-192">Ujistěte se, že vaše databáze je navržená k ukládání binární velké datové proudy, které se mají přijímat datové služby.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-192">Ensure that your database is designed to store the binary large streams that are to be received by your data service.</span></span>  
  
    -   <span data-ttu-id="3c5e4-193">Když klient odešle požadavek POST vložit položku media link entry s prostředkem média v rámci jednoho požadavku <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> je volána k získání datového proudu před datové služby vloží nové entity do databáze.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-193">When a client sends a POST request to insert a media link entry with a media resource in a single request, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> is called to obtain the stream before the data service inserts the new entity into the database.</span></span> <span data-ttu-id="3c5e4-194">Streamování implementaci zprostředkovatele musí být schopna zpracovávat toto chování služby data.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-194">A streaming provider implementation must be able to handle this data service behavior.</span></span> <span data-ttu-id="3c5e4-195">Zvažte použití samostatná data pro tabulku pro ukládání binárních dat nebo úložiště na datový proud v souboru až po entity byla vložena do databáze.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-195">Consider using a separate data table to store the binary data or store the data stream in a file until after the entity has been inserted into the database.</span></span>  
  
-   <span data-ttu-id="3c5e4-196">Při implementaci <xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A>, nebo <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> metody, musíte použít značku eTag a Content-Type hodnoty, které jsou dodávány jako parametry metody.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-196">When you implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A>, or <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> methods, you must use the eTag and Content-Type values that are supplied as method parameters.</span></span> <span data-ttu-id="3c5e4-197">Nenastavujte eTag nebo záhlaví Content-Type v vaše <xref:System.Data.Services.Providers.IDataServiceStreamProvider> používaná implementace poskytovatele.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-197">Do not set eTag or Content-Type headers in your <xref:System.Data.Services.Providers.IDataServiceStreamProvider> provider implementation.</span></span>  
  
-   <span data-ttu-id="3c5e4-198">Ve výchozím nastavení klient odešle velké binární datové proudy s použitím bloku HTTP Transfer-Encoding.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-198">By default, the client sends large binary streams by using a chunked HTTP Transfer-Encoding.</span></span> <span data-ttu-id="3c5e4-199">Vzhledem k tomu, [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] vývojový Server nepodporuje tento typ kódování, nelze použít tento webový server k hostování datových proudů datových služeb, musíte přijmout velké binární datové proudy.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-199">Because the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Development Server does not support this kind of encoding, you cannot use this Web server to host a streaming data service that must accept large binary streams.</span></span> <span data-ttu-id="3c5e4-200">Další informace o [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] vývojový Server, naleznete v tématu [webové servery v sadě Visual Studio pro webové projekty ASP.NET](https://msdn.microsoft.com/library/31d4f588-df59-4b7e-b9ea-e1f2dd204328).</span><span class="sxs-lookup"><span data-stu-id="3c5e4-200">For more information on [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Development Server, see [Web Servers in Visual Studio for ASP.NET Web Projects](https://msdn.microsoft.com/library/31d4f588-df59-4b7e-b9ea-e1f2dd204328).</span></span>  
  
<a name="versioning"></a>   
## <a name="versioning-requirements"></a><span data-ttu-id="3c5e4-201">Požadavky na správu verzí</span><span class="sxs-lookup"><span data-stu-id="3c5e4-201">Versioning Requirements</span></span>  
 <span data-ttu-id="3c5e4-202">Zprostředkovatel streamování má následující [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] protokol požadavků na správu verzí:</span><span class="sxs-lookup"><span data-stu-id="3c5e4-202">The streaming provider has the following [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] protocol versioning requirements:</span></span>  
  
-   <span data-ttu-id="3c5e4-203">Zprostředkovatel streamování vyžaduje, aby podporoval službu dat verzi 2.0 [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] protokol a novějších verzích.</span><span class="sxs-lookup"><span data-stu-id="3c5e4-203">The streaming provider requires that the data service support version 2.0 of the [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] protocol and later versions.</span></span>  
  
 <span data-ttu-id="3c5e4-204">Další informace najdete v tématu [Správa verzí datové služby](../../../../docs/framework/data/wcf/data-service-versioning-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="3c5e4-204">For more information, see [Data Service Versioning](../../../../docs/framework/data/wcf/data-service-versioning-wcf-data-services.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3c5e4-205">Viz také</span><span class="sxs-lookup"><span data-stu-id="3c5e4-205">See Also</span></span>  
 [<span data-ttu-id="3c5e4-206">Zprostředkovatelé datových služeb</span><span class="sxs-lookup"><span data-stu-id="3c5e4-206">Data Services Providers</span></span>](../../../../docs/framework/data/wcf/data-services-providers-wcf-data-services.md)  
 [<span data-ttu-id="3c5e4-207">Vlastní zprostředkovatelé datových služeb</span><span class="sxs-lookup"><span data-stu-id="3c5e4-207">Custom Data Service Providers</span></span>](../../../../docs/framework/data/wcf/custom-data-service-providers-wcf-data-services.md)  
 [<span data-ttu-id="3c5e4-208">Práce s binárními daty</span><span class="sxs-lookup"><span data-stu-id="3c5e4-208">Working with Binary Data</span></span>](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md)
