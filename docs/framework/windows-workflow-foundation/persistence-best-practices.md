---
title: Osvědčené postupy pro trvalost
ms.date: 03/30/2017
ms.assetid: 6974c5a4-1af8-4732-ab53-7d694608a3a0
ms.openlocfilehash: 8ffbb3ebfa8f85e2b0052a9df9ada30766accd8e
ms.sourcegitcommit: 32a575bf4adccc901f00e264f92b759ced633379
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 12/04/2019
ms.locfileid: "74802515"
---
# <a name="persistence-best-practices"></a><span data-ttu-id="768cd-102">Osvědčené postupy pro trvalost</span><span class="sxs-lookup"><span data-stu-id="768cd-102">Persistence Best Practices</span></span>
<span data-ttu-id="768cd-103">Tento dokument popisuje osvědčené postupy pro návrh a konfiguraci pracovního postupu související s trvalým pracovním postupem.</span><span class="sxs-lookup"><span data-stu-id="768cd-103">This document covers best practices for workflow design and configuration related to workflow persistence.</span></span>  
  
## <a name="design-and-implementation-of-durable-workflows"></a><span data-ttu-id="768cd-104">Návrh a implementace trvalých pracovních postupů</span><span class="sxs-lookup"><span data-stu-id="768cd-104">Design and Implementation of Durable Workflows</span></span>  
 <span data-ttu-id="768cd-105">Obecně platí, že pracovní postupy provádějí práci v krátkých obdobích, která jsou provedená v době, kdy je pracovní postup nečinný, protože čeká na událost.</span><span class="sxs-lookup"><span data-stu-id="768cd-105">In general, workflows perform work in short periods that are interleaved with times during which the workflow is idle because it is waiting for an event.</span></span> <span data-ttu-id="768cd-106">Tato událost může být taková jako zpráva nebo časovač vypršení platnosti.</span><span class="sxs-lookup"><span data-stu-id="768cd-106">This event can be such things as a message or an expiring timer.</span></span> <span data-ttu-id="768cd-107">Aby bylo možné uvolnit instanci pracovního postupu, pokud se nejedná o nečinné, hostitel služby musí zachovat instanci pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="768cd-107">To be able to unload the workflow instance when it becomes idle, the service host must persist the workflow instance.</span></span> <span data-ttu-id="768cd-108">To je možné pouze v případě, že instance pracovního postupu není v zóně bez trvalého uchování (například čekání na dokončení transakce nebo čekání na asynchronní zpětné volání).</span><span class="sxs-lookup"><span data-stu-id="768cd-108">This is possible only if the workflow instance is not in a no-persist zone (for example, waiting for a transaction to complete, or waiting for an asynchronous callback).</span></span> <span data-ttu-id="768cd-109">Aby bylo možné uvolnit nečinné instance pracovního postupu, měl by Autor pracovního postupu používat obory transakcí a asynchronní aktivity pouze pro krátkodobé akce.</span><span class="sxs-lookup"><span data-stu-id="768cd-109">To allow an idle workflow instance to unload, the workflow author should use transaction scopes and asynchronous activities for short-lived actions only.</span></span> <span data-ttu-id="768cd-110">Konkrétně by měl autor v těchto zónách bez trvalého zachovávání aktivity co nejkratší.</span><span class="sxs-lookup"><span data-stu-id="768cd-110">In particular, the author should keep delay activities within these no-persist zones as short as possible.</span></span>  
  
 <span data-ttu-id="768cd-111">Pracovní postup může být trvalý pouze v případě, že všechny datové typy používané pracovním postupem jsou serializovatelný.</span><span class="sxs-lookup"><span data-stu-id="768cd-111">A workflow can only be persisted if all of the data types used by the workflow are serializable.</span></span> <span data-ttu-id="768cd-112">Kromě toho musí být vlastní typy používané v trvalých pracovních postupech serializovatelné s <xref:System.Runtime.Serialization.NetDataContractSerializer>, aby je bylo možné trvale <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore>.</span><span class="sxs-lookup"><span data-stu-id="768cd-112">In addition, custom types used in persisted workflows must be serializable with <xref:System.Runtime.Serialization.NetDataContractSerializer> in order to be persisted by <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore>.</span></span>  
  
 <span data-ttu-id="768cd-113">Instance pracovního postupu nejde obnovit v případě selhání hostitele nebo počítače, pokud není trvalá.</span><span class="sxs-lookup"><span data-stu-id="768cd-113">A workflow instance cannot be recovered in case of a host or computer failure if it has not been persisted.</span></span> <span data-ttu-id="768cd-114">Obecně doporučujeme, abyste zachovali instanci pracovního postupu na začátku v životním cyklu pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="768cd-114">In general, we recommend that you persist a workflow instance early in the workflow’s life cycle.</span></span>  
  
 <span data-ttu-id="768cd-115">Pokud je váš pracovní postup zaneprázdněný dlouhou dobu, doporučujeme, abyste instanci pracovního postupu pravidelně zachovali v průběhu svého zaneprázdněného období.</span><span class="sxs-lookup"><span data-stu-id="768cd-115">If your workflow is busy for a long time, we recommend that you persist the workflow instance regularly throughout its busy period.</span></span> <span data-ttu-id="768cd-116">Můžete to udělat tak, že přidáte <xref:System.Activities.Statements.Persist> aktivity v průběhu posloupnosti aktivit, které udržují instanci pracovního postupu zaneprázdněnou.</span><span class="sxs-lookup"><span data-stu-id="768cd-116">You can do this by adding <xref:System.Activities.Statements.Persist> activities throughout the sequence of activities that keep the workflow instance busy.</span></span> <span data-ttu-id="768cd-117">Tímto způsobem může recyklace domény aplikace, selhání hostitelů nebo selhání počítače způsobit vrácení systému zpět na začátek zaneprázdněného období.</span><span class="sxs-lookup"><span data-stu-id="768cd-117">In this manner, application domain recycling, host failures, or computer failures do not cause the system to be rolled back to the start of the busy period.</span></span> <span data-ttu-id="768cd-118">Mějte na paměti, že přidání <xref:System.Activities.Statements.Persist> aktivit do pracovního postupu by mohlo vést k snížení výkonu.</span><span class="sxs-lookup"><span data-stu-id="768cd-118">Be aware that adding <xref:System.Activities.Statements.Persist> activities to your workflow could lead to a degradation of performance.</span></span>  
  
 <span data-ttu-id="768cd-119">Windows Server App Fabric značně zjednodušuje konfiguraci a používání trvalosti.</span><span class="sxs-lookup"><span data-stu-id="768cd-119">Windows Server App Fabric greatly simplifies the configuration and use of persistence.</span></span> <span data-ttu-id="768cd-120">Další informace najdete v tématu [trvalost Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677272(v=azure.10)) .</span><span class="sxs-lookup"><span data-stu-id="768cd-120">For more information, see [Windows Server App Fabric Persistence](https://docs.microsoft.com/previous-versions/appfabric/ee677272(v=azure.10))</span></span>  
  
## <a name="configuration-of-scalability-parameters"></a><span data-ttu-id="768cd-121">Konfigurace parametrů škálovatelnosti</span><span class="sxs-lookup"><span data-stu-id="768cd-121">Configuration of Scalability Parameters</span></span>  
 <span data-ttu-id="768cd-122">Požadavky na škálovatelnost a výkon určují nastavení následujících parametrů:</span><span class="sxs-lookup"><span data-stu-id="768cd-122">Scalability and performance requirements determine the settings of the following parameters:</span></span>  
  
- <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A>  
  
- <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A>  
  
- <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior.InstanceLockedExceptionAction%2A>  
  
 <span data-ttu-id="768cd-123">Tyto parametry by měly být nastaveny podle aktuálního scénáře jako následující.</span><span class="sxs-lookup"><span data-stu-id="768cd-123">These parameters should be set as follows, according to the current scenario.</span></span>  
  
### <a name="scenario-a-small-number-of-workflow-instances-that-require-optimal-response-time"></a><span data-ttu-id="768cd-124">Scénář: malý počet instancí pracovních postupů, které vyžadují optimální dobu odezvy.</span><span class="sxs-lookup"><span data-stu-id="768cd-124">Scenario: A Small Number of Workflow Instances That Require Optimal Response Time</span></span>  
 <span data-ttu-id="768cd-125">V tomto scénáři by všechny instance pracovního postupu měly zůstat načteny, když se stanou nečinné.</span><span class="sxs-lookup"><span data-stu-id="768cd-125">In this scenario, all workflow instances should remain loaded when they become idle.</span></span> <span data-ttu-id="768cd-126">Nastavte <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> na velkou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="768cd-126">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to a large value.</span></span> <span data-ttu-id="768cd-127">Použití tohoto nastavení zabrání přesunutí instance pracovního postupu mezi počítači.</span><span class="sxs-lookup"><span data-stu-id="768cd-127">The use of this setting prevents a workflow instance from moving between computers.</span></span> <span data-ttu-id="768cd-128">Toto nastavení použijte pouze v případě, že platí některá z následujících podmínek:</span><span class="sxs-lookup"><span data-stu-id="768cd-128">Use this setting only if one or more of the following are true:</span></span>  
  
- <span data-ttu-id="768cd-129">Instance pracovního postupu obdrží v průběhu své životnosti jednu zprávu.</span><span class="sxs-lookup"><span data-stu-id="768cd-129">A workflow instance receives a single message throughout its lifetime.</span></span>  
  
- <span data-ttu-id="768cd-130">Všechny instance pracovního postupu jsou spouštěny v jednom počítači.</span><span class="sxs-lookup"><span data-stu-id="768cd-130">All workflow instances run on a single computer</span></span>  
  
- <span data-ttu-id="768cd-131">Všechny zprávy, které jsou přijímány instancí pracovního postupu, jsou přijímány stejným počítačem.</span><span class="sxs-lookup"><span data-stu-id="768cd-131">All messages that are received by a workflow instance are received by the same computer.</span></span>  
  
 <span data-ttu-id="768cd-132">Pomocí <xref:System.Activities.Statements.Persist> aktivity nebo nastavte <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> na hodnotu 0, abyste mohli po selhání hostitele služby nebo počítače povolit obnovení instance pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="768cd-132">Use <xref:System.Activities.Statements.Persist> activities or set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> to 0 to enable recovery of your workflow instance after service host or computer failures.</span></span>  
  
### <a name="scenario-workflow-instances-are-idle-for-long-periods-of-time"></a><span data-ttu-id="768cd-133">Scénář: instance pracovního postupu jsou nečinné po dlouhou dobu.</span><span class="sxs-lookup"><span data-stu-id="768cd-133">Scenario: Workflow Instances Are Idle for Long Periods of Time</span></span>  
 <span data-ttu-id="768cd-134">V tomto scénáři nastavte <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> na 0, aby se uvolnily prostředky co nejrychleji.</span><span class="sxs-lookup"><span data-stu-id="768cd-134">In this scenario, set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to 0 to release resources as soon as possible.</span></span>  
  
### <a name="scenario-workflow-instances-receive-multiple-messages-in-a-short-period-of-time"></a><span data-ttu-id="768cd-135">Scénář: instance pracovních postupů přijímají více zpráv v krátké době</span><span class="sxs-lookup"><span data-stu-id="768cd-135">Scenario: Workflow Instances Receive Multiple Messages in a Short Period of Time</span></span>  
 <span data-ttu-id="768cd-136">V tomto scénáři nastavte <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> na 60 sekund, pokud jsou tyto zprávy přijímány stejným počítačem.</span><span class="sxs-lookup"><span data-stu-id="768cd-136">In this scenario, set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to 60 seconds if these messages are received by the same computer.</span></span> <span data-ttu-id="768cd-137">Tím zabráníte rychlému sekvencování a načtení instance pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="768cd-137">This prevents a rapid sequence of unloading and loading of a workflow instance.</span></span> <span data-ttu-id="768cd-138">Tím se také nezachová instance v paměti, která je příliš dlouhá.</span><span class="sxs-lookup"><span data-stu-id="768cd-138">This also does not keep the instance in memory for too long.</span></span>  
  
 <span data-ttu-id="768cd-139">Nastavte <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> na 0 a nastavte <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior.InstanceLockedExceptionAction%2A> na BasicRetry nebo AggressiveRetry, pokud tyto zprávy mohou být přijímány různými počítači.</span><span class="sxs-lookup"><span data-stu-id="768cd-139">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to 0, and set <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior.InstanceLockedExceptionAction%2A> to BasicRetry or AggressiveRetry if these messages may be received by different computers.</span></span> <span data-ttu-id="768cd-140">To umožňuje, aby instance pracovního postupu byla načtena jiným počítačem.</span><span class="sxs-lookup"><span data-stu-id="768cd-140">This allows the workflow instance to be loaded by another computer.</span></span>  
  
### <a name="scenario-workflow-uses-delay-activities-with-short-durations"></a><span data-ttu-id="768cd-141">Scénář: pracovní postup používá aktivity zpoždění s krátkými dobami trvání</span><span class="sxs-lookup"><span data-stu-id="768cd-141">Scenario: Workflow Uses Delay Activities with Short Durations</span></span>  
 <span data-ttu-id="768cd-142">V tomto scénáři se <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> pravidelně dotazuje databáze trvalosti na instance, které by se měly načíst z důvodu <xref:System.Activities.Statements.Delay> aktivity s prošlou platností.</span><span class="sxs-lookup"><span data-stu-id="768cd-142">In this scenario, the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> regularly polls the persistence database for instances that should be loaded because of an expired <xref:System.Activities.Statements.Delay> activity.</span></span> <span data-ttu-id="768cd-143">Pokud <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> najde časovač, jehož platnost vyprší v dalším intervalu dotazování, zkrátí se v úložišti instance pracovního postupu SQL interval dotazování.</span><span class="sxs-lookup"><span data-stu-id="768cd-143">If the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> finds a timer that will expire in the next polling interval, the SQL Workflow Instance Store shortens the polling interval.</span></span> <span data-ttu-id="768cd-144">Další dotaz pak bude následovat hned po vypršení platnosti časovače.</span><span class="sxs-lookup"><span data-stu-id="768cd-144">The next poll will then occur right after the timer has expired.</span></span> <span data-ttu-id="768cd-145">Tímto způsobem úložiště instancí pracovních postupů SQL dosáhne vysoké přesnosti časovačů, které běží déle než interval dotazování, který je nastavený <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span><span class="sxs-lookup"><span data-stu-id="768cd-145">This way, the SQL Workflow Instance Store achieves a high accuracy of timers that run longer than the polling interval, which is set by <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span></span> <span data-ttu-id="768cd-146">Aby bylo možné včas zpracovat kratší prodlevy, musí instance pracovního postupu zůstat v paměti alespoň v jednom intervalu cyklického dotazování.</span><span class="sxs-lookup"><span data-stu-id="768cd-146">To enable timely processing of shorter delays, the workflow instance must remain in memory for at least one polling interval.</span></span>  
  
 <span data-ttu-id="768cd-147">Nastavte <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> na 0, chcete-li zapsat čas vypršení platnosti do databáze trvalosti.</span><span class="sxs-lookup"><span data-stu-id="768cd-147">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> to 0 to write the expiration time to the persistence database.</span></span>  
  
 <span data-ttu-id="768cd-148">Nastavte <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> na větší nebo rovnou <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> aby se instance v paměti zachovala aspoň u jednoho intervalu cyklického dotazování.</span><span class="sxs-lookup"><span data-stu-id="768cd-148">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to longer than or equal to <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> to keep the instance in memory for at least one polling interval.</span></span>  
  
 <span data-ttu-id="768cd-149">Nedoporučujeme snižovat <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>, protože to vede k zvýšenému zatížení databáze trvalosti.</span><span class="sxs-lookup"><span data-stu-id="768cd-149">We do not recommend reducing the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> because this leads to an increased load on the persistence database.</span></span> <span data-ttu-id="768cd-150">Každý hostitel služby, který používá <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> dotazuje databázi jednou za dobu detekce.</span><span class="sxs-lookup"><span data-stu-id="768cd-150">Each service host that uses the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> polls the database one time per detection period.</span></span> <span data-ttu-id="768cd-151">Nastavení <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> do příliš malého časového intervalu může způsobit snížení výkonu systému, pokud je počet hostitelů služby velký.</span><span class="sxs-lookup"><span data-stu-id="768cd-151">Setting <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> to too small a time interval may cause your system's performance to decrease if the number of service hosts is large.</span></span>  
  
## <a name="configuring-the-sql-workflow-instance-store"></a><span data-ttu-id="768cd-152">Konfigurace úložiště instance pracovního postupu SQL</span><span class="sxs-lookup"><span data-stu-id="768cd-152">Configuring the SQL Workflow Instance Store</span></span>  
 <span data-ttu-id="768cd-153">Úložiště instance pracovního postupu SQL má následující konfigurační parametry:</span><span class="sxs-lookup"><span data-stu-id="768cd-153">The SQL Workflow Instance Store has the following configuration parameters:</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceEncodingOption%2A>  
 <span data-ttu-id="768cd-154">Tento parametr instruuje <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> pro komprimaci stavu instance pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="768cd-154">This parameter instructs the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> to compress the workflow instance state.</span></span> <span data-ttu-id="768cd-155">Komprese snižuje množství dat uložených v databázi trvalosti a snižuje síťový provoz pro případ, že se databáze trvaly nachází na vyhrazeném databázovém serveru.</span><span class="sxs-lookup"><span data-stu-id="768cd-155">Compression reduces the amount of data that is stored in the persistence database and reduces network traffic in case the persistence database resides on a dedicated database server.</span></span> <span data-ttu-id="768cd-156">Pokud se používá komprese, vyžaduje výpočetní prostředky pro komprimaci a extrakci stavu instance.</span><span class="sxs-lookup"><span data-stu-id="768cd-156">If compression is used, it requires computational resources to compress and extract the instance state.</span></span> <span data-ttu-id="768cd-157">Ve většině případů komprese poskytuje zvýšený výkon.</span><span class="sxs-lookup"><span data-stu-id="768cd-157">In most cases, compression yields increased performance.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceCompletionAction%2A>  
 <span data-ttu-id="768cd-158">Tento parametr dá <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore>, aby bylo možné zachovat nebo odstranit dokončené instance.</span><span class="sxs-lookup"><span data-stu-id="768cd-158">This parameter instructs the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> to either keep or delete completed instances.</span></span> <span data-ttu-id="768cd-159">Udržování dokončených instancí zvyšuje požadavky na úložiště databáze Persistence a vede k větším tabulkám, což zvyšuje dobu vyhledávání tabulek.</span><span class="sxs-lookup"><span data-stu-id="768cd-159">Keeping completed instances increases the persistence database storage requirements and leads to larger tables, which increases table lookup times.</span></span> <span data-ttu-id="768cd-160">Pokud nejsou dokončené instance požadovány pro ladění nebo auditování, je nejlepší dát <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> k odstranění dokončených instancí.</span><span class="sxs-lookup"><span data-stu-id="768cd-160">Unless completed instances are required for debugging or auditing, it is best to instruct the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> to delete completed instances.</span></span> <span data-ttu-id="768cd-161">Odstraněné instance by se měly uchovávat pouze v případě, že uživatel vytvoří proces pro jejich nakonec odebrání.</span><span class="sxs-lookup"><span data-stu-id="768cd-161">Deleted instances should be kept only if the user establishes a process for eventually removing them.</span></span> <span data-ttu-id="768cd-162">Všimněte si, že korelační klíče nelze použít, dokud je instance dokončeného pracovního postupu uložena v úložišti instancí.</span><span class="sxs-lookup"><span data-stu-id="768cd-162">Note that correlation keys cannot be reused as long as the completed workflow instance resides in the instance store.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>  
 <span data-ttu-id="768cd-163">Tento parametr definuje maximální interval, pomocí kterého se <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> dotazuje databáze trvalosti pro instance, které by měly být načteny po vypršení platnosti <xref:System.Activities.Statements.Delay> aktivity.</span><span class="sxs-lookup"><span data-stu-id="768cd-163">This parameter defines the maximum interval with which the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> polls the persistence database for instances that should be loaded when a <xref:System.Activities.Statements.Delay> activity expires.</span></span> <span data-ttu-id="768cd-164">Pokud <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> najde časovač, jehož platnost vyprší v dalším intervalu dotazování, zkrátí interval dotazování tak, aby k dalšímu cyklickému dotazování docházelo ihned po vypršení platnosti časovače.</span><span class="sxs-lookup"><span data-stu-id="768cd-164">If the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> finds a timer that will expire in the next polling interval, it shortens the polling interval so that the next poll will occur right after the timer has expired.</span></span> <span data-ttu-id="768cd-165">Tímto způsobem úložiště instancí pracovních postupů SQL dosáhne vysoké přesnosti časovačů, které běží déle než <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span><span class="sxs-lookup"><span data-stu-id="768cd-165">This way, the SQL Workflow Instance Store achieves a high accuracy of timers that run longer than <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span></span>  
  
 <span data-ttu-id="768cd-166">Nedoporučujeme snižovat <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>, protože to vede k zvýšenému zatížení databáze trvalosti.</span><span class="sxs-lookup"><span data-stu-id="768cd-166">We do not recommend reducing the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>, because this leads to an increased load on the persistence database.</span></span> <span data-ttu-id="768cd-167">Každý hostitel služby, který používá <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> dotazuje databázi jednou za dobu detekce.</span><span class="sxs-lookup"><span data-stu-id="768cd-167">Each service host that uses the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> polls the database one time per detection period.</span></span> <span data-ttu-id="768cd-168">Nastavení <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> do příliš malého intervalu může způsobit snížení výkonu vašeho systému, pokud je počet hostitelů služby velký.</span><span class="sxs-lookup"><span data-stu-id="768cd-168">Setting <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> to too small an interval may cause your system's performance to decrease if the number of service hosts is large.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.HostLockRenewalPeriod%2A>  
 <span data-ttu-id="768cd-169">Tento parametr definuje interval, s nímž hostitel obnoví zámek v databázi trvalosti.</span><span class="sxs-lookup"><span data-stu-id="768cd-169">This parameter defines the interval with which the host renews its lock in the persistence database.</span></span> <span data-ttu-id="768cd-170">Zkrácením tohoto intervalu umožníte rychlejší obnovení instancí pracovního postupu v případě, že hostitel nebo počítač selže.</span><span class="sxs-lookup"><span data-stu-id="768cd-170">Shortening this interval will enable a quicker recovery of the workflow instances in case a host or computer fails.</span></span> <span data-ttu-id="768cd-171">Na druhé straně, krátké období obnovení zámků zvyšuje zatížení databáze trvalosti.</span><span class="sxs-lookup"><span data-stu-id="768cd-171">On the other hand, a short lock renewal period increases the load on the persistence database.</span></span> <span data-ttu-id="768cd-172">Každý hostitel služby, který používá <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore>, aktualizuje své zámky v databázi jednou za dobu obnovení.</span><span class="sxs-lookup"><span data-stu-id="768cd-172">Each service host that uses the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> will update its locks in the database one time per renewal period.</span></span> <span data-ttu-id="768cd-173">Pokud počítač používá mnoho hostitelů služby, zajistěte, aby zatížení způsobené obnovením zámku nesnížilo výkon systému.</span><span class="sxs-lookup"><span data-stu-id="768cd-173">If a computer runs many service hosts, make sure that the load caused by lock renewal does not decrease your system's performance.</span></span> <span data-ttu-id="768cd-174">V takovém případě zvažte zvýšení <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.HostLockRenewalPeriod%2A>.</span><span class="sxs-lookup"><span data-stu-id="768cd-174">If it does, consider increasing the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.HostLockRenewalPeriod%2A>.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A>  
 <span data-ttu-id="768cd-175">Pokud je povoleno, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> se pokusí načíst uzamčenou instanci po dobu následujících 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="768cd-175">If enabled, the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> retries to load a locked instance for the next 30 seconds.</span></span> <span data-ttu-id="768cd-176">Nastavte <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> na BasicRetry nebo AggressiveRetry, pokud pracovní postup obdrží více zpráv krátkou dobu a tyto zprávy jsou přijímány různými počítači.</span><span class="sxs-lookup"><span data-stu-id="768cd-176">Set <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> to BasicRetry or AggressiveRetry if the workflow receives multiple messages in a short time, and these messages are received by different computers.</span></span>  
  
 <span data-ttu-id="768cd-177">Vzhledem k tomu, že mechanismus pro opakování zátěže nezavádí žádné nároky na výkon, dokud nedojde k pokusu o zatížení, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> by měla být vždy povolena.</span><span class="sxs-lookup"><span data-stu-id="768cd-177">Because the load retry mechanism does not introduce any performance overhead as long as load retries are not tried, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> should always be enabled.</span></span>
