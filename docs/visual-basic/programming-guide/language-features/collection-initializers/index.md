---
title: Inicializátory kolekce
ms.date: 07/20/2015
f1_keywords:
- vb.CollectionInitializer
helpviewer_keywords:
- collection initializers [Visual Basic]
ms.assetid: a9290329-77b0-4fdf-ae75-8fc17287f469
ms.openlocfilehash: fbdd116298c530ae54677631eff7dac2f22c0fe2
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/22/2019
ms.locfileid: "74346786"
---
# <a name="collection-initializers-visual-basic"></a><span data-ttu-id="e2b70-102">Inicializátory kolekcí (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="e2b70-102">Collection Initializers (Visual Basic)</span></span>

<span data-ttu-id="e2b70-103">*Inicializátory kolekce* poskytují zkrácenou syntaxi, která umožňuje vytvořit kolekci a naplnit ji počáteční sadou hodnot.</span><span class="sxs-lookup"><span data-stu-id="e2b70-103">*Collection initializers* provide a shortened syntax that enables you to create a collection and populate it with an initial set of values.</span></span> <span data-ttu-id="e2b70-104">Inicializátory kolekce jsou užitečné při vytváření kolekce ze sady známých hodnot, například seznamu možností nabídky nebo kategorií, počáteční sady číselných hodnot, statického seznamu řetězců, jako jsou například názvy dnů nebo měsíců nebo zeměpisná umístění, jako je například seznam stavů, které se použijí k ověření.</span><span class="sxs-lookup"><span data-stu-id="e2b70-104">Collection initializers are useful when you are creating a collection from a set of known values, for example, a list of menu options or categories, an initial set of numeric values, a static list of strings such as day or month names, or geographic locations such as a list of states that is used for validation.</span></span>

<span data-ttu-id="e2b70-105">Další informace o kolekcích najdete v tématu [kolekce](../../../../visual-basic/programming-guide/concepts/collections.md).</span><span class="sxs-lookup"><span data-stu-id="e2b70-105">For more information about collections, see [Collections](../../../../visual-basic/programming-guide/concepts/collections.md).</span></span>

<span data-ttu-id="e2b70-106">Inicializátor kolekce identifikujete pomocí klíčového slova `From`, po kterém následují složené závorky (`{}`).</span><span class="sxs-lookup"><span data-stu-id="e2b70-106">You identify a collection initializer by using the `From` keyword followed by braces (`{}`).</span></span> <span data-ttu-id="e2b70-107">Toto je podobné syntaxi literálu pole, která je popsána v [poli](../../../../visual-basic/programming-guide/language-features/arrays/index.md).</span><span class="sxs-lookup"><span data-stu-id="e2b70-107">This is similar to the array literal syntax that is described in [Arrays](../../../../visual-basic/programming-guide/language-features/arrays/index.md).</span></span> <span data-ttu-id="e2b70-108">Následující příklady znázorňují různé způsoby použití inicializátorů kolekcí k vytváření kolekcí.</span><span class="sxs-lookup"><span data-stu-id="e2b70-108">The following examples show various ways to use collection initializers to create collections.</span></span>

[!code-vb[VbVbalrCollectionInitializers#1](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#1)]

> [!NOTE]
> <span data-ttu-id="e2b70-109">C#také poskytuje inicializátory kolekce.</span><span class="sxs-lookup"><span data-stu-id="e2b70-109">C# also provides collection initializers.</span></span> <span data-ttu-id="e2b70-110">C#inicializátory kolekce poskytují stejné funkce jako Visual Basic Inicializátory kolekcí.</span><span class="sxs-lookup"><span data-stu-id="e2b70-110">C# collection initializers provide the same functionality as Visual Basic collection initializers.</span></span> <span data-ttu-id="e2b70-111">Další informace o C# inicializátorech kolekce naleznete v tématu [Inicializátory objektů a kolekcí](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md).</span><span class="sxs-lookup"><span data-stu-id="e2b70-111">For more information about C# collection initializers, see [Object and Collection Initializers](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md).</span></span>

## <a name="syntax"></a><span data-ttu-id="e2b70-112">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="e2b70-112">Syntax</span></span>

<span data-ttu-id="e2b70-113">Inicializátor kolekce se skládá ze seznamu hodnot oddělených čárkami, které jsou uzavřeny v závorkách (`{}`) před klíčovým slovem `From`, jak je znázorněno v následujícím kódu.</span><span class="sxs-lookup"><span data-stu-id="e2b70-113">A collection initializer consists of a list of comma-separated values that are enclosed in braces (`{}`), preceded by the `From` keyword, as shown in the following code.</span></span>

[!code-vb[VbVbalrCollectionInitializers#2](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#2)]

<span data-ttu-id="e2b70-114">Při vytváření kolekce, jako je například <xref:System.Collections.Generic.List%601> nebo <xref:System.Collections.Generic.Dictionary%602>, je nutné před inicializátorem kolekce zadat typ kolekce, jak je znázorněno v následujícím kódu.</span><span class="sxs-lookup"><span data-stu-id="e2b70-114">When you create a collection, such as a <xref:System.Collections.Generic.List%601> or a <xref:System.Collections.Generic.Dictionary%602>, you must supply the collection type before the collection initializer, as shown in the following code.</span></span>

[!code-vb[VbVbalrCollectionInitializers#13](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#13)]

> [!NOTE]
> <span data-ttu-id="e2b70-115">Nelze kombinovat inicializátor kolekce a inicializátor objektu pro inicializaci stejného objektu kolekce.</span><span class="sxs-lookup"><span data-stu-id="e2b70-115">You cannot combine both a collection initializer and an object initializer to initialize the same collection object.</span></span> <span data-ttu-id="e2b70-116">Můžete použít inicializátory objektů k inicializaci objektů v inicializátoru kolekce.</span><span class="sxs-lookup"><span data-stu-id="e2b70-116">You can use object initializers to initialize objects in a collection initializer.</span></span>

## <a name="creating-a-collection-by-using-a-collection-initializer"></a><span data-ttu-id="e2b70-117">Vytvoření kolekce pomocí inicializátoru kolekce</span><span class="sxs-lookup"><span data-stu-id="e2b70-117">Creating a Collection by Using a Collection Initializer</span></span>

<span data-ttu-id="e2b70-118">Když vytváříte kolekci pomocí inicializátoru kolekce, každá hodnota, která je zadána v inicializátoru kolekce, je předána příslušné `Add` metodě kolekce.</span><span class="sxs-lookup"><span data-stu-id="e2b70-118">When you create a collection by using a collection initializer, each value that is supplied in the collection initializer is passed to the appropriate `Add` method of the collection.</span></span> <span data-ttu-id="e2b70-119">Například pokud vytvoříte <xref:System.Collections.Generic.List%601> pomocí inicializátoru kolekce, každá řetězcová hodnota v inicializátoru kolekce je předána metodě <xref:System.Collections.Generic.List%601.Add%2A>.</span><span class="sxs-lookup"><span data-stu-id="e2b70-119">For example, if you create a <xref:System.Collections.Generic.List%601> by using a collection initializer, each string value in the collection initializer is passed to the <xref:System.Collections.Generic.List%601.Add%2A> method.</span></span> <span data-ttu-id="e2b70-120">Pokud chcete vytvořit kolekci pomocí inicializátoru kolekce, zadaný typ musí být platný typ kolekce.</span><span class="sxs-lookup"><span data-stu-id="e2b70-120">If you want to create a collection by using a collection initializer, the specified type must be valid collection type.</span></span> <span data-ttu-id="e2b70-121">Příklady platných typů kolekcí zahrnují třídy, které implementují rozhraní <xref:System.Collections.Generic.IEnumerable%601> nebo dědí <xref:System.Collections.CollectionBase> třídy.</span><span class="sxs-lookup"><span data-stu-id="e2b70-121">Examples of valid collection types include classes that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or inherit the <xref:System.Collections.CollectionBase> class.</span></span> <span data-ttu-id="e2b70-122">Zadaný typ musí také vystavit `Add` metodu, která splňuje následující kritéria.</span><span class="sxs-lookup"><span data-stu-id="e2b70-122">The specified type must also expose an `Add` method that meets the following criteria.</span></span>

- <span data-ttu-id="e2b70-123">Metoda `Add` musí být k dispozici z oboru, ve kterém je volán inicializátor kolekce.</span><span class="sxs-lookup"><span data-stu-id="e2b70-123">The `Add` method must be available from the scope in which the collection initializer is being called.</span></span> <span data-ttu-id="e2b70-124">Metoda `Add` nemusí být veřejná, pokud používáte inicializátor kolekce v situaci, kdy je k dispozici neveřejné metody kolekce.</span><span class="sxs-lookup"><span data-stu-id="e2b70-124">The `Add` method does not have to be public if you are using the collection initializer in a scenario where non-public methods of the collection can be accessed.</span></span>

- <span data-ttu-id="e2b70-125">Metoda `Add` musí být členem instance nebo `Shared` členem třídy kolekce nebo metodou rozšíření.</span><span class="sxs-lookup"><span data-stu-id="e2b70-125">The `Add` method must be an instance member or `Shared` member of the collection class, or an extension method.</span></span>

- <span data-ttu-id="e2b70-126">Musí existovat `Add` metoda, která může odpovídat na základě pravidel Rozlišení přetěžování na typy, které jsou zadány v inicializátoru kolekce.</span><span class="sxs-lookup"><span data-stu-id="e2b70-126">An `Add` method must exist that can be matched, based on overload resolution rules, to the types that are supplied in the collection initializer.</span></span>

 <span data-ttu-id="e2b70-127">Například následující příklad kódu ukazuje, jak vytvořit kolekci `List(Of Customer)` pomocí inicializátoru kolekce.</span><span class="sxs-lookup"><span data-stu-id="e2b70-127">For example, the following code example shows how to create a `List(Of Customer)` collection by using a collection initializer.</span></span> <span data-ttu-id="e2b70-128">Při spuštění kódu je každý objekt `Customer` předán metodě `Add(Customer)` obecného seznamu.</span><span class="sxs-lookup"><span data-stu-id="e2b70-128">When the code is run, each `Customer` object is passed to the `Add(Customer)` method of the generic list.</span></span>

[!code-vb[VbVbalrCollectionInitializers#9](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#9)]

<span data-ttu-id="e2b70-129">Následující příklad kódu ukazuje ekvivalentní kód, který nepoužívá inicializátor kolekce.</span><span class="sxs-lookup"><span data-stu-id="e2b70-129">The following code example shows equivalent code that does not use a collection initializer.</span></span>

[!code-vb[VbVbalrCollectionInitializers#10](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#10)]

<span data-ttu-id="e2b70-130">Pokud má kolekce `Add` metodu, která má parametry odpovídající konstruktoru pro objekt `Customer`, mohli byste vnořit hodnoty parametrů pro metodu `Add` v rámci inicializátorů kolekce, jak je popsáno v následující části.</span><span class="sxs-lookup"><span data-stu-id="e2b70-130">If the collection has an `Add` method that has parameters that match the constructor for the `Customer` object, you could nest parameter values for the `Add` method within collection initializers, as discussed in the next section.</span></span> <span data-ttu-id="e2b70-131">Pokud kolekce neobsahuje takovou `Add` metodu, můžete ji vytvořit jako metodu rozšíření.</span><span class="sxs-lookup"><span data-stu-id="e2b70-131">If the collection does not have such an `Add` method, you can create one as an extension method.</span></span> <span data-ttu-id="e2b70-132">Příklad, jak vytvořit metodu `Add` jako metodu rozšíření pro kolekci, naleznete v tématu [How to: Create a Add rozšiřující metodu, kterou používá inicializátor kolekce](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md).</span><span class="sxs-lookup"><span data-stu-id="e2b70-132">For an example of how to create an `Add` method as an extension method for a collection, see [How to: Create an Add Extension Method Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md).</span></span> <span data-ttu-id="e2b70-133">Příklad vytvoření vlastní kolekce, která může být použita s inicializátorem kolekce, naleznete v tématu [How to: Create a Collection použit inicializátorem kolekce](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md).</span><span class="sxs-lookup"><span data-stu-id="e2b70-133">For an example of how to create a custom collection that can be used with a collection initializer, see [How to: Create a Collection Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md).</span></span>

## <a name="nesting-collection-initializers"></a><span data-ttu-id="e2b70-134">Vnořování inicializátorů kolekce</span><span class="sxs-lookup"><span data-stu-id="e2b70-134">Nesting Collection Initializers</span></span>

<span data-ttu-id="e2b70-135">Můžete vnořit hodnoty do inicializátoru kolekce a identifikovat konkrétní přetížení metody `Add` pro kolekci, která se vytváří.</span><span class="sxs-lookup"><span data-stu-id="e2b70-135">You can nest values within a collection initializer to identify a specific overload of an `Add` method for the collection that is being created.</span></span> <span data-ttu-id="e2b70-136">Hodnoty předané metodě `Add` musí být odděleny čárkami a uzavřeny ve složených závorkách (`{}`), jako by to bylo provedeno v literálu pole nebo inicializátoru kolekce.</span><span class="sxs-lookup"><span data-stu-id="e2b70-136">The values passed to the `Add` method must be separated by commas and enclosed in braces (`{}`), like you would do in an array literal or collection initializer.</span></span>

<span data-ttu-id="e2b70-137">Při vytváření kolekce pomocí vnořených hodnot je každý prvek seznamu vnořených hodnot předán jako argument metodě `Add`, která odpovídá typům prvků.</span><span class="sxs-lookup"><span data-stu-id="e2b70-137">When you create a collection by using nested values, each element of the nested value list is passed as an argument to the `Add` method that matches the element types.</span></span> <span data-ttu-id="e2b70-138">Například následující příklad kódu vytvoří <xref:System.Collections.Generic.Dictionary%602>, ve kterém jsou klíče typu `Integer` a hodnoty jsou typu `String`.</span><span class="sxs-lookup"><span data-stu-id="e2b70-138">For example, the following code example creates a <xref:System.Collections.Generic.Dictionary%602> in which the keys are of type `Integer` and the values are of type `String`.</span></span> <span data-ttu-id="e2b70-139">Každý z vnořených seznamů hodnot se shoduje s metodou <xref:System.Collections.Generic.Dictionary%602.Add%2A> pro `Dictionary`.</span><span class="sxs-lookup"><span data-stu-id="e2b70-139">Each of the nested value lists is matched to the <xref:System.Collections.Generic.Dictionary%602.Add%2A> method for the `Dictionary`.</span></span>

[!code-vb[VbVbalrCollectionInitializers#5](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#5)]

<span data-ttu-id="e2b70-140">Předchozí příklad kódu je ekvivalentní následujícímu kódu.</span><span class="sxs-lookup"><span data-stu-id="e2b70-140">The previous code example is equivalent to the following code.</span></span>

[!code-vb[VbVbalrCollectionInitializers#6](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#6)]

<span data-ttu-id="e2b70-141">Do metody `Add` pro typ kolekce jsou odesílány pouze seznamy s vnořenými hodnotami z první úrovně vnoření.</span><span class="sxs-lookup"><span data-stu-id="e2b70-141">Only nested value lists from the first level of nesting are sent to the `Add` method for the collection type.</span></span> <span data-ttu-id="e2b70-142">Hlubší úrovně vnoření jsou považovány za pole literálů a vnořené seznamy hodnot se neshodují s metodou `Add` žádné kolekce.</span><span class="sxs-lookup"><span data-stu-id="e2b70-142">Deeper levels of nesting are treated as array literals and the nested value lists are not matched to the `Add` method of any collection.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e2b70-143">Související témata</span><span class="sxs-lookup"><span data-stu-id="e2b70-143">Related Topics</span></span>

|<span data-ttu-id="e2b70-144">Titul</span><span class="sxs-lookup"><span data-stu-id="e2b70-144">Title</span></span>|<span data-ttu-id="e2b70-145">Popis</span><span class="sxs-lookup"><span data-stu-id="e2b70-145">Description</span></span>|
|---|---|
|[<span data-ttu-id="e2b70-146">Postupy: Vytvoření metody přidání rozšíření používané inicializátorem kolekce</span><span class="sxs-lookup"><span data-stu-id="e2b70-146">How to: Create an Add Extension Method Used by a Collection Initializer</span></span>](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md)|<span data-ttu-id="e2b70-147">Ukazuje, jak vytvořit metodu rozšíření nazvanou `Add`, kterou lze použít k naplnění kolekce hodnotami z inicializátoru kolekce.</span><span class="sxs-lookup"><span data-stu-id="e2b70-147">Shows how to create an extension method called `Add` that can be used to populate a collection with values from a collection initializer.</span></span>|
|[<span data-ttu-id="e2b70-148">Postupy: Vytvoření kolekce používané inicializátorem kolekce</span><span class="sxs-lookup"><span data-stu-id="e2b70-148">How to: Create a Collection Used by a Collection Initializer</span></span>](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md)|<span data-ttu-id="e2b70-149">Ukazuje, jak povolit použití inicializátoru kolekce zahrnutím metody `Add` do třídy kolekce, která implementuje `IEnumerable`.</span><span class="sxs-lookup"><span data-stu-id="e2b70-149">Shows how to enable use of a collection initializer by including an `Add` method in a collection class that implements `IEnumerable`.</span></span>|

## <a name="see-also"></a><span data-ttu-id="e2b70-150">Viz také:</span><span class="sxs-lookup"><span data-stu-id="e2b70-150">See also</span></span>

- [<span data-ttu-id="e2b70-151">Kolekce</span><span class="sxs-lookup"><span data-stu-id="e2b70-151">Collections</span></span>](../../../../visual-basic/programming-guide/concepts/collections.md)
- [<span data-ttu-id="e2b70-152">Pole</span><span class="sxs-lookup"><span data-stu-id="e2b70-152">Arrays</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/index.md)
- [<span data-ttu-id="e2b70-153">Inicializátory objektů: pojmenované a anonymní typy</span><span class="sxs-lookup"><span data-stu-id="e2b70-153">Object Initializers: Named and Anonymous Types</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)
- [<span data-ttu-id="e2b70-154">Operátor New</span><span class="sxs-lookup"><span data-stu-id="e2b70-154">New Operator</span></span>](../../../../visual-basic/language-reference/operators/new-operator.md)
- [<span data-ttu-id="e2b70-155">Automaticky implementované vlastnosti</span><span class="sxs-lookup"><span data-stu-id="e2b70-155">Auto-Implemented Properties</span></span>](../../../../visual-basic/programming-guide/language-features/procedures/auto-implemented-properties.md)
- [<span data-ttu-id="e2b70-156">Postupy: Inicializace proměnné pole v Visual Basic</span><span class="sxs-lookup"><span data-stu-id="e2b70-156">How to: Initialize an Array Variable in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)
- [<span data-ttu-id="e2b70-157">Odvození místního typu</span><span class="sxs-lookup"><span data-stu-id="e2b70-157">Local Type Inference</span></span>](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)
- [<span data-ttu-id="e2b70-158">Anonymní typy</span><span class="sxs-lookup"><span data-stu-id="e2b70-158">Anonymous Types</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)
- [<span data-ttu-id="e2b70-159">Úvod do jazyka LINQ v Visual Basic</span><span class="sxs-lookup"><span data-stu-id="e2b70-159">Introduction to LINQ in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)
- [<span data-ttu-id="e2b70-160">Postupy: Vytvoření seznamu položek</span><span class="sxs-lookup"><span data-stu-id="e2b70-160">How to: Create a List of Items</span></span>](../../../../visual-basic/programming-guide/concepts/linq/how-to-create-a-list-of-items.md)
