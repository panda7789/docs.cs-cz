---
title: Bezpečné kódování pro rozhraní .NET
description: Návrhový kód pro práci s . NET vynucená oprávnění a další vynucení, které pomáhají zabránit škodlivému kódu v přístupu k datům nebo provádění jiných akcí.
ms.date: 06/28/2018
helpviewer_keywords:
- managed wrapper to native code implementation
- secure coding
- reusable components
- library code that exposes protected resources
- code, security
- code security
- secure coding, options
- components [.NET], security
- code security, options
- security-neutral code
- security [.NET], coding guidelines
ms.assetid: 4f882d94-262b-4494-b0a6-ba9ba1f5f177
ms.openlocfilehash: 05f7e039ecdc0cd33baa015872924fb9e1f078aa
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/12/2020
ms.locfileid: "79187731"
---
# <a name="secure-coding-guidelines"></a><span data-ttu-id="d62cb-103">Bezpečné kódování pokyny</span><span class="sxs-lookup"><span data-stu-id="d62cb-103">Secure coding guidelines</span></span>

<span data-ttu-id="d62cb-104">Zabezpečení založené na důkazech a zabezpečení přístupu kódu poskytují velmi výkonné, explicitní mechanismy pro implementaci zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="d62cb-104">Evidence-based security and code access security provide very powerful, explicit mechanisms to implement security.</span></span> <span data-ttu-id="d62cb-105">Většina kódu aplikace můžete jednoduše použít infrastrukturu implementovanou rozhraním .NET.</span><span class="sxs-lookup"><span data-stu-id="d62cb-105">Most application code can simply use the infrastructure implemented by .NET.</span></span> <span data-ttu-id="d62cb-106">V některých případech je vyžadováno další zabezpečení specifické pro aplikaci, vytvořené rozšířením systému zabezpečení nebo pomocí nových metod ad hoc.</span><span class="sxs-lookup"><span data-stu-id="d62cb-106">In some cases, additional application-specific security is required, built either by extending the security system or by using new ad hoc methods.</span></span>

<span data-ttu-id="d62cb-107">Pomocí .NET vynucená oprávnění a další vynucení ve vašem kódu, měli byste vytvořit bariéry zabránit škodlivý kód z přístupu k informacím, které nechcete, aby měl nebo provádět jiné nežádoucí akce.</span><span class="sxs-lookup"><span data-stu-id="d62cb-107">Using .NET enforced permissions and other enforcement in your code, you should erect barriers to prevent malicious code from accessing information that you don't want it to have or performing other undesirable actions.</span></span> <span data-ttu-id="d62cb-108">Kromě toho je nutné najít rovnováhu mezi zabezpečení a použitelnosti ve všech očekávaných scénářích pomocí důvěryhodného kódu.</span><span class="sxs-lookup"><span data-stu-id="d62cb-108">Additionally, you must strike a balance between security and usability in all the expected scenarios using trusted code.</span></span>

<span data-ttu-id="d62cb-109">Tento přehled popisuje různé způsoby, jak kód může být navržen pro práci se systémem zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="d62cb-109">This overview describes the different ways code can be designed to work with the security system.</span></span>

## <a name="securing-resource-access"></a><span data-ttu-id="d62cb-110">Zabezpečení přístupu k prostředkům</span><span class="sxs-lookup"><span data-stu-id="d62cb-110">Securing resource access</span></span>

<span data-ttu-id="d62cb-111">Při navrhování a psaní kódu je třeba chránit a omezit přístup, který má kód k prostředkům, zejména při použití nebo vyvolání kódu neznámého původu.</span><span class="sxs-lookup"><span data-stu-id="d62cb-111">When designing and writing your code, you need to protect and limit the access that code has to resources, especially when using or invoking code of unknown origin.</span></span> <span data-ttu-id="d62cb-112">Takže mějte na paměti následující techniky, abyste zajistili, že váš kód je bezpečný:</span><span class="sxs-lookup"><span data-stu-id="d62cb-112">So, keep in mind the following techniques to ensure your code is secure:</span></span>

- <span data-ttu-id="d62cb-113">Nepoužívejte zabezpečení přístupu kódu (CAS).</span><span class="sxs-lookup"><span data-stu-id="d62cb-113">Do not use Code Access Security (CAS).</span></span>

- <span data-ttu-id="d62cb-114">Nepoužívejte částečný důvěryhodný kód.</span><span class="sxs-lookup"><span data-stu-id="d62cb-114">Do not use partial trusted code.</span></span>

- <span data-ttu-id="d62cb-115">Nepoužívejte atribut [AllowPartiallyTrustedCaller](xref:System.Security.AllowPartiallyTrustedCallersAttribute) (APTCA).</span><span class="sxs-lookup"><span data-stu-id="d62cb-115">Do not use the [AllowPartiallyTrustedCaller](xref:System.Security.AllowPartiallyTrustedCallersAttribute) attribute (APTCA).</span></span>

- <span data-ttu-id="d62cb-116">Nepoužívejte vzdálené komunikace .NET.</span><span class="sxs-lookup"><span data-stu-id="d62cb-116">Do not use .NET Remoting.</span></span>

- <span data-ttu-id="d62cb-117">Nepoužívejte distribuovaný model s komponentami (DCOM).</span><span class="sxs-lookup"><span data-stu-id="d62cb-117">Do not use Distributed Component Object Model (DCOM).</span></span>

- <span data-ttu-id="d62cb-118">Nepoužívejte binární formatters.</span><span class="sxs-lookup"><span data-stu-id="d62cb-118">Do not use binary formatters.</span></span>

<span data-ttu-id="d62cb-119">Zabezpečení přístupu kódu a transparentní kód zabezpečení nejsou podporovány jako hranice zabezpečení s částečně důvěryhodným kódem.</span><span class="sxs-lookup"><span data-stu-id="d62cb-119">Code Access Security and Security-Transparent Code are not supported as a security boundary with partially trusted code.</span></span> <span data-ttu-id="d62cb-120">Kód neznámého původu nedoporučujeme načítat ani spouštět, pokud nejsou nastavená alternativní bezpečnostní opatření.</span><span class="sxs-lookup"><span data-stu-id="d62cb-120">We advise against loading and executing code of unknown origins without putting alternative security measures in place.</span></span> <span data-ttu-id="d62cb-121">Alternativními bezpečnostními opatřeními jsou:</span><span class="sxs-lookup"><span data-stu-id="d62cb-121">The alternative security measures are:</span></span>

- <span data-ttu-id="d62cb-122">Virtualizace</span><span class="sxs-lookup"><span data-stu-id="d62cb-122">Virtualization</span></span>

- <span data-ttu-id="d62cb-123">Kontejnery aplikací</span><span class="sxs-lookup"><span data-stu-id="d62cb-123">AppContainers</span></span>

- <span data-ttu-id="d62cb-124">Uživatelé operačního systému (OS) a oprávnění</span><span class="sxs-lookup"><span data-stu-id="d62cb-124">Operating system (OS) users and permissions</span></span>

- <span data-ttu-id="d62cb-125">Hyper-V kontejnery</span><span class="sxs-lookup"><span data-stu-id="d62cb-125">Hyper-V containers</span></span>

## <a name="security-neutral-code"></a><span data-ttu-id="d62cb-126">Neutrální kód zabezpečení</span><span class="sxs-lookup"><span data-stu-id="d62cb-126">Security-neutral code</span></span>

<span data-ttu-id="d62cb-127">Bezpečnostní neutrální kód neprovádí nic explicitního se systémem zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="d62cb-127">Security-neutral code does nothing explicit with the security system.</span></span> <span data-ttu-id="d62cb-128">Běží s bez ohledu na oprávnění, která obdrží.</span><span class="sxs-lookup"><span data-stu-id="d62cb-128">It runs with whatever permissions it receives.</span></span> <span data-ttu-id="d62cb-129">Přestože aplikace, kterým se nepodaří zachytit výjimky zabezpečení spojené s chráněnými operacemi (například pomocí souborů, sítí a tak dále), mohou mít za následek neošetřenou výjimku, neutrální kód zabezpečení stále využívá technologie zabezpečení v rozhraní .NET .</span><span class="sxs-lookup"><span data-stu-id="d62cb-129">Although applications that fail to catch security exceptions associated with protected operations (such as using files, networking, and so on) can result in an unhandled exception, security-neutral code still takes advantage of the security technologies in .NET.</span></span>

<span data-ttu-id="d62cb-130">Neutrální knihovna se zabezpečením má zvláštní vlastnosti, kterým byste měli rozumět.</span><span class="sxs-lookup"><span data-stu-id="d62cb-130">A security-neutral library has special characteristics that you should understand.</span></span> <span data-ttu-id="d62cb-131">Předpokládejme, že vaše knihovna poskytuje prvky rozhraní API, které používají soubory nebo volají nespravovaný kód.</span><span class="sxs-lookup"><span data-stu-id="d62cb-131">Suppose your library provides API elements that use files or call unmanaged code.</span></span> <span data-ttu-id="d62cb-132">Pokud váš kód nemá odpovídající oprávnění, nespustí se podle popisu.</span><span class="sxs-lookup"><span data-stu-id="d62cb-132">If your code doesn't have the corresponding permission, it won't run as described.</span></span> <span data-ttu-id="d62cb-133">Však i v případě, že kód má oprávnění, jakýkoli kód aplikace, který jej volá, musí mít stejné oprávnění, aby mohl pracovat.</span><span class="sxs-lookup"><span data-stu-id="d62cb-133">However, even if the code has the permission, any application code that calls it must have the same permission in order to work.</span></span> <span data-ttu-id="d62cb-134">Pokud volající kód nemá správná oprávnění, <xref:System.Security.SecurityException> zobrazí se v důsledku procházení zásobníku zabezpečení přístupu kódu.</span><span class="sxs-lookup"><span data-stu-id="d62cb-134">If the calling code doesn't have the right permission, a <xref:System.Security.SecurityException> appears as a result of the code access security stack walk.</span></span>

## <a name="application-code-that-isnt-a-reusable-component"></a><span data-ttu-id="d62cb-135">Kód aplikace, který není opakovaně použitelnou součástí</span><span class="sxs-lookup"><span data-stu-id="d62cb-135">Application code that isn't a reusable component</span></span>

<span data-ttu-id="d62cb-136">Pokud je váš kód součástí aplikace, která nebude volána jiným kódem, zabezpečení je jednoduché a speciální kódování nemusí být vyžadováno.</span><span class="sxs-lookup"><span data-stu-id="d62cb-136">If your code is part of an application that won't be called by other code, security is simple and special coding might not be required.</span></span> <span data-ttu-id="d62cb-137">Nezapomeňte však, že škodlivý kód může volat váš kód.</span><span class="sxs-lookup"><span data-stu-id="d62cb-137">However, remember that malicious code can call your code.</span></span> <span data-ttu-id="d62cb-138">Zatímco zabezpečení přístupu kódu může zastavit škodlivý kód v přístupu k prostředkům, takový kód může stále číst hodnoty polí nebo vlastností, které mohou obsahovat citlivé informace.</span><span class="sxs-lookup"><span data-stu-id="d62cb-138">While code access security might stop malicious code from accessing resources, such code could still read values of your fields or properties that might contain sensitive information.</span></span>

<span data-ttu-id="d62cb-139">Navíc pokud váš kód přijímá vstup uživatele z Internetu nebo jiných nespolehlivých zdrojů, musíte být opatrní škodlivý vstup.</span><span class="sxs-lookup"><span data-stu-id="d62cb-139">Additionally, if your code accepts user input from the Internet or other unreliable sources, you must be careful about malicious input.</span></span>

## <a name="managed-wrapper-to-native-code-implementation"></a><span data-ttu-id="d62cb-140">Spravovaná obálka implementace nativního kódu</span><span class="sxs-lookup"><span data-stu-id="d62cb-140">Managed wrapper to native code implementation</span></span>

<span data-ttu-id="d62cb-141">Obvykle v tomto scénáři některé užitečné funkce je implementována v nativním kódu, který chcete zpřístupnit spravovaného kódu.</span><span class="sxs-lookup"><span data-stu-id="d62cb-141">Typically in this scenario, some useful functionality is implemented in native code that you want to make available to managed code.</span></span> <span data-ttu-id="d62cb-142">Spravované obálky jsou snadno psát pomocí platformy invoke nebo COM interop.</span><span class="sxs-lookup"><span data-stu-id="d62cb-142">Managed wrappers are easy to write using either platform invoke or COM interop.</span></span> <span data-ttu-id="d62cb-143">Pokud to však uděláte, volající obálky musí mít nespravovaná práva kódu, aby bylo možné uspět.</span><span class="sxs-lookup"><span data-stu-id="d62cb-143">However, if you do this, callers of your wrappers must have unmanaged code rights in order to succeed.</span></span> <span data-ttu-id="d62cb-144">Podle výchozích zásad to znamená, že kód stažený z intranetu nebo Internetu nebude fungovat s obálkami.</span><span class="sxs-lookup"><span data-stu-id="d62cb-144">Under default policy, this means that code downloaded from an intranet or the Internet won't work with the wrappers.</span></span>

<span data-ttu-id="d62cb-145">Místo toho, aby nespravovaný kód práva pro všechny aplikace, které používají tyto obálky, je lepší dát tato práva pouze na obálku kód.</span><span class="sxs-lookup"><span data-stu-id="d62cb-145">Instead of giving unmanaged code rights to all applications that use these wrappers, it's better to give these rights only to the wrapper code.</span></span> <span data-ttu-id="d62cb-146">Pokud základní funkce nezveřejňuje žádné prostředky a implementace je také bezpečné, obálka potřebuje pouze uplatnit svá práva, která umožňuje jakýkoli kód pro volání prostřednictvím.</span><span class="sxs-lookup"><span data-stu-id="d62cb-146">If the underlying functionality exposes no resources and the implementation is likewise safe, the wrapper only needs to assert its rights, which enables any code to call through it.</span></span> <span data-ttu-id="d62cb-147">Pokud jsou zapojeny prostředky, kódování zabezpečení by měla být stejná jako případ kódu knihovny popsané v další části.</span><span class="sxs-lookup"><span data-stu-id="d62cb-147">When resources are involved, security coding should be the same as the library code case described in the next section.</span></span> <span data-ttu-id="d62cb-148">Vzhledem k tomu, že obálka potenciálně vystavuje volající těmto prostředkům, je nutné pečlivé ověření bezpečnosti nativního kódu a je odpovědností obálky.</span><span class="sxs-lookup"><span data-stu-id="d62cb-148">Because the wrapper is potentially exposing callers to these resources, careful verification of the safety of the native code is necessary and is the wrapper's responsibility.</span></span>

## <a name="library-code-that-exposes-protected-resources"></a><span data-ttu-id="d62cb-149">Kód knihovny, který zpřístupňuje chráněné prostředky</span><span class="sxs-lookup"><span data-stu-id="d62cb-149">Library code that exposes protected resources</span></span>

<span data-ttu-id="d62cb-150">Následující přístup je nejsilnější a proto potenciálně nebezpečné (pokud se provádí nesprávně) pro kódování zabezpečení: knihovna slouží jako rozhraní pro jiný kód pro přístup k určité prostředky, které nejsou jinak k dispozici, stejně jako třídy .NET vynutit oprávnění pro prostředky, které používají.</span><span class="sxs-lookup"><span data-stu-id="d62cb-150">The following approach is the most powerful and hence potentially dangerous (if done incorrectly) for security coding: your library serves as an interface for other code to access certain resources that aren't otherwise available, just as the .NET classes enforce permissions for the resources they use.</span></span> <span data-ttu-id="d62cb-151">Všude tam, kde zpřístupníte prostředek, musí váš kód nejprve požadovat oprávnění odpovídající prostředku (to znamená, že musí provést kontrolu zabezpečení) a pak obvykle uplatnit svá práva k provedení skutečné operace.</span><span class="sxs-lookup"><span data-stu-id="d62cb-151">Wherever you expose a resource, your code must first demand the permission appropriate to the resource (that is, it must perform a security check) and then typically assert its rights to perform the actual operation.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d62cb-152">Související témata</span><span class="sxs-lookup"><span data-stu-id="d62cb-152">Related topics</span></span>

|<span data-ttu-id="d62cb-153">Nadpis</span><span class="sxs-lookup"><span data-stu-id="d62cb-153">Title</span></span>|<span data-ttu-id="d62cb-154">Popis</span><span class="sxs-lookup"><span data-stu-id="d62cb-154">Description</span></span>|
|-----------|-----------------|
|[<span data-ttu-id="d62cb-155">Zabezpečení stavových dat</span><span class="sxs-lookup"><span data-stu-id="d62cb-155">Securing State Data</span></span>](securing-state-data.md)|<span data-ttu-id="d62cb-156">Popisuje, jak chránit soukromé členy.</span><span class="sxs-lookup"><span data-stu-id="d62cb-156">Describes how to protect private members.</span></span>|
|[<span data-ttu-id="d62cb-157">Zabezpečení a uživatelský vstup</span><span class="sxs-lookup"><span data-stu-id="d62cb-157">Security and User Input</span></span>](security-and-user-input.md)|<span data-ttu-id="d62cb-158">Popisuje problémy se zabezpečením aplikací, které přijímají vstup uživatele.</span><span class="sxs-lookup"><span data-stu-id="d62cb-158">Describes security concerns for applications that accept user input.</span></span>|
|[<span data-ttu-id="d62cb-159">Zabezpečení a konflikty časování</span><span class="sxs-lookup"><span data-stu-id="d62cb-159">Security and Race Conditions</span></span>](security-and-race-conditions.md)|<span data-ttu-id="d62cb-160">Popisuje, jak se vyhnout sporech v kódu.</span><span class="sxs-lookup"><span data-stu-id="d62cb-160">Describes how to avoid race conditions in your code.</span></span>|
|[<span data-ttu-id="d62cb-161">Zabezpečení a průběžné vytváření kódu</span><span class="sxs-lookup"><span data-stu-id="d62cb-161">Security and On-the-Fly Code Generation</span></span>](security-and-on-the-fly-code-generation.md)|<span data-ttu-id="d62cb-162">Popisuje problémy se zabezpečením aplikací, které generují dynamický kód.</span><span class="sxs-lookup"><span data-stu-id="d62cb-162">Describes security concerns for applications that generate dynamic code.</span></span>|
|[<span data-ttu-id="d62cb-163">Zabezpečení na základě rolí</span><span class="sxs-lookup"><span data-stu-id="d62cb-163">Role-Based Security</span></span>](role-based-security.md)|<span data-ttu-id="d62cb-164">Podrobně popisuje zabezpečení založené na rolích rozhraní .NET a poskytuje pokyny pro jeho použití v kódu.</span><span class="sxs-lookup"><span data-stu-id="d62cb-164">Describes .NET role-based security in detail and provides instructions for using it in your code.</span></span>|
