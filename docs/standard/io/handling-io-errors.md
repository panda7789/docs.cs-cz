---
title: Zpracování vstupně-výstupních chyb v .NET
description: Přečtěte si, jak zpracovávat chyby v/v v .NET. Mapování kódů chyb na výjimky, zpracování výjimek v vstupně-výstupních operacích a zpracování IOException.
ms.date: 08/27/2018
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- I/O, exception handling
- I/O, errors
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: 45f3951b727d3b615d8384541ff169e8840acab0
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/09/2020
ms.locfileid: "84599799"
---
# <a name="handling-io-errors-in-net"></a><span data-ttu-id="1d6c4-104">Zpracování vstupně-výstupních chyb v .NET</span><span class="sxs-lookup"><span data-stu-id="1d6c4-104">Handling I/O errors in .NET</span></span>

<span data-ttu-id="1d6c4-105">Kromě výjimek, které mohou být vyvolány v jakémkoli volání metody (například <xref:System.OutOfMemoryException> při zdůraznění systému nebo v <xref:System.NullReferenceException> důsledku chyby programátora), mohou metody systému souborů .NET vyvolat následující výjimky:</span><span class="sxs-lookup"><span data-stu-id="1d6c4-105">In addition to the exceptions that can be thrown in any method call (such as an <xref:System.OutOfMemoryException> when a system is stressed or an <xref:System.NullReferenceException> due to programmer error), .NET file system methods can throw the following exceptions:</span></span>

- <span data-ttu-id="1d6c4-106"><xref:System.IO.IOException?displayProperty=nameWithType>, základní třída všech <xref:System.IO> typů výjimek.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-106"><xref:System.IO.IOException?displayProperty=nameWithType>, the base class of all <xref:System.IO> exception types.</span></span> <span data-ttu-id="1d6c4-107">Je vyvolána pro chyby, jejichž návratové kódy z operačního systému nejsou přímo mapovány na žádný jiný typ výjimky.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-107">It is thrown for errors whose return codes from the operating system don't directly map to any other exception type.</span></span>
- <span data-ttu-id="1d6c4-108"><xref:System.IO.FileNotFoundException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-108"><xref:System.IO.FileNotFoundException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="1d6c4-109"><xref:System.IO.DirectoryNotFoundException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-109"><xref:System.IO.DirectoryNotFoundException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="1d6c4-110"><xref:System.IO.DriveNotFoundException??displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-110"><xref:System.IO.DriveNotFoundException??displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="1d6c4-111"><xref:System.IO.PathTooLongException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-111"><xref:System.IO.PathTooLongException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="1d6c4-112"><xref:System.OperationCanceledException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-112"><xref:System.OperationCanceledException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="1d6c4-113"><xref:System.UnauthorizedAccessException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-113"><xref:System.UnauthorizedAccessException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="1d6c4-114"><xref:System.ArgumentException?displayProperty=nameWithType>, která je vyvolána pro neplatné znaky cesty v .NET Framework a v .NET Core 2,0 a předchozích verzích.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-114"><xref:System.ArgumentException?displayProperty=nameWithType>, which is thrown for invalid path characters on .NET Framework and on .NET Core 2.0 and previous versions.</span></span>
- <span data-ttu-id="1d6c4-115"><xref:System.NotSupportedException?displayProperty=nameWithType>, který je vyvolána pro neplatná dvojtečka v .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-115"><xref:System.NotSupportedException?displayProperty=nameWithType>, which is thrown for invalid colons in .NET Framework.</span></span>
- <span data-ttu-id="1d6c4-116"><xref:System.Security.SecurityException?displayProperty=nameWithType>, který je vyvolána pro aplikace spuštěné v omezeném vztahu důvěryhodnosti, které nemají potřebná oprávnění pouze pro .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-116"><xref:System.Security.SecurityException?displayProperty=nameWithType>, which is thrown for applications running in limited trust that lack the necessary permissions on .NET Framework only.</span></span> <span data-ttu-id="1d6c4-117">(Ve výchozím nastavení je nastavená plná důvěryhodnost .NET Framework.)</span><span class="sxs-lookup"><span data-stu-id="1d6c4-117">(Full trust is the default on .NET Framework.)</span></span>

## <a name="mapping-error-codes-to-exceptions"></a><span data-ttu-id="1d6c4-118">Mapování kódů chyb na výjimky</span><span class="sxs-lookup"><span data-stu-id="1d6c4-118">Mapping error codes to exceptions</span></span>

<span data-ttu-id="1d6c4-119">Vzhledem k tomu, že systém souborů je prostředkem operačního systému, vstupně-výstupní metody v rozhraní .NET Core a .NET Framework zabalit volání do základního operačního systému.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-119">Because the file system is an operating system resource, I/O methods in both .NET Core and .NET Framework wrap calls to the underlying operating system.</span></span> <span data-ttu-id="1d6c4-120">Pokud dojde k vstupně-výstupní chybě v kódu spuštěném operačním systémem, operační systém vrátí informace o chybě metodě .NET I/O.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-120">When an I/O error occurs in code executed by the operating system, the operating system returns error information to the .NET I/O method.</span></span> <span data-ttu-id="1d6c4-121">Metoda pak přeloží informace o chybě, obvykle ve formě kódu chyby, do typu výjimky .NET.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-121">The method then translates the error information, typically in the form of an error code, into a .NET exception type.</span></span> <span data-ttu-id="1d6c4-122">Ve většině případů to dělá přímo v překladu kódu chyby na odpovídající typ výjimky; neprovádí žádné speciální mapování chyb na základě kontextu volání metody.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-122">In most cases, it does this by directly translating the error code into its corresponding exception type; it does not perform any special mapping of the error based on the context of the method call.</span></span>

<span data-ttu-id="1d6c4-123">Například v operačním systému Windows, volání metody, které vrací chybový kód `ERROR_FILE_NOT_FOUND` (nebo 0x02), mapuje na a <xref:System.IO.FileNotFoundException> , a chybový kód `ERROR_PATH_NOT_FOUND` (nebo 0x03) se mapuje na <xref:System.IO.DirectoryNotFoundException> .</span><span class="sxs-lookup"><span data-stu-id="1d6c4-123">For example, on the Windows operating system, a method call that returns an error code of `ERROR_FILE_NOT_FOUND` (or 0x02) maps to a <xref:System.IO.FileNotFoundException>, and an error code of `ERROR_PATH_NOT_FOUND` (or 0x03) maps to a <xref:System.IO.DirectoryNotFoundException>.</span></span>

<span data-ttu-id="1d6c4-124">Přesné podmínky, za kterých operační systém vrátí konkrétní kódy chyb, ale často nedokumentují nebo špatně zdokumentují.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-124">However, the precise conditions under which the operating system returns particular error codes is often undocumented or poorly documented.</span></span> <span data-ttu-id="1d6c4-125">Výsledkem je, že může dojít k neočekávaným výjimkám.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-125">As a result, unexpected exceptions can occur.</span></span> <span data-ttu-id="1d6c4-126">Například vzhledem k tomu, že pracujete s adresářem namísto souboru, očekáváte, že zadáním neplatné cesty adresáře pro <xref:System.IO.DirectoryInfo.%23ctor%2A> konstruktor vyvolá <xref:System.IO.DirectoryNotFoundException> .</span><span class="sxs-lookup"><span data-stu-id="1d6c4-126">For example, because you are working with a directory rather than a file, you would expect that providing an invalid directory path to the <xref:System.IO.DirectoryInfo.%23ctor%2A> constructor throws a <xref:System.IO.DirectoryNotFoundException>.</span></span> <span data-ttu-id="1d6c4-127">Může však také vyvolat výjimku <xref:System.IO.FileNotFoundException> .</span><span class="sxs-lookup"><span data-stu-id="1d6c4-127">However, it may also throw a <xref:System.IO.FileNotFoundException>.</span></span>

## <a name="exception-handling-in-io-operations"></a><span data-ttu-id="1d6c4-128">Zpracování výjimek v vstupně-výstupních operacích</span><span class="sxs-lookup"><span data-stu-id="1d6c4-128">Exception handling in I/O operations</span></span>

<span data-ttu-id="1d6c4-129">Vzhledem k tomu, že se jedná o závislé na operačním systému, může být výsledkem identické podmínky výjimky (například Chyba adresář nebyl nalezen v našem příkladu).</span><span class="sxs-lookup"><span data-stu-id="1d6c4-129">Because of this reliance on the operating system, identical exception conditions (such as the directory not found error in our example) can result in an I/O method throwing any one of the entire class of I/O exceptions.</span></span> <span data-ttu-id="1d6c4-130">To znamená, že při volání rozhraní API v/v by měl být váš kód připraven zpracovat většinu nebo všechny tyto výjimky, jak je znázorněno v následující tabulce:</span><span class="sxs-lookup"><span data-stu-id="1d6c4-130">This means that, when calling I/O APIs, your code should be prepared to handle most or all of these exceptions, as shown in the following table:</span></span>

| <span data-ttu-id="1d6c4-131">Typ výjimky</span><span class="sxs-lookup"><span data-stu-id="1d6c4-131">Exception type</span></span> | <span data-ttu-id="1d6c4-132">.NET Core</span><span class="sxs-lookup"><span data-stu-id="1d6c4-132">.NET Core</span></span> | <span data-ttu-id="1d6c4-133">.NET Framework</span><span class="sxs-lookup"><span data-stu-id="1d6c4-133">.NET Framework</span></span> |
|---|---|---|
| <xref:System.IO.IOException> | <span data-ttu-id="1d6c4-134">Ano</span><span class="sxs-lookup"><span data-stu-id="1d6c4-134">Yes</span></span> | <span data-ttu-id="1d6c4-135">Ano</span><span class="sxs-lookup"><span data-stu-id="1d6c4-135">Yes</span></span> |
| <xref:System.IO.FileNotFoundException> | <span data-ttu-id="1d6c4-136">Ano</span><span class="sxs-lookup"><span data-stu-id="1d6c4-136">Yes</span></span> | <span data-ttu-id="1d6c4-137">Ano</span><span class="sxs-lookup"><span data-stu-id="1d6c4-137">Yes</span></span> |
| <xref:System.IO.DirectoryNotFoundException> | <span data-ttu-id="1d6c4-138">Ano</span><span class="sxs-lookup"><span data-stu-id="1d6c4-138">Yes</span></span> | <span data-ttu-id="1d6c4-139">Ano</span><span class="sxs-lookup"><span data-stu-id="1d6c4-139">Yes</span></span> |
| <xref:System.IO.DriveNotFoundException?> | <span data-ttu-id="1d6c4-140">Ano</span><span class="sxs-lookup"><span data-stu-id="1d6c4-140">Yes</span></span> | <span data-ttu-id="1d6c4-141">Ano</span><span class="sxs-lookup"><span data-stu-id="1d6c4-141">Yes</span></span> |
| <xref:System.IO.PathTooLongException> | <span data-ttu-id="1d6c4-142">Ano</span><span class="sxs-lookup"><span data-stu-id="1d6c4-142">Yes</span></span> | <span data-ttu-id="1d6c4-143">Ano</span><span class="sxs-lookup"><span data-stu-id="1d6c4-143">Yes</span></span> |
| <xref:System.OperationCanceledException> | <span data-ttu-id="1d6c4-144">Ano</span><span class="sxs-lookup"><span data-stu-id="1d6c4-144">Yes</span></span> | <span data-ttu-id="1d6c4-145">Ano</span><span class="sxs-lookup"><span data-stu-id="1d6c4-145">Yes</span></span> |
| <xref:System.UnauthorizedAccessException> | <span data-ttu-id="1d6c4-146">Ano</span><span class="sxs-lookup"><span data-stu-id="1d6c4-146">Yes</span></span> | <span data-ttu-id="1d6c4-147">Ano</span><span class="sxs-lookup"><span data-stu-id="1d6c4-147">Yes</span></span> |
| <xref:System.ArgumentException> | <span data-ttu-id="1d6c4-148">.NET Core 2,0 a starší</span><span class="sxs-lookup"><span data-stu-id="1d6c4-148">.NET Core 2.0 and earlier</span></span>| <span data-ttu-id="1d6c4-149">Yes</span><span class="sxs-lookup"><span data-stu-id="1d6c4-149">Yes</span></span> |
| <xref:System.NotSupportedException> | <span data-ttu-id="1d6c4-150">Ne</span><span class="sxs-lookup"><span data-stu-id="1d6c4-150">No</span></span> | <span data-ttu-id="1d6c4-151">Yes</span><span class="sxs-lookup"><span data-stu-id="1d6c4-151">Yes</span></span> |
| <xref:System.Security.SecurityException> | <span data-ttu-id="1d6c4-152">Ne</span><span class="sxs-lookup"><span data-stu-id="1d6c4-152">No</span></span> | <span data-ttu-id="1d6c4-153">Jenom omezená důvěra</span><span class="sxs-lookup"><span data-stu-id="1d6c4-153">Limited trust only</span></span> |

## <a name="handling-ioexception"></a><span data-ttu-id="1d6c4-154">Zpracování IOException</span><span class="sxs-lookup"><span data-stu-id="1d6c4-154">Handling IOException</span></span>

<span data-ttu-id="1d6c4-155">Jako základní třída pro výjimky v <xref:System.IO> oboru názvů <xref:System.IO.IOException> je také vyvolána pro jakýkoliv kód chyby, který není namapován na předdefinovaný typ výjimky.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-155">As the base class for exceptions in the <xref:System.IO> namespace, <xref:System.IO.IOException> is also thrown for any error code that does not map to a predefined exception type.</span></span> <span data-ttu-id="1d6c4-156">To znamená, že může být vyvolána jakoukoli operací I/O.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-156">This means that it can be thrown by any I/O operation.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="1d6c4-157">Vzhledem k tomu <xref:System.IO.IOException> , že je základní třídou dalších typů výjimek v <xref:System.IO> oboru názvů, měli byste zpracovat v `catch` bloku po zpracování dalších výjimek souvisejících s vstupem/výstupem.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-157">Because <xref:System.IO.IOException> is the base class of the other exception types in the <xref:System.IO> namespace, you should handle in a `catch` block after you've handled the other I/O-related exceptions.</span></span>

<span data-ttu-id="1d6c4-158">Kromě toho, počínaje rozhraním .NET Core 2,1, ověřuje správnost cesty (například pro zajištění, že nejsou k dispozici neplatné znaky v cestě) a modul runtime vyvolá výjimku namapovanou z kódu chyby operačního systému, nikoli z vlastního ověřovacího kódu.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-158">In addition, starting with .NET Core 2.1, validation checks for path correctness (for example, to ensure that invalid characters are not present in a path) have been removed, and the runtime throws an exception mapped from an operating system error code rather than from its own validation code.</span></span> <span data-ttu-id="1d6c4-159">Nejpravděpodobnější výjimka, která je vyvolána v tomto případě je <xref:System.IO.IOException> , i když jakýkoli jiný typ výjimky může být vyvolán také.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-159">The most likely exception to be thrown in this case is an <xref:System.IO.IOException>, although any other exception type could also be thrown.</span></span>

<span data-ttu-id="1d6c4-160">Všimněte si, že v kódu zpracování výjimek byste měli vždy zpracovat <xref:System.IO.IOException> Poslední.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-160">Note that, in your exception handling code, you should always handle the <xref:System.IO.IOException> last.</span></span> <span data-ttu-id="1d6c4-161">V opačném případě, protože se jedná o základní třídu všech ostatních výjimek v/v, nebudou vyhodnoceny bloky catch odvozených tříd.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-161">Otherwise, because it is the base class of all other IO exceptions, the catch blocks of derived classes will not be evaluated.</span></span>

<span data-ttu-id="1d6c4-162">V případě nástroje <xref:System.IO.IOException> můžete získat další informace o chybě z vlastnosti [IOException. HRESULT](xref:System.Exception.HResult) .</span><span class="sxs-lookup"><span data-stu-id="1d6c4-162">In the case of an <xref:System.IO.IOException>, you can get additional error information from the [IOException.HResult](xref:System.Exception.HResult) property.</span></span> <span data-ttu-id="1d6c4-163">Chcete-li převést hodnotu HResult na kód chyby Win32, provedete horní 16 bitů hodnoty 32.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-163">To convert the HResult value to a Win32 error code, you strip out the upper 16 bits of the 32-bit value.</span></span> <span data-ttu-id="1d6c4-164">V následující tabulce jsou uvedeny kódy chyb, které mohou být zabaleny do <xref:System.IO.IOException> .</span><span class="sxs-lookup"><span data-stu-id="1d6c4-164">The following table lists error codes that may be wrapped in an <xref:System.IO.IOException>.</span></span>

| <span data-ttu-id="1d6c4-165">HResult</span><span class="sxs-lookup"><span data-stu-id="1d6c4-165">HResult</span></span> | <span data-ttu-id="1d6c4-166">Trvalé</span><span class="sxs-lookup"><span data-stu-id="1d6c4-166">Constant</span></span> | <span data-ttu-id="1d6c4-167">Popis</span><span class="sxs-lookup"><span data-stu-id="1d6c4-167">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1d6c4-168">ERROR_SHARING_VIOLATION</span><span class="sxs-lookup"><span data-stu-id="1d6c4-168">ERROR_SHARING_VIOLATION</span></span> | <span data-ttu-id="1d6c4-169">32</span><span class="sxs-lookup"><span data-stu-id="1d6c4-169">32</span></span> | <span data-ttu-id="1d6c4-170">Chybí název souboru, nebo je soubor nebo adresář používán.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-170">The file name is missing, or the file or directory is in use.</span></span> |
| <span data-ttu-id="1d6c4-171">ERROR_FILE_EXISTS</span><span class="sxs-lookup"><span data-stu-id="1d6c4-171">ERROR_FILE_EXISTS</span></span> | <span data-ttu-id="1d6c4-172">80</span><span class="sxs-lookup"><span data-stu-id="1d6c4-172">80</span></span> | <span data-ttu-id="1d6c4-173">Soubor již existuje.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-173">The file already exists.</span></span> |
| <span data-ttu-id="1d6c4-174">ERROR_INVALID_PARAMETER</span><span class="sxs-lookup"><span data-stu-id="1d6c4-174">ERROR_INVALID_PARAMETER</span></span> | <span data-ttu-id="1d6c4-175">87</span><span class="sxs-lookup"><span data-stu-id="1d6c4-175">87</span></span> | <span data-ttu-id="1d6c4-176">Argument dodaný metodě je neplatný.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-176">An argument supplied to the method is invalid.</span></span> |
| <span data-ttu-id="1d6c4-177">ERROR_ALREADY_EXISTS</span><span class="sxs-lookup"><span data-stu-id="1d6c4-177">ERROR_ALREADY_EXISTS</span></span> | <span data-ttu-id="1d6c4-178">183</span><span class="sxs-lookup"><span data-stu-id="1d6c4-178">183</span></span> | <span data-ttu-id="1d6c4-179">Soubor nebo adresář již existuje.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-179">The file or directory already exists.</span></span> |

<span data-ttu-id="1d6c4-180">Můžete je zpracovat pomocí `When` klauzule v příkazu catch, jak ukazuje následující příklad.</span><span class="sxs-lookup"><span data-stu-id="1d6c4-180">You can handle these using a `When` clause in a catch statement, as the following example shows.</span></span>

[!code-csharp[io-exception-handling](~/samples/snippets/standard/io/io-exceptions/cs/io-exceptions.cs)]
[!code-vb[io-exception-handling](~/samples/snippets/standard/io/io-exceptions/vb/io-exceptions.vb)]

## <a name="see-also"></a><span data-ttu-id="1d6c4-181">Viz také</span><span class="sxs-lookup"><span data-stu-id="1d6c4-181">See also</span></span>

- [<span data-ttu-id="1d6c4-182">Zpracování a vyvolávání výjimek v rozhraní .NET</span><span class="sxs-lookup"><span data-stu-id="1d6c4-182">Handling and throwing exceptions in .NET</span></span>](../exceptions/index.md)
- [<span data-ttu-id="1d6c4-183">Zpracování výjimek (Task Parallel Library)</span><span class="sxs-lookup"><span data-stu-id="1d6c4-183">Exception handling (Task Parallel Library)</span></span>](../parallel-programming/exception-handling-task-parallel-library.md)
- [<span data-ttu-id="1d6c4-184">Osvědčené postupy pro výjimky</span><span class="sxs-lookup"><span data-stu-id="1d6c4-184">Best practices for exceptions</span></span>](../exceptions/best-practices-for-exceptions.md)
- [<span data-ttu-id="1d6c4-185">Používání specifických výjimek v bloku catch</span><span class="sxs-lookup"><span data-stu-id="1d6c4-185">How to use specific exceptions in a catch block</span></span>](../exceptions/how-to-use-specific-exceptions-in-a-catch-block.md)
