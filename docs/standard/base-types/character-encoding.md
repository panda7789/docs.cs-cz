---
title: Jak používat třídy kódování znaků v rozhraní .NET
description: Naučte se používat třídy kódování znaků v rozhraní .NET.
ms.date: 12/22/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- encoding, understanding
- encoding, choosing
- encoding, fallback strategy
ms.assetid: bf6d9823-4c2d-48af-b280-919c5af66ae9
ms.openlocfilehash: c626e79e7bbcd71c90775df8ee8c4d6570c29125
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/02/2020
ms.locfileid: "84290575"
---
# <a name="how-to-use-character-encoding-classes-in-net"></a><span data-ttu-id="631b0-103">Jak používat třídy kódování znaků v rozhraní .NET</span><span class="sxs-lookup"><span data-stu-id="631b0-103">How to use character encoding classes in .NET</span></span>

<span data-ttu-id="631b0-104">Tento článek vysvětluje, jak používat třídy, které .NET poskytuje pro kódování a dekódování textu pomocí různých schémat kódování.</span><span class="sxs-lookup"><span data-stu-id="631b0-104">This article explains how to use the classes that .NET provides for encoding and decoding text by using various encoding schemes.</span></span> <span data-ttu-id="631b0-105">V těchto pokynech se předpokládá, že jste si přečetli [Úvod do kódování znaků v rozhraní .NET](character-encoding-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="631b0-105">The instructions assume you have read [Introduction to character encoding in .NET](character-encoding-introduction.md).</span></span>

## <a name="encoders-and-decoders"></a><span data-ttu-id="631b0-106">Kodéry a dekodéry</span><span class="sxs-lookup"><span data-stu-id="631b0-106">Encoders and decoders</span></span>

<span data-ttu-id="631b0-107">Rozhraní .NET poskytuje třídy kódování, které kódují a dekódují text pomocí různých systémů kódování.</span><span class="sxs-lookup"><span data-stu-id="631b0-107">.NET provides encoding classes that encode and decode text by using various encoding systems.</span></span> <span data-ttu-id="631b0-108">Například <xref:System.Text.UTF8Encoding> Třída popisuje pravidla pro kódování a dekódování v kódování UTF-8.</span><span class="sxs-lookup"><span data-stu-id="631b0-108">For example, the <xref:System.Text.UTF8Encoding> class describes the rules for encoding to, and decoding from, UTF-8.</span></span> <span data-ttu-id="631b0-109">.NET používá pro instance kódování UTF-16 (reprezentované <xref:System.Text.UnicodeEncoding> třídou) `string` .</span><span class="sxs-lookup"><span data-stu-id="631b0-109">.NET uses UTF-16 encoding (represented by the <xref:System.Text.UnicodeEncoding> class) for `string` instances.</span></span> <span data-ttu-id="631b0-110">Kodéry a dekodéry jsou k dispozici pro jiná schémata kódování.</span><span class="sxs-lookup"><span data-stu-id="631b0-110">Encoders and decoders are available for other encoding schemes.</span></span>

<span data-ttu-id="631b0-111">Kódování a dekódování může také zahrnovat ověřování.</span><span class="sxs-lookup"><span data-stu-id="631b0-111">Encoding and decoding can also include validation.</span></span> <span data-ttu-id="631b0-112">Například <xref:System.Text.UnicodeEncoding> třída kontroluje všechny `char` instance v rozsahu nahrazení, aby se ujistily, že jsou v platných náhradních páru.</span><span class="sxs-lookup"><span data-stu-id="631b0-112">For example, the <xref:System.Text.UnicodeEncoding> class checks all `char` instances in the surrogate range to make sure they're in valid surrogate pairs.</span></span> <span data-ttu-id="631b0-113">Záložní strategie určuje, jak kodér zpracovává neplatné znaky nebo jak dekodér zpracovává neplatné bajty.</span><span class="sxs-lookup"><span data-stu-id="631b0-113">A fallback strategy determines how an encoder handles invalid characters or how a decoder handles invalid bytes.</span></span>

> [!WARNING]
> <span data-ttu-id="631b0-114">Třídy kódování .NET poskytují způsob, jak uložit a převést znaková data.</span><span class="sxs-lookup"><span data-stu-id="631b0-114">.NET encoding classes provide a way to store and convert character data.</span></span> <span data-ttu-id="631b0-115">Neměly by se používat k ukládání binárních dat ve formě řetězce.</span><span class="sxs-lookup"><span data-stu-id="631b0-115">They should not be used to store binary data in string form.</span></span> <span data-ttu-id="631b0-116">V závislosti na použitém kódování může převod binárních dat na formát řetězce pomocí tříd kódování způsobit neočekávané chování a vydávat nepřesná nebo poškozená data.</span><span class="sxs-lookup"><span data-stu-id="631b0-116">Depending on the encoding used, converting binary data to string format with the encoding classes can introduce unexpected behavior and produce inaccurate or corrupted data.</span></span> <span data-ttu-id="631b0-117">Chcete-li převést binární data do formuláře řetězce, použijte <xref:System.Convert.ToBase64String%2A?displayProperty=nameWithType> metodu.</span><span class="sxs-lookup"><span data-stu-id="631b0-117">To convert binary data to a string form, use the <xref:System.Convert.ToBase64String%2A?displayProperty=nameWithType> method.</span></span>

<span data-ttu-id="631b0-118">Všechny třídy kódování znaků v rozhraní .NET dědí z <xref:System.Text.Encoding?displayProperty=nameWithType> třídy, což je abstraktní třída, která definuje funkce společné pro všechna kódování znaků.</span><span class="sxs-lookup"><span data-stu-id="631b0-118">All character encoding classes in .NET inherit from the <xref:System.Text.Encoding?displayProperty=nameWithType> class, which is an abstract class that defines the functionality common to all character encodings.</span></span> <span data-ttu-id="631b0-119">Chcete-li získat přístup k jednotlivým objektům kódování implementovaným v rozhraní .NET, postupujte následovně:</span><span class="sxs-lookup"><span data-stu-id="631b0-119">To access the individual encoding objects implemented in .NET, do the following:</span></span>

- <span data-ttu-id="631b0-120">Použijte statické vlastnosti <xref:System.Text.Encoding> třídy, které vracejí objekty, které reprezentují standardní kódování znaků dostupné v rozhraní .NET (ASCII, UTF-7, UTF-8, UTF-16 a UTF-32).</span><span class="sxs-lookup"><span data-stu-id="631b0-120">Use the static properties of the <xref:System.Text.Encoding> class, which return objects that represent the standard character encodings available in .NET (ASCII, UTF-7, UTF-8, UTF-16, and UTF-32).</span></span> <span data-ttu-id="631b0-121"><xref:System.Text.Encoding.Unicode%2A?displayProperty=nameWithType>Vlastnost například vrátí <xref:System.Text.UnicodeEncoding> objekt.</span><span class="sxs-lookup"><span data-stu-id="631b0-121">For example, the <xref:System.Text.Encoding.Unicode%2A?displayProperty=nameWithType> property returns a <xref:System.Text.UnicodeEncoding> object.</span></span> <span data-ttu-id="631b0-122">Každý objekt používá náhradní zálohu ke zpracování řetězců, které nelze kódovat, a bajtů, které nelze dekódovat.</span><span class="sxs-lookup"><span data-stu-id="631b0-122">Each object uses replacement fallback to handle strings that it cannot encode and bytes that it cannot decode.</span></span> <span data-ttu-id="631b0-123">Další informace najdete v tématu [náhradní záloha](character-encoding.md#Replacement).</span><span class="sxs-lookup"><span data-stu-id="631b0-123">For more information, see [Replacement fallback](character-encoding.md#Replacement).</span></span>

- <span data-ttu-id="631b0-124">Volejte konstruktor třídy kódování.</span><span class="sxs-lookup"><span data-stu-id="631b0-124">Call the encoding's class constructor.</span></span> <span data-ttu-id="631b0-125">Tímto způsobem lze vytvořit instanci objektů pro kódování ASCII, UTF-7, UTF-8, UTF-16 a UTF-32.</span><span class="sxs-lookup"><span data-stu-id="631b0-125">Objects for the ASCII, UTF-7, UTF-8, UTF-16, and UTF-32 encodings can be instantiated in this way.</span></span> <span data-ttu-id="631b0-126">Ve výchozím nastavení každý objekt používá náhradní zálohu ke zpracování řetězců, které nemohou zakódovat a bajtů, které nelze dekódovat, ale můžete určit, že namísto toho by měla být vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="631b0-126">By default, each object uses replacement fallback to handle strings that it cannot encode and bytes that it cannot decode, but you can specify that an exception should be thrown instead.</span></span> <span data-ttu-id="631b0-127">Další informace najdete v tématu [náhradní záložní](character-encoding.md#Replacement) a náhradní [výjimka](character-encoding.md#Exception).</span><span class="sxs-lookup"><span data-stu-id="631b0-127">For more information, see [Replacement fallback](character-encoding.md#Replacement) and [Exception fallback](character-encoding.md#Exception).</span></span>

- <span data-ttu-id="631b0-128">Zavolejte <xref:System.Text.Encoding.%23ctor%28System.Int32%29> konstruktor a předejte mu celé číslo, které představuje kódování.</span><span class="sxs-lookup"><span data-stu-id="631b0-128">Call the <xref:System.Text.Encoding.%23ctor%28System.Int32%29> constructor and pass it an integer that represents the encoding.</span></span> <span data-ttu-id="631b0-129">Objekty úrovně Standard pro kódování používají náhradní zálohu a znakové stránky a dvoubajtové objekty znakové sady (DBCS) používají pro zpracování řetězců nejlepší zálohu ke zpracování řetězců, které nemohou kódovat a v bajtech, které nemohou dekódovat.</span><span class="sxs-lookup"><span data-stu-id="631b0-129">Standard encoding objects use replacement fallback, and code page and double-byte character set (DBCS) encoding objects use best-fit fallback to handle strings that they cannot encode and bytes that they cannot decode.</span></span> <span data-ttu-id="631b0-130">Další informace najdete v tématu [co nejlépe pro použití](character-encoding.md#BestFit).</span><span class="sxs-lookup"><span data-stu-id="631b0-130">For more information, see [Best-fit fallback](character-encoding.md#BestFit).</span></span>

- <span data-ttu-id="631b0-131">Zavolejte <xref:System.Text.Encoding.GetEncoding%2A?displayProperty=nameWithType> metodu, která vrátí všechny standardní, znakové stránky nebo kódování DBCS dostupné v rozhraní .NET.</span><span class="sxs-lookup"><span data-stu-id="631b0-131">Call the <xref:System.Text.Encoding.GetEncoding%2A?displayProperty=nameWithType> method, which returns any standard, code page, or DBCS encoding available in .NET.</span></span> <span data-ttu-id="631b0-132">Přetížení umožňují určit záložní objekt pro kodér i dekodér.</span><span class="sxs-lookup"><span data-stu-id="631b0-132">Overloads let you specify a fallback object for both the encoder and the decoder.</span></span>

<span data-ttu-id="631b0-133">Můžete načíst informace o všech kódováních dostupných v rozhraní .NET voláním <xref:System.Text.Encoding.GetEncodings%2A?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="631b0-133">You can retrieve information about all the encodings available in .NET by calling the <xref:System.Text.Encoding.GetEncodings%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="631b0-134">Rozhraní .NET podporuje schémata kódování znaků uvedená v následující tabulce.</span><span class="sxs-lookup"><span data-stu-id="631b0-134">.NET supports the character encoding schemes listed in the following table.</span></span>

|<span data-ttu-id="631b0-135">Encoding – třída</span><span class="sxs-lookup"><span data-stu-id="631b0-135">Encoding class</span></span>|<span data-ttu-id="631b0-136">Popis</span><span class="sxs-lookup"><span data-stu-id="631b0-136">Description</span></span>|
|--------------|-----------|
|[<span data-ttu-id="631b0-137">Abecední</span><span class="sxs-lookup"><span data-stu-id="631b0-137">ASCII</span></span>](xref:System.Text.ASCIIEncoding)|<span data-ttu-id="631b0-138">Zakóduje omezený rozsah znaků pomocí nižších sedmi bitů bajtů.</span><span class="sxs-lookup"><span data-stu-id="631b0-138">Encodes a limited range of characters by using the lower seven bits of a byte.</span></span> <span data-ttu-id="631b0-139">Protože toto kódování podporuje pouze hodnoty znaků z U + 0000 až U + 007F, ve většině případů není pro mezinárodní aplikace nedostatečné.</span><span class="sxs-lookup"><span data-stu-id="631b0-139">Because this encoding only supports character values from U+0000 through U+007F, in most cases it is inadequate for internationalized applications.</span></span>|
|[<span data-ttu-id="631b0-140">UTF-7</span><span class="sxs-lookup"><span data-stu-id="631b0-140">UTF-7</span></span>](xref:System.Text.UTF7Encoding)|<span data-ttu-id="631b0-141">Představuje znaky jako sekvence pro znaky 7 bitů ASCII.</span><span class="sxs-lookup"><span data-stu-id="631b0-141">Represents characters as sequences of 7-bit ASCII characters.</span></span> <span data-ttu-id="631b0-142">Znaky Unicode jiné než ASCII jsou reprezentovány řídicí sekvencí znaků ASCII.</span><span class="sxs-lookup"><span data-stu-id="631b0-142">Non-ASCII Unicode characters are represented by an escape sequence of ASCII characters.</span></span> <span data-ttu-id="631b0-143">UTF-7 podporuje protokoly jako e-mail a diskusní skupiny.</span><span class="sxs-lookup"><span data-stu-id="631b0-143">UTF-7 supports protocols such as email and newsgroup.</span></span> <span data-ttu-id="631b0-144">UTF-7 ale není obzvláště zabezpečená nebo robustní.</span><span class="sxs-lookup"><span data-stu-id="631b0-144">However, UTF-7 is not particularly secure or robust.</span></span> <span data-ttu-id="631b0-145">V některých případech může změna jednoho bitu oddáleně měnit výklad celého řetězce v kódování UTF-7.</span><span class="sxs-lookup"><span data-stu-id="631b0-145">In some cases, changing one bit can radically alter the interpretation of an entire UTF-7 string.</span></span> <span data-ttu-id="631b0-146">V jiných případech mohou různé řetězce UTF-7 kódovat stejný text.</span><span class="sxs-lookup"><span data-stu-id="631b0-146">In other cases, different UTF-7 strings can encode the same text.</span></span> <span data-ttu-id="631b0-147">Pro sekvence, které obsahují znaky jiné než ASCII, vyžaduje UTF-7 více místa než UTF-8 a kódování/dekódování je pomalejší.</span><span class="sxs-lookup"><span data-stu-id="631b0-147">For sequences that include non-ASCII characters, UTF-7 requires more space than UTF-8, and encoding/decoding is slower.</span></span> <span data-ttu-id="631b0-148">V důsledku toho byste měli použít UTF-8 místo UTF-7, pokud je to možné.</span><span class="sxs-lookup"><span data-stu-id="631b0-148">Consequently, you should use UTF-8 instead of UTF-7 if possible.</span></span>|
|[<span data-ttu-id="631b0-149">UTF-8</span><span class="sxs-lookup"><span data-stu-id="631b0-149">UTF-8</span></span>](xref:System.Text.UTF8Encoding)|<span data-ttu-id="631b0-150">Představuje každý bod kódu Unicode jako sekvenci jednoho až čtyř bajtů.</span><span class="sxs-lookup"><span data-stu-id="631b0-150">Represents each Unicode code point as a sequence of one to four bytes.</span></span> <span data-ttu-id="631b0-151">UTF-8 podporuje 8bitové velikosti dat a funguje dobře s mnoha stávajícími operačními systémy.</span><span class="sxs-lookup"><span data-stu-id="631b0-151">UTF-8 supports 8-bit data sizes and works well with many existing operating systems.</span></span> <span data-ttu-id="631b0-152">Pro rozsah ASCII znaků je UTF-8 totožný s kódováním ASCII a umožňuje širší skupinu znaků.</span><span class="sxs-lookup"><span data-stu-id="631b0-152">For the ASCII range of characters, UTF-8 is identical to ASCII encoding and allows a broader set of characters.</span></span> <span data-ttu-id="631b0-153">Pro skripty čínského japonštiny (CJK) ale může UTF-8 vyžadovat pro každý znak tři bajty a může způsobit větší velikost dat než UTF-16.</span><span class="sxs-lookup"><span data-stu-id="631b0-153">However, for Chinese-Japanese-Korean (CJK) scripts, UTF-8 can require three bytes for each character, and can cause larger data sizes than UTF-16.</span></span> <span data-ttu-id="631b0-154">V některých případech množství dat ASCII, jako jsou značky HTML, zarovnává větší velikost pro rozsah CJK.</span><span class="sxs-lookup"><span data-stu-id="631b0-154">Sometimes the amount of ASCII data, such as HTML tags, justifies the increased size for the CJK range.</span></span>|
|[<span data-ttu-id="631b0-155">UTF-16</span><span class="sxs-lookup"><span data-stu-id="631b0-155">UTF-16</span></span>](xref:System.Text.UnicodeEncoding)|<span data-ttu-id="631b0-156">Představuje každý bod kódu Unicode jako sekvenci jednoho nebo 2 16 celých čísel.</span><span class="sxs-lookup"><span data-stu-id="631b0-156">Represents each Unicode code point as a sequence of one or two 16-bit integers.</span></span> <span data-ttu-id="631b0-157">Většina běžných znaků Unicode vyžaduje jenom jeden bod kódu UTF-16, i když doplňkové znaky Unicode (U + 10000 a větší) vyžadují dva body náhrady v kódu UTF-16.</span><span class="sxs-lookup"><span data-stu-id="631b0-157">Most common Unicode characters require only one UTF-16 code point, although Unicode supplementary characters (U+10000 and greater) require two UTF-16 surrogate code points.</span></span> <span data-ttu-id="631b0-158">Podporují se tyto objednávky ve Little endian a v bajtech big-endian.</span><span class="sxs-lookup"><span data-stu-id="631b0-158">Both little-endian and big-endian byte orders are supported.</span></span> <span data-ttu-id="631b0-159">Kódování UTF-16 je používáno modulem CLR (Common Language Runtime) k reprezentování <xref:System.Char> a <xref:System.String> hodnotám a používá ho operační systém Windows k reprezentaci `WCHAR` hodnot.</span><span class="sxs-lookup"><span data-stu-id="631b0-159">UTF-16 encoding is used by the common language runtime to represent <xref:System.Char> and <xref:System.String> values, and it is used by the Windows operating system to represent `WCHAR` values.</span></span>|
|[<span data-ttu-id="631b0-160">UTF-32</span><span class="sxs-lookup"><span data-stu-id="631b0-160">UTF-32</span></span>](xref:System.Text.UTF32Encoding)|<span data-ttu-id="631b0-161">Představuje každý bod kódu Unicode jako 32 celé číslo.</span><span class="sxs-lookup"><span data-stu-id="631b0-161">Represents each Unicode code point as a 32-bit integer.</span></span> <span data-ttu-id="631b0-162">Podporují se tyto objednávky ve Little endian a v bajtech big-endian.</span><span class="sxs-lookup"><span data-stu-id="631b0-162">Both little-endian and big-endian byte orders are supported.</span></span> <span data-ttu-id="631b0-163">Kódování UTF-32 se používá v případě, že aplikace chtějí zabránit tomu, aby se při kódování UTF-16 v operačních systémech, které zakódované místo příliš důležité, nepoužívaly kódování UTF-16.</span><span class="sxs-lookup"><span data-stu-id="631b0-163">UTF-32 encoding is used when applications want to avoid the surrogate code point behavior of UTF-16 encoding on operating systems for which encoded space is too important.</span></span> <span data-ttu-id="631b0-164">Jednoduché glyfy vykreslené na displeji mohou být zakódovány pomocí více než jednoho znaku UTF-32.</span><span class="sxs-lookup"><span data-stu-id="631b0-164">Single glyphs rendered on a display can still be encoded with more than one UTF-32 character.</span></span>|
|<span data-ttu-id="631b0-165">Kódování ANSI/ISO</span><span class="sxs-lookup"><span data-stu-id="631b0-165">ANSI/ISO encoding</span></span>|<span data-ttu-id="631b0-166">Poskytuje podporu pro nejrůznější znakové stránky.</span><span class="sxs-lookup"><span data-stu-id="631b0-166">Provides support for a variety of code pages.</span></span> <span data-ttu-id="631b0-167">V operačních systémech Windows se znakové stránky používají k podpoře konkrétního jazyka nebo skupiny jazyků.</span><span class="sxs-lookup"><span data-stu-id="631b0-167">On Windows operating systems, code pages are used to support a specific language or group of languages.</span></span> <span data-ttu-id="631b0-168">Tabulku, která obsahuje seznam kódových stránek podporovaných rozhraním .NET, naleznete v tématu <xref:System.Text.Encoding> Třída.</span><span class="sxs-lookup"><span data-stu-id="631b0-168">For a table that lists the code pages supported by .NET, see the <xref:System.Text.Encoding> class.</span></span> <span data-ttu-id="631b0-169">Objekt kódování pro konkrétní znakovou stránku lze načíst voláním <xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="631b0-169">You can retrieve an encoding object for a particular code page by calling the <xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="631b0-170">Znaková stránka obsahuje 256 kódových bodů a je počítána od nuly.</span><span class="sxs-lookup"><span data-stu-id="631b0-170">A code page contains 256 code points and is zero-based.</span></span> <span data-ttu-id="631b0-171">Ve většině kódových stránek představuje body kódu 0 až 127 znakovou sadu ASCII a body kódu 128 až 255 se výrazně liší mezi kódovými stránkami.</span><span class="sxs-lookup"><span data-stu-id="631b0-171">In most code pages, code points 0 through 127 represent the ASCII character set, and code points 128 through 255 differ significantly between code pages.</span></span> <span data-ttu-id="631b0-172">Například znaková stránka 1252 poskytuje znaky pro systémy psaní latinkou, včetně angličtiny, němčiny a francouzštiny.</span><span class="sxs-lookup"><span data-stu-id="631b0-172">For example, code page 1252 provides the characters for Latin writing systems, including English, German, and French.</span></span> <span data-ttu-id="631b0-173">Poslední 128 body kódu v kódové stránce 1252 obsahují znaky zvýraznění.</span><span class="sxs-lookup"><span data-stu-id="631b0-173">The last 128 code points in code page 1252 contain the accent characters.</span></span> <span data-ttu-id="631b0-174">Znaková stránka 1253 poskytuje kódy znaků, které jsou požadovány v systému řeckého zápisu.</span><span class="sxs-lookup"><span data-stu-id="631b0-174">Code page 1253 provides character codes that are required in the Greek writing system.</span></span> <span data-ttu-id="631b0-175">Poslední 128 body kódu v kódové stránce 1253 obsahují řecké znaky.</span><span class="sxs-lookup"><span data-stu-id="631b0-175">The last 128 code points in code page 1253 contain the Greek characters.</span></span> <span data-ttu-id="631b0-176">V důsledku toho aplikace, která spoléhá na znakové stránky ANSI, nemůže ukládat Řecká a Německo do stejného textového streamu, pokud neobsahuje identifikátor, který označuje odkazovanou znakovou stránku.</span><span class="sxs-lookup"><span data-stu-id="631b0-176">As a result, an application that relies on ANSI code pages cannot store Greek and German in the same text stream unless it includes an identifier that indicates the referenced code page.</span></span>|
|<span data-ttu-id="631b0-177">Kódování dvoubajtové znakové sady (DBCS)</span><span class="sxs-lookup"><span data-stu-id="631b0-177">Double-byte character set (DBCS) encodings</span></span>|<span data-ttu-id="631b0-178">Podporuje jazyky, jako jsou čínština, japonština a korejština, které obsahují více než 256 znaků.</span><span class="sxs-lookup"><span data-stu-id="631b0-178">Supports languages, such as Chinese, Japanese, and Korean, that contain more than 256 characters.</span></span> <span data-ttu-id="631b0-179">Ve znakové sadě DBCS dvojice kódových bodů (Double Byte) představuje každý znak.</span><span class="sxs-lookup"><span data-stu-id="631b0-179">In a DBCS, a pair of code points (a double byte) represents each character.</span></span> <span data-ttu-id="631b0-180"><xref:System.Text.Encoding.IsSingleByte%2A?displayProperty=nameWithType>Vlastnost vrátí `false` pro kódování znakové sady DBCS.</span><span class="sxs-lookup"><span data-stu-id="631b0-180">The <xref:System.Text.Encoding.IsSingleByte%2A?displayProperty=nameWithType> property returns `false` for DBCS encodings.</span></span> <span data-ttu-id="631b0-181">Můžete načíst objekt kódování pro konkrétní sadu DBCS voláním <xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="631b0-181">You can retrieve an encoding object for a particular DBCS by calling the <xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="631b0-182">Když aplikace zpracovává data sady DBCS, první bajt znaku DBCS (vedoucí bajt) se zpracuje v kombinaci s koncovým bajtem, který hned následuje.</span><span class="sxs-lookup"><span data-stu-id="631b0-182">When an application handles DBCS data, the first byte of a DBCS character (the lead byte) is processed in combination with the trail byte that immediately follows it.</span></span> <span data-ttu-id="631b0-183">Vzhledem k tomu, že jedna dvojice dvoubajtových bodů kódu může představovat různé znaky v závislosti na znakové stránce, toto schéma stále nepovoluje kombinaci dvou jazyků, jako jsou japonština a čínština, ve stejném datovém proudu.</span><span class="sxs-lookup"><span data-stu-id="631b0-183">Because a single pair of double-byte code points can represent different characters depending on the code page, this scheme still does not allow for the combination of two languages, such as Japanese and Chinese, in the same data stream.</span></span>|

<span data-ttu-id="631b0-184">Tato kódování umožňují pracovat s znaky Unicode a s kódováními, které se nejčastěji používají ve starších verzích aplikací.</span><span class="sxs-lookup"><span data-stu-id="631b0-184">These encodings enable you to work with Unicode characters as well as with encodings that are most commonly used in legacy applications.</span></span> <span data-ttu-id="631b0-185">Kromě toho můžete vytvořit vlastní kódování definováním třídy, která je odvozena z <xref:System.Text.Encoding> a přepsání jejích členů.</span><span class="sxs-lookup"><span data-stu-id="631b0-185">In addition, you can create a custom encoding by defining a class that derives from <xref:System.Text.Encoding> and overriding its members.</span></span>

## <a name="net-core-encoding-support"></a><span data-ttu-id="631b0-186">Podpora kódování .NET Core</span><span class="sxs-lookup"><span data-stu-id="631b0-186">.NET Core encoding support</span></span>

<span data-ttu-id="631b0-187">Ve výchozím nastavení .NET Core nezpřístupňuje žádné kódování znakových stránek kromě znakové stránky 28591 a kódování Unicode, jako jsou UTF-8 a UTF-16.</span><span class="sxs-lookup"><span data-stu-id="631b0-187">By default, .NET Core does not make available any code page encodings other than code page 28591 and the Unicode encodings, such as UTF-8 and UTF-16.</span></span> <span data-ttu-id="631b0-188">Můžete ale přidat kódování znakové stránky nalezené ve standardních aplikacích pro Windows, které cílí na rozhraní .NET do vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="631b0-188">However, you can add the code page encodings found in standard Windows apps that target .NET to your app.</span></span> <span data-ttu-id="631b0-189">Další informace najdete v <xref:System.Text.CodePagesEncodingProvider> tématu.</span><span class="sxs-lookup"><span data-stu-id="631b0-189">For more information, see the <xref:System.Text.CodePagesEncodingProvider> topic.</span></span>

<a name="Selecting"></a>

## <a name="selecting-an-encoding-class"></a><span data-ttu-id="631b0-190">Výběr třídy kódování</span><span class="sxs-lookup"><span data-stu-id="631b0-190">Selecting an Encoding Class</span></span>

<span data-ttu-id="631b0-191">Pokud máte příležitost zvolit kódování, které má vaše aplikace používat, měli byste použít kódování Unicode, a to, pokud je to možné, <xref:System.Text.UTF8Encoding> nebo <xref:System.Text.UnicodeEncoding> .</span><span class="sxs-lookup"><span data-stu-id="631b0-191">If you have the opportunity to choose the encoding to be used by your application, you should use a Unicode encoding, preferably either <xref:System.Text.UTF8Encoding> or <xref:System.Text.UnicodeEncoding>.</span></span> <span data-ttu-id="631b0-192">(.NET také podporuje třetí kódování Unicode, <xref:System.Text.UTF32Encoding> .)</span><span class="sxs-lookup"><span data-stu-id="631b0-192">(.NET also supports a third Unicode encoding, <xref:System.Text.UTF32Encoding>.)</span></span>

<span data-ttu-id="631b0-193">Pokud plánujete použít kódování ASCII ( <xref:System.Text.ASCIIEncoding> ), vyberte <xref:System.Text.UTF8Encoding> místo toho.</span><span class="sxs-lookup"><span data-stu-id="631b0-193">If you are planning to use an ASCII encoding (<xref:System.Text.ASCIIEncoding>), choose <xref:System.Text.UTF8Encoding> instead.</span></span> <span data-ttu-id="631b0-194">Tato dvě kódování jsou shodná se znakovou sadou ASCII, ale <xref:System.Text.UTF8Encoding> mají následující výhody:</span><span class="sxs-lookup"><span data-stu-id="631b0-194">The two encodings are identical for the ASCII character set, but <xref:System.Text.UTF8Encoding> has the following advantages:</span></span>

- <span data-ttu-id="631b0-195">Může představovat každý znak Unicode, zatímco <xref:System.Text.ASCIIEncoding> podporuje pouze hodnoty znaků Unicode mezi U + 0000 a U + 007F.</span><span class="sxs-lookup"><span data-stu-id="631b0-195">It can represent every Unicode character, whereas <xref:System.Text.ASCIIEncoding> supports only the Unicode character values between U+0000 and U+007F.</span></span>

- <span data-ttu-id="631b0-196">Poskytuje detekci chyb a lepší zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="631b0-196">It provides error detection and better security.</span></span>

- <span data-ttu-id="631b0-197">Byla vyladěna tak, aby byla co nejrychlejší a měla by být rychlejší než jakékoli jiné kódování.</span><span class="sxs-lookup"><span data-stu-id="631b0-197">It has been tuned to be as fast as possible and should be faster than any other encoding.</span></span> <span data-ttu-id="631b0-198">I pro obsah, který je zcela ve formátu ASCII, operace prováděné s <xref:System.Text.UTF8Encoding> jsou rychlejší než operace prováděné s nástrojem <xref:System.Text.ASCIIEncoding> .</span><span class="sxs-lookup"><span data-stu-id="631b0-198">Even for content that is entirely ASCII, operations performed with <xref:System.Text.UTF8Encoding> are faster than operations performed with <xref:System.Text.ASCIIEncoding>.</span></span>

<span data-ttu-id="631b0-199">Měli byste zvážit použití <xref:System.Text.ASCIIEncoding> jenom pro starší verze aplikací.</span><span class="sxs-lookup"><span data-stu-id="631b0-199">You should consider using <xref:System.Text.ASCIIEncoding> only for legacy applications.</span></span> <span data-ttu-id="631b0-200">Nicméně i u starších aplikací <xref:System.Text.UTF8Encoding> může být lepší volbou z následujících důvodů (předpokládá se výchozí nastavení):</span><span class="sxs-lookup"><span data-stu-id="631b0-200">However, even for legacy applications, <xref:System.Text.UTF8Encoding> might be a better choice for the following reasons (assuming default settings):</span></span>

- <span data-ttu-id="631b0-201">Pokud má vaše aplikace obsah, který není výhradně ASCII a zakóduje ho <xref:System.Text.ASCIIEncoding> , každý znak bez ASCII kódování se zakóduje jako otazník (?).</span><span class="sxs-lookup"><span data-stu-id="631b0-201">If your application has content that is not strictly ASCII and encodes it with <xref:System.Text.ASCIIEncoding>, each non-ASCII character encodes as a question mark (?).</span></span> <span data-ttu-id="631b0-202">Pokud aplikace potom tato data dekóduje, dojde ke ztrátě informací.</span><span class="sxs-lookup"><span data-stu-id="631b0-202">If the application then decodes this data, the information is lost.</span></span>

- <span data-ttu-id="631b0-203">Pokud má vaše aplikace obsah, který není výhradně ve formátu ASCII a zakóduje ho pomocí <xref:System.Text.UTF8Encoding> , výsledek se zdá být nečitelný, pokud je interpretován jako ASCII.</span><span class="sxs-lookup"><span data-stu-id="631b0-203">If your application has content that is not strictly ASCII and encodes it with <xref:System.Text.UTF8Encoding>, the result seems unintelligible if interpreted as ASCII.</span></span> <span data-ttu-id="631b0-204">Pokud však aplikace použije k dekódování těchto dat dekodér UTF-8, data se úspěšně vykoná pomocí odezvy.</span><span class="sxs-lookup"><span data-stu-id="631b0-204">However, if the application then uses a UTF-8 decoder to decode this data, the data performs a round trip successfully.</span></span>

<span data-ttu-id="631b0-205">Ve webové aplikaci by se měly znaky odeslané klientovi v reakci na webový požadavek projevit kódováním použitým v klientovi.</span><span class="sxs-lookup"><span data-stu-id="631b0-205">In a web application, characters sent to the client in response to a web request should reflect the encoding used on the client.</span></span> <span data-ttu-id="631b0-206">Ve většině případů byste měli nastavit <xref:System.Web.HttpResponse.ContentEncoding%2A?displayProperty=nameWithType> vlastnost na hodnotu vrácenou <xref:System.Web.HttpRequest.ContentEncoding%2A?displayProperty=nameWithType> vlastností pro zobrazení textu v kódování, které uživatel očekává.</span><span class="sxs-lookup"><span data-stu-id="631b0-206">In most cases, you should set the <xref:System.Web.HttpResponse.ContentEncoding%2A?displayProperty=nameWithType> property to the value returned by the <xref:System.Web.HttpRequest.ContentEncoding%2A?displayProperty=nameWithType> property to display text in the encoding that the user expects.</span></span>

<a name="Using"></a>

## <a name="using-an-encoding-object"></a><span data-ttu-id="631b0-207">Použití objektu Encoding</span><span class="sxs-lookup"><span data-stu-id="631b0-207">Using an Encoding Object</span></span>

<span data-ttu-id="631b0-208">Kodér převede řetězec znaků (nejčastěji znaků Unicode) na jeho číselný ekvivalent (Byte).</span><span class="sxs-lookup"><span data-stu-id="631b0-208">An encoder converts a string of characters (most commonly, Unicode characters) to its numeric (byte) equivalent.</span></span> <span data-ttu-id="631b0-209">Například můžete použít kodér ASCII k převedení znaků Unicode na ASCII, aby se mohly zobrazit v konzole.</span><span class="sxs-lookup"><span data-stu-id="631b0-209">For example, you might use an ASCII encoder to convert Unicode characters to ASCII so that they can be displayed at the console.</span></span> <span data-ttu-id="631b0-210">Chcete-li provést převod, zavolejte <xref:System.Text.Encoding.GetBytes%2A?displayProperty=nameWithType> metodu.</span><span class="sxs-lookup"><span data-stu-id="631b0-210">To perform the conversion, you call the <xref:System.Text.Encoding.GetBytes%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="631b0-211">Chcete-li určit, kolik bajtů je potřeba k uložení zakódovaných znaků před provedením kódování, můžete zavolat <xref:System.Text.Encoding.GetByteCount%2A> metodu.</span><span class="sxs-lookup"><span data-stu-id="631b0-211">If you want to determine how many bytes are needed to store the encoded characters before performing the encoding, you can call the <xref:System.Text.Encoding.GetByteCount%2A> method.</span></span>

<span data-ttu-id="631b0-212">Následující příklad používá jedno bajtové pole ke kódování řetězců ve dvou samostatných operacích.</span><span class="sxs-lookup"><span data-stu-id="631b0-212">The following example uses a single byte array to encode strings in two separate operations.</span></span> <span data-ttu-id="631b0-213">Udržuje index, který označuje počáteční pozici v bajtovém poli pro další sadu bajtů zakódovaných ve formátu ASCII.</span><span class="sxs-lookup"><span data-stu-id="631b0-213">It maintains an index that indicates the starting position in the byte array for the next set of ASCII-encoded bytes.</span></span> <span data-ttu-id="631b0-214">Volá metodu, aby <xref:System.Text.ASCIIEncoding.GetByteCount%28System.String%29?displayProperty=nameWithType> zajistila, že bajtové pole je dostatečně velké pro přizpůsobení kódovaného řetězce.</span><span class="sxs-lookup"><span data-stu-id="631b0-214">It calls the <xref:System.Text.ASCIIEncoding.GetByteCount%28System.String%29?displayProperty=nameWithType> method to ensure that the byte array is large enough to accommodate the encoded string.</span></span> <span data-ttu-id="631b0-215">Poté volá <xref:System.Text.ASCIIEncoding.GetBytes%28System.String%2CSystem.Int32%2CSystem.Int32%2CSystem.Byte%5B%5D%2CSystem.Int32%29?displayProperty=nameWithType> metodu pro kódování znaků v řetězci.</span><span class="sxs-lookup"><span data-stu-id="631b0-215">It then calls the <xref:System.Text.ASCIIEncoding.GetBytes%28System.String%2CSystem.Int32%2CSystem.Int32%2CSystem.Byte%5B%5D%2CSystem.Int32%29?displayProperty=nameWithType> method to encode the characters in the string.</span></span>

[!code-csharp[Conceptual.Encoding#8](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/getbytes1.cs#8)]
[!code-vb[Conceptual.Encoding#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/getbytes1.vb#8)]

<span data-ttu-id="631b0-216">Dekodér převede pole bajtů, které odráží konkrétní kódování znaků, do množiny znaků, buď v poli znaků nebo v řetězci.</span><span class="sxs-lookup"><span data-stu-id="631b0-216">A decoder converts a byte array that reflects a particular character encoding into a set of characters, either in a character array or in a string.</span></span> <span data-ttu-id="631b0-217">Chcete-li dekódovat pole bajtů do pole znaků, zavoláte <xref:System.Text.Encoding.GetChars%2A?displayProperty=nameWithType> metodu.</span><span class="sxs-lookup"><span data-stu-id="631b0-217">To decode a byte array into a character array, you call the <xref:System.Text.Encoding.GetChars%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="631b0-218">Chcete-li dekódovat pole bajtů do řetězce, zavoláte <xref:System.Text.Encoding.GetString%2A> metodu.</span><span class="sxs-lookup"><span data-stu-id="631b0-218">To decode a byte array into a string, you call the <xref:System.Text.Encoding.GetString%2A> method.</span></span> <span data-ttu-id="631b0-219">Chcete-li určit, kolik znaků je potřeba k uložení dekódovaných bajtů před provedením dekódování, můžete zavolat <xref:System.Text.Encoding.GetCharCount%2A> metodu.</span><span class="sxs-lookup"><span data-stu-id="631b0-219">If you want to determine how many characters are needed to store the decoded bytes before performing the decoding, you can call the <xref:System.Text.Encoding.GetCharCount%2A> method.</span></span>

<span data-ttu-id="631b0-220">Následující příklad kóduje tři řetězce a poté je dekóduje do jednoho pole znaků.</span><span class="sxs-lookup"><span data-stu-id="631b0-220">The following example encodes three strings and then decodes them into a single array of characters.</span></span> <span data-ttu-id="631b0-221">Udržuje index, který označuje počáteční pozici v poli znaků pro další sadu dekódových znaků.</span><span class="sxs-lookup"><span data-stu-id="631b0-221">It maintains an index that indicates the starting position in the character array for the next set of decoded characters.</span></span> <span data-ttu-id="631b0-222">Volá metodu, aby <xref:System.Text.ASCIIEncoding.GetCharCount%2A> zajistila, že je pole znaků dostatečně velké, aby se vešly všechny Dekódovatelné znaky.</span><span class="sxs-lookup"><span data-stu-id="631b0-222">It calls the <xref:System.Text.ASCIIEncoding.GetCharCount%2A> method to ensure that the character array is large enough to accommodate all the decoded characters.</span></span> <span data-ttu-id="631b0-223">Pak zavolá <xref:System.Text.ASCIIEncoding.GetChars%28System.Byte%5B%5D%2CSystem.Int32%2CSystem.Int32%2CSystem.Char%5B%5D%2CSystem.Int32%29?displayProperty=nameWithType> metodu pro dekódování pole bajtů.</span><span class="sxs-lookup"><span data-stu-id="631b0-223">It then calls the <xref:System.Text.ASCIIEncoding.GetChars%28System.Byte%5B%5D%2CSystem.Int32%2CSystem.Int32%2CSystem.Char%5B%5D%2CSystem.Int32%29?displayProperty=nameWithType> method to decode the byte array.</span></span>

[!code-csharp[Conceptual.Encoding#9](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/getchars1.cs#9)]
[!code-vb[Conceptual.Encoding#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/getchars1.vb#9)]

<span data-ttu-id="631b0-224">Metody kódování a dekódování třídy odvozené z <xref:System.Text.Encoding> jsou navrženy tak, aby fungovaly na kompletní sadě dat; to znamená, že všechna data, která mají být kódována nebo Dekódovaná, jsou uvedena v jediné volání metody.</span><span class="sxs-lookup"><span data-stu-id="631b0-224">The encoding and decoding methods of a class derived from <xref:System.Text.Encoding> are designed to work on a complete set of data; that is, all the data to be encoded or decoded is supplied in a single method call.</span></span> <span data-ttu-id="631b0-225">V některých případech jsou však data k dispozici v datovém proudu a data, která mají být kódována nebo Dekódovaná, mohou být k dispozici pouze ze samostatných operací čtení.</span><span class="sxs-lookup"><span data-stu-id="631b0-225">However, in some cases, data is available in a stream, and the data to be encoded or decoded may be available only from separate read operations.</span></span> <span data-ttu-id="631b0-226">K tomu je potřeba, aby operace kódování nebo dekódování pamatovala kterýkoli uložený stav z předchozího vyvolání.</span><span class="sxs-lookup"><span data-stu-id="631b0-226">This requires the encoding or decoding operation to remember any saved state from its previous invocation.</span></span> <span data-ttu-id="631b0-227">Metody tříd odvozené z <xref:System.Text.Encoder> a <xref:System.Text.Decoder> jsou schopny zpracovávat operace kódování a dekódování, které přesahují více volání metody.</span><span class="sxs-lookup"><span data-stu-id="631b0-227">Methods of classes derived from <xref:System.Text.Encoder> and <xref:System.Text.Decoder> are able to handle encoding and decoding operations that span multiple method calls.</span></span>

<span data-ttu-id="631b0-228"><xref:System.Text.Encoder>Objekt pro konkrétní kódování je k dispozici z vlastnosti tohoto kódování <xref:System.Text.Encoding.GetEncoder%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="631b0-228">An <xref:System.Text.Encoder> object for a particular encoding is available from that encoding's <xref:System.Text.Encoding.GetEncoder%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="631b0-229"><xref:System.Text.Decoder>Objekt pro konkrétní kódování je k dispozici z vlastnosti tohoto kódování <xref:System.Text.Encoding.GetDecoder%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="631b0-229">A <xref:System.Text.Decoder> object for a particular encoding is available from that encoding's <xref:System.Text.Encoding.GetDecoder%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="631b0-230">Pro dekódování operací si všimněte, že třídy odvozené z <xref:System.Text.Decoder> obsahují <xref:System.Text.Decoder.GetChars%2A?displayProperty=nameWithType> metodu, ale nemají metodu, která odpovídá <xref:System.Text.Encoding.GetString%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="631b0-230">For decoding operations, note that classes derived from <xref:System.Text.Decoder> include a <xref:System.Text.Decoder.GetChars%2A?displayProperty=nameWithType> method, but they do not have a method that corresponds to <xref:System.Text.Encoding.GetString%2A?displayProperty=nameWithType>.</span></span>

<span data-ttu-id="631b0-231">Následující příklad znázorňuje rozdíl mezi použitím <xref:System.Text.Encoding.GetString%2A?displayProperty=nameWithType> <xref:System.Text.Decoder.GetChars%2A?displayProperty=nameWithType> metod a pro dekódování pole bajtů Unicode.</span><span class="sxs-lookup"><span data-stu-id="631b0-231">The following example illustrates the difference between using the <xref:System.Text.Encoding.GetString%2A?displayProperty=nameWithType> and <xref:System.Text.Decoder.GetChars%2A?displayProperty=nameWithType> methods for decoding a Unicode byte array.</span></span> <span data-ttu-id="631b0-232">Příklad zakóduje řetězec, který obsahuje některé znaky Unicode do souboru, a poté používá dvě metody dekódování k dekódování těchto desíti bajtů současně.</span><span class="sxs-lookup"><span data-stu-id="631b0-232">The example encodes a string that contains some Unicode characters to a file, and then uses the two decoding methods to decode them ten bytes at a time.</span></span> <span data-ttu-id="631b0-233">Vzhledem k tomu, že náhradní pár vychází z desáté a jedenáctá bajty, je dekódovat v samostatných voláních metody.</span><span class="sxs-lookup"><span data-stu-id="631b0-233">Because a surrogate pair occurs in the tenth and eleventh bytes, it is decoded in separate method calls.</span></span> <span data-ttu-id="631b0-234">Jak ukazuje výstup, metoda není <xref:System.Text.Encoding.GetString%2A?displayProperty=nameWithType> schopna správně dekódovat bajty a místo toho je nahradí znakem U + FFFD (NAHRAZUJÍCÍ znak).</span><span class="sxs-lookup"><span data-stu-id="631b0-234">As the output shows, the <xref:System.Text.Encoding.GetString%2A?displayProperty=nameWithType> method is not able to correctly decode the bytes and instead replaces them with U+FFFD (REPLACEMENT CHARACTER).</span></span> <span data-ttu-id="631b0-235">Na druhé straně <xref:System.Text.Decoder.GetChars%2A?displayProperty=nameWithType> metoda může úspěšně dekódovat pole bajtů a získat tak původní řetězec.</span><span class="sxs-lookup"><span data-stu-id="631b0-235">On the other hand, the <xref:System.Text.Decoder.GetChars%2A?displayProperty=nameWithType> method is able to successfully decode the byte array to get the original string.</span></span>

[!code-csharp[Conceptual.Encoding#10](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/stream1.cs#10)]
[!code-vb[Conceptual.Encoding#10](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/stream1.vb#10)]

<a name="FallbackStrategy"></a>

## <a name="choosing-a-fallback-strategy"></a><span data-ttu-id="631b0-236">Výběr záložní strategie</span><span class="sxs-lookup"><span data-stu-id="631b0-236">Choosing a Fallback Strategy</span></span>

<span data-ttu-id="631b0-237">Když se metoda pokusí kódovat nebo dekódovat znak, ale neexistuje žádné mapování, musí implementovat záložní strategii, která určuje, jak by mělo být zpracování neúspěšného mapování.</span><span class="sxs-lookup"><span data-stu-id="631b0-237">When a method tries to encode or decode a character but no mapping exists, it must implement a fallback strategy that determines how the failed mapping should be handled.</span></span> <span data-ttu-id="631b0-238">Existují tři typy nouzových strategií:</span><span class="sxs-lookup"><span data-stu-id="631b0-238">There are three types of fallback strategies:</span></span>

- <span data-ttu-id="631b0-239">Nejlépe přizpůsobit záložním</span><span class="sxs-lookup"><span data-stu-id="631b0-239">Best-fit fallback</span></span>

- <span data-ttu-id="631b0-240">Náhradní záložní</span><span class="sxs-lookup"><span data-stu-id="631b0-240">Replacement fallback</span></span>

- <span data-ttu-id="631b0-241">Záložní výjimka</span><span class="sxs-lookup"><span data-stu-id="631b0-241">Exception fallback</span></span>

> [!IMPORTANT]
> <span data-ttu-id="631b0-242">Nejběžnější problémy v operacích kódování dochází, když znak Unicode nelze namapovat na konkrétní kódování znakové stránky.</span><span class="sxs-lookup"><span data-stu-id="631b0-242">The most common problems in encoding operations occur when a Unicode character cannot be mapped to a particular code page encoding.</span></span> <span data-ttu-id="631b0-243">Nejběžnější problémy při dekódování se vyskytují, když neplatné sekvence bajtů nejde přeložit na platné znaky Unicode.</span><span class="sxs-lookup"><span data-stu-id="631b0-243">The most common problems in decoding operations occur when invalid byte sequences cannot be translated into valid Unicode characters.</span></span> <span data-ttu-id="631b0-244">Z těchto důvodů byste měli znát, kterou záložní strategii konkrétní objekt kódování používá.</span><span class="sxs-lookup"><span data-stu-id="631b0-244">For these reasons, you should know which fallback strategy a particular encoding object uses.</span></span> <span data-ttu-id="631b0-245">Kdykoli je to možné, měli byste určit záložní strategii použitou objektem kódování při vytváření instance objektu.</span><span class="sxs-lookup"><span data-stu-id="631b0-245">Whenever possible, you should specify the fallback strategy used by an encoding object when you instantiate the object.</span></span>

<a name="BestFit"></a>

### <a name="best-fit-fallback"></a><span data-ttu-id="631b0-246">Nejlépe přizpůsobit záložním</span><span class="sxs-lookup"><span data-stu-id="631b0-246">Best-Fit Fallback</span></span>

<span data-ttu-id="631b0-247">Pokud znak nemá přesnou shodu v cílovém kódování, kodér se může pokusit namapovat na podobný znak.</span><span class="sxs-lookup"><span data-stu-id="631b0-247">When a character does not have an exact match in the target encoding, the encoder can try to map it to a similar character.</span></span> <span data-ttu-id="631b0-248">(Co nejlépe vyhovuje záložnímu řešení, je většinou kódování, nikoli problém dekódování.</span><span class="sxs-lookup"><span data-stu-id="631b0-248">(Best-fit fallback is mostly an encoding rather than a decoding issue.</span></span> <span data-ttu-id="631b0-249">Existuje několik znakových stránek, které obsahují znaky, které nelze úspěšně namapovat na kódování Unicode.) Nejlepší je jako výchozí pro kódování znakové stránky a dvoubajtové znakové sady, které jsou načteny pomocí <xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType> <xref:System.Text.Encoding.GetEncoding%28System.String%29?displayProperty=nameWithType> přetížení a.</span><span class="sxs-lookup"><span data-stu-id="631b0-249">There are very few code pages that contain characters that cannot be successfully mapped to Unicode.) Best-fit fallback is the default for code page and double-byte character set encodings that are retrieved by the <xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType> and <xref:System.Text.Encoding.GetEncoding%28System.String%29?displayProperty=nameWithType> overloads.</span></span>

> [!NOTE]
> <span data-ttu-id="631b0-250">Teoreticky, třídy kódování Unicode poskytované v rozhraní .NET ( <xref:System.Text.UTF8Encoding> , <xref:System.Text.UnicodeEncoding> a <xref:System.Text.UTF32Encoding> ) podporují každý znak v každé znakové sadě, takže je lze použít k odstranění nejlepšího problému s nouzovou velikostí.</span><span class="sxs-lookup"><span data-stu-id="631b0-250">In theory, the Unicode encoding classes provided in .NET (<xref:System.Text.UTF8Encoding>, <xref:System.Text.UnicodeEncoding>, and <xref:System.Text.UTF32Encoding>) support every character in every character set, so they can be used to eliminate best-fit fallback issues.</span></span>

<span data-ttu-id="631b0-251">Strategie pro nejlepší přizpůsobení se liší u různých znakových stránek.</span><span class="sxs-lookup"><span data-stu-id="631b0-251">Best-fit strategies vary for different code pages.</span></span> <span data-ttu-id="631b0-252">Například pro některé znakové stránky jsou znaky latinky s plnou šířkou mapovány na obecnější znaky s poloviční šířkou.</span><span class="sxs-lookup"><span data-stu-id="631b0-252">For example, for some code pages, full-width Latin characters map to the more common half-width Latin characters.</span></span> <span data-ttu-id="631b0-253">Pro jiné znakové stránky se toto mapování neprovede.</span><span class="sxs-lookup"><span data-stu-id="631b0-253">For other code pages, this mapping is not made.</span></span> <span data-ttu-id="631b0-254">I v rámci agresivní strategie nejlepšího přizpůsobení není pro některé znaky v některých kódování dostatek.</span><span class="sxs-lookup"><span data-stu-id="631b0-254">Even under an aggressive best-fit strategy, there is no imaginable fit for some characters in some encodings.</span></span> <span data-ttu-id="631b0-255">Například čínský znak nemá žádné rozumné mapování na znakovou stránku 1252.</span><span class="sxs-lookup"><span data-stu-id="631b0-255">For example, a Chinese ideograph has no reasonable mapping to code page 1252.</span></span> <span data-ttu-id="631b0-256">V tomto případě je použit náhradní řetězec.</span><span class="sxs-lookup"><span data-stu-id="631b0-256">In this case, a replacement string is used.</span></span> <span data-ttu-id="631b0-257">Ve výchozím nastavení je tento řetězec pouze jedním OTAZNÍKem (U + 003F).</span><span class="sxs-lookup"><span data-stu-id="631b0-257">By default, this string is just a single QUESTION MARK (U+003F).</span></span>

> [!NOTE]
> <span data-ttu-id="631b0-258">Strategie pro nejlepší přizpůsobení nejsou podrobně dokumentovány.</span><span class="sxs-lookup"><span data-stu-id="631b0-258">Best-fit strategies are not documented in detail.</span></span> <span data-ttu-id="631b0-259">Na webu [konsorcia Unicode](https://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WindowsBestFit/) je však uvedeno několik kódových stránek.</span><span class="sxs-lookup"><span data-stu-id="631b0-259">However, several code pages are documented at the [Unicode Consortium's](https://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WindowsBestFit/) website.</span></span> <span data-ttu-id="631b0-260">Popis Interpretace souborů mapování najdete v souboru **Readme. txt** v této složce.</span><span class="sxs-lookup"><span data-stu-id="631b0-260">Please review the **readme.txt** file in that folder for a description of how to interpret the mapping files.</span></span>

<span data-ttu-id="631b0-261">V následujícím příkladu je použita znaková stránka 1252 (znaková stránka systému Windows pro jazyky západní Evropa) k ilustraci mapování nejlepšího přizpůsobení a jejich nevýhod.</span><span class="sxs-lookup"><span data-stu-id="631b0-261">The following example uses code page 1252 (the Windows code page for Western European languages) to illustrate best-fit mapping and its drawbacks.</span></span> <span data-ttu-id="631b0-262"><xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType>Metoda se používá k načtení objektu kódování pro znakovou stránku 1252.</span><span class="sxs-lookup"><span data-stu-id="631b0-262">The <xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType> method is used to retrieve an encoding object for code page 1252.</span></span> <span data-ttu-id="631b0-263">Ve výchozím nastavení používá standardně mapování pro znaky Unicode, které nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="631b0-263">By default, it uses a best-fit mapping for Unicode characters that it does not support.</span></span> <span data-ttu-id="631b0-264">V tomto příkladu se vytvoří instance řetězce, který obsahuje tři znaky, které nepatří do ASCII – BRAILLOVO písmo latinky S (U + 24C8), horní index pět (u + 2075) a nekonečno (U + 221E) – oddělené mezerami.</span><span class="sxs-lookup"><span data-stu-id="631b0-264">The example instantiates a string that contains three non-ASCII characters - CIRCLED LATIN CAPITAL LETTER S (U+24C8), SUPERSCRIPT FIVE (U+2075), and INFINITY (U+221E) - separated by spaces.</span></span> <span data-ttu-id="631b0-265">Jak ukazuje výstup z příkladu, při kódování řetězce jsou tři původní znaky bez mezer nahrazeny OTAZNÍKem (U + 003F), ČÍSLICí pět (U + 0035) a ČÍSLICí osm (U + 0038).</span><span class="sxs-lookup"><span data-stu-id="631b0-265">As the output from the example shows, when the string is encoded, the three original non-space characters are replaced by QUESTION MARK (U+003F), DIGIT FIVE (U+0035), and DIGIT EIGHT (U+0038).</span></span> <span data-ttu-id="631b0-266">ČÍSLICE osm je obzvláště špatná náhrada pro nepodporovaný nekonečný znak a otazník indikuje, že pro původní znak nebylo k dispozici žádné mapování.</span><span class="sxs-lookup"><span data-stu-id="631b0-266">DIGIT EIGHT is a particularly poor replacement for the unsupported INFINITY character, and QUESTION MARK indicates that no mapping was available for the original character.</span></span>

[!code-csharp[Conceptual.Encoding#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/bestfit1.cs#1)]
[!code-vb[Conceptual.Encoding#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/bestfit1.vb#1)]

<span data-ttu-id="631b0-267">Mapování nejlepšího umístění je výchozím chováním pro <xref:System.Text.Encoding> objekt, který kóduje data v kódování Unicode na data znakové stránky a obsahuje starší aplikace, které jsou závislé na tomto chování.</span><span class="sxs-lookup"><span data-stu-id="631b0-267">Best-fit mapping is the default behavior for an <xref:System.Text.Encoding> object that encodes Unicode data into code page data, and there are legacy applications that rely on this behavior.</span></span> <span data-ttu-id="631b0-268">Většina nových aplikací se však musí z bezpečnostních důvodů vyhnout tomu, co nejlépe vyhovuje chování.</span><span class="sxs-lookup"><span data-stu-id="631b0-268">However, most new applications should avoid best-fit behavior for security reasons.</span></span> <span data-ttu-id="631b0-269">Například aplikace by neměly uvádět název domény pomocí kódování, které nejlépe vyhovuje.</span><span class="sxs-lookup"><span data-stu-id="631b0-269">For example, applications should not put a domain name through a best-fit encoding.</span></span>

> [!NOTE]
> <span data-ttu-id="631b0-270">Pro kódování můžete také implementovat vlastní sekundární mapování pro nejlepší přizpůsobení.</span><span class="sxs-lookup"><span data-stu-id="631b0-270">You can also implement a custom best-fit fallback mapping for an encoding.</span></span> <span data-ttu-id="631b0-271">Další informace najdete v části [implementace vlastní nouzové strategie](character-encoding.md#Custom) .</span><span class="sxs-lookup"><span data-stu-id="631b0-271">For more information, see the [Implementing a Custom Fallback Strategy](character-encoding.md#Custom) section.</span></span>

<span data-ttu-id="631b0-272">Pokud je pro objekt kódování výchozí možnost nejlepšího nastavení, můžete zvolit jinou záložní strategii při načítání <xref:System.Text.Encoding> objektu voláním <xref:System.Text.Encoding.GetEncoding%28System.Int32%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> metody nebo přetížení.</span><span class="sxs-lookup"><span data-stu-id="631b0-272">If best-fit fallback is the default for an encoding object, you can choose another fallback strategy when you retrieve an <xref:System.Text.Encoding> object by calling the <xref:System.Text.Encoding.GetEncoding%28System.Int32%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> or <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> overload.</span></span> <span data-ttu-id="631b0-273">Následující část obsahuje příklad, který nahradí každý znak, který nelze namapovat na znakovou stránku 1252 hvězdičkou (\*).</span><span class="sxs-lookup"><span data-stu-id="631b0-273">The following section includes an example that replaces each character that cannot be mapped to code page 1252 with an asterisk (\*).</span></span>

[!code-csharp[Conceptual.Encoding#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/bestfit1a.cs#3)]
[!code-vb[Conceptual.Encoding#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/bestfit1a.vb#3)]

<a name="Replacement"></a>

### <a name="replacement-fallback"></a><span data-ttu-id="631b0-274">Náhradní záložní</span><span class="sxs-lookup"><span data-stu-id="631b0-274">Replacement Fallback</span></span>

<span data-ttu-id="631b0-275">Pokud znak nemá přesnou shodu v cílovém schématu, ale neexistuje žádný vhodný znak, který lze namapovat na, aplikace může určit náhradní znak nebo řetězec.</span><span class="sxs-lookup"><span data-stu-id="631b0-275">When a character does not have an exact match in the target scheme, but there is no appropriate character that it can be mapped to, the application can specify a replacement character or string.</span></span> <span data-ttu-id="631b0-276">Toto je výchozí chování pro dekodér Unicode, které nahradí každou posloupnost dvou bajtů, kterou nemůže dekódovat pomocí REPLACEMENT_CHARACTER (U + FFFD).</span><span class="sxs-lookup"><span data-stu-id="631b0-276">This is the default behavior for the Unicode decoder, which replaces any two-byte sequence that it cannot decode with REPLACEMENT_CHARACTER (U+FFFD).</span></span> <span data-ttu-id="631b0-277">Je to také výchozí chování <xref:System.Text.ASCIIEncoding> třídy, které nahradí každý znak, který nemůže kódování ani dekódovat pomocí otazníku.</span><span class="sxs-lookup"><span data-stu-id="631b0-277">It is also the default behavior of the <xref:System.Text.ASCIIEncoding> class, which replaces each character that it cannot encode or decode with a question mark.</span></span> <span data-ttu-id="631b0-278">Následující příklad ukazuje nahrazení znaku pro řetězec Unicode z předchozího příkladu.</span><span class="sxs-lookup"><span data-stu-id="631b0-278">The following example illustrates character replacement for the Unicode string from the previous example.</span></span> <span data-ttu-id="631b0-279">Jak výstup ukazuje, každý znak, který nelze dekódovat do bajtové hodnoty ASCII, je nahrazen hodnotou 0x3F, což je kód ASCII pro otazník.</span><span class="sxs-lookup"><span data-stu-id="631b0-279">As the output shows, each character that cannot be decoded into an ASCII byte value is replaced by 0x3F, which is the ASCII code for a question mark.</span></span>

[!code-csharp[Conceptual.Encoding#2](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/replacementascii.cs#2)]
[!code-vb[Conceptual.Encoding#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/replacementascii.vb#2)]

<span data-ttu-id="631b0-280">Rozhraní .NET zahrnuje <xref:System.Text.EncoderReplacementFallback> <xref:System.Text.DecoderReplacementFallback> třídy a, které nahradí náhradní řetězec, pokud znak není přesně mapován v operaci kódování nebo dekódování.</span><span class="sxs-lookup"><span data-stu-id="631b0-280">.NET includes the <xref:System.Text.EncoderReplacementFallback> and <xref:System.Text.DecoderReplacementFallback> classes, which substitute a replacement string if a character does not map exactly in an encoding or decoding operation.</span></span> <span data-ttu-id="631b0-281">Ve výchozím nastavení je tento nahrazující řetězec otazník, ale můžete volat přetížení konstruktoru třídy pro výběr jiného řetězce.</span><span class="sxs-lookup"><span data-stu-id="631b0-281">By default, this replacement string is a question mark, but you can call a class constructor overload to choose a different string.</span></span> <span data-ttu-id="631b0-282">Obvykle je nahrazující řetězec jedním znakem, přestože to není požadavek.</span><span class="sxs-lookup"><span data-stu-id="631b0-282">Typically, the replacement string is a single character, although this is not a requirement.</span></span> <span data-ttu-id="631b0-283">Následující příklad změní chování kodéru kódové stránky 1252 vytvořením <xref:System.Text.EncoderReplacementFallback> objektu, který používá hvězdičku (\*) jako náhradní řetězec.</span><span class="sxs-lookup"><span data-stu-id="631b0-283">The following example changes the behavior of the code page 1252 encoder by instantiating an <xref:System.Text.EncoderReplacementFallback> object that uses an asterisk (\*) as a replacement string.</span></span>

[!code-csharp[Conceptual.Encoding#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/bestfit1a.cs#3)]
[!code-vb[Conceptual.Encoding#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/bestfit1a.vb#3)]

> [!NOTE]
> <span data-ttu-id="631b0-284">Pro kódování můžete také implementovat náhradní třídu.</span><span class="sxs-lookup"><span data-stu-id="631b0-284">You can also implement a replacement class for an encoding.</span></span> <span data-ttu-id="631b0-285">Další informace najdete v části [implementace vlastní nouzové strategie](character-encoding.md#Custom) .</span><span class="sxs-lookup"><span data-stu-id="631b0-285">For more information, see the [Implementing a Custom Fallback Strategy](character-encoding.md#Custom) section.</span></span>

<span data-ttu-id="631b0-286">Kromě OTAZNÍKu (U + 003F) se znak nahrazení Unicode (U + FFFD) běžně používá jako náhradní řetězec, zejména při dekódování sekvencí bajtů, které se nedají úspěšně přeložit do znaků Unicode.</span><span class="sxs-lookup"><span data-stu-id="631b0-286">In addition to QUESTION MARK (U+003F), the Unicode REPLACEMENT CHARACTER (U+FFFD) is commonly used as a replacement string, particularly when decoding byte sequences that cannot be successfully translated into Unicode characters.</span></span> <span data-ttu-id="631b0-287">Můžete však vybrat libovolný řetězec pro nahrazení a může obsahovat více znaků.</span><span class="sxs-lookup"><span data-stu-id="631b0-287">However, you are free to choose any replacement string, and it can contain multiple characters.</span></span>

<a name="Exception"></a>

### <a name="exception-fallback"></a><span data-ttu-id="631b0-288">Záložní výjimka</span><span class="sxs-lookup"><span data-stu-id="631b0-288">Exception Fallback</span></span>

<span data-ttu-id="631b0-289">Namísto poskytnutí nejlepšího náhradního nebo náhradního řetězce může kodér vyvolat výjimku, <xref:System.Text.EncoderFallbackException> Pokud není schopen zakódovat sadu znaků a dekodér může vyvolat, <xref:System.Text.DecoderFallbackException> Pokud není schopen dekódovat bajtové pole.</span><span class="sxs-lookup"><span data-stu-id="631b0-289">Instead of providing a best-fit fallback or a replacement string, an encoder can throw an <xref:System.Text.EncoderFallbackException> if it is unable to encode a set of characters, and a decoder can throw a <xref:System.Text.DecoderFallbackException> if it is unable to decode a byte array.</span></span> <span data-ttu-id="631b0-290">Chcete-li vyvolat výjimku při operacích kódování a dekódování, zadejte <xref:System.Text.EncoderExceptionFallback> objekt a <xref:System.Text.DecoderExceptionFallback> objekt, v uvedeném pořadí, do <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="631b0-290">To throw an exception in encoding and decoding operations, you supply an <xref:System.Text.EncoderExceptionFallback> object and a <xref:System.Text.DecoderExceptionFallback> object, respectively, to the <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="631b0-291">Následující příklad ukazuje použití výjimky s <xref:System.Text.ASCIIEncoding> třídou.</span><span class="sxs-lookup"><span data-stu-id="631b0-291">The following example illustrates exception fallback with the <xref:System.Text.ASCIIEncoding> class.</span></span>

[!code-csharp[Conceptual.Encoding#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/exceptionascii.cs#4)]
[!code-vb[Conceptual.Encoding#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/exceptionascii.vb#4)]

> [!NOTE]
> <span data-ttu-id="631b0-292">Můžete také implementovat vlastní obslužnou rutinu výjimky pro operaci kódování.</span><span class="sxs-lookup"><span data-stu-id="631b0-292">You can also implement a custom exception handler for an encoding operation.</span></span> <span data-ttu-id="631b0-293">Další informace najdete v části [implementace vlastní nouzové strategie](character-encoding.md#Custom) .</span><span class="sxs-lookup"><span data-stu-id="631b0-293">For more information, see the [Implementing a Custom Fallback Strategy](character-encoding.md#Custom) section.</span></span>

<span data-ttu-id="631b0-294"><xref:System.Text.EncoderFallbackException>Objekty a <xref:System.Text.DecoderFallbackException> poskytují následující informace o stavu, který způsobil výjimku:</span><span class="sxs-lookup"><span data-stu-id="631b0-294">The <xref:System.Text.EncoderFallbackException> and <xref:System.Text.DecoderFallbackException> objects provide the following information about the condition that caused the exception:</span></span>

- <span data-ttu-id="631b0-295"><xref:System.Text.EncoderFallbackException>Objekt obsahuje <xref:System.Text.EncoderFallbackException.IsUnknownSurrogate%2A> metodu, která označuje, zda znak nebo znaky, které nemohou být zakódovány, představuje neznámý náhradní pár (v takovém případě se metoda vrátí `true` ) nebo neznámý jediný znak (v takovém případě se metoda vrátí `false` ).</span><span class="sxs-lookup"><span data-stu-id="631b0-295">The <xref:System.Text.EncoderFallbackException> object includes an <xref:System.Text.EncoderFallbackException.IsUnknownSurrogate%2A> method, which indicates whether the character or characters that cannot be encoded represent an unknown surrogate pair (in which case, the method returns `true`) or an unknown single character (in which case, the method returns `false`).</span></span> <span data-ttu-id="631b0-296">Znaky v náhradní dvojici jsou k dispozici z <xref:System.Text.EncoderFallbackException.CharUnknownHigh%2A?displayProperty=nameWithType> <xref:System.Text.EncoderFallbackException.CharUnknownLow%2A?displayProperty=nameWithType> vlastností a.</span><span class="sxs-lookup"><span data-stu-id="631b0-296">The characters in the surrogate pair are available from the <xref:System.Text.EncoderFallbackException.CharUnknownHigh%2A?displayProperty=nameWithType> and <xref:System.Text.EncoderFallbackException.CharUnknownLow%2A?displayProperty=nameWithType> properties.</span></span> <span data-ttu-id="631b0-297">Z vlastnosti je k dispozici neznámý jeden znak <xref:System.Text.EncoderFallbackException.CharUnknown%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="631b0-297">The unknown single character is available from the <xref:System.Text.EncoderFallbackException.CharUnknown%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="631b0-298"><xref:System.Text.EncoderFallbackException.Index%2A?displayProperty=nameWithType>Vlastnost určuje pozici v řetězci, na které byl nalezen první znak, který nelze zakódovat.</span><span class="sxs-lookup"><span data-stu-id="631b0-298">The <xref:System.Text.EncoderFallbackException.Index%2A?displayProperty=nameWithType> property indicates the position in the string at which the first character that could not be encoded was found.</span></span>

- <span data-ttu-id="631b0-299"><xref:System.Text.DecoderFallbackException>Objekt obsahuje <xref:System.Text.DecoderFallbackException.BytesUnknown%2A> vlastnost, která vrací pole bajtů, které nelze dekódovat.</span><span class="sxs-lookup"><span data-stu-id="631b0-299">The <xref:System.Text.DecoderFallbackException> object includes a <xref:System.Text.DecoderFallbackException.BytesUnknown%2A> property that returns an array of bytes that cannot be decoded.</span></span> <span data-ttu-id="631b0-300"><xref:System.Text.DecoderFallbackException.Index%2A?displayProperty=nameWithType>Vlastnost označuje počáteční pozici neznámých bajtů.</span><span class="sxs-lookup"><span data-stu-id="631b0-300">The <xref:System.Text.DecoderFallbackException.Index%2A?displayProperty=nameWithType> property indicates the starting position of the unknown bytes.</span></span>

<span data-ttu-id="631b0-301">I když <xref:System.Text.EncoderFallbackException> <xref:System.Text.DecoderFallbackException> objekty a poskytují dostatečné diagnostické informace o výjimce, neposkytují přístup k vyrovnávací paměti pro kódování nebo dekódování.</span><span class="sxs-lookup"><span data-stu-id="631b0-301">Although the <xref:System.Text.EncoderFallbackException> and <xref:System.Text.DecoderFallbackException> objects provide adequate diagnostic information about the exception, they do not provide access to the encoding or decoding buffer.</span></span> <span data-ttu-id="631b0-302">Proto neumožňují nahradit nebo opravit neplatná data v rámci metody Encoding nebo dekódování.</span><span class="sxs-lookup"><span data-stu-id="631b0-302">Therefore, they do not allow invalid data to be replaced or corrected within the encoding or decoding method.</span></span>

<a name="Custom"></a>

## <a name="implementing-a-custom-fallback-strategy"></a><span data-ttu-id="631b0-303">Implementace vlastní nouzové strategie</span><span class="sxs-lookup"><span data-stu-id="631b0-303">Implementing a Custom Fallback Strategy</span></span>

<span data-ttu-id="631b0-304">Kromě nejlepšího mapování, které je implementováno interně pomocí znakových stránek, .NET zahrnuje následující třídy pro implementaci záložní strategie:</span><span class="sxs-lookup"><span data-stu-id="631b0-304">In addition to the best-fit mapping that is implemented internally by code pages, .NET includes the following classes for implementing a fallback strategy:</span></span>

- <span data-ttu-id="631b0-305">Použijte <xref:System.Text.EncoderReplacementFallback> a <xref:System.Text.EncoderReplacementFallbackBuffer> k nahrazení znaků v operacích kódování.</span><span class="sxs-lookup"><span data-stu-id="631b0-305">Use <xref:System.Text.EncoderReplacementFallback> and <xref:System.Text.EncoderReplacementFallbackBuffer> to replace characters in encoding operations.</span></span>

- <span data-ttu-id="631b0-306">Použijte <xref:System.Text.DecoderReplacementFallback> a <xref:System.Text.DecoderReplacementFallbackBuffer> k nahrazení znaků v operacích dekódování.</span><span class="sxs-lookup"><span data-stu-id="631b0-306">Use <xref:System.Text.DecoderReplacementFallback> and <xref:System.Text.DecoderReplacementFallbackBuffer> to replace characters in decoding operations.</span></span>

- <span data-ttu-id="631b0-307">Použijte <xref:System.Text.EncoderExceptionFallback> a <xref:System.Text.EncoderExceptionFallbackBuffer> k vyvolání, <xref:System.Text.EncoderFallbackException> Když znak nelze kódovat.</span><span class="sxs-lookup"><span data-stu-id="631b0-307">Use <xref:System.Text.EncoderExceptionFallback> and <xref:System.Text.EncoderExceptionFallbackBuffer> to throw an <xref:System.Text.EncoderFallbackException> when a character cannot be encoded.</span></span>

- <span data-ttu-id="631b0-308">Použijte <xref:System.Text.DecoderExceptionFallback> a <xref:System.Text.DecoderExceptionFallbackBuffer> k vyvolání, <xref:System.Text.DecoderFallbackException> Když znak nelze dekódovat.</span><span class="sxs-lookup"><span data-stu-id="631b0-308">Use <xref:System.Text.DecoderExceptionFallback> and <xref:System.Text.DecoderExceptionFallbackBuffer> to throw a <xref:System.Text.DecoderFallbackException> when a character cannot be decoded.</span></span>

<span data-ttu-id="631b0-309">Pomocí následujících kroků můžete navíc implementovat vlastní řešení, které se nejlépe hodí pro nouzové účely, náhradní zálohu nebo výjimku.</span><span class="sxs-lookup"><span data-stu-id="631b0-309">In addition, you can implement a custom solution that uses best-fit fallback, replacement fallback, or exception fallback, by following these steps:</span></span>

1. <span data-ttu-id="631b0-310">Odvození třídy z <xref:System.Text.EncoderFallback> pro operace kódování a z <xref:System.Text.DecoderFallback> pro operace dekódování.</span><span class="sxs-lookup"><span data-stu-id="631b0-310">Derive a class from <xref:System.Text.EncoderFallback> for encoding operations, and from <xref:System.Text.DecoderFallback> for decoding operations.</span></span>

2. <span data-ttu-id="631b0-311">Odvození třídy z <xref:System.Text.EncoderFallbackBuffer> pro operace kódování a z <xref:System.Text.DecoderFallbackBuffer> pro operace dekódování.</span><span class="sxs-lookup"><span data-stu-id="631b0-311">Derive a class from <xref:System.Text.EncoderFallbackBuffer> for encoding operations, and from <xref:System.Text.DecoderFallbackBuffer> for decoding operations.</span></span>

3. <span data-ttu-id="631b0-312">Pro záložní výjimku, pokud předdefinované <xref:System.Text.EncoderFallbackException> a <xref:System.Text.DecoderFallbackException> třídy nevyhovují vašim potřebám, odvozuje třídu od objektu výjimky, jako je například <xref:System.Exception> nebo <xref:System.ArgumentException> .</span><span class="sxs-lookup"><span data-stu-id="631b0-312">For exception fallback, if the predefined <xref:System.Text.EncoderFallbackException> and <xref:System.Text.DecoderFallbackException> classes do not meet your needs, derive a class from an exception object such as <xref:System.Exception> or <xref:System.ArgumentException>.</span></span>

### <a name="deriving-from-encoderfallback-or-decoderfallback"></a><span data-ttu-id="631b0-313">Odvození z EncoderFallback nebo DecoderFallback</span><span class="sxs-lookup"><span data-stu-id="631b0-313">Deriving from EncoderFallback or DecoderFallback</span></span>

<span data-ttu-id="631b0-314">Chcete-li implementovat vlastní nouzové řešení, je nutné vytvořit třídu, která dědí z <xref:System.Text.EncoderFallback> pro operace kódování a z <xref:System.Text.DecoderFallback> pro dekódování operací.</span><span class="sxs-lookup"><span data-stu-id="631b0-314">To implement a custom fallback solution, you must create a class that inherits from <xref:System.Text.EncoderFallback> for encoding operations, and from <xref:System.Text.DecoderFallback> for decoding operations.</span></span> <span data-ttu-id="631b0-315">Instance těchto tříd jsou předány <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> metodě a slouží jako prostředník mezi třídou kódování a záložní implementací.</span><span class="sxs-lookup"><span data-stu-id="631b0-315">Instances of these classes are passed to the <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> method and serve as the intermediary between the encoding class and the fallback implementation.</span></span>

<span data-ttu-id="631b0-316">Při vytváření vlastního záložního řešení pro kodér nebo dekodér je nutné implementovat následující členy:</span><span class="sxs-lookup"><span data-stu-id="631b0-316">When you create a custom fallback solution for an encoder or decoder, you must implement the following members:</span></span>

- <span data-ttu-id="631b0-317"><xref:System.Text.EncoderFallback.MaxCharCount%2A?displayProperty=nameWithType>Vlastnost nebo <xref:System.Text.DecoderFallback.MaxCharCount%2A?displayProperty=nameWithType> , která vrací maximální možný počet znaků, které se nejlépe hodí, nahrazuje nebo nevýjimka, může vrátit, aby nahradila jediný znak.</span><span class="sxs-lookup"><span data-stu-id="631b0-317">The <xref:System.Text.EncoderFallback.MaxCharCount%2A?displayProperty=nameWithType> or <xref:System.Text.DecoderFallback.MaxCharCount%2A?displayProperty=nameWithType> property, which returns the maximum possible number of characters that the best-fit, replacement, or exception fallback can return to replace a single character.</span></span> <span data-ttu-id="631b0-318">U vlastní nouzové výjimky má jeho hodnota hodnotu nula.</span><span class="sxs-lookup"><span data-stu-id="631b0-318">For a custom exception fallback, its value is zero.</span></span>

- <span data-ttu-id="631b0-319"><xref:System.Text.EncoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType>Metoda nebo <xref:System.Text.DecoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType> , která vrátí vlastní <xref:System.Text.EncoderFallbackBuffer> nebo <xref:System.Text.DecoderFallbackBuffer> implementaci.</span><span class="sxs-lookup"><span data-stu-id="631b0-319">The <xref:System.Text.EncoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType> or <xref:System.Text.DecoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType> method, which returns your custom <xref:System.Text.EncoderFallbackBuffer> or <xref:System.Text.DecoderFallbackBuffer> implementation.</span></span> <span data-ttu-id="631b0-320">Metoda je volána kodérem při výskytu prvního znaku, který není schopen úspěšně kódovat, nebo dekodérem, když nalezne první bajt, který nemůže úspěšně dekódovat.</span><span class="sxs-lookup"><span data-stu-id="631b0-320">The method is called by the encoder when it encounters the first character that it is unable to successfully encode, or by the decoder when it encounters the first byte that it is unable to successfully decode.</span></span>

### <a name="deriving-from-encoderfallbackbuffer-or-decoderfallbackbuffer"></a><span data-ttu-id="631b0-321">Odvození z EncoderFallbackBuffer nebo DecoderFallbackBuffer</span><span class="sxs-lookup"><span data-stu-id="631b0-321">Deriving from EncoderFallbackBuffer or DecoderFallbackBuffer</span></span>

<span data-ttu-id="631b0-322">Pro implementaci vlastního záložního řešení je nutné také vytvořit třídu, která dědí z <xref:System.Text.EncoderFallbackBuffer> pro operace kódování a z <xref:System.Text.DecoderFallbackBuffer> pro dekódování operací.</span><span class="sxs-lookup"><span data-stu-id="631b0-322">To implement a custom fallback solution, you must also create a class that inherits from <xref:System.Text.EncoderFallbackBuffer> for encoding operations, and from <xref:System.Text.DecoderFallbackBuffer> for decoding operations.</span></span> <span data-ttu-id="631b0-323">Instance těchto tříd jsou vráceny <xref:System.Text.EncoderFallback.CreateFallbackBuffer%2A> metodou <xref:System.Text.EncoderFallback> <xref:System.Text.DecoderFallback> třídy a.</span><span class="sxs-lookup"><span data-stu-id="631b0-323">Instances of these classes are returned by the <xref:System.Text.EncoderFallback.CreateFallbackBuffer%2A> method  of the <xref:System.Text.EncoderFallback> and <xref:System.Text.DecoderFallback> classes.</span></span> <span data-ttu-id="631b0-324"><xref:System.Text.EncoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType>Metoda je volána kodérem, když nalezne první znak, který není možné kódovat, a <xref:System.Text.DecoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType> Metoda je volána dekodérem, když narazí na jeden nebo více bajtů, které není možné dekódovat.</span><span class="sxs-lookup"><span data-stu-id="631b0-324">The <xref:System.Text.EncoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType> method is called by the encoder when it encounters the first character that it is not able to encode, and the <xref:System.Text.DecoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType> method is called by the decoder when it encounters one or more bytes that it is not able to decode.</span></span> <span data-ttu-id="631b0-325"><xref:System.Text.EncoderFallbackBuffer>Třídy a <xref:System.Text.DecoderFallbackBuffer> poskytují záložní implementaci.</span><span class="sxs-lookup"><span data-stu-id="631b0-325">The <xref:System.Text.EncoderFallbackBuffer> and <xref:System.Text.DecoderFallbackBuffer> classes provide the fallback implementation.</span></span> <span data-ttu-id="631b0-326">Každá instance představuje vyrovnávací paměť, která obsahuje záložní znaky, které nahradí znak, který nelze zakódovat, nebo posloupnost bajtů, které nelze dekódovat.</span><span class="sxs-lookup"><span data-stu-id="631b0-326">Each instance represents a buffer that contains the fallback characters that will replace the character that cannot be encoded or the byte sequence that cannot be decoded.</span></span>

<span data-ttu-id="631b0-327">Při vytváření vlastního záložního řešení pro kodér nebo dekodér je nutné implementovat následující členy:</span><span class="sxs-lookup"><span data-stu-id="631b0-327">When you create a custom fallback solution for an encoder or decoder, you must implement the following members:</span></span>

- <span data-ttu-id="631b0-328"><xref:System.Text.EncoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType>Metoda nebo <xref:System.Text.DecoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="631b0-328">The <xref:System.Text.EncoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType> or <xref:System.Text.DecoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="631b0-329"><xref:System.Text.EncoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType>je volána kodérem k poskytnutí záložní vyrovnávací paměti s informacemi o znaku, který nelze kódovat.</span><span class="sxs-lookup"><span data-stu-id="631b0-329"><xref:System.Text.EncoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType> is called by the encoder to provide the fallback buffer with information about the character that it cannot encode.</span></span> <span data-ttu-id="631b0-330">Vzhledem k tomu, že znak pro kódování může být náhradní pár, je tato metoda přetížená.</span><span class="sxs-lookup"><span data-stu-id="631b0-330">Because the character to be encoded may be a surrogate pair, this method is overloaded.</span></span> <span data-ttu-id="631b0-331">Jednomu přetížení se předal znak, který se má zakódovat, a jeho index v řetězci.</span><span class="sxs-lookup"><span data-stu-id="631b0-331">One overload is passed the character to be encoded and its index in the string.</span></span> <span data-ttu-id="631b0-332">Druhé přetížení je předání vysoké a nízké náhrady spolu s indexem v řetězci.</span><span class="sxs-lookup"><span data-stu-id="631b0-332">The second overload is passed the high and low surrogate along with its index in the string.</span></span> <span data-ttu-id="631b0-333"><xref:System.Text.DecoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType>Metoda je volána dekodérem k poskytnutí záložní vyrovnávací paměti s informacemi o bajtech, které nelze dekódovat.</span><span class="sxs-lookup"><span data-stu-id="631b0-333">The <xref:System.Text.DecoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType> method is called by the decoder to provide the fallback buffer with information about the bytes that it cannot decode.</span></span> <span data-ttu-id="631b0-334">Tato metoda předává pole bajtů, které nelze dekódovat, spolu s indexem prvního bajtu.</span><span class="sxs-lookup"><span data-stu-id="631b0-334">This method is passed an array of bytes that it cannot decode, along with the index of the first byte.</span></span> <span data-ttu-id="631b0-335">Záložní metoda by měla vracet, `true` Pokud záložní vyrovnávací paměť může dodat znak nebo náhradní znak nebo znaky. v opačném případě by měla vracet `false` .</span><span class="sxs-lookup"><span data-stu-id="631b0-335">The fallback method should return `true` if the fallback buffer can supply a best-fit or replacement character or characters; otherwise, it should return `false`.</span></span> <span data-ttu-id="631b0-336">Pro zálohu výjimky by měla metoda Fallback vyvolat výjimku.</span><span class="sxs-lookup"><span data-stu-id="631b0-336">For an exception fallback, the fallback method should throw an exception.</span></span>

- <span data-ttu-id="631b0-337"><xref:System.Text.EncoderFallbackBuffer.GetNextChar%2A?displayProperty=nameWithType>Metoda nebo <xref:System.Text.DecoderFallbackBuffer.GetNextChar%2A?displayProperty=nameWithType> , která je volána opakovaně kodérem nebo dekodérem k získání dalšího znaku z záložní vyrovnávací paměti.</span><span class="sxs-lookup"><span data-stu-id="631b0-337">The <xref:System.Text.EncoderFallbackBuffer.GetNextChar%2A?displayProperty=nameWithType> or <xref:System.Text.DecoderFallbackBuffer.GetNextChar%2A?displayProperty=nameWithType> method, which is called repeatedly by the encoder or decoder to get the next character from the fallback buffer.</span></span> <span data-ttu-id="631b0-338">Pokud byly vráceny všechny záložní znaky, metoda by měla vracet U + 0000.</span><span class="sxs-lookup"><span data-stu-id="631b0-338">When all fallback characters have been returned, the method should return U+0000.</span></span>

- <span data-ttu-id="631b0-339"><xref:System.Text.EncoderFallbackBuffer.Remaining%2A?displayProperty=nameWithType>Vlastnost nebo <xref:System.Text.DecoderFallbackBuffer.Remaining%2A?displayProperty=nameWithType> , která vrací počet znaků zbývajících v záložní vyrovnávací paměti.</span><span class="sxs-lookup"><span data-stu-id="631b0-339">The <xref:System.Text.EncoderFallbackBuffer.Remaining%2A?displayProperty=nameWithType> or <xref:System.Text.DecoderFallbackBuffer.Remaining%2A?displayProperty=nameWithType> property, which returns the number of characters remaining in the fallback buffer.</span></span>

- <span data-ttu-id="631b0-340"><xref:System.Text.EncoderFallbackBuffer.MovePrevious%2A?displayProperty=nameWithType>Metoda nebo <xref:System.Text.DecoderFallbackBuffer.MovePrevious%2A?displayProperty=nameWithType> , která přesune aktuální pozici v záložní vyrovnávací paměti na předchozí znak.</span><span class="sxs-lookup"><span data-stu-id="631b0-340">The <xref:System.Text.EncoderFallbackBuffer.MovePrevious%2A?displayProperty=nameWithType> or <xref:System.Text.DecoderFallbackBuffer.MovePrevious%2A?displayProperty=nameWithType> method, which moves the current position in the fallback buffer to the previous character.</span></span>

- <span data-ttu-id="631b0-341"><xref:System.Text.EncoderFallbackBuffer.Reset%2A?displayProperty=nameWithType>Metoda nebo <xref:System.Text.DecoderFallbackBuffer.Reset%2A?displayProperty=nameWithType> , která znovu inicializuje záložní vyrovnávací paměť.</span><span class="sxs-lookup"><span data-stu-id="631b0-341">The <xref:System.Text.EncoderFallbackBuffer.Reset%2A?displayProperty=nameWithType> or <xref:System.Text.DecoderFallbackBuffer.Reset%2A?displayProperty=nameWithType> method, which reinitializes the fallback buffer.</span></span>

<span data-ttu-id="631b0-342">Pokud je nouzová implementace nejlépe vyhovující záložnímu nebo náhradnímu Fallback, třídy odvozené z <xref:System.Text.EncoderFallbackBuffer> a <xref:System.Text.DecoderFallbackBuffer> také udržují dvě soukromá pole instance: přesný počet znaků ve vyrovnávací paměti a index dalšího znaku ve vyrovnávací paměti, který má být vrácen.</span><span class="sxs-lookup"><span data-stu-id="631b0-342">If the fallback implementation is a best-fit fallback or a replacement fallback, the classes derived from <xref:System.Text.EncoderFallbackBuffer> and <xref:System.Text.DecoderFallbackBuffer> also maintain two private instance fields: the exact number of characters in the buffer; and the index of the next character in the buffer to return.</span></span>

### <a name="an-encoderfallback-example"></a><span data-ttu-id="631b0-343">EncoderFallback příklad</span><span class="sxs-lookup"><span data-stu-id="631b0-343">An EncoderFallback Example</span></span>

<span data-ttu-id="631b0-344">Předchozí příklad používá náhradní zálohu k nahrazení znaků Unicode, které neodpovídaly znakům ASCII hvězdičkou (\*).</span><span class="sxs-lookup"><span data-stu-id="631b0-344">An earlier example used replacement fallback to replace Unicode characters that did not correspond to ASCII characters with an asterisk (\*).</span></span> <span data-ttu-id="631b0-345">Následující příklad používá vlastní implementaci záložní implementace, která je vhodná pro zajištění lepšího mapování znaků, které nejsou ASCII.</span><span class="sxs-lookup"><span data-stu-id="631b0-345">The following example uses a custom best-fit fallback implementation instead to provide a better mapping of non-ASCII characters.</span></span>

<span data-ttu-id="631b0-346">Následující kód definuje třídu s názvem `CustomMapper` , která je odvozena z <xref:System.Text.EncoderFallback> a zpracovává tak nejlepší mapování znaků, které nejsou ASCII.</span><span class="sxs-lookup"><span data-stu-id="631b0-346">The following code defines a class named `CustomMapper` that is derived from <xref:System.Text.EncoderFallback> to handle the best-fit mapping of non-ASCII characters.</span></span> <span data-ttu-id="631b0-347">Jeho `CreateFallbackBuffer` Metoda vrátí `CustomMapperFallbackBuffer` objekt, který poskytuje <xref:System.Text.EncoderFallbackBuffer> implementaci.</span><span class="sxs-lookup"><span data-stu-id="631b0-347">Its `CreateFallbackBuffer` method returns a `CustomMapperFallbackBuffer` object, which provides the <xref:System.Text.EncoderFallbackBuffer> implementation.</span></span> <span data-ttu-id="631b0-348">`CustomMapper`Třída používá <xref:System.Collections.Generic.Dictionary%602> objekt k uložení mapování nepodporovaných znaků Unicode (hodnota klíče) a jejich odpovídajících 8bitových znaků (které jsou uloženy ve dvou po sobě jdoucích bajtech v 64ovém Integer).</span><span class="sxs-lookup"><span data-stu-id="631b0-348">The `CustomMapper` class uses a <xref:System.Collections.Generic.Dictionary%602> object to store the mappings of unsupported Unicode characters (the key value) and their corresponding 8-bit characters (which are stored in two consecutive bytes in a 64-bit integer).</span></span> <span data-ttu-id="631b0-349">Chcete-li toto mapování zpřístupnit pro záložní vyrovnávací paměť, `CustomMapper` je instance předána jako parametr `CustomMapperFallbackBuffer` konstruktoru třídy.</span><span class="sxs-lookup"><span data-stu-id="631b0-349">To make this mapping available to the fallback buffer, the `CustomMapper` instance is passed as a parameter to the `CustomMapperFallbackBuffer` class constructor.</span></span> <span data-ttu-id="631b0-350">Vzhledem k tomu, že nejdelší mapování je řetězec "INF" pro znak Unicode U + 221E, `MaxCharCount` vrátí vlastnost hodnotu 3.</span><span class="sxs-lookup"><span data-stu-id="631b0-350">Because the longest mapping is the string "INF" for the Unicode character U+221E, the `MaxCharCount` property returns 3.</span></span>

[!code-csharp[Conceptual.Encoding#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/custom1.cs#5)]
[!code-vb[Conceptual.Encoding#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/custom1.vb#5)]

<span data-ttu-id="631b0-351">Následující kód definuje `CustomMapperFallbackBuffer` třídu, která je odvozena z <xref:System.Text.EncoderFallbackBuffer> .</span><span class="sxs-lookup"><span data-stu-id="631b0-351">The following code defines the `CustomMapperFallbackBuffer` class, which is derived from <xref:System.Text.EncoderFallbackBuffer>.</span></span> <span data-ttu-id="631b0-352">Slovník, který obsahuje mapování nejlepšího umístění a který je definován v `CustomMapper` instanci, je k dispozici z jeho konstruktoru třídy.</span><span class="sxs-lookup"><span data-stu-id="631b0-352">The dictionary that contains best-fit mappings and that is defined in the `CustomMapper` instance is available from its class constructor.</span></span> <span data-ttu-id="631b0-353">Jeho `Fallback` Metoda vrátí `true` , pokud některý ze znaků Unicode, které kodér ASCII nemůže kódovat, je definován ve slovníku mapování; v opačném případě vrátí `false` .</span><span class="sxs-lookup"><span data-stu-id="631b0-353">Its `Fallback` method returns `true` if any of the Unicode characters that the ASCII encoder cannot encode are defined in the mapping dictionary; otherwise, it returns `false`.</span></span> <span data-ttu-id="631b0-354">Pro každou zálohu `count` Určuje soukromá proměnná počet znaků, které budou vráceny, a soukromá `index` Proměnná označuje pozici v bufferu řetězce, a `charsToReturn` to u dalšího znaku, který chcete vrátit.</span><span class="sxs-lookup"><span data-stu-id="631b0-354">For each fallback, the private `count` variable indicates the number of characters that remain to be returned, and the private `index` variable indicates the position in the string buffer, `charsToReturn`, of the next character to return.</span></span>

[!code-csharp[Conceptual.Encoding#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/custom1.cs#6)]
[!code-vb[Conceptual.Encoding#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/custom1.vb#6)]

<span data-ttu-id="631b0-355">Následující kód potom vytvoří instanci `CustomMapper` objektu a předá jeho instanci <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> metodě.</span><span class="sxs-lookup"><span data-stu-id="631b0-355">The following code then instantiates the `CustomMapper` object and passes an instance of it to the <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="631b0-356">Výstup označuje, že pro záložní implementaci, který nejlépe vyhovuje, se v původním řetězci zpracovávají tři znaky jiné než ASCII.</span><span class="sxs-lookup"><span data-stu-id="631b0-356">The output indicates that the best-fit fallback implementation successfully handles the three non-ASCII characters in the original string.</span></span>

[!code-csharp[Conceptual.Encoding#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/custom1.cs#7)]
[!code-vb[Conceptual.Encoding#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/custom1.vb#7)]

## <a name="see-also"></a><span data-ttu-id="631b0-357">Viz také</span><span class="sxs-lookup"><span data-stu-id="631b0-357">See also</span></span>

- [<span data-ttu-id="631b0-358">Úvod do kódování znaků v rozhraní .NET</span><span class="sxs-lookup"><span data-stu-id="631b0-358">Introduction to character encoding in .NET</span></span>](character-encoding-introduction.md)
- <xref:System.Text.Encoder>
- <xref:System.Text.Decoder>
- <xref:System.Text.DecoderFallback>
- <xref:System.Text.Encoding>
- <xref:System.Text.EncoderFallback>
- [<span data-ttu-id="631b0-359">Globalizace a lokalizace</span><span class="sxs-lookup"><span data-stu-id="631b0-359">Globalization and Localization</span></span>](../globalization-localization/index.md)
