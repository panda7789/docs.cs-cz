---
title: Latentní režimy
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- garbage collection, intrusiveness
- garbage collection, latency modes
ms.assetid: 96278bb7-6eab-4612-8594-ceebfc887d81
ms.openlocfilehash: a8eaf0c80aa32978eead80c51a905cbcd66a537b
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/15/2020
ms.locfileid: "74283598"
---
# <a name="latency-modes"></a><span data-ttu-id="2e34f-102">Režimy latence</span><span class="sxs-lookup"><span data-stu-id="2e34f-102">Latency modes</span></span>

<span data-ttu-id="2e34f-103">Chcete-li získat objekty, systém uvolňování paměti (GC) musí zastavit všechna spuštěná vlákna v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="2e34f-103">To reclaim objects, the garbage collector (GC) must stop all the executing threads in an application.</span></span> <span data-ttu-id="2e34f-104">Doba, po kterou je aktivní systém uvolňování paměti, se označuje jako jeho *latence*.</span><span class="sxs-lookup"><span data-stu-id="2e34f-104">The period of time during which the garbage collector is active is referred to as its *latency*.</span></span>

<span data-ttu-id="2e34f-105">V některých situacích, například když aplikace načte data nebo zobrazí obsah, úplné uvolnění paměti může dojít v kritickém čase a bránit výkonu.</span><span class="sxs-lookup"><span data-stu-id="2e34f-105">In some situations, such as when an application retrieves data or displays content, a full garbage collection can occur at a critical time and impede performance.</span></span> <span data-ttu-id="2e34f-106">Můžete upravit rušivost systému uvolňování paměti <xref:System.Runtime.GCSettings.LatencyMode%2A?displayProperty=nameWithType> nastavením vlastnosti <xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType> na jednu z hodnot.</span><span class="sxs-lookup"><span data-stu-id="2e34f-106">You can adjust the intrusiveness of the garbage collector by setting the <xref:System.Runtime.GCSettings.LatencyMode%2A?displayProperty=nameWithType> property to one of the <xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType> values.</span></span>

## <a name="low-latency-settings"></a><span data-ttu-id="2e34f-107">Nastavení s nízkou latencí</span><span class="sxs-lookup"><span data-stu-id="2e34f-107">Low latency settings</span></span>

<span data-ttu-id="2e34f-108">Použití "nízké" latence nastavení znamená, že uvolňování vnikne méně ve vaší aplikaci.</span><span class="sxs-lookup"><span data-stu-id="2e34f-108">Using a "low" latency setting means the garbage collector intrudes less in your application.</span></span> <span data-ttu-id="2e34f-109">Uvolňování paměti je konzervativnější o uvolnění paměti.</span><span class="sxs-lookup"><span data-stu-id="2e34f-109">Garbage collection is more conservative about reclaiming memory.</span></span>

<span data-ttu-id="2e34f-110">Výčet <xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType> poskytuje dvě nastavení s nízkou latencí:</span><span class="sxs-lookup"><span data-stu-id="2e34f-110">The <xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType> enumeration provides two low latency settings:</span></span>

- <span data-ttu-id="2e34f-111">[GCLatencyMode.LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) potlačuje kolekce generace 2 a provádí pouze generování 0 a 1 kolekce.</span><span class="sxs-lookup"><span data-stu-id="2e34f-111">[GCLatencyMode.LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) suppresses generation 2 collections and performs only generation 0 and 1 collections.</span></span> <span data-ttu-id="2e34f-112">Může být použit pouze na krátkou dobu.</span><span class="sxs-lookup"><span data-stu-id="2e34f-112">It can be used only for short periods of time.</span></span> <span data-ttu-id="2e34f-113">Po delší dobu, pokud je systém pod tlakem paměti, systém uvolňování paměti spustí kolekci, která může krátce pozastavit aplikaci a narušit časově kritickou operaci.</span><span class="sxs-lookup"><span data-stu-id="2e34f-113">Over longer periods, if the system is under memory pressure, the garbage collector will trigger a collection, which can briefly pause the application and disrupt a time-critical operation.</span></span> <span data-ttu-id="2e34f-114">Toto nastavení je k dispozici pouze pro uvolňování paměti pracovní stanice.</span><span class="sxs-lookup"><span data-stu-id="2e34f-114">This setting is available only for workstation garbage collection.</span></span>

- <span data-ttu-id="2e34f-115">[GCLatencyMode.SustainedLowLatency](xref:System.Runtime.GCLatencyMode.SustainedLowLatency) potlačuje kolekce generace popředí 2 a provádí pouze generování 0, 1 a pozadí generace 2 kolekce.</span><span class="sxs-lookup"><span data-stu-id="2e34f-115">[GCLatencyMode.SustainedLowLatency](xref:System.Runtime.GCLatencyMode.SustainedLowLatency) suppresses foreground generation 2 collections and performs only generation 0, 1, and background generation 2 collections.</span></span> <span data-ttu-id="2e34f-116">Může být použit pro delší časové období a je k dispozici pro pracovní stanice a server uvolňování paměti.</span><span class="sxs-lookup"><span data-stu-id="2e34f-116">It can be used for longer periods of time, and is available for both workstation and server garbage collection.</span></span> <span data-ttu-id="2e34f-117">Toto nastavení nelze použít, pokud je zakázáno uvolňování paměti na pozadí.</span><span class="sxs-lookup"><span data-stu-id="2e34f-117">This setting cannot be used if background garbage collection is disabled.</span></span>

<span data-ttu-id="2e34f-118">Během období s nízkou latencí generace 2 kolekce jsou potlačeny, pokud dojde k následující:</span><span class="sxs-lookup"><span data-stu-id="2e34f-118">During low latency periods, generation 2 collections are suppressed unless the following occurs:</span></span>

- <span data-ttu-id="2e34f-119">Systém obdrží oznámení o nedostatku paměti z operačního systému.</span><span class="sxs-lookup"><span data-stu-id="2e34f-119">The system receives a low memory notification from the operating system.</span></span>

- <span data-ttu-id="2e34f-120">Kód aplikace indukuje <xref:System.GC.Collect%2A?displayProperty=nameWithType> kolekci voláním `generation` metody a zadáním 2 pro parametr.</span><span class="sxs-lookup"><span data-stu-id="2e34f-120">Application code induces a collection by calling the <xref:System.GC.Collect%2A?displayProperty=nameWithType> method and specifying 2 for the `generation` parameter.</span></span>

## <a name="scenarios"></a><span data-ttu-id="2e34f-121">Scénáře</span><span class="sxs-lookup"><span data-stu-id="2e34f-121">Scenarios</span></span>

<span data-ttu-id="2e34f-122">V následující tabulce jsou uvedeny <xref:System.Runtime.GCLatencyMode> scénáře aplikace pro použití hodnot:</span><span class="sxs-lookup"><span data-stu-id="2e34f-122">The following table lists the application scenarios for using the <xref:System.Runtime.GCLatencyMode> values:</span></span>

|<span data-ttu-id="2e34f-123">Latence režim</span><span class="sxs-lookup"><span data-stu-id="2e34f-123">Latency mode</span></span>|<span data-ttu-id="2e34f-124">Scénáře aplikací</span><span class="sxs-lookup"><span data-stu-id="2e34f-124">Application scenarios</span></span>|
|------------------|---------------------------|
|<xref:System.Runtime.GCLatencyMode.Batch>|<span data-ttu-id="2e34f-125">Pro aplikace, které nemají žádné uživatelské rozhraní (UI) nebo operace na straně serveru.</span><span class="sxs-lookup"><span data-stu-id="2e34f-125">For applications that have no user interface (UI) or server-side operations.</span></span><br /><br /><span data-ttu-id="2e34f-126">Pokud je uvolňování paměti na pozadí zakázáno, jedná se o výchozí režim pro uvolňování paměti pracovní stanice a serveru.</span><span class="sxs-lookup"><span data-stu-id="2e34f-126">When background garbage collection is disabled, this is the default mode for workstation and server garbage collection.</span></span> <span data-ttu-id="2e34f-127"><xref:System.Runtime.GCLatencyMode.Batch>režim také přepíše nastavení [gcConcurrent,](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md) to znamená, že zabraňuje pozadí nebo souběžných kolekcí.</span><span class="sxs-lookup"><span data-stu-id="2e34f-127"><xref:System.Runtime.GCLatencyMode.Batch> mode also overrides the [gcConcurrent](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md) setting, that is, it prevents background or concurrent collections.</span></span>|
|<xref:System.Runtime.GCLatencyMode.Interactive>|<span data-ttu-id="2e34f-128">Pro většinu aplikací, které mají ui.</span><span class="sxs-lookup"><span data-stu-id="2e34f-128">For most applications that have a UI.</span></span><br /><br /><span data-ttu-id="2e34f-129">Toto je výchozí režim pro uvolňování paměti pracovní stanice a serveru.</span><span class="sxs-lookup"><span data-stu-id="2e34f-129">This is the default mode for workstation and server garbage collection.</span></span> <span data-ttu-id="2e34f-130">Pokud je však aplikace hostována, mají přednost nastavení uvolňování paměti hostitelského procesu.</span><span class="sxs-lookup"><span data-stu-id="2e34f-130">However, if an app is hosted, the garbage collector settings of the hosting process take precedence.</span></span>|
|<xref:System.Runtime.GCLatencyMode.LowLatency>|<span data-ttu-id="2e34f-131">Pro aplikace, které mají krátkodobé, časově citlivé operace, během kterého přerušení z uvolňování může být rušivé.</span><span class="sxs-lookup"><span data-stu-id="2e34f-131">For applications that have short-term, time-sensitive operations during which interruptions from the garbage collector could be disruptive.</span></span> <span data-ttu-id="2e34f-132">Například aplikace, které vykreslují animace nebo funkce pro sběr dat.</span><span class="sxs-lookup"><span data-stu-id="2e34f-132">For example, applications that render animations or data acquisition functions.</span></span>|
|<xref:System.Runtime.GCLatencyMode.SustainedLowLatency>|<span data-ttu-id="2e34f-133">Pro aplikace, které mají časově citlivé operace pro uzavřené, ale potenciálně delší dobu trvání, během kterého přerušení z uvolňování může být rušivé.</span><span class="sxs-lookup"><span data-stu-id="2e34f-133">For applications that have time-sensitive operations for a contained but potentially longer duration of time during which interruptions from the garbage collector could be disruptive.</span></span> <span data-ttu-id="2e34f-134">Například aplikace, které potřebují rychlou odezvu, protože se během obchodních hodin mění údaje o trhu.</span><span class="sxs-lookup"><span data-stu-id="2e34f-134">For example, applications that need quick response times as market data changes during trading hours.</span></span><br /><br /><span data-ttu-id="2e34f-135">Výsledkem tohoto režimu je větší velikost spravované haldy než jiné režimy.</span><span class="sxs-lookup"><span data-stu-id="2e34f-135">This mode results in a larger managed heap size than other modes.</span></span> <span data-ttu-id="2e34f-136">Vzhledem k tomu, že není komprimovat spravované haldy, vyšší fragmentace je možné.</span><span class="sxs-lookup"><span data-stu-id="2e34f-136">Because it does not compact the managed heap, higher fragmentation is possible.</span></span> <span data-ttu-id="2e34f-137">Ujistěte se, že je k dispozici dostatek paměti.</span><span class="sxs-lookup"><span data-stu-id="2e34f-137">Ensure that sufficient memory is available.</span></span>|

## <a name="guidelines-for-using-low-latency"></a><span data-ttu-id="2e34f-138">Pokyny pro použití s nízkou latencí</span><span class="sxs-lookup"><span data-stu-id="2e34f-138">Guidelines for using low latency</span></span>

<span data-ttu-id="2e34f-139">Při použití [režimu GCLatencyMode.LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) zvažte následující pokyny:</span><span class="sxs-lookup"><span data-stu-id="2e34f-139">When you use [GCLatencyMode.LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) mode, consider the following guidelines:</span></span>

- <span data-ttu-id="2e34f-140">Udržujte časové období v nízké latenci co nejkratší.</span><span class="sxs-lookup"><span data-stu-id="2e34f-140">Keep the period of time in low latency as short as possible.</span></span>

- <span data-ttu-id="2e34f-141">Vyhněte se přidělování vysoké množství paměti během období s nízkou latencí.</span><span class="sxs-lookup"><span data-stu-id="2e34f-141">Avoid allocating high amounts of memory during low latency periods.</span></span> <span data-ttu-id="2e34f-142">Oznámení nedostatku paměti může dojít, protože uvolňování paměti uvolňuje méně objektů.</span><span class="sxs-lookup"><span data-stu-id="2e34f-142">Low memory notifications can occur because garbage collection reclaims fewer objects.</span></span>

- <span data-ttu-id="2e34f-143">Zatímco v režimu s nízkou latencí, minimalizovat počet nových přidělení, zejména přidělení na haldy velkého objektu a připnuté objekty.</span><span class="sxs-lookup"><span data-stu-id="2e34f-143">While in the low latency mode, minimize the number of new allocations, in particular allocations onto the large object heap and pinned objects.</span></span>

- <span data-ttu-id="2e34f-144">Mějte na paměti podprocesy, které by mohly být přidělování.</span><span class="sxs-lookup"><span data-stu-id="2e34f-144">Be aware of threads that could be allocating.</span></span> <span data-ttu-id="2e34f-145">Vzhledem <xref:System.Runtime.GCSettings.LatencyMode%2A> k tomu, že <xref:System.OutOfMemoryException> nastavení vlastnosti je celý proces, výjimky mohou být generovány v libovolném vlákně, které je přidělování.</span><span class="sxs-lookup"><span data-stu-id="2e34f-145">Because the <xref:System.Runtime.GCSettings.LatencyMode%2A> property setting is process-wide, <xref:System.OutOfMemoryException> exceptions can be generated on any thread that is allocating.</span></span>

- <span data-ttu-id="2e34f-146">Zalomit kód s nízkou latencí v oblastech omezené spuštění.</span><span class="sxs-lookup"><span data-stu-id="2e34f-146">Wrap the low latency code in constrained execution regions.</span></span> <span data-ttu-id="2e34f-147">Další informace naleznete [v tématu Oblasti omezeného provádění](../../../docs/framework/performance/constrained-execution-regions.md).</span><span class="sxs-lookup"><span data-stu-id="2e34f-147">For more information, see [Constrained execution regions](../../../docs/framework/performance/constrained-execution-regions.md).</span></span>

- <span data-ttu-id="2e34f-148">Můžete vynutit generování 2 kolekce během období <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%29?displayProperty=nameWithType> s nízkou latencí voláním metody.</span><span class="sxs-lookup"><span data-stu-id="2e34f-148">You can force generation 2 collections during a low latency period by calling the <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%29?displayProperty=nameWithType> method.</span></span>

## <a name="see-also"></a><span data-ttu-id="2e34f-149">Viz také</span><span class="sxs-lookup"><span data-stu-id="2e34f-149">See also</span></span>

- <xref:System.GC?displayProperty=nameWithType>
- [<span data-ttu-id="2e34f-150">Vyvolané kolekce</span><span class="sxs-lookup"><span data-stu-id="2e34f-150">Induced Collections</span></span>](../../../docs/standard/garbage-collection/induced.md)
- [<span data-ttu-id="2e34f-151">Kolekce paměti</span><span class="sxs-lookup"><span data-stu-id="2e34f-151">Garbage Collection</span></span>](../../../docs/standard/garbage-collection/index.md)
