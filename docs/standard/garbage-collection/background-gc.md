---
title: Uvolňování paměti na pozadí
description: Další informace o uvolňování paměti na pozadí v rozhraní .NET a o tom, jak se liší v uvolňování paměti pracovní stanice a serveru.
ms.date: 04/21/2020
helpviewer_keywords:
- garbage collection, background
- background garbage collection
ms.openlocfilehash: dcb1d348e679e07646273b8fbc4ea29b44ee4974
ms.sourcegitcommit: 73aa9653547a1cd70ee6586221f79cc29b588ebd
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/23/2020
ms.locfileid: "82103560"
---
# <a name="background-garbage-collection"></a><span data-ttu-id="0a05b-103">Uvolňování paměti na pozadí</span><span class="sxs-lookup"><span data-stu-id="0a05b-103">Background garbage collection</span></span>

<span data-ttu-id="0a05b-104">V uvolňování paměti na pozadí (GC) dočasné generace (0 a 1) jsou shromažďovány podle potřeby, zatímco probíhá kolekce generace 2.</span><span class="sxs-lookup"><span data-stu-id="0a05b-104">In background garbage collection (GC), ephemeral generations (0 and 1) are collected as needed while the collection of generation 2 is in progress.</span></span> <span data-ttu-id="0a05b-105">Uvolňování paměti na pozadí se provádí na jednom nebo více vyhrazených vláknech v závislosti na tom, zda je to pozadí nebo server GC a platí pouze pro kolekce generace 2.</span><span class="sxs-lookup"><span data-stu-id="0a05b-105">Background garbage collection is performed on one or more dedicated threads, depending on whether it's background or server GC, and applies only to generation 2 collections.</span></span>

<span data-ttu-id="0a05b-106">Uvolnění paměti na pozadí je ve výchozím nastavení povoleno.</span><span class="sxs-lookup"><span data-stu-id="0a05b-106">Background garbage collection is enabled by default.</span></span> <span data-ttu-id="0a05b-107">Může být povolena nebo zakázána nastavením [konfigurace gcConcurrent](../../../docs/framework/configure-apps/file-schema/runtime/gcconcurrent-element.md) v aplikacích rozhraní .NET Framework nebo [nastavenísystem.GC.Concurrent](../../core/run-time-config/garbage-collector.md#systemgcconcurrentcomplus_gcconcurrent) v aplikacích .NET Core.</span><span class="sxs-lookup"><span data-stu-id="0a05b-107">It can be enabled or disabled with the [gcConcurrent](../../../docs/framework/configure-apps/file-schema/runtime/gcconcurrent-element.md) configuration setting in .NET Framework apps or the [System.GC.Concurrent](../../core/run-time-config/garbage-collector.md#systemgcconcurrentcomplus_gcconcurrent) setting in .NET Core apps.</span></span>

> [!NOTE]
> <span data-ttu-id="0a05b-108">Uvolňování paměti na pozadí nahrazuje [souběžné uvolňování paměti](#concurrent-garbage-collection) a je k dispozici v rozhraní .NET Framework 4 a novějších verzích.</span><span class="sxs-lookup"><span data-stu-id="0a05b-108">Background garbage collection replaces [concurrent garbage collection](#concurrent-garbage-collection) and is available in .NET Framework 4 and later versions.</span></span> <span data-ttu-id="0a05b-109">V rozhraní .NET Framework 4 je podporována pouze pro uvolňování paměti *pracovní stanice.*</span><span class="sxs-lookup"><span data-stu-id="0a05b-109">In .NET Framework 4, it's supported only for *workstation* garbage collection.</span></span> <span data-ttu-id="0a05b-110">Počínaje rozhraním .NET Framework 4.5 je k dispozici uvolňování paměti na pozadí pro uvolňování paměti *pracovní stanice* i *serveru.*</span><span class="sxs-lookup"><span data-stu-id="0a05b-110">Starting with .NET Framework 4.5, background garbage collection is available for both *workstation* and *server* garbage collection.</span></span>

<span data-ttu-id="0a05b-111">Kolekce na dočasné generace během uvolňování paměti na pozadí se označuje jako uvolňování paměti *popředí.*</span><span class="sxs-lookup"><span data-stu-id="0a05b-111">A collection on ephemeral generations during background garbage collection is known as *foreground* garbage collection.</span></span> <span data-ttu-id="0a05b-112">Dojde-li k uvolnění paměti v popředí, jsou pozastavena všechna spravovaná vlákna.</span><span class="sxs-lookup"><span data-stu-id="0a05b-112">When foreground garbage collections occur, all managed threads are suspended.</span></span>

<span data-ttu-id="0a05b-113">Pokud probíhá uvolňování paměti na pozadí a v generaci 0 jste přidělili dostatek objektů, clr provádí generování 0 nebo generace 1 uvolňování paměti na popředí.</span><span class="sxs-lookup"><span data-stu-id="0a05b-113">When background garbage collection is in progress and you've allocated enough objects in generation 0, the CLR performs a generation 0 or generation 1 foreground garbage collection.</span></span> <span data-ttu-id="0a05b-114">Vyhrazené vlákno uvolňování paměti na pozadí kontroluje v častých bezpečných bodech k určení, zda existuje požadavek na uvolnění paměti v popředí.</span><span class="sxs-lookup"><span data-stu-id="0a05b-114">The dedicated background garbage collection thread checks at frequent safe points to determine whether there is a request for foreground garbage collection.</span></span> <span data-ttu-id="0a05b-115">Pokud existuje, kolekce pozadí pozastaví sám tak, aby může dojít k uvolňování paměti popředí.</span><span class="sxs-lookup"><span data-stu-id="0a05b-115">If there is, the background collection suspends itself so that foreground garbage collection can occur.</span></span> <span data-ttu-id="0a05b-116">Po dokončení uvolňování paměti na popředí, vyhrazené podprocesy uvolňování paměti na pozadí a vlákna uživatele pokračovat.</span><span class="sxs-lookup"><span data-stu-id="0a05b-116">After the foreground garbage collection is completed, the dedicated background garbage collection threads and user threads resume.</span></span>

<span data-ttu-id="0a05b-117">Uvolňování paměti na pozadí odebere omezení přidělení uložená souběžným uvolňováním paměti, protože dočasné uvolnění paměti může nastat během uvolňování paměti na pozadí.</span><span class="sxs-lookup"><span data-stu-id="0a05b-117">Background garbage collection removes allocation restrictions imposed by concurrent garbage collection, because ephemeral garbage collections can occur during background garbage collection.</span></span> <span data-ttu-id="0a05b-118">Uvolňování paměti na pozadí může odebrat nevrácené objekty v dočasných generacích.</span><span class="sxs-lookup"><span data-stu-id="0a05b-118">Background garbage collection can remove dead objects in ephemeral generations.</span></span> <span data-ttu-id="0a05b-119">Může také rozbalit haldy v případě potřeby během uvolnění paměti generace 1.</span><span class="sxs-lookup"><span data-stu-id="0a05b-119">It can also expand the heap if needed during a generation 1 garbage collection.</span></span>

## <a name="background-workstation-vs-server-gc"></a><span data-ttu-id="0a05b-120">Pracovní stanice na pozadí vs. server GC</span><span class="sxs-lookup"><span data-stu-id="0a05b-120">Background workstation vs. server GC</span></span>

<span data-ttu-id="0a05b-121">Počínaje rozhraním .NET Framework 4.5 je pro server GC k dispozici uvolňování paměti na pozadí.</span><span class="sxs-lookup"><span data-stu-id="0a05b-121">Starting with .NET Framework 4.5, background garbage collection is available for server GC.</span></span> <span data-ttu-id="0a05b-122">Gc na pozadí je výchozí režim pro uvolnění paměti serveru.</span><span class="sxs-lookup"><span data-stu-id="0a05b-122">Background GC is the default mode for server garbage collection.</span></span>

<span data-ttu-id="0a05b-123">Uvolňování paměti serveru na pozadí funguje podobně jako uvolňování paměti pracovní stanice na pozadí, ale existuje několik rozdílů:</span><span class="sxs-lookup"><span data-stu-id="0a05b-123">Background server garbage collection functions similarly to background workstation garbage collection, but there are a few differences:</span></span>

- <span data-ttu-id="0a05b-124">Uvolňování paměti pracovní stanice na pozadí používá jedno vyhrazené vlákno uvolňování paměti na pozadí, zatímco uvolňování paměti serveru na pozadí používá více vláken.</span><span class="sxs-lookup"><span data-stu-id="0a05b-124">Background workstation garbage collection uses one dedicated background garbage collection thread, whereas background server garbage collection uses multiple threads.</span></span> <span data-ttu-id="0a05b-125">Obvykle je vyhrazené vlákno pro každý logický procesor.</span><span class="sxs-lookup"><span data-stu-id="0a05b-125">Typically, there's a dedicated thread for each logical processor.</span></span>

- <span data-ttu-id="0a05b-126">Na rozdíl od vlákna uvolňování paměti na pozadí pracovní stanice nejsou časový mj.</span><span class="sxs-lookup"><span data-stu-id="0a05b-126">Unlike the workstation background garbage collection thread, the background server GC threads do not time out.</span></span>

<span data-ttu-id="0a05b-127">Následující obrázek znázorňuje uvolňování paměti *pracovní stanice* na pozadí provedené v samostatném vyhrazeném vlákně:</span><span class="sxs-lookup"><span data-stu-id="0a05b-127">The following illustration shows background *workstation* garbage collection performed on a separate, dedicated thread:</span></span>

![Uvolňování paměti pracovní stanice na pozadí](./media/fundamentals/background-workstation-garbage-collection.png)

<span data-ttu-id="0a05b-129">Následující obrázek znázorňuje uvolňování paměti *serveru* na pozadí prováděné v samostatných vyhrazených vláknech:</span><span class="sxs-lookup"><span data-stu-id="0a05b-129">The following illustration shows background *server* garbage collection performed on separate, dedicated threads:</span></span>

![Uvolnění paměti serveru na pozadí](./media/fundamentals/background-server-garbage-collection.png)

## <a name="concurrent-garbage-collection"></a><span data-ttu-id="0a05b-131">Souběžné uvolňování paměti</span><span class="sxs-lookup"><span data-stu-id="0a05b-131">Concurrent garbage collection</span></span>

> [!TIP]
> <span data-ttu-id="0a05b-132">Tento oddíl se vztahuje na:</span><span class="sxs-lookup"><span data-stu-id="0a05b-132">This section applies to:</span></span>
>
> - <span data-ttu-id="0a05b-133">Rozhraní .NET Framework 3.5 a starší pro uvolňování paměti pracovní stanice</span><span class="sxs-lookup"><span data-stu-id="0a05b-133">.NET Framework 3.5 and earlier for workstation garbage collection</span></span>
> - <span data-ttu-id="0a05b-134">Rozhraní .NET Framework 4 a starší pro uvolnění paměti serveru</span><span class="sxs-lookup"><span data-stu-id="0a05b-134">.NET Framework 4 and earlier for server garbage collection</span></span>
>
> <span data-ttu-id="0a05b-135">Souběžné nesmysly jsou nahrazeny uvolňováním paměti na pozadí v novějších verzích.</span><span class="sxs-lookup"><span data-stu-id="0a05b-135">Concurrent garbage is replaced by background garbage collection in later versions.</span></span>

<span data-ttu-id="0a05b-136">V uvolňování paměti pracovní stanice nebo serveru můžete [povolit souběžné uvolňování paměti](../../../docs/framework/configure-apps/file-schema/runtime/gcconcurrent-element.md), které umožňuje souběžné spuštění vláken s vyhrazeným vláknem, které provádí uvolňování paměti po většinu doby trvání kolekce.</span><span class="sxs-lookup"><span data-stu-id="0a05b-136">In workstation or server garbage collection, you can [enable concurrent garbage collection](../../../docs/framework/configure-apps/file-schema/runtime/gcconcurrent-element.md), which enables threads to run concurrently with a dedicated thread that performs the garbage collection for most of the duration of the collection.</span></span> <span data-ttu-id="0a05b-137">Tato možnost ovlivňuje pouze uvolňování paměti v generaci 2; generace 0 a 1 jsou vždy nesouběžné, protože se rychle dokončí.</span><span class="sxs-lookup"><span data-stu-id="0a05b-137">This option affects only garbage collections in generation 2; generations 0 and 1 are always non-concurrent because they finish fast.</span></span>

<span data-ttu-id="0a05b-138">Souběžné uvolňování paměti umožňuje interaktivní masy lépe reagovat minimalizací pauzy pro kolekci.</span><span class="sxs-lookup"><span data-stu-id="0a05b-138">Concurrent garbage collection enables interactive applications to be more responsive by minimizing pauses for a collection.</span></span> <span data-ttu-id="0a05b-139">Spravovaná vlákna mohou pokračovat ve většině času při spuštění souběžného vlákna uvolňování paměti.</span><span class="sxs-lookup"><span data-stu-id="0a05b-139">Managed threads can continue to run most of the time while the concurrent garbage collection thread is running.</span></span> <span data-ttu-id="0a05b-140">To má za následek kratší pauzy při uvolňování paměti dochází.</span><span class="sxs-lookup"><span data-stu-id="0a05b-140">This results in shorter pauses while a garbage collection is occurring.</span></span>

<span data-ttu-id="0a05b-141">Souběžné uvolňování paměti se provádí ve vyhrazeném vlákně.</span><span class="sxs-lookup"><span data-stu-id="0a05b-141">Concurrent garbage collection is performed on a dedicated thread.</span></span> <span data-ttu-id="0a05b-142">Ve výchozím nastavení clr spustí uvolňování paměti pracovní stanice s souběžným uvolňováním paměti povoleno v počítačích s jedním i více procesory.</span><span class="sxs-lookup"><span data-stu-id="0a05b-142">By default, the CLR runs workstation garbage collection with concurrent garbage collection enabled on both single-processor and multi-processor computers.</span></span>

<span data-ttu-id="0a05b-143">Následující obrázek znázorňuje souběžné uvolňování paměti prováděné v samostatném vyhrazeném vlákně.</span><span class="sxs-lookup"><span data-stu-id="0a05b-143">The following illustration shows concurrent garbage collection performed on a separate dedicated thread.</span></span>

![Souběžná vlákna uvolňování paměti](./media/gc-concurrent.png)

## <a name="see-also"></a><span data-ttu-id="0a05b-145">Viz také</span><span class="sxs-lookup"><span data-stu-id="0a05b-145">See also</span></span>

- [<span data-ttu-id="0a05b-146">Uvolňování paměti pracovní stanice a serveru</span><span class="sxs-lookup"><span data-stu-id="0a05b-146">Workstation and server garbage collection</span></span>](workstation-server-gc.md)
- [<span data-ttu-id="0a05b-147">Možnosti konfigurace za běhu pro uvolňování paměti</span><span class="sxs-lookup"><span data-stu-id="0a05b-147">Run-time configuration options for garbage collection</span></span>](../../core/run-time-config/garbage-collector.md)
