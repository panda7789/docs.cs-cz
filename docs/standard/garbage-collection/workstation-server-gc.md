---
title: Pracovní stanice vs. shromažďování paměti serveru (GC)
description: Přečtěte si o uvolňování paměti pracovních stanic a serverů v .NET.
ms.date: 04/21/2020
helpviewer_keywords:
- garbage collection, workstation
- garbage collection, server
- workstation garbage collection
- server garbage collection
ms.openlocfilehash: 640b5f42c1f841c2537284e4721e827248e3d300
ms.sourcegitcommit: ef50c99928183a0bba75e07b9f22895cd4c480f8
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/07/2020
ms.locfileid: "87917006"
---
# <a name="workstation-and-server-garbage-collection"></a><span data-ttu-id="ff60e-103">Uvolnění paměti pracovní stanice a serveru</span><span class="sxs-lookup"><span data-stu-id="ff60e-103">Workstation and server garbage collection</span></span>

<span data-ttu-id="ff60e-104">Systém uvolňování paměti je samoobslužné ladění a může fungovat v nejrůznějších scénářích.</span><span class="sxs-lookup"><span data-stu-id="ff60e-104">The garbage collector is self-tuning and can work in a wide variety of scenarios.</span></span> <span data-ttu-id="ff60e-105">V závislosti na charakteristikách úlohy však můžete [nastavit typ uvolňování paměti](../../core/run-time-config/garbage-collector.md#flavors-of-garbage-collection) .</span><span class="sxs-lookup"><span data-stu-id="ff60e-105">However, you can [set the type of garbage collection](../../core/run-time-config/garbage-collector.md#flavors-of-garbage-collection) based on the characteristics of the workload.</span></span> <span data-ttu-id="ff60e-106">CLR poskytuje následující typy uvolňování paměti:</span><span class="sxs-lookup"><span data-stu-id="ff60e-106">The CLR provides the following types of garbage collection:</span></span>

- <span data-ttu-id="ff60e-107">Uvolňování paměti pracovní stanice (GC), která je určená pro klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="ff60e-107">Workstation garbage collection (GC), which is designed for client apps.</span></span> <span data-ttu-id="ff60e-108">Jedná se o výchozí charakter GC pro samostatné aplikace.</span><span class="sxs-lookup"><span data-stu-id="ff60e-108">It's the default GC flavor for standalone apps.</span></span> <span data-ttu-id="ff60e-109">U hostovaných aplikací, například těch, které hostuje ASP.NET, hostitel určí výchozí charakter GC.</span><span class="sxs-lookup"><span data-stu-id="ff60e-109">For hosted apps, for example, those hosted by ASP.NET, the host determines the default GC flavor.</span></span>

  <span data-ttu-id="ff60e-110">Uvolňování paměti pracovní stanice může být souběžné nebo nesouběžné.</span><span class="sxs-lookup"><span data-stu-id="ff60e-110">Workstation garbage collection can be concurrent or non-concurrent.</span></span> <span data-ttu-id="ff60e-111">Souběžné uvolňování paměti (nebo *pozadí*) umožňuje spravovaným vláknům pokračovat v operacích během uvolňování paměti.</span><span class="sxs-lookup"><span data-stu-id="ff60e-111">Concurrent (or *background*) garbage collection enables managed threads to continue operations during a garbage collection.</span></span> <span data-ttu-id="ff60e-112">[Kolekce uvolnění paměti na pozadí](background-gc.md) nahrazuje [souběžné uvolňování paměti](background-gc.md#concurrent-garbage-collection) v .NET Framework 4 a novějších verzích.</span><span class="sxs-lookup"><span data-stu-id="ff60e-112">[Background garbage collection](background-gc.md) replaces [concurrent garbage collection](background-gc.md#concurrent-garbage-collection) in .NET Framework 4 and later versions.</span></span>

- <span data-ttu-id="ff60e-113">Uvolňování paměti serveru, které je určeno pro serverové aplikace, které vyžadují vysokou propustnost a škálovatelnost.</span><span class="sxs-lookup"><span data-stu-id="ff60e-113">Server garbage collection, which is intended for server applications that need high throughput and scalability.</span></span>

  - <span data-ttu-id="ff60e-114">V rozhraní .NET Core může být uvolňování paměti serveru nesouběžné nebo na pozadí.</span><span class="sxs-lookup"><span data-stu-id="ff60e-114">In .NET Core, server garbage collection can be non-concurrent or background.</span></span>

  - <span data-ttu-id="ff60e-115">V .NET Framework 4,5 a novějších verzích může být uvolňování paměti serveru nesouběžné nebo na pozadí.</span><span class="sxs-lookup"><span data-stu-id="ff60e-115">In .NET Framework 4.5 and later versions, server garbage collection can be non-concurrent or background.</span></span> <span data-ttu-id="ff60e-116">V .NET Framework 4 a předchozích verzích je uvolňování paměti serveru nesouběžné.</span><span class="sxs-lookup"><span data-stu-id="ff60e-116">In .NET Framework 4 and previous versions, server garbage collection is non-concurrent.</span></span>

<span data-ttu-id="ff60e-117">Následující ilustrace znázorňuje vyhrazená vlákna, která provádějí uvolňování paměti na serveru:</span><span class="sxs-lookup"><span data-stu-id="ff60e-117">The following illustration shows the dedicated threads that perform the garbage collection on a server:</span></span>

![Vlákna uvolňování paměti serveru](media/gc-server.png)

## <a name="performance-considerations"></a><span data-ttu-id="ff60e-119">Otázky výkonu</span><span class="sxs-lookup"><span data-stu-id="ff60e-119">Performance considerations</span></span>

### <a name="workstation-gc"></a><span data-ttu-id="ff60e-120">GC pracovní stanice</span><span class="sxs-lookup"><span data-stu-id="ff60e-120">Workstation GC</span></span>

<span data-ttu-id="ff60e-121">Následují požadavky na vlákna a výkon pro uvolňování paměti pracovních stanic:</span><span class="sxs-lookup"><span data-stu-id="ff60e-121">The following are threading and performance considerations for workstation garbage collection:</span></span>

- <span data-ttu-id="ff60e-122">Kolekce probíhá na uživatelském vlákně, které aktivovalo uvolňování paměti a zůstává ve stejné prioritě.</span><span class="sxs-lookup"><span data-stu-id="ff60e-122">The collection occurs on the user thread that triggered the garbage collection and remains at the same priority.</span></span> <span data-ttu-id="ff60e-123">Vzhledem k tomu, že se uživatelské vlákna obvykle spouští s normální prioritou, musí být systém uvolňování paměti (který běží na normální prioritní vlákně) s ostatními vlákny pro čas procesoru.</span><span class="sxs-lookup"><span data-stu-id="ff60e-123">Because user threads typically run at normal priority, the garbage collector (which runs on a normal priority thread) must compete with other threads for CPU time.</span></span> <span data-ttu-id="ff60e-124">(Vlákna, která spouštějí nativní kód, nejsou pozastavena buď na serveru, nebo v uvolnění paměti pracovní stanice.)</span><span class="sxs-lookup"><span data-stu-id="ff60e-124">(Threads that run native code are not suspended on either server or workstation garbage collection.)</span></span>

- <span data-ttu-id="ff60e-125">Uvolňování paměti pracovní stanice se vždycky používá v počítači, který má jenom jeden procesor, bez ohledu na [nastavení konfigurace](../../core/run-time-config/garbage-collector.md#workstation-vs-server).</span><span class="sxs-lookup"><span data-stu-id="ff60e-125">Workstation garbage collection is always used on a computer that has only one processor, regardless of the [configuration setting](../../core/run-time-config/garbage-collector.md#workstation-vs-server).</span></span>

### <a name="server-gc"></a><span data-ttu-id="ff60e-126">Uvolňování paměti serveru</span><span class="sxs-lookup"><span data-stu-id="ff60e-126">Server GC</span></span>

<span data-ttu-id="ff60e-127">Následují požadavky na vlákna a výkon pro uvolňování paměti serveru:</span><span class="sxs-lookup"><span data-stu-id="ff60e-127">The following are threading and performance considerations for server garbage collection:</span></span>

- <span data-ttu-id="ff60e-128">Kolekce probíhá ve více vyhrazených vláknech, které jsou spuštěny na `THREAD_PRIORITY_HIGHEST` úrovni priority.</span><span class="sxs-lookup"><span data-stu-id="ff60e-128">The collection occurs on multiple dedicated threads that are running at `THREAD_PRIORITY_HIGHEST` priority level.</span></span>

- <span data-ttu-id="ff60e-129">Halda a vyhrazené vlákno pro provádění uvolňování paměti jsou k dispozici pro každý procesor a haldy jsou shromažďovány ve stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="ff60e-129">A heap and a dedicated thread to perform garbage collection are provided for each CPU, and the heaps are collected at the same time.</span></span> <span data-ttu-id="ff60e-130">Každá halda obsahuje malou haldu objektů a velké haldy objektů a ke všem haldám je možné přistupovat pomocí uživatelského kódu.</span><span class="sxs-lookup"><span data-stu-id="ff60e-130">Each heap contains a small object heap and a large object heap, and all heaps can be accessed by user code.</span></span> <span data-ttu-id="ff60e-131">Objekty na různých haldách mohou vzájemně odkazovat.</span><span class="sxs-lookup"><span data-stu-id="ff60e-131">Objects on different heaps can refer to each other.</span></span>

- <span data-ttu-id="ff60e-132">Vzhledem k tomu, že více vláken uvolňování paměti současně spolupracuje, je uvolňování paměti serveru rychlejší než uvolnění paměti pracovní stanice ve stejné velikosti haldy.</span><span class="sxs-lookup"><span data-stu-id="ff60e-132">Because multiple garbage collection threads work together, server garbage collection is faster than workstation garbage collection on the same size heap.</span></span>

- <span data-ttu-id="ff60e-133">Uvolňování paměti serveru má často větší velikost segmentů.</span><span class="sxs-lookup"><span data-stu-id="ff60e-133">Server garbage collection often has larger size segments.</span></span> <span data-ttu-id="ff60e-134">Toto je však pouze generalizace: velikost segmentu je specifická pro konkrétní implementaci a může se změnit.</span><span class="sxs-lookup"><span data-stu-id="ff60e-134">However, this is only a generalization: segment size is implementation-specific and is subject to change.</span></span> <span data-ttu-id="ff60e-135">Při ladění aplikace nevytvářejte předpoklady o velikosti segmentů přidělených systémem uvolňování paměti.</span><span class="sxs-lookup"><span data-stu-id="ff60e-135">Don't make assumptions about the size of segments allocated by the garbage collector when tuning your app.</span></span>

- <span data-ttu-id="ff60e-136">Uvolňování paměti serveru může být náročné na prostředky.</span><span class="sxs-lookup"><span data-stu-id="ff60e-136">Server garbage collection can be resource-intensive.</span></span> <span data-ttu-id="ff60e-137">Představte si například, že v počítači, který má čtyři procesory, je spuštěno 12 procesů, které používají GC serveru.</span><span class="sxs-lookup"><span data-stu-id="ff60e-137">For example, imagine that there are 12 processes that use server GC running on a computer that has four processors.</span></span> <span data-ttu-id="ff60e-138">Pokud se u všech procesů vyskytne uvolňování paměti ve stejnou dobu, může to narušit navzájem, protože ve stejném procesoru bylo naplánováno 12 vláken.</span><span class="sxs-lookup"><span data-stu-id="ff60e-138">If all the processes happen to collect garbage at the same time, they would interfere with each other, as there would be 12 threads scheduled on the same processor.</span></span> <span data-ttu-id="ff60e-139">Pokud jsou procesy aktivní, není vhodné, abyste je používali při použití GC serveru.</span><span class="sxs-lookup"><span data-stu-id="ff60e-139">If the processes are active, it's not a good idea to have them all use server GC.</span></span>

<span data-ttu-id="ff60e-140">Pokud používáte stovky instancí aplikace, zvažte použití uvolňování paměti pracovní stanice se zakázaným souběžným uvolňováním paměti.</span><span class="sxs-lookup"><span data-stu-id="ff60e-140">If you're running hundreds of instances of an application, consider using workstation garbage collection with concurrent garbage collection disabled.</span></span> <span data-ttu-id="ff60e-141">Výsledkem bude méně přepínání kontextu, což může zlepšit výkon.</span><span class="sxs-lookup"><span data-stu-id="ff60e-141">This will result in less context switching, which can improve performance.</span></span>

## <a name="see-also"></a><span data-ttu-id="ff60e-142">Viz také</span><span class="sxs-lookup"><span data-stu-id="ff60e-142">See also</span></span>

- [<span data-ttu-id="ff60e-143">Uvolňování paměti na pozadí</span><span class="sxs-lookup"><span data-stu-id="ff60e-143">Background garbage collection</span></span>](background-gc.md)
- [<span data-ttu-id="ff60e-144">Možnosti konfigurace běhu pro uvolňování paměti</span><span class="sxs-lookup"><span data-stu-id="ff60e-144">Run-time configuration options for garbage collection</span></span>](../../core/run-time-config/garbage-collector.md)
