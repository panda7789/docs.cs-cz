---
title: Tok dat (Task Parallel Library)
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- Task Parallel Library, dataflows
- TPL dataflow library
ms.assetid: 643575d0-d26d-4c35-8de7-a9c403e97dd6
ms.openlocfilehash: 6c589e85a0bbfb3f0b5858698ffb2a294ff88cf2
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/15/2020
ms.locfileid: "73973783"
---
# <a name="dataflow-task-parallel-library"></a><span data-ttu-id="f677e-102">Tok dat (Task Parallel Library)</span><span class="sxs-lookup"><span data-stu-id="f677e-102">Dataflow (Task Parallel Library)</span></span>
<span data-ttu-id="f677e-103">Paralelní knihovna úloh (TPL) poskytuje součásti toku dat, které pomáhají zvýšit robustnost aplikací s podporou souběžnosti.</span><span class="sxs-lookup"><span data-stu-id="f677e-103">The Task Parallel Library (TPL) provides dataflow components to help increase the robustness of concurrency-enabled applications.</span></span> <span data-ttu-id="f677e-104">Tyto součásti toku dat jsou souhrnně označovány jako *Knihovna toku dat TPL*.</span><span class="sxs-lookup"><span data-stu-id="f677e-104">These dataflow components are collectively referred to as the *TPL Dataflow Library*.</span></span> <span data-ttu-id="f677e-105">Tento model toku dat podporuje programování založené na objektu actor tím, že poskytuje v procesu předávání zpráv pro hrubozrnné tok dat a pipelining úkoly.</span><span class="sxs-lookup"><span data-stu-id="f677e-105">This dataflow model promotes actor-based programming by providing in-process message passing for coarse-grained dataflow and pipelining tasks.</span></span> <span data-ttu-id="f677e-106">Součásti toku dat se staví na typech a plánování infrastruktury TPL a integrují se s podporou jazyka C#, Visual Basic a F# pro asynchronní programování.</span><span class="sxs-lookup"><span data-stu-id="f677e-106">The dataflow components build on the types and scheduling infrastructure of the TPL and integrate with the C#, Visual Basic, and F# language support for asynchronous programming.</span></span> <span data-ttu-id="f677e-107">Tyto součásti toku dat jsou užitečné, pokud máte více operací, které musí komunikovat mezi sebou asynchronně nebo pokud chcete zpracovávat data, jakmile budou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="f677e-107">These dataflow components are useful when you have multiple operations that must communicate with one another asynchronously or when you want to process data as it becomes available.</span></span> <span data-ttu-id="f677e-108">Zvažte například aplikaci, která zpracovává obrazová data z webové kamery.</span><span class="sxs-lookup"><span data-stu-id="f677e-108">For example, consider an application that processes image data from a web camera.</span></span> <span data-ttu-id="f677e-109">Pomocí modelu toku dat může aplikace zpracovat obrazové rámce tak, jak jsou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="f677e-109">By using the dataflow model, the application can process image frames as they become available.</span></span> <span data-ttu-id="f677e-110">Pokud aplikace vylepšuje obrazové rámečky, například provedením korekce světla nebo redukce červených očí, můžete vytvořit *kanál* komponent toku dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-110">If the application enhances image frames, for example, by performing light correction or red-eye reduction, you can create a *pipeline* of dataflow components.</span></span> <span data-ttu-id="f677e-111">Každá fáze kanálu může používat více hrubozrnné funkce paralelismu, jako je například funkce poskytované TPL, transformovat image.</span><span class="sxs-lookup"><span data-stu-id="f677e-111">Each stage of the pipeline might use more coarse-grained parallelism functionality, such as the functionality that is provided by the TPL, to transform the image.</span></span>  
  
 <span data-ttu-id="f677e-112">Tento dokument poskytuje přehled knihovny Toků dat TPL.</span><span class="sxs-lookup"><span data-stu-id="f677e-112">This document provides an overview of the TPL Dataflow Library.</span></span> <span data-ttu-id="f677e-113">Popisuje programovací model, předdefinované typy bloků toku dat a jak nakonfigurovat bloky toku dat tak, aby splňovaly specifické požadavky vašich aplikací.</span><span class="sxs-lookup"><span data-stu-id="f677e-113">It describes the programming model, the predefined dataflow block types, and how to configure dataflow blocks to meet the specific requirements of your applications.</span></span>  

[!INCLUDE [tpl-install-instructions](../../../includes/tpl-install-instructions.md)]

## <a name="programming-model"></a><span data-ttu-id="f677e-114">Programovací model</span><span class="sxs-lookup"><span data-stu-id="f677e-114">Programming Model</span></span>
 <span data-ttu-id="f677e-115">Knihovna Toku dat TPL poskytuje základ pro předávání zpráv a paralelizaci aplikací náročných na procesor a vstupně-výstupních aplikací, které mají vysokou propustnost a nízkou latenci.</span><span class="sxs-lookup"><span data-stu-id="f677e-115">The TPL Dataflow Library provides a foundation for message passing and parallelizing CPU-intensive and I/O-intensive applications that have high throughput and low latency.</span></span> <span data-ttu-id="f677e-116">Poskytuje také explicitní kontrolu nad tím, jak jsou data uložena do vyrovnávací paměti a pohybuje se po celém systému.</span><span class="sxs-lookup"><span data-stu-id="f677e-116">It also gives you explicit control over how data is buffered and moves around the system.</span></span> <span data-ttu-id="f677e-117">Chcete-li lépe porozumět programovacímu modelu toku dat, zvažte aplikaci, která asynchronně načte obrazy z disku a vytvoří složený z těchto bitových kopií.</span><span class="sxs-lookup"><span data-stu-id="f677e-117">To better understand the dataflow programming model, consider an application that asynchronously loads images from disk and creates a composite of those images.</span></span> <span data-ttu-id="f677e-118">Tradiční programovací modely obvykle vyžadují použití zpětná volání a synchronizační objekty, jako jsou zámky, ke koordinaci úkolů a přístup ke sdíleným datům.</span><span class="sxs-lookup"><span data-stu-id="f677e-118">Traditional programming models typically require that you use callbacks and synchronization objects, such as locks, to coordinate tasks and access to shared data.</span></span> <span data-ttu-id="f677e-119">Pomocí programovacího modelu toku dat můžete vytvořit objekty toku dat, které zpracovávají obrazy při čtení z disku.</span><span class="sxs-lookup"><span data-stu-id="f677e-119">By using the dataflow programming model, you can create dataflow objects that process images as they are read from disk.</span></span> <span data-ttu-id="f677e-120">V rámci modelu toku dat deklarujete, jak jsou data zpracována, jakmile budou k dispozici, a také všechny závislosti mezi daty.</span><span class="sxs-lookup"><span data-stu-id="f677e-120">Under the dataflow model, you declare how data is handled when it becomes available, and also any dependencies between data.</span></span> <span data-ttu-id="f677e-121">Vzhledem k tomu, že modul runtime spravuje závislosti mezi daty, můžete se často vyhnout požadavku na synchronizaci přístupu ke sdíleným datům.</span><span class="sxs-lookup"><span data-stu-id="f677e-121">Because the runtime manages dependencies between data, you can often avoid the requirement to synchronize access to shared data.</span></span> <span data-ttu-id="f677e-122">Navíc vzhledem k tomu, že plány modulu runtime fungují na základě asynchronního příchodu dat, může tok dat zlepšit odezvu a propustnost efektivní správou podkladových vláken.</span><span class="sxs-lookup"><span data-stu-id="f677e-122">In addition, because the runtime schedules work based on the asynchronous arrival of data, dataflow can improve responsiveness and throughput by efficiently managing the underlying threads.</span></span> <span data-ttu-id="f677e-123">Příklad, který používá programovací model toku dat k implementaci zpracování obrazu v aplikaci Windows Forms, naleznete v [tématu Návod: Použití toku dat v aplikaci Windows Forms](../../../docs/standard/parallel-programming/walkthrough-using-dataflow-in-a-windows-forms-application.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-123">For an example that uses the dataflow programming model to implement image processing in a Windows Forms application, see [Walkthrough: Using Dataflow in a Windows Forms Application](../../../docs/standard/parallel-programming/walkthrough-using-dataflow-in-a-windows-forms-application.md).</span></span>  
  
### <a name="sources-and-targets"></a><span data-ttu-id="f677e-124">Zdroje a cíle</span><span class="sxs-lookup"><span data-stu-id="f677e-124">Sources and Targets</span></span>  
 <span data-ttu-id="f677e-125">Knihovna toku dat TPL se skládá z *bloků toku dat*, což jsou datové struktury, které ukládají do vyrovnávací paměti a zpracovávají data.</span><span class="sxs-lookup"><span data-stu-id="f677e-125">The TPL Dataflow Library consists of *dataflow blocks*, which are data structures that buffer and process data.</span></span> <span data-ttu-id="f677e-126">TPL definuje tři druhy bloků toku dat: *zdrojové bloky*, *cílové bloky*a *bloky propagátorů*.</span><span class="sxs-lookup"><span data-stu-id="f677e-126">The TPL defines three kinds of dataflow blocks: *source blocks*, *target blocks*, and *propagator blocks*.</span></span> <span data-ttu-id="f677e-127">Zdrojový blok funguje jako zdroj dat a lze z nich číst.</span><span class="sxs-lookup"><span data-stu-id="f677e-127">A source block acts as a source of data and can be read from.</span></span> <span data-ttu-id="f677e-128">Cílový blok funguje jako příjemce dat a může být zapsán do.</span><span class="sxs-lookup"><span data-stu-id="f677e-128">A target block acts as a receiver of data and can be written to.</span></span> <span data-ttu-id="f677e-129">Blok propagátoru funguje jako zdrojový blok i cílový blok a lze jej číst a zapisovat do ní.</span><span class="sxs-lookup"><span data-stu-id="f677e-129">A propagator block acts as both a source block and a target block, and can be read from and written to.</span></span> <span data-ttu-id="f677e-130">TPL definuje <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601?displayProperty=nameWithType> rozhraní představující zdroje, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601?displayProperty=nameWithType> představují cíle <xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602?displayProperty=nameWithType> a představují množitelé.</span><span class="sxs-lookup"><span data-stu-id="f677e-130">The TPL defines the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601?displayProperty=nameWithType> interface to represent sources, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601?displayProperty=nameWithType> to represent targets, and <xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602?displayProperty=nameWithType> to represent propagators.</span></span> <span data-ttu-id="f677e-131"><xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602>dědí z <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601>obou <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>a .</span><span class="sxs-lookup"><span data-stu-id="f677e-131"><xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602> inherits from both <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601>, and <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span></span>  
  
 <span data-ttu-id="f677e-132">Knihovna toku dat TPL poskytuje několik předdefinovaných <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>typů <xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602> bloků toku dat, které implementují <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601>rozhraní , a rozhraní.</span><span class="sxs-lookup"><span data-stu-id="f677e-132">The TPL Dataflow Library provides several predefined dataflow block types that implement the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601>, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>, and <xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602> interfaces.</span></span> <span data-ttu-id="f677e-133">Tyto typy bloků toku dat jsou popsány v tomto dokumentu v části [Předdefinované typy bloků datového toku](#predefined-dataflow-block-types).</span><span class="sxs-lookup"><span data-stu-id="f677e-133">These dataflow block types are described in this document in the section [Predefined Dataflow Block Types](#predefined-dataflow-block-types).</span></span>  
  
### <a name="connecting-blocks"></a><span data-ttu-id="f677e-134">Spojovací bloky</span><span class="sxs-lookup"><span data-stu-id="f677e-134">Connecting Blocks</span></span>  
 <span data-ttu-id="f677e-135">Bloky toku dat můžete připojit k *potrubím*, což jsou lineární sekvence bloků toku dat nebo *sítí*, což jsou grafy bloků toku dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-135">You can connect dataflow blocks to form *pipelines*, which are linear sequences of dataflow blocks, or *networks*, which are graphs of dataflow blocks.</span></span> <span data-ttu-id="f677e-136">Kanál je jedna forma sítě.</span><span class="sxs-lookup"><span data-stu-id="f677e-136">A pipeline is one form of network.</span></span> <span data-ttu-id="f677e-137">V kanálu nebo v síti zdroje asynchronně mažit data na cíle, jakmile tato data k dispozici.</span><span class="sxs-lookup"><span data-stu-id="f677e-137">In a pipeline or network, sources asynchronously propagate data to targets as that data becomes available.</span></span> <span data-ttu-id="f677e-138">Metoda <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A?displayProperty=nameWithType> propojuje zdrojový blok toku dat s cílovým blokem.</span><span class="sxs-lookup"><span data-stu-id="f677e-138">The <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A?displayProperty=nameWithType> method links a source dataflow block to a target block.</span></span> <span data-ttu-id="f677e-139">Zdroj lze propojit s nulou nebo více cíli; cíle mohou být propojeny z nuly nebo z více zdrojů.</span><span class="sxs-lookup"><span data-stu-id="f677e-139">A source can be linked to zero or more targets; targets can be linked from zero or more sources.</span></span> <span data-ttu-id="f677e-140">Bloky toku dat můžete přidávat nebo odebírat do kanálu nebo sítě nebo z něj současně.</span><span class="sxs-lookup"><span data-stu-id="f677e-140">You can add or remove dataflow blocks to or from a pipeline or network concurrently.</span></span> <span data-ttu-id="f677e-141">Předdefinované typy bloků toku dat zpracovávají všechny aspekty bezpečnosti vláken propojování a odpojování.</span><span class="sxs-lookup"><span data-stu-id="f677e-141">The predefined dataflow block types handle all thread-safety aspects of linking and unlinking.</span></span>  
  
 <span data-ttu-id="f677e-142">Příklad, který spojuje bloky toku dat k vytvoření základního kanálu, najdete v [tématu Návod: Vytvoření kanálu toku dat](../../../docs/standard/parallel-programming/walkthrough-creating-a-dataflow-pipeline.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-142">For an example that connects dataflow blocks to form a basic pipeline, see [Walkthrough: Creating a Dataflow Pipeline](../../../docs/standard/parallel-programming/walkthrough-creating-a-dataflow-pipeline.md).</span></span> <span data-ttu-id="f677e-143">Příklad, který spojuje bloky toku dat a tvoří složitější síť, najdete v [tématu Návod: Použití toku dat v aplikaci Windows Forms](../../../docs/standard/parallel-programming/walkthrough-using-dataflow-in-a-windows-forms-application.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-143">For an example that connects dataflow blocks to form a more complex network, see [Walkthrough: Using Dataflow in a Windows Forms Application](../../../docs/standard/parallel-programming/walkthrough-using-dataflow-in-a-windows-forms-application.md).</span></span> <span data-ttu-id="f677e-144">Příklad, který odpojuje cíl od zdroje poté, co zdroj nabídne cílovou zprávu, najdete v tématu [Jak zrušit propojení bloků toku dat](../../../docs/standard/parallel-programming/how-to-unlink-dataflow-blocks.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-144">For an example that unlinks a target from a source after the source offers the target a message, see [How to: Unlink Dataflow Blocks](../../../docs/standard/parallel-programming/how-to-unlink-dataflow-blocks.md).</span></span>  
  
#### <a name="filtering"></a><span data-ttu-id="f677e-145">Filtrování</span><span class="sxs-lookup"><span data-stu-id="f677e-145">Filtering</span></span>  
 <span data-ttu-id="f677e-146">Při volání <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A?displayProperty=nameWithType> metody propojit zdroj s cílem, můžete zadat delegáta, který určuje, zda cílový blok přijme nebo odmítne zprávu na základě hodnoty této zprávy.</span><span class="sxs-lookup"><span data-stu-id="f677e-146">When you call the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A?displayProperty=nameWithType> method to link a source to a target, you can supply a delegate that determines whether the target block accepts or rejects a message based on the value of that message.</span></span> <span data-ttu-id="f677e-147">Tento mechanismus filtrování je užitečný způsob, jak zaručit, že blok toku dat obdrží pouze určité hodnoty.</span><span class="sxs-lookup"><span data-stu-id="f677e-147">This filtering mechanism is a useful way to guarantee that a dataflow block receives only certain values.</span></span> <span data-ttu-id="f677e-148">Pro většinu předdefinovaných typů bloků toku dat, pokud je zdrojový blok připojen k více cílovým blokům, když cílový blok odmítne zprávu, zdroj nabídne tuto zprávu dalšímu cíli.</span><span class="sxs-lookup"><span data-stu-id="f677e-148">For most of the predefined dataflow block types, if a source block is connected to multiple target blocks, when a target block rejects a message, the source offers that message to the next target.</span></span> <span data-ttu-id="f677e-149">Pořadí, ve kterém zdroj nabízí zprávy cílům, je definováno zdrojem a může se lišit podle typu zdroje.</span><span class="sxs-lookup"><span data-stu-id="f677e-149">The order in which a source offers messages to targets is defined by the source and can vary according to the type of the source.</span></span> <span data-ttu-id="f677e-150">Většina typů zdrojových bloků přestane nabízet zprávu poté, co jeden cíl tuto zprávu přijme.</span><span class="sxs-lookup"><span data-stu-id="f677e-150">Most source block types stop offering a message after one target accepts that message.</span></span> <span data-ttu-id="f677e-151">Jednou výjimkou z tohoto <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> pravidla je třída, která nabízí každou zprávu všem cílům, i když některé cíle zprávu odmítnou.</span><span class="sxs-lookup"><span data-stu-id="f677e-151">One exception to this rule is the <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> class, which offers each message to all targets, even if some targets reject the message.</span></span> <span data-ttu-id="f677e-152">Příklad, který používá filtrování ke zpracování pouze určitých zpráv, naleznete [v tématu Návod: Použití toku dat v aplikaci Windows Forms .](../../../docs/standard/parallel-programming/walkthrough-using-dataflow-in-a-windows-forms-application.md)</span><span class="sxs-lookup"><span data-stu-id="f677e-152">For an example that uses filtering to process only certain messages, see [Walkthrough: Using Dataflow in a Windows Forms Application](../../../docs/standard/parallel-programming/walkthrough-using-dataflow-in-a-windows-forms-application.md).</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="f677e-153">Vzhledem k tomu, že každý předdefinovaný typ bloku zdrojového toku dat zaručuje, že zprávy jsou šířeny v pořadí, ve kterém jsou přijímány, musí být každá zpráva přečtena ze zdrojového bloku předtím, než zdrojový blok může zpracovat další zprávu.</span><span class="sxs-lookup"><span data-stu-id="f677e-153">Because each predefined source dataflow block type guarantees that messages are propagated out in the order in which they are received, every message must be read from the source block before the source block can process the next message.</span></span> <span data-ttu-id="f677e-154">Proto při použití filtrování připojit více cílů ke zdroji, ujistěte se, že alespoň jeden cílový blok obdrží každou zprávu.</span><span class="sxs-lookup"><span data-stu-id="f677e-154">Therefore, when you use filtering to connect multiple targets to a source, make sure that at least one target block receives each message.</span></span> <span data-ttu-id="f677e-155">V opačném případě může zablokování aplikace.</span><span class="sxs-lookup"><span data-stu-id="f677e-155">Otherwise, your application might deadlock.</span></span>  
  
### <a name="message-passing"></a><span data-ttu-id="f677e-156">Předání zprávy</span><span class="sxs-lookup"><span data-stu-id="f677e-156">Message Passing</span></span>  
 <span data-ttu-id="f677e-157">Programovací model toku dat souvisí s konceptem *předávání zpráv*, kde nezávislé součásti programu vzájemně komunikují odesíláním zpráv.</span><span class="sxs-lookup"><span data-stu-id="f677e-157">The dataflow programming model is related to the concept of *message passing*, where independent components of a program communicate with one another by sending messages.</span></span> <span data-ttu-id="f677e-158">Jedním ze způsobů, jak šířit zprávy mezi <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Post%2A> součástmi aplikace, je volání <xref:System.Threading.Tasks.Dataflow.DataflowBlock.SendAsync%2A?displayProperty=nameWithType> a<xref:System.Threading.Tasks.Dataflow.DataflowBlock.Post%2A> metody pro odesílání zpráv do cílových bloků toku dat post ( funguje synchronně; <xref:System.Threading.Tasks.Dataflow.DataflowBlock.SendAsync%2A> asynchronně) a <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Receive%2A>, <xref:System.Threading.Tasks.Dataflow.DataflowBlock.ReceiveAsync%2A>a <xref:System.Threading.Tasks.Dataflow.DataflowBlock.TryReceive%2A> metody pro příjem zpráv ze zdrojových bloků.</span><span class="sxs-lookup"><span data-stu-id="f677e-158">One way to propagate messages among application components is to call the <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Post%2A> and <xref:System.Threading.Tasks.Dataflow.DataflowBlock.SendAsync%2A?displayProperty=nameWithType> methods to send messages to target dataflow blocks post (<xref:System.Threading.Tasks.Dataflow.DataflowBlock.Post%2A> acts synchronously; <xref:System.Threading.Tasks.Dataflow.DataflowBlock.SendAsync%2A> acts asynchronously) and the <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Receive%2A>, <xref:System.Threading.Tasks.Dataflow.DataflowBlock.ReceiveAsync%2A>, and <xref:System.Threading.Tasks.Dataflow.DataflowBlock.TryReceive%2A> methods to receive messages from source blocks.</span></span> <span data-ttu-id="f677e-159">Tyto metody můžete kombinovat s kanály toku dat nebo sítě odesláním vstupních dat do hlavního uzlu (cílový blok) a příjem výstupních dat z terminálového uzlu kanálu nebo terminálových uzlů sítě (jeden nebo více zdrojových bloků).</span><span class="sxs-lookup"><span data-stu-id="f677e-159">You can combine these methods with dataflow pipelines or networks by sending input data to the head node (a target block), and receiving output data from the terminal node of the pipeline or the terminal nodes of the network (one or more source blocks).</span></span> <span data-ttu-id="f677e-160">Metodu <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Choose%2A> můžete také použít ke čtení z prvního z poskytnutých zdrojů, který má k dispozici data a provést akci na tato data.</span><span class="sxs-lookup"><span data-stu-id="f677e-160">You can also use the <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Choose%2A> method to read from the first of the provided sources that has data available and perform action on that data.</span></span>  
  
 <span data-ttu-id="f677e-161">Zdrojové bloky nabízejí data cílovým blokům voláním <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="f677e-161">Source blocks offer data to target blocks by calling the <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="f677e-162">Cílový blok reaguje na nabízenou zprávu jedním ze tří způsobů: může zprávu přijmout, zprávu odmítnout nebo zprávu odložit.</span><span class="sxs-lookup"><span data-stu-id="f677e-162">The target block responds to an offered message in one of three ways: it can accept the message, decline the message, or postpone the message.</span></span> <span data-ttu-id="f677e-163">Když cíl přijme zprávu, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> metoda <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Accepted>vrátí .</span><span class="sxs-lookup"><span data-stu-id="f677e-163">When the target accepts the message, the <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> method returns <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Accepted>.</span></span> <span data-ttu-id="f677e-164">Když cíl odmítne zprávu, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> metoda <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Declined>vrátí .</span><span class="sxs-lookup"><span data-stu-id="f677e-164">When the target declines the message, the <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> method returns <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Declined>.</span></span> <span data-ttu-id="f677e-165">Pokud cíl vyžaduje, aby již nepřijímá žádné <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> zprávy <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.DecliningPermanently>ze zdroje, vrátí .</span><span class="sxs-lookup"><span data-stu-id="f677e-165">When the target requires that it no longer receives any messages from the source, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> returns <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.DecliningPermanently>.</span></span> <span data-ttu-id="f677e-166">Předdefinované typy zdrojových bloků nenabízejí zprávy propojeným cílům po přijetí takové vrácené hodnoty a automaticky se od těchto cílů odpojí.</span><span class="sxs-lookup"><span data-stu-id="f677e-166">The predefined source block types do not offer messages to linked targets after such a return value is received, and they automatically unlink from such targets.</span></span>  
  
 <span data-ttu-id="f677e-167">Když cílový blok odloží zprávu pro <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> pozdější <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Postponed>použití, metoda vrátí .</span><span class="sxs-lookup"><span data-stu-id="f677e-167">When a target block postpones the message for later use, the <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> method returns <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Postponed>.</span></span> <span data-ttu-id="f677e-168">Cílový blok, který odkládá zprávu <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ReserveMessage%2A?displayProperty=nameWithType> může později volat metodu a pokusit se rezervovat nabízené zprávy.</span><span class="sxs-lookup"><span data-stu-id="f677e-168">A target block that postpones a message can later call the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ReserveMessage%2A?displayProperty=nameWithType> method to try to reserve the offered message.</span></span> <span data-ttu-id="f677e-169">V tomto okamžiku je zpráva stále k dispozici a může být použita cílovým blokem nebo byla přijata jiným cílem.</span><span class="sxs-lookup"><span data-stu-id="f677e-169">At this point, the message is either still available and can be used by the target block, or the message has been taken by another target.</span></span> <span data-ttu-id="f677e-170">Pokud cílový blok později vyžaduje zprávu nebo již nepotřebuje <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ConsumeMessage%2A?displayProperty=nameWithType> <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ReleaseReservation%2A> zprávu, volá metodu nebo, resp.</span><span class="sxs-lookup"><span data-stu-id="f677e-170">When the target block later requires the message or no longer needs the message, it calls the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ConsumeMessage%2A?displayProperty=nameWithType> or <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ReleaseReservation%2A> method, respectively.</span></span> <span data-ttu-id="f677e-171">Rezervace zpráv se obvykle používá typy bloků toku dat, které pracují v nechamtivém režimu.</span><span class="sxs-lookup"><span data-stu-id="f677e-171">Message reservation is typically used by the dataflow block types that operate in non-greedy mode.</span></span> <span data-ttu-id="f677e-172">Nechamtivý režim je vysvětlen dále v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="f677e-172">Non-greedy mode is explained later in this document.</span></span> <span data-ttu-id="f677e-173">Místo vyhrazení odložené zprávy, cílový blok můžete <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ConsumeMessage%2A?displayProperty=nameWithType> také použít metodu k pokusu přímo využívat odložené zprávy.</span><span class="sxs-lookup"><span data-stu-id="f677e-173">Instead of reserving a postponed message, a target block can also use the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ConsumeMessage%2A?displayProperty=nameWithType> method to attempt to directly consume the postponed message.</span></span>  
  
### <a name="dataflow-block-completion"></a><span data-ttu-id="f677e-174">Dokončení bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="f677e-174">Dataflow Block Completion</span></span>  
 <span data-ttu-id="f677e-175">Bloky toku dat také podporují koncepci *dokončení*.</span><span class="sxs-lookup"><span data-stu-id="f677e-175">Dataflow blocks also support the concept of *completion*.</span></span> <span data-ttu-id="f677e-176">Blok toku dat, který je v dokončeném stavu neprovede žádnou další práci.</span><span class="sxs-lookup"><span data-stu-id="f677e-176">A dataflow block that is in the completed state does not perform any further work.</span></span> <span data-ttu-id="f677e-177">Každý blok toku <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> dat má přidružený objekt, označovaný jako *úkol dokončení*, který představuje stav dokončení bloku.</span><span class="sxs-lookup"><span data-stu-id="f677e-177">Each dataflow block has an associated <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> object, known as a *completion task*, that represents the completion status of the block.</span></span> <span data-ttu-id="f677e-178">Vzhledem k tomu, že můžete čekat na dokončení objektu <xref:System.Threading.Tasks.Task> pomocí úloh dokončení, můžete počkat na dokončení jednoho nebo více terminálových uzlů sítě toku dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-178">Because you can wait for a <xref:System.Threading.Tasks.Task> object to finish, by using completion tasks, you can wait for one or more terminal nodes of a dataflow network to finish.</span></span> <span data-ttu-id="f677e-179">Rozhraní <xref:System.Threading.Tasks.Dataflow.IDataflowBlock> definuje metodu, <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A> která informuje blok toku dat o dokončení požadavku <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> a vlastnost, která vrátí úkol dokončení pro blok toku dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-179">The <xref:System.Threading.Tasks.Dataflow.IDataflowBlock> interface defines the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A> method, which informs the dataflow block of a request for it to complete, and the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> property, which returns the completion task for the dataflow block.</span></span> <span data-ttu-id="f677e-180">Oba <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601> <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> a <xref:System.Threading.Tasks.Dataflow.IDataflowBlock> zdědit rozhraní.</span><span class="sxs-lookup"><span data-stu-id="f677e-180">Both <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601> and <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> inherit the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock> interface.</span></span>  
  
 <span data-ttu-id="f677e-181">Existují dva způsoby, jak zjistit, zda blok toku dat dokončena bez chyby, došlo k jedné nebo více chyb nebo byla zrušena.</span><span class="sxs-lookup"><span data-stu-id="f677e-181">There are two ways to determine whether a dataflow block completed without error, encountered one or more errors, or was canceled.</span></span> <span data-ttu-id="f677e-182">Prvním způsobem je volání <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> metody na dokončení `try` - `catch` úkolu`Try` - `Catch` v bloku (v jazyce Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="f677e-182">The first way is to call the <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> method on the completion task in a `try`-`catch` block (`Try`-`Catch` in Visual Basic).</span></span> <span data-ttu-id="f677e-183">Následující příklad vytvoří <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> objekt, <xref:System.ArgumentOutOfRangeException> který vyvolá, pokud jeho vstupní hodnota je menší než nula.</span><span class="sxs-lookup"><span data-stu-id="f677e-183">The following example creates an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object that throws <xref:System.ArgumentOutOfRangeException> if its input value is less than zero.</span></span> <span data-ttu-id="f677e-184"><xref:System.AggregateException>je vyvolána, když <xref:System.Threading.Tasks.Task.Wait%2A> tento příklad volá na dokončení úkolu.</span><span class="sxs-lookup"><span data-stu-id="f677e-184"><xref:System.AggregateException> is thrown when this example calls <xref:System.Threading.Tasks.Task.Wait%2A> on the completion task.</span></span> <span data-ttu-id="f677e-185">Je <xref:System.ArgumentOutOfRangeException> přístupný prostřednictvím <xref:System.AggregateException.InnerExceptions%2A> vlastnosti <xref:System.AggregateException> objektu.</span><span class="sxs-lookup"><span data-stu-id="f677e-185">The <xref:System.ArgumentOutOfRangeException> is accessed through the <xref:System.AggregateException.InnerExceptions%2A> property of the <xref:System.AggregateException> object.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#10](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#10)]
 [!code-vb[TPLDataflow_Overview#10](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#10)]  
  
 <span data-ttu-id="f677e-186">Tento příklad ukazuje případ, ve kterém výjimka přejde neošetřené v delegáta bloku toku dat spuštění.</span><span class="sxs-lookup"><span data-stu-id="f677e-186">This example demonstrates the case in which an exception goes unhandled in the delegate of an execution dataflow block.</span></span> <span data-ttu-id="f677e-187">Doporučujeme, abyste zpracovat výjimky v tělech těchto bloků.</span><span class="sxs-lookup"><span data-stu-id="f677e-187">We recommend that you handle exceptions in the bodies of such blocks.</span></span> <span data-ttu-id="f677e-188">Pokud se vám to však nedaří, blok se chová, jako by byl zrušen, a nezpracovává příchozí zprávy.</span><span class="sxs-lookup"><span data-stu-id="f677e-188">However, if you are unable to do so, the block behaves as though it was canceled and does not process incoming messages.</span></span>  
  
 <span data-ttu-id="f677e-189">Při explicitně zrušit blok toku <xref:System.AggregateException> dat, objekt obsahuje <xref:System.OperationCanceledException> ve vlastnosti. <xref:System.AggregateException.InnerExceptions%2A></span><span class="sxs-lookup"><span data-stu-id="f677e-189">When a dataflow block is canceled explicitly, the <xref:System.AggregateException> object contains <xref:System.OperationCanceledException> in the <xref:System.AggregateException.InnerExceptions%2A> property.</span></span> <span data-ttu-id="f677e-190">Další informace o zrušení toku dat naleznete v části [Povolení zrušení.](#enabling-cancellation)</span><span class="sxs-lookup"><span data-stu-id="f677e-190">For more information about dataflow cancellation, see [Enabling Cancellation](#enabling-cancellation) section.</span></span>  
  
 <span data-ttu-id="f677e-191">Druhým způsobem, jak určit stav dokončení bloku toku dat, je použít pokračování úlohy dokončení nebo použít funkce asynchronního jazyka c# a visual basic asynchronně čekat na dokončení úlohy.</span><span class="sxs-lookup"><span data-stu-id="f677e-191">The second way to determine the completion status of a dataflow block is to use a continuation of the completion task, or to use the asynchronous language features of C# and Visual Basic to asynchronously wait for the completion task.</span></span> <span data-ttu-id="f677e-192">Delegát, který zadáte <xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=nameWithType> metodě <xref:System.Threading.Tasks.Task> trvá objekt, který představuje předchozí úkol.</span><span class="sxs-lookup"><span data-stu-id="f677e-192">The delegate that you provide to the <xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=nameWithType> method takes a <xref:System.Threading.Tasks.Task> object that represents the antecedent task.</span></span> <span data-ttu-id="f677e-193">V případě vlastnosti <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> delegát pro pokračování přebírá dokončení úkolu sám.</span><span class="sxs-lookup"><span data-stu-id="f677e-193">In the case of the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> property, the delegate for the continuation takes the completion task itself.</span></span> <span data-ttu-id="f677e-194">Následující příklad se podobá předchozí, s tím <xref:System.Threading.Tasks.Task.ContinueWith%2A> rozdílem, že také používá metodu k vytvoření úlohy pokračování, která vytiskne stav celkové operace toku dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-194">The following example resembles the previous one, except that it also uses the <xref:System.Threading.Tasks.Task.ContinueWith%2A> method to create a continuation task that prints the status of the overall dataflow operation.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#11](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#11)]
 [!code-vb[TPLDataflow_Overview#11](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#11)]  
  
 <span data-ttu-id="f677e-195">Můžete také použít vlastnosti, například <xref:System.Threading.Tasks.Task.IsCanceled%2A> v těle úlohy pokračování k určení další informace o stavu dokončení bloku toku dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-195">You can also use properties such as <xref:System.Threading.Tasks.Task.IsCanceled%2A> in the body of the continuation task to determine additional information about the completion status of a dataflow block.</span></span> <span data-ttu-id="f677e-196">Další informace o úkolech pokračování a jejich vztahu ke zrušení a zpracování chyb naleznete [v tématu Řetězení úkolů pomocí úloh pokračování](../../../docs/standard/parallel-programming/chaining-tasks-by-using-continuation-tasks.md), Zrušení [úloh](../../../docs/standard/parallel-programming/task-cancellation.md)a [Zpracování výjimek](../../../docs/standard/parallel-programming/exception-handling-task-parallel-library.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-196">For more information about continuation tasks and how they relate to cancellation and error handling, see [Chaining Tasks by Using Continuation Tasks](../../../docs/standard/parallel-programming/chaining-tasks-by-using-continuation-tasks.md), [Task Cancellation](../../../docs/standard/parallel-programming/task-cancellation.md), and [Exception Handling](../../../docs/standard/parallel-programming/exception-handling-task-parallel-library.md).</span></span>  

## <a name="predefined-dataflow-block-types"></a><span data-ttu-id="f677e-197">Předdefinované typy bloků toku dat</span><span class="sxs-lookup"><span data-stu-id="f677e-197">Predefined Dataflow Block Types</span></span>  
 <span data-ttu-id="f677e-198">Knihovna toku dat TPL poskytuje několik předdefinovaných typů bloků toku dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-198">The TPL Dataflow Library provides several predefined dataflow block types.</span></span> <span data-ttu-id="f677e-199">Tyto typy jsou rozděleny do tří kategorií: *ukládání bloků do vyrovnávací paměti*, bloky *spuštění*a *bloky seskupení*.</span><span class="sxs-lookup"><span data-stu-id="f677e-199">These types are divided into three categories: *buffering blocks*, *execution blocks*, and *grouping blocks*.</span></span> <span data-ttu-id="f677e-200">Následující části popisují typy bloků, které tvoří tyto kategorie.</span><span class="sxs-lookup"><span data-stu-id="f677e-200">The following sections describe the block types that make up these categories.</span></span>  
  
### <a name="buffering-blocks"></a><span data-ttu-id="f677e-201">Ukládání bloků do vyrovnávací paměti</span><span class="sxs-lookup"><span data-stu-id="f677e-201">Buffering Blocks</span></span>  
 <span data-ttu-id="f677e-202">Ukládání bloků do vyrovnávací paměti uchovává data pro spotřebitele dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-202">Buffering blocks hold data for use by data consumers.</span></span> <span data-ttu-id="f677e-203">Knihovna toku dat TPL poskytuje <xref:System.Threading.Tasks.Dataflow.BufferBlock%601?displayProperty=nameWithType>tři <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601?displayProperty=nameWithType>typy <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601?displayProperty=nameWithType>bloků vyrovnávací paměti: , , a .</span><span class="sxs-lookup"><span data-stu-id="f677e-203">The TPL Dataflow Library provides three buffering block types: <xref:System.Threading.Tasks.Dataflow.BufferBlock%601?displayProperty=nameWithType>, <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601?displayProperty=nameWithType>, and <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601?displayProperty=nameWithType>.</span></span>  
  
#### <a name="bufferblockt"></a><span data-ttu-id="f677e-204">Nárazníkový blok(T)</span><span class="sxs-lookup"><span data-stu-id="f677e-204">BufferBlock(T)</span></span>  
 <span data-ttu-id="f677e-205">Třída <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> představuje obecnou strukturu asynchronního zasílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="f677e-205">The <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> class represents a general-purpose asynchronous messaging structure.</span></span> <span data-ttu-id="f677e-206">Tato třída ukládá první in, first out (FIFO) fronty zpráv, které mohou být zapsány do více zdrojů nebo číst z více cílů.</span><span class="sxs-lookup"><span data-stu-id="f677e-206">This class stores a first in, first out (FIFO) queue of messages that can be written to by multiple sources or read from by multiple targets.</span></span> <span data-ttu-id="f677e-207">Když cíl obdrží zprávu z <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> objektu, tato zpráva je odebrána z fronty zpráv.</span><span class="sxs-lookup"><span data-stu-id="f677e-207">When a target receives a message from a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> object, that message is removed from the message queue.</span></span> <span data-ttu-id="f677e-208">Proto i <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> když objekt může mít více cílů, pouze jeden cíl obdrží každou zprávu.</span><span class="sxs-lookup"><span data-stu-id="f677e-208">Therefore, although a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> object can have multiple targets, only one target will receive each message.</span></span> <span data-ttu-id="f677e-209">Třída <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> je užitečná, pokud chcete předat více zpráv jiné součásti a tato součást musí přijímat každou zprávu.</span><span class="sxs-lookup"><span data-stu-id="f677e-209">The <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> class is useful when you want to pass multiple messages to another component, and that component must receive each message.</span></span>  
  
 <span data-ttu-id="f677e-210">Následující základní příklad <xref:System.Int32> odešle <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> několik hodnot do objektu a potom přečte tyto hodnoty zpět z tohoto objektu.</span><span class="sxs-lookup"><span data-stu-id="f677e-210">The following basic example posts several <xref:System.Int32> values to a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> object and then reads those values back from that object.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#1](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#1)]
 [!code-vb[TPLDataflow_Overview#1](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#1)]  
  
 <span data-ttu-id="f677e-211">Úplný příklad, který ukazuje, jak psát zprávy a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> číst zprávy z objektu, naleznete v tématu [How to: Write Messages to and Read Messages from a Dataflow Block](../../../docs/standard/parallel-programming/how-to-write-messages-to-and-read-messages-from-a-dataflow-block.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-211">For a complete example that demonstrates how to write messages to and read messages from a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> object, see [How to: Write Messages to and Read Messages from a Dataflow Block](../../../docs/standard/parallel-programming/how-to-write-messages-to-and-read-messages-from-a-dataflow-block.md).</span></span>  
  
#### <a name="broadcastblockt"></a><span data-ttu-id="f677e-212">Vysílací blok(T)</span><span class="sxs-lookup"><span data-stu-id="f677e-212">BroadcastBlock(T)</span></span>  
 <span data-ttu-id="f677e-213">Třída <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> je užitečná, pokud je nutné předat více zpráv jiné součásti, ale tato součást potřebuje pouze nejnovější hodnotu.</span><span class="sxs-lookup"><span data-stu-id="f677e-213">The <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> class is useful when you must pass multiple messages to another component, but that component needs only the most recent value.</span></span> <span data-ttu-id="f677e-214">Tato třída je také užitečná, pokud chcete vysílat zprávu více součástem.</span><span class="sxs-lookup"><span data-stu-id="f677e-214">This class is also useful when you want to broadcast a message to multiple components.</span></span>  
  
 <span data-ttu-id="f677e-215">Následující základní příklad <xref:System.Double> zaúčtuje <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> hodnotu objektu a potom tuto hodnotu několikrát přečte zpět z tohoto objektu.</span><span class="sxs-lookup"><span data-stu-id="f677e-215">The following basic example posts a <xref:System.Double> value to a <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> object and then reads that value back from that object several times.</span></span> <span data-ttu-id="f677e-216">Vzhledem k tomu, že hodnoty nejsou odebrány z <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> objektů po jejich čtení, je vždy k dispozici stejná hodnota.</span><span class="sxs-lookup"><span data-stu-id="f677e-216">Because values are not removed from <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> objects after they are read, the same value is available every time.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#2](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#2)]
 [!code-vb[TPLDataflow_Overview#2](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#2)]  
  
 <span data-ttu-id="f677e-217">Úplný příklad, který ukazuje, <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> jak použít k vysílání zprávy do více cílových bloků, najdete v [tématu Postup: Zadání plánovače úloh v bloku toku dat](../../../docs/standard/parallel-programming/how-to-specify-a-task-scheduler-in-a-dataflow-block.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-217">For a complete example that demonstrates how to use <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> to broadcast a message to multiple target blocks, see [How to: Specify a Task Scheduler in a Dataflow Block](../../../docs/standard/parallel-programming/how-to-specify-a-task-scheduler-in-a-dataflow-block.md).</span></span>  
  
#### <a name="writeonceblockt"></a><span data-ttu-id="f677e-218">WriteOnceBlock(T)</span><span class="sxs-lookup"><span data-stu-id="f677e-218">WriteOnceBlock(T)</span></span>  
 <span data-ttu-id="f677e-219">Třída <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> se podobá <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> třídě, s <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> tím rozdílem, že objekt lze zapsat pouze jednou.</span><span class="sxs-lookup"><span data-stu-id="f677e-219">The <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> class resembles the <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> class, except that a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object can be written to one time only.</span></span> <span data-ttu-id="f677e-220">Můžete si <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> představit, že je podobný c# [jen pro čtení](../../csharp/language-reference/keywords/readonly.md) [(ReadOnly](../../visual-basic/language-reference/modifiers/readonly.md) v jazyce Visual Basic) klíčové slovo, s tím rozdílem, <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> že objekt stane neměnné poté, co obdrží hodnotu namísto na konstrukci.</span><span class="sxs-lookup"><span data-stu-id="f677e-220">You can think of <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> as being similar to the C# [readonly](../../csharp/language-reference/keywords/readonly.md) ([ReadOnly](../../visual-basic/language-reference/modifiers/readonly.md) in Visual Basic) keyword, except that a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object becomes immutable after it receives a value instead of at construction.</span></span> <span data-ttu-id="f677e-221">Stejně <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> jako třída, když cíl obdrží <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> zprávu z objektu, tato zpráva není odebrána z tohoto objektu.</span><span class="sxs-lookup"><span data-stu-id="f677e-221">Like the <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> class, when a target receives a message from a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object, that message is not removed from that object.</span></span> <span data-ttu-id="f677e-222">Proto více cílů obdrží kopii zprávy.</span><span class="sxs-lookup"><span data-stu-id="f677e-222">Therefore, multiple targets receive a copy of the message.</span></span> <span data-ttu-id="f677e-223">Třída <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> je užitečná, pokud chcete šířit pouze první z více zpráv.</span><span class="sxs-lookup"><span data-stu-id="f677e-223">The <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> class is useful when you want to propagate only the first of multiple messages.</span></span>  
  
 <span data-ttu-id="f677e-224">Následující základní příklad <xref:System.String> odešle <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> do objektu více hodnot a potom přečte hodnotu zpět z tohoto objektu.</span><span class="sxs-lookup"><span data-stu-id="f677e-224">The following basic example posts multiple <xref:System.String> values to a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object and then reads the value back from that object.</span></span> <span data-ttu-id="f677e-225">Vzhledem <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> k tomu, že objekt lze <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> zapsat pouze jednou, poté, co objekt obdrží zprávu, zahodí následné zprávy.</span><span class="sxs-lookup"><span data-stu-id="f677e-225">Because a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object can be written to one time only, after a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object receives a message, it discards subsequent messages.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#3](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#3)]
 [!code-vb[TPLDataflow_Overview#3](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#3)]  
  
 <span data-ttu-id="f677e-226">Úplný příklad, který ukazuje, <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> jak použít k získání hodnoty první operace, která skončí, naleznete v [tématu How to: Unlink Dataflow Blocks](../../../docs/standard/parallel-programming/how-to-unlink-dataflow-blocks.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-226">For a complete example that demonstrates how to use <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> to receive the value of the first operation that finishes, see [How to: Unlink Dataflow Blocks](../../../docs/standard/parallel-programming/how-to-unlink-dataflow-blocks.md).</span></span>  
  
### <a name="execution-blocks"></a><span data-ttu-id="f677e-227">Bloky spuštění</span><span class="sxs-lookup"><span data-stu-id="f677e-227">Execution Blocks</span></span>  
 <span data-ttu-id="f677e-228">Bloky spuštění volání uživatelem zapředpokladu delegáta pro každou část přijatých dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-228">Execution blocks call a user-provided delegate for each piece of received data.</span></span> <span data-ttu-id="f677e-229">Knihovna toku dat TPL poskytuje <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> <xref:System.Threading.Tasks.Dataflow.TransformBlock%602?displayProperty=nameWithType>tři <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602?displayProperty=nameWithType>typy bloků spuštění: , a .</span><span class="sxs-lookup"><span data-stu-id="f677e-229">The TPL Dataflow Library provides three execution block types: <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602?displayProperty=nameWithType>, and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602?displayProperty=nameWithType>.</span></span>  
  
#### <a name="actionblockt"></a><span data-ttu-id="f677e-230">ActionBlock(T)</span><span class="sxs-lookup"><span data-stu-id="f677e-230">ActionBlock(T)</span></span>  
 <span data-ttu-id="f677e-231">Třída <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> je cílový blok, který volá delegáta, když přijímá data.</span><span class="sxs-lookup"><span data-stu-id="f677e-231">The <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> class is a target block that calls a delegate when it receives data.</span></span> <span data-ttu-id="f677e-232">Představte <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> si objekt jako delegáta, který běží asynchronně, když jsou k dispozici data.</span><span class="sxs-lookup"><span data-stu-id="f677e-232">Think of a <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object as a delegate that runs asynchronously when data becomes available.</span></span> <span data-ttu-id="f677e-233">Delegát, který zadáte <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> objektu může <xref:System.Action%601> být `System.Func<TInput, Task>`typu nebo typu .</span><span class="sxs-lookup"><span data-stu-id="f677e-233">The delegate that you provide to an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object can be of type <xref:System.Action%601> or type `System.Func<TInput, Task>`.</span></span> <span data-ttu-id="f677e-234">Při použití <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> objektu <xref:System.Action%601>s , zpracování každého vstupního prvku je považováno za dokončené při delegáta vrátí.</span><span class="sxs-lookup"><span data-stu-id="f677e-234">When you use an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object with <xref:System.Action%601>, processing of each input element is considered completed when the delegate returns.</span></span> <span data-ttu-id="f677e-235">Při použití <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> objektu `System.Func<TInput, Task>`s , zpracování každého vstupního prvku <xref:System.Threading.Tasks.Task> je považováno za dokončené pouze po dokončení vráceného objektu.</span><span class="sxs-lookup"><span data-stu-id="f677e-235">When you use an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object with `System.Func<TInput, Task>`, processing of each input element is considered completed only when the returned <xref:System.Threading.Tasks.Task> object is completed.</span></span> <span data-ttu-id="f677e-236">Pomocí těchto dvou mechanismů můžete <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> použít pro synchronní i asynchronní zpracování každého vstupního prvku.</span><span class="sxs-lookup"><span data-stu-id="f677e-236">By using these two mechanisms, you can use <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> for both synchronous and asynchronous processing of each input element.</span></span>  
  
 <span data-ttu-id="f677e-237">Následující základní příklad <xref:System.Int32> odešle <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> do objektu více hodnot.</span><span class="sxs-lookup"><span data-stu-id="f677e-237">The following basic example posts multiple <xref:System.Int32> values to an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object.</span></span> <span data-ttu-id="f677e-238">Objekt <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> vytiskne tyto hodnoty do konzoly.</span><span class="sxs-lookup"><span data-stu-id="f677e-238">The <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object prints those values to the console.</span></span> <span data-ttu-id="f677e-239">Tento příklad pak nastaví blok do dokončeného stavu a čeká na dokončení všech úloh toku dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-239">This example then sets the block to the completed state and waits for all dataflow tasks to finish.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#4](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#4)]
 [!code-vb[TPLDataflow_Overview#4](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#4)]  
  
 <span data-ttu-id="f677e-240">Úplné příklady, které ukazují, jak <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> používat delegáty s třídou, najdete v [tématu Jak: Provést akci při přijetí bloku toku dat přijímá data](../../../docs/standard/parallel-programming/how-to-perform-action-when-a-dataflow-block-receives-data.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-240">For complete examples that demonstrate how to use delegates with the <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> class, see [How to: Perform Action When a Dataflow Block Receives Data](../../../docs/standard/parallel-programming/how-to-perform-action-when-a-dataflow-block-receives-data.md).</span></span>  
  
#### <a name="transformblocktinput-toutput"></a><span data-ttu-id="f677e-241">TransformBlock(TInput, TOutput)</span><span class="sxs-lookup"><span data-stu-id="f677e-241">TransformBlock(TInput, TOutput)</span></span>  
 <span data-ttu-id="f677e-242">Třída <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> se podobá <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> třídy, s tím rozdílem, že funguje jako zdroj a jako cíl.</span><span class="sxs-lookup"><span data-stu-id="f677e-242">The <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> class resembles the <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> class, except that it acts as both a source and as a target.</span></span> <span data-ttu-id="f677e-243">Delegát, který předáte <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> objektu, vrátí `TOutput`hodnotu typu .</span><span class="sxs-lookup"><span data-stu-id="f677e-243">The delegate that you pass to a <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object returns a value of type `TOutput`.</span></span> <span data-ttu-id="f677e-244">Delegát, který zadáte <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> objektu může `System.Func<TInput, TOutput>` být `System.Func<TInput, Task<TOutput>>`typu nebo typu .</span><span class="sxs-lookup"><span data-stu-id="f677e-244">The delegate that you provide to a <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object can be of type `System.Func<TInput, TOutput>` or type `System.Func<TInput, Task<TOutput>>`.</span></span> <span data-ttu-id="f677e-245">Při použití <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> objektu `System.Func<TInput, TOutput>`s , zpracování každého vstupního prvku je považováno za dokončené při delegáta vrátí.</span><span class="sxs-lookup"><span data-stu-id="f677e-245">When you use a <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object with `System.Func<TInput, TOutput>`, processing of each input element is considered completed when the delegate returns.</span></span> <span data-ttu-id="f677e-246">Při použití <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> objektu `System.Func<TInput, Task<TOutput>>`použitého s , zpracování každého vstupního <xref:System.Threading.Tasks.Task%601> prvku je považováno za dokončené pouze po dokončení vráceného objektu.</span><span class="sxs-lookup"><span data-stu-id="f677e-246">When you use a <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object used with `System.Func<TInput, Task<TOutput>>`, processing of each input element is considered completed only when the returned <xref:System.Threading.Tasks.Task%601> object is completed.</span></span> <span data-ttu-id="f677e-247">Stejně <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>jako u , pomocí těchto <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> dvou mechanismů, můžete použít pro synchronní i asynchronní zpracování každého vstupního prvku.</span><span class="sxs-lookup"><span data-stu-id="f677e-247">As with <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, by using these two mechanisms, you can use <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> for both synchronous and asynchronous processing of each input element.</span></span>  
  
 <span data-ttu-id="f677e-248">Následující základní příklad <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> vytvoří objekt, který vypočítá druhou odmocninu jeho vstupu.</span><span class="sxs-lookup"><span data-stu-id="f677e-248">The following basic example creates a <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object that computes the square root of its input.</span></span> <span data-ttu-id="f677e-249">Objekt <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> přebírá <xref:System.Int32> hodnoty jako vstup <xref:System.Double> a vytváří hodnoty jako výstup.</span><span class="sxs-lookup"><span data-stu-id="f677e-249">The <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object takes <xref:System.Int32> values as input and produces <xref:System.Double> values as output.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#5](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#5)]
 [!code-vb[TPLDataflow_Overview#5](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#5)]  
  
 <span data-ttu-id="f677e-250">Úplné příklady, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> které se používají v síti bloků toku dat, která provádí zpracování obrazu v aplikaci Windows Forms, naleznete [v tématu Návod: Použití toku dat v aplikaci Windows Forms](../../../docs/standard/parallel-programming/walkthrough-using-dataflow-in-a-windows-forms-application.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-250">For complete examples that uses <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> in a network of dataflow blocks that performs image processing in a Windows Forms application, see [Walkthrough: Using Dataflow in a Windows Forms Application](../../../docs/standard/parallel-programming/walkthrough-using-dataflow-in-a-windows-forms-application.md).</span></span>  
  
#### <a name="transformmanyblocktinput-toutput"></a><span data-ttu-id="f677e-251">TransformManyBlock(TInput, TOutput)</span><span class="sxs-lookup"><span data-stu-id="f677e-251">TransformManyBlock(TInput, TOutput)</span></span>  
 <span data-ttu-id="f677e-252">Třída <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> se podobá <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> třídě, <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> s tím rozdílem, že produkuje nula nebo více výstupních hodnot pro každou vstupní hodnotu, namísto pouze jednu výstupní hodnotu pro každou vstupní hodnotu.</span><span class="sxs-lookup"><span data-stu-id="f677e-252">The <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> class resembles the <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> class, except that <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> produces zero or more output values for each input value, instead of only one output value for each input value.</span></span> <span data-ttu-id="f677e-253">Delegát, který zadáte <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> objektu může `System.Func<TInput, IEnumerable<TOutput>>` být `System.Func<TInput, Task<IEnumerable<TOutput>>>`typu nebo typu .</span><span class="sxs-lookup"><span data-stu-id="f677e-253">The delegate that you provide to a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object can be of type `System.Func<TInput, IEnumerable<TOutput>>` or type `System.Func<TInput, Task<IEnumerable<TOutput>>>`.</span></span> <span data-ttu-id="f677e-254">Při použití <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> objektu `System.Func<TInput, IEnumerable<TOutput>>`s , zpracování každého vstupního prvku je považováno za dokončené při delegáta vrátí.</span><span class="sxs-lookup"><span data-stu-id="f677e-254">When you use a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object with `System.Func<TInput, IEnumerable<TOutput>>`, processing of each input element is considered completed when the delegate returns.</span></span> <span data-ttu-id="f677e-255">Při použití <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> objektu `System.Func<TInput, Task<IEnumerable<TOutput>>>`s , zpracování každého vstupního prvku `System.Threading.Tasks.Task<IEnumerable<TOutput>>` je považováno za úplné pouze po dokončení vráceného objektu.</span><span class="sxs-lookup"><span data-stu-id="f677e-255">When you use a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object with `System.Func<TInput, Task<IEnumerable<TOutput>>>`, processing of each input element is considered complete only when the returned `System.Threading.Tasks.Task<IEnumerable<TOutput>>` object is completed.</span></span>  
  
 <span data-ttu-id="f677e-256">Následující základní příklad <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> vytvoří objekt, který rozdělí řetězce do jejich jednotlivých sekvencí znaků.</span><span class="sxs-lookup"><span data-stu-id="f677e-256">The following basic example creates a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object that splits strings into their individual character sequences.</span></span> <span data-ttu-id="f677e-257">Objekt <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> přebírá <xref:System.String> hodnoty jako vstup <xref:System.Char> a vytváří hodnoty jako výstup.</span><span class="sxs-lookup"><span data-stu-id="f677e-257">The <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object takes <xref:System.String> values as input and produces <xref:System.Char> values as output.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#6](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#6)]
 [!code-vb[TPLDataflow_Overview#6](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#6)]  
  
 <span data-ttu-id="f677e-258">Úplné příklady, <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> které slouží k vytvoření více nezávislých výstupů pro každý vstup v kanálu toku dat, naleznete v [tématu Návod: Vytvoření kanálu toku dat](../../../docs/standard/parallel-programming/walkthrough-creating-a-dataflow-pipeline.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-258">For complete examples that use <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> to produce multiple independent outputs for each input in a dataflow pipeline, see [Walkthrough: Creating a Dataflow Pipeline](../../../docs/standard/parallel-programming/walkthrough-creating-a-dataflow-pipeline.md).</span></span>  
  
#### <a name="degree-of-parallelism"></a><span data-ttu-id="f677e-259">Stupeň paralelismu</span><span class="sxs-lookup"><span data-stu-id="f677e-259">Degree of Parallelism</span></span>  
 <span data-ttu-id="f677e-260">Každý <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>, <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> a objekt vyrovnávací paměti vstupní zprávy, dokud blok je připraven ke zpracování.</span><span class="sxs-lookup"><span data-stu-id="f677e-260">Every <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>, and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object buffers input messages until the block is ready to process them.</span></span> <span data-ttu-id="f677e-261">Ve výchozím nastavení tyto třídy zpracovávají zprávy v pořadí, ve kterém jsou přijímány, jednu zprávu najednou.</span><span class="sxs-lookup"><span data-stu-id="f677e-261">By default, these classes process messages in the order in which they are received, one message at a time.</span></span> <span data-ttu-id="f677e-262">Můžete také určit stupeň paralelismu, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> který má být povolen <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, a objekty pro zpracování více zpráv současně.</span><span class="sxs-lookup"><span data-stu-id="f677e-262">You can also specify the degree of parallelism to enable <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> objects to process multiple messages concurrently.</span></span> <span data-ttu-id="f677e-263">Další informace o souběžném provádění naleznete v části Určení stupně paralelismu dále v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="f677e-263">For more information about concurrent execution, see the section Specifying the Degree of Parallelism later in this document.</span></span> <span data-ttu-id="f677e-264">Příklad, který nastavuje stupeň paralelismu, aby blok toku dat spuštění mohl zpracovat více než jednu zprávu najednou, najdete v tématu [How to: Specify the Degree of Parallelism in a Dataflow Block](../../../docs/standard/parallel-programming/how-to-specify-the-degree-of-parallelism-in-a-dataflow-block.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-264">For an example that sets the degree of parallelism to enable an execution dataflow block to process more than one message at a time, see [How to: Specify the Degree of Parallelism in a Dataflow Block](../../../docs/standard/parallel-programming/how-to-specify-the-degree-of-parallelism-in-a-dataflow-block.md).</span></span>  
  
#### <a name="summary-of-delegate-types"></a><span data-ttu-id="f677e-265">Souhrn typů delegátů</span><span class="sxs-lookup"><span data-stu-id="f677e-265">Summary of Delegate Types</span></span>  
 <span data-ttu-id="f677e-266">Následující tabulka shrnuje typy delegátů, <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>které <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>můžete <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> poskytnout , a objekty.</span><span class="sxs-lookup"><span data-stu-id="f677e-266">The following table summarizes the delegate types that you can provide to <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>, and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> objects.</span></span> <span data-ttu-id="f677e-267">Tato tabulka také určuje, zda typ delegáta pracuje synchronně nebo asynchronně.</span><span class="sxs-lookup"><span data-stu-id="f677e-267">This table also specifies whether the delegate type operates synchronously or asynchronously.</span></span>  
  
|<span data-ttu-id="f677e-268">Typ</span><span class="sxs-lookup"><span data-stu-id="f677e-268">Type</span></span>|<span data-ttu-id="f677e-269">Synchronní typ delegáta</span><span class="sxs-lookup"><span data-stu-id="f677e-269">Synchronous Delegate Type</span></span>|<span data-ttu-id="f677e-270">Asynchronní typ delegáta</span><span class="sxs-lookup"><span data-stu-id="f677e-270">Asynchronous Delegate Type</span></span>|  
|----------|-------------------------------|--------------------------------|  
|<xref:System.Threading.Tasks.Dataflow.ActionBlock%601>|`System.Action`|`System.Func<TInput, Task>`|  
|<xref:System.Threading.Tasks.Dataflow.TransformBlock%602>|`System.Func<TInput, TOutput>`|`System.Func<TInput, Task<TOutput>>`|  
|<xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>|`System.Func<TInput, IEnumerable<TOutput>>`|`System.Func<TInput, Task<IEnumerable<TOutput>>>`|  
  
 <span data-ttu-id="f677e-271">Výrazy lambda můžete také použít při práci s typy bloků spuštění.</span><span class="sxs-lookup"><span data-stu-id="f677e-271">You can also use lambda expressions when you work with execution block types.</span></span> <span data-ttu-id="f677e-272">Příklad, který ukazuje, jak používat výraz lambda s blokem spuštění, najdete v tématu [How to: Perform Action When a Dataflow Block Receives Data](../../../docs/standard/parallel-programming/how-to-perform-action-when-a-dataflow-block-receives-data.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-272">For an example that shows how to use a lambda expression with an execution block, see [How to: Perform Action When a Dataflow Block Receives Data](../../../docs/standard/parallel-programming/how-to-perform-action-when-a-dataflow-block-receives-data.md).</span></span>  
  
### <a name="grouping-blocks"></a><span data-ttu-id="f677e-273">Seskupování bloků</span><span class="sxs-lookup"><span data-stu-id="f677e-273">Grouping Blocks</span></span>  
 <span data-ttu-id="f677e-274">Seskupování bloků kombinuje data z jednoho nebo více zdrojů a pod různými omezeními.</span><span class="sxs-lookup"><span data-stu-id="f677e-274">Grouping blocks combine data from one or more sources and under various constraints.</span></span> <span data-ttu-id="f677e-275">Knihovna toku dat TPL poskytuje <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> <xref:System.Threading.Tasks.Dataflow.JoinBlock%602>tři <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602>typy spojů: , a .</span><span class="sxs-lookup"><span data-stu-id="f677e-275">The TPL Dataflow Library provides three join block types: <xref:System.Threading.Tasks.Dataflow.BatchBlock%601>, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602>, and <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602>.</span></span>  
  
#### <a name="batchblockt"></a><span data-ttu-id="f677e-276">BatchBlock(T)</span><span class="sxs-lookup"><span data-stu-id="f677e-276">BatchBlock(T)</span></span>  
 <span data-ttu-id="f677e-277">Třída <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> kombinuje sady vstupních dat, které jsou známé jako dávky, do polí výstupních dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-277">The <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> class combines sets of input data, which are known as batches, into arrays of output data.</span></span> <span data-ttu-id="f677e-278">Při vytváření objektu <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> určíte velikost každé dávky.</span><span class="sxs-lookup"><span data-stu-id="f677e-278">You specify the size of each batch when you create a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object.</span></span> <span data-ttu-id="f677e-279">Když <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> objekt obdrží zadaný počet vstupních prvků, asynchronně rozšíří pole, které obsahuje tyto prvky.</span><span class="sxs-lookup"><span data-stu-id="f677e-279">When the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object receives the specified count of input elements, it asynchronously propagates out an array that contains those elements.</span></span> <span data-ttu-id="f677e-280">Pokud <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> je objekt nastaven na dokončený stav, ale neobsahuje dostatek prvků k vytvoření dávky, rozšíří konečné pole, které obsahuje zbývající vstupní prvky.</span><span class="sxs-lookup"><span data-stu-id="f677e-280">If a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object is set to the completed state but does not contain enough elements to form a batch, it propagates out a final array that contains the remaining input elements.</span></span>  
  
 <span data-ttu-id="f677e-281">Třída <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> pracuje v *hladové* nebo *non-chamtivý* režimu.</span><span class="sxs-lookup"><span data-stu-id="f677e-281">The <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> class operates in either *greedy* or *non-greedy* mode.</span></span> <span data-ttu-id="f677e-282">V nenasytném režimu, <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> který je výchozí, objekt přijme každou zprávu, která je nabízena a rozšíří pole po obdrží zadaný počet prvků.</span><span class="sxs-lookup"><span data-stu-id="f677e-282">In greedy mode, which is the default, a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object accepts every message that it is offered and propagates out an array after it receives the specified count of elements.</span></span> <span data-ttu-id="f677e-283">V nechamtivém režimu <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> objekt odloží všechny příchozí zprávy, dokud dostatek zdrojů nenabídne zprávy bloku k vytvoření dávky.</span><span class="sxs-lookup"><span data-stu-id="f677e-283">In non-greedy mode, a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object postpones all incoming messages until enough sources have offered messages to the block to form a batch.</span></span> <span data-ttu-id="f677e-284">Hladový režim obvykle funguje lépe než nechamtivý režim, protože vyžaduje menší režii zpracování.</span><span class="sxs-lookup"><span data-stu-id="f677e-284">Greedy mode typically performs better than non-greedy mode because it requires less processing overhead.</span></span> <span data-ttu-id="f677e-285">Však můžete použít nechamtivý režim, když je nutné koordinovat spotřebu z více zdrojů atomickým způsobem.</span><span class="sxs-lookup"><span data-stu-id="f677e-285">However, you can use non-greedy mode when you must coordinate consumption from multiple sources in an atomic fashion.</span></span> <span data-ttu-id="f677e-286">Zadejte nechamtivý <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> `False` režim `dataflowBlockOptions` nastavením <xref:System.Threading.Tasks.Dataflow.BatchBlock%601.%23ctor%2A> v parametru v konstruktoru.</span><span class="sxs-lookup"><span data-stu-id="f677e-286">Specify non-greedy mode by setting <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> to `False` in the `dataflowBlockOptions` parameter in the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601.%23ctor%2A> constructor.</span></span>  
  
 <span data-ttu-id="f677e-287">Následující základní příklad <xref:System.Int32> zaúčtuje <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> několik hodnot do objektu, který obsahuje deset prvků v dávce.</span><span class="sxs-lookup"><span data-stu-id="f677e-287">The following basic example posts several <xref:System.Int32> values to a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object that holds ten elements in a batch.</span></span> <span data-ttu-id="f677e-288">Chcete-li zaručit, že všechny <xref:System.Threading.Tasks.Dataflow.BatchBlock%601>hodnoty šířit z <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A> , tento příklad volá metodu.</span><span class="sxs-lookup"><span data-stu-id="f677e-288">To guarantee that all values propagate out of the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601>, this example calls the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A> method.</span></span> <span data-ttu-id="f677e-289">Metoda <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A> nastaví <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> objekt do stavu dokončena <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> a proto objekt rozšíří všechny zbývající prvky jako konečnou dávku.</span><span class="sxs-lookup"><span data-stu-id="f677e-289">The <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A> method sets the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object to the completed state, and therefore, the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object propagates out any remaining elements as a final batch.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#7](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#7)]
 [!code-vb[TPLDataflow_Overview#7](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#7)]  
  
 <span data-ttu-id="f677e-290">Úplný příklad, který <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> se používá ke zlepšení efektivity operací vkládání databáze, naleznete [v návodu: Použití BatchBlock a BatchedJoinBlock pro zlepšení efektivity](../../../docs/standard/parallel-programming/walkthrough-using-batchblock-and-batchedjoinblock-to-improve-efficiency.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-290">For a complete example that uses <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> to improve the efficiency of database insert operations, see [Walkthrough: Using BatchBlock and BatchedJoinBlock to Improve Efficiency](../../../docs/standard/parallel-programming/walkthrough-using-batchblock-and-batchedjoinblock-to-improve-efficiency.md).</span></span>  
  
#### <a name="joinblockt1-t2-"></a><span data-ttu-id="f677e-291">JoinBlock(T1, T2, ...)</span><span class="sxs-lookup"><span data-stu-id="f677e-291">JoinBlock(T1, T2, ...)</span></span>  
 <span data-ttu-id="f677e-292">A <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> třídy sbírat vstupní prvky a šířit ven <xref:System.Tuple%602?displayProperty=nameWithType> nebo <xref:System.Tuple%603?displayProperty=nameWithType> objekty, které obsahují tyto prvky.</span><span class="sxs-lookup"><span data-stu-id="f677e-292">The <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> and <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> classes collect input elements and propagate out <xref:System.Tuple%602?displayProperty=nameWithType> or <xref:System.Tuple%603?displayProperty=nameWithType> objects that contain those elements.</span></span> <span data-ttu-id="f677e-293"><xref:System.Threading.Tasks.Dataflow.JoinBlock%602> Třídy <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> a nedědí z <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span><span class="sxs-lookup"><span data-stu-id="f677e-293">The <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> and <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> classes do not inherit from <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span></span> <span data-ttu-id="f677e-294">Místo toho poskytují <xref:System.Threading.Tasks.Dataflow.JoinBlock%602.Target1%2A>vlastnosti , <xref:System.Threading.Tasks.Dataflow.JoinBlock%602.Target2%2A>, a <xref:System.Threading.Tasks.Dataflow.JoinBlock%603.Target3%2A>, které implementují <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span><span class="sxs-lookup"><span data-stu-id="f677e-294">Instead, they provide properties, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602.Target1%2A>, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602.Target2%2A>, and <xref:System.Threading.Tasks.Dataflow.JoinBlock%603.Target3%2A>, that implement <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span></span>  
  
 <span data-ttu-id="f677e-295">Like <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> , <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> a pracovat buď v chamtivý nebo non-chamtivý režimu.</span><span class="sxs-lookup"><span data-stu-id="f677e-295">Like <xref:System.Threading.Tasks.Dataflow.BatchBlock%601>, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> and <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> operate in either greedy or non-greedy mode.</span></span> <span data-ttu-id="f677e-296">V nenasytný režim, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> který <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> je výchozí, nebo objekt přijme každou zprávu, která je nabízena a rozšíří z řazené kolekce členů po každý z jeho cílů obdrží alespoň jednu zprávu.</span><span class="sxs-lookup"><span data-stu-id="f677e-296">In greedy mode, which is the default, a <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> or <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> object accepts every message that it is offered and propagates out a tuple after each of its targets receives at least one message.</span></span> <span data-ttu-id="f677e-297">V nehladovém režimu <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> objekt nebo objekt odloží všechny příchozí zprávy, dokud nebudou nabídnuta data, která jsou potřebná k vytvoření řazené kolekce členů.</span><span class="sxs-lookup"><span data-stu-id="f677e-297">In non-greedy mode, a <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> or <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> object postpones all incoming messages until all targets have been offered the data that is required to create a tuple.</span></span> <span data-ttu-id="f677e-298">V tomto okamžiku blok zapojí do protokolu dvoufázového potvrzení atomicky načíst všechny požadované položky ze zdrojů.</span><span class="sxs-lookup"><span data-stu-id="f677e-298">At this point, the block engages in a two-phase commit protocol to atomically retrieve all required items from the sources.</span></span> <span data-ttu-id="f677e-299">Toto odložení umožňuje jiné entitě mezitím využívat data, aby celkový systém mohl pokročit vpřed.</span><span class="sxs-lookup"><span data-stu-id="f677e-299">This postponement makes it possible for another entity to consume the data in the meantime, to allow the overall system to make forward progress.</span></span>  
  
 <span data-ttu-id="f677e-300">Následující základní příklad ukazuje případ, <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> ve kterém objekt vyžaduje více dat k výpočtu hodnoty.</span><span class="sxs-lookup"><span data-stu-id="f677e-300">The following basic example demonstrates a case in which a <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> object requires multiple data to compute a value.</span></span> <span data-ttu-id="f677e-301">Tento příklad <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> vytvoří objekt, <xref:System.Int32> který <xref:System.Char> vyžaduje dvě hodnoty a hodnotu k provedení aritmetické operace.</span><span class="sxs-lookup"><span data-stu-id="f677e-301">This example creates a <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> object that requires two <xref:System.Int32> values and a <xref:System.Char> value to perform an arithmetic operation.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#8](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#8)]
 [!code-vb[TPLDataflow_Overview#8](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#8)]  
  
 <span data-ttu-id="f677e-302">Úplný příklad, který <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> používá objekty v nechamtivém režimu ke spolupráci s prostředky, najdete v tématu [How to: Use JoinBlock to Read Data from Multiple Sources](../../../docs/standard/parallel-programming/how-to-use-joinblock-to-read-data-from-multiple-sources.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-302">For a complete example that uses <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> objects in non-greedy mode to cooperatively share a resource, see [How to: Use JoinBlock to Read Data From Multiple Sources](../../../docs/standard/parallel-programming/how-to-use-joinblock-to-read-data-from-multiple-sources.md).</span></span>  
  
#### <a name="batchedjoinblockt1-t2-"></a><span data-ttu-id="f677e-303">BatchedJoinBlock(T1, T2, ...)</span><span class="sxs-lookup"><span data-stu-id="f677e-303">BatchedJoinBlock(T1, T2, ...)</span></span>  
 <span data-ttu-id="f677e-304">A <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%603> třídy sbírat dávky vstupní prvky a šířit ven `System.Tuple(IList(T1), IList(T2))` nebo `System.Tuple(IList(T1), IList(T2), IList(T3))` objekty, které obsahují tyto prvky.</span><span class="sxs-lookup"><span data-stu-id="f677e-304">The <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> and <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%603> classes collect batches of input elements and propagate out `System.Tuple(IList(T1), IList(T2))` or `System.Tuple(IList(T1), IList(T2), IList(T3))` objects that contain those elements.</span></span> <span data-ttu-id="f677e-305">Myslete <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> na jako <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> <xref:System.Threading.Tasks.Dataflow.JoinBlock%602>kombinace a .</span><span class="sxs-lookup"><span data-stu-id="f677e-305">Think of <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> as a combination of <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> and <xref:System.Threading.Tasks.Dataflow.JoinBlock%602>.</span></span> <span data-ttu-id="f677e-306">Určete velikost každé dávky <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> při vytváření objektu.</span><span class="sxs-lookup"><span data-stu-id="f677e-306">Specify the size of each batch when you create a <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> object.</span></span> <span data-ttu-id="f677e-307"><xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602>poskytuje také <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target1%2A> vlastnosti <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target2%2A>a <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>, které implementují .</span><span class="sxs-lookup"><span data-stu-id="f677e-307"><xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> also provides properties, <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target1%2A> and <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target2%2A>, that implement <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span></span> <span data-ttu-id="f677e-308">Když zadaný počet vstupních prvků jsou přijaty z napříč všemi <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> cíli, objekt asynchronně rozšíří `System.Tuple(IList(T1), IList(T2))` objekt, který obsahuje tyto prvky.</span><span class="sxs-lookup"><span data-stu-id="f677e-308">When the specified count of input elements are received from across all targets, the <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> object asynchronously propagates out a `System.Tuple(IList(T1), IList(T2))` object that contains those elements.</span></span>  
  
 <span data-ttu-id="f677e-309">Následující základní příklad <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> vytvoří objekt, <xref:System.Int32> který obsahuje výsledky, <xref:System.Exception> hodnoty a chyby, které jsou objekty.</span><span class="sxs-lookup"><span data-stu-id="f677e-309">The following basic example creates a <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> object that holds results, <xref:System.Int32> values, and errors that are <xref:System.Exception> objects.</span></span> <span data-ttu-id="f677e-310">Tento příklad provádí více operací <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target1%2A> a zapisuje výsledky do vlastnosti a chyby <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target2%2A> do vlastnosti objektu. <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602></span><span class="sxs-lookup"><span data-stu-id="f677e-310">This example performs multiple operations and writes results to the <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target1%2A> property, and errors to the <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target2%2A> property, of the <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> object.</span></span> <span data-ttu-id="f677e-311">Vzhledem k tomu, že počet úspěšných <xref:System.Collections.Generic.IList%601> a neúspěšných operací není předem znám, umožňují objekty každému cíli přijímat nulové nebo více hodnot.</span><span class="sxs-lookup"><span data-stu-id="f677e-311">Because the count of successful and failed operations is unknown in advance, the <xref:System.Collections.Generic.IList%601> objects enable each target to receive zero or more values.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#9](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#9)]
 [!code-vb[TPLDataflow_Overview#9](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#9)]  
  
 <span data-ttu-id="f677e-312">Úplný příklad, který <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> používá k zachycení výsledků a všech výjimek, ke kterým dochází při čtení programu z databáze, naleznete [v tématu Návod: Použití BatchBlock a BatchedJoinBlock pro zlepšení efektivity](../../../docs/standard/parallel-programming/walkthrough-using-batchblock-and-batchedjoinblock-to-improve-efficiency.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-312">For a complete example that uses <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> to capture both the results and any exceptions that occur while the program reads from a database, see [Walkthrough: Using BatchBlock and BatchedJoinBlock to Improve Efficiency](../../../docs/standard/parallel-programming/walkthrough-using-batchblock-and-batchedjoinblock-to-improve-efficiency.md).</span></span>  

## <a name="configuring-dataflow--block-behavior"></a><span data-ttu-id="f677e-313">Konfigurace chování bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="f677e-313">Configuring Dataflow  Block Behavior</span></span>  
 <span data-ttu-id="f677e-314">Můžete povolit další možnosti poskytnutím objektu <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions?displayProperty=nameWithType> konstruktoru typů bloků toku dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-314">You can enable additional options by providing a <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions?displayProperty=nameWithType> object to the constructor of dataflow block types.</span></span> <span data-ttu-id="f677e-315">Tyto možnosti řídí chování, jako je plánovač, který spravuje základní úkol a stupeň paralelismu.</span><span class="sxs-lookup"><span data-stu-id="f677e-315">These options control behavior such the scheduler that manages the underlying task and the degree of parallelism.</span></span> <span data-ttu-id="f677e-316">Také <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions> má odvozené typy, které určují chování, které je specifické pro určité typy bloků toku dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-316">The <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions> also has derived types that specify behavior that is specific to certain dataflow block types.</span></span> <span data-ttu-id="f677e-317">Následující tabulka shrnuje, který typ možností je přidružen ke každému typu bloku toku dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-317">The following table summarizes which options type is associated with each dataflow block type.</span></span>  
  
|<span data-ttu-id="f677e-318">Typ bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="f677e-318">Dataflow Block Type</span></span>|<span data-ttu-id="f677e-319"><xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions>Typ</span><span class="sxs-lookup"><span data-stu-id="f677e-319"><xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions> type</span></span>|  
|-------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|  
|<xref:System.Threading.Tasks.Dataflow.BufferBlock%601>|<xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601>|<xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601>|<xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.ActionBlock%601>|<xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.TransformBlock%602>|<xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>|<xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.BatchBlock%601>|<xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.JoinBlock%602>|<xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602>|<xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions>|  
  
 <span data-ttu-id="f677e-320">Následující části obsahují další informace o důležitých typech možností <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions?displayProperty=nameWithType>bloků <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions?displayProperty=nameWithType>toku dat, které jsou k dispozici prostřednictvím , a <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions?displayProperty=nameWithType> tříd.</span><span class="sxs-lookup"><span data-stu-id="f677e-320">The following sections provide additional information about the important kinds of dataflow block options that are available through the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions?displayProperty=nameWithType>, <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions?displayProperty=nameWithType>, and <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions?displayProperty=nameWithType> classes.</span></span>  
  
### <a name="specifying-the-task-scheduler"></a><span data-ttu-id="f677e-321">Určení plánovače úloh</span><span class="sxs-lookup"><span data-stu-id="f677e-321">Specifying the Task Scheduler</span></span>  
 <span data-ttu-id="f677e-322">Každý předdefinovaný blok toku dat používá mechanismus plánování úloh TPL k provádění činností, jako je šíření dat do cíle, příjem dat ze zdroje a spuštění uživatelem definovaných delegátů, když jsou data k dispozici.</span><span class="sxs-lookup"><span data-stu-id="f677e-322">Every predefined dataflow block uses the TPL task scheduling mechanism to perform activities such as propagating data to a target, receiving data from a source, and running user-defined delegates when data becomes available.</span></span> <span data-ttu-id="f677e-323"><xref:System.Threading.Tasks.TaskScheduler>je abstraktní třída, která představuje plánovač úloh, který zařadí úkoly do podprocesů.</span><span class="sxs-lookup"><span data-stu-id="f677e-323"><xref:System.Threading.Tasks.TaskScheduler> is an abstract class that represents a task scheduler that queues tasks onto threads.</span></span> <span data-ttu-id="f677e-324">Výchozí plánovač úloh <xref:System.Threading.Tasks.TaskScheduler.Default%2A>, používá <xref:System.Threading.ThreadPool> třídu k zařazení do fronty a provádění prací.</span><span class="sxs-lookup"><span data-stu-id="f677e-324">The default task scheduler, <xref:System.Threading.Tasks.TaskScheduler.Default%2A>, uses the <xref:System.Threading.ThreadPool> class to queue and execute work.</span></span> <span data-ttu-id="f677e-325">Výchozí plánovač úloh můžete přepsat nastavením <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.TaskScheduler%2A> vlastnosti při vytváření objektu bloku toku dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-325">You can override the default task scheduler by setting the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.TaskScheduler%2A> property when you construct a dataflow block object.</span></span>  
  
 <span data-ttu-id="f677e-326">Když stejný plánovač úloh spravuje více bloků toku dat, může vynutit zásady napříč nimi.</span><span class="sxs-lookup"><span data-stu-id="f677e-326">When the same task scheduler manages multiple dataflow blocks, it can enforce policies across them.</span></span> <span data-ttu-id="f677e-327">Například pokud více bloků toku dat jsou nakonfigurovány <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> tak, aby cílí na výhradní plánovač stejného objektu, všechny práce, které běží přes tyto bloky serializovat.</span><span class="sxs-lookup"><span data-stu-id="f677e-327">For example, if multiple dataflow blocks are each configured to target the exclusive scheduler of the same <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> object, all work that runs across these blocks is serialized.</span></span> <span data-ttu-id="f677e-328">Podobně pokud tyto bloky jsou nakonfigurovány tak, aby <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> cílí na souběžný plánovač stejného objektu a tento plánovač je nakonfigurován tak, aby měl maximální úroveň souběžnosti, veškerá práce z těchto bloků je omezena na tento počet souběžných operací.</span><span class="sxs-lookup"><span data-stu-id="f677e-328">Similarly, if these blocks are configured to target the concurrent scheduler of the same <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> object, and that scheduler is configured to have a maximum concurrency level, all work from these blocks is limited to that number of concurrent operations.</span></span> <span data-ttu-id="f677e-329">Příklad, který používá <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> třídu k povolení operací čtení provádět paralelně, ale zápis operace dojít výhradně všechny ostatní operace, naleznete v tématu [Jak: Zadat plánovač úloh v bloku toku dat](../../../docs/standard/parallel-programming/how-to-specify-a-task-scheduler-in-a-dataflow-block.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-329">For an example that uses the <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> class to enable read operations to occur in parallel, but write operations to occur exclusively of all other operations, see [How to: Specify a Task Scheduler in a Dataflow Block](../../../docs/standard/parallel-programming/how-to-specify-a-task-scheduler-in-a-dataflow-block.md).</span></span> <span data-ttu-id="f677e-330">Další informace o plánovačích úloh v TPL naleznete v tématu <xref:System.Threading.Tasks.TaskScheduler> třídy.</span><span class="sxs-lookup"><span data-stu-id="f677e-330">For more information about task schedulers in the TPL, see the <xref:System.Threading.Tasks.TaskScheduler> class topic.</span></span>  
  
### <a name="specifying-the-degree-of-parallelism"></a><span data-ttu-id="f677e-331">Určení stupně paralelismu</span><span class="sxs-lookup"><span data-stu-id="f677e-331">Specifying the Degree of Parallelism</span></span>  
 <span data-ttu-id="f677e-332">Ve výchozím nastavení tři typy bloků spuštění, které <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>knihovna toku dat TPL poskytuje, , <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>, zpracovat jednu zprávu najednou.</span><span class="sxs-lookup"><span data-stu-id="f677e-332">By default, the three execution block types that the TPL Dataflow Library provides, <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>, and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>, process one message at a time.</span></span> <span data-ttu-id="f677e-333">Tyto typy bloků toku dat také zpracovávají zprávy v pořadí, ve kterém jsou přijímány.</span><span class="sxs-lookup"><span data-stu-id="f677e-333">These dataflow block types also process messages in the order in which they are received.</span></span> <span data-ttu-id="f677e-334">Chcete-li povolit tyto bloky toku dat <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A?displayProperty=nameWithType> pro zpracování zpráv souběžně, nastavte vlastnost při vytváření objektu bloku toku dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-334">To enable these dataflow blocks to process messages concurrently, set the <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A?displayProperty=nameWithType> property when you construct the dataflow block object.</span></span>  
  
 <span data-ttu-id="f677e-335">Výchozí hodnota <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> je 1, která zaručuje, že blok toku dat zpracovává jednu zprávu najednou.</span><span class="sxs-lookup"><span data-stu-id="f677e-335">The default value of <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> is 1, which guarantees that the dataflow block processes one message at a time.</span></span> <span data-ttu-id="f677e-336">Nastavení této vlastnosti na hodnotu, která je větší než 1 umožňuje bloku toku dat ke zpracování více zpráv současně.</span><span class="sxs-lookup"><span data-stu-id="f677e-336">Setting this property to a value that is larger than 1 enables the dataflow block to process multiple messages concurrently.</span></span> <span data-ttu-id="f677e-337">Nastavení této <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded?displayProperty=nameWithType> vlastnosti umožňuje základní plánovač úloh spravovat maximální stupeň souběžnosti.</span><span class="sxs-lookup"><span data-stu-id="f677e-337">Setting this property to <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded?displayProperty=nameWithType> enables the underlying task scheduler to manage the maximum degree of concurrency.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="f677e-338">Zadáte-li maximální stupeň paralelismu, který je větší než 1, více zpráv jsou zpracovány současně a proto zprávy nemusí být zpracovány v pořadí, ve kterém jsou přijímány.</span><span class="sxs-lookup"><span data-stu-id="f677e-338">When you specify a maximum degree of parallelism that is larger than 1, multiple messages are processed simultaneously, and therefore messages might not be processed in the order in which they are received.</span></span> <span data-ttu-id="f677e-339">Pořadí, ve kterém jsou zprávy výstup z bloku je však stejný, ve kterém jsou přijaty.</span><span class="sxs-lookup"><span data-stu-id="f677e-339">The order in which the messages are output from the block is, however, the same one in which they are received.</span></span>  
  
 <span data-ttu-id="f677e-340">Vzhledem <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> k tomu, že vlastnost představuje maximální stupeň paralelismu, blok toku dat může spustit s menším stupněm paralelismu, než zadáte.</span><span class="sxs-lookup"><span data-stu-id="f677e-340">Because the <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> property represents the maximum degree of parallelism, the dataflow block might execute with a lesser degree of parallelism than you specify.</span></span> <span data-ttu-id="f677e-341">Blok toku dat může použít menší stupeň paralelismu ke splnění jeho funkční požadavky nebo proto, že je nedostatek dostupných systémových prostředků.</span><span class="sxs-lookup"><span data-stu-id="f677e-341">The dataflow block might use a lesser degree of parallelism to meet its functional requirements or because there is a lack of available system resources.</span></span> <span data-ttu-id="f677e-342">Blok toku dat nikdy nezvolí více paralelismu, než zadáte.</span><span class="sxs-lookup"><span data-stu-id="f677e-342">A dataflow block never chooses more parallelism than you specify.</span></span>  
  
 <span data-ttu-id="f677e-343">Hodnota vlastnosti <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> je výhradní pro každý objekt bloku toku dat.</span><span class="sxs-lookup"><span data-stu-id="f677e-343">The value of the <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> property is exclusive to each dataflow block object.</span></span> <span data-ttu-id="f677e-344">Například pokud čtyři objekty bloku toku dat každý zadat 1 pro maximální stupeň paralelismu, všechny čtyři objekty bloku toku dat může potenciálně spustit paralelně.</span><span class="sxs-lookup"><span data-stu-id="f677e-344">For example, if four dataflow block objects each specify 1 for the maximum degree of parallelism, all four dataflow block objects can potentially run in parallel.</span></span>  
  
 <span data-ttu-id="f677e-345">Příklad, který nastavuje maximální stupeň paralelismu, aby bylo možné provádět zdlouhavé operace paralelně, naleznete v tématu [How to: Specify the Degree of Parallelism in a Dataflow Block](../../../docs/standard/parallel-programming/how-to-specify-the-degree-of-parallelism-in-a-dataflow-block.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-345">For an example that sets the maximum degree of parallelism to enable lengthy operations to occur in parallel, see [How to: Specify the Degree of Parallelism in a Dataflow Block](../../../docs/standard/parallel-programming/how-to-specify-the-degree-of-parallelism-in-a-dataflow-block.md).</span></span>  
  
### <a name="specifying-the-number-of-messages-per-task"></a><span data-ttu-id="f677e-346">Určení počtu zpráv na úkol</span><span class="sxs-lookup"><span data-stu-id="f677e-346">Specifying the Number of Messages per Task</span></span>  
 <span data-ttu-id="f677e-347">Předdefinované typy bloků toku dat používají úlohy ke zpracování více vstupních prvků.</span><span class="sxs-lookup"><span data-stu-id="f677e-347">The predefined dataflow block types use tasks to process multiple input elements.</span></span> <span data-ttu-id="f677e-348">To pomáhá minimalizovat počet objektů úloh, které jsou nutné ke zpracování dat, což umožňuje aplikacím pracovat efektivněji.</span><span class="sxs-lookup"><span data-stu-id="f677e-348">This helps minimize the number of task objects that are required to process data, which enables applications to run more efficiently.</span></span> <span data-ttu-id="f677e-349">Však při úkoly z jedné sady bloků toku dat jsou zpracování dat, úkoly z jiných bloků toku dat může být nutné čekat na dobu zpracování do fronty zpráv.</span><span class="sxs-lookup"><span data-stu-id="f677e-349">However, when the tasks from one set of dataflow blocks are processing data, the tasks from other dataflow blocks might need to wait for processing time by queuing messages.</span></span> <span data-ttu-id="f677e-350">Chcete-li povolit lepší spravedlnost mezi <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> úlohami toku dat, nastavte vlastnost.</span><span class="sxs-lookup"><span data-stu-id="f677e-350">To enable better fairness among dataflow tasks, set the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> property.</span></span> <span data-ttu-id="f677e-351">Pokud <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> je <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded?displayProperty=nameWithType>nastavena na , což je výchozí, úloha používaná blokem toku dat zpracovává tolik zpráv, kolik je k dispozici.</span><span class="sxs-lookup"><span data-stu-id="f677e-351">When <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> is set to <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded?displayProperty=nameWithType>, which is the default, the task used by a dataflow block processes as many messages as are available.</span></span> <span data-ttu-id="f677e-352">Pokud <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> je nastavena na <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded>jinou hodnotu než , blok <xref:System.Threading.Tasks.Task> toku dat zpracovává maximálně tento počet zpráv na objekt.</span><span class="sxs-lookup"><span data-stu-id="f677e-352">When <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> is set to a value other than <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded>, the dataflow block processes at most this number of messages per <xref:System.Threading.Tasks.Task> object.</span></span> <span data-ttu-id="f677e-353">Přestože <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> nastavení vlastnosti může zvýšit spravedlnost mezi úkoly, může způsobit, že systém vytvořit více úkolů, než je nezbytné, což může snížit výkon.</span><span class="sxs-lookup"><span data-stu-id="f677e-353">Although setting the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> property can increase fairness among tasks, it can cause the system to create more tasks than are necessary, which can decrease performance.</span></span>  
  
### <a name="enabling-cancellation"></a><span data-ttu-id="f677e-354">Povolení zrušení</span><span class="sxs-lookup"><span data-stu-id="f677e-354">Enabling Cancellation</span></span>  
 <span data-ttu-id="f677e-355">TPL poskytuje mechanismus, který umožňuje úkolům koordinovat zrušení kooperativním způsobem.</span><span class="sxs-lookup"><span data-stu-id="f677e-355">The TPL provides a mechanism that enables tasks to coordinate cancellation in a cooperative manner.</span></span> <span data-ttu-id="f677e-356">Chcete-li povolit bloky toku dat <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.CancellationToken%2A> k účasti v tomto mechanismu zrušení, nastavte vlastnost.</span><span class="sxs-lookup"><span data-stu-id="f677e-356">To enable dataflow blocks to participate in this cancellation mechanism, set the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.CancellationToken%2A> property.</span></span> <span data-ttu-id="f677e-357">Pokud <xref:System.Threading.CancellationToken> je tento objekt nastaven na zrušený stav, všechny bloky toku dat, které sledují provádění tohoto tokenu dokončení jejich aktuální položky, ale nespustí zpracování následných položek.</span><span class="sxs-lookup"><span data-stu-id="f677e-357">When this <xref:System.Threading.CancellationToken> object is set to the canceled state, all dataflow blocks that monitor this token finish execution of their current item but do not start processing subsequent items.</span></span> <span data-ttu-id="f677e-358">Tyto bloky toku dat také vymazat všechny zprávy ve vyrovnávací paměti, uvolnění připojení k libovolnému zdroji a cílové bloky a přechod do zrušeného stavu.</span><span class="sxs-lookup"><span data-stu-id="f677e-358">These dataflow blocks also clear any buffered messages, release connections to any source and target blocks, and transition to the canceled state.</span></span> <span data-ttu-id="f677e-359">Přechodem do zrušeného stavu <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> má vlastnost <xref:System.Threading.Tasks.Task.Status%2A> nastavenou <xref:System.Threading.Tasks.TaskStatus.Canceled>na , pokud během zpracování nedošlo k výjimce.</span><span class="sxs-lookup"><span data-stu-id="f677e-359">By transitioning to the canceled state, the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> property has the <xref:System.Threading.Tasks.Task.Status%2A> property set to <xref:System.Threading.Tasks.TaskStatus.Canceled>, unless an exception occurred during processing.</span></span> <span data-ttu-id="f677e-360">V takovém <xref:System.Threading.Tasks.Task.Status%2A> případě je <xref:System.Threading.Tasks.TaskStatus.Faulted>nastavena na .</span><span class="sxs-lookup"><span data-stu-id="f677e-360">In that case, <xref:System.Threading.Tasks.Task.Status%2A> is set to <xref:System.Threading.Tasks.TaskStatus.Faulted>.</span></span>  
  
 <span data-ttu-id="f677e-361">Příklad, který ukazuje, jak používat zrušení v aplikaci Windows Forms, naleznete v tématu [How to: Cancel a Dataflow Block](../../../docs/standard/parallel-programming/how-to-cancel-a-dataflow-block.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-361">For an example that demonstrates how to use cancellation in a Windows Forms application, see [How to: Cancel a Dataflow Block](../../../docs/standard/parallel-programming/how-to-cancel-a-dataflow-block.md).</span></span> <span data-ttu-id="f677e-362">Další informace o zrušení v TPL naleznete v tématu [Zrušení úkolu](../../../docs/standard/parallel-programming/task-cancellation.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-362">For more information about cancellation in the TPL, see [Task Cancellation](../../../docs/standard/parallel-programming/task-cancellation.md).</span></span>  
  
### <a name="specifying-greedy-versus-non-greedy-behavior"></a><span data-ttu-id="f677e-363">Určení nenasytného versus nechamtivého chování</span><span class="sxs-lookup"><span data-stu-id="f677e-363">Specifying Greedy Versus Non-Greedy Behavior</span></span>  
 <span data-ttu-id="f677e-364">Několik typů seskupení datový tok bloku může pracovat v *hladové* nebo *ne-chamtivý* režimu.</span><span class="sxs-lookup"><span data-stu-id="f677e-364">Several grouping dataflow block types can operate in either *greedy* or *non-greedy* mode.</span></span> <span data-ttu-id="f677e-365">Ve výchozím nastavení předdefinované typy bloků toku dat pracují v chamtivém režimu.</span><span class="sxs-lookup"><span data-stu-id="f677e-365">By default, the predefined dataflow block types operate in greedy mode.</span></span>  
  
 <span data-ttu-id="f677e-366">Pro typy bloků <xref:System.Threading.Tasks.Dataflow.JoinBlock%602>spojení, jako je například, chamtivý režim znamená, že blok okamžitě přijímá data i v případě, že odpovídající data, s nimiž se připojit ještě není k dispozici.</span><span class="sxs-lookup"><span data-stu-id="f677e-366">For join block types such as <xref:System.Threading.Tasks.Dataflow.JoinBlock%602>, greedy mode means that the block immediately accepts data even if the corresponding data with which to join is not yet available.</span></span> <span data-ttu-id="f677e-367">Nechamtivý režim znamená, že blok odloží všechny příchozí zprávy, dokud jeden je k dispozici na každém z jeho cílů k dokončení spojení.</span><span class="sxs-lookup"><span data-stu-id="f677e-367">Non-greedy mode means that the block postpones all incoming messages until one is available on each of its targets to complete the join.</span></span> <span data-ttu-id="f677e-368">Pokud některá z odložených zpráv již nejsou k dispozici, blok spojení uvolní všechny odložené zprávy a restartuje proces.</span><span class="sxs-lookup"><span data-stu-id="f677e-368">If any of the postponed messages are no longer available, the join block releases all postponed messages and restarts the process.</span></span> <span data-ttu-id="f677e-369">Pro <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> třídu, hladové a non-chamtivý chování je podobné, s <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> tím rozdílem, že v režimu non-hladový objekt odkládá všechny příchozí zprávy, dokud dost jsou k dispozici z různých zdrojů k dokončení dávky.</span><span class="sxs-lookup"><span data-stu-id="f677e-369">For the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> class, greedy and non-greedy behavior is similar, except that under non-greedy mode, a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object postpones all incoming messages until enough are available from distinct sources to complete a batch.</span></span>  
  
 <span data-ttu-id="f677e-370">Chcete-li určit nechamtivý režim <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> pro `False`blok toku dat, nastavte na .</span><span class="sxs-lookup"><span data-stu-id="f677e-370">To specify non-greedy mode for a dataflow block, set <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> to `False`.</span></span> <span data-ttu-id="f677e-371">Příklad, který ukazuje, jak použít nechamtivý režim k povolení více bloků spojení pro efektivnější sdílení zdroje dat, naleznete v [tématu How to: Use JoinBlock to Read Data from Multiple Sources](../../../docs/standard/parallel-programming/how-to-use-joinblock-to-read-data-from-multiple-sources.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-371">For an example that demonstrates how to use non-greedy mode to enable multiple join blocks to share a data source more efficiently, see [How to: Use JoinBlock to Read Data From Multiple Sources](../../../docs/standard/parallel-programming/how-to-use-joinblock-to-read-data-from-multiple-sources.md).</span></span>

## <a name="custom-dataflow-blocks"></a><span data-ttu-id="f677e-372">Vlastní bloky toku dat</span><span class="sxs-lookup"><span data-stu-id="f677e-372">Custom Dataflow Blocks</span></span>  
 <span data-ttu-id="f677e-373">Přestože knihovna toku dat TPL poskytuje mnoho předdefinovaných typů bloků, můžete vytvořit další typy bloků, které provádějí vlastní chování.</span><span class="sxs-lookup"><span data-stu-id="f677e-373">Although the TPL Dataflow Library provides many predefined block types, you can create additional block types that perform custom behavior.</span></span> <span data-ttu-id="f677e-374">Implementujte <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601> <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> rozhraní nebo přímo <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Encapsulate%2A> nebo použijte metodu k vytvoření komplexního bloku, který zapouzdřuje chování existujících typů bloků.</span><span class="sxs-lookup"><span data-stu-id="f677e-374">Implement the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601> or <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> interfaces directly or use the  <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Encapsulate%2A> method to build a complex block that encapsulates the behavior of existing block types.</span></span> <span data-ttu-id="f677e-375">Příklady, které ukazují, jak implementovat vlastní funkce bloku toku dat, naleznete [v tématu Návod: Vytvoření vlastního typu bloku toku dat](../../../docs/standard/parallel-programming/walkthrough-creating-a-custom-dataflow-block-type.md).</span><span class="sxs-lookup"><span data-stu-id="f677e-375">For examples that show how to implement custom dataflow block functionality, see [Walkthrough: Creating a Custom Dataflow Block Type](../../../docs/standard/parallel-programming/walkthrough-creating-a-custom-dataflow-block-type.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="f677e-376">Související témata</span><span class="sxs-lookup"><span data-stu-id="f677e-376">Related Topics</span></span>  
  
|<span data-ttu-id="f677e-377">Nadpis</span><span class="sxs-lookup"><span data-stu-id="f677e-377">Title</span></span>|<span data-ttu-id="f677e-378">Popis</span><span class="sxs-lookup"><span data-stu-id="f677e-378">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="f677e-379">Postupy: Zápis zpráv do bloku toku dat a čtení zpráv z bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="f677e-379">How to: Write Messages to and Read Messages from a Dataflow Block</span></span>](../../../docs/standard/parallel-programming/how-to-write-messages-to-and-read-messages-from-a-dataflow-block.md)|<span data-ttu-id="f677e-380">Ukazuje, jak psát zprávy a číst <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> zprávy z objektu.</span><span class="sxs-lookup"><span data-stu-id="f677e-380">Demonstrates how to write messages to and read messages from a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> object.</span></span>|  
|[<span data-ttu-id="f677e-381">Postupy: Implementace vzoru toku dat producent–příjemce</span><span class="sxs-lookup"><span data-stu-id="f677e-381">How to: Implement a Producer-Consumer Dataflow Pattern</span></span>](../../../docs/standard/parallel-programming/how-to-implement-a-producer-consumer-dataflow-pattern.md)|<span data-ttu-id="f677e-382">Popisuje, jak pomocí modelu toku dat implementovat vzor výrobce a spotřebitele, kde výrobce odesílá zprávy do bloku toku dat a příjemce čte zprávy z tohoto bloku.</span><span class="sxs-lookup"><span data-stu-id="f677e-382">Describes how to use the dataflow model to implement a producer-consumer pattern, where the producer sends messages to a dataflow block, and the consumer reads messages from that block.</span></span>|  
|[<span data-ttu-id="f677e-383">Postupy: Provádění akcí po přijetí dat do bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="f677e-383">How to: Perform Action When a Dataflow Block Receives Data</span></span>](../../../docs/standard/parallel-programming/how-to-perform-action-when-a-dataflow-block-receives-data.md)|<span data-ttu-id="f677e-384">Popisuje, jak poskytnout delegáty typy bloků <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>toku dat spuštění , , <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>.</span><span class="sxs-lookup"><span data-stu-id="f677e-384">Describes how to provide delegates to the execution dataflow block types, <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>, and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>.</span></span>|  
|[<span data-ttu-id="f677e-385">Návod: Vytvoření kanálu toku dat</span><span class="sxs-lookup"><span data-stu-id="f677e-385">Walkthrough: Creating a Dataflow Pipeline</span></span>](../../../docs/standard/parallel-programming/walkthrough-creating-a-dataflow-pipeline.md)|<span data-ttu-id="f677e-386">Popisuje, jak vytvořit kanál toku dat, který stahuje text z webu a provádí operace s tímto textem.</span><span class="sxs-lookup"><span data-stu-id="f677e-386">Describes how to create a dataflow pipeline that downloads text from the web and performs operations on that text.</span></span>|  
|[<span data-ttu-id="f677e-387">Postupy: Zrušení propojení bloků toku dat</span><span class="sxs-lookup"><span data-stu-id="f677e-387">How to: Unlink Dataflow Blocks</span></span>](../../../docs/standard/parallel-programming/how-to-unlink-dataflow-blocks.md)|<span data-ttu-id="f677e-388">Ukazuje, jak použít <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A> metodu k odpojení cílového bloku od jeho zdroje poté, co zdroj nabídne zprávu cíli.</span><span class="sxs-lookup"><span data-stu-id="f677e-388">Demonstrates how to use the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A> method to unlink a target block from its source after the source offers a message to the target.</span></span>|  
|[<span data-ttu-id="f677e-389">Návod: Použití toku dat v aplikaci Windows Forms</span><span class="sxs-lookup"><span data-stu-id="f677e-389">Walkthrough: Using Dataflow in a Windows Forms Application</span></span>](../../../docs/standard/parallel-programming/walkthrough-using-dataflow-in-a-windows-forms-application.md)|<span data-ttu-id="f677e-390">Ukazuje, jak vytvořit síť bloků toku dat, které provádějí zpracování obrazu v aplikaci Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="f677e-390">Demonstrates how to create a network of dataflow blocks that perform image processing in a Windows Forms application.</span></span>|  
|[<span data-ttu-id="f677e-391">Postupy: Zrušení bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="f677e-391">How to: Cancel a Dataflow Block</span></span>](../../../docs/standard/parallel-programming/how-to-cancel-a-dataflow-block.md)|<span data-ttu-id="f677e-392">Ukazuje, jak používat zrušení v aplikaci Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="f677e-392">Demonstrates how to use cancellation in a Windows Forms application.</span></span>|  
|[<span data-ttu-id="f677e-393">Postupy: Načítání dat z více zdrojů pomocí třídy JoinBlock</span><span class="sxs-lookup"><span data-stu-id="f677e-393">How to: Use JoinBlock to Read Data From Multiple Sources</span></span>](../../../docs/standard/parallel-programming/how-to-use-joinblock-to-read-data-from-multiple-sources.md)|<span data-ttu-id="f677e-394">Vysvětluje, jak použít <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> třídu k provedení operace, pokud jsou data k dispozici z více zdrojů, a jak použít nechamtivý režim, aby bylo možné efektivněji sdílet zdroj dat více bloků spojení.</span><span class="sxs-lookup"><span data-stu-id="f677e-394">Explains how to use the <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> class to perform an operation when data is available from multiple sources, and how to use non-greedy mode to enable multiple join blocks to share a data source more efficiently.</span></span>|  
|[<span data-ttu-id="f677e-395">Postupy: Určení stupně paralelního zpracování v bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="f677e-395">How to: Specify the Degree of Parallelism in a Dataflow Block</span></span>](../../../docs/standard/parallel-programming/how-to-specify-the-degree-of-parallelism-in-a-dataflow-block.md)|<span data-ttu-id="f677e-396">Popisuje, jak nastavit <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> vlastnost povolit spuštění bloku toku dat pro zpracování více než jednu zprávu najednou.</span><span class="sxs-lookup"><span data-stu-id="f677e-396">Describes how to set the <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> property to enable an execution dataflow block to process more than one message at a time.</span></span>|  
|[<span data-ttu-id="f677e-397">Postupy: Určení plánovače úloh v bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="f677e-397">How to: Specify a Task Scheduler in a Dataflow Block</span></span>](../../../docs/standard/parallel-programming/how-to-specify-a-task-scheduler-in-a-dataflow-block.md)|<span data-ttu-id="f677e-398">Ukazuje, jak přidružit konkrétní plánovač úloh při použití toku dat v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="f677e-398">Demonstrates how to associate a specific task scheduler when you use dataflow in your application.</span></span>|  
|[<span data-ttu-id="f677e-399">Návod: Zvýšení efektivity díky použití tříd BatchBlock a BatchedJoinBlock</span><span class="sxs-lookup"><span data-stu-id="f677e-399">Walkthrough: Using BatchBlock and BatchedJoinBlock to Improve Efficiency</span></span>](../../../docs/standard/parallel-programming/walkthrough-using-batchblock-and-batchedjoinblock-to-improve-efficiency.md)|<span data-ttu-id="f677e-400">Popisuje, jak pomocí <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> třídy ke zlepšení efektivity operací vkládání <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> databáze a jak použít třídu k zachycení výsledků a všech výjimek, ke kterým dochází při čtení programu z databáze.</span><span class="sxs-lookup"><span data-stu-id="f677e-400">Describes how to use the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> class to improve the efficiency of database insert operations, and how to use the <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> class to capture both the results and any exceptions that occur while the program reads from a database.</span></span>|  
|[<span data-ttu-id="f677e-401">Návod: Vytvoření bloku toku dat vlastního typu</span><span class="sxs-lookup"><span data-stu-id="f677e-401">Walkthrough: Creating a Custom Dataflow Block Type</span></span>](../../../docs/standard/parallel-programming/walkthrough-creating-a-custom-dataflow-block-type.md)|<span data-ttu-id="f677e-402">Ukazuje dva způsoby, jak vytvořit typ bloku toku dat, který implementuje vlastní chování.</span><span class="sxs-lookup"><span data-stu-id="f677e-402">Demonstrates two ways to create a dataflow block type that implements custom behavior.</span></span>|  
|[<span data-ttu-id="f677e-403">Task Parallel Library (TPL)</span><span class="sxs-lookup"><span data-stu-id="f677e-403">Task Parallel Library (TPL)</span></span>](../../../docs/standard/parallel-programming/task-parallel-library-tpl.md)|<span data-ttu-id="f677e-404">Zavádí TPL, knihovnu, která zjednodušuje paralelní a souběžné programování v aplikacích rozhraní .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="f677e-404">Introduces the TPL, a library that simplifies parallel and concurrent programming in .NET Framework applications.</span></span>|
