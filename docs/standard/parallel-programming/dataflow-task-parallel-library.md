---
title: Tok dat (Task Parallel Library)
description: Naučte se používat součásti toku dat v rámci Task Parallel Library (TPL) ke zlepšení odolnosti aplikací s podporou souběžného zpracování.
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- Task Parallel Library, dataflows
- TPL dataflow library
ms.assetid: 643575d0-d26d-4c35-8de7-a9c403e97dd6
ms.openlocfilehash: 2c7bbc9bf935159ab66bd2a61a60b9484e67018a
ms.sourcegitcommit: 7137e12f54c4e83a94ae43ec320f8cf59c1772ea
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/10/2020
ms.locfileid: "84662547"
---
# <a name="dataflow-task-parallel-library"></a><span data-ttu-id="49aa9-103">Tok dat (Task Parallel Library)</span><span class="sxs-lookup"><span data-stu-id="49aa9-103">Dataflow (Task Parallel Library)</span></span>
<span data-ttu-id="49aa9-104">Task Parallel Library (TPL) poskytuje součásti toku dat, které vám pomůžou zvýšit odolnost aplikací s podporou souběžného zpracování.</span><span class="sxs-lookup"><span data-stu-id="49aa9-104">The Task Parallel Library (TPL) provides dataflow components to help increase the robustness of concurrency-enabled applications.</span></span> <span data-ttu-id="49aa9-105">Tyto komponenty toku dat jsou souhrnně označovány jako *Knihovna rozhraní TPL Dataflow*.</span><span class="sxs-lookup"><span data-stu-id="49aa9-105">These dataflow components are collectively referred to as the *TPL Dataflow Library*.</span></span> <span data-ttu-id="49aa9-106">Tento model toku dat propaguje programování založené na objektu actor tím, že zajišťuje předávání zpráv v procesu pro hrubý úlohy toku dat a zřetězení.</span><span class="sxs-lookup"><span data-stu-id="49aa9-106">This dataflow model promotes actor-based programming by providing in-process message passing for coarse-grained dataflow and pipelining tasks.</span></span> <span data-ttu-id="49aa9-107">Komponenty toku dat jsou vytvořeny na typech a plánování infrastruktury aplikace TPL a integrovány s podporou jazyka C#, Visual Basic a F # pro asynchronní programování.</span><span class="sxs-lookup"><span data-stu-id="49aa9-107">The dataflow components build on the types and scheduling infrastructure of the TPL and integrate with the C#, Visual Basic, and F# language support for asynchronous programming.</span></span> <span data-ttu-id="49aa9-108">Tyto součásti toku dat jsou užitečné v případě, že máte více operací, které musí komunikovat s jiným asynchronním nebo pokud chcete data zpracovat, jakmile budou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="49aa9-108">These dataflow components are useful when you have multiple operations that must communicate with one another asynchronously or when you want to process data as it becomes available.</span></span> <span data-ttu-id="49aa9-109">Zvažte například aplikaci, která zpracovává obrazová data z webové kamery.</span><span class="sxs-lookup"><span data-stu-id="49aa9-109">For example, consider an application that processes image data from a web camera.</span></span> <span data-ttu-id="49aa9-110">Pomocí modelu toku dat aplikace může zpracovat snímky imagí, jakmile budou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="49aa9-110">By using the dataflow model, the application can process image frames as they become available.</span></span> <span data-ttu-id="49aa9-111">Pokud aplikace vylepšuje snímky obrázků, například provedením světlé nápravy nebo snížení červeného oka, můžete vytvořit *kanál* komponent toku dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-111">If the application enhances image frames, for example, by performing light correction or red-eye reduction, you can create a *pipeline* of dataflow components.</span></span> <span data-ttu-id="49aa9-112">Každá fáze kanálu může použít více hrubých paralelních funkcí, jako jsou funkce, které poskytuje TPL, k transformaci image.</span><span class="sxs-lookup"><span data-stu-id="49aa9-112">Each stage of the pipeline might use more coarse-grained parallelism functionality, such as the functionality that is provided by the TPL, to transform the image.</span></span>  
  
 <span data-ttu-id="49aa9-113">Tento dokument poskytuje přehled knihovny toku dat TPL.</span><span class="sxs-lookup"><span data-stu-id="49aa9-113">This document provides an overview of the TPL Dataflow Library.</span></span> <span data-ttu-id="49aa9-114">Popisuje programovací model, předdefinované typy bloků toku dat a způsob konfigurace bloků toku dat pro splnění konkrétních požadavků vašich aplikací.</span><span class="sxs-lookup"><span data-stu-id="49aa9-114">It describes the programming model, the predefined dataflow block types, and how to configure dataflow blocks to meet the specific requirements of your applications.</span></span>  

[!INCLUDE [tpl-install-instructions](../../../includes/tpl-install-instructions.md)]

## <a name="programming-model"></a><span data-ttu-id="49aa9-115">Programovací model</span><span class="sxs-lookup"><span data-stu-id="49aa9-115">Programming Model</span></span>
 <span data-ttu-id="49aa9-116">Knihovna TPL Dataflow poskytuje základ pro předávání zpráv a virtuálního aplikací náročných na výkon procesoru a vstupně-výstupní operace s vysokou propustností a nízkou latencí.</span><span class="sxs-lookup"><span data-stu-id="49aa9-116">The TPL Dataflow Library provides a foundation for message passing and parallelizing CPU-intensive and I/O-intensive applications that have high throughput and low latency.</span></span> <span data-ttu-id="49aa9-117">Poskytuje vám také explicitní kontrolu nad tím, jak jsou data ukládána do vyrovnávací paměti a pohybují se systémem.</span><span class="sxs-lookup"><span data-stu-id="49aa9-117">It also gives you explicit control over how data is buffered and moves around the system.</span></span> <span data-ttu-id="49aa9-118">Pro lepší pochopení programovacího modelu toku dat zvažte aplikaci, která asynchronně načte obrázky z disku a vytvoří složený z těchto imagí.</span><span class="sxs-lookup"><span data-stu-id="49aa9-118">To better understand the dataflow programming model, consider an application that asynchronously loads images from disk and creates a composite of those images.</span></span> <span data-ttu-id="49aa9-119">Tradiční programovací modely obvykle vyžadují, abyste k koordinaci úloh a přístupu ke sdíleným datům použili zpětná volání a synchronizační objekty, jako jsou zámky.</span><span class="sxs-lookup"><span data-stu-id="49aa9-119">Traditional programming models typically require that you use callbacks and synchronization objects, such as locks, to coordinate tasks and access to shared data.</span></span> <span data-ttu-id="49aa9-120">Pomocí modelu programování toku dat můžete vytvořit objekty Dataflow, které zpracovávají obrázky při jejich čtení z disku.</span><span class="sxs-lookup"><span data-stu-id="49aa9-120">By using the dataflow programming model, you can create dataflow objects that process images as they are read from disk.</span></span> <span data-ttu-id="49aa9-121">V modelu toku dat deklarujete, jakým způsobem jsou data zpracována, jakmile budou k dispozici, a také všechny závislosti mezi daty.</span><span class="sxs-lookup"><span data-stu-id="49aa9-121">Under the dataflow model, you declare how data is handled when it becomes available, and also any dependencies between data.</span></span> <span data-ttu-id="49aa9-122">Vzhledem k tomu, že modul runtime spravuje závislosti mezi daty, můžete se často vyhnout nutnosti synchronizovat přístup ke sdíleným datům.</span><span class="sxs-lookup"><span data-stu-id="49aa9-122">Because the runtime manages dependencies between data, you can often avoid the requirement to synchronize access to shared data.</span></span> <span data-ttu-id="49aa9-123">Kromě toho, vzhledem k tomu, že modul runtime plánuje práci na základě asynchronního příjezdu dat, může tok dat zlepšit odezvu a propustnost tím, že efektivně spravuje podkladová vlákna.</span><span class="sxs-lookup"><span data-stu-id="49aa9-123">In addition, because the runtime schedules work based on the asynchronous arrival of data, dataflow can improve responsiveness and throughput by efficiently managing the underlying threads.</span></span> <span data-ttu-id="49aa9-124">Příklad, který používá programovací model Dataflow k implementaci zpracování bitové kopie v aplikaci model Windows Forms, naleznete v tématu [Návod: použití toku dat v aplikaci model Windows Forms](walkthrough-using-dataflow-in-a-windows-forms-application.md).</span><span class="sxs-lookup"><span data-stu-id="49aa9-124">For an example that uses the dataflow programming model to implement image processing in a Windows Forms application, see [Walkthrough: Using Dataflow in a Windows Forms Application](walkthrough-using-dataflow-in-a-windows-forms-application.md).</span></span>  
  
### <a name="sources-and-targets"></a><span data-ttu-id="49aa9-125">Zdroje a cíle</span><span class="sxs-lookup"><span data-stu-id="49aa9-125">Sources and Targets</span></span>  
 <span data-ttu-id="49aa9-126">Knihovna TPL Dataflow se skládá z *bloků toku*dat, což jsou datové struktury, které ukládají data do vyrovnávací paměti a zpracovávají data.</span><span class="sxs-lookup"><span data-stu-id="49aa9-126">The TPL Dataflow Library consists of *dataflow blocks*, which are data structures that buffer and process data.</span></span> <span data-ttu-id="49aa9-127">TPL definuje tři druhy bloků toku: *zdrojové bloky*, *cílové bloky*a *bloky pro šíření*.</span><span class="sxs-lookup"><span data-stu-id="49aa9-127">The TPL defines three kinds of dataflow blocks: *source blocks*, *target blocks*, and *propagator blocks*.</span></span> <span data-ttu-id="49aa9-128">Zdrojový blok funguje jako zdroj dat a lze ho číst z.</span><span class="sxs-lookup"><span data-stu-id="49aa9-128">A source block acts as a source of data and can be read from.</span></span> <span data-ttu-id="49aa9-129">Cílový blok funguje jako přijímač dat a lze do něj zapisovat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-129">A target block acts as a receiver of data and can be written to.</span></span> <span data-ttu-id="49aa9-130">Blok šíření funguje jako zdrojový blok i cílový blok a lze ho číst z a zapisovat do.</span><span class="sxs-lookup"><span data-stu-id="49aa9-130">A propagator block acts as both a source block and a target block, and can be read from and written to.</span></span> <span data-ttu-id="49aa9-131">TPL definuje rozhraní, <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601?displayProperty=nameWithType> které představuje zdroje, pro reprezentaci <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601?displayProperty=nameWithType> cílů a <xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602?displayProperty=nameWithType> k reprezentaci rozšířících.</span><span class="sxs-lookup"><span data-stu-id="49aa9-131">The TPL defines the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601?displayProperty=nameWithType> interface to represent sources, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601?displayProperty=nameWithType> to represent targets, and <xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602?displayProperty=nameWithType> to represent propagators.</span></span> <span data-ttu-id="49aa9-132"><xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602>dědí z obou <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601> a <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-132"><xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602> inherits from both <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601>, and <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span></span>  
  
 <span data-ttu-id="49aa9-133">Knihovna TPL Dataflow poskytuje několik předdefinovaných typů bloků toku dat, které implementují <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601> <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> rozhraní, a <xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-133">The TPL Dataflow Library provides several predefined dataflow block types that implement the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601>, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>, and <xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602> interfaces.</span></span> <span data-ttu-id="49aa9-134">Tyto typy bloků toku dat jsou popsány v tomto dokumentu v části [předdefinované typy bloků toku](#predefined-dataflow-block-types)dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-134">These dataflow block types are described in this document in the section [Predefined Dataflow Block Types](#predefined-dataflow-block-types).</span></span>  
  
### <a name="connecting-blocks"></a><span data-ttu-id="49aa9-135">Spojovací bloky</span><span class="sxs-lookup"><span data-stu-id="49aa9-135">Connecting Blocks</span></span>  
 <span data-ttu-id="49aa9-136">Bloky toku dat můžete propojit s *kanály*pro formuláře, které jsou lineární sekvence bloků toku dat nebo *sítě*, které jsou grafy bloků toku dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-136">You can connect dataflow blocks to form *pipelines*, which are linear sequences of dataflow blocks, or *networks*, which are graphs of dataflow blocks.</span></span> <span data-ttu-id="49aa9-137">Kanál je jedna forma sítě.</span><span class="sxs-lookup"><span data-stu-id="49aa9-137">A pipeline is one form of network.</span></span> <span data-ttu-id="49aa9-138">V kanálu nebo v síti zdroje asynchronně šíří data do cílů, jakmile budou tato data k dispozici.</span><span class="sxs-lookup"><span data-stu-id="49aa9-138">In a pipeline or network, sources asynchronously propagate data to targets as that data becomes available.</span></span> <span data-ttu-id="49aa9-139"><xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A?displayProperty=nameWithType>Metoda propojuje zdrojový blok toku dat s cílovým blokem.</span><span class="sxs-lookup"><span data-stu-id="49aa9-139">The <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A?displayProperty=nameWithType> method links a source dataflow block to a target block.</span></span> <span data-ttu-id="49aa9-140">Zdroj může být propojený s žádným nebo více cíli. cíle lze propojit z nula nebo více zdrojů.</span><span class="sxs-lookup"><span data-stu-id="49aa9-140">A source can be linked to zero or more targets; targets can be linked from zero or more sources.</span></span> <span data-ttu-id="49aa9-141">Bloky toku dat můžete do nebo z kanálu nebo sítě souběžně přidávat nebo odebírat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-141">You can add or remove dataflow blocks to or from a pipeline or network concurrently.</span></span> <span data-ttu-id="49aa9-142">Předdefinované typy bloků toku dat zpracovávají všechny aspekty bezpečnosti pro přístup z více vláken při propojování a odpojování.</span><span class="sxs-lookup"><span data-stu-id="49aa9-142">The predefined dataflow block types handle all thread-safety aspects of linking and unlinking.</span></span>  
  
 <span data-ttu-id="49aa9-143">Příklad, který spojuje bloky toku dat s cílem vytvořit základní kanál, najdete v tématu [Návod: vytvoření kanálu toku](walkthrough-creating-a-dataflow-pipeline.md)dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-143">For an example that connects dataflow blocks to form a basic pipeline, see [Walkthrough: Creating a Dataflow Pipeline](walkthrough-creating-a-dataflow-pipeline.md).</span></span> <span data-ttu-id="49aa9-144">Příklad propojení bloků toku dat za účelem vytvoření komplexnější sítě najdete v tématu [Návod: použití toku dat v aplikaci model Windows Forms](walkthrough-using-dataflow-in-a-windows-forms-application.md).</span><span class="sxs-lookup"><span data-stu-id="49aa9-144">For an example that connects dataflow blocks to form a more complex network, see [Walkthrough: Using Dataflow in a Windows Forms Application](walkthrough-using-dataflow-in-a-windows-forms-application.md).</span></span> <span data-ttu-id="49aa9-145">Příklad, který odpojí cíl ze zdroje po tom, co zdroj nabízí cíl zprávy, naleznete v tématu [How to: Unlink Dataflow Blocks](how-to-unlink-dataflow-blocks.md).</span><span class="sxs-lookup"><span data-stu-id="49aa9-145">For an example that unlinks a target from a source after the source offers the target a message, see [How to: Unlink Dataflow Blocks](how-to-unlink-dataflow-blocks.md).</span></span>  
  
#### <a name="filtering"></a><span data-ttu-id="49aa9-146">Filtrování</span><span class="sxs-lookup"><span data-stu-id="49aa9-146">Filtering</span></span>  
 <span data-ttu-id="49aa9-147">Při volání <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A?displayProperty=nameWithType> metody pro propojení zdroje s cílem můžete zadat delegáta, který určuje, zda cílový blok přijme nebo odmítne zprávu na základě hodnoty této zprávy.</span><span class="sxs-lookup"><span data-stu-id="49aa9-147">When you call the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A?displayProperty=nameWithType> method to link a source to a target, you can supply a delegate that determines whether the target block accepts or rejects a message based on the value of that message.</span></span> <span data-ttu-id="49aa9-148">Tento mechanismus filtrování je užitečný způsob, jak zajistit, aby blok toku dat přijímal jenom určité hodnoty.</span><span class="sxs-lookup"><span data-stu-id="49aa9-148">This filtering mechanism is a useful way to guarantee that a dataflow block receives only certain values.</span></span> <span data-ttu-id="49aa9-149">Pro většinu předdefinovaných typů bloku toku dat je-li zdrojový blok připojen k více cílovým blokům, poté, co cílový blok odmítne zprávu, zdroj nabídne tuto zprávu dalšímu cíli.</span><span class="sxs-lookup"><span data-stu-id="49aa9-149">For most of the predefined dataflow block types, if a source block is connected to multiple target blocks, when a target block rejects a message, the source offers that message to the next target.</span></span> <span data-ttu-id="49aa9-150">Pořadí, ve kterém zdroj nabízí zprávy na cíle, je definováno zdrojem a může se lišit podle typu zdroje.</span><span class="sxs-lookup"><span data-stu-id="49aa9-150">The order in which a source offers messages to targets is defined by the source and can vary according to the type of the source.</span></span> <span data-ttu-id="49aa9-151">Většina typů zdrojových bloků zastaví nabízenou zprávu po tom, co jeden cíl přijme tuto zprávu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-151">Most source block types stop offering a message after one target accepts that message.</span></span> <span data-ttu-id="49aa9-152">Jedinou výjimkou z tohoto pravidla je <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> třída, která nabízí každou zprávu všem cílům, i když některé cíle odmítnou zprávu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-152">One exception to this rule is the <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> class, which offers each message to all targets, even if some targets reject the message.</span></span> <span data-ttu-id="49aa9-153">Příklad, který používá filtrování pro zpracování pouze určitých zpráv, naleznete v tématu [Návod: použití toku dat v aplikaci model Windows Forms](walkthrough-using-dataflow-in-a-windows-forms-application.md).</span><span class="sxs-lookup"><span data-stu-id="49aa9-153">For an example that uses filtering to process only certain messages, see [Walkthrough: Using Dataflow in a Windows Forms Application](walkthrough-using-dataflow-in-a-windows-forms-application.md).</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="49aa9-154">Vzhledem k tomu, že každý předdefinovaný typ bloku toku dat zaručuje, že se zprávy šíří v pořadí, ve kterém byly přijaty, musí být každá zpráva načtena ze zdrojového bloku předtím, než může zdrojový blok zpracovat další zprávu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-154">Because each predefined source dataflow block type guarantees that messages are propagated out in the order in which they are received, every message must be read from the source block before the source block can process the next message.</span></span> <span data-ttu-id="49aa9-155">Proto když použijete filtrování k připojení více cílů ke zdroji, ujistěte se, že alespoň jeden cílový blok obdrží každou zprávu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-155">Therefore, when you use filtering to connect multiple targets to a source, make sure that at least one target block receives each message.</span></span> <span data-ttu-id="49aa9-156">V opačném případě se aplikace může zablokovat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-156">Otherwise, your application might deadlock.</span></span>  
  
### <a name="message-passing"></a><span data-ttu-id="49aa9-157">Předávání zpráv</span><span class="sxs-lookup"><span data-stu-id="49aa9-157">Message Passing</span></span>  
 <span data-ttu-id="49aa9-158">Programovací model Dataflow se vztahuje na pojem *předávání zpráv*, kde nezávislé komponenty programu spolu komunikují prostřednictvím posílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="49aa9-158">The dataflow programming model is related to the concept of *message passing*, where independent components of a program communicate with one another by sending messages.</span></span> <span data-ttu-id="49aa9-159">Jedním ze způsobů, jak šířit zprávy mezi součástmi aplikace, je <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Post%2A> zavolat <xref:System.Threading.Tasks.Dataflow.DataflowBlock.SendAsync%2A?displayProperty=nameWithType> metody a pro odesílání zpráv do cílového bloku toku dat (operace <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Post%2A> funguje synchronně; <xref:System.Threading.Tasks.Dataflow.DataflowBlock.SendAsync%2A> funguje asynchronně) a <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Receive%2A> <xref:System.Threading.Tasks.Dataflow.DataflowBlock.ReceiveAsync%2A> metody, a <xref:System.Threading.Tasks.Dataflow.DataflowBlock.TryReceive%2A> pro příjem zpráv ze zdrojových bloků.</span><span class="sxs-lookup"><span data-stu-id="49aa9-159">One way to propagate messages among application components is to call the <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Post%2A> and <xref:System.Threading.Tasks.Dataflow.DataflowBlock.SendAsync%2A?displayProperty=nameWithType> methods to send messages to target dataflow blocks post (<xref:System.Threading.Tasks.Dataflow.DataflowBlock.Post%2A> acts synchronously; <xref:System.Threading.Tasks.Dataflow.DataflowBlock.SendAsync%2A> acts asynchronously) and the <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Receive%2A>, <xref:System.Threading.Tasks.Dataflow.DataflowBlock.ReceiveAsync%2A>, and <xref:System.Threading.Tasks.Dataflow.DataflowBlock.TryReceive%2A> methods to receive messages from source blocks.</span></span> <span data-ttu-id="49aa9-160">Tyto metody můžete kombinovat s kanály toku dat nebo sítěmi tím, že odesíláte vstupní data do hlavního uzlu (cílový blok) a přijímáte výstupní data z uzlu terminálu kanálu nebo uzlů terminálů sítě (jeden nebo více zdrojových bloků).</span><span class="sxs-lookup"><span data-stu-id="49aa9-160">You can combine these methods with dataflow pipelines or networks by sending input data to the head node (a target block), and receiving output data from the terminal node of the pipeline or the terminal nodes of the network (one or more source blocks).</span></span> <span data-ttu-id="49aa9-161">Můžete také použít <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Choose%2A> metodu ke čtení z první z poskytnutých zdrojů, které mají data k dispozici a k provádění akcí u těchto dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-161">You can also use the <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Choose%2A> method to read from the first of the provided sources that has data available and perform action on that data.</span></span>  
  
 <span data-ttu-id="49aa9-162">Zdrojové bloky nabízejí data do cílových bloků voláním <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="49aa9-162">Source blocks offer data to target blocks by calling the <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="49aa9-163">Cílový blok odpoví na nabízenou zprávu jedním ze tří způsobů: může přijmout zprávu, odmítnout zprávu nebo odložit zprávu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-163">The target block responds to an offered message in one of three ways: it can accept the message, decline the message, or postpone the message.</span></span> <span data-ttu-id="49aa9-164">Když cíl přijme zprávu, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> vrátí metoda <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Accepted> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-164">When the target accepts the message, the <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> method returns <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Accepted>.</span></span> <span data-ttu-id="49aa9-165">Když cíl zprávu odmítne, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> vrátí metoda <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Declined> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-165">When the target declines the message, the <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> method returns <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Declined>.</span></span> <span data-ttu-id="49aa9-166">Pokud cíl vyžaduje, aby již nepřijímal žádné zprávy ze zdroje, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> vrátí <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.DecliningPermanently> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-166">When the target requires that it no longer receives any messages from the source, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> returns <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.DecliningPermanently>.</span></span> <span data-ttu-id="49aa9-167">Předdefinované typy zdrojových bloků nenabízejí zprávy do propojených cílů po přijetí takové návratové hodnoty a automaticky odpojí z těchto cílů.</span><span class="sxs-lookup"><span data-stu-id="49aa9-167">The predefined source block types do not offer messages to linked targets after such a return value is received, and they automatically unlink from such targets.</span></span>  
  
 <span data-ttu-id="49aa9-168">Když cílový blok odloží zprávu pro pozdější použití, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> vrátí metoda <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Postponed> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-168">When a target block postpones the message for later use, the <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> method returns <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Postponed>.</span></span> <span data-ttu-id="49aa9-169">Cílový blok, který odloží zprávu, může později zavolat <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ReserveMessage%2A?displayProperty=nameWithType> metodu pro pokus o rezervaci nabízené zprávy.</span><span class="sxs-lookup"><span data-stu-id="49aa9-169">A target block that postpones a message can later call the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ReserveMessage%2A?displayProperty=nameWithType> method to try to reserve the offered message.</span></span> <span data-ttu-id="49aa9-170">V tomto okamžiku je zpráva buď stále k dispozici, a může ji použít cílovým blokem, nebo zpráva byla pořízena jiným cílem.</span><span class="sxs-lookup"><span data-stu-id="49aa9-170">At this point, the message is either still available and can be used by the target block, or the message has been taken by another target.</span></span> <span data-ttu-id="49aa9-171">Pokud cílový blok později vyžaduje zprávu nebo už zprávu nepotřebuje, volá <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ConsumeMessage%2A?displayProperty=nameWithType> metodu nebo v <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ReleaseReservation%2A> uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="49aa9-171">When the target block later requires the message or no longer needs the message, it calls the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ConsumeMessage%2A?displayProperty=nameWithType> or <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ReleaseReservation%2A> method, respectively.</span></span> <span data-ttu-id="49aa9-172">Rezervace zprávy obvykle používá typy bloků toku dat, které fungují v nehladovém režimu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-172">Message reservation is typically used by the dataflow block types that operate in non-greedy mode.</span></span> <span data-ttu-id="49aa9-173">Nehladový režim je vysvětlen dále v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-173">Non-greedy mode is explained later in this document.</span></span> <span data-ttu-id="49aa9-174">Místo zachovávání odložené zprávy může cílový blok také použít <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ConsumeMessage%2A?displayProperty=nameWithType> metodu k pokusu o přímé využití odložené zprávy.</span><span class="sxs-lookup"><span data-stu-id="49aa9-174">Instead of reserving a postponed message, a target block can also use the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ConsumeMessage%2A?displayProperty=nameWithType> method to attempt to directly consume the postponed message.</span></span>  
  
### <a name="dataflow-block-completion"></a><span data-ttu-id="49aa9-175">Dokončení bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="49aa9-175">Dataflow Block Completion</span></span>  
 <span data-ttu-id="49aa9-176">Bloky toku dat také podporují koncept *dokončení*.</span><span class="sxs-lookup"><span data-stu-id="49aa9-176">Dataflow blocks also support the concept of *completion*.</span></span> <span data-ttu-id="49aa9-177">Blok toku dat, který je v dokončeném stavu, neprovede žádnou další práci.</span><span class="sxs-lookup"><span data-stu-id="49aa9-177">A dataflow block that is in the completed state does not perform any further work.</span></span> <span data-ttu-id="49aa9-178">Každý blok toku dat má přidružený <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> objekt, který je známý jako *úkol dokončení*, který představuje stav dokončení bloku.</span><span class="sxs-lookup"><span data-stu-id="49aa9-178">Each dataflow block has an associated <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> object, known as a *completion task*, that represents the completion status of the block.</span></span> <span data-ttu-id="49aa9-179">Vzhledem k tomu, že můžete počkat na <xref:System.Threading.Tasks.Task> dokončení objektu, můžete pomocí úloh dokončení počkat na dokončení jednoho nebo více uzlů terminálů sítě toku dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-179">Because you can wait for a <xref:System.Threading.Tasks.Task> object to finish, by using completion tasks, you can wait for one or more terminal nodes of a dataflow network to finish.</span></span> <span data-ttu-id="49aa9-180"><xref:System.Threading.Tasks.Dataflow.IDataflowBlock>Rozhraní definuje <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A> metodu, která informuje blok toku dat žádosti o dokončení a <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> vlastnost, která vrátí úlohu dokončení pro blok toku dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-180">The <xref:System.Threading.Tasks.Dataflow.IDataflowBlock> interface defines the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A> method, which informs the dataflow block of a request for it to complete, and the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> property, which returns the completion task for the dataflow block.</span></span> <span data-ttu-id="49aa9-181">Obojí <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601> a <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> dědí <xref:System.Threading.Tasks.Dataflow.IDataflowBlock> rozhraní.</span><span class="sxs-lookup"><span data-stu-id="49aa9-181">Both <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601> and <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> inherit the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock> interface.</span></span>  
  
 <span data-ttu-id="49aa9-182">Existují dva způsoby, jak určit, zda byl blok toku dat dokončen bez chyb, došlo k jedné nebo více chybám nebo byl zrušen.</span><span class="sxs-lookup"><span data-stu-id="49aa9-182">There are two ways to determine whether a dataflow block completed without error, encountered one or more errors, or was canceled.</span></span> <span data-ttu-id="49aa9-183">Prvním způsobem je zavolat <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> metodu pro úkol dokončení v `try` - `catch` bloku ( `Try` - `Catch` v Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="49aa9-183">The first way is to call the <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> method on the completion task in a `try`-`catch` block (`Try`-`Catch` in Visual Basic).</span></span> <span data-ttu-id="49aa9-184">Následující příklad vytvoří <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> objekt, který vyvolá v <xref:System.ArgumentOutOfRangeException> případě, že jeho vstupní hodnota je menší než nula.</span><span class="sxs-lookup"><span data-stu-id="49aa9-184">The following example creates an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object that throws <xref:System.ArgumentOutOfRangeException> if its input value is less than zero.</span></span> <span data-ttu-id="49aa9-185"><xref:System.AggregateException>je vyvolána, když tento příklad volá <xref:System.Threading.Tasks.Task.Wait%2A> úlohu dokončení.</span><span class="sxs-lookup"><span data-stu-id="49aa9-185"><xref:System.AggregateException> is thrown when this example calls <xref:System.Threading.Tasks.Task.Wait%2A> on the completion task.</span></span> <span data-ttu-id="49aa9-186"><xref:System.ArgumentOutOfRangeException>Je k dispozici prostřednictvím <xref:System.AggregateException.InnerExceptions%2A> vlastnosti <xref:System.AggregateException> objektu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-186">The <xref:System.ArgumentOutOfRangeException> is accessed through the <xref:System.AggregateException.InnerExceptions%2A> property of the <xref:System.AggregateException> object.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#10](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#10)]
 [!code-vb[TPLDataflow_Overview#10](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#10)]  
  
 <span data-ttu-id="49aa9-187">Tento příklad ukazuje případ, ve kterém výjimka Neošetřená v delegátu pro spuštění bloku toku dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-187">This example demonstrates the case in which an exception goes unhandled in the delegate of an execution dataflow block.</span></span> <span data-ttu-id="49aa9-188">Doporučujeme zpracovávat výjimky v podvodních blocích.</span><span class="sxs-lookup"><span data-stu-id="49aa9-188">We recommend that you handle exceptions in the bodies of such blocks.</span></span> <span data-ttu-id="49aa9-189">Nicméně pokud to nemůžete udělat, blok se chová, jako by byl zrušen a nezpracovává příchozí zprávy.</span><span class="sxs-lookup"><span data-stu-id="49aa9-189">However, if you are unable to do so, the block behaves as though it was canceled and does not process incoming messages.</span></span>  
  
 <span data-ttu-id="49aa9-190">Když je blok toku dat explicitně zrušen, <xref:System.AggregateException> objekt obsahuje <xref:System.OperationCanceledException> <xref:System.AggregateException.InnerExceptions%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="49aa9-190">When a dataflow block is canceled explicitly, the <xref:System.AggregateException> object contains <xref:System.OperationCanceledException> in the <xref:System.AggregateException.InnerExceptions%2A> property.</span></span> <span data-ttu-id="49aa9-191">Další informace o zrušení toku dat najdete v části [Povolení zrušení](#enabling-cancellation) .</span><span class="sxs-lookup"><span data-stu-id="49aa9-191">For more information about dataflow cancellation, see [Enabling Cancellation](#enabling-cancellation) section.</span></span>  
  
 <span data-ttu-id="49aa9-192">Druhým způsobem, jak určit stav dokončení bloku toku dat, je použití pokračování úlohy dokončení nebo použití asynchronních funkcí jazyka C# a Visual Basic k asynchronnímu čekání na úkol dokončení.</span><span class="sxs-lookup"><span data-stu-id="49aa9-192">The second way to determine the completion status of a dataflow block is to use a continuation of the completion task, or to use the asynchronous language features of C# and Visual Basic to asynchronously wait for the completion task.</span></span> <span data-ttu-id="49aa9-193">Delegát, který zadáte do <xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=nameWithType> metody, převezme <xref:System.Threading.Tasks.Task> objekt, který představuje předchozí úlohu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-193">The delegate that you provide to the <xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=nameWithType> method takes a <xref:System.Threading.Tasks.Task> object that represents the antecedent task.</span></span> <span data-ttu-id="49aa9-194">V případě <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> vlastnosti má delegát pro pokračování vlastní úlohu dokončení.</span><span class="sxs-lookup"><span data-stu-id="49aa9-194">In the case of the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> property, the delegate for the continuation takes the completion task itself.</span></span> <span data-ttu-id="49aa9-195">Následující příklad je podobný předchozímu, s tím rozdílem, že používá také <xref:System.Threading.Tasks.Task.ContinueWith%2A> metodu k vytvoření pokračování úlohy, která vytiskne stav celkové operace toku dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-195">The following example resembles the previous one, except that it also uses the <xref:System.Threading.Tasks.Task.ContinueWith%2A> method to create a continuation task that prints the status of the overall dataflow operation.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#11](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#11)]
 [!code-vb[TPLDataflow_Overview#11](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#11)]  
  
 <span data-ttu-id="49aa9-196">Můžete také použít vlastnosti, jako <xref:System.Threading.Tasks.Task.IsCanceled%2A> je například v těle úlohy pokračování, a určit tak další informace o stavu dokončení bloku toku dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-196">You can also use properties such as <xref:System.Threading.Tasks.Task.IsCanceled%2A> in the body of the continuation task to determine additional information about the completion status of a dataflow block.</span></span> <span data-ttu-id="49aa9-197">Další informace o pokračujících úkolech a jejich vztahu ke zrušení a zpracování chyb naleznete v tématu [zřetězení úloh pomocí úloh pokračování](chaining-tasks-by-using-continuation-tasks.md), [zrušení úkolu](task-cancellation.md)a [zpracování výjimek](exception-handling-task-parallel-library.md).</span><span class="sxs-lookup"><span data-stu-id="49aa9-197">For more information about continuation tasks and how they relate to cancellation and error handling, see [Chaining Tasks by Using Continuation Tasks](chaining-tasks-by-using-continuation-tasks.md), [Task Cancellation](task-cancellation.md), and [Exception Handling](exception-handling-task-parallel-library.md).</span></span>  

## <a name="predefined-dataflow-block-types"></a><span data-ttu-id="49aa9-198">Předdefinované typy bloků toku dat</span><span class="sxs-lookup"><span data-stu-id="49aa9-198">Predefined Dataflow Block Types</span></span>  
 <span data-ttu-id="49aa9-199">Knihovna TPL Dataflow poskytuje několik předdefinovaných typů bloků toku dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-199">The TPL Dataflow Library provides several predefined dataflow block types.</span></span> <span data-ttu-id="49aa9-200">Tyto typy jsou rozděleny do tří kategorií: *bloky ukládání do vyrovnávací paměti*, *bloky spouštění*a *bloky seskupení*.</span><span class="sxs-lookup"><span data-stu-id="49aa9-200">These types are divided into three categories: *buffering blocks*, *execution blocks*, and *grouping blocks*.</span></span> <span data-ttu-id="49aa9-201">Následující části popisují typy bloků, které tvoří tyto kategorie.</span><span class="sxs-lookup"><span data-stu-id="49aa9-201">The following sections describe the block types that make up these categories.</span></span>  
  
### <a name="buffering-blocks"></a><span data-ttu-id="49aa9-202">Bloky ukládání do vyrovnávací paměti</span><span class="sxs-lookup"><span data-stu-id="49aa9-202">Buffering Blocks</span></span>  
 <span data-ttu-id="49aa9-203">Ukládání bloků do vyrovnávací paměti blokuje data, která používají příjemci dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-203">Buffering blocks hold data for use by data consumers.</span></span> <span data-ttu-id="49aa9-204">Knihovna TPL Dataflow poskytuje tři typy bloků vyrovnávací paměti: <xref:System.Threading.Tasks.Dataflow.BufferBlock%601?displayProperty=nameWithType> , <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601?displayProperty=nameWithType> a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-204">The TPL Dataflow Library provides three buffering block types: <xref:System.Threading.Tasks.Dataflow.BufferBlock%601?displayProperty=nameWithType>, <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601?displayProperty=nameWithType>, and <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601?displayProperty=nameWithType>.</span></span>  
  
#### <a name="bufferblockt"></a><span data-ttu-id="49aa9-205">BufferBlock (T)</span><span class="sxs-lookup"><span data-stu-id="49aa9-205">BufferBlock(T)</span></span>  
 <span data-ttu-id="49aa9-206"><xref:System.Threading.Tasks.Dataflow.BufferBlock%601>Třída reprezentuje strukturu asynchronního zasílání zpráv pro obecné účely.</span><span class="sxs-lookup"><span data-stu-id="49aa9-206">The <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> class represents a general-purpose asynchronous messaging structure.</span></span> <span data-ttu-id="49aa9-207">Tato třída ukládá do fronty první v, první ven (FIFO) zprávy, na které může zapisovat více zdrojů nebo číst z více cílů.</span><span class="sxs-lookup"><span data-stu-id="49aa9-207">This class stores a first in, first out (FIFO) queue of messages that can be written to by multiple sources or read from by multiple targets.</span></span> <span data-ttu-id="49aa9-208">Když cíl obdrží zprávu od <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> objektu, tato zpráva se odebere z fronty zpráv.</span><span class="sxs-lookup"><span data-stu-id="49aa9-208">When a target receives a message from a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> object, that message is removed from the message queue.</span></span> <span data-ttu-id="49aa9-209">Proto i když <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> objekt může mít více cílů, obdrží každou zprávu pouze jeden cíl.</span><span class="sxs-lookup"><span data-stu-id="49aa9-209">Therefore, although a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> object can have multiple targets, only one target will receive each message.</span></span> <span data-ttu-id="49aa9-210"><xref:System.Threading.Tasks.Dataflow.BufferBlock%601>Třída je užitečná v případě, že chcete předat více zpráv jiné komponentě a tato součást musí přijmout každou zprávu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-210">The <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> class is useful when you want to pass multiple messages to another component, and that component must receive each message.</span></span>  
  
 <span data-ttu-id="49aa9-211">Následující základní příklad účtuje několik <xref:System.Int32> hodnot <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> objektu a poté tyto hodnoty přečte z tohoto objektu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-211">The following basic example posts several <xref:System.Int32> values to a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> object and then reads those values back from that object.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#1](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#1)]
 [!code-vb[TPLDataflow_Overview#1](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#1)]  
  
 <span data-ttu-id="49aa9-212">Úplný příklad, který ukazuje, jak napsat zprávy do a číst zprávy z <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> objektu, naleznete v tématu [How to: Write Message and Read Messages from the Dataflow Block](how-to-write-messages-to-and-read-messages-from-a-dataflow-block.md).</span><span class="sxs-lookup"><span data-stu-id="49aa9-212">For a complete example that demonstrates how to write messages to and read messages from a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> object, see [How to: Write Messages to and Read Messages from a Dataflow Block](how-to-write-messages-to-and-read-messages-from-a-dataflow-block.md).</span></span>  
  
#### <a name="broadcastblockt"></a><span data-ttu-id="49aa9-213">BroadcastBlock (T)</span><span class="sxs-lookup"><span data-stu-id="49aa9-213">BroadcastBlock(T)</span></span>  
 <span data-ttu-id="49aa9-214"><xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601>Třída je užitečná v případě, že je nutné předat více zpráv jiné komponentě, ale komponenta potřebuje pouze nejnovější hodnotu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-214">The <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> class is useful when you must pass multiple messages to another component, but that component needs only the most recent value.</span></span> <span data-ttu-id="49aa9-215">Tato třída je užitečná také v případě, že chcete vysílat zprávu na více součástí.</span><span class="sxs-lookup"><span data-stu-id="49aa9-215">This class is also useful when you want to broadcast a message to multiple components.</span></span>  
  
 <span data-ttu-id="49aa9-216">Následující základní příklad účtuje <xref:System.Double> hodnotu <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> objektu a potom tuto hodnotu z tohoto objektu přečte několikrát.</span><span class="sxs-lookup"><span data-stu-id="49aa9-216">The following basic example posts a <xref:System.Double> value to a <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> object and then reads that value back from that object several times.</span></span> <span data-ttu-id="49aa9-217">Vzhledem k tomu, že hodnoty nejsou odebrány z <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> objektů po jejich čtení, je stejná hodnota vždy k dispozici.</span><span class="sxs-lookup"><span data-stu-id="49aa9-217">Because values are not removed from <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> objects after they are read, the same value is available every time.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#2](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#2)]
 [!code-vb[TPLDataflow_Overview#2](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#2)]  
  
 <span data-ttu-id="49aa9-218">Úplný příklad, který ukazuje, jak použít <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> pro vysílání zprávy do více cílových bloků, naleznete v tématu [How to: zadejte Plánovač úloh v bloku toku](how-to-specify-a-task-scheduler-in-a-dataflow-block.md)dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-218">For a complete example that demonstrates how to use <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> to broadcast a message to multiple target blocks, see [How to: Specify a Task Scheduler in a Dataflow Block](how-to-specify-a-task-scheduler-in-a-dataflow-block.md).</span></span>  
  
#### <a name="writeonceblockt"></a><span data-ttu-id="49aa9-219">WriteOnceBlock (T)</span><span class="sxs-lookup"><span data-stu-id="49aa9-219">WriteOnceBlock(T)</span></span>  
 <span data-ttu-id="49aa9-220"><xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601>Třída se podobá <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> třídě, s tím rozdílem, že <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> objekt může být zapsán pouze jednorázově.</span><span class="sxs-lookup"><span data-stu-id="49aa9-220">The <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> class resembles the <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> class, except that a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object can be written to one time only.</span></span> <span data-ttu-id="49aa9-221">Můžete si představit <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> jako podobné klíčovému slovu jazyka C# [jen](../../csharp/language-reference/keywords/readonly.md) pro[čtení (ReadOnly](../../visual-basic/language-reference/modifiers/readonly.md) v Visual Basic) s tím rozdílem, že <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> objekt se po přijetí hodnoty namísto konstrukce stala neměnné.</span><span class="sxs-lookup"><span data-stu-id="49aa9-221">You can think of <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> as being similar to the C# [readonly](../../csharp/language-reference/keywords/readonly.md) ([ReadOnly](../../visual-basic/language-reference/modifiers/readonly.md) in Visual Basic) keyword, except that a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object becomes immutable after it receives a value instead of at construction.</span></span> <span data-ttu-id="49aa9-222">Podobně jako <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> třída, když cíl obdrží zprávu z <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> objektu, není tato zpráva z tohoto objektu odebrána.</span><span class="sxs-lookup"><span data-stu-id="49aa9-222">Like the <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> class, when a target receives a message from a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object, that message is not removed from that object.</span></span> <span data-ttu-id="49aa9-223">Proto více cílů obdrží kopii zprávy.</span><span class="sxs-lookup"><span data-stu-id="49aa9-223">Therefore, multiple targets receive a copy of the message.</span></span> <span data-ttu-id="49aa9-224"><xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601>Třída je užitečná, pokud chcete rozšířit pouze první z více zpráv.</span><span class="sxs-lookup"><span data-stu-id="49aa9-224">The <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> class is useful when you want to propagate only the first of multiple messages.</span></span>  
  
 <span data-ttu-id="49aa9-225">Následující základní příklad odesílá více <xref:System.String> hodnot do <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> objektu a pak přečte hodnotu z tohoto objektu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-225">The following basic example posts multiple <xref:System.String> values to a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object and then reads the value back from that object.</span></span> <span data-ttu-id="49aa9-226">Vzhledem k tomu, že je <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> možné objekt zapsat pouze jednou, poté, co <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> objekt obdrží zprávu, zahodí následné zprávy.</span><span class="sxs-lookup"><span data-stu-id="49aa9-226">Because a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object can be written to one time only, after a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object receives a message, it discards subsequent messages.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#3](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#3)]
 [!code-vb[TPLDataflow_Overview#3](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#3)]  
  
 <span data-ttu-id="49aa9-227">Úplný příklad, který ukazuje, jak použít <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> pro příjem hodnoty první operace, která skončí, naleznete v tématu [How to: Unlink Dataflow Blocks](how-to-unlink-dataflow-blocks.md).</span><span class="sxs-lookup"><span data-stu-id="49aa9-227">For a complete example that demonstrates how to use <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> to receive the value of the first operation that finishes, see [How to: Unlink Dataflow Blocks](how-to-unlink-dataflow-blocks.md).</span></span>  
  
### <a name="execution-blocks"></a><span data-ttu-id="49aa9-228">Bloky spuštění</span><span class="sxs-lookup"><span data-stu-id="49aa9-228">Execution Blocks</span></span>  
 <span data-ttu-id="49aa9-229">Bloky spouštění volají uživatelem poskytnutý delegát pro každou část přijatých dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-229">Execution blocks call a user-provided delegate for each piece of received data.</span></span> <span data-ttu-id="49aa9-230">Knihovna TPL Dataflow poskytuje tři typy bloku spuštění: <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> , <xref:System.Threading.Tasks.Dataflow.TransformBlock%602?displayProperty=nameWithType> , a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-230">The TPL Dataflow Library provides three execution block types: <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602?displayProperty=nameWithType>, and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602?displayProperty=nameWithType>.</span></span>  
  
#### <a name="actionblockt"></a><span data-ttu-id="49aa9-231">ActionBlock (T)</span><span class="sxs-lookup"><span data-stu-id="49aa9-231">ActionBlock(T)</span></span>  
 <span data-ttu-id="49aa9-232"><xref:System.Threading.Tasks.Dataflow.ActionBlock%601>Třída je cílovým blokem, který volá delegáta při přijímání dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-232">The <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> class is a target block that calls a delegate when it receives data.</span></span> <span data-ttu-id="49aa9-233">Objekt můžete představit <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> jako delegát, který se spouští asynchronně, když budou data k dispozici.</span><span class="sxs-lookup"><span data-stu-id="49aa9-233">Think of a <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object as a delegate that runs asynchronously when data becomes available.</span></span> <span data-ttu-id="49aa9-234">Delegát, který zadáte objektu, <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> může být typu <xref:System.Action%601> nebo typu `System.Func<TInput, Task>` .</span><span class="sxs-lookup"><span data-stu-id="49aa9-234">The delegate that you provide to an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object can be of type <xref:System.Action%601> or type `System.Func<TInput, Task>`.</span></span> <span data-ttu-id="49aa9-235">Při použití <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> objektu s se <xref:System.Action%601> zpracování každého elementu vstupu je považováno za dokončené, když se delegát vrátí.</span><span class="sxs-lookup"><span data-stu-id="49aa9-235">When you use an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object with <xref:System.Action%601>, processing of each input element is considered completed when the delegate returns.</span></span> <span data-ttu-id="49aa9-236">Při použití <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> objektu se `System.Func<TInput, Task>` zpracování každého vstupního elementu je považováno za dokončené pouze v případě, že <xref:System.Threading.Tasks.Task> je vrácen objekt dokončen.</span><span class="sxs-lookup"><span data-stu-id="49aa9-236">When you use an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object with `System.Func<TInput, Task>`, processing of each input element is considered completed only when the returned <xref:System.Threading.Tasks.Task> object is completed.</span></span> <span data-ttu-id="49aa9-237">Pomocí těchto dvou mechanismů lze použít <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> pro synchronní i asynchronní zpracování každého elementu Input.</span><span class="sxs-lookup"><span data-stu-id="49aa9-237">By using these two mechanisms, you can use <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> for both synchronous and asynchronous processing of each input element.</span></span>  
  
 <span data-ttu-id="49aa9-238">Následující základní příklad odesílá více <xref:System.Int32> hodnot do <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> objektu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-238">The following basic example posts multiple <xref:System.Int32> values to an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object.</span></span> <span data-ttu-id="49aa9-239"><xref:System.Threading.Tasks.Dataflow.ActionBlock%601>Objekt vytiskne tyto hodnoty do konzoly.</span><span class="sxs-lookup"><span data-stu-id="49aa9-239">The <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object prints those values to the console.</span></span> <span data-ttu-id="49aa9-240">Tento příklad nastaví blok na stav dokončeno a počká na dokončení všech úloh toku dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-240">This example then sets the block to the completed state and waits for all dataflow tasks to finish.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#4](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#4)]
 [!code-vb[TPLDataflow_Overview#4](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#4)]  
  
 <span data-ttu-id="49aa9-241">Kompletní příklady, které demonstrují, jak používat delegáty s <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> třídou, naleznete v tématu [How to: Action, když blok toku dat přijímá data](how-to-perform-action-when-a-dataflow-block-receives-data.md).</span><span class="sxs-lookup"><span data-stu-id="49aa9-241">For complete examples that demonstrate how to use delegates with the <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> class, see [How to: Perform Action When a Dataflow Block Receives Data](how-to-perform-action-when-a-dataflow-block-receives-data.md).</span></span>  
  
#### <a name="transformblocktinput-toutput"></a><span data-ttu-id="49aa9-242">Operace TransformBlock (TInput, TOutput)</span><span class="sxs-lookup"><span data-stu-id="49aa9-242">TransformBlock(TInput, TOutput)</span></span>  
 <span data-ttu-id="49aa9-243"><xref:System.Threading.Tasks.Dataflow.TransformBlock%602>Třída se podobá <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> třídě, s tím rozdílem, že funguje jako zdroj i jako cíl.</span><span class="sxs-lookup"><span data-stu-id="49aa9-243">The <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> class resembles the <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> class, except that it acts as both a source and as a target.</span></span> <span data-ttu-id="49aa9-244">Delegát, který předáte objektu, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> vrací hodnotu typu `TOutput` .</span><span class="sxs-lookup"><span data-stu-id="49aa9-244">The delegate that you pass to a <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object returns a value of type `TOutput`.</span></span> <span data-ttu-id="49aa9-245">Delegát, který zadáte objektu, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> může být typu `System.Func<TInput, TOutput>` nebo typu `System.Func<TInput, Task<TOutput>>` .</span><span class="sxs-lookup"><span data-stu-id="49aa9-245">The delegate that you provide to a <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object can be of type `System.Func<TInput, TOutput>` or type `System.Func<TInput, Task<TOutput>>`.</span></span> <span data-ttu-id="49aa9-246">Při použití <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> objektu s se `System.Func<TInput, TOutput>` zpracování každého elementu vstupu je považováno za dokončené, když se delegát vrátí.</span><span class="sxs-lookup"><span data-stu-id="49aa9-246">When you use a <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object with `System.Func<TInput, TOutput>`, processing of each input element is considered completed when the delegate returns.</span></span> <span data-ttu-id="49aa9-247">Při použití <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> objektu používaného s `System.Func<TInput, Task<TOutput>>` je zpracování každého vstupního elementu považováno za dokončeno pouze v případě, že <xref:System.Threading.Tasks.Task%601> je vrácen objekt dokončen.</span><span class="sxs-lookup"><span data-stu-id="49aa9-247">When you use a <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object used with `System.Func<TInput, Task<TOutput>>`, processing of each input element is considered completed only when the returned <xref:System.Threading.Tasks.Task%601> object is completed.</span></span> <span data-ttu-id="49aa9-248">Stejně jako u <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> , pomocí těchto dvou mechanismů lze použít <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> pro synchronní i asynchronní zpracování každého elementu Input.</span><span class="sxs-lookup"><span data-stu-id="49aa9-248">As with <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, by using these two mechanisms, you can use <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> for both synchronous and asynchronous processing of each input element.</span></span>  
  
 <span data-ttu-id="49aa9-249">Následující základní příklad vytvoří <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> objekt, který vypočítá druhou odmocninu svého vstupu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-249">The following basic example creates a <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object that computes the square root of its input.</span></span> <span data-ttu-id="49aa9-250"><xref:System.Threading.Tasks.Dataflow.TransformBlock%602>Objekt přebírá <xref:System.Int32> hodnoty jako vstup a vytváří <xref:System.Double> hodnoty jako výstup.</span><span class="sxs-lookup"><span data-stu-id="49aa9-250">The <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object takes <xref:System.Int32> values as input and produces <xref:System.Double> values as output.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#5](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#5)]
 [!code-vb[TPLDataflow_Overview#5](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#5)]  
  
 <span data-ttu-id="49aa9-251">Kompletní příklady, které používá <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> v síti bloků toku dat, který provádí zpracování imagí v model Windows Forms aplikaci, najdete v tématu [Návod: použití toku dat v aplikaci model Windows Forms](walkthrough-using-dataflow-in-a-windows-forms-application.md).</span><span class="sxs-lookup"><span data-stu-id="49aa9-251">For complete examples that uses <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> in a network of dataflow blocks that performs image processing in a Windows Forms application, see [Walkthrough: Using Dataflow in a Windows Forms Application](walkthrough-using-dataflow-in-a-windows-forms-application.md).</span></span>  
  
#### <a name="transformmanyblocktinput-toutput"></a><span data-ttu-id="49aa9-252">TransformManyBlock(TInput, TOutput)</span><span class="sxs-lookup"><span data-stu-id="49aa9-252">TransformManyBlock(TInput, TOutput)</span></span>  
 <span data-ttu-id="49aa9-253"><xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>Třída se podobá <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> třídě, s tím rozdílem, že pro každou vstupní hodnotu <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> vytvoří nula nebo více výstupních hodnot namísto jedné výstupní hodnoty pro každou vstupní hodnotu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-253">The <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> class resembles the <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> class, except that <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> produces zero or more output values for each input value, instead of only one output value for each input value.</span></span> <span data-ttu-id="49aa9-254">Delegát, který zadáte objektu, <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> může být typu `System.Func<TInput, IEnumerable<TOutput>>` nebo typu `System.Func<TInput, Task<IEnumerable<TOutput>>>` .</span><span class="sxs-lookup"><span data-stu-id="49aa9-254">The delegate that you provide to a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object can be of type `System.Func<TInput, IEnumerable<TOutput>>` or type `System.Func<TInput, Task<IEnumerable<TOutput>>>`.</span></span> <span data-ttu-id="49aa9-255">Při použití <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> objektu s se `System.Func<TInput, IEnumerable<TOutput>>` zpracování každého elementu vstupu je považováno za dokončené, když se delegát vrátí.</span><span class="sxs-lookup"><span data-stu-id="49aa9-255">When you use a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object with `System.Func<TInput, IEnumerable<TOutput>>`, processing of each input element is considered completed when the delegate returns.</span></span> <span data-ttu-id="49aa9-256">Při použití <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> objektu se `System.Func<TInput, Task<IEnumerable<TOutput>>>` zpracování každého vstupního elementu je považováno za kompletní pouze v případě, že `System.Threading.Tasks.Task<IEnumerable<TOutput>>` je vrácen objekt dokončen.</span><span class="sxs-lookup"><span data-stu-id="49aa9-256">When you use a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object with `System.Func<TInput, Task<IEnumerable<TOutput>>>`, processing of each input element is considered complete only when the returned `System.Threading.Tasks.Task<IEnumerable<TOutput>>` object is completed.</span></span>  
  
 <span data-ttu-id="49aa9-257">Následující základní příklad vytvoří <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> objekt, který rozdělí řetězce do jejich jednotlivých znakových sekvencí.</span><span class="sxs-lookup"><span data-stu-id="49aa9-257">The following basic example creates a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object that splits strings into their individual character sequences.</span></span> <span data-ttu-id="49aa9-258"><xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>Objekt přebírá <xref:System.String> hodnoty jako vstup a vytváří <xref:System.Char> hodnoty jako výstup.</span><span class="sxs-lookup"><span data-stu-id="49aa9-258">The <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object takes <xref:System.String> values as input and produces <xref:System.Char> values as output.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#6](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#6)]
 [!code-vb[TPLDataflow_Overview#6](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#6)]  
  
 <span data-ttu-id="49aa9-259">Kompletní příklady, které slouží <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> k vytvoření více nezávislých výstupů pro každý vstup v kanálu toku dat, naleznete v tématu [Návod: vytvoření kanálu toku](walkthrough-creating-a-dataflow-pipeline.md)dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-259">For complete examples that use <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> to produce multiple independent outputs for each input in a dataflow pipeline, see [Walkthrough: Creating a Dataflow Pipeline](walkthrough-creating-a-dataflow-pipeline.md).</span></span>  
  
#### <a name="degree-of-parallelism"></a><span data-ttu-id="49aa9-260">Stupeň paralelismu</span><span class="sxs-lookup"><span data-stu-id="49aa9-260">Degree of Parallelism</span></span>  
 <span data-ttu-id="49aa9-261">Každý <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> objekt, a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> ukládá do vyrovnávací paměti vstupní zprávy, dokud je blok připravený na jejich zpracování.</span><span class="sxs-lookup"><span data-stu-id="49aa9-261">Every <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>, and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object buffers input messages until the block is ready to process them.</span></span> <span data-ttu-id="49aa9-262">Ve výchozím nastavení tyto třídy zpracovávají zprávy v pořadí, ve kterém jsou přijímány, vždy jedna zpráva.</span><span class="sxs-lookup"><span data-stu-id="49aa9-262">By default, these classes process messages in the order in which they are received, one message at a time.</span></span> <span data-ttu-id="49aa9-263">Můžete také určit míru paralelismu, které mají být povoleny <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> , <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> a objekty pro souběžné <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> zpracování více zpráv.</span><span class="sxs-lookup"><span data-stu-id="49aa9-263">You can also specify the degree of parallelism to enable <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> objects to process multiple messages concurrently.</span></span> <span data-ttu-id="49aa9-264">Další informace o souběžném spuštění najdete v části určení stupně paralelismu v níže v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-264">For more information about concurrent execution, see the section Specifying the Degree of Parallelism later in this document.</span></span> <span data-ttu-id="49aa9-265">Příklad, který nastaví míru paralelismus pro povolení bloku toku dat spouštění pro zpracování více než jedné zprávy najednou, naleznete v tématu [How to: set a stupně paralelismus v bloku toku](how-to-specify-the-degree-of-parallelism-in-a-dataflow-block.md)dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-265">For an example that sets the degree of parallelism to enable an execution dataflow block to process more than one message at a time, see [How to: Specify the Degree of Parallelism in a Dataflow Block](how-to-specify-the-degree-of-parallelism-in-a-dataflow-block.md).</span></span>  
  
#### <a name="summary-of-delegate-types"></a><span data-ttu-id="49aa9-266">Souhrn typů delegátů</span><span class="sxs-lookup"><span data-stu-id="49aa9-266">Summary of Delegate Types</span></span>  
 <span data-ttu-id="49aa9-267">Následující tabulka shrnuje typy delegátů, které lze poskytnout <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> objektům, a.</span><span class="sxs-lookup"><span data-stu-id="49aa9-267">The following table summarizes the delegate types that you can provide to <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>, and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> objects.</span></span> <span data-ttu-id="49aa9-268">Tato tabulka také určuje, zda typ delegáta funguje synchronně nebo asynchronně.</span><span class="sxs-lookup"><span data-stu-id="49aa9-268">This table also specifies whether the delegate type operates synchronously or asynchronously.</span></span>  
  
|<span data-ttu-id="49aa9-269">Typ</span><span class="sxs-lookup"><span data-stu-id="49aa9-269">Type</span></span>|<span data-ttu-id="49aa9-270">Typ synchronního delegáta</span><span class="sxs-lookup"><span data-stu-id="49aa9-270">Synchronous Delegate Type</span></span>|<span data-ttu-id="49aa9-271">Typ asynchronního delegáta</span><span class="sxs-lookup"><span data-stu-id="49aa9-271">Asynchronous Delegate Type</span></span>|  
|----------|-------------------------------|--------------------------------|  
|<xref:System.Threading.Tasks.Dataflow.ActionBlock%601>|`System.Action`|`System.Func<TInput, Task>`|  
|<xref:System.Threading.Tasks.Dataflow.TransformBlock%602>|`System.Func<TInput, TOutput>`|`System.Func<TInput, Task<TOutput>>`|  
|<xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>|`System.Func<TInput, IEnumerable<TOutput>>`|`System.Func<TInput, Task<IEnumerable<TOutput>>>`|  
  
 <span data-ttu-id="49aa9-272">Lambda výrazy můžete použít také při práci s typy bloku spuštění.</span><span class="sxs-lookup"><span data-stu-id="49aa9-272">You can also use lambda expressions when you work with execution block types.</span></span> <span data-ttu-id="49aa9-273">Příklad, který ukazuje, jak použít výraz lambda s blokem spuštění, naleznete v tématu [How to: Action, když blok toku dat přijímá data](how-to-perform-action-when-a-dataflow-block-receives-data.md).</span><span class="sxs-lookup"><span data-stu-id="49aa9-273">For an example that shows how to use a lambda expression with an execution block, see [How to: Perform Action When a Dataflow Block Receives Data](how-to-perform-action-when-a-dataflow-block-receives-data.md).</span></span>  
  
### <a name="grouping-blocks"></a><span data-ttu-id="49aa9-274">Bloky seskupení</span><span class="sxs-lookup"><span data-stu-id="49aa9-274">Grouping Blocks</span></span>  
 <span data-ttu-id="49aa9-275">Bloky seskupení seskupují data z jednoho nebo více zdrojů a v různých omezeních.</span><span class="sxs-lookup"><span data-stu-id="49aa9-275">Grouping blocks combine data from one or more sources and under various constraints.</span></span> <span data-ttu-id="49aa9-276">Knihovna TPL Dataflow poskytuje tři typy bloku spojení: <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> , <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> a <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-276">The TPL Dataflow Library provides three join block types: <xref:System.Threading.Tasks.Dataflow.BatchBlock%601>, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602>, and <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602>.</span></span>  
  
#### <a name="batchblockt"></a><span data-ttu-id="49aa9-277">Tříd BatchBlock (T)</span><span class="sxs-lookup"><span data-stu-id="49aa9-277">BatchBlock(T)</span></span>  
 <span data-ttu-id="49aa9-278"><xref:System.Threading.Tasks.Dataflow.BatchBlock%601>Třída kombinuje sady vstupních dat, která se označují jako dávky, do polí výstupních dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-278">The <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> class combines sets of input data, which are known as batches, into arrays of output data.</span></span> <span data-ttu-id="49aa9-279">Velikost každé dávky určíte při vytváření <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> objektu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-279">You specify the size of each batch when you create a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object.</span></span> <span data-ttu-id="49aa9-280">Když <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> objekt obdrží zadaný počet vstupních prvků, asynchronně rozšíří pole, které obsahuje tyto prvky.</span><span class="sxs-lookup"><span data-stu-id="49aa9-280">When the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object receives the specified count of input elements, it asynchronously propagates out an array that contains those elements.</span></span> <span data-ttu-id="49aa9-281">Pokud <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> je objekt nastavený na stav dokončeno, ale neobsahuje dostatek prvků pro vytvoření dávky, rozšíří konečné pole, které obsahuje zbývající vstupní prvky.</span><span class="sxs-lookup"><span data-stu-id="49aa9-281">If a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object is set to the completed state but does not contain enough elements to form a batch, it propagates out a final array that contains the remaining input elements.</span></span>  
  
 <span data-ttu-id="49aa9-282"><xref:System.Threading.Tasks.Dataflow.BatchBlock%601>Třída funguje buď v *hladovém* , nebo *nehladovém* režimu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-282">The <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> class operates in either *greedy* or *non-greedy* mode.</span></span> <span data-ttu-id="49aa9-283">V režimu hladce, který je výchozí hodnota, <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> objekt akceptuje každou zprávu, že je nabízena a šíří pole po přijetí zadaného počtu prvků.</span><span class="sxs-lookup"><span data-stu-id="49aa9-283">In greedy mode, which is the default, a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object accepts every message that it is offered and propagates out an array after it receives the specified count of elements.</span></span> <span data-ttu-id="49aa9-284">V nehladovém režimu <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> objekt odloží všechny příchozí zprávy, dokud dostatek zdrojů nenabídly do bloku zprávy, aby mohl vytvořit dávku.</span><span class="sxs-lookup"><span data-stu-id="49aa9-284">In non-greedy mode, a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object postpones all incoming messages until enough sources have offered messages to the block to form a batch.</span></span> <span data-ttu-id="49aa9-285">Hladový režim obvykle provádí lepší režim než hladec, protože vyžaduje méně režijních nákladů na zpracování.</span><span class="sxs-lookup"><span data-stu-id="49aa9-285">Greedy mode typically performs better than non-greedy mode because it requires less processing overhead.</span></span> <span data-ttu-id="49aa9-286">Nehladý režim však můžete použít v případě, že je nutné sjednotit spotřebu z více zdrojů atomicky.</span><span class="sxs-lookup"><span data-stu-id="49aa9-286">However, you can use non-greedy mode when you must coordinate consumption from multiple sources in an atomic fashion.</span></span> <span data-ttu-id="49aa9-287">Určete Nehladový režim nastavením <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> na `False` v `dataflowBlockOptions` parametru v <xref:System.Threading.Tasks.Dataflow.BatchBlock%601.%23ctor%2A> konstruktoru.</span><span class="sxs-lookup"><span data-stu-id="49aa9-287">Specify non-greedy mode by setting <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> to `False` in the `dataflowBlockOptions` parameter in the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601.%23ctor%2A> constructor.</span></span>  
  
 <span data-ttu-id="49aa9-288">Následující základní příklad účtuje několik <xref:System.Int32> hodnot do <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> objektu, který obsahuje deset prvků v dávce.</span><span class="sxs-lookup"><span data-stu-id="49aa9-288">The following basic example posts several <xref:System.Int32> values to a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object that holds ten elements in a batch.</span></span> <span data-ttu-id="49aa9-289">Aby bylo zaručeno, že všechny hodnoty šíří mimo <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> , tento příklad volá <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A> metodu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-289">To guarantee that all values propagate out of the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601>, this example calls the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A> method.</span></span> <span data-ttu-id="49aa9-290"><xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A>Metoda nastaví <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> objekt na stav dokončeno, a proto <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> objekt rozšíří všechny zbývající prvky jako finální dávku.</span><span class="sxs-lookup"><span data-stu-id="49aa9-290">The <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A> method sets the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object to the completed state, and therefore, the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object propagates out any remaining elements as a final batch.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#7](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#7)]
 [!code-vb[TPLDataflow_Overview#7](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#7)]  
  
 <span data-ttu-id="49aa9-291">Kompletní příklad, který používá <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> ke zlepšení efektivity operací vložení databáze, najdete v tématu [Návod: použití tříd BatchBlock a BatchedJoinBlock ke zvýšení efektivity](walkthrough-using-batchblock-and-batchedjoinblock-to-improve-efficiency.md).</span><span class="sxs-lookup"><span data-stu-id="49aa9-291">For a complete example that uses <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> to improve the efficiency of database insert operations, see [Walkthrough: Using BatchBlock and BatchedJoinBlock to Improve Efficiency](walkthrough-using-batchblock-and-batchedjoinblock-to-improve-efficiency.md).</span></span>  
  
#### <a name="joinblockt1-t2-"></a><span data-ttu-id="49aa9-292">JoinBlock (T1, T2,...)</span><span class="sxs-lookup"><span data-stu-id="49aa9-292">JoinBlock(T1, T2, ...)</span></span>  
 <span data-ttu-id="49aa9-293"><xref:System.Threading.Tasks.Dataflow.JoinBlock%602>Třídy a <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> shromažďují vstupní prvky a šíří <xref:System.Tuple%602?displayProperty=nameWithType> <xref:System.Tuple%603?displayProperty=nameWithType> objekty, které obsahují tyto prvky.</span><span class="sxs-lookup"><span data-stu-id="49aa9-293">The <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> and <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> classes collect input elements and propagate out <xref:System.Tuple%602?displayProperty=nameWithType> or <xref:System.Tuple%603?displayProperty=nameWithType> objects that contain those elements.</span></span> <span data-ttu-id="49aa9-294"><xref:System.Threading.Tasks.Dataflow.JoinBlock%602>Třídy a <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> nedědí z <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-294">The <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> and <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> classes do not inherit from <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span></span> <span data-ttu-id="49aa9-295">Místo toho poskytují vlastnosti,, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602.Target1%2A> <xref:System.Threading.Tasks.Dataflow.JoinBlock%602.Target2%2A> a, <xref:System.Threading.Tasks.Dataflow.JoinBlock%603.Target3%2A> které implementují <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-295">Instead, they provide properties, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602.Target1%2A>, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602.Target2%2A>, and <xref:System.Threading.Tasks.Dataflow.JoinBlock%603.Target3%2A>, that implement <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span></span>  
  
 <span data-ttu-id="49aa9-296">Podobně <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> jako <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> a <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> funguje v hladovém nebo nehladovém režimu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-296">Like <xref:System.Threading.Tasks.Dataflow.BatchBlock%601>, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> and <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> operate in either greedy or non-greedy mode.</span></span> <span data-ttu-id="49aa9-297">V režimu hladce, což je výchozí hodnota, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> objekt nebo přijímá všechny zprávy, které jsou nabízeny, a šíří řazenou kolekci členů po každém z jeho cílů obdrží alespoň jednu zprávu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-297">In greedy mode, which is the default, a <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> or <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> object accepts every message that it is offered and propagates out a tuple after each of its targets receives at least one message.</span></span> <span data-ttu-id="49aa9-298">V nehladovém režimu <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> objekt nebo odloží všechny příchozí zprávy, dokud nebudou všechny cíle nabídnuty na data potřebná k vytvoření řazené kolekce členů.</span><span class="sxs-lookup"><span data-stu-id="49aa9-298">In non-greedy mode, a <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> or <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> object postpones all incoming messages until all targets have been offered the data that is required to create a tuple.</span></span> <span data-ttu-id="49aa9-299">V tomto okamžiku se zablokuje pomocí dvoufázového potvrzovacího protokolu, aby byly atomicky načteny všechny požadované položky ze zdrojů.</span><span class="sxs-lookup"><span data-stu-id="49aa9-299">At this point, the block engages in a two-phase commit protocol to atomically retrieve all required items from the sources.</span></span> <span data-ttu-id="49aa9-300">Díky tomuto odložení je možné, že by jiná entita mohla data během této doby spotřebovat, aby celkový systém mohl předávat pokrok.</span><span class="sxs-lookup"><span data-stu-id="49aa9-300">This postponement makes it possible for another entity to consume the data in the meantime, to allow the overall system to make forward progress.</span></span>  
  
 <span data-ttu-id="49aa9-301">Následující základní příklad ukazuje případ, ve kterém <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> objekt vyžaduje více dat pro výpočet hodnoty.</span><span class="sxs-lookup"><span data-stu-id="49aa9-301">The following basic example demonstrates a case in which a <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> object requires multiple data to compute a value.</span></span> <span data-ttu-id="49aa9-302">Tento příklad vytvoří <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> objekt, který vyžaduje dvě <xref:System.Int32> hodnoty a <xref:System.Char> hodnotu k provedení aritmetické operace.</span><span class="sxs-lookup"><span data-stu-id="49aa9-302">This example creates a <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> object that requires two <xref:System.Int32> values and a <xref:System.Char> value to perform an arithmetic operation.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#8](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#8)]
 [!code-vb[TPLDataflow_Overview#8](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#8)]  
  
 <span data-ttu-id="49aa9-303">Úplný příklad, který používá <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> objekty v nehladovém režimu pro kooperativní sdílení prostředku, naleznete v tématu [How to: use JoinBlock ke čtení dat z více zdrojů](how-to-use-joinblock-to-read-data-from-multiple-sources.md).</span><span class="sxs-lookup"><span data-stu-id="49aa9-303">For a complete example that uses <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> objects in non-greedy mode to cooperatively share a resource, see [How to: Use JoinBlock to Read Data From Multiple Sources](how-to-use-joinblock-to-read-data-from-multiple-sources.md).</span></span>  
  
#### <a name="batchedjoinblockt1-t2-"></a><span data-ttu-id="49aa9-304">BatchedJoinBlock (T1, T2,...)</span><span class="sxs-lookup"><span data-stu-id="49aa9-304">BatchedJoinBlock(T1, T2, ...)</span></span>  
 <span data-ttu-id="49aa9-305"><xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602>Třídy a <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%603> shromažďují dávky vstupních prvků a šíří `System.Tuple(IList(T1), IList(T2))` `System.Tuple(IList(T1), IList(T2), IList(T3))` objekty, které obsahují tyto prvky.</span><span class="sxs-lookup"><span data-stu-id="49aa9-305">The <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> and <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%603> classes collect batches of input elements and propagate out `System.Tuple(IList(T1), IList(T2))` or `System.Tuple(IList(T1), IList(T2), IList(T3))` objects that contain those elements.</span></span> <span data-ttu-id="49aa9-306">Můžete si představit <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> jako kombinaci <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> a <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-306">Think of <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> as a combination of <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> and <xref:System.Threading.Tasks.Dataflow.JoinBlock%602>.</span></span> <span data-ttu-id="49aa9-307">Určete velikost každé dávky při vytváření <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> objektu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-307">Specify the size of each batch when you create a <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> object.</span></span> <span data-ttu-id="49aa9-308"><xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602>poskytuje také vlastnosti, <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target1%2A> a, <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target2%2A> které implementují <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-308"><xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> also provides properties, <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target1%2A> and <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target2%2A>, that implement <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span></span> <span data-ttu-id="49aa9-309">Při přijetí zadaného počtu vstupních prvků ze všech cílů <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> objekt asynchronně šíří `System.Tuple(IList(T1), IList(T2))` objekt, který obsahuje tyto prvky.</span><span class="sxs-lookup"><span data-stu-id="49aa9-309">When the specified count of input elements are received from across all targets, the <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> object asynchronously propagates out a `System.Tuple(IList(T1), IList(T2))` object that contains those elements.</span></span>  
  
 <span data-ttu-id="49aa9-310">Následující základní příklad vytvoří <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> objekt, který obsahuje výsledky, <xref:System.Int32> hodnoty a chyby, které jsou <xref:System.Exception> objekty.</span><span class="sxs-lookup"><span data-stu-id="49aa9-310">The following basic example creates a <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> object that holds results, <xref:System.Int32> values, and errors that are <xref:System.Exception> objects.</span></span> <span data-ttu-id="49aa9-311">Tento příklad provede více operací a zapisuje výsledky do <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target1%2A> vlastnosti a chyby <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target2%2A> <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> objektu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-311">This example performs multiple operations and writes results to the <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target1%2A> property, and errors to the <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target2%2A> property, of the <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> object.</span></span> <span data-ttu-id="49aa9-312">Vzhledem k tomu, že počet úspěšných a neúspěšných operací je předem neznámý, <xref:System.Collections.Generic.IList%601> objekty umožňují, aby každý cíl přijímal nula nebo více hodnot.</span><span class="sxs-lookup"><span data-stu-id="49aa9-312">Because the count of successful and failed operations is unknown in advance, the <xref:System.Collections.Generic.IList%601> objects enable each target to receive zero or more values.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#9](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#9)]
 [!code-vb[TPLDataflow_Overview#9](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#9)]  
  
 <span data-ttu-id="49aa9-313">Kompletní příklad, který používá <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> k zachycení výsledků a všech výjimek, ke kterým dojde, když program čte z databáze, najdete v tématu [Návod: použití tříd BatchBlock a BatchedJoinBlock ke zvýšení efektivity](walkthrough-using-batchblock-and-batchedjoinblock-to-improve-efficiency.md).</span><span class="sxs-lookup"><span data-stu-id="49aa9-313">For a complete example that uses <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> to capture both the results and any exceptions that occur while the program reads from a database, see [Walkthrough: Using BatchBlock and BatchedJoinBlock to Improve Efficiency](walkthrough-using-batchblock-and-batchedjoinblock-to-improve-efficiency.md).</span></span>  

## <a name="configuring-dataflow--block-behavior"></a><span data-ttu-id="49aa9-314">Konfigurace chování bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="49aa9-314">Configuring Dataflow  Block Behavior</span></span>  
 <span data-ttu-id="49aa9-315">Můžete povolit další možnosti poskytnutím <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions?displayProperty=nameWithType> objektu konstruktoru typu bloku toku dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-315">You can enable additional options by providing a <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions?displayProperty=nameWithType> object to the constructor of dataflow block types.</span></span> <span data-ttu-id="49aa9-316">Tyto možnosti řídí chování, jako je Plánovač, který spravuje základní úlohu a stupeň paralelismu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-316">These options control behavior such the scheduler that manages the underlying task and the degree of parallelism.</span></span> <span data-ttu-id="49aa9-317"><xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions>Má také odvozené typy, které určují chování, které je specifické pro určité typy bloků toku dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-317">The <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions> also has derived types that specify behavior that is specific to certain dataflow block types.</span></span> <span data-ttu-id="49aa9-318">Následující tabulka shrnuje, které typy možností jsou spojené s každým typem bloku toku dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-318">The following table summarizes which options type is associated with each dataflow block type.</span></span>  
  
|<span data-ttu-id="49aa9-319">Typ bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="49aa9-319">Dataflow Block Type</span></span>|<span data-ttu-id="49aa9-320"><xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions>textový</span><span class="sxs-lookup"><span data-stu-id="49aa9-320"><xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions> type</span></span>|  
|-------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|  
|<xref:System.Threading.Tasks.Dataflow.BufferBlock%601>|<xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601>|<xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601>|<xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.ActionBlock%601>|<xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.TransformBlock%602>|<xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>|<xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.BatchBlock%601>|<xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.JoinBlock%602>|<xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602>|<xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions>|  
  
 <span data-ttu-id="49aa9-321">Následující části poskytují další informace o důležitých typech možností bloku toku dat, které jsou k dispozici prostřednictvím <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions?displayProperty=nameWithType> tříd, <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions?displayProperty=nameWithType> a <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-321">The following sections provide additional information about the important kinds of dataflow block options that are available through the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions?displayProperty=nameWithType>, <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions?displayProperty=nameWithType>, and <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions?displayProperty=nameWithType> classes.</span></span>  
  
### <a name="specifying-the-task-scheduler"></a><span data-ttu-id="49aa9-322">Určení Plánovač úloh</span><span class="sxs-lookup"><span data-stu-id="49aa9-322">Specifying the Task Scheduler</span></span>  
 <span data-ttu-id="49aa9-323">Každý předdefinovaný blok toku dat používá mechanizmus plánování úloh TPL k provádění aktivit, jako je například šíření dat do cíle, příjem dat ze zdroje a spuštění uživatelem definovaných delegátů, když budou data k dispozici.</span><span class="sxs-lookup"><span data-stu-id="49aa9-323">Every predefined dataflow block uses the TPL task scheduling mechanism to perform activities such as propagating data to a target, receiving data from a source, and running user-defined delegates when data becomes available.</span></span> <span data-ttu-id="49aa9-324"><xref:System.Threading.Tasks.TaskScheduler>je abstraktní třída, která představuje Plánovač úloh, který zařadí do fronty úlohy na vlákna.</span><span class="sxs-lookup"><span data-stu-id="49aa9-324"><xref:System.Threading.Tasks.TaskScheduler> is an abstract class that represents a task scheduler that queues tasks onto threads.</span></span> <span data-ttu-id="49aa9-325">Výchozí Plánovač úloh <xref:System.Threading.Tasks.TaskScheduler.Default%2A> používá <xref:System.Threading.ThreadPool> třídu k zařazení do fronty a provedení práce.</span><span class="sxs-lookup"><span data-stu-id="49aa9-325">The default task scheduler, <xref:System.Threading.Tasks.TaskScheduler.Default%2A>, uses the <xref:System.Threading.ThreadPool> class to queue and execute work.</span></span> <span data-ttu-id="49aa9-326">Výchozí Plánovač úloh můžete přepsat nastavením <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.TaskScheduler%2A> vlastnosti při vytváření objektu bloku toku dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-326">You can override the default task scheduler by setting the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.TaskScheduler%2A> property when you construct a dataflow block object.</span></span>  
  
 <span data-ttu-id="49aa9-327">Když stejný Plánovač úloh spravuje více bloků toku dat, může v nich vyhovět zásadám.</span><span class="sxs-lookup"><span data-stu-id="49aa9-327">When the same task scheduler manages multiple dataflow blocks, it can enforce policies across them.</span></span> <span data-ttu-id="49aa9-328">Například pokud jsou jednotlivé bloky toku dat nakonfigurovány tak, aby cílí na výhradní Plánovač stejného <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> objektu, bude serializována veškerá práce, která běží v těchto blocích.</span><span class="sxs-lookup"><span data-stu-id="49aa9-328">For example, if multiple dataflow blocks are each configured to target the exclusive scheduler of the same <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> object, all work that runs across these blocks is serialized.</span></span> <span data-ttu-id="49aa9-329">Podobně platí, že pokud jsou tyto bloky nakonfigurovány tak, aby cílí na souběžný Plánovač stejného <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> objektu a že je tento Plánovač nakonfigurovaný tak, aby měl maximální úroveň souběžnosti, všechny práce z těchto bloků budou omezeny na tento počet souběžných operací.</span><span class="sxs-lookup"><span data-stu-id="49aa9-329">Similarly, if these blocks are configured to target the concurrent scheduler of the same <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> object, and that scheduler is configured to have a maximum concurrency level, all work from these blocks is limited to that number of concurrent operations.</span></span> <span data-ttu-id="49aa9-330">Příklad, který používá <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> třídu k umožnění operací čtení paralelně, ale operace zápisu mají být provedeny výhradně pro všechny ostatní operace, naleznete v tématu [How to: zadejte Plánovač úloh v bloku toku](how-to-specify-a-task-scheduler-in-a-dataflow-block.md)dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-330">For an example that uses the <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> class to enable read operations to occur in parallel, but write operations to occur exclusively of all other operations, see [How to: Specify a Task Scheduler in a Dataflow Block](how-to-specify-a-task-scheduler-in-a-dataflow-block.md).</span></span> <span data-ttu-id="49aa9-331">Další informace o Plánovači úloh v TPL naleznete v <xref:System.Threading.Tasks.TaskScheduler> tématu třídy.</span><span class="sxs-lookup"><span data-stu-id="49aa9-331">For more information about task schedulers in the TPL, see the <xref:System.Threading.Tasks.TaskScheduler> class topic.</span></span>  
  
### <a name="specifying-the-degree-of-parallelism"></a><span data-ttu-id="49aa9-332">Určení stupně paralelismu</span><span class="sxs-lookup"><span data-stu-id="49aa9-332">Specifying the Degree of Parallelism</span></span>  
 <span data-ttu-id="49aa9-333">Ve výchozím nastavení tři typy bloku spuštění, které poskytuje knihovna toku dat TPL, <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> , <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> zpracovávají jednu zprávu v jednom okamžiku.</span><span class="sxs-lookup"><span data-stu-id="49aa9-333">By default, the three execution block types that the TPL Dataflow Library provides, <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>, and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>, process one message at a time.</span></span> <span data-ttu-id="49aa9-334">Tyto typy bloků toku dat také zpracovávají zprávy v pořadí, ve kterém jsou přijaty.</span><span class="sxs-lookup"><span data-stu-id="49aa9-334">These dataflow block types also process messages in the order in which they are received.</span></span> <span data-ttu-id="49aa9-335">Chcete-li těmto blokům toku dat Povolit souběžné zpracování zpráv, nastavte <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A?displayProperty=nameWithType> vlastnost při vytváření objektu bloku toku dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-335">To enable these dataflow blocks to process messages concurrently, set the <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A?displayProperty=nameWithType> property when you construct the dataflow block object.</span></span>  
  
 <span data-ttu-id="49aa9-336">Výchozí hodnota <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> je 1, což zaručuje, že blok toku dat zpracuje jednu zprávu současně.</span><span class="sxs-lookup"><span data-stu-id="49aa9-336">The default value of <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> is 1, which guarantees that the dataflow block processes one message at a time.</span></span> <span data-ttu-id="49aa9-337">Když nastavíte tuto vlastnost na hodnotu, která je větší než 1, povolí blok toku dat souběžně zpracovávat více zpráv.</span><span class="sxs-lookup"><span data-stu-id="49aa9-337">Setting this property to a value that is larger than 1 enables the dataflow block to process multiple messages concurrently.</span></span> <span data-ttu-id="49aa9-338">Nastavením této vlastnosti <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded?displayProperty=nameWithType> umožníte základnímu Plánovači úloh spravovat maximální stupeň souběžnosti.</span><span class="sxs-lookup"><span data-stu-id="49aa9-338">Setting this property to <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded?displayProperty=nameWithType> enables the underlying task scheduler to manage the maximum degree of concurrency.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="49aa9-339">Když zadáte maximální stupeň paralelismu, který je větší než 1, zpracovává se souběžně několik zpráv, takže zprávy nemusejí být zpracovány v pořadí, ve kterém byly přijaty.</span><span class="sxs-lookup"><span data-stu-id="49aa9-339">When you specify a maximum degree of parallelism that is larger than 1, multiple messages are processed simultaneously, and therefore messages might not be processed in the order in which they are received.</span></span> <span data-ttu-id="49aa9-340">Pořadí, ve kterém jsou zprávy výstupem z bloku, je však stejné jako v tom, v jakém byly přijaty.</span><span class="sxs-lookup"><span data-stu-id="49aa9-340">The order in which the messages are output from the block is, however, the same one in which they are received.</span></span>  
  
 <span data-ttu-id="49aa9-341">Vzhledem k tomu, že <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> vlastnost představuje maximální stupeň paralelismu, může být blok toku dat proveden s menším stupněm paralelismu, než určíte.</span><span class="sxs-lookup"><span data-stu-id="49aa9-341">Because the <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> property represents the maximum degree of parallelism, the dataflow block might execute with a lesser degree of parallelism than you specify.</span></span> <span data-ttu-id="49aa9-342">Blok toku dat může používat menší stupeň paralelismu k splnění jeho funkčních požadavků nebo nedostatku dostupných systémových prostředků.</span><span class="sxs-lookup"><span data-stu-id="49aa9-342">The dataflow block might use a lesser degree of parallelism to meet its functional requirements or because there is a lack of available system resources.</span></span> <span data-ttu-id="49aa9-343">Blok toku dat nikdy nevolí více paralelismu, než zadáte.</span><span class="sxs-lookup"><span data-stu-id="49aa9-343">A dataflow block never chooses more parallelism than you specify.</span></span>  
  
 <span data-ttu-id="49aa9-344">Hodnota <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> vlastnosti je exkluzivní pro každý objekt bloku toku dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-344">The value of the <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> property is exclusive to each dataflow block object.</span></span> <span data-ttu-id="49aa9-345">Pokud například čtyři objekty bloku Dataflow každý určí 1 pro maximální stupeň paralelismu, mohou být všechny čtyři objekty bloku toku dat potenciálně spouštěny paralelně.</span><span class="sxs-lookup"><span data-stu-id="49aa9-345">For example, if four dataflow block objects each specify 1 for the maximum degree of parallelism, all four dataflow block objects can potentially run in parallel.</span></span>  
  
 <span data-ttu-id="49aa9-346">Příklad, který nastaví maximální stupeň paralelismu na paralelní výskyt operací, naleznete v tématu [How to: set a stupně paralelismus v bloku toku](how-to-specify-the-degree-of-parallelism-in-a-dataflow-block.md)dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-346">For an example that sets the maximum degree of parallelism to enable lengthy operations to occur in parallel, see [How to: Specify the Degree of Parallelism in a Dataflow Block](how-to-specify-the-degree-of-parallelism-in-a-dataflow-block.md).</span></span>  
  
### <a name="specifying-the-number-of-messages-per-task"></a><span data-ttu-id="49aa9-347">Určení počtu zpráv na úlohu</span><span class="sxs-lookup"><span data-stu-id="49aa9-347">Specifying the Number of Messages per Task</span></span>  
 <span data-ttu-id="49aa9-348">Předdefinované typy bloků toku dat používají úlohy ke zpracování více elementů vstupu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-348">The predefined dataflow block types use tasks to process multiple input elements.</span></span> <span data-ttu-id="49aa9-349">To pomáhá minimalizovat počet objektů úloh, které jsou požadovány pro zpracování dat, což umožňuje aplikacím běžet efektivněji.</span><span class="sxs-lookup"><span data-stu-id="49aa9-349">This helps minimize the number of task objects that are required to process data, which enables applications to run more efficiently.</span></span> <span data-ttu-id="49aa9-350">Pokud ale úkoly z jedné sady bloků toku dat zpracovávají data, může se stát, že se úlohy z jiných bloků toku budou muset čekat na dobu zpracování v rámci řazení zpráv do fronty.</span><span class="sxs-lookup"><span data-stu-id="49aa9-350">However, when the tasks from one set of dataflow blocks are processing data, the tasks from other dataflow blocks might need to wait for processing time by queuing messages.</span></span> <span data-ttu-id="49aa9-351">Chcete-li umožnit lepší rovnost mezi úlohami toku dat, nastavte <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="49aa9-351">To enable better fairness among dataflow tasks, set the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> property.</span></span> <span data-ttu-id="49aa9-352">Když <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> je nastavená na <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded?displayProperty=nameWithType> , což je výchozí, úloha používaná blokem toku dat zpracovává všechny zprávy, které jsou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="49aa9-352">When <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> is set to <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded?displayProperty=nameWithType>, which is the default, the task used by a dataflow block processes as many messages as are available.</span></span> <span data-ttu-id="49aa9-353">Když <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> je nastavená na jinou hodnotu než <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded> , blok toku dat zpracovává maximálně tento počet zpráv na <xref:System.Threading.Tasks.Task> objekt.</span><span class="sxs-lookup"><span data-stu-id="49aa9-353">When <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> is set to a value other than <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded>, the dataflow block processes at most this number of messages per <xref:System.Threading.Tasks.Task> object.</span></span> <span data-ttu-id="49aa9-354">I když nastavení <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> vlastnosti může zvýšit spravedlivosti mezi úkoly, může způsobit, že systém vytvoří více úloh, než je nutné, což může snížit výkon.</span><span class="sxs-lookup"><span data-stu-id="49aa9-354">Although setting the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> property can increase fairness among tasks, it can cause the system to create more tasks than are necessary, which can decrease performance.</span></span>  
  
### <a name="enabling-cancellation"></a><span data-ttu-id="49aa9-355">Povolení zrušení</span><span class="sxs-lookup"><span data-stu-id="49aa9-355">Enabling Cancellation</span></span>  
 <span data-ttu-id="49aa9-356">TPL poskytuje mechanismus, který umožňuje úlohám koordinovat zrušení v rámci spolupráce.</span><span class="sxs-lookup"><span data-stu-id="49aa9-356">The TPL provides a mechanism that enables tasks to coordinate cancellation in a cooperative manner.</span></span> <span data-ttu-id="49aa9-357">Chcete-li povolit bloky toku dat pro účast v tomto mechanismu zrušení, nastavte <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.CancellationToken%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="49aa9-357">To enable dataflow blocks to participate in this cancellation mechanism, set the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.CancellationToken%2A> property.</span></span> <span data-ttu-id="49aa9-358">Pokud <xref:System.Threading.CancellationToken> je tento objekt nastavený na stornovaný stav, všechny bloky toku dat, které sledují toto vykonání tohoto tokenu aktuální položky, ale nespouštějí následné zpracování položek.</span><span class="sxs-lookup"><span data-stu-id="49aa9-358">When this <xref:System.Threading.CancellationToken> object is set to the canceled state, all dataflow blocks that monitor this token finish execution of their current item but do not start processing subsequent items.</span></span> <span data-ttu-id="49aa9-359">Tyto bloky toku dat také vymažou všechny zprávy ve vyrovnávací paměti, vydávají připojení k jakémukoli zdrojovému a cílovému bloku a přechod do stavu zrušeno.</span><span class="sxs-lookup"><span data-stu-id="49aa9-359">These dataflow blocks also clear any buffered messages, release connections to any source and target blocks, and transition to the canceled state.</span></span> <span data-ttu-id="49aa9-360">Přechodem na stornovaný stav <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> vlastnost má vlastnost <xref:System.Threading.Tasks.Task.Status%2A> nastavenou na hodnotu <xref:System.Threading.Tasks.TaskStatus.Canceled> , pokud během zpracování nedojde k výjimce.</span><span class="sxs-lookup"><span data-stu-id="49aa9-360">By transitioning to the canceled state, the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> property has the <xref:System.Threading.Tasks.Task.Status%2A> property set to <xref:System.Threading.Tasks.TaskStatus.Canceled>, unless an exception occurred during processing.</span></span> <span data-ttu-id="49aa9-361">V takovém případě <xref:System.Threading.Tasks.Task.Status%2A> je nastavena na <xref:System.Threading.Tasks.TaskStatus.Faulted> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-361">In that case, <xref:System.Threading.Tasks.Task.Status%2A> is set to <xref:System.Threading.Tasks.TaskStatus.Faulted>.</span></span>  
  
 <span data-ttu-id="49aa9-362">Příklad, který ukazuje, jak použít zrušení v model Windows Forms aplikace, naleznete v tématu [How to: Cancel a Block toku](how-to-cancel-a-dataflow-block.md)dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-362">For an example that demonstrates how to use cancellation in a Windows Forms application, see [How to: Cancel a Dataflow Block](how-to-cancel-a-dataflow-block.md).</span></span> <span data-ttu-id="49aa9-363">Další informace o zrušení v TPL naleznete v tématu [zrušení úlohy](task-cancellation.md).</span><span class="sxs-lookup"><span data-stu-id="49aa9-363">For more information about cancellation in the TPL, see [Task Cancellation](task-cancellation.md).</span></span>  
  
### <a name="specifying-greedy-versus-non-greedy-behavior"></a><span data-ttu-id="49aa9-364">Určení hladového versus nehladového chování</span><span class="sxs-lookup"><span data-stu-id="49aa9-364">Specifying Greedy Versus Non-Greedy Behavior</span></span>  
 <span data-ttu-id="49aa9-365">Několik typů bloků datového toku pro seskupení může pracovat buď v *hladovém* , nebo *nehladovém* režimu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-365">Several grouping dataflow block types can operate in either *greedy* or *non-greedy* mode.</span></span> <span data-ttu-id="49aa9-366">Ve výchozím nastavení jsou předdefinované typy bloků toku dat provozovány v hladovém režimu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-366">By default, the predefined dataflow block types operate in greedy mode.</span></span>  
  
 <span data-ttu-id="49aa9-367">Pro typy bloku JOIN, jako <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> je například hladový režim, znamená, že blok okamžitě přijímá data i v případě, že odpovídající data, ke kterým se připojíte, ještě nejsou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="49aa9-367">For join block types such as <xref:System.Threading.Tasks.Dataflow.JoinBlock%602>, greedy mode means that the block immediately accepts data even if the corresponding data with which to join is not yet available.</span></span> <span data-ttu-id="49aa9-368">Nehladový režim znamená, že blok odloží všechny příchozí zprávy, dokud není k dispozici na všech svých cílech pro dokončení spojení.</span><span class="sxs-lookup"><span data-stu-id="49aa9-368">Non-greedy mode means that the block postpones all incoming messages until one is available on each of its targets to complete the join.</span></span> <span data-ttu-id="49aa9-369">Pokud již žádná z odložených zpráv není k dispozici, blok spojení uvolní všechny odložené zprávy a restartuje proces.</span><span class="sxs-lookup"><span data-stu-id="49aa9-369">If any of the postponed messages are no longer available, the join block releases all postponed messages and restarts the process.</span></span> <span data-ttu-id="49aa9-370">Pro <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> třídu, hladové a nehladové chování je podobné, s výjimkou případů, kdy v nehladovém režimu <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> objekt odloží všechny příchozí zprávy, dokud není dostatek dostupných z různých zdrojů k dokončení dávky.</span><span class="sxs-lookup"><span data-stu-id="49aa9-370">For the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> class, greedy and non-greedy behavior is similar, except that under non-greedy mode, a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object postpones all incoming messages until enough are available from distinct sources to complete a batch.</span></span>  
  
 <span data-ttu-id="49aa9-371">Chcete-li určit Nehladový režim pro blok toku dat, nastavte <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> na `False` .</span><span class="sxs-lookup"><span data-stu-id="49aa9-371">To specify non-greedy mode for a dataflow block, set <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> to `False`.</span></span> <span data-ttu-id="49aa9-372">Příklad, který ukazuje, jak použít nehladý režim pro povolení více spojovacích bloků pro efektivnější sdílení zdroje dat, naleznete v tématu [How to: use JoinBlock ke čtení dat z více zdrojů](how-to-use-joinblock-to-read-data-from-multiple-sources.md).</span><span class="sxs-lookup"><span data-stu-id="49aa9-372">For an example that demonstrates how to use non-greedy mode to enable multiple join blocks to share a data source more efficiently, see [How to: Use JoinBlock to Read Data From Multiple Sources](how-to-use-joinblock-to-read-data-from-multiple-sources.md).</span></span>

## <a name="custom-dataflow-blocks"></a><span data-ttu-id="49aa9-373">Vlastní bloky toku dat</span><span class="sxs-lookup"><span data-stu-id="49aa9-373">Custom Dataflow Blocks</span></span>  
 <span data-ttu-id="49aa9-374">I když knihovna TPL Dataflow poskytuje mnoho předdefinovaných typů bloku, můžete vytvořit další typy bloků, které provádějí vlastní chování.</span><span class="sxs-lookup"><span data-stu-id="49aa9-374">Although the TPL Dataflow Library provides many predefined block types, you can create additional block types that perform custom behavior.</span></span> <span data-ttu-id="49aa9-375">Implementujte <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601> <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> rozhraní nebo přímo nebo použijte <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Encapsulate%2A> metodu k sestavení komplexního bloku, který zapouzdřuje chování existujících typů bloků.</span><span class="sxs-lookup"><span data-stu-id="49aa9-375">Implement the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601> or <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> interfaces directly or use the  <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Encapsulate%2A> method to build a complex block that encapsulates the behavior of existing block types.</span></span> <span data-ttu-id="49aa9-376">Příklady, které ukazují, jak implementovat vlastní funkci bloku toku dat, naleznete v tématu [Návod: Vytvoření vlastního typu bloku toku](walkthrough-creating-a-custom-dataflow-block-type.md)dat.</span><span class="sxs-lookup"><span data-stu-id="49aa9-376">For examples that show how to implement custom dataflow block functionality, see [Walkthrough: Creating a Custom Dataflow Block Type](walkthrough-creating-a-custom-dataflow-block-type.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="49aa9-377">Související témata</span><span class="sxs-lookup"><span data-stu-id="49aa9-377">Related Topics</span></span>  
  
|<span data-ttu-id="49aa9-378">Nadpis</span><span class="sxs-lookup"><span data-stu-id="49aa9-378">Title</span></span>|<span data-ttu-id="49aa9-379">Popis</span><span class="sxs-lookup"><span data-stu-id="49aa9-379">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="49aa9-380">Postupy: Zápis zpráv do bloku toku dat a čtení zpráv z bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="49aa9-380">How to: Write Messages to and Read Messages from a Dataflow Block</span></span>](how-to-write-messages-to-and-read-messages-from-a-dataflow-block.md)|<span data-ttu-id="49aa9-381">Ukazuje, jak psát zprávy do a číst zprávy z <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> objektu.</span><span class="sxs-lookup"><span data-stu-id="49aa9-381">Demonstrates how to write messages to and read messages from a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> object.</span></span>|  
|[<span data-ttu-id="49aa9-382">Postupy: Implementace vzoru toku dat producent–příjemce</span><span class="sxs-lookup"><span data-stu-id="49aa9-382">How to: Implement a Producer-Consumer Dataflow Pattern</span></span>](how-to-implement-a-producer-consumer-dataflow-pattern.md)|<span data-ttu-id="49aa9-383">Popisuje, jak použít model toku dat pro implementaci vzoru producent-příjemce, kde producent posílá zprávy do bloku toku dat a příjemce čte zprávy z tohoto bloku.</span><span class="sxs-lookup"><span data-stu-id="49aa9-383">Describes how to use the dataflow model to implement a producer-consumer pattern, where the producer sends messages to a dataflow block, and the consumer reads messages from that block.</span></span>|  
|[<span data-ttu-id="49aa9-384">Postupy: Provádění akcí po přijetí dat do bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="49aa9-384">How to: Perform Action When a Dataflow Block Receives Data</span></span>](how-to-perform-action-when-a-dataflow-block-receives-data.md)|<span data-ttu-id="49aa9-385">Popisuje, jak poskytnout delegáty pro spouštění typů bloku toku dat, <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> , <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> .</span><span class="sxs-lookup"><span data-stu-id="49aa9-385">Describes how to provide delegates to the execution dataflow block types, <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>, and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>.</span></span>|  
|[<span data-ttu-id="49aa9-386">Návod: Vytvoření kanálu toku dat</span><span class="sxs-lookup"><span data-stu-id="49aa9-386">Walkthrough: Creating a Dataflow Pipeline</span></span>](walkthrough-creating-a-dataflow-pipeline.md)|<span data-ttu-id="49aa9-387">V této části najdete popis postupu vytvoření kanálu toku dat, který stahuje text z webu a provádí operace s tímto textem.</span><span class="sxs-lookup"><span data-stu-id="49aa9-387">Describes how to create a dataflow pipeline that downloads text from the web and performs operations on that text.</span></span>|  
|[<span data-ttu-id="49aa9-388">Postupy: Zrušení propojení bloků toku dat</span><span class="sxs-lookup"><span data-stu-id="49aa9-388">How to: Unlink Dataflow Blocks</span></span>](how-to-unlink-dataflow-blocks.md)|<span data-ttu-id="49aa9-389">Ukazuje, jak použít <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A> metodu k odpojení cílového bloku od zdroje poté, co zdroj nabídne zprávu cíli.</span><span class="sxs-lookup"><span data-stu-id="49aa9-389">Demonstrates how to use the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A> method to unlink a target block from its source after the source offers a message to the target.</span></span>|  
|[<span data-ttu-id="49aa9-390">Návod: Použití toku dat ve formulářové aplikaci Windows</span><span class="sxs-lookup"><span data-stu-id="49aa9-390">Walkthrough: Using Dataflow in a Windows Forms Application</span></span>](walkthrough-using-dataflow-in-a-windows-forms-application.md)|<span data-ttu-id="49aa9-391">Ukazuje, jak vytvořit síť bloků toku dat, které provádějí zpracování bitové kopie v aplikaci model Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="49aa9-391">Demonstrates how to create a network of dataflow blocks that perform image processing in a Windows Forms application.</span></span>|  
|[<span data-ttu-id="49aa9-392">Postupy: Zrušení bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="49aa9-392">How to: Cancel a Dataflow Block</span></span>](how-to-cancel-a-dataflow-block.md)|<span data-ttu-id="49aa9-393">Ukazuje, jak použít zrušení v aplikaci model Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="49aa9-393">Demonstrates how to use cancellation in a Windows Forms application.</span></span>|  
|[<span data-ttu-id="49aa9-394">Postupy: Načítání dat z více zdrojů pomocí třídy JoinBlock</span><span class="sxs-lookup"><span data-stu-id="49aa9-394">How to: Use JoinBlock to Read Data From Multiple Sources</span></span>](how-to-use-joinblock-to-read-data-from-multiple-sources.md)|<span data-ttu-id="49aa9-395">Vysvětluje, jak použít <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> třídu k provedení operace, když jsou data k dispozici z více zdrojů, a jak použít Nehladový režim k povolení sdílení zdroje dat více spojovacími bloky.</span><span class="sxs-lookup"><span data-stu-id="49aa9-395">Explains how to use the <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> class to perform an operation when data is available from multiple sources, and how to use non-greedy mode to enable multiple join blocks to share a data source more efficiently.</span></span>|  
|[<span data-ttu-id="49aa9-396">Postupy: Určení stupně paralelního zpracování v bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="49aa9-396">How to: Specify the Degree of Parallelism in a Dataflow Block</span></span>](how-to-specify-the-degree-of-parallelism-in-a-dataflow-block.md)|<span data-ttu-id="49aa9-397">Popisuje, jak nastavit <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> vlastnost tak, aby umožňovala zpracování bloku toku dat spouštění více zpráv najednou.</span><span class="sxs-lookup"><span data-stu-id="49aa9-397">Describes how to set the <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> property to enable an execution dataflow block to process more than one message at a time.</span></span>|  
|[<span data-ttu-id="49aa9-398">Postupy: Určení plánovače úloh v bloku toku dat</span><span class="sxs-lookup"><span data-stu-id="49aa9-398">How to: Specify a Task Scheduler in a Dataflow Block</span></span>](how-to-specify-a-task-scheduler-in-a-dataflow-block.md)|<span data-ttu-id="49aa9-399">Ukazuje, jak přidružit konkrétní Plánovač úloh při použití toku dat ve vaší aplikaci.</span><span class="sxs-lookup"><span data-stu-id="49aa9-399">Demonstrates how to associate a specific task scheduler when you use dataflow in your application.</span></span>|  
|[<span data-ttu-id="49aa9-400">Návod: Zvýšení efektivity díky použití tříd BatchBlock a BatchedJoinBlock</span><span class="sxs-lookup"><span data-stu-id="49aa9-400">Walkthrough: Using BatchBlock and BatchedJoinBlock to Improve Efficiency</span></span>](walkthrough-using-batchblock-and-batchedjoinblock-to-improve-efficiency.md)|<span data-ttu-id="49aa9-401">Popisuje, jak použít <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> třídu ke zlepšení efektivity operací vložení databáze a způsobu použití <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> třídy k zachycení výsledků a všech výjimek, ke kterým dojde, když program načítá z databáze.</span><span class="sxs-lookup"><span data-stu-id="49aa9-401">Describes how to use the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> class to improve the efficiency of database insert operations, and how to use the <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> class to capture both the results and any exceptions that occur while the program reads from a database.</span></span>|  
|[<span data-ttu-id="49aa9-402">Návod: Vytvoření bloku toku dat vlastního typu</span><span class="sxs-lookup"><span data-stu-id="49aa9-402">Walkthrough: Creating a Custom Dataflow Block Type</span></span>](walkthrough-creating-a-custom-dataflow-block-type.md)|<span data-ttu-id="49aa9-403">Ukazuje dva způsoby vytvoření typu bloku toku dat, který implementuje vlastní chování.</span><span class="sxs-lookup"><span data-stu-id="49aa9-403">Demonstrates two ways to create a dataflow block type that implements custom behavior.</span></span>|  
|[<span data-ttu-id="49aa9-404">Task Parallel Library (TPL)</span><span class="sxs-lookup"><span data-stu-id="49aa9-404">Task Parallel Library (TPL)</span></span>](task-parallel-library-tpl.md)|<span data-ttu-id="49aa9-405">Zavádí TPL, knihovnu, která zjednodušuje paralelní a souběžné programování v aplikacích .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="49aa9-405">Introduces the TPL, a library that simplifies parallel and concurrent programming in .NET Framework applications.</span></span>|
