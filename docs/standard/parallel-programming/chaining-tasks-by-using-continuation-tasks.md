---
title: Řetězení úloh pomocí úloh pokračování
ms.date: 02/11/2019
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- tasks, continuations
ms.assetid: 0b45e9a2-de28-46ce-8212-1817280ed42d
ms.openlocfilehash: 7de8c4e44e1866e3df36c666c9ecc210dc6a7d83
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/15/2020
ms.locfileid: "78159361"
---
# <a name="chaining-tasks-by-using-continuation-tasks"></a><span data-ttu-id="414f4-102">Řetězení úloh pomocí úloh pokračování</span><span class="sxs-lookup"><span data-stu-id="414f4-102">Chaining Tasks by Using Continuation Tasks</span></span>
<span data-ttu-id="414f4-103">V asynchronním programování je běžné, že jedna asynchronní operace po dokončení vyvolá druhou operaci a předá jí data.</span><span class="sxs-lookup"><span data-stu-id="414f4-103">In asynchronous programming, it is common for one asynchronous operation, on completion, to invoke a second operation and pass data to it.</span></span> <span data-ttu-id="414f4-104">Tradičně pokračování byly provedeny pomocí metody zpětného volání.</span><span class="sxs-lookup"><span data-stu-id="414f4-104">Traditionally, continuations have been done by using callback methods.</span></span> <span data-ttu-id="414f4-105">V paralelní knihovně úloh je stejná funkce poskytována *úlohami pokračování*.</span><span class="sxs-lookup"><span data-stu-id="414f4-105">In the Task Parallel Library, the same functionality is provided by *continuation tasks*.</span></span> <span data-ttu-id="414f4-106">Úloha pokračování (označovaná také jako pokračování) je asynchronní úloha, která je vyvolána jinou úlohou, která se nazývá *předchůdce*, když předchůdce dokončí.</span><span class="sxs-lookup"><span data-stu-id="414f4-106">A continuation task (also known just as a continuation) is an asynchronous task that is invoked by another task, which is known as the *antecedent*, when the antecedent finishes.</span></span>  
  
 <span data-ttu-id="414f4-107">Pokračování jsou poměrně snadné použití, ale přesto jsou silné a flexibilní.</span><span class="sxs-lookup"><span data-stu-id="414f4-107">Continuations are relatively easy to use, but are nevertheless powerful and flexible.</span></span> <span data-ttu-id="414f4-108">Můžete například provést následující věci:</span><span class="sxs-lookup"><span data-stu-id="414f4-108">For example, you can:</span></span>  
  
- <span data-ttu-id="414f4-109">Předá data z předchůdce pokračování.</span><span class="sxs-lookup"><span data-stu-id="414f4-109">Pass data from the antecedent to the continuation.</span></span>  
  
- <span data-ttu-id="414f4-110">Určete přesné podmínky, za kterých bude pokračování vyvoláno nebo není vyvoláno.</span><span class="sxs-lookup"><span data-stu-id="414f4-110">Specify the precise conditions under which the continuation will be invoked or not invoked.</span></span>  
  
- <span data-ttu-id="414f4-111">Zrušte pokračování před spuštěním nebo kooperativně, jak je spuštěno.</span><span class="sxs-lookup"><span data-stu-id="414f4-111">Cancel a continuation either before it starts or cooperatively as it is running.</span></span>  
  
- <span data-ttu-id="414f4-112">Poskytněte rady o tom, jak by mělo být naplánováno pokračování.</span><span class="sxs-lookup"><span data-stu-id="414f4-112">Provide hints about how the continuation should be scheduled.</span></span>  
  
- <span data-ttu-id="414f4-113">Vyvolat více pokračování ze stejného předchůdce.</span><span class="sxs-lookup"><span data-stu-id="414f4-113">Invoke multiple continuations from the same antecedent.</span></span>  
  
- <span data-ttu-id="414f4-114">Vyvolat jedno pokračování po dokončení všech nebo některé z více předchůdců.</span><span class="sxs-lookup"><span data-stu-id="414f4-114">Invoke one continuation when all or any one of multiple antecedents complete.</span></span>  
  
- <span data-ttu-id="414f4-115">Řetěz pokračuje jeden po druhém na libovolnou délku.</span><span class="sxs-lookup"><span data-stu-id="414f4-115">Chain continuations one after another to any arbitrary length.</span></span>  
  
- <span data-ttu-id="414f4-116">Použijte pokračování pro zpracování výjimek vyzdvižených předchůdcem.</span><span class="sxs-lookup"><span data-stu-id="414f4-116">Use a continuation to handle exceptions thrown by the antecedent.</span></span>  
  
## <a name="about-continuations"></a><span data-ttu-id="414f4-117">Pokračování</span><span class="sxs-lookup"><span data-stu-id="414f4-117">About continuations</span></span>  
 <span data-ttu-id="414f4-118">Pokračování je úkol, který je <xref:System.Threading.Tasks.TaskStatus.WaitingForActivation> vytvořen ve stavu.</span><span class="sxs-lookup"><span data-stu-id="414f4-118">A continuation is a task that is created in the <xref:System.Threading.Tasks.TaskStatus.WaitingForActivation> state.</span></span> <span data-ttu-id="414f4-119">Aktivuje se automaticky po dokončení předchozího úkolu nebo úkolů.</span><span class="sxs-lookup"><span data-stu-id="414f4-119">It is activated automatically when its antecedent task or tasks complete.</span></span> <span data-ttu-id="414f4-120">Volání <xref:System.Threading.Tasks.Task.Start%2A?displayProperty=nameWithType> na pokračování v uživatelském <xref:System.InvalidOperationException?displayProperty=nameWithType> kódu vyvolá výjimku.</span><span class="sxs-lookup"><span data-stu-id="414f4-120">Calling <xref:System.Threading.Tasks.Task.Start%2A?displayProperty=nameWithType> on a continuation in user code throws an <xref:System.InvalidOperationException?displayProperty=nameWithType> exception.</span></span>  
  
 <span data-ttu-id="414f4-121">Pokračování je samo <xref:System.Threading.Tasks.Task> o sobě a neblokuje vlákno, na kterém je spuštěn.</span><span class="sxs-lookup"><span data-stu-id="414f4-121">A continuation is itself a <xref:System.Threading.Tasks.Task> and does not block the thread on which it is started.</span></span> <span data-ttu-id="414f4-122">Volání <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> metody blokovat, dokud dokončení úkolu pokračování.</span><span class="sxs-lookup"><span data-stu-id="414f4-122">Call the <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> method to block until the continuation task finishes.</span></span>  
  
## <a name="creating-a-continuation-for-a-single-antecedent"></a><span data-ttu-id="414f4-123">Vytvoření pokračování pro jednu předchozí</span><span class="sxs-lookup"><span data-stu-id="414f4-123">Creating a continuation for a single antecedent</span></span>  
 <span data-ttu-id="414f4-124">Můžete vytvořit pokračování, které se spustí po jeho <xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=nameWithType> předchůdce dokončil voláním metody.</span><span class="sxs-lookup"><span data-stu-id="414f4-124">You create a continuation that executes when its antecedent has completed by calling the <xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="414f4-125">Následující příklad ukazuje základní vzor (pro přehlednost, zpracování výjimek je vynechán).</span><span class="sxs-lookup"><span data-stu-id="414f4-125">The following example shows the basic pattern (for clarity, exception handling is omitted).</span></span> <span data-ttu-id="414f4-126">Provede předchozí úlohu , `taskA`která vrací <xref:System.DayOfWeek> objekt, který označuje název aktuálního dne v týdnu.</span><span class="sxs-lookup"><span data-stu-id="414f4-126">It executes an antecedent task, `taskA`, that returns a <xref:System.DayOfWeek> object that indicates the name of the current day of the week.</span></span> <span data-ttu-id="414f4-127">Po dokončení předchůdce je úkol pokračování `continuation`, předán předchozí a zobrazí řetězec, který obsahuje jeho výsledek.</span><span class="sxs-lookup"><span data-stu-id="414f4-127">When the antecedent completes, the continuation task, `continuation`, is passed the antecedent and displays a string that includes its result.</span></span>

> [!NOTE]
> <span data-ttu-id="414f4-128">C# ukázky v tomto článku `async` použít modifikátor na metodu. `Main`</span><span class="sxs-lookup"><span data-stu-id="414f4-128">The C# samples in this article make use of the `async` modifier on the `Main` method.</span></span> <span data-ttu-id="414f4-129">Tato funkce je k dispozici v C# 7.1 a novější.</span><span class="sxs-lookup"><span data-stu-id="414f4-129">That feature is available in C# 7.1 and later.</span></span> <span data-ttu-id="414f4-130">Předchozí verze [`CS5001`](../../csharp/misc/cs5001.md) generovat při kompilaci tohoto ukázkového kódu.</span><span class="sxs-lookup"><span data-stu-id="414f4-130">Previous versions generate [`CS5001`](../../csharp/misc/cs5001.md) when compiling this sample code.</span></span> <span data-ttu-id="414f4-131">Budete muset nastavit jazykovou verzi C# 7.1 nebo novější.</span><span class="sxs-lookup"><span data-stu-id="414f4-131">You'll need to set the language version to C# 7.1 or newer.</span></span> <span data-ttu-id="414f4-132">Jak nakonfigurovat jazykovou verzi, najdete v článku o [konfiguraci jazykové verze](../../csharp/language-reference/configure-language-version.md).</span><span class="sxs-lookup"><span data-stu-id="414f4-132">You can learn how to configure the language version in the article on [configure language version](../../csharp/language-reference/configure-language-version.md).</span></span>
  
 [!code-csharp[TPL_Continuations#1](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/simple1.cs#1)]
 [!code-vb[TPL_Continuations#1](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/simple1.vb#1)]  
  
## <a name="creating-a-continuation-for-multiple-antecedents"></a><span data-ttu-id="414f4-133">Vytvoření pokračování pro více předchůdců</span><span class="sxs-lookup"><span data-stu-id="414f4-133">Creating a continuation for multiple antecedents</span></span>  
 <span data-ttu-id="414f4-134">Můžete také vytvořit pokračování, které bude spuštěno po dokončení některé nebo všechny skupiny úkolů.</span><span class="sxs-lookup"><span data-stu-id="414f4-134">You can also create a continuation that will run when any or all of a group of tasks has completed.</span></span> <span data-ttu-id="414f4-135">Chcete-li provést pokračování po dokončení všech předchozích úloh, volání statické (`Shared` v jazyce Visual Basic) <xref:System.Threading.Tasks.Task.WhenAll%2A?displayProperty=nameWithType> metoda nebo metodu instance. <xref:System.Threading.Tasks.TaskFactory.ContinueWhenAll%2A?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="414f4-135">To execute a continuation when all antecedent tasks have completed, you call the static (`Shared` in Visual Basic) <xref:System.Threading.Tasks.Task.WhenAll%2A?displayProperty=nameWithType> method or the instance <xref:System.Threading.Tasks.TaskFactory.ContinueWhenAll%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="414f4-136">Chcete-li provést pokračování po dokončení některého z předchozích`Shared` úloh, volání <xref:System.Threading.Tasks.Task.WhenAny%2A?displayProperty=nameWithType> statické ( <xref:System.Threading.Tasks.TaskFactory.ContinueWhenAny%2A?displayProperty=nameWithType> v jazyce Visual Basic) metoda nebo metodu instance.</span><span class="sxs-lookup"><span data-stu-id="414f4-136">To execute a continuation when any of the antecedent tasks has completed, you call the static (`Shared` in Visual Basic) <xref:System.Threading.Tasks.Task.WhenAny%2A?displayProperty=nameWithType> method or the instance <xref:System.Threading.Tasks.TaskFactory.ContinueWhenAny%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="414f4-137">Všimněte si, <xref:System.Threading.Tasks.Task.WhenAll%2A?displayProperty=nameWithType> <xref:System.Threading.Tasks.Task.WhenAny%2A?displayProperty=nameWithType> že volání a přetížení neblokují volající vlákno.</span><span class="sxs-lookup"><span data-stu-id="414f4-137">Note that calls to the <xref:System.Threading.Tasks.Task.WhenAll%2A?displayProperty=nameWithType> and <xref:System.Threading.Tasks.Task.WhenAny%2A?displayProperty=nameWithType> overloads do not block the calling thread.</span></span>  <span data-ttu-id="414f4-138">Obvykle však voláte všechny, ale <xref:System.Threading.Tasks.Task.WhenAll%28System.Collections.Generic.IEnumerable%7BSystem.Threading.Tasks.Task%7D%29?displayProperty=nameWithType> a <xref:System.Threading.Tasks.Task.WhenAll%28System.Threading.Tasks.Task%5B%5D%29?displayProperty=nameWithType> <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> metody k načtení vrácené vlastnosti, která blokuje volající vlákno.</span><span class="sxs-lookup"><span data-stu-id="414f4-138">However, you typically call all but the <xref:System.Threading.Tasks.Task.WhenAll%28System.Collections.Generic.IEnumerable%7BSystem.Threading.Tasks.Task%7D%29?displayProperty=nameWithType> and  <xref:System.Threading.Tasks.Task.WhenAll%28System.Threading.Tasks.Task%5B%5D%29?displayProperty=nameWithType> methods to retrieve the returned  <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> property, which does block the calling thread.</span></span>  
  
 <span data-ttu-id="414f4-139">Následující příklad volá <xref:System.Threading.Tasks.Task.WhenAll%28System.Collections.Generic.IEnumerable%7BSystem.Threading.Tasks.Task%7D%29?displayProperty=nameWithType> metodu k vytvoření úlohy pokračování, která odráží výsledky jeho 10 předchozích úkolů.</span><span class="sxs-lookup"><span data-stu-id="414f4-139">The following example calls the <xref:System.Threading.Tasks.Task.WhenAll%28System.Collections.Generic.IEnumerable%7BSystem.Threading.Tasks.Task%7D%29?displayProperty=nameWithType> method to create a continuation task that reflects the results of its 10 antecedent tasks.</span></span> <span data-ttu-id="414f4-140">Každý předchozí úkol čtverce hodnotu indexu, která se pohybuje od jedné do 10.</span><span class="sxs-lookup"><span data-stu-id="414f4-140">Each antecedent task squares an index value that ranges from one to 10.</span></span> <span data-ttu-id="414f4-141">Pokud předchůdce úspěšně dokončena (jejich <xref:System.Threading.Tasks.Task.Status%2A?displayProperty=nameWithType> vlastnost <xref:System.Threading.Tasks.TaskStatus.RanToCompletion?displayProperty=nameWithType>je <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> ), vlastnost pokračování je <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> pole hodnoty vrácené každý předchůdce.</span><span class="sxs-lookup"><span data-stu-id="414f4-141">If the antecedents complete successfully (their <xref:System.Threading.Tasks.Task.Status%2A?displayProperty=nameWithType> property is <xref:System.Threading.Tasks.TaskStatus.RanToCompletion?displayProperty=nameWithType>), the <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> property of the continuation is an array of the <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> values returned by each antecedent.</span></span> <span data-ttu-id="414f4-142">Příklad je přidá k výpočtu součtu čtverců pro všechna čísla od jedné do deseti.</span><span class="sxs-lookup"><span data-stu-id="414f4-142">The example adds them to compute the sum of squares for all numbers between one and 10.</span></span>  
  
 [!code-csharp[TPL_Continuations#5](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/whenall1.cs#5)]
 [!code-vb[TPL_Continuations#5](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/whenall1.vb#5)]  
  
## <a name="continuation-options"></a><span data-ttu-id="414f4-143">Možnosti pokračování</span><span class="sxs-lookup"><span data-stu-id="414f4-143">Continuation options</span></span>  
 <span data-ttu-id="414f4-144">Při vytváření pokračování jedné úlohy můžete <xref:System.Threading.Tasks.Task.ContinueWith%2A> použít přetížení, <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> které trvá hodnotu výčtu k určení podmínek, za kterých začíná pokračování.</span><span class="sxs-lookup"><span data-stu-id="414f4-144">When you create a single-task continuation, you can use a <xref:System.Threading.Tasks.Task.ContinueWith%2A> overload that takes a <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> enumeration value to specify the conditions under which the continuation starts.</span></span> <span data-ttu-id="414f4-145">Můžete například určit, že pokračování má být spuštěno pouze v případě, že předchůdce bude úspěšně dokončen, nebo pouze v případě, že se dokončí v chybném stavu.</span><span class="sxs-lookup"><span data-stu-id="414f4-145">For example, you can specify that the continuation is to run only if the antecedent completes successfully, or only if it completes in a faulted state.</span></span> <span data-ttu-id="414f4-146">Pokud podmínka není true, když předchůdce je připraven k vyvolání pokračování, <xref:System.Threading.Tasks.TaskStatus.Canceled?displayProperty=nameWithType> pokračování přechody přímo do stavu a následně nelze spustit.</span><span class="sxs-lookup"><span data-stu-id="414f4-146">If the condition is not true when the antecedent is ready to invoke the continuation, the continuation transitions directly to the <xref:System.Threading.Tasks.TaskStatus.Canceled?displayProperty=nameWithType> state and subsequently cannot be started.</span></span>  
  
 <span data-ttu-id="414f4-147">Počet víceúloha pokračování metody, jako je <xref:System.Threading.Tasks.TaskFactory.ContinueWhenAll%2A?displayProperty=nameWithType> například přetížení <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> metody, také parametr.</span><span class="sxs-lookup"><span data-stu-id="414f4-147">A number of multi-task continuation methods, such as overloads of the <xref:System.Threading.Tasks.TaskFactory.ContinueWhenAll%2A?displayProperty=nameWithType> method, also include a <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> parameter.</span></span> <span data-ttu-id="414f4-148">Je však platná <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> pouze podmnožina všech členů výčtu.</span><span class="sxs-lookup"><span data-stu-id="414f4-148">Only a subset of all <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> enumeration members are valid, however.</span></span> <span data-ttu-id="414f4-149">Můžete zadat <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> hodnoty, které mají <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=nameWithType> protějšky ve <xref:System.Threading.Tasks.TaskContinuationOptions.AttachedToParent?displayProperty=nameWithType>výčtu, například , <xref:System.Threading.Tasks.TaskContinuationOptions.LongRunning?displayProperty=nameWithType>a <xref:System.Threading.Tasks.TaskContinuationOptions.PreferFairness?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="414f4-149">You can specify <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> values that have counterparts in the <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=nameWithType> enumeration, such as <xref:System.Threading.Tasks.TaskContinuationOptions.AttachedToParent?displayProperty=nameWithType>, <xref:System.Threading.Tasks.TaskContinuationOptions.LongRunning?displayProperty=nameWithType>, and <xref:System.Threading.Tasks.TaskContinuationOptions.PreferFairness?displayProperty=nameWithType>.</span></span> <span data-ttu-id="414f4-150">Pokud zadáte některou `NotOn` `OnlyOn` z možností nebo s pokračováním více úkolů, bude vyvolána <xref:System.ArgumentOutOfRangeException> výjimka za běhu.</span><span class="sxs-lookup"><span data-stu-id="414f4-150">If you specify any of the `NotOn` or `OnlyOn` options with a multi-task continuation, an <xref:System.ArgumentOutOfRangeException> exception will be thrown at run time.</span></span>  
  
 <span data-ttu-id="414f4-151">Další informace o možnostech pokračování <xref:System.Threading.Tasks.TaskContinuationOptions> úkolu naleznete v tématu.</span><span class="sxs-lookup"><span data-stu-id="414f4-151">For more information on task continuation options, see the <xref:System.Threading.Tasks.TaskContinuationOptions> topic.</span></span>  
  
## <a name="passing-data-to-a-continuation"></a><span data-ttu-id="414f4-152">Předávání dat pokračování</span><span class="sxs-lookup"><span data-stu-id="414f4-152">Passing Data to a Continuation</span></span>  
 <span data-ttu-id="414f4-153">Metoda <xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=nameWithType> předá odkaz na předchůdce uživateli delegátpokračování jako argument.</span><span class="sxs-lookup"><span data-stu-id="414f4-153">The <xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=nameWithType> method passes a reference to the antecedent to the user delegate of the continuation as an argument.</span></span> <span data-ttu-id="414f4-154">Pokud předchůdce je <xref:System.Threading.Tasks.Task%601?displayProperty=nameWithType> objekt a úloha byla spuštěna, dokud nebyla <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> dokončena, pak pokračování přístup k vlastnost úkolu.</span><span class="sxs-lookup"><span data-stu-id="414f4-154">If the antecedent is a <xref:System.Threading.Tasks.Task%601?displayProperty=nameWithType> object, and the task ran until it was completed, then the continuation can access the <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> property of the task.</span></span>  
  
 <span data-ttu-id="414f4-155">Vlastnost <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> blokuje, dokud úkol nebyl dokončen.</span><span class="sxs-lookup"><span data-stu-id="414f4-155">The <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> property blocks until the task has completed.</span></span> <span data-ttu-id="414f4-156">Pokud však byla úloha zrušena nebo došlo k <xref:System.Threading.Tasks.Task%601.Result%2A> chybě, <xref:System.AggregateException> pokus o přístup k vlastnosti vyvolá výjimku.</span><span class="sxs-lookup"><span data-stu-id="414f4-156">However, if the task was canceled or faulted, attempting to access the <xref:System.Threading.Tasks.Task%601.Result%2A> property throws an <xref:System.AggregateException> exception.</span></span> <span data-ttu-id="414f4-157">Tomuto problému se můžete <xref:System.Threading.Tasks.TaskContinuationOptions.OnlyOnRanToCompletion> vyhnout pomocí možnosti, jak je znázorněno v následujícím příkladu.</span><span class="sxs-lookup"><span data-stu-id="414f4-157">You can avoid this problem by using the <xref:System.Threading.Tasks.TaskContinuationOptions.OnlyOnRanToCompletion> option, as shown in the following example.</span></span>  
  
 [!code-csharp[TPL_Continuations#2](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/result1.cs#2)]
 [!code-vb[TPL_Continuations#2](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/result1.vb#2)]  
  
 <span data-ttu-id="414f4-158">Pokud chcete pokračování spustit i v případě, že předchůdce neběžel k úspěšnému dokončení, je nutné chránit před výjimkou.</span><span class="sxs-lookup"><span data-stu-id="414f4-158">If you want the continuation to run even if the antecedent did not run to successful completion, you must guard against the exception.</span></span> <span data-ttu-id="414f4-159">Jedním z přístupů <xref:System.Threading.Tasks.Task.Status%2A?displayProperty=nameWithType> je otestovat vlastnost předchůdce a pouze <xref:System.Threading.Tasks.Task%601.Result%2A> pokus o přístup <xref:System.Threading.Tasks.TaskStatus.Faulted> <xref:System.Threading.Tasks.TaskStatus.Canceled>k vlastnosti, pokud stav není nebo .</span><span class="sxs-lookup"><span data-stu-id="414f4-159">One approach is to test the <xref:System.Threading.Tasks.Task.Status%2A?displayProperty=nameWithType> property of the antecedent, and only attempt to access the <xref:System.Threading.Tasks.Task%601.Result%2A> property if the status is not <xref:System.Threading.Tasks.TaskStatus.Faulted> or <xref:System.Threading.Tasks.TaskStatus.Canceled>.</span></span> <span data-ttu-id="414f4-160">Můžete také prozkoumat <xref:System.Threading.Tasks.Task.Exception%2A> vlastnost předchůdce.</span><span class="sxs-lookup"><span data-stu-id="414f4-160">You can also examine the <xref:System.Threading.Tasks.Task.Exception%2A> property of the antecedent.</span></span> <span data-ttu-id="414f4-161">Další informace naleznete v [tématu Zpracování výjimek](../../../docs/standard/parallel-programming/exception-handling-task-parallel-library.md).</span><span class="sxs-lookup"><span data-stu-id="414f4-161">For more information, see [Exception Handling](../../../docs/standard/parallel-programming/exception-handling-task-parallel-library.md).</span></span> <span data-ttu-id="414f4-162">Následující příklad upravuje předchozí příklad pro přístup k <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> vlastnosti antecedent <xref:System.Threading.Tasks.TaskStatus.RanToCompletion?displayProperty=nameWithType>pouze v případě, že jeho stav je .</span><span class="sxs-lookup"><span data-stu-id="414f4-162">The following example modifies the previous example to access antecedent's <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> property only if its status is <xref:System.Threading.Tasks.TaskStatus.RanToCompletion?displayProperty=nameWithType>.</span></span>  
  
 [!code-csharp[TPL_Continuations#7](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/result2.cs#7)]
 [!code-vb[TPL_Continuations#7](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/result2.vb#7)]  
  
## <a name="canceling-a-continuation"></a><span data-ttu-id="414f4-163">Zrušení pokračování</span><span class="sxs-lookup"><span data-stu-id="414f4-163">Canceling a Continuation</span></span>  
 <span data-ttu-id="414f4-164">Vlastnost <xref:System.Threading.Tasks.Task.Status%2A?displayProperty=nameWithType> pokračování je nastavena <xref:System.Threading.Tasks.TaskStatus.Canceled?displayProperty=nameWithType> na v následujících situacích:</span><span class="sxs-lookup"><span data-stu-id="414f4-164">The <xref:System.Threading.Tasks.Task.Status%2A?displayProperty=nameWithType> property of a continuation is set to <xref:System.Threading.Tasks.TaskStatus.Canceled?displayProperty=nameWithType> in the following situations:</span></span>  
  
- <span data-ttu-id="414f4-165">Vyvolá výjimku <xref:System.OperationCanceledException> v reakci na požadavek na zrušení.</span><span class="sxs-lookup"><span data-stu-id="414f4-165">It throws an <xref:System.OperationCanceledException> exception in response to a cancellation request.</span></span> <span data-ttu-id="414f4-166">Stejně jako u jakékoli úlohy, pokud výjimka obsahuje stejný token, který byl předán pokračování, je považován za potvrzení zrušení spolupráce.</span><span class="sxs-lookup"><span data-stu-id="414f4-166">As with any task, if the exception contains the same token that was passed to the continuation, it is treated as an acknowledgement of cooperative cancellation.</span></span>  
  
- <span data-ttu-id="414f4-167">Pokračování je <xref:System.Threading.CancellationToken?displayProperty=nameWithType> předán, <xref:System.Threading.CancellationToken.IsCancellationRequested%2A> jehož vlastnost je `true`.</span><span class="sxs-lookup"><span data-stu-id="414f4-167">The continuation is passed a <xref:System.Threading.CancellationToken?displayProperty=nameWithType> whose <xref:System.Threading.CancellationToken.IsCancellationRequested%2A> property is `true`.</span></span> <span data-ttu-id="414f4-168">V tomto případě pokračování nespustí a přechody <xref:System.Threading.Tasks.TaskStatus.Canceled?displayProperty=nameWithType> do stavu.</span><span class="sxs-lookup"><span data-stu-id="414f4-168">In this case, the continuation does not start, and it transitions to the <xref:System.Threading.Tasks.TaskStatus.Canceled?displayProperty=nameWithType> state.</span></span>  
  
- <span data-ttu-id="414f4-169">Pokračování nikdy spustí, protože podmínka <xref:System.Threading.Tasks.TaskContinuationOptions> nastavená jeho argument nebyla splněna.</span><span class="sxs-lookup"><span data-stu-id="414f4-169">The continuation never runs because the condition set by its <xref:System.Threading.Tasks.TaskContinuationOptions> argument was not met.</span></span> <span data-ttu-id="414f4-170">Například pokud předchůdce přejde do <xref:System.Threading.Tasks.TaskStatus.Faulted?displayProperty=nameWithType> stavu, jeho pokračování, <xref:System.Threading.Tasks.TaskContinuationOptions.NotOnFaulted?displayProperty=nameWithType> které bylo předáno možnost <xref:System.Threading.Tasks.TaskStatus.Canceled> nebude spuštěna, ale bude přechod do stavu.</span><span class="sxs-lookup"><span data-stu-id="414f4-170">For example, if an antecedent goes into a <xref:System.Threading.Tasks.TaskStatus.Faulted?displayProperty=nameWithType> state, its continuation that was passed the <xref:System.Threading.Tasks.TaskContinuationOptions.NotOnFaulted?displayProperty=nameWithType> option will not run but will transition to the <xref:System.Threading.Tasks.TaskStatus.Canceled> state.</span></span>  
  
 <span data-ttu-id="414f4-171">Pokud úkol a jeho pokračování představují dvě části stejné logické operace, můžete předat stejný token zrušení pro oba úkoly, jak je znázorněno v následujícím příkladu.</span><span class="sxs-lookup"><span data-stu-id="414f4-171">If a task and its continuation represent two parts of the same logical operation, you can pass the same cancellation token to both tasks, as shown in the following example.</span></span> <span data-ttu-id="414f4-172">Skládá se z předchůdce, který generuje seznam celá čísla, která jsou dělitelná 33, které přejde na pokračování.</span><span class="sxs-lookup"><span data-stu-id="414f4-172">It consists of an antecedent that generates a list of integers that are divisible by 33, which it passes to the continuation.</span></span> <span data-ttu-id="414f4-173">Pokračování zase zobrazí seznam.</span><span class="sxs-lookup"><span data-stu-id="414f4-173">The continuation in turn displays the list.</span></span> <span data-ttu-id="414f4-174">Předchůdce i pokračování se pravidelně pozastavují v náhodných intervalech.</span><span class="sxs-lookup"><span data-stu-id="414f4-174">Both the antecedent and the continuation pause regularly for random intervals.</span></span> <span data-ttu-id="414f4-175">Kromě toho <xref:System.Threading.Timer?displayProperty=nameWithType> objekt se používá `Elapsed` ke spuštění metody po pětisekundový časový interval.</span><span class="sxs-lookup"><span data-stu-id="414f4-175">In addition, a <xref:System.Threading.Timer?displayProperty=nameWithType> object is used to execute the `Elapsed` method after a five-second timeout interval.</span></span> <span data-ttu-id="414f4-176">Tento příklad <xref:System.Threading.CancellationTokenSource.Cancel%2A?displayProperty=nameWithType> volá metodu, která způsobí, že <xref:System.Threading.CancellationToken.ThrowIfCancellationRequested%2A?displayProperty=nameWithType> aktuálně spuštěná úloha volá metodu.</span><span class="sxs-lookup"><span data-stu-id="414f4-176">This example calls the <xref:System.Threading.CancellationTokenSource.Cancel%2A?displayProperty=nameWithType> method, which causes the currently executing task to call the <xref:System.Threading.CancellationToken.ThrowIfCancellationRequested%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="414f4-177">Zda <xref:System.Threading.CancellationTokenSource.Cancel%2A?displayProperty=nameWithType> je metoda volána při předchůdce nebo jeho pokračování je provádění závisí na dobu trvání náhodně generované pauzy.</span><span class="sxs-lookup"><span data-stu-id="414f4-177">Whether the <xref:System.Threading.CancellationTokenSource.Cancel%2A?displayProperty=nameWithType> method is called when the antecedent or its continuation is executing depends on the duration of the randomly generated pauses.</span></span> <span data-ttu-id="414f4-178">Pokud předchůdce je zrušena, pokračování se nespustí.</span><span class="sxs-lookup"><span data-stu-id="414f4-178">If the antecedent is canceled, the continuation will not start.</span></span> <span data-ttu-id="414f4-179">Pokud předchůdce není zrušena, token lze stále použít ke zrušení pokračování.</span><span class="sxs-lookup"><span data-stu-id="414f4-179">If the antecedent is not canceled, the token can still be used to cancel the continuation.</span></span>  
  
 [!code-csharp[TPL_Continuations#3](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/cancellation1.cs#3)]
 [!code-vb[TPL_Continuations#3](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/cancellation1.vb#3)]  
  
 <span data-ttu-id="414f4-180">Můžete také zabránit pokračování v provádění, pokud jeho předchůdce je zrušena bez poskytnutí pokračování <xref:System.Threading.Tasks.TaskContinuationOptions.NotOnCanceled?displayProperty=nameWithType> token zrušení zadáním možnosti při vytváření pokračování.</span><span class="sxs-lookup"><span data-stu-id="414f4-180">You can also prevent a continuation from executing if its antecedent is canceled without supplying the continuation a cancellation token by specifying the <xref:System.Threading.Tasks.TaskContinuationOptions.NotOnCanceled?displayProperty=nameWithType> option when you create the continuation.</span></span> <span data-ttu-id="414f4-181">Následuje jednoduchý příklad.</span><span class="sxs-lookup"><span data-stu-id="414f4-181">The following is a simple example.</span></span>  
  
 [!code-csharp[TPL_Continuations#8](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/cancellation2.cs#8)]
 [!code-vb[TPL_Continuations#8](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/cancellation2.vb#8)]  
  
 <span data-ttu-id="414f4-182">Po pokračování přejde <xref:System.Threading.Tasks.TaskStatus.Canceled> do stavu, může ovlivnit pokračování, <xref:System.Threading.Tasks.TaskContinuationOptions> které následují, v závislosti na které byly určeny pro tyto pokračování.</span><span class="sxs-lookup"><span data-stu-id="414f4-182">After a continuation goes into the <xref:System.Threading.Tasks.TaskStatus.Canceled> state, it may affect continuations that follow, depending on the <xref:System.Threading.Tasks.TaskContinuationOptions> that were specified for those continuations.</span></span>  
  
 <span data-ttu-id="414f4-183">Pokračování, které jsou uvolněny nespustí.</span><span class="sxs-lookup"><span data-stu-id="414f4-183">Continuations that are disposed will not start.</span></span>  
  
## <a name="continuations-and-child-tasks"></a><span data-ttu-id="414f4-184">Pokračování a podřízené úkoly</span><span class="sxs-lookup"><span data-stu-id="414f4-184">Continuations and Child Tasks</span></span>  
 <span data-ttu-id="414f4-185">Pokračování nespustí, dokud předchůdce a všechny jeho připojené podřízené úkoly byly dokončeny.</span><span class="sxs-lookup"><span data-stu-id="414f4-185">A continuation does not run until the antecedent and all of its attached child tasks have completed.</span></span> <span data-ttu-id="414f4-186">Pokračování nečeká na dokončení odpojených podřízených úloh.</span><span class="sxs-lookup"><span data-stu-id="414f4-186">The continuation does not wait for detached child tasks to finish.</span></span> <span data-ttu-id="414f4-187">Následující dva příklady ilustrují podřízené úkoly, které jsou připojeny k předchůdce, který vytváří pokračování a odnímaly je od předchozího.</span><span class="sxs-lookup"><span data-stu-id="414f4-187">The following two examples illustrate child tasks that are attached to and detached from an antecedent that creates a continuation.</span></span> <span data-ttu-id="414f4-188">V následujícím příkladu pokračování spustí pouze po dokončení všech podřízených úloh a spuštění příkladu vícekrát vytvoří stejný výstup pokaždé.</span><span class="sxs-lookup"><span data-stu-id="414f4-188">In the following example, the continuation runs only after all child tasks have completed, and running the example multiple times produces identical output each time.</span></span> <span data-ttu-id="414f4-189">Příklad spustí předchůdce voláním <xref:System.Threading.Tasks.TaskFactory.StartNew%2A?displayProperty=nameWithType> metody, protože ve výchozím <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> nastavení metoda vytvoří nadřazený úkol, jehož výchozí možnost vytvoření úkolu je <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="414f4-189">The example launches the antecedent by calling the <xref:System.Threading.Tasks.TaskFactory.StartNew%2A?displayProperty=nameWithType> method, since by default the <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> method creates a parent task whose default task creation option is <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType>.</span></span>  
  
 [!code-csharp[TPL_Continuations#9](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/attached1.cs#9)]
 [!code-vb[TPL_Continuations#9](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/attached1.vb#9)]  
  
 <span data-ttu-id="414f4-190">Pokud podřízené úkoly jsou odpojeny od předchůdce, ale pokračování spustí, jakmile předchůdce byl ukončen, bez ohledu na stav podřízené úkoly.</span><span class="sxs-lookup"><span data-stu-id="414f4-190">If child tasks are detached from the antecedent, however, the continuation runs as soon as the antecedent has terminated, regardless of the state of the child tasks.</span></span> <span data-ttu-id="414f4-191">V důsledku toho více spuštění v následujícím příkladu můžete vytvořit variabilní výstup, který závisí na tom, jak plánovač úloh zpracovány každé podřízené úlohy.</span><span class="sxs-lookup"><span data-stu-id="414f4-191">As a result, multiple runs of the following example can produce variable output that depends on how the task scheduler handled each child task.</span></span>  
  
 [!code-csharp[TPL_Continuations#10](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/detached1.cs#10)]
 [!code-vb[TPL_Continuations#10](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/detached1.vb#10)]  
  
 <span data-ttu-id="414f4-192">Konečný stav předchozí úlohy závisí na konečném stavu všech připojených podřízených úkolů.</span><span class="sxs-lookup"><span data-stu-id="414f4-192">The final status of the antecedent task depends on the final status of any attached child tasks.</span></span> <span data-ttu-id="414f4-193">Stav odpojených podřízených úkolů nemá vliv na nadřazenou položku.</span><span class="sxs-lookup"><span data-stu-id="414f4-193">The status of detached child tasks does not affect the parent.</span></span> <span data-ttu-id="414f4-194">Další informace naleznete v [tématu Attached and Detached Child Tasks](../../../docs/standard/parallel-programming/attached-and-detached-child-tasks.md).</span><span class="sxs-lookup"><span data-stu-id="414f4-194">For more information, see [Attached and Detached Child Tasks](../../../docs/standard/parallel-programming/attached-and-detached-child-tasks.md).</span></span>  
  
## <a name="associating-state-with-continuations"></a><span data-ttu-id="414f4-195">Soupozování státu s pokračováním</span><span class="sxs-lookup"><span data-stu-id="414f4-195">Associating State with Continuations</span></span>  
 <span data-ttu-id="414f4-196">K pokračování úkolu můžete přidružit libovolný stav.</span><span class="sxs-lookup"><span data-stu-id="414f4-196">You can associate arbitrary state with a task continuation.</span></span> <span data-ttu-id="414f4-197">Metoda <xref:System.Threading.Tasks.Task.ContinueWith%2A> poskytuje přetížené verze, které <xref:System.Object> každý trvat hodnotu, která představuje stav pokračování.</span><span class="sxs-lookup"><span data-stu-id="414f4-197">The <xref:System.Threading.Tasks.Task.ContinueWith%2A> method provides overloaded versions that each take an <xref:System.Object> value that represents the state of the continuation.</span></span> <span data-ttu-id="414f4-198">Později můžete přistupovat k <xref:System.Threading.Tasks.Task.AsyncState%2A?displayProperty=nameWithType> tomuto objektu stavu pomocí vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="414f4-198">You can later access this state object by using the <xref:System.Threading.Tasks.Task.AsyncState%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="414f4-199">Tento objekt `null` stavu je, pokud nezadáte hodnotu.</span><span class="sxs-lookup"><span data-stu-id="414f4-199">This state object is `null` if you do not provide a value.</span></span>  
  
 <span data-ttu-id="414f4-200">Stav pokračování je užitečný při převodu existujícího kódu, který používá [asynchronní programovací model (APM)](../../../docs/standard/asynchronous-programming-patterns/asynchronous-programming-model-apm.md) k použití TPL.</span><span class="sxs-lookup"><span data-stu-id="414f4-200">Continuation state is useful when you convert existing code that uses the [Asynchronous Programming Model (APM)](../../../docs/standard/asynchronous-programming-patterns/asynchronous-programming-model-apm.md) to use the TPL.</span></span> <span data-ttu-id="414f4-201">V APM obvykle poskytujete stav objektu v **metodě Begin**_Method_ a <xref:System.IAsyncResult.AsyncState%2A?displayProperty=nameWithType> později přistupujete k tomuto stavu pomocí vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="414f4-201">In the APM, you typically provide object state in the **Begin**_Method_ method and later access that state by using the <xref:System.IAsyncResult.AsyncState%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="414f4-202">Pomocí <xref:System.Threading.Tasks.Task.ContinueWith%2A> metody můžete zachovat tento stav při převodu kódu, který používá APM pro použití TPL.</span><span class="sxs-lookup"><span data-stu-id="414f4-202">By using the <xref:System.Threading.Tasks.Task.ContinueWith%2A> method, you can preserve this state when you convert code that uses the APM to use the TPL.</span></span>  
  
 <span data-ttu-id="414f4-203">Stav pokračování může být také <xref:System.Threading.Tasks.Task> užitečné při práci s objekty v ladicím programu sady Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="414f4-203">Continuation state can also be useful when you work with <xref:System.Threading.Tasks.Task> objects in the Visual Studio debugger.</span></span> <span data-ttu-id="414f4-204">Například v okně **Paralelní úkoly** se ve sloupci **Úkol** zobrazí řetězcová reprezentace objektu stavu pro každou úlohu.</span><span class="sxs-lookup"><span data-stu-id="414f4-204">For example, in the **Parallel Tasks** window, the **Task** column displays the string representation of the state object for each task.</span></span> <span data-ttu-id="414f4-205">Další informace o okně **Paralelní úkoly** naleznete [v tématu Použití okna Úkoly](/visualstudio/debugger/using-the-tasks-window).</span><span class="sxs-lookup"><span data-stu-id="414f4-205">For more information about the **Parallel Tasks** window, see [Using the Tasks Window](/visualstudio/debugger/using-the-tasks-window).</span></span>  
  
 <span data-ttu-id="414f4-206">Následující příklad ukazuje, jak použít stav pokračování.</span><span class="sxs-lookup"><span data-stu-id="414f4-206">The following example shows how to use continuation state.</span></span> <span data-ttu-id="414f4-207">Vytvoří řetězec pokračování úlohy.</span><span class="sxs-lookup"><span data-stu-id="414f4-207">It creates a chain of continuation tasks.</span></span> <span data-ttu-id="414f4-208">Každý úkol poskytuje aktuální <xref:System.DateTime> čas, objekt, `state` pro <xref:System.Threading.Tasks.Task.ContinueWith%2A> parametr metody.</span><span class="sxs-lookup"><span data-stu-id="414f4-208">Each task provides the current time, a <xref:System.DateTime> object, for the `state` parameter of the <xref:System.Threading.Tasks.Task.ContinueWith%2A> method.</span></span> <span data-ttu-id="414f4-209">Každý <xref:System.DateTime> objekt představuje čas, kdy je vytvořena úloha pokračování.</span><span class="sxs-lookup"><span data-stu-id="414f4-209">Each <xref:System.DateTime> object represents the time at which the continuation task is created.</span></span> <span data-ttu-id="414f4-210">Každý úkol vytvoří jako svůj <xref:System.DateTime> výsledek druhý objekt, který představuje čas dokončení úkolu.</span><span class="sxs-lookup"><span data-stu-id="414f4-210">Each task produces as its result a second <xref:System.DateTime> object that represents the time at which the task finishes.</span></span> <span data-ttu-id="414f4-211">Po dokončení všech úkolů se v tomto příkladu zobrazí čas vytvoření a čas dokončení každé úlohy pokračování.</span><span class="sxs-lookup"><span data-stu-id="414f4-211">After all tasks finish, this example displays the creation time and the time at which each continuation task finishes.</span></span>  
  
 [!code-csharp[TPL_ContinuationState#1](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuationstate/cs/continuationstate.cs#1)]
 [!code-vb[TPL_ContinuationState#1](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuationstate/vb/continuationstate.vb#1)]  
  
## <a name="handling-exceptions-thrown-from-continuations"></a><span data-ttu-id="414f4-212">Zpracování výjimek vyzdvižených z pokračování</span><span class="sxs-lookup"><span data-stu-id="414f4-212">Handling Exceptions Thrown from Continuations</span></span>  
 <span data-ttu-id="414f4-213">Vztah předchůdce a pokračování není vztah nadřazený podřízený.</span><span class="sxs-lookup"><span data-stu-id="414f4-213">An antecedent-continuation relationship is not a parent-child relationship.</span></span> <span data-ttu-id="414f4-214">Výjimky vyzývané pokračováním nejsou šířeny do předchůdce.</span><span class="sxs-lookup"><span data-stu-id="414f4-214">Exceptions thrown by continuations are not propagated to the antecedent.</span></span> <span data-ttu-id="414f4-215">Proto zpracovat výjimky vyvoláné pokračování jako byste je zpracovat v jakékoli jiné úlohy, takto:</span><span class="sxs-lookup"><span data-stu-id="414f4-215">Therefore, handle exceptions thrown by continuations as you would handle them in any other task, as follows:</span></span>  
  
- <span data-ttu-id="414f4-216">Můžete použít <xref:System.Threading.Tasks.Task.Wait%2A>, <xref:System.Threading.Tasks.Task.WaitAll%2A>nebo <xref:System.Threading.Tasks.Task.WaitAny%2A> metoda nebo jeho obecný protějšek, čekat na pokračování.</span><span class="sxs-lookup"><span data-stu-id="414f4-216">You can use the <xref:System.Threading.Tasks.Task.Wait%2A>, <xref:System.Threading.Tasks.Task.WaitAll%2A>, or <xref:System.Threading.Tasks.Task.WaitAny%2A> method, or its generic counterpart, to wait on the continuation.</span></span> <span data-ttu-id="414f4-217">Můžete počkat na předchůdce a jeho pokračování `try` ve stejném příkazu, jak je znázorněno v následujícím příkladu.</span><span class="sxs-lookup"><span data-stu-id="414f4-217">You can wait for an antecedent and its continuations in the same `try` statement, as shown in the following example.</span></span>  
  
     [!code-csharp[TPL_Continuations#6](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/exception1.cs#6)]
     [!code-vb[TPL_Continuations#6](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/exception1.vb#6)]  
  
- <span data-ttu-id="414f4-218">Můžete použít druhé pokračování sledovat <xref:System.Threading.Tasks.Task.Exception%2A> vlastnost první pokračování.</span><span class="sxs-lookup"><span data-stu-id="414f4-218">You can use a second continuation to observe the <xref:System.Threading.Tasks.Task.Exception%2A> property of the first continuation.</span></span> <span data-ttu-id="414f4-219">V následujícím příkladu se úloha pokusí číst z neexistujícího souboru.</span><span class="sxs-lookup"><span data-stu-id="414f4-219">In the following example, a task attempts to read from a non-existent file.</span></span> <span data-ttu-id="414f4-220">Pokračování pak zobrazí informace o výjimce v předchozí úloze.</span><span class="sxs-lookup"><span data-stu-id="414f4-220">The continuation then displays information about the exception in the antecedent task.</span></span>  
  
     [!code-csharp[TPL_Continuations#4](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/exception2.cs#4)]
     [!code-vb[TPL_Continuations#4](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/exception2.vb#4)]  
  
     <span data-ttu-id="414f4-221">Vzhledem k tomu, že byla spuštěna s <xref:System.Threading.Tasks.TaskContinuationOptions.OnlyOnFaulted?displayProperty=nameWithType> možností, pokračování provede pouze v případě, že dojde k <xref:System.Threading.Tasks.Task.Exception%2A> výjimce v předchůdce, a proto lze předpokládat, že vlastnost předchůdce není `null`.</span><span class="sxs-lookup"><span data-stu-id="414f4-221">Because it was run with the <xref:System.Threading.Tasks.TaskContinuationOptions.OnlyOnFaulted?displayProperty=nameWithType> option, the continuation executes only if an exception occurs in the antecedent, and therefore it can assume that the antecedent's <xref:System.Threading.Tasks.Task.Exception%2A> property is not `null`.</span></span> <span data-ttu-id="414f4-222">Pokud pokračování provede, zda je vyvolána výjimka v předchůdce, bude muset zkontrolovat, zda <xref:System.Threading.Tasks.Task.Exception%2A> předchůdce vlastnost `null` není před pokusem o zpracování výjimky, jak ukazuje následující fragment kódu.</span><span class="sxs-lookup"><span data-stu-id="414f4-222">If the continuation executes whether or not an exception is thrown in the antecedent, it would have to check whether the antecedent's <xref:System.Threading.Tasks.Task.Exception%2A> property is not `null` before attempting to handle the exception, as the following code fragment shows.</span></span>  
  
     [!code-csharp[TPL_Continuations#11](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/exception2.cs#11)]
     [!code-vb[TPL_Continuations#11](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/exception2.vb#11)]  
  
     <span data-ttu-id="414f4-223">Další informace naleznete v [tématu Zpracování výjimek](../../../docs/standard/parallel-programming/exception-handling-task-parallel-library.md).</span><span class="sxs-lookup"><span data-stu-id="414f4-223">For more information, see [Exception Handling](../../../docs/standard/parallel-programming/exception-handling-task-parallel-library.md).</span></span>  
  
- <span data-ttu-id="414f4-224">Pokud pokračování je připojen podřízený úkol, který <xref:System.Threading.Tasks.TaskContinuationOptions.AttachedToParent?displayProperty=nameWithType> byl vytvořen pomocí možnosti, jeho výjimky budou rozšířeny nadřazené zpět do volajícího vlákna, jako je tomu v případě jakékoli jiné připojené podřízené.</span><span class="sxs-lookup"><span data-stu-id="414f4-224">If the continuation is an attached child task that was created by using the <xref:System.Threading.Tasks.TaskContinuationOptions.AttachedToParent?displayProperty=nameWithType> option, its exceptions will be propagated by the parent back to the calling thread, as is the case in any other attached child.</span></span> <span data-ttu-id="414f4-225">Další informace naleznete v [tématu Attached and Detached Child Tasks](../../../docs/standard/parallel-programming/attached-and-detached-child-tasks.md).</span><span class="sxs-lookup"><span data-stu-id="414f4-225">For more information, see [Attached and Detached Child Tasks](../../../docs/standard/parallel-programming/attached-and-detached-child-tasks.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="414f4-226">Viz také</span><span class="sxs-lookup"><span data-stu-id="414f4-226">See also</span></span>

- [<span data-ttu-id="414f4-227">Task Parallel Library (TPL)</span><span class="sxs-lookup"><span data-stu-id="414f4-227">Task Parallel Library (TPL)</span></span>](../../../docs/standard/parallel-programming/task-parallel-library-tpl.md)
