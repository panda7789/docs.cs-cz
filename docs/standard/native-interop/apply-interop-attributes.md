---
title: Použití atributů spolupráce
description: Tento článek shrnuje atributy zprostředkovatele komunikace s objekty COM v oboru názvů System. Runtime. InteropServices, včetně atributů doby návrhu a nástroje pro převod.
ms.date: 03/30/2017
helpviewer_keywords:
- design-time attributes
- .NET Framework, exposing components to COM
- attributes [.NET Framework], design-time functionality
- conversion-tool attributes
- attributes [.NET Framework], interop-specific
- attributes [.NET Framework], conversion-tool
- interoperation with unmanaged code, applying attributes
- interoperation with unmanaged code, exposing .NET Framework components
- COM interop, exposing COM components
- COM interop, applying attributes
ms.assetid: b6014613-641c-4912-9e2f-83a99210a037
ms.openlocfilehash: 831f8d79030264ef013a75cd91cb771c9d168576
ms.sourcegitcommit: 9a4488a3625866335e83a20da5e9c5286b1f034c
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/15/2020
ms.locfileid: "83420536"
---
# <a name="applying-interop-attributes"></a><span data-ttu-id="b2b11-103">Použití atributů spolupráce</span><span class="sxs-lookup"><span data-stu-id="b2b11-103">Applying Interop Attributes</span></span>
<span data-ttu-id="b2b11-104"><xref:System.Runtime.InteropServices>Obor názvů poskytuje tři kategorie atributů specifických pro spolupráci: ty, které jste použili v době návrhu, ty, které byly aplikovány pomocí nástrojů spolupráce modelu COM a rozhraní API během procesu převodu a které byly aplikovány vámi nebo zprostředkovatelem komunikace s objekty com.</span><span class="sxs-lookup"><span data-stu-id="b2b11-104">The <xref:System.Runtime.InteropServices> namespace provides three categories of interop-specific attributes: those applied by you at design time, those applied by COM interop tools and APIs during the conversion process, and those applied either by you or COM interop.</span></span>  
  
 <span data-ttu-id="b2b11-105">Pokud nejste obeznámeni s úlohou použití atributů pro spravovaný kód, přečtěte si téma [rozšíření metadat pomocí atributů](../../../docs/standard/attributes/index.md).</span><span class="sxs-lookup"><span data-stu-id="b2b11-105">If you are unfamiliar with the task of applying attributes to managed code, see [Extending Metadata Using Attributes](../../../docs/standard/attributes/index.md).</span></span> <span data-ttu-id="b2b11-106">Podobně jako u jiných vlastních atributů můžete použít atributy specifické pro spolupráci na typy, metody, vlastnosti, parametry, pole a další členy.</span><span class="sxs-lookup"><span data-stu-id="b2b11-106">Like other custom attributes, you can apply interop-specific attributes to types, methods, properties, parameters, fields, and other members.</span></span>  
  
## <a name="design-time-attributes"></a><span data-ttu-id="b2b11-107">Atributy doby návrhu</span><span class="sxs-lookup"><span data-stu-id="b2b11-107">Design-Time Attributes</span></span>  
 <span data-ttu-id="b2b11-108">Můžete upravit výsledek procesu převodu prováděného pomocí nástrojů pro spolupráci s objekty COM a rozhraní API pomocí atributů pro dobu návrhu.</span><span class="sxs-lookup"><span data-stu-id="b2b11-108">You can adjust the outcome of the conversion process performed by COM interop tools and APIs by using design-time attributes.</span></span> <span data-ttu-id="b2b11-109">Následující tabulka popisuje atributy, které lze použít pro spravovaný zdrojový kód.</span><span class="sxs-lookup"><span data-stu-id="b2b11-109">The following table describes the attributes that you can apply to your managed source code.</span></span> <span data-ttu-id="b2b11-110">Nástroje pro vzájemné spolupráce modelu COM mohou také použít atributy popsané v této tabulce.</span><span class="sxs-lookup"><span data-stu-id="b2b11-110">COM interop tools, on occasion, might also apply the attributes described in this table.</span></span>  
  
|<span data-ttu-id="b2b11-111">Atribut</span><span class="sxs-lookup"><span data-stu-id="b2b11-111">Attribute</span></span>|<span data-ttu-id="b2b11-112">Popis</span><span class="sxs-lookup"><span data-stu-id="b2b11-112">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.AutomationProxyAttribute>|<span data-ttu-id="b2b11-113">Určuje, zda má být typ zařazen pomocí zařazovacího modulu automatizace nebo vlastního proxy a zástupné procedury.</span><span class="sxs-lookup"><span data-stu-id="b2b11-113">Specifies whether the type should be marshaled using the Automation marshaler or a custom proxy and stub.</span></span>|  
|<xref:System.Runtime.InteropServices.ClassInterfaceAttribute>|<span data-ttu-id="b2b11-114">Řídí typ rozhraní generovaného pro třídu.</span><span class="sxs-lookup"><span data-stu-id="b2b11-114">Controls the type of interface generated for a class.</span></span>|  
|<xref:System.Runtime.InteropServices.CoClassAttribute>|<span data-ttu-id="b2b11-115">Určuje identifikátor CLSID původní coclass importované z knihovny typů.</span><span class="sxs-lookup"><span data-stu-id="b2b11-115">Identifies the CLSID of the original coclass imported from a type library.</span></span><br /><br /> <span data-ttu-id="b2b11-116">Nástroje zprostředkovatele komunikace s objekty COM obvykle používají tento atribut.</span><span class="sxs-lookup"><span data-stu-id="b2b11-116">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComImportAttribute>|<span data-ttu-id="b2b11-117">Označuje, že definice typu coclass nebo rozhraní byla naimportována z knihovny typů modelu COM.</span><span class="sxs-lookup"><span data-stu-id="b2b11-117">Indicates that a coclass or interface definition was imported from a COM type library.</span></span> <span data-ttu-id="b2b11-118">Modul runtime pomocí tohoto příznaku informuje o tom, jak typ aktivovat a zařadit.</span><span class="sxs-lookup"><span data-stu-id="b2b11-118">The runtime uses this flag to know how to activate and marshal the type.</span></span> <span data-ttu-id="b2b11-119">Tento atribut zakazuje export typu zpět do knihovny typů.</span><span class="sxs-lookup"><span data-stu-id="b2b11-119">This attribute prohibits the type from being exported back to a type library.</span></span><br /><br /> <span data-ttu-id="b2b11-120">Nástroje zprostředkovatele komunikace s objekty COM obvykle používají tento atribut.</span><span class="sxs-lookup"><span data-stu-id="b2b11-120">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComRegisterFunctionAttribute>|<span data-ttu-id="b2b11-121">Označuje, že metoda by měla být volána, když je sestavení registrováno pro použití z modelu COM, aby bylo možné během procesu registrace spustit uživatelsky psaný kód.</span><span class="sxs-lookup"><span data-stu-id="b2b11-121">Indicates that a method should be called when the assembly is registered for use from COM, so that user-written code can be executed during the registration process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComSourceInterfacesAttribute>|<span data-ttu-id="b2b11-122">Označuje rozhraní, která jsou zdrojem událostí pro třídu.</span><span class="sxs-lookup"><span data-stu-id="b2b11-122">Identifies interfaces that are sources of events for the class.</span></span><br /><br /> <span data-ttu-id="b2b11-123">Nástroje pro spolupráci s objekty COM mohou použít tento atribut.</span><span class="sxs-lookup"><span data-stu-id="b2b11-123">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComUnregisterFunctionAttribute>|<span data-ttu-id="b2b11-124">Označuje, že metoda by měla být volána, když je zrušena registrace sestavení z modelu COM, aby mohl být během procesu proveden uživatelsky napsaný kód.</span><span class="sxs-lookup"><span data-stu-id="b2b11-124">Indicates that a method should be called when the assembly is unregistered from COM, so that user-written code can execute during the process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComVisibleAttribute>|<span data-ttu-id="b2b11-125">Pokud se hodnota atributu rovná **false**, vykresluje se typy neviditelné na com.</span><span class="sxs-lookup"><span data-stu-id="b2b11-125">Renders types invisible to COM when the attribute value equals **false**.</span></span> <span data-ttu-id="b2b11-126">Tento atribut lze použít na jednotlivý typ nebo na celé sestavení pro řízení viditelnosti modelu COM.</span><span class="sxs-lookup"><span data-stu-id="b2b11-126">This attribute can be applied to an individual type or to an entire assembly to control COM visibility.</span></span> <span data-ttu-id="b2b11-127">Ve výchozím nastavení jsou viditelné všechny spravované, veřejné typy. atribut není nutné, aby jej bylo možné zobrazit.</span><span class="sxs-lookup"><span data-stu-id="b2b11-127">By default, all managed, public types are visible; the attribute is not needed to make them visible.</span></span>|  
|<xref:System.Runtime.InteropServices.DispIdAttribute>|<span data-ttu-id="b2b11-128">Určuje identifikátor odeslání objektu COM (DISPID) metody nebo pole.</span><span class="sxs-lookup"><span data-stu-id="b2b11-128">Specifies the COM dispatch identifier (DISPID) of a method or field.</span></span> <span data-ttu-id="b2b11-129">Tento atribut obsahuje identifikátor DISPID pro metodu, pole nebo vlastnost, kterou popisuje.</span><span class="sxs-lookup"><span data-stu-id="b2b11-129">This attribute contains the DISPID for the method, field, or property it describes.</span></span><br /><br /> <span data-ttu-id="b2b11-130">Nástroje pro spolupráci s objekty COM mohou použít tento atribut.</span><span class="sxs-lookup"><span data-stu-id="b2b11-130">COM interop tools can apply this attribute.</span></span>|
|<xref:System.Runtime.InteropServices.ComDefaultInterfaceAttribute>|<span data-ttu-id="b2b11-131">Označuje výchozí rozhraní pro třídu COM implementovanou v rozhraní .NET.</span><span class="sxs-lookup"><span data-stu-id="b2b11-131">Indicates the default interface for a COM class implemented in .NET.</span></span><br /><br /> <span data-ttu-id="b2b11-132">Nástroje pro spolupráci s objekty COM mohou použít tento atribut.</span><span class="sxs-lookup"><span data-stu-id="b2b11-132">COM interop tools can apply this attribute.</span></span>|
|<xref:System.Runtime.InteropServices.FieldOffsetAttribute>|<span data-ttu-id="b2b11-133">Označuje fyzickou pozici každého pole v rámci třídy při použití s **StructLayoutAttribute**a **LayoutKind** je nastaven na hodnotu Explicit.</span><span class="sxs-lookup"><span data-stu-id="b2b11-133">Indicates the physical position of each field within a class when used with the **StructLayoutAttribute**, and the **LayoutKind** is set to Explicit.</span></span>|  
|<xref:System.Runtime.InteropServices.GuidAttribute>|<span data-ttu-id="b2b11-134">Určuje globálně jedinečný identifikátor (GUID) třídy, rozhraní nebo celé knihovny typů.</span><span class="sxs-lookup"><span data-stu-id="b2b11-134">Specifies the globally unique identifier (GUID) of a class, interface, or an entire type library.</span></span> <span data-ttu-id="b2b11-135">Řetězec předaný atributu musí být formát, který je přijatelným argumentem konstruktoru pro typ **System. GUID**.</span><span class="sxs-lookup"><span data-stu-id="b2b11-135">The string passed to the attribute must be a format that is an acceptable constructor argument for the type **System.Guid**.</span></span><br /><br /> <span data-ttu-id="b2b11-136">Nástroje pro spolupráci s objekty COM mohou použít tento atribut.</span><span class="sxs-lookup"><span data-stu-id="b2b11-136">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.IDispatchImplAttribute>|<span data-ttu-id="b2b11-137">Určuje, která implementace rozhraní **IDispatch** používá modul CLR při vystavování duálních rozhraní a IDispatch do modelu COM.</span><span class="sxs-lookup"><span data-stu-id="b2b11-137">Indicates which **IDispatch** interface implementation the common language runtime uses when exposing dual interfaces and dispinterfaces to COM.</span></span>|  
|<xref:System.Runtime.InteropServices.InAttribute>|<span data-ttu-id="b2b11-138">Označuje, že data by měla být zařazena do volajícího.</span><span class="sxs-lookup"><span data-stu-id="b2b11-138">Indicates that data should be marshaled in to the caller.</span></span> <span data-ttu-id="b2b11-139">Dá se použít k parametrům atributů.</span><span class="sxs-lookup"><span data-stu-id="b2b11-139">Can be used to attribute parameters.</span></span>|  
|<xref:System.Runtime.InteropServices.InterfaceTypeAttribute>|<span data-ttu-id="b2b11-140">Řídí způsob zpřístupnění spravovaného rozhraní klientům modelu COM (pouze duální, IUnknown-odvozený nebo IDispatch).</span><span class="sxs-lookup"><span data-stu-id="b2b11-140">Controls how a managed interface is exposed to COM clients (Dual, IUnknown-derived, or IDispatch only).</span></span><br /><br /> <span data-ttu-id="b2b11-141">Nástroje pro spolupráci s objekty COM mohou použít tento atribut.</span><span class="sxs-lookup"><span data-stu-id="b2b11-141">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.LCIDConversionAttribute>|<span data-ttu-id="b2b11-142">Označuje, že signatura nespravované metody očekává parametr LCID.</span><span class="sxs-lookup"><span data-stu-id="b2b11-142">Indicates that an unmanaged method signature expects an LCID parameter.</span></span><br /><br /> <span data-ttu-id="b2b11-143">Nástroje pro spolupráci s objekty COM mohou použít tento atribut.</span><span class="sxs-lookup"><span data-stu-id="b2b11-143">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.MarshalAsAttribute>|<span data-ttu-id="b2b11-144">Určuje, jak mají být data v polích nebo parametrech zařazena mezi spravovaný a nespravovaný kód.</span><span class="sxs-lookup"><span data-stu-id="b2b11-144">Indicates how the data in fields or parameters should be marshaled between managed and unmanaged code.</span></span> <span data-ttu-id="b2b11-145">Atribut je vždy volitelný, protože každý datový typ má výchozí chování zařazování.</span><span class="sxs-lookup"><span data-stu-id="b2b11-145">The attribute is always optional because each data type has default marshaling behavior.</span></span><br /><br /> <span data-ttu-id="b2b11-146">Nástroje pro spolupráci s objekty COM mohou použít tento atribut.</span><span class="sxs-lookup"><span data-stu-id="b2b11-146">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OptionalAttribute>|<span data-ttu-id="b2b11-147">Označuje, že parametr je nepovinný.</span><span class="sxs-lookup"><span data-stu-id="b2b11-147">Indicates that a parameter is optional.</span></span><br /><br /> <span data-ttu-id="b2b11-148">Nástroje pro spolupráci s objekty COM mohou použít tento atribut.</span><span class="sxs-lookup"><span data-stu-id="b2b11-148">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OutAttribute>|<span data-ttu-id="b2b11-149">Označuje, že data v poli nebo parametru musí být zařazena z pojmenovaného objektu zpět na jeho volajícího.</span><span class="sxs-lookup"><span data-stu-id="b2b11-149">Indicates that the data in a field or parameter must be marshaled from a called object back to its caller.</span></span>|  
|<xref:System.Runtime.InteropServices.PreserveSigAttribute>|<span data-ttu-id="b2b11-150">Potlačí transformaci signatury HRESULT nebo retval, která obvykle probíhá během volání meziprovozu.</span><span class="sxs-lookup"><span data-stu-id="b2b11-150">Suppresses the HRESULT or retval signature transformation that normally takes place during interoperation calls.</span></span> <span data-ttu-id="b2b11-151">Atribut ovlivňuje zařazování i export knihovny typů.</span><span class="sxs-lookup"><span data-stu-id="b2b11-151">The attribute affects marshaling as well as type library exporting.</span></span><br /><br /> <span data-ttu-id="b2b11-152">Nástroje pro spolupráci s objekty COM mohou použít tento atribut.</span><span class="sxs-lookup"><span data-stu-id="b2b11-152">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ProgIdAttribute>|<span data-ttu-id="b2b11-153">Určuje identifikátor ProgID .NET Framework třídy.</span><span class="sxs-lookup"><span data-stu-id="b2b11-153">Specifies the ProgID of a .NET Framework class.</span></span> <span data-ttu-id="b2b11-154">Lze použít pro třídy atributů.</span><span class="sxs-lookup"><span data-stu-id="b2b11-154">Can be used to attribute classes.</span></span>|  
|<xref:System.Runtime.InteropServices.StructLayoutAttribute>|<span data-ttu-id="b2b11-155">Ovládá fyzické rozložení polí třídy.</span><span class="sxs-lookup"><span data-stu-id="b2b11-155">Controls the physical layout of the fields of a class.</span></span><br /><br /> <span data-ttu-id="b2b11-156">Nástroje pro spolupráci s objekty COM mohou použít tento atribut.</span><span class="sxs-lookup"><span data-stu-id="b2b11-156">COM interop tools can apply this attribute.</span></span>|  
  
## <a name="conversion-tool-attributes"></a><span data-ttu-id="b2b11-157">Atributy nástroje pro převod</span><span class="sxs-lookup"><span data-stu-id="b2b11-157">Conversion-Tool Attributes</span></span>  
 <span data-ttu-id="b2b11-158">Následující tabulka popisuje atributy, které se během procesu převodu vztahují na nástroje COM interop Tools.</span><span class="sxs-lookup"><span data-stu-id="b2b11-158">The following table describes attributes that COM interop tools apply during the conversion process.</span></span> <span data-ttu-id="b2b11-159">Tyto atributy nepoužijete v době návrhu.</span><span class="sxs-lookup"><span data-stu-id="b2b11-159">You do not apply these attributes at design time.</span></span>  
  
|<span data-ttu-id="b2b11-160">Atribut</span><span class="sxs-lookup"><span data-stu-id="b2b11-160">Attribute</span></span>|<span data-ttu-id="b2b11-161">Popis</span><span class="sxs-lookup"><span data-stu-id="b2b11-161">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.ComAliasNameAttribute>|<span data-ttu-id="b2b11-162">Označuje alias COM pro parametr nebo typ pole.</span><span class="sxs-lookup"><span data-stu-id="b2b11-162">Indicates the COM alias for a parameter or field type.</span></span> <span data-ttu-id="b2b11-163">Dá se použít k parametrům atributů, polím nebo návratovým hodnotám.</span><span class="sxs-lookup"><span data-stu-id="b2b11-163">Can be used to attribute parameters, fields, or return values.</span></span>|  
|<xref:System.Runtime.InteropServices.ComConversionLossAttribute>|<span data-ttu-id="b2b11-164">Označuje, že informace o třídě nebo rozhraní byly při importu z knihovny typů do sestavení ztraceny.</span><span class="sxs-lookup"><span data-stu-id="b2b11-164">Indicates that information about a class or interface was lost when it was imported from a type library to an assembly.</span></span>|  
|<xref:System.Runtime.InteropServices.ComEventInterfaceAttribute>|<span data-ttu-id="b2b11-165">Identifikuje zdrojové rozhraní a třídu, která implementuje metody rozhraní události.</span><span class="sxs-lookup"><span data-stu-id="b2b11-165">Identifies the source interface and the class that implements the methods of the event interface.</span></span>|  
|<xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute>|<span data-ttu-id="b2b11-166">Označuje, že bylo sestavení původně importováno z knihovny typů modelu COM.</span><span class="sxs-lookup"><span data-stu-id="b2b11-166">Indicates that the assembly was originally imported from a COM type library.</span></span> <span data-ttu-id="b2b11-167">Tento atribut obsahuje definici knihovny typů původní knihovny typů.</span><span class="sxs-lookup"><span data-stu-id="b2b11-167">This attribute contains the type library definition of the original type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibFuncAttribute>|<span data-ttu-id="b2b11-168">Obsahuje **FUNCFLAGS** , které byly původně importovány pro tuto funkci z knihovny typů modelu COM.</span><span class="sxs-lookup"><span data-stu-id="b2b11-168">Contains the **FUNCFLAGS** that were originally imported for this function from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibTypeAttribute>|<span data-ttu-id="b2b11-169">Obsahuje **TYPEFLAGS** , které byly původně importovány pro tento typ z knihovny typů modelu COM.</span><span class="sxs-lookup"><span data-stu-id="b2b11-169">Contains the **TYPEFLAGS** that were originally imported for this type from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibVarAttribute>|<span data-ttu-id="b2b11-170">Obsahuje **VARFLAGS** , které byly původně importovány pro tuto proměnnou z knihovny typů modelu COM.</span><span class="sxs-lookup"><span data-stu-id="b2b11-170">Contains the **VARFLAGS** that were originally imported for this variable from the COM type library.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="b2b11-171">Viz také</span><span class="sxs-lookup"><span data-stu-id="b2b11-171">See also</span></span>

- <xref:System.Runtime.InteropServices>
- [<span data-ttu-id="b2b11-172">Vystavení komponent architektury .NET Framework pro COM</span><span class="sxs-lookup"><span data-stu-id="b2b11-172">Exposing .NET Framework Components to COM</span></span>](../../../docs/framework/interop/exposing-dotnet-components-to-com.md)
- [<span data-ttu-id="b2b11-173">Atributy</span><span class="sxs-lookup"><span data-stu-id="b2b11-173">Attributes</span></span>](../../../docs/standard/attributes/index.md)
- [<span data-ttu-id="b2b11-174">Kvalifikace typů .NET pro spolupráci</span><span class="sxs-lookup"><span data-stu-id="b2b11-174">Qualifying .NET Types for Interoperation</span></span>](../../../docs/standard/native-interop/qualify-net-types-for-interoperation.md)
- [<span data-ttu-id="b2b11-175">Balení .NET Framework sestavení pro model COM</span><span class="sxs-lookup"><span data-stu-id="b2b11-175">Packaging a .NET Framework Assembly for COM</span></span>](../../../docs/framework/interop/packaging-an-assembly-for-com.md)
