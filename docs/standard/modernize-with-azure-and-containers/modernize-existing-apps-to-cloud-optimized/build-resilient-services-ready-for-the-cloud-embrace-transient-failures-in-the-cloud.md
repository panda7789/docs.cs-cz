---
title: Vytváření odolných služeb připravených pro cloud. Zpracování přechodných selhání v cloudu
description: Modernizace stávajících aplikací .NET pomocí cloudu Azure a Windows kontejnery | Vytváření odolných služeb připravených pro cloud. Zpracování přechodných selhání v cloudu
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 04/30/2018
ms.openlocfilehash: 16228321cc788b381603513213130415eb73a95c
ms.sourcegitcommit: ccd8c36b0d74d99291d41aceb14cf98d74dc9d2b
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 12/10/2018
ms.locfileid: "53128853"
---
# <a name="build-resilient-services-ready-for-the-cloud-embrace-transient-failures-in-the-cloud"></a><span data-ttu-id="00e47-105">Vytváření odolných služeb připravených pro cloud: Zpracování přechodných selhání v cloudu</span><span class="sxs-lookup"><span data-stu-id="00e47-105">Build resilient services ready for the cloud: Embrace transient failures in the cloud</span></span>

<span data-ttu-id="00e47-106">Odolnost proti chybám je schopnost zotavení z chyb a nadále fungovat.</span><span class="sxs-lookup"><span data-stu-id="00e47-106">Resiliency is the ability to recover from failures and continue to function.</span></span> <span data-ttu-id="00e47-107">Odolnost proti chybám není o předcházení chybám, ale přijímá skutečnost, že dojde k chybám a pak reagovat na ně způsobem, který zabraňuje výpadkům nebo ztrátě.</span><span class="sxs-lookup"><span data-stu-id="00e47-107">Resiliency is not about avoiding failures, but accepting the fact that failures will occur, and then responding to them in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="00e47-108">Cílem odolnosti proti chybám je plně funkčního stavu aplikace po selhání.</span><span class="sxs-lookup"><span data-stu-id="00e47-108">The goal of resiliency is to return the application to a fully functioning state after a failure.</span></span>

<span data-ttu-id="00e47-109">Vaše aplikace je připravena pro cloud, když minimálně implementuje modelu založeného na softwaru odolnosti proti chybám, nikoli jako model založený na hardwaru.</span><span class="sxs-lookup"><span data-stu-id="00e47-109">Your application is ready for the cloud when, at a minimum, it implements a software-based model of resiliency, rather than a hardware-based model.</span></span> <span data-ttu-id="00e47-110">Vaše Cloudová aplikace musí využívat částečné chyby, ke kterým dojde jistě.</span><span class="sxs-lookup"><span data-stu-id="00e47-110">Your cloud application must embrace the partial failures that will certainly occur.</span></span> <span data-ttu-id="00e47-111">Navrhujete nebo částečně Refaktorovat aplikace k zajištění odolnosti proti chybám s očekávané částečně neúspěšné.</span><span class="sxs-lookup"><span data-stu-id="00e47-111">Design or partially refactor your application to achieve resiliency with expected partial failures.</span></span> <span data-ttu-id="00e47-112">To by se měly navrhovat pro zvládnutí částečně neúspěšné, stejně jako přechodný síťový výpadků a uzly nebo virtuální počítače k chybám v cloudu.</span><span class="sxs-lookup"><span data-stu-id="00e47-112">It should be designed to cope with partial failures, like transient network outages and nodes, or VMs crashing in the cloud.</span></span> <span data-ttu-id="00e47-113">I kontejnery, který se přesouvá na jiný uzel v clusteru služby orchestrator může způsobit krátkodobých krátká selhání v rámci aplikace.</span><span class="sxs-lookup"><span data-stu-id="00e47-113">Even containers being moved to a different node within an orchestrator cluster can cause intermittent short failures within the application.</span></span>

## <a name="handling-partial-failure"></a><span data-ttu-id="00e47-114">Zpracování částečného selhání</span><span class="sxs-lookup"><span data-stu-id="00e47-114">Handling partial failure</span></span>

<span data-ttu-id="00e47-115">V aplikaci založené na cloudu je všudypřítomnou riziko částečného selhání.</span><span class="sxs-lookup"><span data-stu-id="00e47-115">In a cloud-based application, there's an ever-present risk of partial failure.</span></span> <span data-ttu-id="00e47-116">Například instanci jednoho webu nebo kontejner může selhat nebo může být k dispozici nebo neodpovídá na krátkou dobu.</span><span class="sxs-lookup"><span data-stu-id="00e47-116">For instance, a single website instance or a container might fail, or it might be unavailable or unresponsive for a short time.</span></span> <span data-ttu-id="00e47-117">Nebo jeden virtuální počítač nebo server, mohou selhat.</span><span class="sxs-lookup"><span data-stu-id="00e47-117">Or, a single VM or server might crash.</span></span>

<span data-ttu-id="00e47-118">Protože samostatné procesy jsou klientů a služeb, nemusí služba včas reagovat na žádosti klienta.</span><span class="sxs-lookup"><span data-stu-id="00e47-118">Because clients and services are separate processes, a service might not be able to respond in a timely manner to a client's request.</span></span> <span data-ttu-id="00e47-119">Službě mohou být přetížená a pomalé reakce na žádosti, nebo nemusí být dostupná pro krátkého formátu času z důvodu problémů se sítí.</span><span class="sxs-lookup"><span data-stu-id="00e47-119">The service might be overloaded and respond slowly to requests, or it might not be accessible for a short time because of network issues.</span></span>

<span data-ttu-id="00e47-120">Představte si třeba monolitické aplikace .NET, který přistupuje k databázi ve službě Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="00e47-120">For example, consider a monolithic .NET application that accesses a database in Azure SQL Database.</span></span> <span data-ttu-id="00e47-121">Pokud je databáze Azure SQL nebo jakoukoli jinou službu třetí strany reagovat pro stručný čas (Azure SQL database může být přesunut do jiného uzlu nebo na server a nebudou reagovat na několik sekund), když se uživatel pokusí provést žádnou akci, může dojít k selhání aplikace a zobrazit w výjimku ve stejnou chvíli.</span><span class="sxs-lookup"><span data-stu-id="00e47-121">If the Azure SQL database or any other third-party service is unresponsive for a brief time (an Azure SQL database might be moved to a different node or server, and be unresponsive for a few seconds), when the user tries to do any action, the application might crash and show an exception at the same moment.</span></span>

<span data-ttu-id="00e47-122">Informace o podobném scénáři se může stát v aplikaci, která využívá služby HTTP.</span><span class="sxs-lookup"><span data-stu-id="00e47-122">A similar scenario might occur in an app that consumes HTTP services.</span></span> <span data-ttu-id="00e47-123">Síť nebo službu samotnou nemusí být k dispozici v cloudu během krátké, přechodná selhání.</span><span class="sxs-lookup"><span data-stu-id="00e47-123">The network or the service itself might not be available in the cloud during a short, transient failure.</span></span>

<span data-ttu-id="00e47-124">Odolné aplikace zobrazený obrázek 4 – 9, by měly implementovat postupů, jako jsou "opakování pomocí exponenciálního omezení rychlosti" poskytnout příležitosti pro zpracování přechodných selhání v prostředcích aplikace.</span><span class="sxs-lookup"><span data-stu-id="00e47-124">A resilient application like the one shown in Figure 4-9 should implement techniques like "retries with exponential backoff" to give the application an opportunity to handle transient failures in resources.</span></span> <span data-ttu-id="00e47-125">"Jističe" také měli použít ve svých aplikacích.</span><span class="sxs-lookup"><span data-stu-id="00e47-125">You also should use "circuit breakers" in your applications.</span></span> <span data-ttu-id="00e47-126">Jističe přestane aplikace v pokusu o přístup k prostředku, když je ve skutečnosti dlouhodobé selhání.</span><span class="sxs-lookup"><span data-stu-id="00e47-126">A circuit breaker stops an application from trying to access a resource when it's actually a long-term failure.</span></span> <span data-ttu-id="00e47-127">Aplikace s použitím jističe, se vyhnete webinářem útok DoS sám na sebe.</span><span class="sxs-lookup"><span data-stu-id="00e47-127">By using a circuit breaker, the application avoids provoking a denial of service to itself.</span></span>

![Částečně neúspěšné zpracovat opakování pomocí exponenciálního omezení rychlosti](./media/image9.png)

> <span data-ttu-id="00e47-129">**Obrázek 4 – 9.**</span><span class="sxs-lookup"><span data-stu-id="00e47-129">**Figure 4-9.**</span></span> <span data-ttu-id="00e47-130">Částečně neúspěšné zpracovat opakování pomocí exponenciálního omezení rychlosti</span><span class="sxs-lookup"><span data-stu-id="00e47-130">Partial failures handled by retries with exponential backoff</span></span>

<span data-ttu-id="00e47-131">Tyto postupy můžete použít zdroje HTTP a databázových prostředků.</span><span class="sxs-lookup"><span data-stu-id="00e47-131">You can use these techniques both in HTTP resources and in database resources.</span></span> <span data-ttu-id="00e47-132">Obrázek 4 – 9 aplikace jsou založené na 3vrstvou architekturu, je třeba těchto technik na úrovni služeb (HTTP) a na úrovni datové vrstvy (TCP).</span><span class="sxs-lookup"><span data-stu-id="00e47-132">In Figure 4-9, the application is based on a 3-tier architecture, so you need these techniques at the services level (HTTP) and at the data tier level (TCP).</span></span> <span data-ttu-id="00e47-133">V monolitické aplikaci, která používá jenom na úrovni aplikace s jedním kromě databáze (Další služby ani mikroslužeb) zpracování přechodných chyb na úrovni databáze, připojení může být dostačující.</span><span class="sxs-lookup"><span data-stu-id="00e47-133">In a monolithic application that uses only a single app tier in addition to the database (no additional services or microservices), handling transient failures at the database connection level might be enough.</span></span> <span data-ttu-id="00e47-134">V této situaci se vyžaduje jenom konkrétní konfiguraci připojení k databázi.</span><span class="sxs-lookup"><span data-stu-id="00e47-134">In that scenario, just a particular configuration of the database connection is required.</span></span>

<span data-ttu-id="00e47-135">Při implementaci odolných komunikaci, kterou si přístup k databázi, v závislosti na verzi technologie .NET, které používáte, může být jednoduché (například [s Entity Framework 6 nebo novější](https://msdn.microsoft.com/library/dn456835(v=vs.113).aspx), je jenom na vás konfigurace připojení k databázi).</span><span class="sxs-lookup"><span data-stu-id="00e47-135">When implementing resilient communications that access the database, depending on the version of .NET you are using, it can be straightforward (for example, [with Entity Framework 6 or later](https://msdn.microsoft.com/library/dn456835(v=vs.113).aspx), it's just a matter of configuring the database connection).</span></span> <span data-ttu-id="00e47-136">Nebo možná budete muset používat další knihovny se podobně jako [přechodné Fault Handling Application Block](https://msdn.microsoft.com/library/hh680934(v=pandp.50).aspx) (pro starší verze rozhraní .NET), nebo dokonce implementují vlastní knihovny.</span><span class="sxs-lookup"><span data-stu-id="00e47-136">Or, you might need to use additional libraries like the [Transient Fault Handling Application Block](https://msdn.microsoft.com/library/hh680934(v=pandp.50).aspx) (for earlier versions of .NET), or even implement your own library.</span></span>

<span data-ttu-id="00e47-137">Při provádění opakování HTTP a jističe, doporučení pro .NET je použít [Polly](https://github.com/App-vNext/Polly) knihovny, která cílí na rozhraní .NET Framework 4.0, .NET Framework 4.5 a .NET Standard 1.1, včetně podpory .NET Core.</span><span class="sxs-lookup"><span data-stu-id="00e47-137">When implementing HTTP retries and circuit breakers, the recommendation for .NET is to use the [Polly](https://github.com/App-vNext/Polly) library, which targets .NET Framework 4.0, .NET Framework 4.5, and .NET Standard 1.1, which includes .NET Core support.</span></span>

<span data-ttu-id="00e47-138">Zjistěte, jak implementovat strategie pro zpracování částečného selhání v cloudu, najdete v následujících odkazech.</span><span class="sxs-lookup"><span data-stu-id="00e47-138">To learn how to implement strategies for handling partial failures in the cloud, see the following references.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="00e47-139">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="00e47-139">Additional resources</span></span>

-   <span data-ttu-id="00e47-140">**Implementace odolných komunikace pro zpracování částečného selhání**</span><span class="sxs-lookup"><span data-stu-id="00e47-140">**Implementing resilient communication to handle partial failure**</span></span>

    [https://docs.microsoft.com/dotnet/standard/microservices-architecture/implement-resilient-applications/partial-failure-strategies](../../microservices-architecture/implement-resilient-applications/partial-failure-strategies.md)

-   <span data-ttu-id="00e47-141">**Entity Framework odolnost proti chybám a zkuste to znovu logiku připojení (verze 6 a novější)**</span><span class="sxs-lookup"><span data-stu-id="00e47-141">**Entity Framework connection resiliency and retry logic (version 6 and later)**</span></span>

    [https://msdn.microsoft.com/library/dn456835(v=vs.113).aspx](https://msdn.microsoft.com/library/dn456835(v=vs.113).aspx)

-   <span data-ttu-id="00e47-142">**Blok aplikací zpracování přechodných chyb**</span><span class="sxs-lookup"><span data-stu-id="00e47-142">**The Transient Fault Handling Application Block**</span></span>

-   [https://msdn.microsoft.com/library/hh680934(v=pandp.50).aspx](https://msdn.microsoft.com/library/hh680934(v=pandp.50).aspx)

-   <span data-ttu-id="00e47-143">**Knihovnu Polly pro odolný komunikaci pomocí protokolu HTTP**</span><span class="sxs-lookup"><span data-stu-id="00e47-143">**Polly library for resilient HTTP communication**</span></span>

    https://github.com/App-vNext/Polly

>[!div class="step-by-step"]
><span data-ttu-id="00e47-144">[Předchozí](when-to-deploy-windows-containers-to-azure-container-service-kubernetes.md)
>[další](modernize-your-apps-with-monitoring-and-telemetry.md)</span><span class="sxs-lookup"><span data-stu-id="00e47-144">[Previous](when-to-deploy-windows-containers-to-azure-container-service-kubernetes.md)
[Next](modernize-your-apps-with-monitoring-and-telemetry.md)</span></span>