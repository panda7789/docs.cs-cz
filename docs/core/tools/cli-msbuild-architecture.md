---
title: Architektura nástrojů příkazového řádku .NET Core
description: Přečtěte si o vrstvách nástrojů .NET Core a o tom, co se změnilo v posledních verzích.
ms.date: 03/06/2017
ms.openlocfilehash: fde1a0acb6af9dd65aa3466b4ea37473b2eab6fb
ms.sourcegitcommit: 011314e0c8eb4cf4a11d92078f58176c8c3efd2d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 02/09/2020
ms.locfileid: "77092912"
---
# <a name="high-level-overview-of-changes-in-the-net-core-tools"></a><span data-ttu-id="2939b-103">Podrobný přehled změn v nástrojích .NET Core</span><span class="sxs-lookup"><span data-stu-id="2939b-103">High-level overview of changes in the .NET Core tools</span></span>

<span data-ttu-id="2939b-104">Tento dokument popisuje změny spojené s přesunutím z *Project. JSON* na MSBuild a systém projektu *csproj* s informacemi o změnách vrstev nástrojů .NET Core a implementaci příkazů CLI.</span><span class="sxs-lookup"><span data-stu-id="2939b-104">This document describes the changes associated with moving from *project.json* to MSBuild and the *csproj* project system with information on the changes to the layering of the .NET Core tooling and the implementation of the CLI commands.</span></span> <span data-ttu-id="2939b-105">K těmto změnám došlo s vydáním .NET Core SDK 1,0 a sady Visual Studio 2017 7. března 2017 (viz [oznámení](https://devblogs.microsoft.com/dotnet/announcing-net-core-tools-1-0/)), ale byly původně implementovány s vydáním .NET Core SDK Preview 3.</span><span class="sxs-lookup"><span data-stu-id="2939b-105">These changes occurred with the release of .NET Core SDK 1.0 and Visual Studio 2017 on March 7, 2017 (see the [announcement](https://devblogs.microsoft.com/dotnet/announcing-net-core-tools-1-0/)) but were initially implemented with the release of the .NET Core SDK Preview 3.</span></span>

## <a name="moving-away-from-projectjson"></a><span data-ttu-id="2939b-106">Přesun mimo Project. JSON</span><span class="sxs-lookup"><span data-stu-id="2939b-106">Moving away from project.json</span></span>

<span data-ttu-id="2939b-107">Největší změna v nástrojích pro .NET Core je určitě [z Project. JSON přejít na csproj](https://devblogs.microsoft.com/dotnet/changes-to-project-json/) jako systém projektu.</span><span class="sxs-lookup"><span data-stu-id="2939b-107">The biggest change in the tooling for .NET Core is certainly the [move away from project.json to csproj](https://devblogs.microsoft.com/dotnet/changes-to-project-json/) as the project system.</span></span> <span data-ttu-id="2939b-108">Nejnovější verze nástrojů příkazového řádku nepodporují soubory *Project. JSON* .</span><span class="sxs-lookup"><span data-stu-id="2939b-108">The latest versions of the command-line tools don't support *project.json* files.</span></span> <span data-ttu-id="2939b-109">To znamená, že se nedá použít k sestavení, spuštění nebo publikování aplikací a knihoven založených na Project. JSON.</span><span class="sxs-lookup"><span data-stu-id="2939b-109">That means that it cannot be used to build, run, or publish project.json based applications and libraries.</span></span> <span data-ttu-id="2939b-110">Chcete-li použít tuto verzi nástrojů, migrujte existující projekty nebo začněte novými.</span><span class="sxs-lookup"><span data-stu-id="2939b-110">To use this version of the tools, migrate your existing projects or start new ones.</span></span>

<span data-ttu-id="2939b-111">V rámci tohoto přesunu byl vlastní modul sestavení vyvinutý pro sestavení projektů Project. JSON nahrazen vyspělým a plně schopným sestavovacím modulem s názvem [MSBuild](https://github.com/Microsoft/msbuild).</span><span class="sxs-lookup"><span data-stu-id="2939b-111">As part of this move, the custom build engine that was developed to build project.json projects was replaced with a mature and fully capable build engine called [MSBuild](https://github.com/Microsoft/msbuild).</span></span> <span data-ttu-id="2939b-112">MSBuild je známý modul v komunitě .NET.</span><span class="sxs-lookup"><span data-stu-id="2939b-112">MSBuild is a well-known engine in the .NET community.</span></span> <span data-ttu-id="2939b-113">Byla to klíčová technologie od první verze platformy.</span><span class="sxs-lookup"><span data-stu-id="2939b-113">It has been a key technology since the platform's first release.</span></span> <span data-ttu-id="2939b-114">Vzhledem k tomu, že je potřeba sestavovat aplikace .NET Core, MSBuild byl předaný do .NET Core a lze ho použít na libovolné platformě, na které běží .NET Core.</span><span class="sxs-lookup"><span data-stu-id="2939b-114">Because it needs to build .NET Core applications, MSBuild has been ported to .NET Core and can be used on any platform that .NET Core runs on.</span></span> <span data-ttu-id="2939b-115">Jednou z hlavních příslibů .NET Core je sada pro vývoj pro různé platformy a zajistili jsme, že tento přesun neruší tento příslib.</span><span class="sxs-lookup"><span data-stu-id="2939b-115">One of the main promises of .NET Core is that of a cross-platform development stack, and we have made sure that this move does not break that promise.</span></span>

> [!TIP]
> <span data-ttu-id="2939b-116">Pokud s nástrojem MSBuild začínáte a chcete získat další informace o této službě, můžete začít načtením článku [koncepty nástroje MSBuild](/visualstudio/msbuild/msbuild-concepts) .</span><span class="sxs-lookup"><span data-stu-id="2939b-116">If you are new to MSBuild and would like to learn more about it, you can start by reading the [MSBuild concepts](/visualstudio/msbuild/msbuild-concepts) article.</span></span>

## <a name="the-tooling-layers"></a><span data-ttu-id="2939b-117">Vrstvy nástrojů</span><span class="sxs-lookup"><span data-stu-id="2939b-117">The tooling layers</span></span>

<span data-ttu-id="2939b-118">Se změnou v modulu sestavení a přesunem z existujícího systému projektů se za vás některé otázky přirozeně sledují.</span><span class="sxs-lookup"><span data-stu-id="2939b-118">With the change in build engine and the move away from the existing project system, some questions naturally follow.</span></span> <span data-ttu-id="2939b-119">Provedení kterékoli z těchto změn změní celkové "vrstvení" nástrojů pro ekosystém nástrojů .NET Core?</span><span class="sxs-lookup"><span data-stu-id="2939b-119">Do any of these changes change the overall "layering" of the .NET Core tooling ecosystem?</span></span> <span data-ttu-id="2939b-120">Existují nové bity a součásti?</span><span class="sxs-lookup"><span data-stu-id="2939b-120">Are there new bits and components?</span></span>

<span data-ttu-id="2939b-121">Pojďme začít s rychlým aktualizačním rozhraním ve verzi Preview 2, jak je znázorněno na následujícím obrázku:</span><span class="sxs-lookup"><span data-stu-id="2939b-121">Let's start with a quick refresher on Preview 2 layering as shown in the following picture:</span></span>

![Preview 2 – architektura vysoké úrovně nástrojů](media/cli-msbuild-architecture/p2-arch.png)

<span data-ttu-id="2939b-123">Vrstvení nástrojů v Preview 2 je jednoduché.</span><span class="sxs-lookup"><span data-stu-id="2939b-123">The layering of the tools in Preview 2 is straightforward.</span></span> <span data-ttu-id="2939b-124">V dolní části je základem .NET Core CLI.</span><span class="sxs-lookup"><span data-stu-id="2939b-124">At the bottom, the foundation is the .NET Core CLI.</span></span> <span data-ttu-id="2939b-125">Všechny ostatní nástroje vyšší úrovně, jako je například Visual Studio nebo Visual Studio Code, závisí a spoléhají na rozhraní příkazového řádku pro sestavování projektů, obnovování závislostí a tak dále.</span><span class="sxs-lookup"><span data-stu-id="2939b-125">All other, higher-level tools, such as Visual Studio or Visual Studio Code, depend and rely on the CLI to build projects, restore dependencies, and so on.</span></span> <span data-ttu-id="2939b-126">Například pokud aplikace Visual Studio chtěla provést operaci obnovení, zavolá do příkazu `dotnet restore` ([Viz poznámku](#dotnet-restore-note)) v rozhraní příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="2939b-126">For example, if Visual Studio wanted to perform a restore operation, it would call into the `dotnet restore` ([see note](#dotnet-restore-note)) command in the CLI.</span></span>

<span data-ttu-id="2939b-127">Při přesunu na nový systém projektu se změní předchozí diagram:</span><span class="sxs-lookup"><span data-stu-id="2939b-127">With the move to the new project system, the previous diagram changes:</span></span>

![Architektura vysoké úrovně .NET Core SDK 1.0.0](media/cli-msbuild-architecture/p3-arch.png)

<span data-ttu-id="2939b-129">Hlavním rozdílem je, že rozhraní příkazového řádku již není základní vrstva; Tato role je nyní vyplněna "sdílenou komponentou sady SDK".</span><span class="sxs-lookup"><span data-stu-id="2939b-129">The main difference is that the CLI is not the foundational layer anymore; this role is now filled by the "shared SDK component".</span></span> <span data-ttu-id="2939b-130">Tato sdílená součást sady SDK je sada cílů a přidružených úloh, které jsou zodpovědné za kompilování kódu, publikování a balení balíčků NuGet atd.</span><span class="sxs-lookup"><span data-stu-id="2939b-130">This shared SDK component is a set of targets and associated tasks that are responsible for compiling code, publishing it, packing NuGet packages, and so on.</span></span> <span data-ttu-id="2939b-131">.NET Core SDK je open source a je k dispozici na GitHubu v [úložišti SDK](https://github.com/dotnet/sdk).</span><span class="sxs-lookup"><span data-stu-id="2939b-131">The .NET Core SDK is open-source and is available on GitHub on the [SDK repo](https://github.com/dotnet/sdk).</span></span>

> [!NOTE]
> <span data-ttu-id="2939b-132">"Target" je výraz MSBuild, který označuje pojmenovanou operaci, kterou může nástroj MSBuild vyvolat.</span><span class="sxs-lookup"><span data-stu-id="2939b-132">A "target" is an MSBuild term that indicates a named operation that MSBuild can invoke.</span></span> <span data-ttu-id="2939b-133">Obvykle je spojen s jednou nebo více úlohami, které spouštějí určitou logiku, kterou by měl cíl provádět.</span><span class="sxs-lookup"><span data-stu-id="2939b-133">It is usually coupled with one or more tasks that execute some logic that the target is supposed to do.</span></span> <span data-ttu-id="2939b-134">Nástroj MSBuild podporuje mnoho předem připravených cílů, jako `Copy` nebo `Execute`; umožňuje také uživatelům psát vlastní úkoly pomocí spravovaného kódu a definovat cíle pro provádění těchto úkolů.</span><span class="sxs-lookup"><span data-stu-id="2939b-134">MSBuild supports many ready-made targets such as `Copy` or `Execute`; it also allows users to write their own tasks using managed code and define targets to execute those tasks.</span></span> <span data-ttu-id="2939b-135">Další informace najdete v tématu [úlohy nástroje MSBuild](/visualstudio/msbuild/msbuild-tasks).</span><span class="sxs-lookup"><span data-stu-id="2939b-135">For more information, see [MSBuild tasks](/visualstudio/msbuild/msbuild-tasks).</span></span>

<span data-ttu-id="2939b-136">Všechny sady nástrojů teď využívají sdílenou součást sady SDK a její cíle, včetně rozhraní příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="2939b-136">All the toolsets now consume the shared SDK component and its targets, CLI included.</span></span> <span data-ttu-id="2939b-137">Například Visual Studio 2019 nevolá do příkazu `dotnet restore` ([Viz poznámku](#dotnet-restore-note)), aby obnovil závislosti pro projekty .NET Core.</span><span class="sxs-lookup"><span data-stu-id="2939b-137">For example, Visual Studio 2019 doesn't call into the `dotnet restore` ([see note](#dotnet-restore-note)) command to restore dependencies for .NET Core projects.</span></span> <span data-ttu-id="2939b-138">Místo toho používá cíl "obnovit" přímo.</span><span class="sxs-lookup"><span data-stu-id="2939b-138">Instead, it uses the "Restore" target directly.</span></span> <span data-ttu-id="2939b-139">Vzhledem k tomu, že se jedná o cíle nástroje MSBuild, můžete pomocí příkazu [dotnet MSBuild](dotnet-msbuild.md) spustit také nezpracovaný nástroj MSBuild.</span><span class="sxs-lookup"><span data-stu-id="2939b-139">Since these are MSBuild targets, you can also use raw MSBuild to execute them using the [dotnet msbuild](dotnet-msbuild.md) command.</span></span>

### <a name="cli-commands"></a><span data-ttu-id="2939b-140">Příkazy rozhraní příkazového řádku</span><span class="sxs-lookup"><span data-stu-id="2939b-140">CLI commands</span></span>

<span data-ttu-id="2939b-141">Sdílená součást sady SDK znamená, že většina existujících příkazů rozhraní příkazového řádku byla znovu implementována jako úlohy a cíle nástroje MSBuild.</span><span class="sxs-lookup"><span data-stu-id="2939b-141">The shared SDK component means that the majority of existing CLI commands have been reimplemented as MSBuild tasks and targets.</span></span> <span data-ttu-id="2939b-142">Co to znamená pro příkazy rozhraní příkazového řádku a vaše využití sady nástrojů?</span><span class="sxs-lookup"><span data-stu-id="2939b-142">What does this mean for the CLI commands and your usage of the toolset?</span></span>

<span data-ttu-id="2939b-143">Z perspektivy využití se nezmění způsob, jakým rozhraní příkazového řádku používáte.</span><span class="sxs-lookup"><span data-stu-id="2939b-143">From a usage perspective, it doesn't change the way you use the CLI.</span></span> <span data-ttu-id="2939b-144">Rozhraní příkazového řádku má stále základní příkazy, které existovaly ve verzi .NET Core 1,0 Preview 2:</span><span class="sxs-lookup"><span data-stu-id="2939b-144">The CLI still has the core commands that existed in the .NET Core 1.0 Preview 2 release:</span></span>

- `new`
- `restore`
- `run`
- `build`
- `publish`
- `test`
- `pack`

<span data-ttu-id="2939b-145">Tyto příkazy pořád dělají, co očekáváte (nový projekt, sestavte ho, publikujte ho, probalíte a tak dále).</span><span class="sxs-lookup"><span data-stu-id="2939b-145">These commands still do what you expect them to do (new up a project, build it, publish it, pack it, and so on).</span></span> <span data-ttu-id="2939b-146">Můžete se obrátit na obrazovku Nápověda (pomocí `dotnet <command> --help`) nebo v dokumentaci k tomuto webu, kde se seznámíte s jejich chováním.</span><span class="sxs-lookup"><span data-stu-id="2939b-146">You can consult either the command's help screen (using `dotnet <command> --help`) or documentation on this site to get familiar with their behavior.</span></span>

<span data-ttu-id="2939b-147">V perspektivě spuštění příkazy rozhraní příkazového řádku převezmou své parametry a vytvoří volání "raw" MSBuild, které nastaví potřebné vlastnosti a spustí požadovaný cíl.</span><span class="sxs-lookup"><span data-stu-id="2939b-147">From an execution perspective, the CLI commands take their parameters and construct a call to "raw" MSBuild that sets the needed properties and runs the desired target.</span></span> <span data-ttu-id="2939b-148">K lepší ilustraci byste měli vzít v úvahu následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="2939b-148">To better illustrate this, consider the following command:</span></span>

   ```dotnetcli
   dotnet publish -o pub -c Release
   ```

<span data-ttu-id="2939b-149">Tento příkaz publikuje aplikaci do `pub` složky pomocí konfigurace Release (vydání).</span><span class="sxs-lookup"><span data-stu-id="2939b-149">This command publishes an application into a `pub` folder using the "Release" configuration.</span></span> <span data-ttu-id="2939b-150">Interně se tento příkaz převede do následujícího vyvolání MSBuild:</span><span class="sxs-lookup"><span data-stu-id="2939b-150">Internally, this command gets translated into the following MSBuild invocation:</span></span>

   ```dotnetcli
   dotnet msbuild -t:Publish -p:OutputPath=pub -p:Configuration=Release
   ```

<span data-ttu-id="2939b-151">Mezi významné výjimky z tohoto pravidla patří `new` a `run` příkazy.</span><span class="sxs-lookup"><span data-stu-id="2939b-151">Notable exceptions to this rule are the `new` and `run` commands.</span></span> <span data-ttu-id="2939b-152">Nebyly implementovány jako cíle nástroje MSBuild.</span><span class="sxs-lookup"><span data-stu-id="2939b-152">They have not been implemented as MSBuild targets.</span></span>

<a name="dotnet-restore-note"></a>
[!INCLUDE[DotNet Restore Note](~/includes/dotnet-restore-note.md)]
