---
title: Principy AssemblyLoadContext – .NET Core
description: Klíčové koncepty pro pochopení účelu a chování AssemblyLoadContext v .NET Core
ms.date: 08/09/2019
author: sdmaclea
ms.author: stmaclea
ms.openlocfilehash: 8a73a432bf8cc72cced77cf6c62a785b72032913
ms.sourcegitcommit: 9c3a4f2d3babca8919a1e490a159c1500ba7a844
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/12/2019
ms.locfileid: "72291259"
---
# <a name="understanding-systemruntimeloaderassemblyloadcontext"></a><span data-ttu-id="e374d-103">Principy System. Runtime. Loader. AssemblyLoadContext</span><span class="sxs-lookup"><span data-stu-id="e374d-103">Understanding System.Runtime.Loader.AssemblyLoadContext</span></span>

<span data-ttu-id="e374d-104">Třída <xref:System.Runtime.Loader.AssemblyLoadContext> je jedinečná pro .NET Core.</span><span class="sxs-lookup"><span data-stu-id="e374d-104">The <xref:System.Runtime.Loader.AssemblyLoadContext> class is unique to .NET Core.</span></span> <span data-ttu-id="e374d-105">Tento článek se pokusí doplnit dokumentaci k rozhraní <xref:System.Runtime.Loader.AssemblyLoadContext> API pomocí koncepčních informací.</span><span class="sxs-lookup"><span data-stu-id="e374d-105">This article attempts to supplement the <xref:System.Runtime.Loader.AssemblyLoadContext> API documentation with conceptual information.</span></span>

<span data-ttu-id="e374d-106">Tento článek je relevantní pro vývojáře implementující dynamické načítání, zejména pro vývojáře architektury dynamického nasazování.</span><span class="sxs-lookup"><span data-stu-id="e374d-106">This article is relevant to developers implementing dynamic loading, especially dynamic loading framework developers.</span></span>

## <a name="what-is-the-assemblyloadcontext"></a><span data-ttu-id="e374d-107">Co je AssemblyLoadContext?</span><span class="sxs-lookup"><span data-stu-id="e374d-107">What is the AssemblyLoadContext?</span></span>

<span data-ttu-id="e374d-108">Každá aplikace .NET Core implicitně používá <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="e374d-108">Every .NET Core application implicitly uses the <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span>
<span data-ttu-id="e374d-109">Je poskytovatelem modulu runtime pro vyhledání a načtení závislostí.</span><span class="sxs-lookup"><span data-stu-id="e374d-109">It's the runtime's provider for locating and loading dependencies.</span></span> <span data-ttu-id="e374d-110">Pokaždé, když je načtena závislost, je vyvolána instance <xref:System.Runtime.Loader.AssemblyLoadContext> k jejímu vyhledání.</span><span class="sxs-lookup"><span data-stu-id="e374d-110">Whenever a dependency is loaded, an <xref:System.Runtime.Loader.AssemblyLoadContext> instance is invoked to locate it.</span></span>

- <span data-ttu-id="e374d-111">Poskytuje službu pro hledání, načítání a ukládání spravovaných sestavení a dalších závislostí do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="e374d-111">It provides a service of locating, loading, and caching managed assemblies and other dependencies.</span></span>

- <span data-ttu-id="e374d-112">Aby bylo možné podporovat dynamické načítání a uvolňování kódu, vytvoří izolovaný kontext pro načítání kódu a jeho závislostí ve své vlastní instanci <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="e374d-112">To support dynamic code loading and unloading, it creates an isolated context for loading code and its dependencies in their own <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span>

## <a name="when-do-you-need-multiple-assemblyloadcontext-instances"></a><span data-ttu-id="e374d-113">Pokud potřebujete více instancí AssemblyLoadContext?</span><span class="sxs-lookup"><span data-stu-id="e374d-113">When do you need multiple AssemblyLoadContext instances?</span></span>

<span data-ttu-id="e374d-114">Jedna instance <xref:System.Runtime.Loader.AssemblyLoadContext> je omezena tak, aby se načetla přesně jedna verze <xref:System.Reflection.Assembly> na jednoduchý název sestavení <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="e374d-114">A single <xref:System.Runtime.Loader.AssemblyLoadContext> instance is limited to loading exactly one version of an <xref:System.Reflection.Assembly> per simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>

<span data-ttu-id="e374d-115">Toto omezení může být problém při dynamickém načítání modulů kódu.</span><span class="sxs-lookup"><span data-stu-id="e374d-115">This restriction can become a problem when loading code modules dynamically.</span></span> <span data-ttu-id="e374d-116">Každý modul je nezávisle zkompilován a může záviset na různých verzích <xref:System.Reflection.Assembly>.</span><span class="sxs-lookup"><span data-stu-id="e374d-116">Each module is independently compiled and may depend on different versions of an <xref:System.Reflection.Assembly>.</span></span> <span data-ttu-id="e374d-117">K tomuto problému obvykle dochází, když různé moduly závisejí na různých verzích běžně používané knihovny.</span><span class="sxs-lookup"><span data-stu-id="e374d-117">This problem commonly occurs when different modules depend on different versions of a commonly used library.</span></span>

<span data-ttu-id="e374d-118">Aby bylo možné podporovat dynamické načítání kódu, rozhraní <xref:System.Runtime.Loader.AssemblyLoadContext> API poskytuje k načítání konfliktních verzí <xref:System.Reflection.Assembly> ve stejné aplikaci.</span><span class="sxs-lookup"><span data-stu-id="e374d-118">To support dynamically loading code, the <xref:System.Runtime.Loader.AssemblyLoadContext> API provides for loading conflicting versions of an <xref:System.Reflection.Assembly> in the same application.</span></span> <span data-ttu-id="e374d-119">Každá instance <xref:System.Runtime.Loader.AssemblyLoadContext> poskytuje jedinečný slovník mapování každého <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> na konkrétní instanci <xref:System.Reflection.Assembly>.</span><span class="sxs-lookup"><span data-stu-id="e374d-119">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance provides a unique dictionary mapping each <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> to a specific <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="e374d-120">Poskytuje také pohodlný mechanismus pro seskupení závislostí souvisejících s modulem kódu pro pozdější uvolnění.</span><span class="sxs-lookup"><span data-stu-id="e374d-120">It also provides a convenient mechanism for grouping dependencies related to a code module for later unload.</span></span>

## <a name="what-is-special-about-the-assemblyloadcontextdefault-instance"></a><span data-ttu-id="e374d-121">Co je zvláštní informace o instanci AssemblyLoadContext. Default?</span><span class="sxs-lookup"><span data-stu-id="e374d-121">What is special about the AssemblyLoadContext.Default instance?</span></span>

<span data-ttu-id="e374d-122">Instance <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> je automaticky vyplněna modulem runtime při spuštění.</span><span class="sxs-lookup"><span data-stu-id="e374d-122">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance is automatically populated by the runtime at startup.</span></span>  <span data-ttu-id="e374d-123">K vyhledání a vyhledání všech statických závislostí používá [výchozí zjišťování](default-probing.md) .</span><span class="sxs-lookup"><span data-stu-id="e374d-123">It uses [default probing](default-probing.md) to locate and find all static dependencies.</span></span>

<span data-ttu-id="e374d-124">Řeší nejběžnější scénáře načítání závislostí.</span><span class="sxs-lookup"><span data-stu-id="e374d-124">It solves the most common dependency loading scenarios.</span></span>

## <a name="how-does-assemblyloadcontext-support-dynamic-dependencies"></a><span data-ttu-id="e374d-125">Jak AssemblyLoadContext podporuje dynamické závislosti?</span><span class="sxs-lookup"><span data-stu-id="e374d-125">How does AssemblyLoadContext support dynamic dependencies?</span></span>

<span data-ttu-id="e374d-126"><xref:System.Runtime.Loader.AssemblyLoadContext> má různé události a virtuální funkce, které je možné přepsat.</span><span class="sxs-lookup"><span data-stu-id="e374d-126"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span>

<span data-ttu-id="e374d-127">Instance <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> podporuje pouze přepsání událostí.</span><span class="sxs-lookup"><span data-stu-id="e374d-127">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance only supports overriding the events.</span></span>

<span data-ttu-id="e374d-128">V článcích [spravovaný algoritmus pro načítání sestavení](loading-managed.md), [algoritmus načítání satelitních sestavení](loading-resources.md)a [nespravovaný (nativní) modul načítání knihovny](loading-unmanaged.md) odkazují na všechny dostupné události a virtuální funkce.</span><span class="sxs-lookup"><span data-stu-id="e374d-128">The articles [Managed assembly loading algorithm](loading-managed.md), [Satellite assembly loading algorithm](loading-resources.md), and [Unmanaged (native) library loading algorithm](loading-unmanaged.md) refer to all the available events and virtual functions.</span></span>  <span data-ttu-id="e374d-129">Články ukazují relativní pozici každé události a funkce v algoritmech načítání.</span><span class="sxs-lookup"><span data-stu-id="e374d-129">The articles show each event and function's relative position in the loading algorithms.</span></span> <span data-ttu-id="e374d-130">V tomto článku nejsou tyto informace reprodukovány.</span><span class="sxs-lookup"><span data-stu-id="e374d-130">This article doesn't reproduce that information.</span></span>

<span data-ttu-id="e374d-131">Tato část obsahuje obecné principy relevantních událostí a funkcí.</span><span class="sxs-lookup"><span data-stu-id="e374d-131">This section covers the general principles for the relevant events and functions.</span></span>

- <span data-ttu-id="e374d-132">**Být možné opakovat**.</span><span class="sxs-lookup"><span data-stu-id="e374d-132">**Be repeatable**.</span></span> <span data-ttu-id="e374d-133">Dotaz na konkrétní závislost musí vždy mít stejnou odpověď.</span><span class="sxs-lookup"><span data-stu-id="e374d-133">A query for a specific dependency must always result in the same response.</span></span> <span data-ttu-id="e374d-134">Musí být vrácena stejná instance načtené závislosti.</span><span class="sxs-lookup"><span data-stu-id="e374d-134">The same loaded dependency instance must be returned.</span></span> <span data-ttu-id="e374d-135">Tento požadavek je zásadní pro konzistenci mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="e374d-135">This requirement is fundamental  for cache consistency.</span></span> <span data-ttu-id="e374d-136">Konkrétně pro spravovaná sestavení vytváříme <xref:System.Reflection.Assembly> cache.</span><span class="sxs-lookup"><span data-stu-id="e374d-136">For managed assemblies in particular, we're creating a <xref:System.Reflection.Assembly> cache.</span></span> <span data-ttu-id="e374d-137">Klíč mezipaměti je jednoduchý název sestavení <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="e374d-137">The cache key is a simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="e374d-138">**Obvykle nevyvolejte**.</span><span class="sxs-lookup"><span data-stu-id="e374d-138">**Typically don't throw**.</span></span>  <span data-ttu-id="e374d-139">Očekává se, že tyto funkce vrátí `null` spíše než throw, pokud nelze najít požadovanou závislost.</span><span class="sxs-lookup"><span data-stu-id="e374d-139">It's expected that these functions return `null` rather than throw when unable to find the requested dependency.</span></span> <span data-ttu-id="e374d-140">K vyvolání dojde v předčasném ukončení hledání a k šíření výjimky pro volajícího.</span><span class="sxs-lookup"><span data-stu-id="e374d-140">Throwing will prematurely end the search and be propagate an exception to the caller.</span></span> <span data-ttu-id="e374d-141">Vystavení by mělo být omezeno na neočekávané chyby, jako je poškozené sestavení nebo nedostatek paměti.</span><span class="sxs-lookup"><span data-stu-id="e374d-141">Throwing should be restricted to unexpected errors like a corrupted assembly or an out of memory condition.</span></span>
- <span data-ttu-id="e374d-142">**Vyhněte se rekurzi**.</span><span class="sxs-lookup"><span data-stu-id="e374d-142">**Avoid recursion**.</span></span> <span data-ttu-id="e374d-143">Počítejte s tím, že tyto funkce a obslužné rutiny implementují pravidla načítání pro hledání závislostí.</span><span class="sxs-lookup"><span data-stu-id="e374d-143">Be aware that these functions and handlers implement the loading rules for locating dependencies.</span></span> <span data-ttu-id="e374d-144">Vaše implementace by neměla volat rozhraní API, která spouštějí rekurzi.</span><span class="sxs-lookup"><span data-stu-id="e374d-144">Your implementation shouldn't call APIs that trigger recursion.</span></span> <span data-ttu-id="e374d-145">Váš kód by měl obvykle volat funkce **AssemblyLoadContext** Load, které vyžadují specifickou cestu nebo argument odkazu na paměť.</span><span class="sxs-lookup"><span data-stu-id="e374d-145">Your code should typically call **AssemblyLoadContext** load functions that require a specific path or memory reference argument.</span></span>
- <span data-ttu-id="e374d-146">**Načtěte do správného AssemblyLoadContext**.</span><span class="sxs-lookup"><span data-stu-id="e374d-146">**Load into the correct AssemblyLoadContext**.</span></span> <span data-ttu-id="e374d-147">Volba místa načtení závislostí je specifická pro aplikaci.</span><span class="sxs-lookup"><span data-stu-id="e374d-147">The choice of where to load dependencies is application-specific.</span></span>  <span data-ttu-id="e374d-148">Tato volba je implementována těmito událostmi a funkcemi.</span><span class="sxs-lookup"><span data-stu-id="e374d-148">The choice is implemented by these events and functions.</span></span> <span data-ttu-id="e374d-149">Když váš kód volá funkce **AssemblyLoadContext** Load-by-Path, zavolejte je na instanci, kde chcete kód načíst.</span><span class="sxs-lookup"><span data-stu-id="e374d-149">When your code calls **AssemblyLoadContext** load-by-path functions call them on the instance where you want the code loaded.</span></span> <span data-ttu-id="e374d-150">Při návratu `null` a umožnění <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> zpracování zatížení může být nejjednodušší možnost.</span><span class="sxs-lookup"><span data-stu-id="e374d-150">Sometime returning `null` and letting the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> handle the load may be the simplest option.</span></span>
- <span data-ttu-id="e374d-151">**Uvědomte si Races vlákna**.</span><span class="sxs-lookup"><span data-stu-id="e374d-151">**Be aware of thread races**.</span></span> <span data-ttu-id="e374d-152">Načítání může být aktivováno více vlákny.</span><span class="sxs-lookup"><span data-stu-id="e374d-152">Loading can be triggered by multiple threads.</span></span> <span data-ttu-id="e374d-153">AssemblyLoadContext zpracovává vlákna Races atomicky přidávání sestavení do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="e374d-153">The AssemblyLoadContext handles thread races by atomically adding assemblies to its cache.</span></span> <span data-ttu-id="e374d-154">Instance rasy loser je zahozena.</span><span class="sxs-lookup"><span data-stu-id="e374d-154">The race loser's instance is discarded.</span></span> <span data-ttu-id="e374d-155">V logice implementace Nepřidávejte další logiku, která správně nezpracovává více vláken.</span><span class="sxs-lookup"><span data-stu-id="e374d-155">In your implementation logic, don't add extra logic that doesn't handle multiple threads properly.</span></span>

## <a name="how-are-dynamic-dependencies-isolated"></a><span data-ttu-id="e374d-156">Jak jsou izolované dynamické závislosti?</span><span class="sxs-lookup"><span data-stu-id="e374d-156">How are dynamic dependencies isolated?</span></span>

<span data-ttu-id="e374d-157">Každá instance <xref:System.Runtime.Loader.AssemblyLoadContext> představuje jedinečný obor pro <xref:System.Reflection.Assembly> instance a definice <xref:System.Type>.</span><span class="sxs-lookup"><span data-stu-id="e374d-157">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance represents a unique scope for <xref:System.Reflection.Assembly> instances and <xref:System.Type> definitions.</span></span>

<span data-ttu-id="e374d-158">Mezi těmito závislostmi neexistuje žádná binární izolace.</span><span class="sxs-lookup"><span data-stu-id="e374d-158">There's no binary isolation between these dependencies.</span></span> <span data-ttu-id="e374d-159">Jsou izolované jenom tím, že se nehledají podle názvu.</span><span class="sxs-lookup"><span data-stu-id="e374d-159">They're only isolated by not finding each other by name.</span></span>

<span data-ttu-id="e374d-160">V každém <xref:System.Runtime.Loader.AssemblyLoadContext>:</span><span class="sxs-lookup"><span data-stu-id="e374d-160">In each <xref:System.Runtime.Loader.AssemblyLoadContext>:</span></span>

- <span data-ttu-id="e374d-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> se může vztahovat na jinou instanci <xref:System.Reflection.Assembly>.</span><span class="sxs-lookup"><span data-stu-id="e374d-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> may refer to a different <xref:System.Reflection.Assembly> instance.</span></span>
- <span data-ttu-id="e374d-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType> může vrátit jinou instanci typu pro stejný typ `name`.</span><span class="sxs-lookup"><span data-stu-id="e374d-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType> may return a different type instance for the same type `name`.</span></span>

## <a name="how-are-dependencies-shared"></a><span data-ttu-id="e374d-163">Jak se sdílí závislosti?</span><span class="sxs-lookup"><span data-stu-id="e374d-163">How are dependencies shared?</span></span>

<span data-ttu-id="e374d-164">Mezi instancemi <xref:System.Runtime.Loader.AssemblyLoadContext> je možné snadno sdílet závislosti.</span><span class="sxs-lookup"><span data-stu-id="e374d-164">Dependencies can easily be shared between <xref:System.Runtime.Loader.AssemblyLoadContext> instances.</span></span> <span data-ttu-id="e374d-165">Obecný model je pro jednu <xref:System.Runtime.Loader.AssemblyLoadContext> načtení závislosti.</span><span class="sxs-lookup"><span data-stu-id="e374d-165">The general model is for one <xref:System.Runtime.Loader.AssemblyLoadContext> to load a dependency.</span></span>  <span data-ttu-id="e374d-166">Druhá sdílí závislost pomocí odkazu na načtené sestavení.</span><span class="sxs-lookup"><span data-stu-id="e374d-166">The other shares the dependency by using a reference to the loaded assembly.</span></span>

<span data-ttu-id="e374d-167">Toto sdílení je vyžadováno pro sestavení modulu runtime.</span><span class="sxs-lookup"><span data-stu-id="e374d-167">This sharing is required of the runtime assemblies.</span></span> <span data-ttu-id="e374d-168">Tato sestavení lze načíst pouze do <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="e374d-168">These assemblies can only be loaded into the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="e374d-169">Stejný je vyžadován pro rozhraní, jako `ASP.NET`, `WPF`nebo `WinForms`.</span><span class="sxs-lookup"><span data-stu-id="e374d-169">The same is required for frameworks like `ASP.NET`, `WPF`, or `WinForms`.</span></span>

<span data-ttu-id="e374d-170">Doporučuje se, aby se sdílené závislosti načetly do <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="e374d-170">It's recommended that shared dependencies should be loaded into <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="e374d-171">Toto sdílení je běžným vzorem návrhu.</span><span class="sxs-lookup"><span data-stu-id="e374d-171">This sharing is the common design pattern.</span></span>

<span data-ttu-id="e374d-172">Sdílení je implementováno v kódování instance vlastního <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="e374d-172">Sharing is implemented in the coding of the custom <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span> <span data-ttu-id="e374d-173"><xref:System.Runtime.Loader.AssemblyLoadContext> má různé události a virtuální funkce, které je možné přepsat.</span><span class="sxs-lookup"><span data-stu-id="e374d-173"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span> <span data-ttu-id="e374d-174">Když kterákoli z těchto funkcí vrátí odkaz na instanci <xref:System.Reflection.Assembly>, která byla načtena v jiné instanci <xref:System.Runtime.Loader.AssemblyLoadContext>, je sdílena <xref:System.Reflection.Assembly> instance.</span><span class="sxs-lookup"><span data-stu-id="e374d-174">When any of these functions return a reference to an <xref:System.Reflection.Assembly> instance that was loaded in another <xref:System.Runtime.Loader.AssemblyLoadContext> instance, the <xref:System.Reflection.Assembly> instance is shared.</span></span> <span data-ttu-id="e374d-175">Algoritmus standardního zatížení se neshoduje s <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> pro načítání pro zjednodušení společného vzoru sdílení.</span><span class="sxs-lookup"><span data-stu-id="e374d-175">The standard load algorithm defers to <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> for loading to simplify the common sharing pattern.</span></span>  <span data-ttu-id="e374d-176">Viz [algoritmus načítání spravovaného sestavení](loading-managed.md).</span><span class="sxs-lookup"><span data-stu-id="e374d-176">See [Managed assembly loading algorithm](loading-managed.md).</span></span>

## <a name="complications"></a><span data-ttu-id="e374d-177">Komplikace</span><span class="sxs-lookup"><span data-stu-id="e374d-177">Complications</span></span>

### <a name="type-conversion-issues"></a><span data-ttu-id="e374d-178">Problémy s převodem typu</span><span class="sxs-lookup"><span data-stu-id="e374d-178">Type conversion issues</span></span>

<span data-ttu-id="e374d-179">Pokud dvě instance <xref:System.Runtime.Loader.AssemblyLoadContext> obsahují definice typu se stejným `name`, nejedná se o stejný typ.</span><span class="sxs-lookup"><span data-stu-id="e374d-179">When two <xref:System.Runtime.Loader.AssemblyLoadContext> instances contain type definitions with the same `name`, they're not the same type.</span></span> <span data-ttu-id="e374d-180">Jsou stejného typu, pokud a pocházejí ze stejné <xref:System.Reflection.Assembly> instance.</span><span class="sxs-lookup"><span data-stu-id="e374d-180">They're the same type if and only if they come from the same <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="e374d-181">Chcete-li zkomplikovat otázky, zprávy o výjimce týkající se těchto neodpovídajících typů mohou být matoucí.</span><span class="sxs-lookup"><span data-stu-id="e374d-181">To complicate matters, exception messages about these mismatched types can be confusing.</span></span> <span data-ttu-id="e374d-182">Typy jsou odkazovány na zprávy výjimek podle jejich jednoduchého typu.</span><span class="sxs-lookup"><span data-stu-id="e374d-182">The types are referred to in the exception messages by their simple type names.</span></span> <span data-ttu-id="e374d-183">Zpráva o běžné výjimce v tomto případě by měla být ve tvaru:</span><span class="sxs-lookup"><span data-stu-id="e374d-183">The common exception message in this case would be of the form:</span></span>

> <span data-ttu-id="e374d-184">Objekt typu ' IsolatedType ' nelze převést na typ ' IsolatedType '.</span><span class="sxs-lookup"><span data-stu-id="e374d-184">Object of type 'IsolatedType' cannot be converted to type 'IsolatedType'.</span></span>

### <a name="debugging-type-conversion-issues"></a><span data-ttu-id="e374d-185">Problémy s převodem typu ladění</span><span class="sxs-lookup"><span data-stu-id="e374d-185">Debugging type conversion issues</span></span>

<span data-ttu-id="e374d-186">Vzhledem k dvojici neodpovídajících typů je důležité také znát:</span><span class="sxs-lookup"><span data-stu-id="e374d-186">Given a pair of mismatched types it's important to also know:</span></span>

- <span data-ttu-id="e374d-187"><xref:System.Type.Assembly?displayProperty=nameWithType> každého typu</span><span class="sxs-lookup"><span data-stu-id="e374d-187">Each type's <xref:System.Type.Assembly?displayProperty=nameWithType></span></span>
- <span data-ttu-id="e374d-188"><xref:System.Runtime.Loader.AssemblyLoadContext>každého typu, který lze získat prostřednictvím funkce <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="e374d-188">Each type's <xref:System.Runtime.Loader.AssemblyLoadContext>, which can be obtained via the <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType> function.</span></span>

<span data-ttu-id="e374d-189">Vzhledem k těmto dvěma objektům `a` a `b`bude užitečné vyhodnotit následující v ladicím programu:</span><span class="sxs-lookup"><span data-stu-id="e374d-189">Given two objects `a` and `b`, evaluating the following in the debugger will be helpful:</span></span>

```csharp
// In debugger look at each assembly's instance, Location, and FullName
a.GetType().Assembly
b.GetType().Assembly
// In debugger look at each AssemblyLoadContext's instance and name
System.Runtime.AssemblyLoadContext.GetLoadContext(a.GetType().Assembly)
System.Runtime.AssemblyLoadContext.GetLoadContext(b.GetType().Assembly)
```

### <a name="resolving-type-conversion-issues"></a><span data-ttu-id="e374d-190">Řešení problémů s převodem typů</span><span class="sxs-lookup"><span data-stu-id="e374d-190">Resolving type conversion issues</span></span>

<span data-ttu-id="e374d-191">Existují dva vzory návrhu pro řešení těchto problémů s převodem typů.</span><span class="sxs-lookup"><span data-stu-id="e374d-191">There are two design patterns for solving these type conversion issues.</span></span>

1. <span data-ttu-id="e374d-192">Použijte běžné sdílené typy.</span><span class="sxs-lookup"><span data-stu-id="e374d-192">Use common shared types.</span></span> <span data-ttu-id="e374d-193">Tento sdílený typ může být buď primitivní typ modulu runtime, nebo může zahrnovat vytvoření nového sdíleného typu ve sdíleném sestavení.</span><span class="sxs-lookup"><span data-stu-id="e374d-193">This shared type can either be a primitive runtime type, or it can involve creating a new shared type in a shared assembly.</span></span>  <span data-ttu-id="e374d-194">Sdílený typ je často [rozhraní](../../csharp/language-reference/keywords/interface.md) definované v sestavení aplikace.</span><span class="sxs-lookup"><span data-stu-id="e374d-194">Often the shared type is an [interface](../../csharp/language-reference/keywords/interface.md) defined in an application assembly.</span></span> <span data-ttu-id="e374d-195">Viz také: [jak se sdílí závislosti?](#how-are-dependencies-shared).</span><span class="sxs-lookup"><span data-stu-id="e374d-195">See also: [How are dependencies shared?](#how-are-dependencies-shared).</span></span>

2. <span data-ttu-id="e374d-196">Použijte techniky zařazování pro převod z jednoho typu na jiný.</span><span class="sxs-lookup"><span data-stu-id="e374d-196">Use marshaling techniques to convert from one type to another.</span></span>
