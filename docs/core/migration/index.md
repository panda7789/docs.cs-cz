---
title: Migrace .NET Core ze služby Project. JSON
description: Naučte se migrovat starší projekt .NET Core pomocí Project. JSON.
ms.date: 07/19/2017
ms.openlocfilehash: f81d01c052c3632c48a5f961be86eab686c2074e
ms.sourcegitcommit: 5f236cd78cf09593c8945a7d753e0850e96a0b80
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/07/2020
ms.locfileid: "75714355"
---
# <a name="migrating-net-core-projects-from-projectjson"></a><span data-ttu-id="c830f-103">Migrace projektů .NET Core ze služby Project. JSON</span><span class="sxs-lookup"><span data-stu-id="c830f-103">Migrating .NET Core projects from project.json</span></span>

<span data-ttu-id="c830f-104">Tento dokument popisuje následující tři scénáře migrace pro projekty .NET Core:</span><span class="sxs-lookup"><span data-stu-id="c830f-104">This document covers the following three migration scenarios for .NET Core projects:</span></span>

1. [<span data-ttu-id="c830f-105">Migrace z platného nejnovějšího schématu *Project. JSON* na *csproj*</span><span class="sxs-lookup"><span data-stu-id="c830f-105">Migration from a valid latest schema of *project.json* to *csproj*</span></span>](#migration-from-projectjson-to-csproj)
2. [<span data-ttu-id="c830f-106">Migrace z DNX do csproj</span><span class="sxs-lookup"><span data-stu-id="c830f-106">Migration from DNX to csproj</span></span>](#migration-from-dnx-to-csproj)
3. [<span data-ttu-id="c830f-107">Migrace z RC3 a předchozích projektů .NET Core csproj do konečného formátu</span><span class="sxs-lookup"><span data-stu-id="c830f-107">Migration from RC3 and previous .NET Core csproj projects to the final format</span></span>](#migration-from-earlier-net-core-csproj-formats-to-rtm-csproj)

<span data-ttu-id="c830f-108">Tento dokument se vztahuje pouze na starší projekty .NET Core, které používají Project. JSON.</span><span class="sxs-lookup"><span data-stu-id="c830f-108">This document is only applicable to older .NET Core projects that use project.json.</span></span> <span data-ttu-id="c830f-109">Nevztahuje se na migraci z .NET Framework do .NET Core.</span><span class="sxs-lookup"><span data-stu-id="c830f-109">It does not apply to migrating from .NET Framework to .NET Core.</span></span>

## <a name="migration-from-projectjson-to-csproj"></a><span data-ttu-id="c830f-110">Migrace z Project. JSON na csproj</span><span class="sxs-lookup"><span data-stu-id="c830f-110">Migration from project.json to csproj</span></span>

<span data-ttu-id="c830f-111">Migraci z *Project. JSON* na *. csproj* lze provést pomocí jedné z následujících metod:</span><span class="sxs-lookup"><span data-stu-id="c830f-111">Migration from *project.json* to *.csproj* can be done using one of the following methods:</span></span>

- [<span data-ttu-id="c830f-112">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="c830f-112">Visual Studio</span></span>](#visual-studio)
- [<span data-ttu-id="c830f-113">Nástroj příkazového řádku dotnet pro migraci</span><span class="sxs-lookup"><span data-stu-id="c830f-113">dotnet migrate command-line tool</span></span>](#dotnet-migrate)

<span data-ttu-id="c830f-114">Obě metody používají stejný základní modul pro migraci projektů, takže výsledky budou stejné pro obě.</span><span class="sxs-lookup"><span data-stu-id="c830f-114">Both methods use the same underlying engine to migrate the projects, so the results will be the same for both.</span></span> <span data-ttu-id="c830f-115">Ve většině případů jedním z těchto dvou způsobů, jak migrovat soubor *Project. JSON* na *csproj* , je jediná věc, kterou potřebujete, a není nutné provádět žádné další ruční úpravy souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="c830f-115">In most cases, using one of these two ways to migrate the *project.json* to *csproj* is the only thing that is needed, and no further manual editing of the project file is necessary.</span></span> <span data-ttu-id="c830f-116">Výsledný soubor *. csproj* bude pojmenován stejně jako obsahující název adresáře.</span><span class="sxs-lookup"><span data-stu-id="c830f-116">The resulting *.csproj* file will be named the same as the containing directory name.</span></span>

### <a name="visual-studio"></a><span data-ttu-id="c830f-117">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="c830f-117">Visual Studio</span></span>

<span data-ttu-id="c830f-118">Po otevření souboru *. xproj* nebo souboru řešení, který odkazuje na soubory *. xproj* v aplikaci Visual Studio 2017 nebo visual Studio 2019 verze 16,2 a starší se zobrazí dialogové okno **jednosměrného upgradu** .</span><span class="sxs-lookup"><span data-stu-id="c830f-118">When you open an *.xproj* file or a solution file that references *.xproj* files in Visual Studio 2017 or Visual Studio 2019 version 16.2 and earlier, the **One-way upgrade** dialog appears.</span></span> <span data-ttu-id="c830f-119">V dialogovém okně se zobrazí projekty, které mají být migrovány.</span><span class="sxs-lookup"><span data-stu-id="c830f-119">The dialog displays the projects to be migrated.</span></span> <span data-ttu-id="c830f-120">Pokud otevřete soubor řešení, zobrazí se všechny projekty zadané v souboru řešení.</span><span class="sxs-lookup"><span data-stu-id="c830f-120">If you open a solution file, all the projects specified in the solution file are listed.</span></span> <span data-ttu-id="c830f-121">Zkontrolujte seznam projektů, které chcete migrovat, a vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="c830f-121">Review the list of projects to be migrated and select **OK**.</span></span>

![Dialog s jednosměrným upgradem zobrazující seznam projektů, které se mají migrovat](media/one-way-upgrade.jpg)

<span data-ttu-id="c830f-123">Visual Studio automaticky migruje vybrané projekty.</span><span class="sxs-lookup"><span data-stu-id="c830f-123">Visual Studio migrates the selected projects automatically.</span></span> <span data-ttu-id="c830f-124">Pokud při migraci řešení nezvolíte možnost všechny projekty, zobrazí se stejné dialogové okno s výzvou k upgradu zbývajících projektů z tohoto řešení.</span><span class="sxs-lookup"><span data-stu-id="c830f-124">When migrating a solution, if you don't choose all projects, the same dialog appears asking you to upgrade the remaining projects from that solution.</span></span> <span data-ttu-id="c830f-125">Po dokončení migrace projektu můžete zobrazit a upravit jeho obsah tak, že kliknete pravým tlačítkem myši na projekt v okně **Průzkumník řešení** a vyberete **Upravit \<název projektu >. csproj**.</span><span class="sxs-lookup"><span data-stu-id="c830f-125">After the project is migrated, you can see and modify its contents by right-clicking the project in the **Solution Explorer** window and selecting **Edit \<project name>.csproj**.</span></span>

<span data-ttu-id="c830f-126">Migrované soubory (*Project. JSON*, *Global. JSON*, *. xproj*a soubor řešení) se přesunou do složky *zálohy* .</span><span class="sxs-lookup"><span data-stu-id="c830f-126">Files that were migrated (*project.json*, *global.json*, *.xproj*, and solution file) are moved to a *Backup* folder.</span></span> <span data-ttu-id="c830f-127">Migrovaný soubor řešení je upgradován na Visual Studio 2017 nebo Visual Studio 2019 a nebudete moci otevřít tento soubor řešení v aplikaci Visual Studio 2015 nebo starší verze.</span><span class="sxs-lookup"><span data-stu-id="c830f-127">The migrated solution file is upgraded to Visual Studio 2017 or Visual Studio 2019 and you won't be able to open that solution file in Visual Studio 2015 or earlier versions.</span></span> <span data-ttu-id="c830f-128">Soubor s názvem *UpgradeLog. htm* , který obsahuje sestavu migrace, se také ukládá a otevírá automaticky.</span><span class="sxs-lookup"><span data-stu-id="c830f-128">A file named *UpgradeLog.htm* that contains a migration report is also saved and opened automatically.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="c830f-129">V aplikaci Visual Studio 2019 verze 16,3 a novější nelze načíst nebo migrovat soubor *. xproj* .</span><span class="sxs-lookup"><span data-stu-id="c830f-129">In Visual Studio 2019 version 16.3 and later, you cannot load or migrate an *.xproj* file.</span></span> <span data-ttu-id="c830f-130">Kromě toho Visual Studio 2015 neposkytuje možnost migrovat soubor *. xproj* .</span><span class="sxs-lookup"><span data-stu-id="c830f-130">Additionally, Visual Studio 2015 doesn't provide the ability to migrate an *.xproj* file.</span></span> <span data-ttu-id="c830f-131">Pokud používáte jednu z těchto verzí sady Visual Studio, buď nainstalujte vhodnou verzi sady Visual Studio, nebo použijte nástroj pro migraci z příkazového řádku, který je popsán dále.</span><span class="sxs-lookup"><span data-stu-id="c830f-131">If you're using one of these Visual Studio versions, either install a suitable version of Visual Studio, or use the command line migration tool that's described next.</span></span>

### <a name="dotnet-migrate"></a><span data-ttu-id="c830f-132">dotnet migrate</span><span class="sxs-lookup"><span data-stu-id="c830f-132">dotnet migrate</span></span>

<span data-ttu-id="c830f-133">Ve scénáři příkazového řádku můžete použít příkaz [`dotnet migrate`](../tools/dotnet-migrate.md) .</span><span class="sxs-lookup"><span data-stu-id="c830f-133">In the command-line scenario, you can use the [`dotnet migrate`](../tools/dotnet-migrate.md) command.</span></span> <span data-ttu-id="c830f-134">Migruje projekt, řešení nebo sadu složek v tomto pořadí v závislosti na tom, které z nich byly nalezeny.</span><span class="sxs-lookup"><span data-stu-id="c830f-134">It migrates a project, a solution, or a set of folders in that order, depending on which ones were found.</span></span> <span data-ttu-id="c830f-135">Při migraci projektu se migruje projekt a všechny jeho závislosti.</span><span class="sxs-lookup"><span data-stu-id="c830f-135">When you migrate a project, the project and all its dependencies are migrated.</span></span>

<span data-ttu-id="c830f-136">Migrované soubory (*Project. JSON*, *Global. JSON*a *. xproj*) se přesunou do složky *zálohy* .</span><span class="sxs-lookup"><span data-stu-id="c830f-136">Files that were migrated (*project.json*, *global.json*, and *.xproj*) are moved to a *backup* folder.</span></span>

> [!NOTE]
> <span data-ttu-id="c830f-137">Pokud používáte Visual Studio Code, příkaz `dotnet migrate` neupraví soubory specifické pro Visual Studio Code, jako je *Tasks. JSON*.</span><span class="sxs-lookup"><span data-stu-id="c830f-137">If you are using Visual Studio Code, the `dotnet migrate` command does not modify Visual Studio Code-specific files such as *tasks.json*.</span></span> <span data-ttu-id="c830f-138">Tyto soubory je třeba změnit ručně.</span><span class="sxs-lookup"><span data-stu-id="c830f-138">These files need to be changed manually.</span></span>
> <span data-ttu-id="c830f-139">To platí také v případě, že používáte editor nebo integrované vývojové prostředí (IDE) jiné než Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="c830f-139">This is also true if you are using an editor or Integrated Development Environment (IDE) other than Visual Studio.</span></span>

<span data-ttu-id="c830f-140">Prohlédněte si [mapování mezi vlastnostmi Project. JSON a csproj](../tools/project-json-to-csproj.md) pro porovnání formátů *Project. JSON* a *. csproj* .</span><span class="sxs-lookup"><span data-stu-id="c830f-140">See [A mapping between project.json and csproj properties](../tools/project-json-to-csproj.md) for a comparison of *project.json* and *.csproj* formats.</span></span>

<span data-ttu-id="c830f-141">Pokud se zobrazí chyba:</span><span class="sxs-lookup"><span data-stu-id="c830f-141">If you get an error:</span></span>

> <span data-ttu-id="c830f-142">Nenašel se žádný spustitelný soubor, který by odpovídal příkazu dotnet – migrace.</span><span class="sxs-lookup"><span data-stu-id="c830f-142">No executable found matching command dotnet-migrate</span></span>

<span data-ttu-id="c830f-143">Spuštěním `dotnet --version` zobrazíte verzi, kterou používáte.</span><span class="sxs-lookup"><span data-stu-id="c830f-143">Run `dotnet --version` to see which version you are using.</span></span> <span data-ttu-id="c830f-144">[`dotnet migrate`](../tools/dotnet-migrate.md) byla představena v .NET Core SDK 1.0.0 a odebrána ve verzi 3.0.100.</span><span class="sxs-lookup"><span data-stu-id="c830f-144">[`dotnet migrate`](../tools/dotnet-migrate.md) was introduced in .NET Core SDK 1.0.0 and removed in version 3.0.100.</span></span>
<span data-ttu-id="c830f-145">Tato chyba se zobrazí, pokud máte soubor *Global. JSON* v aktuálním nebo nadřazeném adresáři a verze `sdk`, kterou Určuje, je mimo tento rozsah.</span><span class="sxs-lookup"><span data-stu-id="c830f-145">You'll get this error if you have a *global.json* file in the current or parent directory, and the `sdk` version it specifies is outside this range.</span></span>

## <a name="migration-from-dnx-to-csproj"></a><span data-ttu-id="c830f-146">Migrace z DNX do csproj</span><span class="sxs-lookup"><span data-stu-id="c830f-146">Migration from DNX to csproj</span></span>

<span data-ttu-id="c830f-147">Pokud stále používáte DNX pro vývoj v .NET Core, proces migrace by se měl provádět ve dvou fázích:</span><span class="sxs-lookup"><span data-stu-id="c830f-147">If you are still using DNX for .NET Core development, your migration process should be done in two stages:</span></span>

1. <span data-ttu-id="c830f-148">Použijte [stávající pokyny k migraci DNX](from-dnx.md) k migraci z DNX na rozhraní PŘÍKAZového řádku s povoleným formátem JSON pro Project.</span><span class="sxs-lookup"><span data-stu-id="c830f-148">Use the [existing DNX migration guidance](from-dnx.md) to migrate from DNX to project-json enabled CLI.</span></span>
2. <span data-ttu-id="c830f-149">Postupujte podle kroků z předchozí části a migrujte z *Project. JSON* na *. csproj*.</span><span class="sxs-lookup"><span data-stu-id="c830f-149">Follow the steps from the previous section to migrate from *project.json* to *.csproj*.</span></span>  

> [!NOTE]
> <span data-ttu-id="c830f-150">DNX se oficiálně zastaralá během vydání verze Preview 1 .NET Core CLI.</span><span class="sxs-lookup"><span data-stu-id="c830f-150">DNX has become officially deprecated during the Preview 1 release of the .NET Core CLI.</span></span>

## <a name="migration-from-earlier-net-core-csproj-formats-to-rtm-csproj"></a><span data-ttu-id="c830f-151">Migrace z dřívějších formátů .NET Core csproj do RTM csproj</span><span class="sxs-lookup"><span data-stu-id="c830f-151">Migration from earlier .NET Core csproj formats to RTM csproj</span></span>

<span data-ttu-id="c830f-152">Formát .NET Core csproj se mění a vyvíjí u každé nové předběžné verze nástrojů.</span><span class="sxs-lookup"><span data-stu-id="c830f-152">The .NET Core csproj format has been changing and evolving with each new pre-release version of the tooling.</span></span> <span data-ttu-id="c830f-153">Neexistuje žádný nástroj, který by migrovali soubor projektu z dřívějších verzí sady csproj na nejnovější, takže je nutné ručně upravit soubor projektu.</span><span class="sxs-lookup"><span data-stu-id="c830f-153">There is no tool that will migrate your project file from earlier versions of csproj to the latest, so you need to manually edit the project file.</span></span> <span data-ttu-id="c830f-154">Skutečný postup závisí na verzi souboru projektu, který migrujete.</span><span class="sxs-lookup"><span data-stu-id="c830f-154">The actual steps depend on the version of the project file you are migrating.</span></span> <span data-ttu-id="c830f-155">Níže jsou uvedeny pokyny, které je třeba vzít v úvahu v závislosti na změnách, ke kterým došlo mezi verzemi:</span><span class="sxs-lookup"><span data-stu-id="c830f-155">The following is some guidance to consider based on the changes that happened between versions:</span></span>

- <span data-ttu-id="c830f-156">Odeberte vlastnost verze nástrojů z prvku `<Project>`, pokud existuje.</span><span class="sxs-lookup"><span data-stu-id="c830f-156">Remove the tools version property from the `<Project>` element, if it exists.</span></span>
- <span data-ttu-id="c830f-157">Z `<Project>` elementu odeberte obor názvů XML (`xmlns`).</span><span class="sxs-lookup"><span data-stu-id="c830f-157">Remove the XML namespace (`xmlns`) from the `<Project>` element.</span></span>
- <span data-ttu-id="c830f-158">Pokud neexistuje, přidejte atribut `Sdk` do prvku `<Project>` a nastavte jej na `Microsoft.NET.Sdk` nebo `Microsoft.NET.Sdk.Web`.</span><span class="sxs-lookup"><span data-stu-id="c830f-158">If it doesn't exist, add the `Sdk` attribute to the `<Project>` element and set it to `Microsoft.NET.Sdk` or `Microsoft.NET.Sdk.Web`.</span></span> <span data-ttu-id="c830f-159">Tento atribut určuje, že projekt používá sadu SDK, která má být použita.</span><span class="sxs-lookup"><span data-stu-id="c830f-159">This attribute specifies that the project uses the SDK to be used.</span></span> <span data-ttu-id="c830f-160">`Microsoft.NET.Sdk.Web` se používá pro webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="c830f-160">`Microsoft.NET.Sdk.Web` is used for web apps.</span></span>
- <span data-ttu-id="c830f-161">Odeberte příkazy `<Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" />` a `<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />` z horního a dolního okraje projektu.</span><span class="sxs-lookup"><span data-stu-id="c830f-161">Remove the `<Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" />` and `<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />` statements from the top and bottom of the project.</span></span> <span data-ttu-id="c830f-162">Tyto příkazy import jsou odvozeny v sadě SDK, takže není nutné, aby byly v projektu.</span><span class="sxs-lookup"><span data-stu-id="c830f-162">These import statements are implied by the SDK, so there is no need for them to be in the project.</span></span>
- <span data-ttu-id="c830f-163">Pokud máte v projektu `Microsoft.NETCore.App` nebo `NETStandard.Library` `<PackageReference>` položky, měli byste je odebrat.</span><span class="sxs-lookup"><span data-stu-id="c830f-163">If you have `Microsoft.NETCore.App` or `NETStandard.Library` `<PackageReference>` items in your project, you should remove them.</span></span> <span data-ttu-id="c830f-164">Tyto odkazy na balíčky jsou [odvozeny v sadě SDK](https://aka.ms/sdkimplicitrefs).</span><span class="sxs-lookup"><span data-stu-id="c830f-164">These package references are [implied by the SDK](https://aka.ms/sdkimplicitrefs).</span></span>
- <span data-ttu-id="c830f-165">Odeberte prvek `Microsoft.NET.Sdk` `<PackageReference>`, pokud existuje.</span><span class="sxs-lookup"><span data-stu-id="c830f-165">Remove the `Microsoft.NET.Sdk` `<PackageReference>` element, if it exists.</span></span> <span data-ttu-id="c830f-166">Odkaz na sadu SDK přichází prostřednictvím atributu `Sdk` u elementu `<Project>`.</span><span class="sxs-lookup"><span data-stu-id="c830f-166">The SDK reference comes through the `Sdk` attribute on the `<Project>` element.</span></span>
- <span data-ttu-id="c830f-167">Odeberte [globy](https://en.wikipedia.org/wiki/Glob_(programming)) , které jsou [zahrnuté v sadě SDK](../tools/csproj.md#default-compilation-includes-in-net-core-projects).</span><span class="sxs-lookup"><span data-stu-id="c830f-167">Remove the [globs](https://en.wikipedia.org/wiki/Glob_(programming)) that are [implied by the SDK](../tools/csproj.md#default-compilation-includes-in-net-core-projects).</span></span> <span data-ttu-id="c830f-168">Ponecháním těchto globy ve vašem projektu dojde k chybě při sestavování, protože položky kompilace budou duplikovány.</span><span class="sxs-lookup"><span data-stu-id="c830f-168">Leaving these globs in your project will cause an error on build because compile items will be duplicated.</span></span>

<span data-ttu-id="c830f-169">Po provedení těchto kroků by váš projekt měl být plně kompatibilní s formátem RTM .NET Core csproj.</span><span class="sxs-lookup"><span data-stu-id="c830f-169">After these steps your project should be fully compatible with the RTM .NET Core csproj format.</span></span>

<span data-ttu-id="c830f-170">Příklady před a po migraci ze starého formátu csproj na nový najdete v článku [aktualizace nástrojů pro vylepšení sady Visual Studio 2017 RC – .NET Core](https://devblogs.microsoft.com/dotnet/updating-visual-studio-2017-rc-net-core-tooling-improvements/) na blogu .NET.</span><span class="sxs-lookup"><span data-stu-id="c830f-170">For examples of before and after the migration from old csproj format to the new one, see the [Updating Visual Studio 2017 RC – .NET Core Tooling improvements](https://devblogs.microsoft.com/dotnet/updating-visual-studio-2017-rc-net-core-tooling-improvements/) article on the .NET blog.</span></span>

## <a name="see-also"></a><span data-ttu-id="c830f-171">Viz také:</span><span class="sxs-lookup"><span data-stu-id="c830f-171">See also</span></span>

- [<span data-ttu-id="c830f-172">Přenos, migrace a Upgrade projektů sady Visual Studio</span><span class="sxs-lookup"><span data-stu-id="c830f-172">Port, Migrate, and Upgrade Visual Studio Projects</span></span>](/visualstudio/porting/port-migrate-and-upgrade-visual-studio-projects)
