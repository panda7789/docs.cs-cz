---
title: Běhové prostředí pro nasazení samoobslužných aplikací v rozhraní .NET Core
description: Přečtěte si o dotnet publish změnách pro samostatná nasazení.
author: KathleenDollard
ms.date: 05/31/2018
ms.openlocfilehash: 22385c7b5d2bf87755fd51cd6268d21fe3431c74
ms.sourcegitcommit: 9a97c76e141333394676bc5d264c6624b6f45bcf
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/08/2020
ms.locfileid: "75740793"
---
# <a name="self-contained-deployment-runtime-roll-forward"></a><span data-ttu-id="41bf7-103">Samostatné nasazení – dopředné posunutí modulu runtime</span><span class="sxs-lookup"><span data-stu-id="41bf7-103">Self-contained deployment runtime roll forward</span></span>

<span data-ttu-id="41bf7-104">[Nasazení samostatně obsažených aplikací](index.md) .NET Core zahrnuje i knihovny .NET Core i modul runtime .NET Core.</span><span class="sxs-lookup"><span data-stu-id="41bf7-104">.NET Core [self-contained application deployments](index.md) include both the .NET Core libraries and the .NET Core runtime.</span></span> <span data-ttu-id="41bf7-105">Počínaje rozhraním .NET Core 2,1 SDK (verze 2.1.300) publikovaná samostatná nasazení aplikace [publikuje na vašem počítači nejvyšší modul opravy](https://github.com/dotnet/designs/pull/36).</span><span class="sxs-lookup"><span data-stu-id="41bf7-105">Starting in .NET Core 2.1 SDK (version 2.1.300), a self-contained application deployment [publishes the highest patch runtime on your machine](https://github.com/dotnet/designs/pull/36).</span></span> <span data-ttu-id="41bf7-106">Ve výchozím nastavení [`dotnet publish`](../tools/dotnet-publish.md) pro samostatné nasazení vybere nejnovější verzi nainstalovanou jako součást sady SDK na počítači pro publikování.</span><span class="sxs-lookup"><span data-stu-id="41bf7-106">By default, [`dotnet publish`](../tools/dotnet-publish.md) for a self-contained deployment selects the latest version installed as part of the SDK on the publishing machine.</span></span> <span data-ttu-id="41bf7-107">Tím umožníte, aby se nasazená aplikace spouštěla s opravami zabezpečení (a dalšími opravami), které jsou dostupné během `publish`.</span><span class="sxs-lookup"><span data-stu-id="41bf7-107">This enables your deployed application to run with security fixes (and other fixes) available during `publish`.</span></span> <span data-ttu-id="41bf7-108">Aby bylo možné získat novou opravu, je nutné aplikaci znovu publikovat.</span><span class="sxs-lookup"><span data-stu-id="41bf7-108">The application must be republished to obtain a new patch.</span></span> <span data-ttu-id="41bf7-109">Samostatné aplikace jsou vytvořeny zadáním `-r <RID>` v příkazu `dotnet publish` nebo zadáním [identifikátoru modulu runtime (RID)](../rid-catalog.md) v souboru projektu (csproj/vbproj) nebo na příkazovém řádku.</span><span class="sxs-lookup"><span data-stu-id="41bf7-109">Self-contained applications are created by specifying `-r <RID>` on the `dotnet publish` command or by specifying the [runtime identifier (RID)](../rid-catalog.md) in the project file (csproj / vbproj) or on the command line.</span></span>

## <a name="patch-version-roll-forward-overview"></a><span data-ttu-id="41bf7-110">Přehled aktualizace verze posunutí – přehled</span><span class="sxs-lookup"><span data-stu-id="41bf7-110">Patch version roll forward overview</span></span>

<span data-ttu-id="41bf7-111">[`restore`](../tools/dotnet-restore.md), [`build`](../tools/dotnet-build.md) a [`publish`](../tools/dotnet-publish.md) , jsou `dotnet` příkazy, které se dají spouštět samostatně.</span><span class="sxs-lookup"><span data-stu-id="41bf7-111">[`restore`](../tools/dotnet-restore.md), [`build`](../tools/dotnet-build.md) and [`publish`](../tools/dotnet-publish.md) are `dotnet` commands that can run separately.</span></span> <span data-ttu-id="41bf7-112">Volba modulu runtime je součástí operace `restore`, nikoli `publish` nebo `build`.</span><span class="sxs-lookup"><span data-stu-id="41bf7-112">The runtime choice is part of the `restore` operation, not `publish` or `build`.</span></span> <span data-ttu-id="41bf7-113">Pokud zavoláte `publish`, bude zvolena nejnovější verze patch.</span><span class="sxs-lookup"><span data-stu-id="41bf7-113">If you call `publish`, the latest patch version will be chosen.</span></span> <span data-ttu-id="41bf7-114">Pokud zavoláte `publish` s argumentem `--no-restore`, pak nebudete mít k dispozici požadovanou verzi opravy, protože předchozí `restore` pravděpodobně nebyla provedena s novou zásadou pro publikování aplikací, která je samostatnou součástí.</span><span class="sxs-lookup"><span data-stu-id="41bf7-114">If you call `publish` with the `--no-restore` argument, then you may not get the desired patch version because a prior `restore` may not have been executed with the new self-contained application publishing policy.</span></span> <span data-ttu-id="41bf7-115">V tomto případě se chyba sestavení generuje s textem podobným následujícímu:</span><span class="sxs-lookup"><span data-stu-id="41bf7-115">In this case, a build error is generated with text similar to the following:</span></span>

  <span data-ttu-id="41bf7-116">"Projekt se obnovil pomocí Microsoft. NETCore. app verze 2.0.0, ale s aktuálním nastavením se místo toho použije verze 2.0.6.</span><span class="sxs-lookup"><span data-stu-id="41bf7-116">"The project was restored using Microsoft.NETCore.App version 2.0.0, but with current settings, version 2.0.6 would be used instead.</span></span> <span data-ttu-id="41bf7-117">Chcete-li tento problém vyřešit, zajistěte, aby se pro obnovení používalo stejné nastavení a pro následné operace, jako je například sestavení nebo publikování.</span><span class="sxs-lookup"><span data-stu-id="41bf7-117">To resolve this issue, make sure the same settings are used for restore and for subsequent operations such as build or publish.</span></span> <span data-ttu-id="41bf7-118">K tomuto problému obvykle dochází, pokud je vlastnost RuntimeIdentifier nastavena během sestavování nebo publikování, ale nikoli během obnovení. "</span><span class="sxs-lookup"><span data-stu-id="41bf7-118">Typically this issue can occur if the RuntimeIdentifier property is set during build or publish but not during restore."</span></span>

> [!NOTE]
> <span data-ttu-id="41bf7-119">`restore` a `build` lze spustit implicitně jako součást jiného příkazu, jako je `publish`.</span><span class="sxs-lookup"><span data-stu-id="41bf7-119">`restore` and `build` can be run implicitly as part of another command, like `publish`.</span></span> <span data-ttu-id="41bf7-120">Při implicitním spuštění jako součást jiného příkazu jsou k dispozici s dalším kontextem, aby byly vytvořeny správné artefakty.</span><span class="sxs-lookup"><span data-stu-id="41bf7-120">When run implicitly as part of another command, they are provided with additional context so that the right artifacts are produced.</span></span> <span data-ttu-id="41bf7-121">Když `publish`te s modulem runtime (například `dotnet publish -r linux-x64`), implicitní `restore` obnoví balíčky pro modul runtime pro Linux-x64.</span><span class="sxs-lookup"><span data-stu-id="41bf7-121">When you `publish` with a runtime (for example, `dotnet publish -r linux-x64`), the implicit `restore` restores packages for the linux-x64 runtime.</span></span> <span data-ttu-id="41bf7-122">Pokud `restore` explicitně zavoláte, neobnoví běhové balíčky ve výchozím nastavení, protože nemá daný kontext.</span><span class="sxs-lookup"><span data-stu-id="41bf7-122">If you call `restore` explicitly, it does not restore runtime packages by default, because it doesn't have that context.</span></span>

## <a name="how-to-avoid-restore-during-publish"></a><span data-ttu-id="41bf7-123">Jak se vyhnout obnovení během publikování</span><span class="sxs-lookup"><span data-stu-id="41bf7-123">How to avoid restore during publish</span></span>

<span data-ttu-id="41bf7-124">Spuštění `restore` jako součást operace `publish` může být pro váš scénář nežádoucí.</span><span class="sxs-lookup"><span data-stu-id="41bf7-124">Running `restore` as part of the `publish` operation may be undesirable for your scenario.</span></span> <span data-ttu-id="41bf7-125">Abyste se vyhnuli `restore` během `publish` při vytváření samostatných aplikací, udělejte toto:</span><span class="sxs-lookup"><span data-stu-id="41bf7-125">To avoid `restore` during `publish` while creating self-contained applications, do the following:</span></span>

- <span data-ttu-id="41bf7-126">Nastavte vlastnost `RuntimeIdentifiers` na seznam oddělený středníkem všech [identifikátorů RID](../rid-catalog.md) , které se mají publikovat.</span><span class="sxs-lookup"><span data-stu-id="41bf7-126">Set the `RuntimeIdentifiers` property to a semicolon-separated list of all the [RIDs](../rid-catalog.md) to be published.</span></span>
- <span data-ttu-id="41bf7-127">Nastavte `TargetLatestRuntimePatch` vlastnost `true`.</span><span class="sxs-lookup"><span data-stu-id="41bf7-127">Set the `TargetLatestRuntimePatch` property to `true`.</span></span>

## <a name="no-restore-argument-with-dotnet-publish-options"></a><span data-ttu-id="41bf7-128">Argument No-Restore s možnostmi dotnet publish</span><span class="sxs-lookup"><span data-stu-id="41bf7-128">No-restore argument with dotnet publish options</span></span>

<span data-ttu-id="41bf7-129">Pokud chcete vytvořit samostatně používané aplikace i [aplikace závislé na architektuře](index.md) se stejným souborem projektu a chcete použít argument `--no-restore` s `dotnet publish`a pak zvolte jednu z následujících možností:</span><span class="sxs-lookup"><span data-stu-id="41bf7-129">If you want to create both self-contained applications and [framework-dependent applications](index.md) with the same project file, and you want to use the `--no-restore` argument with `dotnet publish`, then choose one of the following:</span></span>

1. <span data-ttu-id="41bf7-130">Preferovat chování závislé na rozhraní.</span><span class="sxs-lookup"><span data-stu-id="41bf7-130">Prefer the framework-dependent behavior.</span></span> <span data-ttu-id="41bf7-131">Pokud je aplikace závislá na rozhraní, jedná se o výchozí chování.</span><span class="sxs-lookup"><span data-stu-id="41bf7-131">If the application is framework-dependent, this is the default behavior.</span></span> <span data-ttu-id="41bf7-132">Pokud je aplikace samostatná a může použít neopravený místní modul runtime 2.1.0, nastavte `TargetLatestRuntimePatch` na `false` v souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="41bf7-132">If the application is self-contained, and can use an unpatched 2.1.0 local runtime, set the `TargetLatestRuntimePatch` to `false` in the project file.</span></span>

2. <span data-ttu-id="41bf7-133">Preferovat chování samostatně obsaženého.</span><span class="sxs-lookup"><span data-stu-id="41bf7-133">Prefer the self-contained behavior.</span></span> <span data-ttu-id="41bf7-134">Pokud je aplikace samostatná, jedná se o výchozí chování.</span><span class="sxs-lookup"><span data-stu-id="41bf7-134">If the application is self-contained, this is the default behavior.</span></span> <span data-ttu-id="41bf7-135">Pokud je aplikace závislá na rozhraní a vyžaduje nainstalovanou nejnovější opravu, nastavte `TargetLatestRuntimePatch` na `true` v souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="41bf7-135">If the application is framework-dependent, and requires the latest patch installed, set `TargetLatestRuntimePatch` to `true` in the project file.</span></span>

3. <span data-ttu-id="41bf7-136">Převezměte explicitní řízení verze rozhraní Runtime nastavením `RuntimeFrameworkVersion` na konkrétní verzi opravy v souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="41bf7-136">Take explicit control of the runtime framework version by setting `RuntimeFrameworkVersion` to the specific patch version in the project file.</span></span>
