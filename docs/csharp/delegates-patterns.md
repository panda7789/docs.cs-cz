---
title: Obecné vzory pro delegáty
description: Další informace o běžných vzorcích pro použití delegátů v kódu, abyste se vyhnuli silnému spojení mezi součástmi.
ms.date: 06/20/2016
ms.assetid: 0ff8fdfd-6a11-4327-b061-0f2526f35b43
ms.openlocfilehash: 22ab88e5b139381e3a8921baa20df035f1405146
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/14/2020
ms.locfileid: "79399663"
---
# <a name="common-patterns-for-delegates"></a><span data-ttu-id="1d4f8-103">Obecné vzory pro delegáty</span><span class="sxs-lookup"><span data-stu-id="1d4f8-103">Common Patterns for Delegates</span></span>

[<span data-ttu-id="1d4f8-104">Předchozí</span><span class="sxs-lookup"><span data-stu-id="1d4f8-104">Previous</span></span>](delegates-strongly-typed.md)

<span data-ttu-id="1d4f8-105">Delegáti poskytují mechanismus, který umožňuje návrhy softwaru zahrnující minimální párování mezi součástmi.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-105">Delegates provide a mechanism that enables software designs involving minimal coupling between components.</span></span>

<span data-ttu-id="1d4f8-106">Jeden vynikající příklad pro tento druh designu je LINQ.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-106">One excellent example for this kind of design is LINQ.</span></span> <span data-ttu-id="1d4f8-107">Vzor výrazu dotazu LINQ závisí na delegátech pro všechny jeho funkce.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-107">The LINQ Query Expression Pattern relies on delegates for all of its features.</span></span> <span data-ttu-id="1d4f8-108">Vezměme si tento jednoduchý příklad:</span><span class="sxs-lookup"><span data-stu-id="1d4f8-108">Consider this simple example:</span></span>

```csharp
var smallNumbers = numbers.Where(n => n < 10);
```

<span data-ttu-id="1d4f8-109">Tím se vyfiltruje posloupnost čísel pouze na čísla menší než hodnota 10.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-109">This filters the sequence of numbers to only those less than the value 10.</span></span>
<span data-ttu-id="1d4f8-110">Metoda `Where` používá delegáta, který určuje, které prvky sekvence předat filtr.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-110">The `Where` method uses a delegate that determines which elements of a sequence pass the filter.</span></span> <span data-ttu-id="1d4f8-111">Při vytváření dotazu LINQ zadáte implementaci delegáta pro tento konkrétní účel.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-111">When you create a LINQ query, you supply the implementation of the delegate for this specific purpose.</span></span>

<span data-ttu-id="1d4f8-112">Prototyp metody Kde je:</span><span class="sxs-lookup"><span data-stu-id="1d4f8-112">The prototype for the Where method is:</span></span>

```csharp
public static IEnumerable<TSource> Where<TSource> (this IEnumerable<TSource> source, Func<TSource, bool> predicate);
```

<span data-ttu-id="1d4f8-113">Tento příklad se opakuje se všemi metodami, které jsou součástí LINQ.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-113">This example is repeated with all the methods that are part of LINQ.</span></span> <span data-ttu-id="1d4f8-114">Všechny spoléhají na delegáty pro kód, který spravuje konkrétní dotaz.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-114">They all rely on delegates for the code that manages the specific query.</span></span> <span data-ttu-id="1d4f8-115">Tento návrhový vzor rozhraní API je velmi výkonný, který se učí a rozumí.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-115">This API design pattern is a very powerful one to learn and understand.</span></span>

<span data-ttu-id="1d4f8-116">Tento jednoduchý příklad ukazuje, jak delegáti vyžadují velmi málo párování mezi součástmi.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-116">This simple example illustrates how delegates require very little coupling between components.</span></span> <span data-ttu-id="1d4f8-117">Není nutné vytvořit třídu, která je odvozena z určité základní třídy.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-117">You don't need to create a class that derives from a particular base class.</span></span> <span data-ttu-id="1d4f8-118">Není nutné implementovat konkrétní rozhraní.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-118">You don't need to implement a specific interface.</span></span>
<span data-ttu-id="1d4f8-119">Jediným požadavkem je poskytnout implementaci jedné metody, která je pro daný úkol zásadní.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-119">The only requirement is to provide the implementation of one method that is fundamental to the task at hand.</span></span>

## <a name="building-your-own-components-with-delegates"></a><span data-ttu-id="1d4f8-120">Vytváření vlastních komponent s delegáty</span><span class="sxs-lookup"><span data-stu-id="1d4f8-120">Building Your Own Components with Delegates</span></span>

<span data-ttu-id="1d4f8-121">Budeme stavět na tomto příkladu vytvořením komponenty pomocí návrhu, který závisí na delegátech.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-121">Let's build on that example by creating a component using a design that relies on delegates.</span></span>

<span data-ttu-id="1d4f8-122">Pojďme definovat součást, která by mohla být použita pro zprávy protokolu ve velkém systému.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-122">Let's define a component that could be used for log messages in a large system.</span></span> <span data-ttu-id="1d4f8-123">Součásti knihovny lze použít v mnoha různých prostředích, na různých platformách.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-123">The library components could be used in many different environments, on multiple different platforms.</span></span> <span data-ttu-id="1d4f8-124">Existuje mnoho běžných funkcí v součásti, která spravuje protokoly.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-124">There are a lot of common features in the component that manages the logs.</span></span> <span data-ttu-id="1d4f8-125">Bude muset přijímat zprávy z libovolné součásti v systému.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-125">It will need to accept messages from any component in the system.</span></span> <span data-ttu-id="1d4f8-126">Tyto zprávy budou mít různé priority, které může základní součást spravovat.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-126">Those messages will have different priorities, which the core component can manage.</span></span> <span data-ttu-id="1d4f8-127">Zprávy by měly mít časová razítka v konečné archivované podobě.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-127">The messages should have timestamps in their final archived form.</span></span> <span data-ttu-id="1d4f8-128">Pro pokročilejší scénáře můžete filtrovat zprávy podle zdrojové součásti.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-128">For more advanced scenarios, you could filter messages by the source component.</span></span>

<span data-ttu-id="1d4f8-129">Existuje jeden aspekt funkce, která se bude často měnit: kde jsou zprávy zapsány.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-129">There is one aspect of the feature that will change often: where messages are written.</span></span> <span data-ttu-id="1d4f8-130">V některých prostředích mohou být zapsány do konzoly chyb.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-130">In some environments, they may be written to the error console.</span></span> <span data-ttu-id="1d4f8-131">V jiných soubor.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-131">In others, a file.</span></span> <span data-ttu-id="1d4f8-132">Mezi další možnosti patří úložiště databáze, protokoly událostí operačního systému nebo jiné úložiště dokumentů.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-132">Other possibilities include database storage, OS event logs, or other document storage.</span></span>

<span data-ttu-id="1d4f8-133">Existují také kombinace výstupu, které mohou být použity v různých scénářích.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-133">There are also combinations of output that might be used in different scenarios.</span></span> <span data-ttu-id="1d4f8-134">Můžete chtít psát zprávy do konzoly a do souboru.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-134">You may want to write messages to the console and to a file.</span></span>

<span data-ttu-id="1d4f8-135">Návrh založený na delegátech poskytne velkou flexibilitu a usnadní podporu mechanismů úložiště, které mohou být přidány v budoucnu.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-135">A design based on delegates will provide a great deal of flexibility, and make it easy to support storage mechanisms that may be added in the future.</span></span>

<span data-ttu-id="1d4f8-136">V rámci tohoto návrhu primární součást protokolu může být nevirtuální, dokonce zapečetěné třídy.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-136">Under this design, the primary log component can be a non-virtual, even sealed class.</span></span> <span data-ttu-id="1d4f8-137">Chcete-li zapisovat zprávy na různá paměťová média, můžete připojit libovolnou sadu delegátů.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-137">You can plug in any set of delegates to write the messages to different storage media.</span></span> <span data-ttu-id="1d4f8-138">Integrovaná podpora pro delegáty vícesměrového vysílání usnadňuje podporu scénářů, kde zprávy musí být zapsány do více umístění (soubor a konzola).</span><span class="sxs-lookup"><span data-stu-id="1d4f8-138">The built in support for multicast delegates makes it easy to support scenarios where messages must be written to multiple locations (a file, and a console).</span></span>

## <a name="a-first-implementation"></a><span data-ttu-id="1d4f8-139">První implementace</span><span class="sxs-lookup"><span data-stu-id="1d4f8-139">A First Implementation</span></span>

<span data-ttu-id="1d4f8-140">Začněme malé: počáteční implementace bude přijímat nové zprávy a psát je pomocí libovolného připojeného delegáta.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-140">Let's start small: the initial implementation will accept new messages, and write them using any attached delegate.</span></span> <span data-ttu-id="1d4f8-141">Můžete začít s jedním delegátem, který zapisuje zprávy do konzoly.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-141">You can start with one delegate that writes messages to the console.</span></span>

[!code-csharp[LoggerImplementation](../../samples/snippets/csharp/delegates-and-events/Logger.cs#FirstImplementation "A first Logger implementation.")]

<span data-ttu-id="1d4f8-142">Statická třída výše je nejjednodušší věc, která může fungovat.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-142">The static class above is the simplest thing that can work.</span></span> <span data-ttu-id="1d4f8-143">Musíme napsat jedinou implementaci pro metodu, která zapisuje zprávy do konzoly:</span><span class="sxs-lookup"><span data-stu-id="1d4f8-143">We need to write the single implementation for the method that writes messages to the console:</span></span>

[!code-csharp[LogToConsole](../../samples/snippets/csharp/delegates-and-events/LoggingMethods.cs#LogToConsole "A Console logger.")]

<span data-ttu-id="1d4f8-144">Nakonec je třeba připojit delegáta připojením k writemessage delegát deklarované v protokolování:</span><span class="sxs-lookup"><span data-stu-id="1d4f8-144">Finally, you need to hook up the delegate by attaching it to the WriteMessage delegate declared in the logger:</span></span>

[!code-csharp[ConnectDelegate](../../samples/snippets/csharp/delegates-and-events/Program.cs#ConnectDelegate "Connect to the delegate")]

## <a name="practices"></a><span data-ttu-id="1d4f8-145">Postupy</span><span class="sxs-lookup"><span data-stu-id="1d4f8-145">Practices</span></span>

<span data-ttu-id="1d4f8-146">Náš vzorek zatím je poměrně jednoduchý, ale stále ukazuje některé důležité pokyny pro návrhy zahrnující delegáty.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-146">Our sample so far is fairly simple, but it still demonstrates some of the important guidelines for designs involving delegates.</span></span>

<span data-ttu-id="1d4f8-147">Použití typů delegátů definovaných v základní rámci usnadňuje uživatelům práci s delegáty.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-147">Using the delegate types defined in the Core Framework makes it easier for users to work with the delegates.</span></span> <span data-ttu-id="1d4f8-148">Nemusíte definovat nové typy a vývojáři, kteří používají vaši knihovnu, se nemusí učit nové specializované typy delegátů.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-148">You don't need to define new types, and developers using your library do not need to learn new, specialized delegate types.</span></span>

<span data-ttu-id="1d4f8-149">Použitá rozhraní jsou co nejmenší a co nejflexibilnější: Chcete-li vytvořit nový výstupní protokol, musíte vytvořit jednu metodu.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-149">The interfaces used are as minimal and as flexible as possible: To create a new output logger, you must create one method.</span></span> <span data-ttu-id="1d4f8-150">Tato metoda může být statickou metodou nebo metodou instance.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-150">That method may be a static method, or an instance method.</span></span> <span data-ttu-id="1d4f8-151">Může mít jakýkoliv přístup.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-151">It may have any access.</span></span>

## <a name="formatting-output"></a><span data-ttu-id="1d4f8-152">Formátování výstupu</span><span class="sxs-lookup"><span data-stu-id="1d4f8-152">Formatting Output</span></span>

<span data-ttu-id="1d4f8-153">Udělejme tuto první verzi trochu robustnější a pak začněte vytvářet další mechanismy protokolování.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-153">Let's make this first version a bit more robust, and then start creating other logging mechanisms.</span></span>

<span data-ttu-id="1d4f8-154">Dále přidáme několik argumentů k `LogMessage()` metodě tak, aby vaše třída protokolu vytvořila strukturovanější zprávy:</span><span class="sxs-lookup"><span data-stu-id="1d4f8-154">Next, let's add a few arguments to the `LogMessage()` method so that your log class creates more structured messages:</span></span>

[!code-csharp[Severity](../../samples/snippets/csharp/delegates-and-events/Logger.cs#Severity "Define severities")]
[!code-csharp[NextLogger](../../samples/snippets/csharp/delegates-and-events/Logger.cs#LoggerTwo "Refine the Logger")]

<span data-ttu-id="1d4f8-155">Dále využijte tento `Severity` argument k filtrování zpráv, které jsou odesílány do výstupu protokolu.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-155">Next, let's make use of that `Severity` argument to filter the messages that are sent to the log's output.</span></span>

[!code-csharp[FinalLogger](../../samples/snippets/csharp/delegates-and-events/Logger.cs#LoggerFinal "Finish the Logger")]

## <a name="practices"></a><span data-ttu-id="1d4f8-156">Postupy</span><span class="sxs-lookup"><span data-stu-id="1d4f8-156">Practices</span></span>

<span data-ttu-id="1d4f8-157">Do infrastruktury protokolování jste přidali nové funkce.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-157">You've added new features to the logging infrastructure.</span></span> <span data-ttu-id="1d4f8-158">Vzhledem k tomu, že součást protokolování je velmi volně spojena s libovolným výstupním mechanismem, tyto nové funkce lze přidat bez dopadu na některý z kódu implementujícího delegáta protokolování.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-158">Because the logger component is very loosely coupled to any output mechanism, these new features can be added with no impact on any of the code implementing the logger delegate.</span></span>

<span data-ttu-id="1d4f8-159">Při vytváření tohoto stavu uvidíte další příklady toho, jak tato volná spojka umožňuje větší flexibilitu při aktualizaci částí webu bez jakýchkoli změn v jiných umístěních.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-159">As you keep building this, you'll see more examples of how this loose coupling enables greater flexibility in updating parts of the site without any changes to other locations.</span></span> <span data-ttu-id="1d4f8-160">Ve skutečnosti ve větší aplikaci, výstupní třídy protokolování může být v jiném sestavení a ani není nutné znovu sestavit.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-160">In fact, in a larger application, the logger output classes might be in a different assembly, and not even need to be rebuilt.</span></span>

## <a name="building-a-second-output-engine"></a><span data-ttu-id="1d4f8-161">Vytvoření druhého výstupního modulu</span><span class="sxs-lookup"><span data-stu-id="1d4f8-161">Building a Second Output Engine</span></span>

<span data-ttu-id="1d4f8-162">Složka Log přichází dobře.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-162">The Log component is coming along well.</span></span> <span data-ttu-id="1d4f8-163">Přidáme ještě jeden výstupní modul, který zaznamenává zprávy do souboru.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-163">Let's add one more output engine that logs messages to a file.</span></span> <span data-ttu-id="1d4f8-164">To bude o něco více zapojený chod motoru.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-164">This will be a slightly more involved output engine.</span></span> <span data-ttu-id="1d4f8-165">Bude to třída, která zapouzdřuje operace se soubory a zajišťuje, že soubor je vždy uzavřen po každém zápisu.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-165">It will be a class that encapsulates the file operations, and ensures that the file is always closed after each write.</span></span> <span data-ttu-id="1d4f8-166">Tím zajistíte, že všechna data jsou vyprázdněna na disk po vygenerování každé zprávy.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-166">That ensures that all the data is flushed to disk after each message is generated.</span></span>

<span data-ttu-id="1d4f8-167">Zde je, že soubor založený logger:</span><span class="sxs-lookup"><span data-stu-id="1d4f8-167">Here is that file based logger:</span></span>

[!code-csharp[FileLogger](../../samples/snippets/csharp/delegates-and-events/FileLogger.cs#FileLogger "Log to files")]

<span data-ttu-id="1d4f8-168">Po vytvoření této třídy, můžete vytvořit instanci a připojí jeho LogMessage metoda logger komponenty:</span><span class="sxs-lookup"><span data-stu-id="1d4f8-168">Once you've created this class, you can instantiate it and it attaches its LogMessage method to the Logger component:</span></span>

[!code-csharp[FileLogger](../../samples/snippets/csharp/delegates-and-events/Program.cs#FileLogger "Log to files")]

<span data-ttu-id="1d4f8-169">Tihle dva se vzájemně nevylučují.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-169">These two are not mutually exclusive.</span></span> <span data-ttu-id="1d4f8-170">Můžete připojit metody protokolu a generovat zprávy ke konzole a souboru:</span><span class="sxs-lookup"><span data-stu-id="1d4f8-170">You could attach both log methods and generate messages to the console and a file:</span></span>

```csharp
var fileOutput = new FileLogger("log.txt");
Logger.WriteMessage += LoggingMethods.LogToConsole; // LoggingMethods is the static class we utilized earlier
```

<span data-ttu-id="1d4f8-171">Později, i ve stejné aplikaci, můžete odebrat jeden z delegátů bez dalších problémů do systému:</span><span class="sxs-lookup"><span data-stu-id="1d4f8-171">Later, even in the same application, you can remove one of the delegates without any other issues to the system:</span></span>

```csharp
Logger.WriteMessage -= LoggingMethods.LogToConsole;
```

## <a name="practices"></a><span data-ttu-id="1d4f8-172">Postupy</span><span class="sxs-lookup"><span data-stu-id="1d4f8-172">Practices</span></span>

<span data-ttu-id="1d4f8-173">Nyní jste přidali druhou výstupní obslužnou rutinu pro podsystém protokolování.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-173">Now, you've added a second output handler for the logging sub-system.</span></span>
<span data-ttu-id="1d4f8-174">Ten potřebuje trochu více infrastruktury pro správnou podporu systému souborů.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-174">This one needs a bit more infrastructure to correctly support the file system.</span></span> <span data-ttu-id="1d4f8-175">Delegát je metoda instance.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-175">The delegate is an instance method.</span></span> <span data-ttu-id="1d4f8-176">Je to také soukromá metoda.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-176">It's also a private method.</span></span>
<span data-ttu-id="1d4f8-177">Není třeba větší dostupnost, protože infrastruktura delegáta může připojit delegáty.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-177">There's no need for greater accessibility because the delegate infrastructure can connect the delegates.</span></span>

<span data-ttu-id="1d4f8-178">Za druhé návrh založený na delegáta umožňuje více výstupních metod bez dalšího kódu.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-178">Second, the delegate-based design enables multiple output methods without any extra code.</span></span> <span data-ttu-id="1d4f8-179">Není nutné vytvářet žádné další infrastruktury pro podporu více výstupních metod.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-179">You don't need to build any additional infrastructure to support multiple output methods.</span></span> <span data-ttu-id="1d4f8-180">Jednoduše se stávají další metodou na seznamu vyvolání.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-180">They simply become another method on the invocation list.</span></span>

<span data-ttu-id="1d4f8-181">Věnujte zvláštní pozornost kódu v metodě výstupu protokolování souborů.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-181">Pay special attention to the code in the file logging output method.</span></span> <span data-ttu-id="1d4f8-182">Je kódován zajistit, že nevyvolá žádné výjimky.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-182">It is coded to ensure that it does not throw any exceptions.</span></span> <span data-ttu-id="1d4f8-183">I když to není vždy nezbytně nutné, je to často dobrá praxe.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-183">While this isn't always strictly necessary, it's often a good practice.</span></span> <span data-ttu-id="1d4f8-184">Pokud některá z metod delegáta vyvolá výjimku, zbývající delegáti, které jsou na vyvolání nebude vyvolána.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-184">If either of the delegate methods throws an exception, the remaining delegates that are on the invocation won't be invoked.</span></span>

<span data-ttu-id="1d4f8-185">Jako poslední poznámka musí protokolování souborů spravovat své prostředky otevřením a zavřením souboru v každé zprávě protokolu.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-185">As a last note, the file logger must manage its resources by opening and closing the file on each log message.</span></span> <span data-ttu-id="1d4f8-186">Můžete se rozhodnout ponechat soubor otevřený a implementovat IDisposable k zavření souboru po dokončení.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-186">You could choose to keep the file open and implement IDisposable to close the file when you are completed.</span></span>
<span data-ttu-id="1d4f8-187">Každá metoda má své výhody a nevýhody.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-187">Either method has its advantages and disadvantages.</span></span> <span data-ttu-id="1d4f8-188">Oba vytvořit trochu více spojení mezi třídami.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-188">Both do create a bit more coupling between the classes.</span></span>

<span data-ttu-id="1d4f8-189">Žádný kód ve třídě Logger by bylo nutné aktualizovat, aby bylo možné podporovat oba scénáře.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-189">None of the code in the Logger class would need to be updated in order to support either scenario.</span></span>

## <a name="handling-null-delegates"></a><span data-ttu-id="1d4f8-190">Zpracování nulových delegátů</span><span class="sxs-lookup"><span data-stu-id="1d4f8-190">Handling Null Delegates</span></span>

<span data-ttu-id="1d4f8-191">Nakonec pojďme aktualizovat LogMessage metoda tak, aby je robustní pro ty případy, kdy je vybrán žádný výstupní mechanismus.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-191">Finally, let's update the LogMessage method so that it is robust for those cases when no output mechanism is selected.</span></span> <span data-ttu-id="1d4f8-192">Aktuální implementace vyvolá, `NullReferenceException` když `WriteMessage` delegát nemá seznam vyvolání připojen.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-192">The current implementation will throw a `NullReferenceException` when the `WriteMessage` delegate does not have an invocation list attached.</span></span>
<span data-ttu-id="1d4f8-193">Můžete dát přednost návrhu, který tiše pokračuje, když nebyly připojeny žádné metody.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-193">You may prefer a design that silently continues when no methods have been attached.</span></span> <span data-ttu-id="1d4f8-194">To je snadné pomocí operátoru podmíněné `Delegate.Invoke()` null v kombinaci s metodou:</span><span class="sxs-lookup"><span data-stu-id="1d4f8-194">This is easy using the null conditional operator, combined with the `Delegate.Invoke()` method:</span></span>

```csharp
public static void LogMessage(string msg)
{
    WriteMessage?.Invoke(msg);
}
```

<span data-ttu-id="1d4f8-195">Operátor null podmíněné (`?.`) zkratuje,`WriteMessage` když je levý operand ( v tomto případě) null, což znamená, že není proveden žádný pokus o protokolování zprávy.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-195">The null conditional operator (`?.`) short-circuits when the left operand (`WriteMessage` in this case) is null, which means no attempt is made to log a message.</span></span>

<span data-ttu-id="1d4f8-196">Nenajdete metodu `Invoke()` uvedenou v dokumentaci pro `System.Delegate` nebo `System.MulticastDelegate`.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-196">You won't find the `Invoke()` method listed in the documentation for `System.Delegate` or `System.MulticastDelegate`.</span></span> <span data-ttu-id="1d4f8-197">Kompilátor generuje typ `Invoke` ovou bezpečnou metodu pro všechny deklarované typy delegátů.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-197">The compiler generates a type safe `Invoke` method for any delegate type declared.</span></span> <span data-ttu-id="1d4f8-198">V tomto příkladu `Invoke` to `string` znamená, že má jeden argument a má prázdný návratový typ.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-198">In this example, that means `Invoke` takes a single `string` argument, and has a void return type.</span></span>

## <a name="summary-of-practices"></a><span data-ttu-id="1d4f8-199">Shrnutí postupů</span><span class="sxs-lookup"><span data-stu-id="1d4f8-199">Summary of Practices</span></span>

<span data-ttu-id="1d4f8-200">Viděli jste začátky součásti protokolu, která by mohla být rozšířena s jinými autory a dalšími funkcemi.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-200">You've seen the beginnings of a log component that could be expanded with other writers, and other features.</span></span> <span data-ttu-id="1d4f8-201">Pomocí delegátů v návrhu jsou tyto různé součásti velmi volně spojeny.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-201">By using delegates in the design these different components are very loosely coupled.</span></span> <span data-ttu-id="1d4f8-202">To poskytuje několik výhod.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-202">This provides several advantages.</span></span> <span data-ttu-id="1d4f8-203">Je velmi snadné vytvořit nové výstupní mechanismy a připojit je k systému.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-203">It's very easy to create new output mechanisms and attach them to the system.</span></span> <span data-ttu-id="1d4f8-204">Tyto další mechanismy potřebují pouze jednu metodu: metodu, která zapisuje zprávu protokolu.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-204">These other mechanisms only need one method: the method that writes the log message.</span></span> <span data-ttu-id="1d4f8-205">Je to design, který je velmi odolný, když jsou přidány nové funkce.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-205">It's a design that is very resilient when new features are added.</span></span> <span data-ttu-id="1d4f8-206">Smlouva požadovaná pro všechny zapisovatel je implementovat jednu metodu.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-206">The contract required for any writer is to implement one method.</span></span> <span data-ttu-id="1d4f8-207">Tato metoda může být statickou metodu nebo metodu instance.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-207">That method could be a static or instance method.</span></span> <span data-ttu-id="1d4f8-208">Může to být veřejný, soukromý nebo jakýkoli jiný legální přístup.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-208">It could be public, private, or any other legal access.</span></span>

<span data-ttu-id="1d4f8-209">Logger třída může provádět libovolný počet vylepšení nebo změny bez zavedení narušující změny.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-209">The Logger class can make any number of enhancements or changes without introducing breaking changes.</span></span> <span data-ttu-id="1d4f8-210">Stejně jako všechny třídy nelze upravit veřejné rozhraní API bez rizika porušení změn.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-210">Like any class, you cannot modify the public API without the risk of breaking changes.</span></span> <span data-ttu-id="1d4f8-211">Ale protože spojení mezi protokolování a všechny výstupní motory je pouze prostřednictvím delegáta, žádné jiné typy (jako rozhraní nebo základní třídy) jsou zapojeny.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-211">But, because the coupling between the logger and any output engines is only through the delegate, no other types (like interfaces or base classes) are involved.</span></span> <span data-ttu-id="1d4f8-212">Spojka je co nejmenší.</span><span class="sxs-lookup"><span data-stu-id="1d4f8-212">The coupling is as small as possible.</span></span>

[<span data-ttu-id="1d4f8-213">Další</span><span class="sxs-lookup"><span data-stu-id="1d4f8-213">Next</span></span>](events-overview.md)
