---
title: Typy odkazů s možnou hodnotou Null – odkaz jazyka C#
description: Informace o typech odkazů s možnou hodnotou C# s možnou hodnotou null a jejich použití
ms.date: 04/06/2020
ms.openlocfilehash: cb61b162b06faa51faabbcdd91e55618cdeaca73
ms.sourcegitcommit: 73aa9653547a1cd70ee6586221f79cc29b588ebd
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/23/2020
ms.locfileid: "82102694"
---
# <a name="nullable-reference-types-c-reference"></a><span data-ttu-id="27bf7-103">Typy odkazů s možnou hodnotou Null (odkaz jazyka C#)</span><span class="sxs-lookup"><span data-stu-id="27bf7-103">Nullable reference types (C# reference)</span></span>

> [!NOTE]
> <span data-ttu-id="27bf7-104">Tento článek popisuje referenční typy s možnou hodnotou null.</span><span class="sxs-lookup"><span data-stu-id="27bf7-104">This article covers nullable reference types.</span></span> <span data-ttu-id="27bf7-105">Můžete také deklarovat [typy hodnot s možnou hodnotou.](nullable-value-types.md)</span><span class="sxs-lookup"><span data-stu-id="27bf7-105">You can also declare [nullable value types](nullable-value-types.md).</span></span>

<span data-ttu-id="27bf7-106">Nulllze typy odkazů jsou k dispozici počínaje C# 8.0, v kódu, který se přihlásil do *kontextu s platností null*.</span><span class="sxs-lookup"><span data-stu-id="27bf7-106">Nullable reference types are available beginning with C# 8.0, in code that has opted in to a *nullable aware context*.</span></span> <span data-ttu-id="27bf7-107">Typy odkazů s možnou hodnotou Null, upozornění na statickou analýzu null a [operátor odpouštějící nulu](../operators/null-forgiving.md) jsou volitelné funkce jazyka.</span><span class="sxs-lookup"><span data-stu-id="27bf7-107">Nullable reference types, the null static analysis warnings, and the [null-forgiving operator](../operators/null-forgiving.md) are optional language features.</span></span> <span data-ttu-id="27bf7-108">Všechny jsou ve výchozím nastavení vypnuty.</span><span class="sxs-lookup"><span data-stu-id="27bf7-108">All are turned off by default.</span></span> <span data-ttu-id="27bf7-109">Kontext *s možnou hodnotou null* je řízen na úrovni projektu pomocí nastavení sestavení nebo v kódu pomocí pragmas.</span><span class="sxs-lookup"><span data-stu-id="27bf7-109">A *nullable context* is controlled at the project level using build settings, or in code using pragmas.</span></span>

 <span data-ttu-id="27bf7-110">V kontextu s výhodami, které lze uznat s platností:</span><span class="sxs-lookup"><span data-stu-id="27bf7-110">In a nullable aware context:</span></span>

- <span data-ttu-id="27bf7-111">Proměnná typu `T` odkazu musí být inicializována s hodnotou non-null `null`a nesmí jí být nikdy přiřazena hodnota, která může být .</span><span class="sxs-lookup"><span data-stu-id="27bf7-111">A variable of a reference type `T` must be initialized with non-null, and may never be assigned a value that may be `null`.</span></span>
- <span data-ttu-id="27bf7-112">Proměnná referenčního `T?` typu může být `null` inicializována nebo `null`přiřazena `null` , ale musí být před zrušením odkazování zkontrolována.</span><span class="sxs-lookup"><span data-stu-id="27bf7-112">A variable of a reference type `T?` may be initialized with `null` or assigned `null`, but is required to be checked against `null` before de-referencing.</span></span>
- <span data-ttu-id="27bf7-113">Proměnná `m` typu `T?` je považována za non-null při použití operátoru null `m!`odpouštějící, jako v .</span><span class="sxs-lookup"><span data-stu-id="27bf7-113">A variable `m` of type `T?` is considered to be non-null when you apply the null-forgiving operator, as in `m!`.</span></span>

<span data-ttu-id="27bf7-114">Rozdíl mezi typ `T` odkazu s nemožnou hodnotou `T?` null a typ odkazu s možnou hodnotou null jsou vynuceny interpretací předchozích pravidel kompilátorem.</span><span class="sxs-lookup"><span data-stu-id="27bf7-114">The distinctions between a non-nullable reference type `T` and a nullable reference type `T?` are enforced by the compiler's interpretation of the preceding rules.</span></span> <span data-ttu-id="27bf7-115">Proměnná typu `T` a proměnná `T?` typu jsou reprezentovány stejným typem .NET.</span><span class="sxs-lookup"><span data-stu-id="27bf7-115">A variable of type `T` and a variable of type `T?` are represented by the same .NET type.</span></span> <span data-ttu-id="27bf7-116">Následující příklad deklaruje řetězec s nulovou hodnotou a řetězec s hodnotou null a poté použije operátor null-forgiving k přiřazení hodnoty řetězci, který nelze utajit s nulou:</span><span class="sxs-lookup"><span data-stu-id="27bf7-116">The following example declares a non-nullable string and a nullable string, and then uses the null-forgiving operator to assign a value to a non-nullable string:</span></span>

:::code language="csharp" source="snippets/NullableReferenceTypes.cs" id="SnippetCoreSyntax":::

<span data-ttu-id="27bf7-117">Proměnné `notNull` a `nullable` jsou reprezentovány <xref:System.String> typem.</span><span class="sxs-lookup"><span data-stu-id="27bf7-117">The variables `notNull` and `nullable` are both represented by the <xref:System.String> type.</span></span> <span data-ttu-id="27bf7-118">Vzhledem k tomu, že typy s možnou hodnotou null a null lze uložit jako stejný typ, existuje několik umístění, kde není povoleno použití typu odkazu s možnou hodnotou null.</span><span class="sxs-lookup"><span data-stu-id="27bf7-118">Because the non-nullable and nullable types are both stored as the same type, there are several locations where using a nullable reference type isn't allowed.</span></span> <span data-ttu-id="27bf7-119">Obecně platí, že typ odkazu s možnou hodnotou null nelze použít jako základní třídu nebo implementované rozhraní.</span><span class="sxs-lookup"><span data-stu-id="27bf7-119">In general, a nullable reference type can't be used as a base class or implemented interface.</span></span> <span data-ttu-id="27bf7-120">Typ odkazu s možnou hodnotou null nelze použít při žádném výrazu pro vytváření objektů nebo testování typu.</span><span class="sxs-lookup"><span data-stu-id="27bf7-120">A nullable reference type can't be used in any object creation or type testing expression.</span></span> <span data-ttu-id="27bf7-121">Typ odkazu s možnou hodnotou null nemůže být typem výrazu přístupu člena.</span><span class="sxs-lookup"><span data-stu-id="27bf7-121">A nullable reference type can't be the type of a member access expression.</span></span> <span data-ttu-id="27bf7-122">Následující příklady ukazují tyto konstrukce:</span><span class="sxs-lookup"><span data-stu-id="27bf7-122">The following examples show these constructs:</span></span>

```csharp
public MyClass : System.Object? // not allowed
{
}

var nullEmpty = System.String?.Empty; // Not allowed
var maybeObject = new object?(); // Not allowed
try
{
    if (thing is string? nullableString) // not allowed
        Console.WriteLine(nullableString);
} catch (Exception? e) // Not Allowed
{
    Console.WriteLine("error");
}
```

## <a name="nullable-references-and-static-analysis"></a><span data-ttu-id="27bf7-123">Odkazy s možnou hodnotou null a statická analýza</span><span class="sxs-lookup"><span data-stu-id="27bf7-123">Nullable references and static analysis</span></span>

<span data-ttu-id="27bf7-124">Příklady v předchozí části ilustrují povahu typů odkazů s možnou hodnotou null.</span><span class="sxs-lookup"><span data-stu-id="27bf7-124">The examples in the previous section illustrate the nature of nullable reference types.</span></span> <span data-ttu-id="27bf7-125">Typy odkazů s možnou hodnotou Null nejsou nové typy tříd, ale spíše poznámky na existující chod odkazů.</span><span class="sxs-lookup"><span data-stu-id="27bf7-125">Nullable reference types aren't new class types, but rather annotations on existing reference types.</span></span> <span data-ttu-id="27bf7-126">Kompilátor používá tyto poznámky, které vám pomohou najít potenciální chyby odkazu null ve vašem kódu.</span><span class="sxs-lookup"><span data-stu-id="27bf7-126">The compiler uses those annotations to help you find potential null reference errors in your code.</span></span> <span data-ttu-id="27bf7-127">Neexistuje žádný rozdíl za běhu mezi typ odkazu s hodnotou nes holých hodnot a typ odkazu s možnou hodnotou null.</span><span class="sxs-lookup"><span data-stu-id="27bf7-127">There's no runtime difference between a non-nullable reference type and a nullable reference type.</span></span> <span data-ttu-id="27bf7-128">Kompilátor nepřidá žádnou kontrolu za běhu pro typy odkazů s nulou.</span><span class="sxs-lookup"><span data-stu-id="27bf7-128">The compiler doesn't add any runtime checking for non-nullable reference types.</span></span> <span data-ttu-id="27bf7-129">Výhody jsou v analýze kompilace.</span><span class="sxs-lookup"><span data-stu-id="27bf7-129">The benefits are in the compile-time analysis.</span></span> <span data-ttu-id="27bf7-130">Kompilátor generuje upozornění, která vám pomohou najít a opravit potenciální chyby null ve vašem kódu.</span><span class="sxs-lookup"><span data-stu-id="27bf7-130">The compiler generates warnings that help you find and fix potential null errors in your code.</span></span> <span data-ttu-id="27bf7-131">Deklarujete svůj záměr a kompilátor vás upozorní, když váš kód tento záměr poruší.</span><span class="sxs-lookup"><span data-stu-id="27bf7-131">You declare your intent, and the compiler warns you when your code violates that intent.</span></span>

<span data-ttu-id="27bf7-132">V kontextu s povolenou hodnotou null kompilátor provádí statickou analýzu proměnných libovolného typu odkazu, a to jak s hodnotou null, tak s hodnotou null.</span><span class="sxs-lookup"><span data-stu-id="27bf7-132">In a nullable enabled context, the compiler performs static analysis on variables of any reference type, both nullable and non-nullable.</span></span> <span data-ttu-id="27bf7-133">Kompilátor sleduje stav null každé referenční proměnné jako *buď není null* nebo možná *null*.</span><span class="sxs-lookup"><span data-stu-id="27bf7-133">The compiler tracks the null state of each reference variable as either *not null* or *maybe null*.</span></span> <span data-ttu-id="27bf7-134">Výchozí stav odkazu, který nelze utnou ta nulu, *nemá hodnotu null*.</span><span class="sxs-lookup"><span data-stu-id="27bf7-134">The default state of a non-nullable reference is *not null*.</span></span> <span data-ttu-id="27bf7-135">Výchozí stav odkazu s možnou hodnotou null je *pravděpodobně null*.</span><span class="sxs-lookup"><span data-stu-id="27bf7-135">The default state of a nullable reference is *maybe null*.</span></span>

<span data-ttu-id="27bf7-136">Nenulové typy odkazů by měly být vždy bezpečné pro zrušení odkazu, protože jejich stav null *není null*.</span><span class="sxs-lookup"><span data-stu-id="27bf7-136">Non-nullable reference types should always be safe to dereference because their null state is *not null*.</span></span> <span data-ttu-id="27bf7-137">Chcete-li vynutit toto pravidlo, kompilátor vydá upozornění, pokud typ odkazu, který nelze uvážit, není inicializován na hodnotu bez null.</span><span class="sxs-lookup"><span data-stu-id="27bf7-137">To enforce that rule, the compiler issues warnings if a non-nullable reference type isn't initialized to a non-null value.</span></span> <span data-ttu-id="27bf7-138">Místní proměnné musí být přiřazeny tam, kde jsou deklarovány.</span><span class="sxs-lookup"><span data-stu-id="27bf7-138">Local variables must be assigned where they're declared.</span></span> <span data-ttu-id="27bf7-139">Každý konstruktor musí přiřadit každé pole, buď v jeho těle, volaný konstruktor, nebo pomocí inicializátoru pole.</span><span class="sxs-lookup"><span data-stu-id="27bf7-139">Every constructor must assign every field, either in its body, a called constructor, or using a field initializer.</span></span> <span data-ttu-id="27bf7-140">Kompilátor vydává upozornění, pokud je odkaz s nulovou hodnotou přiřazen k odkazu, jehož stav je *možná null*.</span><span class="sxs-lookup"><span data-stu-id="27bf7-140">The compiler issues warnings if a non-nullable reference is assigned to a reference whose state is *maybe null*.</span></span> <span data-ttu-id="27bf7-141">Však vzhledem k tomu, že odkaz, který nelze hodnotit hodnotu null, *není null*, nejsou vydána žádná upozornění, pokud jsou tyto proměnné de-referenced.</span><span class="sxs-lookup"><span data-stu-id="27bf7-141">However, because a non-nullable reference is *not null*, no warnings are issued when those variables are de-referenced.</span></span>

<span data-ttu-id="27bf7-142">Typy odkazů s možnou hodnotou `null`Null mohou být inicializovány nebo přiřazeny .</span><span class="sxs-lookup"><span data-stu-id="27bf7-142">Nullable reference types may be initialized or assigned to `null`.</span></span> <span data-ttu-id="27bf7-143">Proto musí statická analýza určit, že proměnná *není null* před je odkazován.</span><span class="sxs-lookup"><span data-stu-id="27bf7-143">Therefore, static analysis must determine that a variable is *not null* before it's dereferenced.</span></span> <span data-ttu-id="27bf7-144">Pokud je odkaz s možnou hodnotou null určen *jako pravděpodobně null*, nelze jej přiřadit k referenční proměnné, na které nelze stanovit hodnotu null.</span><span class="sxs-lookup"><span data-stu-id="27bf7-144">If a nullable reference is determined to be *maybe null*, it can't be assigned to a non-nullable reference variable.</span></span> <span data-ttu-id="27bf7-145">Následující třída ukazuje příklady těchto upozornění:</span><span class="sxs-lookup"><span data-stu-id="27bf7-145">The following class shows examples of these warnings:</span></span>

:::code language="csharp" source="snippets/NullableReferenceTypes.cs" id="SnippetClassWithNullable":::

<span data-ttu-id="27bf7-146">Následující úryvek ukazuje, kde kompilátor vydává upozornění při použití této třídy:</span><span class="sxs-lookup"><span data-stu-id="27bf7-146">The following snippet shows where the compiler emits warnings when using this class:</span></span>

:::code language="csharp" source="snippets/NullableReferenceTypes.cs" id="SnippetLocalWarnings":::

<span data-ttu-id="27bf7-147">Předchozí příklady ukazují statické analýzy kompilátoru k určení nulového stavu referenčních proměnných.</span><span class="sxs-lookup"><span data-stu-id="27bf7-147">The preceding examples demonstrate the compiler's static analysis to determine the null state of reference variables.</span></span> <span data-ttu-id="27bf7-148">Kompilátor použije jazyková pravidla pro nulové kontroly a přiřazení, aby informoval svou analýzu.</span><span class="sxs-lookup"><span data-stu-id="27bf7-148">The compiler applies language rules for null checks and assignments to inform its analysis.</span></span>  <span data-ttu-id="27bf7-149">Kompilátor nemůže dělat předpoklady o sémantiku metod nebo vlastností.</span><span class="sxs-lookup"><span data-stu-id="27bf7-149">The compiler can't make assumptions about the semantics of methods or properties.</span></span> <span data-ttu-id="27bf7-150">Pokud voláte metody, které provádějí nulové kontroly, kompilátor nemůže vědět, tyto metody ovlivňují stav null proměnné.</span><span class="sxs-lookup"><span data-stu-id="27bf7-150">If you call methods that perform null checks, the compiler can't know those methods affect a variable's null state.</span></span> <span data-ttu-id="27bf7-151">Existuje několik atributů, které můžete přidat do svých api informovat kompilátor o sémantiku argumentů a vrácené hodnoty.</span><span class="sxs-lookup"><span data-stu-id="27bf7-151">There are a number of attributes you can add to your APIs to inform the compiler about the semantics of arguments and return values.</span></span> <span data-ttu-id="27bf7-152">Tyto atributy byly použity pro mnoho běžných rozhraní API v knihovnách .NET Core.</span><span class="sxs-lookup"><span data-stu-id="27bf7-152">These attributes have been applied to many common APIs in the .NET Core libraries.</span></span> <span data-ttu-id="27bf7-153">Například <xref:System.String.IsNullOrEmpty%2A> byla aktualizována a kompilátor správně interpretuje tuto metodu jako kontrolu null.</span><span class="sxs-lookup"><span data-stu-id="27bf7-153">For example, <xref:System.String.IsNullOrEmpty%2A> has been updated, and the compiler correctly interprets that method as a null check.</span></span> <span data-ttu-id="27bf7-154">Další informace o atributech, které platí pro statickou analýzu nulového stavu, naleznete v článku [atributů Nullable](../attributes/nullable-analysis.md).</span><span class="sxs-lookup"><span data-stu-id="27bf7-154">For more information about the attributes that apply to null state static analysis, see the article on [Nullable attributes](../attributes/nullable-analysis.md).</span></span>

## <a name="setting-the-nullable-context"></a><span data-ttu-id="27bf7-155">Nastavení kontextu s možnou hodnotou null</span><span class="sxs-lookup"><span data-stu-id="27bf7-155">Setting the nullable context</span></span>

<span data-ttu-id="27bf7-156">Existují dva způsoby, jak řídit kontext s možnou hodnotou null.</span><span class="sxs-lookup"><span data-stu-id="27bf7-156">There are two ways to control the nullable context.</span></span> <span data-ttu-id="27bf7-157">Na úrovni projektu můžete přidat `<Nullable>enable</Nullable>` nastavení projektu.</span><span class="sxs-lookup"><span data-stu-id="27bf7-157">At the project level, you can add the `<Nullable>enable</Nullable>` project setting.</span></span> <span data-ttu-id="27bf7-158">Ve zdrojovém souboru C# `#nullable enable` můžete přidat pragma povolit kontext s možnou hodnotou null.</span><span class="sxs-lookup"><span data-stu-id="27bf7-158">In a single C# source file, you can add the `#nullable enable` pragma to enable the nullable context.</span></span> <span data-ttu-id="27bf7-159">Viz článek o [nastavení strategie s možnou hodnotou null](../../nullable-migration-strategies.md).</span><span class="sxs-lookup"><span data-stu-id="27bf7-159">See the article on [setting a nullable strategy](../../nullable-migration-strategies.md).</span></span>

## <a name="c-language-specification"></a><span data-ttu-id="27bf7-160">specifikace jazyka C#</span><span class="sxs-lookup"><span data-stu-id="27bf7-160">C# language specification</span></span>

<span data-ttu-id="27bf7-161">Další informace naleznete v následujících návrzích [specifikace jazyka C#](~/_csharplang/spec/introduction.md):</span><span class="sxs-lookup"><span data-stu-id="27bf7-161">For more information, see the following proposals for the [C# language specification](~/_csharplang/spec/introduction.md):</span></span>

- [<span data-ttu-id="27bf7-162">Odkazové typy s možnou hodnotou null</span><span class="sxs-lookup"><span data-stu-id="27bf7-162">Nullable reference types</span></span>](~/_csharplang/proposals/csharp-8.0/nullable-reference-types.md)
- [<span data-ttu-id="27bf7-163">Návrh specifikace referenčních typů s možnou hodnotou null</span><span class="sxs-lookup"><span data-stu-id="27bf7-163">Draft nullable reference types specification</span></span>](~/_csharplang/proposals/csharp-8.0/nullable-reference-types-specification.md)

## <a name="see-also"></a><span data-ttu-id="27bf7-164">Viz také</span><span class="sxs-lookup"><span data-stu-id="27bf7-164">See also</span></span>

- [<span data-ttu-id="27bf7-165">Referenční dokumentace k jazyku C#</span><span class="sxs-lookup"><span data-stu-id="27bf7-165">C# reference</span></span>](../index.md)
- [<span data-ttu-id="27bf7-166">Typy hodnot s povolenou hodnotou Null</span><span class="sxs-lookup"><span data-stu-id="27bf7-166">Nullable value types</span></span>](nullable-value-types.md)
