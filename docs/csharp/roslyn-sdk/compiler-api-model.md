---
title: .NET Compiler Platform koncepty a objektový model sady SDK
description: Tento přehled poskytuje pozadí, které potřebujete pro efektivní práci se sadou .NET Compiler SDK. Naučíte se vrstvy rozhraní API, hlavní typy a celkový objektový model.
ms.date: 10/10/2017
ms.custom: mvc
ms.openlocfilehash: 529ce6fbdef22964251c8b22abbd5d8aadab633d
ms.sourcegitcommit: fff146ba3fd1762c8c432d95c8b877825ae536fc
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/08/2020
ms.locfileid: "82975937"
---
# <a name="understand-the-net-compiler-platform-sdk-model"></a><span data-ttu-id="b1f00-104">Principy modelu .NET Compiler Platform SDK</span><span class="sxs-lookup"><span data-stu-id="b1f00-104">Understand the .NET Compiler Platform SDK model</span></span>

<span data-ttu-id="b1f00-105">Kompilátory zpracovávají kód, který zapisujete po strukturovaných pravidel, která se často liší od způsobu, jakým člověk čte a pochopit kód.</span><span class="sxs-lookup"><span data-stu-id="b1f00-105">Compilers process the code you write following structured rules that often differ from the way humans read and understand code.</span></span> <span data-ttu-id="b1f00-106">Základní porozumění modelu používanému kompilátory je zásadní pro porozumění rozhraním API, která používáte při vytváření nástrojů založených na Roslyn.</span><span class="sxs-lookup"><span data-stu-id="b1f00-106">A basic understanding of the model used by compilers is essential to understanding the APIs you use when building Roslyn-based tools.</span></span>

## <a name="compiler-pipeline-functional-areas"></a><span data-ttu-id="b1f00-107">Funkční oblasti kanálu kompilátoru</span><span class="sxs-lookup"><span data-stu-id="b1f00-107">Compiler pipeline functional areas</span></span>

<span data-ttu-id="b1f00-108">Sada .NET Compiler Platform SDK zpřístupňuje analýzu kódu C# a Visual Basic kompilátorů jako příjemce tím, že poskytuje vrstvu rozhraní API, která zrcadlí tradiční kanál kompilátoru.</span><span class="sxs-lookup"><span data-stu-id="b1f00-108">The .NET Compiler Platform SDK exposes the C# and Visual Basic compilers' code analysis to you as a consumer by providing an API layer that mirrors a traditional compiler pipeline.</span></span>

![kroky zdrojového kódu zpracování kanálu kompilátoru do kódu objektu](media/compiler-api-model/compiler-pipeline.png)

<span data-ttu-id="b1f00-110">Každá fáze tohoto kanálu je samostatná součást.</span><span class="sxs-lookup"><span data-stu-id="b1f00-110">Each phase of this pipeline is a separate component.</span></span> <span data-ttu-id="b1f00-111">Nejprve fáze analýzy tokenizes a analyzuje zdrojový text do syntaxe, která následuje po jazykové gramatice.</span><span class="sxs-lookup"><span data-stu-id="b1f00-111">First, the parse phase tokenizes and parses source text into syntax that follows the language grammar.</span></span> <span data-ttu-id="b1f00-112">V druhé fázi deklarace analyzuje zdrojová a importovaná metadata do formuláře s pojmenovanými symboly.</span><span class="sxs-lookup"><span data-stu-id="b1f00-112">Second, the declaration phase analyzes source and imported metadata to form named symbols.</span></span> <span data-ttu-id="b1f00-113">Dále fáze vazby porovná identifikátory v kódu ke symbolům.</span><span class="sxs-lookup"><span data-stu-id="b1f00-113">Next, the bind phase matches identifiers in the code to symbols.</span></span> <span data-ttu-id="b1f00-114">Nakonec fáze generování generuje sestavení se všemi informacemi sestavenými kompilátorem.</span><span class="sxs-lookup"><span data-stu-id="b1f00-114">Finally, the emit phase emits an assembly with all the information built up by the compiler.</span></span>

![rozhraní API kanálu kompilátoru poskytuje přístup k jednotlivým krokům, které jsou součástí kanálu kompilátoru.](media/compiler-api-model/compiler-pipeline-api.png)

<span data-ttu-id="b1f00-116">V rámci každé z těchto fází sada SDK .NET Compiler Platform zpřístupňuje objektový model, který umožňuje přístup k informacím v této fázi.</span><span class="sxs-lookup"><span data-stu-id="b1f00-116">Corresponding to each of those phases, the .NET Compiler Platform SDK exposes an object model that allows access to the information at that phase.</span></span> <span data-ttu-id="b1f00-117">Fáze analýzy zveřejňuje strom syntaxe, fáze deklarace zveřejňuje hierarchickou tabulku symbolů. fáze vazby zpřístupňuje výsledek sémantické analýzy kompilátoru a fáze generování je rozhraní API, které vytváří bajtové kódy IL.</span><span class="sxs-lookup"><span data-stu-id="b1f00-117">The parsing phase exposes a syntax tree, the declaration phase exposes a hierarchical symbol table, the binding phase exposes the result of the compiler’s semantic analysis, and the emit phase is an API that produces IL byte codes.</span></span>

![jazykové služby, které jsou dostupné z rozhraní API kompilátoru v každém kroku kanálu kompilátoru](media/compiler-api-model/compiler-pipeline-lang-svc.png)

<span data-ttu-id="b1f00-119">Každý kompilátor kombinuje tyto komponenty dohromady jako jeden celý celek.</span><span class="sxs-lookup"><span data-stu-id="b1f00-119">Each compiler combines these components together as a single end-to-end whole.</span></span>

<span data-ttu-id="b1f00-120">Tato rozhraní API jsou stejná jako ta, která používá aplikace Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="b1f00-120">These APIs are the same ones used by Visual Studio.</span></span> <span data-ttu-id="b1f00-121">Například funkce navigace v kódu a formátování používají stromy syntaxe, Prohlížeč objektů a navigační funkce používají tabulku symbolů, refaktoringy, přejít k definici používá sémantický model a příkaz Upravit a pokračovat používá všechny z nich, včetně rozhraní Emit API.</span><span class="sxs-lookup"><span data-stu-id="b1f00-121">For instance, the code outlining and formatting features use the syntax trees, the Object Browser and navigation features use the symbol table, refactorings and Go to Definition use the semantic model, and Edit and Continue uses all of these, including the Emit API.</span></span>

## <a name="api-layers"></a><span data-ttu-id="b1f00-122">Vrstvy API</span><span class="sxs-lookup"><span data-stu-id="b1f00-122">API layers</span></span>

<span data-ttu-id="b1f00-123">Sada SDK kompilátoru .NET se skládá ze dvou hlavních vrstev rozhraní API: rozhraní API pro kompilátor a rozhraní API pracovních prostorů.</span><span class="sxs-lookup"><span data-stu-id="b1f00-123">The .NET compiler SDK consists of two main layers of APIs: compiler APIs and workspaces APIs.</span></span>

![vrstvy rozhraní API reprezentované rozhraními API kanálu kompilátoru](media/compiler-api-model/api-layers.png)

### <a name="compiler-apis"></a><span data-ttu-id="b1f00-125">Rozhraní API kompilátoru</span><span class="sxs-lookup"><span data-stu-id="b1f00-125">Compiler APIs</span></span>

<span data-ttu-id="b1f00-126">Vrstva kompilátoru obsahuje objektové modely, které odpovídají informacím zveřejněným v každé fázi kanálu kompilátoru, syntaktické i sémantické.</span><span class="sxs-lookup"><span data-stu-id="b1f00-126">The compiler layer contains the object models that correspond to information exposed at each phase of the compiler pipeline, both syntactic and semantic.</span></span> <span data-ttu-id="b1f00-127">Vrstva kompilátoru obsahuje také neproměnlivý snímek jediného vyvolání kompilátoru, včetně odkazů na sestavení, možností kompilátoru a souborů zdrojového kódu.</span><span class="sxs-lookup"><span data-stu-id="b1f00-127">The compiler layer also contains an immutable snapshot of a single invocation of a compiler, including assembly references, compiler options, and source code files.</span></span> <span data-ttu-id="b1f00-128">K dispozici jsou dvě odlišná rozhraní API, která představují jazyk C# a jazyk Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="b1f00-128">There are two distinct APIs that represent the C# language and the Visual Basic language.</span></span> <span data-ttu-id="b1f00-129">Tato dvě rozhraní API jsou podobná v tvarování, ale jsou upraveny pro vysokou věrnost pro každý jednotlivý jazyk.</span><span class="sxs-lookup"><span data-stu-id="b1f00-129">These two APIs are similar in shape but tailored for high-fidelity to each individual language.</span></span> <span data-ttu-id="b1f00-130">Tato vrstva nemá žádné závislosti na komponentách sady Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="b1f00-130">This layer has no dependencies on Visual Studio components.</span></span>

### <a name="diagnostic-apis"></a><span data-ttu-id="b1f00-131">Rozhraní API pro diagnostiku</span><span class="sxs-lookup"><span data-stu-id="b1f00-131">Diagnostic APIs</span></span>

<span data-ttu-id="b1f00-132">V rámci analýzy může kompilátor vytvořit sadu diagnostiky, která pokrývá vše od syntaxe, sémantické a omezené Chyby přiřazení k různým upozorněním a informativní diagnostice.</span><span class="sxs-lookup"><span data-stu-id="b1f00-132">As part of its analysis the compiler may produce a set of diagnostics covering everything from syntax, semantic, and definite assignment errors to various warnings and informational diagnostics.</span></span> <span data-ttu-id="b1f00-133">Vrstva rozhraní API kompilátoru zpřístupňuje diagnostiku prostřednictvím rozšiřitelného rozhraní API, které umožňuje připojit uživatelsky definované analyzátory do procesu kompilace.</span><span class="sxs-lookup"><span data-stu-id="b1f00-133">The Compiler API layer exposes diagnostics through an extensible API that allows user-defined analyzers to be plugged into the compilation process.</span></span> <span data-ttu-id="b1f00-134">Umožňuje vytvářet uživatelsky definované diagnostiky, jako jsou ty, které vytvořily nástroje jako StyleCop nebo FxCop, a to společně s diagnostikou definovanou kompilátorem.</span><span class="sxs-lookup"><span data-stu-id="b1f00-134">It allows user-defined diagnostics, such as those produced by tools like StyleCop or FxCop, to be produced alongside compiler-defined diagnostics.</span></span> <span data-ttu-id="b1f00-135">Vytváření diagnostiky tímto způsobem má za následek integraci přirozeně s nástroji, jako je MSBuild a Visual Studio, které závisí na diagnostice pro prostředí, jako je například zastavení sestavení založeného na zásadách a zobrazení živých vlnovek v editoru a návrh oprav kódu.</span><span class="sxs-lookup"><span data-stu-id="b1f00-135">Producing diagnostics in this way has the benefit of integrating naturally with tools such as MSBuild and Visual Studio which depend on diagnostics for experiences such as halting a build based on policy and showing live squiggles in the editor and suggesting code fixes.</span></span>

### <a name="scripting-apis"></a><span data-ttu-id="b1f00-136">Rozhraní API pro skriptování</span><span class="sxs-lookup"><span data-stu-id="b1f00-136">Scripting APIs</span></span>

<span data-ttu-id="b1f00-137">Rozhraní API pro hostování a skriptování jsou součástí vrstvy kompilátoru.</span><span class="sxs-lookup"><span data-stu-id="b1f00-137">Hosting and scripting APIs are part of the compiler layer.</span></span> <span data-ttu-id="b1f00-138">Můžete je použít pro spouštění fragmentů kódu a nahromadění kontextu spuštění modulu runtime.</span><span class="sxs-lookup"><span data-stu-id="b1f00-138">You can use them for executing code snippets and accumulating a runtime execution context.</span></span>
<span data-ttu-id="b1f00-139">Tato rozhraní API používají interaktivní REPL C# (čtení-vyhodnocení-tisk smyčky).</span><span class="sxs-lookup"><span data-stu-id="b1f00-139">The C# interactive REPL (Read-Evaluate-Print Loop) uses these APIs.</span></span> <span data-ttu-id="b1f00-140">REPL umožňuje používat C# jako skriptovací jazyk a při psaní kódu interaktivně spouštět kód.</span><span class="sxs-lookup"><span data-stu-id="b1f00-140">The REPL enables you to use C# as a scripting language, executing the code interactively as you write it.</span></span>

### <a name="workspaces-apis"></a><span data-ttu-id="b1f00-141">Rozhraní API pracovních prostorů</span><span class="sxs-lookup"><span data-stu-id="b1f00-141">Workspaces APIs</span></span>

<span data-ttu-id="b1f00-142">Vrstva pracovní prostory obsahuje rozhraní API pracovního prostoru, což je výchozí bod pro analýzu kódu a refaktoring přes celá řešení.</span><span class="sxs-lookup"><span data-stu-id="b1f00-142">The Workspaces layer contains the Workspace API, which is the starting point for doing code analysis and refactoring over entire solutions.</span></span> <span data-ttu-id="b1f00-143">Pomáhá vám při organizování všech informací o projektech v řešení do jediného objektového modelu a nabízí vám přímý přístup k modelům objektů vrstvy kompilátoru bez nutnosti analyzovat soubory, konfigurovat možnosti nebo spravovat závislosti mezi projekty.</span><span class="sxs-lookup"><span data-stu-id="b1f00-143">It assists you in organizing all the information about the projects in a solution into a single object model, offering you direct access to the compiler layer object models without needing to parse files, configure options, or manage project-to-project dependencies.</span></span>

<span data-ttu-id="b1f00-144">Kromě toho pracovní prostory rozsvítí sadu rozhraní API, která se používají při implementaci nástroje pro analýzu kódu a nástroje refaktoringu, které fungují v hostitelském prostředí, jako je například integrované vývojové prostředí (IDE) sady Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="b1f00-144">In addition, the Workspaces layer surfaces a set of APIs used when implementing code analysis and refactoring tools that function within a host environment like the Visual Studio IDE.</span></span> <span data-ttu-id="b1f00-145">Příklady zahrnují rozhraní API najít všechny odkazy, formátování a generování kódu.</span><span class="sxs-lookup"><span data-stu-id="b1f00-145">Examples include the Find All References, Formatting, and Code Generation APIs.</span></span>

<span data-ttu-id="b1f00-146">Tato vrstva nemá žádné závislosti na komponentách sady Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="b1f00-146">This layer has no dependencies on Visual Studio components.</span></span>
