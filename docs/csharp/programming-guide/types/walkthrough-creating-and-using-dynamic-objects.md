---
title: 'Návod: Vytváření a používání dynamických objektů (C# a Visual Basic)'
description: Naučte se vytvářet a používat dynamické objekty v tomto návodu. Vytvořte vlastní dynamický objekt a projekt, který používá knihovnu ' Ironpythonu '.
ms.date: 07/20/2015
dev_langs:
- csharp
- vb
helpviewer_keywords:
- dynamic objects [Visual Basic]
- dynamic objects
- dynamic objects [C#]
ms.assetid: 568f1645-1305-4906-8625-5d77af81e04f
ms.openlocfilehash: 144651d3b14f6f6093ab07f1df7be10e6d05ae89
ms.sourcegitcommit: 552b4b60c094559db9d8178fa74f5bafaece0caf
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/29/2020
ms.locfileid: "87381252"
---
# <a name="walkthrough-creating-and-using-dynamic-objects-c-and-visual-basic"></a><span data-ttu-id="35928-104">Návod: Vytváření a používání dynamických objektů (C# a Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="35928-104">Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)</span></span>

<span data-ttu-id="35928-105">Dynamické objekty zveřejňují členy, jako jsou vlastnosti a metody v době běhu, místo v době kompilace.</span><span class="sxs-lookup"><span data-stu-id="35928-105">Dynamic objects expose members such as properties and methods at run time, instead of at compile time.</span></span> <span data-ttu-id="35928-106">To umožňuje vytvářet objekty pro práci se strukturami, které neodpovídají statickému typu nebo formátu.</span><span class="sxs-lookup"><span data-stu-id="35928-106">This enables you to create objects to work with structures that do not match a static type or format.</span></span> <span data-ttu-id="35928-107">Například můžete použít dynamický objekt pro odkaz na model DOM (Document Object Model) HTML (DOM), který může obsahovat libovolnou kombinaci platných elementů a atributů HTML značek.</span><span class="sxs-lookup"><span data-stu-id="35928-107">For example, you can use a dynamic object to reference the HTML Document Object Model (DOM), which can contain any combination of valid HTML markup elements and attributes.</span></span> <span data-ttu-id="35928-108">Vzhledem k tomu, že každý dokument HTML je jedinečný, jsou členy pro konkrétní dokument HTML určeny za běhu.</span><span class="sxs-lookup"><span data-stu-id="35928-108">Because each HTML document is unique, the members for a particular HTML document are determined at run time.</span></span> <span data-ttu-id="35928-109">Společná metoda, která odkazuje na atribut prvku jazyka HTML, je předání názvu atributu `GetProperty` metodě elementu.</span><span class="sxs-lookup"><span data-stu-id="35928-109">A common method to reference an attribute of an HTML element is to pass the name of the attribute to the `GetProperty` method of the element.</span></span> <span data-ttu-id="35928-110">Chcete-li odkazovat na `id` atribut elementu HTML `<div id="Div1">` , nejprve získejte odkaz na `<div>` prvek a pak použijte `divElement.GetProperty("id")` .</span><span class="sxs-lookup"><span data-stu-id="35928-110">To reference the `id` attribute of the HTML element `<div id="Div1">`, you first obtain a reference to the `<div>` element, and then use `divElement.GetProperty("id")`.</span></span> <span data-ttu-id="35928-111">Použijete-li dynamický objekt, můžete odkazovat na `id` atribut jako `divElement.id` .</span><span class="sxs-lookup"><span data-stu-id="35928-111">If you use a dynamic object, you can reference the `id` attribute as `divElement.id`.</span></span>  
  
 <span data-ttu-id="35928-112">Dynamické objekty také poskytují pohodlný přístup k dynamickým jazykům, jako jsou Ironpythonu a IronRuby.</span><span class="sxs-lookup"><span data-stu-id="35928-112">Dynamic objects also provide convenient access to dynamic languages such as IronPython and IronRuby.</span></span> <span data-ttu-id="35928-113">Můžete použít dynamický objekt pro odkazování na dynamický skript, který je interpretován v době běhu.</span><span class="sxs-lookup"><span data-stu-id="35928-113">You can use a dynamic object to refer to a dynamic script that is interpreted at run time.</span></span>  
  
 <span data-ttu-id="35928-114">Můžete odkazovat na dynamický objekt pomocí pozdní vazby.</span><span class="sxs-lookup"><span data-stu-id="35928-114">You reference a dynamic object by using late binding.</span></span> <span data-ttu-id="35928-115">V jazyce C# určíte typ objektu s pozdní vazbou jako `dynamic` .</span><span class="sxs-lookup"><span data-stu-id="35928-115">In C#, you specify the type of a late-bound object as `dynamic`.</span></span> <span data-ttu-id="35928-116">V Visual Basic zadáte typ pozdní vázaného objektu jako `Object` .</span><span class="sxs-lookup"><span data-stu-id="35928-116">In Visual Basic, you specify the type of a late-bound object as `Object`.</span></span> <span data-ttu-id="35928-117">Další informace najdete v tématu [Dynamická](../../language-reference/builtin-types/reference-types.md) a [časná a pozdní vazba](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span><span class="sxs-lookup"><span data-stu-id="35928-117">For more information, see [dynamic](../../language-reference/builtin-types/reference-types.md) and [Early and Late Binding](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span></span>  
  
 <span data-ttu-id="35928-118">Vlastní dynamické objekty lze vytvořit pomocí tříd v <xref:System.Dynamic?displayProperty=nameWithType> oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="35928-118">You can create custom dynamic objects by using the classes in the <xref:System.Dynamic?displayProperty=nameWithType> namespace.</span></span> <span data-ttu-id="35928-119">Můžete například vytvořit <xref:System.Dynamic.ExpandoObject> a zadat členy daného objektu v době běhu.</span><span class="sxs-lookup"><span data-stu-id="35928-119">For example, you can create an <xref:System.Dynamic.ExpandoObject> and specify the members of that object at run time.</span></span> <span data-ttu-id="35928-120">Můžete také vytvořit vlastní typ, který dědí <xref:System.Dynamic.DynamicObject> třídu.</span><span class="sxs-lookup"><span data-stu-id="35928-120">You can also create your own type that inherits the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="35928-121">Pak můžete přepsat členy <xref:System.Dynamic.DynamicObject> třídy, aby poskytovaly dynamické funkce modulu runtime.</span><span class="sxs-lookup"><span data-stu-id="35928-121">You can then override the members of the <xref:System.Dynamic.DynamicObject> class to provide run-time dynamic functionality.</span></span>  
  
 <span data-ttu-id="35928-122">V tomto návodu budete provádět následující úlohy:</span><span class="sxs-lookup"><span data-stu-id="35928-122">In this walkthrough you will perform the following tasks:</span></span>  
  
- <span data-ttu-id="35928-123">Vytvořte vlastní objekt, který dynamicky zveřejňuje obsah textového souboru jako vlastnosti objektu.</span><span class="sxs-lookup"><span data-stu-id="35928-123">Create a custom object that dynamically exposes the contents of a text file as properties of an object.</span></span>  
  
- <span data-ttu-id="35928-124">Vytvořte projekt, který používá `IronPython` knihovnu.</span><span class="sxs-lookup"><span data-stu-id="35928-124">Create a project that uses an `IronPython` library.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="35928-125">Předpoklady</span><span class="sxs-lookup"><span data-stu-id="35928-125">Prerequisites</span></span>  

<span data-ttu-id="35928-126">K dokončení tohoto Názorného postupu potřebujete [ironpythonu](https://ironpython.net/) pro .NET.</span><span class="sxs-lookup"><span data-stu-id="35928-126">You need [IronPython](https://ironpython.net/) for .NET to complete this walkthrough.</span></span> <span data-ttu-id="35928-127">Nejnovější verzi získáte tak, že přejdete na [stránku pro stažení](https://ironpython.net/download/) .</span><span class="sxs-lookup"><span data-stu-id="35928-127">Go to their [Download page](https://ironpython.net/download/) to obtain the latest version.</span></span>
  
[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  
  
## <a name="creating-a-custom-dynamic-object"></a><span data-ttu-id="35928-128">Vytvoření vlastního dynamického objektu</span><span class="sxs-lookup"><span data-stu-id="35928-128">Creating a Custom Dynamic Object</span></span>

<span data-ttu-id="35928-129">První projekt, který vytvoříte v tomto návodu, definuje vlastní dynamický objekt, který vyhledá obsah textového souboru.</span><span class="sxs-lookup"><span data-stu-id="35928-129">The first project that you create in this walkthrough defines a custom dynamic object that searches the contents of a text file.</span></span> <span data-ttu-id="35928-130">Text, který se má hledat, je určený názvem dynamické vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="35928-130">Text to search for is specified by the name of a dynamic property.</span></span> <span data-ttu-id="35928-131">Například pokud volání Určuje kód `dynamicFile.Sample` , dynamická třída vrátí obecný seznam řetězců, které obsahují všechny řádky ze souboru, který začíná "Sample".</span><span class="sxs-lookup"><span data-stu-id="35928-131">For example, if calling code specifies `dynamicFile.Sample`, the dynamic class returns a generic list of strings that contains all of the lines from the file that begin with "Sample".</span></span> <span data-ttu-id="35928-132">Při hledání se nerozlišují malá a velká písmena.</span><span class="sxs-lookup"><span data-stu-id="35928-132">The search is case-insensitive.</span></span> <span data-ttu-id="35928-133">Dynamická třída také podporuje dva nepovinné argumenty.</span><span class="sxs-lookup"><span data-stu-id="35928-133">The dynamic class also supports two optional arguments.</span></span> <span data-ttu-id="35928-134">První argument je hodnota výčtu možnosti vyhledávání, která určuje, že Dynamická třída by měla vyhledat shody na začátku řádku, na konci řádku nebo kdekoli na řádku.</span><span class="sxs-lookup"><span data-stu-id="35928-134">The first argument is a search option enum value that specifies that the dynamic class should search for matches at the start of the line, the end of the line, or anywhere in the line.</span></span> <span data-ttu-id="35928-135">Druhý argument určuje, že Dynamická třída by měla před vyhledáváním oříznout úvodní a koncové mezery z každého řádku.</span><span class="sxs-lookup"><span data-stu-id="35928-135">The second argument specifies that the dynamic class should trim leading and trailing spaces from each line before searching.</span></span> <span data-ttu-id="35928-136">Například pokud volání Určuje kód `dynamicFile.Sample(StringSearchOption.Contains)` , dynamická třída vyhledá "Sample" kdekoli na řádku.</span><span class="sxs-lookup"><span data-stu-id="35928-136">For example, if calling code specifies `dynamicFile.Sample(StringSearchOption.Contains)`, the dynamic class searches for "Sample" anywhere in a line.</span></span> <span data-ttu-id="35928-137">Pokud volání Určuje kód `dynamicFile.Sample(StringSearchOption.StartsWith, false)` , dynamická třída vyhledá "Sample" na začátku každého řádku a neodstraní úvodní a koncové mezery.</span><span class="sxs-lookup"><span data-stu-id="35928-137">If calling code specifies `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, the dynamic class searches for "Sample" at the start of each line, and does not remove leading and trailing spaces.</span></span> <span data-ttu-id="35928-138">Výchozím chováním dynamické třídy je vyhledat shodu na začátku každého řádku a odebrat úvodní a koncové mezery.</span><span class="sxs-lookup"><span data-stu-id="35928-138">The default behavior of the dynamic class is to search for a match at the start of each line and to remove leading and trailing spaces.</span></span>  
  
### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="35928-139">Vytvoření vlastní dynamické třídy</span><span class="sxs-lookup"><span data-stu-id="35928-139">To create a custom dynamic class</span></span>  
  
1. <span data-ttu-id="35928-140">Spusťte Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="35928-140">Start Visual Studio.</span></span>  
  
2. <span data-ttu-id="35928-141">V nabídce **soubor** přejděte na příkaz **Nový** a klikněte na **projekt**.</span><span class="sxs-lookup"><span data-stu-id="35928-141">On the **File** menu, point to **New** and then click **Project**.</span></span>  
  
3. <span data-ttu-id="35928-142">V dialogovém okně **Nový projekt** v podokně **typy projektů** se ujistěte, že je vybrána možnost **Windows** .</span><span class="sxs-lookup"><span data-stu-id="35928-142">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="35928-143">V podokně **šablony** vyberte **Konzolová aplikace** .</span><span class="sxs-lookup"><span data-stu-id="35928-143">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="35928-144">Do pole **název** zadejte `DynamicSample` a pak klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="35928-144">In the **Name** box, type `DynamicSample`, and then click **OK**.</span></span> <span data-ttu-id="35928-145">Vytvoří se nový projekt.</span><span class="sxs-lookup"><span data-stu-id="35928-145">The new project is created.</span></span>  
  
4. <span data-ttu-id="35928-146">Klikněte pravým tlačítkem na projekt DynamicSample a přejděte na **Přidat**a pak klikněte na **Třída**.</span><span class="sxs-lookup"><span data-stu-id="35928-146">Right-click the DynamicSample project and point to **Add**, and then click **Class**.</span></span> <span data-ttu-id="35928-147">Do pole **název** zadejte `ReadOnlyFile` a pak klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="35928-147">In the **Name** box, type `ReadOnlyFile`, and then click **OK**.</span></span> <span data-ttu-id="35928-148">Přidá se nový soubor, který obsahuje třídu ReadOnlyFile.</span><span class="sxs-lookup"><span data-stu-id="35928-148">A new file is added that contains the ReadOnlyFile class.</span></span>  
  
5. <span data-ttu-id="35928-149">V horní části souboru ReadOnlyFile.cs nebo ReadOnlyFile. vb přidejte následující kód pro import <xref:System.IO?displayProperty=nameWithType> <xref:System.Dynamic?displayProperty=nameWithType> oboru názvů a.</span><span class="sxs-lookup"><span data-stu-id="35928-149">At the top of the ReadOnlyFile.cs or ReadOnlyFile.vb file, add the following code to import the <xref:System.IO?displayProperty=nameWithType> and <xref:System.Dynamic?displayProperty=nameWithType> namespaces.</span></span>  

    [!code-csharp[VbDynamicWalkthrough#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#1)]
    [!code-vb[VbDynamicWalkthrough#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#1)]  

6. <span data-ttu-id="35928-150">Vlastní dynamický objekt používá výčet k určení kritérií vyhledávání.</span><span class="sxs-lookup"><span data-stu-id="35928-150">The custom dynamic object uses an enum to determine the search criteria.</span></span> <span data-ttu-id="35928-151">Před příkazem třídy přidejte následující definici výčtu.</span><span class="sxs-lookup"><span data-stu-id="35928-151">Before the class statement, add the following enum definition.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#2)]
    [!code-vb[VbDynamicWalkthrough#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#2)]
  
7. <span data-ttu-id="35928-152">Aktualizujte příkaz Class tak, aby dědil `DynamicObject` třídu, jak je znázorněno v následujícím příkladu kódu.</span><span class="sxs-lookup"><span data-stu-id="35928-152">Update the class statement to inherit the `DynamicObject` class, as shown in the following code example.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#3)]
    [!code-vb[VbDynamicWalkthrough#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#3)]

8. <span data-ttu-id="35928-153">Přidejte následující kód do `ReadOnlyFile` třídy pro definování soukromého pole pro cestu k souboru a konstruktor pro `ReadOnlyFile` třídu.</span><span class="sxs-lookup"><span data-stu-id="35928-153">Add the following code to the `ReadOnlyFile` class to define a private field for the file path and a constructor for the `ReadOnlyFile` class.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#4](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#4)]
    [!code-vb[VbDynamicWalkthrough#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#4)]
  
9. <span data-ttu-id="35928-154">Do třídy `ReadOnlyFile` přidejte následující metodu `GetPropertyValue`.</span><span class="sxs-lookup"><span data-stu-id="35928-154">Add the following `GetPropertyValue` method to the `ReadOnlyFile` class.</span></span> <span data-ttu-id="35928-155">`GetPropertyValue`Metoda přijímá jako vstup kritéria hledání a vrací řádky z textového souboru, které odpovídají kritériím vyhledávání.</span><span class="sxs-lookup"><span data-stu-id="35928-155">The `GetPropertyValue` method takes, as input, search criteria and returns the lines from a text file that match that search criteria.</span></span> <span data-ttu-id="35928-156">Dynamické metody poskytované `ReadOnlyFile` třídou volají `GetPropertyValue` metodu pro načtení příslušných výsledků.</span><span class="sxs-lookup"><span data-stu-id="35928-156">The dynamic methods provided by the `ReadOnlyFile` class call the `GetPropertyValue` method to retrieve their respective results.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#5](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#5)]
    [!code-vb[VbDynamicWalkthrough#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#5)]  
  
10. <span data-ttu-id="35928-157">Po `GetPropertyValue` metodě přidejte následující kód pro přepsání <xref:System.Dynamic.DynamicObject.TryGetMember%2A> metody <xref:System.Dynamic.DynamicObject> třídy.</span><span class="sxs-lookup"><span data-stu-id="35928-157">After the `GetPropertyValue` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="35928-158"><xref:System.Dynamic.DynamicObject.TryGetMember%2A>Metoda je volána, když je požadován člen dynamické třídy a nejsou zadány žádné argumenty.</span><span class="sxs-lookup"><span data-stu-id="35928-158">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method is called when a member of a dynamic class is requested and no arguments are specified.</span></span> <span data-ttu-id="35928-159">`binder`Argument obsahuje informace o odkazovaném členu a `result` argument odkazuje na výsledek vrácený pro zadaného člena.</span><span class="sxs-lookup"><span data-stu-id="35928-159">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="35928-160"><xref:System.Dynamic.DynamicObject.TryGetMember%2A>Metoda vrátí logickou hodnotu, která vrátí, `true` zda požadovaný člen existuje; v opačném případě vrátí `false` .</span><span class="sxs-lookup"><span data-stu-id="35928-160">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#6](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#6)]
    [!code-vb[VbDynamicWalkthrough#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#6)]
  
11. <span data-ttu-id="35928-161">Po `TryGetMember` metodě přidejte následující kód pro přepsání <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> metody <xref:System.Dynamic.DynamicObject> třídy.</span><span class="sxs-lookup"><span data-stu-id="35928-161">After the `TryGetMember` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="35928-162"><xref:System.Dynamic.DynamicObject.TryInvokeMember%2A>Metoda je volána, když je požadován člen dynamické třídy s argumenty.</span><span class="sxs-lookup"><span data-stu-id="35928-162">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method is called when a member of a dynamic class is requested with arguments.</span></span> <span data-ttu-id="35928-163">`binder`Argument obsahuje informace o odkazovaném členu a `result` argument odkazuje na výsledek vrácený pro zadaného člena.</span><span class="sxs-lookup"><span data-stu-id="35928-163">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="35928-164">`args`Argument obsahuje pole argumentů, které jsou předány členu.</span><span class="sxs-lookup"><span data-stu-id="35928-164">The `args` argument contains an array of the arguments that are passed to the member.</span></span> <span data-ttu-id="35928-165"><xref:System.Dynamic.DynamicObject.TryInvokeMember%2A>Metoda vrátí logickou hodnotu, která vrátí, `true` zda požadovaný člen existuje; v opačném případě vrátí `false` .</span><span class="sxs-lookup"><span data-stu-id="35928-165">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>  
  
    <span data-ttu-id="35928-166">Vlastní verze `TryInvokeMember` metody očekává, že první argument bude hodnota z `StringSearchOption` výčtu, který jste definovali v předchozím kroku.</span><span class="sxs-lookup"><span data-stu-id="35928-166">The custom version of the `TryInvokeMember` method expects the first argument to be a value from the `StringSearchOption` enum that you defined in a previous step.</span></span> <span data-ttu-id="35928-167">`TryInvokeMember`Metoda očekává, že druhý argument bude logická hodnota.</span><span class="sxs-lookup"><span data-stu-id="35928-167">The `TryInvokeMember` method expects the second argument to be a Boolean value.</span></span> <span data-ttu-id="35928-168">Pokud jsou jeden nebo oba argumenty platné hodnoty, jsou předány `GetPropertyValue` metodě pro načtení výsledků.</span><span class="sxs-lookup"><span data-stu-id="35928-168">If one or both arguments are valid values, they are passed to the `GetPropertyValue` method to retrieve the results.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#7](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#7)]
    [!code-vb[VbDynamicWalkthrough#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#7)]
  
12. <span data-ttu-id="35928-169">Uložte soubor a zavřete ho.</span><span class="sxs-lookup"><span data-stu-id="35928-169">Save and close the file.</span></span>  
  
#### <a name="to-create-a-sample-text-file"></a><span data-ttu-id="35928-170">Vytvoření ukázkového textového souboru</span><span class="sxs-lookup"><span data-stu-id="35928-170">To create a sample text file</span></span>  
  
1. <span data-ttu-id="35928-171">Klikněte pravým tlačítkem na projekt DynamicSample, přejděte na **Přidat**a klikněte na **Nová položka**.</span><span class="sxs-lookup"><span data-stu-id="35928-171">Right-click the DynamicSample project and point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="35928-172">V podokně **Nainstalované šablony** vyberte **Obecné**a potom vyberte šablonu **textový soubor** .</span><span class="sxs-lookup"><span data-stu-id="35928-172">In the **Installed Templates** pane, select **General**, and then select the **Text File** template.</span></span> <span data-ttu-id="35928-173">V poli **název** ponechte výchozí název TextFile1.txt a pak klikněte na **Přidat**.</span><span class="sxs-lookup"><span data-stu-id="35928-173">Leave the default name of TextFile1.txt in the **Name** box, and then click **Add**.</span></span> <span data-ttu-id="35928-174">Do projektu se přidá nový textový soubor.</span><span class="sxs-lookup"><span data-stu-id="35928-174">A new text file is added to the project.</span></span>  
  
2. <span data-ttu-id="35928-175">Zkopírujte následující text do souboru TextFile1.txt.</span><span class="sxs-lookup"><span data-stu-id="35928-175">Copy the following text to the TextFile1.txt file.</span></span>  
  
    ```text  
    List of customers and suppliers  
  
    Supplier: Lucerne Publishing (https://www.lucernepublishing.com/)  
    Customer: Preston, Chris  
    Customer: Hines, Patrick  
    Customer: Cameron, Maria  
    Supplier: Graphic Design Institute (https://www.graphicdesigninstitute.com/)
    Supplier: Fabrikam, Inc. (https://www.fabrikam.com/)
    Customer: Seubert, Roxanne  
    Supplier: Proseware, Inc. (http://www.proseware.com/)
    Customer: Adolphi, Stephan  
    Customer: Koch, Paul  
    ```  
  
3. <span data-ttu-id="35928-176">Uložte soubor a zavřete ho.</span><span class="sxs-lookup"><span data-stu-id="35928-176">Save and close the file.</span></span>  
  
#### <a name="to-create-a-sample-application-that-uses-the-custom-dynamic-object"></a><span data-ttu-id="35928-177">Vytvoření ukázkové aplikace, která používá vlastní dynamický objekt</span><span class="sxs-lookup"><span data-stu-id="35928-177">To create a sample application that uses the custom dynamic object</span></span>  
  
1. <span data-ttu-id="35928-178">V **Průzkumník řešení**dvakrát klikněte na soubor Module1. vb, pokud používáte Visual Basic nebo soubor program.cs, pokud používáte jazyk Visual C#.</span><span class="sxs-lookup"><span data-stu-id="35928-178">In **Solution Explorer**, double-click the Module1.vb file if you are using Visual Basic or the Program.cs file if you are using Visual C#.</span></span>  
  
2. <span data-ttu-id="35928-179">Do hlavní procedury přidejte následující kód, který vytvoří instanci `ReadOnlyFile` třídy pro soubor TextFile1.txt.</span><span class="sxs-lookup"><span data-stu-id="35928-179">Add the following code to the Main procedure to create an instance of the `ReadOnlyFile` class for the TextFile1.txt file.</span></span> <span data-ttu-id="35928-180">Kód používá pozdní vazbu k volání dynamických členů a načítají řádky textu, které obsahují řetězec "Customer".</span><span class="sxs-lookup"><span data-stu-id="35928-180">The code uses late binding to call dynamic members and retrieve lines of text that contain the string "Customer".</span></span>  
  
     [!code-csharp[VbDynamicWalkthrough#8](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/program.cs#8)]
     [!code-vb[VbDynamicWalkthrough#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/module1.vb#8)]
  
3. <span data-ttu-id="35928-181">Uložte soubor a stisknutím kombinace kláves CTRL + F5 Sestavte a spusťte aplikaci.</span><span class="sxs-lookup"><span data-stu-id="35928-181">Save the file and press CTRL+F5 to build and run the application.</span></span>  
  
## <a name="calling-a-dynamic-language-library"></a><span data-ttu-id="35928-182">Volání knihovny dynamického jazyka</span><span class="sxs-lookup"><span data-stu-id="35928-182">Calling a Dynamic Language Library</span></span>  

<span data-ttu-id="35928-183">Následující projekt, který vytvoříte v tomto návodu, přistupuje k knihovně, která je napsaná v dynamické jazykové Ironpythonu.</span><span class="sxs-lookup"><span data-stu-id="35928-183">The next project that you create in this walkthrough accesses a library that is written in the dynamic language IronPython.</span></span>
  
### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="35928-184">Vytvoření vlastní dynamické třídy</span><span class="sxs-lookup"><span data-stu-id="35928-184">To create a custom dynamic class</span></span>
  
1. <span data-ttu-id="35928-185">V aplikaci Visual Studio v nabídce **soubor** přejděte na možnost **Nový** a poté klikněte na položku **projekt**.</span><span class="sxs-lookup"><span data-stu-id="35928-185">In Visual Studio, on the **File** menu, point to **New** and then click **Project**.</span></span>  
  
2. <span data-ttu-id="35928-186">V dialogovém okně **Nový projekt** v podokně **typy projektů** se ujistěte, že je vybrána možnost **Windows** .</span><span class="sxs-lookup"><span data-stu-id="35928-186">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="35928-187">V podokně **šablony** vyberte **Konzolová aplikace** .</span><span class="sxs-lookup"><span data-stu-id="35928-187">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="35928-188">Do pole **název** zadejte `DynamicIronPythonSample` a pak klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="35928-188">In the **Name** box, type `DynamicIronPythonSample`, and then click **OK**.</span></span> <span data-ttu-id="35928-189">Vytvoří se nový projekt.</span><span class="sxs-lookup"><span data-stu-id="35928-189">The new project is created.</span></span>  
  
3. <span data-ttu-id="35928-190">Pokud používáte Visual Basic, klikněte pravým tlačítkem na projekt DynamicIronPythonSample a pak klikněte na **vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="35928-190">If you are using Visual Basic, right-click the DynamicIronPythonSample project and then click **Properties**.</span></span> <span data-ttu-id="35928-191">Klikněte na kartu **odkazy** . klikněte na tlačítko **Přidat** .</span><span class="sxs-lookup"><span data-stu-id="35928-191">Click the **References** tab. Click the **Add** button.</span></span> <span data-ttu-id="35928-192">Pokud používáte jazyk Visual C#, klikněte v **Průzkumník řešení**pravým tlačítkem myši na složku **odkazy** a potom klikněte na tlačítko **Přidat odkaz**.</span><span class="sxs-lookup"><span data-stu-id="35928-192">If you are using Visual C#, in **Solution Explorer**, right-click the **References** folder and then click **Add Reference**.</span></span>  
  
4. <span data-ttu-id="35928-193">Na kartě **Procházet** přejděte do složky, ve které jsou nainstalované knihovny ironpythonu.</span><span class="sxs-lookup"><span data-stu-id="35928-193">On the **Browse** tab, browse to the folder where the IronPython libraries are installed.</span></span> <span data-ttu-id="35928-194">Například C:\Program Files\IronPython 2,6 pro .NET 4,0.</span><span class="sxs-lookup"><span data-stu-id="35928-194">For example, C:\Program Files\IronPython 2.6 for .NET 4.0.</span></span> <span data-ttu-id="35928-195">Vyberte knihovny **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll**a **Microsoft.Dynamic.dll** .</span><span class="sxs-lookup"><span data-stu-id="35928-195">Select the **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll**, and **Microsoft.Dynamic.dll** libraries.</span></span> <span data-ttu-id="35928-196">Klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="35928-196">Click **OK**.</span></span>  
  
5. <span data-ttu-id="35928-197">Pokud používáte Visual Basic, upravte soubor Module1. vb.</span><span class="sxs-lookup"><span data-stu-id="35928-197">If you are using Visual Basic, edit the Module1.vb file.</span></span> <span data-ttu-id="35928-198">Pokud používáte jazyk Visual C#, upravte soubor Program.cs.</span><span class="sxs-lookup"><span data-stu-id="35928-198">If you are using Visual C#, edit the Program.cs file.</span></span>  
  
6. <span data-ttu-id="35928-199">V horní části souboru přidejte následující kód pro import `Microsoft.Scripting.Hosting` `IronPython.Hosting` oborů názvů a z knihoven ironpythonu.</span><span class="sxs-lookup"><span data-stu-id="35928-199">At the top of the file, add the following code to import the `Microsoft.Scripting.Hosting` and `IronPython.Hosting` namespaces from the IronPython libraries.</span></span>  
  
    [!code-csharp[VbDynamicWalkthroughIronPython#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#1)]
    [!code-vb[VbDynamicWalkthroughIronPython#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#1)]
  
7. <span data-ttu-id="35928-200">Do metody Main přidejte následující kód k vytvoření nového `Microsoft.Scripting.Hosting.ScriptRuntime` objektu pro hostování knihoven ironpythonu.</span><span class="sxs-lookup"><span data-stu-id="35928-200">In the Main method, add the following code to create a new `Microsoft.Scripting.Hosting.ScriptRuntime` object to host the IronPython libraries.</span></span> <span data-ttu-id="35928-201">`ScriptRuntime`Objekt načte modul Random.py knihovny ironpythonu.</span><span class="sxs-lookup"><span data-stu-id="35928-201">The `ScriptRuntime` object loads the IronPython library module random.py.</span></span>  
  
     [!code-csharp[VbDynamicWalkthroughIronPython#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#2)]
     [!code-vb[VbDynamicWalkthroughIronPython#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#2)]
  
8. <span data-ttu-id="35928-202">Poté, co kód načte modul random.py, přidejte následující kód pro vytvoření pole celých čísel.</span><span class="sxs-lookup"><span data-stu-id="35928-202">After the code to load the random.py module, add the following code to create an array of integers.</span></span> <span data-ttu-id="35928-203">Pole je předáno `shuffle` metodě modulu Random.py, který náhodně seřadí hodnoty v poli.</span><span class="sxs-lookup"><span data-stu-id="35928-203">The array is passed to the `shuffle` method of the random.py module, which randomly sorts the values in the array.</span></span>  
  
     [!code-csharp[VbDynamicWalkthroughIronPython#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#3)]
     [!code-vb[VbDynamicWalkthroughIronPython#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#3)]
  
9. <span data-ttu-id="35928-204">Uložte soubor a stisknutím kombinace kláves CTRL + F5 Sestavte a spusťte aplikaci.</span><span class="sxs-lookup"><span data-stu-id="35928-204">Save the file and press CTRL+F5 to build and run the application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="35928-205">Viz také:</span><span class="sxs-lookup"><span data-stu-id="35928-205">See also</span></span>

- <xref:System.Dynamic?displayProperty=nameWithType>
- <xref:System.Dynamic.DynamicObject?displayProperty=nameWithType>
- [<span data-ttu-id="35928-206">Použití typu dynamic</span><span class="sxs-lookup"><span data-stu-id="35928-206">Using Type dynamic</span></span>](./using-type-dynamic.md)
- [<span data-ttu-id="35928-207">Počáteční a pozdní vazba</span><span class="sxs-lookup"><span data-stu-id="35928-207">Early and Late Binding</span></span>](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md)
- [<span data-ttu-id="35928-208">dynamické</span><span class="sxs-lookup"><span data-stu-id="35928-208">dynamic</span></span>](../../language-reference/builtin-types/reference-types.md)
- [<span data-ttu-id="35928-209">Implementace dynamických rozhraní (ke stažení PDF z webu Microsoft TechNet)</span><span class="sxs-lookup"><span data-stu-id="35928-209">Implementing Dynamic Interfaces (downloadable PDF from Microsoft TechNet)</span></span>](https://download.microsoft.com/download/5/4/B/54B83DFE-D7AA-4155-9687-B0CF58FF65D7/implementing-dynamic-interfaces.pdf)
