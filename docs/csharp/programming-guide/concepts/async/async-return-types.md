---
title: Asynchronní návratové typy (C#)
description: Přečtěte si o návratových typech, které asynchronní metody mohou mít v jazyce C# s příklady kódu pro každý typ a další prostředky.
ms.date: 08/19/2020
ms.assetid: ddb2539c-c898-48c1-ad92-245e4a996df8
ms.openlocfilehash: 71e560ed8ee0cae14da396e5ea2f3ab29611ebab
ms.sourcegitcommit: 9c45035b781caebc63ec8ecf912dc83fb6723b1f
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/25/2020
ms.locfileid: "88811493"
---
# <a name="async-return-types-c"></a><span data-ttu-id="523ba-103">Asynchronní návratové typy (C#)</span><span class="sxs-lookup"><span data-stu-id="523ba-103">Async return types (C#)</span></span>

<span data-ttu-id="523ba-104">Asynchronní metody mohou mít následující návratové typy:</span><span class="sxs-lookup"><span data-stu-id="523ba-104">Async methods can have the following return types:</span></span>

- <span data-ttu-id="523ba-105"><xref:System.Threading.Tasks.Task>, pro asynchronní metodu, která provádí operaci, ale nevrací žádnou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="523ba-105"><xref:System.Threading.Tasks.Task>, for an async method that performs an operation but returns no value.</span></span>
- <span data-ttu-id="523ba-106"><xref:System.Threading.Tasks.Task%601>, pro asynchronní metodu, která vrací hodnotu.</span><span class="sxs-lookup"><span data-stu-id="523ba-106"><xref:System.Threading.Tasks.Task%601>, for an async method that returns a value.</span></span>
- <span data-ttu-id="523ba-107">`void`, pro obslužnou rutinu události.</span><span class="sxs-lookup"><span data-stu-id="523ba-107">`void`, for an event handler.</span></span>
- <span data-ttu-id="523ba-108">Počínaje jazykem C# 7,0, jakýkoli typ, který má přístupnou `GetAwaiter` metodu.</span><span class="sxs-lookup"><span data-stu-id="523ba-108">Starting with C# 7.0, any type that has an accessible `GetAwaiter` method.</span></span> <span data-ttu-id="523ba-109">Objekt vrácený `GetAwaiter` metodou musí implementovat <xref:System.Runtime.CompilerServices.ICriticalNotifyCompletion?displayProperty=nameWithType> rozhraní.</span><span class="sxs-lookup"><span data-stu-id="523ba-109">The object returned by the `GetAwaiter` method must implement the <xref:System.Runtime.CompilerServices.ICriticalNotifyCompletion?displayProperty=nameWithType> interface.</span></span>
- <span data-ttu-id="523ba-110">Počínaje jazykem C# 8,0, <xref:System.Collections.Generic.IAsyncEnumerable%601> pro asynchronní metodu, která vrací *asynchronní datový proud*.</span><span class="sxs-lookup"><span data-stu-id="523ba-110">Starting with C# 8.0, <xref:System.Collections.Generic.IAsyncEnumerable%601>, for an async method that returns an *async stream*.</span></span>

<span data-ttu-id="523ba-111">Další informace o asynchronních metodách naleznete v tématu [asynchronní programování s Async a await (C#)](./index.md).</span><span class="sxs-lookup"><span data-stu-id="523ba-111">For more information about async methods, see [Asynchronous programming with async and await (C#)](./index.md).</span></span>

<span data-ttu-id="523ba-112">Existuje také několik dalších typů, které jsou specifické pro úlohy Windows:</span><span class="sxs-lookup"><span data-stu-id="523ba-112">Several other types also exist that are specific to Windows workloads:</span></span>

- <span data-ttu-id="523ba-113"><xref:System.Windows.Threading.DispatcherOperation>, pro asynchronní operace omezené na Windows.</span><span class="sxs-lookup"><span data-stu-id="523ba-113"><xref:System.Windows.Threading.DispatcherOperation>, for async operations limited to Windows.</span></span>
- <span data-ttu-id="523ba-114"><xref:Windows.Foundation.IAsyncAction>, pro asynchronní akce v UWP, které nevracejí hodnotu.</span><span class="sxs-lookup"><span data-stu-id="523ba-114"><xref:Windows.Foundation.IAsyncAction>, for async actions in UWP that do not return a value.</span></span>
- <span data-ttu-id="523ba-115"><xref:Windows.Foundation.IAsyncActionWithProgress%601>, pro asynchronní akce v UWP, které hlásí průběh, ale nevrací hodnotu.</span><span class="sxs-lookup"><span data-stu-id="523ba-115"><xref:Windows.Foundation.IAsyncActionWithProgress%601>, for async actions in UWP that report progress but do not return a value.</span></span>
- <span data-ttu-id="523ba-116"><xref:Windows.Foundation.IAsyncOperation%601>pro asynchronní operace v UWP, které vracejí hodnotu.</span><span class="sxs-lookup"><span data-stu-id="523ba-116"><xref:Windows.Foundation.IAsyncOperation%601>, for async operations in UWP that return a value.</span></span>
- <span data-ttu-id="523ba-117"><xref:Windows.Foundation.IAsyncOperationWithProgress%602>, pro asynchronní operace v UWP, které nastavují průběh a vracejí hodnotu.</span><span class="sxs-lookup"><span data-stu-id="523ba-117"><xref:Windows.Foundation.IAsyncOperationWithProgress%602>, for async operations in UWP that report progress and return a value.</span></span>

## <a name="task-return-type"></a><span data-ttu-id="523ba-118">Návratový typ úlohy</span><span class="sxs-lookup"><span data-stu-id="523ba-118">Task return type</span></span>

<span data-ttu-id="523ba-119">Asynchronní metody, které neobsahují `return` příkaz nebo obsahují `return` příkaz, který nevrací operand, obvykle mají návratový typ <xref:System.Threading.Tasks.Task> .</span><span class="sxs-lookup"><span data-stu-id="523ba-119">Async methods that don't contain a `return` statement or that contain a `return` statement that doesn't return an operand usually have a return type of <xref:System.Threading.Tasks.Task>.</span></span> <span data-ttu-id="523ba-120">Tyto metody vrátí, `void` Pokud jsou spouštěny synchronně.</span><span class="sxs-lookup"><span data-stu-id="523ba-120">Such methods return `void` if they run synchronously.</span></span> <span data-ttu-id="523ba-121">Použijete-li <xref:System.Threading.Tasks.Task> návratový typ pro asynchronní metodu, volající metoda může použít `await` operátor pro pozastavení dokončování volajícího až do dokončení volané asynchronní metody.</span><span class="sxs-lookup"><span data-stu-id="523ba-121">If you use a <xref:System.Threading.Tasks.Task> return type for an async method, a calling method can use an `await` operator to suspend the caller's completion until the called async method has finished.</span></span>

<span data-ttu-id="523ba-122">V následujícím příkladu `WaitAndApologizeAsync` Metoda neobsahuje `return` příkaz, takže metoda vrátí <xref:System.Threading.Tasks.Task> objekt.</span><span class="sxs-lookup"><span data-stu-id="523ba-122">In the following example, the `WaitAndApologizeAsync` method doesn't contain a `return` statement, so the method returns a <xref:System.Threading.Tasks.Task> object.</span></span> <span data-ttu-id="523ba-123">Vrácení, `Task` `WaitAndApologizeAsync` které umožňuje očekávat.</span><span class="sxs-lookup"><span data-stu-id="523ba-123">Returning a `Task` enables `WaitAndApologizeAsync` to be awaited.</span></span> <span data-ttu-id="523ba-124"><xref:System.Threading.Tasks.Task>Typ nezahrnuje vlastnost, `Result` protože nemá žádnou návratovou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="523ba-124">The <xref:System.Threading.Tasks.Task> type doesn't include a `Result` property because it has no return value.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns2.cs" id="TaskReturn":::

<span data-ttu-id="523ba-125">`WaitAndApologizeAsync` je očekáván pomocí příkazu await namísto výrazu await, podobně jako volání příkazu pro synchronní metodu vracející typ void.</span><span class="sxs-lookup"><span data-stu-id="523ba-125">`WaitAndApologizeAsync` is awaited by using an await statement instead of an await expression, similar to the calling statement for a synchronous void-returning method.</span></span> <span data-ttu-id="523ba-126">Použití operátoru await v tomto případě nevytvoří hodnotu.</span><span class="sxs-lookup"><span data-stu-id="523ba-126">The application of an await operator in this case doesn't produce a value.</span></span> <span data-ttu-id="523ba-127">Pro objasnění příkazu terms a Expression použijte následující tabulku:</span><span class="sxs-lookup"><span data-stu-id="523ba-127">To clarify the terms statement and expression, refer to the table below:</span></span>

| <span data-ttu-id="523ba-128">Typ čekání</span><span class="sxs-lookup"><span data-stu-id="523ba-128">Await kind</span></span> | <span data-ttu-id="523ba-129">Příklad</span><span class="sxs-lookup"><span data-stu-id="523ba-129">Example</span></span>                                      | <span data-ttu-id="523ba-130">Typ</span><span class="sxs-lookup"><span data-stu-id="523ba-130">Type</span></span>                                   |
|------------|----------------------------------------------|----------------------------------------|
| <span data-ttu-id="523ba-131">Příkaz</span><span class="sxs-lookup"><span data-stu-id="523ba-131">Statement</span></span>  | `await SomeTaskMethodAsync()`                | <xref:System.Threading.Tasks.Task>     |
| <span data-ttu-id="523ba-132">Výraz</span><span class="sxs-lookup"><span data-stu-id="523ba-132">Expression</span></span> | `T result = await SomeTaskMethodAsync<T>();` | <xref:System.Threading.Tasks.Task%601> |

<span data-ttu-id="523ba-133">Volání můžete oddělit `WaitAndApologizeAsync` od aplikace operátoru await, jak ukazuje následující kód.</span><span class="sxs-lookup"><span data-stu-id="523ba-133">You can separate the call to `WaitAndApologizeAsync` from the application of an await operator, as the following code shows.</span></span> <span data-ttu-id="523ba-134">Mějte ale na paměti, že `Task` vlastnost neobsahuje `Result` vlastnost a že při použití operátoru await na objekt není vyprodukována žádná hodnota `Task` .</span><span class="sxs-lookup"><span data-stu-id="523ba-134">However, remember that a `Task` doesn't have a `Result` property, and that no value is produced when an await operator is applied to a `Task`.</span></span>

<span data-ttu-id="523ba-135">Následující kód odděluje volání `WaitAndApologizeAsync` metody z čekání na úlohu, kterou metoda vrátí.</span><span class="sxs-lookup"><span data-stu-id="523ba-135">The following code separates calling the `WaitAndApologizeAsync` method from awaiting the task that the method returns.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns2a.cs" id="AwaitTask":::

## <a name="tasktresult-return-type"></a><span data-ttu-id="523ba-136">\<TResult\>Návratový typ úlohy</span><span class="sxs-lookup"><span data-stu-id="523ba-136">Task\<TResult\> return type</span></span>

<span data-ttu-id="523ba-137"><xref:System.Threading.Tasks.Task%601>Návratový typ se používá pro asynchronní metodu, která obsahuje příkaz [return](../../../language-reference/keywords/return.md) , ve kterém je operand `TResult` .</span><span class="sxs-lookup"><span data-stu-id="523ba-137">The <xref:System.Threading.Tasks.Task%601> return type is used for an async method that contains a [return](../../../language-reference/keywords/return.md) statement in which the operand is `TResult`.</span></span>

<span data-ttu-id="523ba-138">V následujícím příkladu `GetLeisureHoursAsync` Metoda obsahuje `return` příkaz, který vrací celé číslo.</span><span class="sxs-lookup"><span data-stu-id="523ba-138">In the following example, the `GetLeisureHoursAsync` method contains a `return` statement that returns an integer.</span></span> <span data-ttu-id="523ba-139">Proto deklarace metody musí specifikovat návratový typ `Task<int>` .</span><span class="sxs-lookup"><span data-stu-id="523ba-139">Therefore, the method declaration must specify a return type of `Task<int>`.</span></span> <span data-ttu-id="523ba-140"><xref:System.Threading.Tasks.Task.FromResult%2A>Asynchronní metoda je zástupný symbol pro operaci, která vrací <xref:System.DateTime.DayOfWeek> .</span><span class="sxs-lookup"><span data-stu-id="523ba-140">The <xref:System.Threading.Tasks.Task.FromResult%2A> async method is a placeholder for an operation that returns a <xref:System.DateTime.DayOfWeek>.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns1.cs" id="LeisureHours":::

<span data-ttu-id="523ba-141">Když `GetLeisureHoursAsync` je volána z výrazu await v `ShowTodaysInfo` metodě, výraz await načte celočíselnou hodnotu (hodnotu `leisureHours` ), která je uložena v úkolu vráceném `GetLeisureHours` metodou.</span><span class="sxs-lookup"><span data-stu-id="523ba-141">When `GetLeisureHoursAsync` is called from within an await expression in the `ShowTodaysInfo` method, the await expression retrieves the integer value (the value of `leisureHours`) that's stored in the task returned by the `GetLeisureHours` method.</span></span> <span data-ttu-id="523ba-142">Další informace o výrazech await naleznete v tématu [await](../../../language-reference/operators/await.md).</span><span class="sxs-lookup"><span data-stu-id="523ba-142">For more information about await expressions, see [await](../../../language-reference/operators/await.md).</span></span>

<span data-ttu-id="523ba-143">Můžete lépe pochopit, jak `await` načte výsledek z rozhraní `Task<T>` oddělením volání `GetLeisureHoursAsync` z aplikace `await` , jak ukazuje následující kód.</span><span class="sxs-lookup"><span data-stu-id="523ba-143">You can better understand how `await` retrieves the result from a `Task<T>` by separating the call to `GetLeisureHoursAsync` from the application of `await`, as the following code shows.</span></span> <span data-ttu-id="523ba-144">Volání metody `GetLeisureHoursAsync` , která není okamžitě očekávána `Task<int>` , vrátí, jak byste očekávali od deklarace metody.</span><span class="sxs-lookup"><span data-stu-id="523ba-144">A call to method `GetLeisureHoursAsync` that isn't immediately awaited returns a `Task<int>`, as you would expect from the declaration of the method.</span></span> <span data-ttu-id="523ba-145">Úkol je přiřazen k `getLeisureHoursTask` proměnné v příkladu.</span><span class="sxs-lookup"><span data-stu-id="523ba-145">The task is assigned to the `getLeisureHoursTask` variable in the example.</span></span> <span data-ttu-id="523ba-146">Protože `getLeisureHoursTask` je <xref:System.Threading.Tasks.Task%601> , obsahuje <xref:System.Threading.Tasks.Task%601.Result> vlastnost typu `TResult` .</span><span class="sxs-lookup"><span data-stu-id="523ba-146">Because `getLeisureHoursTask` is a <xref:System.Threading.Tasks.Task%601>, it contains a <xref:System.Threading.Tasks.Task%601.Result> property of type `TResult`.</span></span> <span data-ttu-id="523ba-147">V tomto případě `TResult` představuje typ Integer.</span><span class="sxs-lookup"><span data-stu-id="523ba-147">In this case, `TResult` represents an integer type.</span></span> <span data-ttu-id="523ba-148">Při `await` použití na je `getLeisureHoursTask` Výraz Await vyhodnocen jako obsah <xref:System.Threading.Tasks.Task%601.Result%2A> vlastnosti `getLeisureHoursTask` .</span><span class="sxs-lookup"><span data-stu-id="523ba-148">When `await` is applied to `getLeisureHoursTask`, the await expression evaluates to the contents of the <xref:System.Threading.Tasks.Task%601.Result%2A> property of `getLeisureHoursTask`.</span></span> <span data-ttu-id="523ba-149">Hodnota je přiřazena `ret` proměnné.</span><span class="sxs-lookup"><span data-stu-id="523ba-149">The value is assigned to the `ret` variable.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="523ba-150"><xref:System.Threading.Tasks.Task%601.Result%2A>Vlastnost je vlastnost blokování.</span><span class="sxs-lookup"><span data-stu-id="523ba-150">The <xref:System.Threading.Tasks.Task%601.Result%2A> property is a blocking property.</span></span> <span data-ttu-id="523ba-151">Pokud se pokusíte o přístup k tomuto úkolu před jeho dokončením, bude vlákno, které je aktuálně aktivní, blokováno, dokud se úloha nedokončí a hodnota nebude k dispozici.</span><span class="sxs-lookup"><span data-stu-id="523ba-151">If you try to access it before its task is finished, the thread that's currently active is blocked until the task completes and the value is available.</span></span> <span data-ttu-id="523ba-152">Ve většině případů byste měli k hodnotě přistupovat pomocí místo přímého `await` přístupu k vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="523ba-152">In most cases, you should access the value by using `await` instead of accessing the property directly.</span></span>
>
> <span data-ttu-id="523ba-153">Předchozí příklad obnovil hodnotu <xref:System.Threading.Tasks.Task%601.Result%2A> vlastnosti pro blokování hlavního vlákna tak, aby `Main` Metoda mohla vytisknout `message` do konzoly před ukončením aplikace.</span><span class="sxs-lookup"><span data-stu-id="523ba-153">The previous example retrieved the value of the <xref:System.Threading.Tasks.Task%601.Result%2A> property to block the main thread so that the `Main` method could print the `message` to the console before the application ended.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns1a.cs" id="StoreTask":::

## <a name="void-return-type"></a><span data-ttu-id="523ba-154">Návratový typ void</span><span class="sxs-lookup"><span data-stu-id="523ba-154">Void return type</span></span>

<span data-ttu-id="523ba-155">Použijete `void` návratový typ v obslužných rutinách asynchronní události, které vyžadují `void` návratový typ.</span><span class="sxs-lookup"><span data-stu-id="523ba-155">You use the `void` return type in asynchronous event handlers, which require a `void` return type.</span></span> <span data-ttu-id="523ba-156">Pro jiné metody než obslužné rutiny událostí, které nevracejí hodnotu, byste měli <xref:System.Threading.Tasks.Task> místo toho vracet výjimku, protože asynchronní metoda, která vrací, `void` nemůže být očekávána.</span><span class="sxs-lookup"><span data-stu-id="523ba-156">For methods other than event handlers that don't return a value, you should return a <xref:System.Threading.Tasks.Task> instead, because an async method that returns `void` can't be awaited.</span></span> <span data-ttu-id="523ba-157">Jakýkoli volající takové metody musí pokračovat v dokončování bez čekání na dokončení volané asynchronní metody.</span><span class="sxs-lookup"><span data-stu-id="523ba-157">Any caller of such a method must continue to completion without waiting for the called async method to finish.</span></span> <span data-ttu-id="523ba-158">Volající musí být nezávislý na všech hodnotách nebo výjimkách vygenerovaných asynchronní metodou.</span><span class="sxs-lookup"><span data-stu-id="523ba-158">The caller must be independent of any values or exceptions that the async method generates.</span></span>

<span data-ttu-id="523ba-159">Volající asynchronní metody vracející hodnotu void nemůže zachytit výjimky vyvolané z metody a tyto neošetřené výjimky pravděpodobně způsobí selhání aplikace.</span><span class="sxs-lookup"><span data-stu-id="523ba-159">The caller of a void-returning async method can't catch exceptions thrown from the method, and such unhandled exceptions are likely to cause your application to fail.</span></span> <span data-ttu-id="523ba-160">Pokud metoda, která vrátí <xref:System.Threading.Tasks.Task> nebo <xref:System.Threading.Tasks.Task%601> vyvolá výjimku, je tato výjimka uložena v vráceném úkolu.</span><span class="sxs-lookup"><span data-stu-id="523ba-160">If a method that returns a <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> throws an exception, the exception is stored in the returned task.</span></span> <span data-ttu-id="523ba-161">Výjimka je znovu vyvolána, když je úloha očekávána.</span><span class="sxs-lookup"><span data-stu-id="523ba-161">The exception is rethrown when the task is awaited.</span></span> <span data-ttu-id="523ba-162">Proto se ujistěte, že jakákoliv asynchronní metoda, která může vyvolat výjimku, má návratový typ <xref:System.Threading.Tasks.Task> nebo <xref:System.Threading.Tasks.Task%601> a že volání metody jsou očekávána.</span><span class="sxs-lookup"><span data-stu-id="523ba-162">Therefore, make sure that any async method that can produce an exception has a return type of <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> and that calls to the method are awaited.</span></span>

<span data-ttu-id="523ba-163">Další informace o tom, jak zachytit výjimky v asynchronních metodách, naleznete v části [výjimky v asynchronních metodách](../../../language-reference/keywords/try-catch.md#exceptions-in-async-methods) v článku [try-catch](../../../language-reference/keywords/try-catch.md) .</span><span class="sxs-lookup"><span data-stu-id="523ba-163">For more information about how to catch exceptions in async methods, see the [Exceptions in async methods](../../../language-reference/keywords/try-catch.md#exceptions-in-async-methods) section of the [try-catch](../../../language-reference/keywords/try-catch.md) article.</span></span>

<span data-ttu-id="523ba-164">Následující příklad ukazuje chování obslužné rutiny asynchronní události.</span><span class="sxs-lookup"><span data-stu-id="523ba-164">The following example shows the behavior of an async event handler.</span></span> <span data-ttu-id="523ba-165">V ukázkovém kódu musí obslužná rutina asynchronní události dát hlavnímu vláknu po jeho dokončení informace.</span><span class="sxs-lookup"><span data-stu-id="523ba-165">In the example code, an async event handler must let the main thread know when it finishes.</span></span> <span data-ttu-id="523ba-166">Pak hlavní vlákno může počkat na dokončení asynchronní obslužné rutiny události před ukončením programu.</span><span class="sxs-lookup"><span data-stu-id="523ba-166">Then the main thread can wait for an async event handler to complete before exiting the program.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns3.cs":::

## <a name="generalized-async-return-types-and-valuetasktresult"></a><span data-ttu-id="523ba-167">Generalizované asynchronní návratové typy a ValueTask\<TResult\></span><span class="sxs-lookup"><span data-stu-id="523ba-167">Generalized async return types and ValueTask\<TResult\></span></span>

<span data-ttu-id="523ba-168">Počínaje jazykem C# 7,0 může asynchronní metoda vracet libovolný typ, který má přístupnou `GetAwaiter` metodu.</span><span class="sxs-lookup"><span data-stu-id="523ba-168">Starting with C# 7.0, an async method can return any type that has an accessible `GetAwaiter` method.</span></span>

<span data-ttu-id="523ba-169">Vzhledem <xref:System.Threading.Tasks.Task> k tomu, že a <xref:System.Threading.Tasks.Task%601> jsou typy odkazů, přidělování paměti v cestách kritických pro výkon, zejména v případě, že přidělení dochází v těsných smyčkách, může negativně ovlivnit výkon.</span><span class="sxs-lookup"><span data-stu-id="523ba-169">Because <xref:System.Threading.Tasks.Task> and <xref:System.Threading.Tasks.Task%601> are reference types, memory allocation in performance-critical paths, particularly when allocations occur in tight loops, can adversely affect performance.</span></span> <span data-ttu-id="523ba-170">Podpora zobecněných návratových typů znamená, že můžete místo typu odkazu vrátit typ s odlehčenou hodnotou, abyste zabránili dalšímu přidělení paměti.</span><span class="sxs-lookup"><span data-stu-id="523ba-170">Support for generalized return types means that you can return a lightweight value type instead of a reference type to avoid additional memory allocations.</span></span>

<span data-ttu-id="523ba-171">Rozhraní .NET poskytuje <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> strukturu jako zjednodušenou implementaci generalizované hodnoty vracející úlohy.</span><span class="sxs-lookup"><span data-stu-id="523ba-171">.NET provides the <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> structure as a lightweight implementation of a generalized task-returning value.</span></span> <span data-ttu-id="523ba-172">Chcete-li použít <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> typ, je nutné přidat `System.Threading.Tasks.Extensions` balíček NuGet do projektu.</span><span class="sxs-lookup"><span data-stu-id="523ba-172">To use the <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> type, you must add the `System.Threading.Tasks.Extensions` NuGet package to your project.</span></span> <span data-ttu-id="523ba-173">V následujícím příkladu se pomocí <xref:System.Threading.Tasks.ValueTask%601> struktury načte hodnota dvou indexů.</span><span class="sxs-lookup"><span data-stu-id="523ba-173">The following example uses the <xref:System.Threading.Tasks.ValueTask%601> structure to retrieve the value of two dice rolls.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-valuetask.cs":::

## <a name="async-streams-with-iasyncenumerablet"></a><span data-ttu-id="523ba-174">Asynchronní streamování pomocí IAsyncEnumerable\<T\></span><span class="sxs-lookup"><span data-stu-id="523ba-174">Async streams with IAsyncEnumerable\<T\></span></span>

<span data-ttu-id="523ba-175">Počínaje jazykem C# 8,0 může asynchronní metoda vracet *asynchronní datový proud*reprezentovaný <xref:System.Collections.Generic.IAsyncEnumerable%601> .</span><span class="sxs-lookup"><span data-stu-id="523ba-175">Starting with C# 8.0, an async method may return an *async stream*, represented by <xref:System.Collections.Generic.IAsyncEnumerable%601>.</span></span> <span data-ttu-id="523ba-176">Asynchronní datový proud poskytuje způsob, jak vytvořit výčet položek čtených z datového proudu, když jsou prvky generovány v blocích s opakovanými asynchronními voláními.</span><span class="sxs-lookup"><span data-stu-id="523ba-176">An async stream provides a way to enumerate items read from a stream when elements are generated in chunks with repeated asynchronous calls.</span></span> <span data-ttu-id="523ba-177">Následující příklad ukazuje asynchronní metodu, která generuje asynchronní datový proud:</span><span class="sxs-lookup"><span data-stu-id="523ba-177">The following example shows an async method that generates an async stream:</span></span>

:::code language="csharp" source="snippets/async-return-types/AsyncStreams.cs" id="GenerateAsyncStream":::

<span data-ttu-id="523ba-178">Předchozí příklad čte řádky z řetězce asynchronně.</span><span class="sxs-lookup"><span data-stu-id="523ba-178">The preceding example reads lines from a string asynchronously.</span></span> <span data-ttu-id="523ba-179">Po načtení každého řádku kód vytvoří výčet každého slova v řetězci.</span><span class="sxs-lookup"><span data-stu-id="523ba-179">Once each line is read, the code enumerates each word in the string.</span></span> <span data-ttu-id="523ba-180">Volající by mohli vytvořit výčet každého slova pomocí `await foreach` příkazu.</span><span class="sxs-lookup"><span data-stu-id="523ba-180">Callers would enumerate each word using the `await foreach` statement.</span></span> <span data-ttu-id="523ba-181">Metoda čeká v případě, kdy potřebuje asynchronní čtení dalšího řádku ze zdrojového řetězce.</span><span class="sxs-lookup"><span data-stu-id="523ba-181">The method awaits when it needs to asynchronously read the next line from the source string.</span></span>

## <a name="see-also"></a><span data-ttu-id="523ba-182">Viz také</span><span class="sxs-lookup"><span data-stu-id="523ba-182">See also</span></span>

- <xref:System.Threading.Tasks.Task.FromResult%2A>
- [<span data-ttu-id="523ba-183">Zpracování asynchronních úloh po dokončení</span><span class="sxs-lookup"><span data-stu-id="523ba-183">Process asynchronous tasks as they complete</span></span>](start-multiple-async-tasks-and-process-them-as-they-complete.md)
- [<span data-ttu-id="523ba-184">Asynchronní programování s modifikátorem Async a operátoru Await (C#)</span><span class="sxs-lookup"><span data-stu-id="523ba-184">Asynchronous programming with async and await (C#)</span></span>](index.md)
- [<span data-ttu-id="523ba-185">async</span><span class="sxs-lookup"><span data-stu-id="523ba-185">async</span></span>](../../../language-reference/keywords/async.md)
- [<span data-ttu-id="523ba-186">await</span><span class="sxs-lookup"><span data-stu-id="523ba-186">await</span></span>](../../../language-reference/operators/await.md)
